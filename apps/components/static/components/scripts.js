class ComponentFramework{static createElement(t){const e=document.querySelector(`[cid="${t.cid}"]`),i=document.createElement(t.selector||{AutomatonEditor:"c-automaton-editor",AutomatonDrawer:"c-automaton-drawer",AutomatonViewer:"c-automaton-viewer",CheckboxGroup:"c-checkbox-group",CodeEditor:"c-code-editor",Countdown:"c-countdown",DragDrop:"c-drag-drop",GraphDrawer:"c-graph-drawer",GraphViewer:"c-graph-viewer",Input:"c-input",Hint:"c-hint",JSXGraph:"c-jsxgraph",KekuleEditor:"c-kekule-editor",KekuleViewer:"c-kekule-viewer",MatchList:"c-match-list",MathDrawer:"c-math-drawer",MathInput:"c-math-input",MathMatrix:"c-math-matrix",RadioGroup:"c-radio-group",SortList:"c-sort-list",Text:"c-text",TextSelect:"c-text-select"}[t.controller]);i.setAttribute("cid",t.cid),e.replaceWith(i),i.deserialize(t)}static findAnswers(t){return document.querySelectorAll("[cid]").forEach(e=>{t[e.getAttribute("cid")]=e.serialize()||{}}),t}}var global,factory;!function(t,e){"use strict";function i(){var t=w.splice(0,w.length);for(Kt=0;t.length;)t.shift().call(null,t.shift())}function s(t,e){for(var i=0,s=t.length;i<s;i++)f(t[i],e)}function n(t){return function(e){It(e)&&(f(e,t),rt.length&&s(e.querySelectorAll(rt),t))}}function r(t){var e=Xt.call(t,"is"),i=t.nodeName.toUpperCase(),s=at.call(st,e?tt+e.toUpperCase():Q+i);return e&&-1<s&&!o(i,e)?-1:s}function o(t,e){return-1<rt.indexOf(t+'[is="'+e+'"]')}function a(t){var e=t.currentTarget,i=t.attrChange,s=t.attrName,n=t.target,r=t[V]||2,o=t[$]||3;!se||n&&n!==e||!e[X]||"style"===s||t.prevValue===t.newValue&&(""!==t.newValue||i!==r&&i!==o)||e[X](s,i===r?null:t.prevValue,i===o?null:t.newValue)}function l(t){var e=n(t);return function(t){w.push(e,t.target),Kt&&clearTimeout(Kt),Kt=setTimeout(i,1)}}function h(t){ie&&(ie=!1,t.currentTarget.removeEventListener(K,h)),rt.length&&s((t.target||_).querySelectorAll(rt),t.detail===Y?Y:B),Dt&&function(){for(var t,e=0,i=Rt.length;e<i;e++)ot.contains(t=Rt[e])||(i--,Rt.splice(e--,1),f(t,Y))}()}function c(t,e){var i=this;Ht.call(i,t,e),E.call(i,{target:i})}function d(t,e,i){var s=e.apply(t,i),n=r(s);return-1<n&&N(s,nt[n]),i.pop()&&rt.length&&function(t){for(var e,i=0,s=t.length;i<s;i++)N(e=t[i],nt[r(e)])}(s.querySelectorAll(rt)),s}function u(t,e){Mt(t,e),T?T.observe(t,$t):(ee&&(t.setAttribute=c,t[I]=A(t),t[R](Z,E)),t[R](W,a)),t[q]&&se&&(t.created=!0,t[q](),t.created=!1)}function p(t){throw new Error("A "+t+" type is already registered")}function f(t,e){var i,s,n=r(t);-1<n&&!Yt.call(t,"TEMPLATE")&&(O(t,nt[n]),n=0,e!==B||t[B]?e!==Y||t[Y]||(t[B]=!1,t[Y]=!0,s="disconnected",n=1):(t[Y]=!1,t[B]=!0,s="connected",n=1,Dt&&at.call(Rt,t)<0&&Rt.push(t)),n&&(i=t[e+F]||t[s+F])&&i.call(t))}function m(){}function g(t,e,i){var s=i&&i[z]||"",n=e.prototype,r=Tt(n),o=e.observedAttributes||ut,a={prototype:r};jt(r,q,{value:function(){if(St)St=!1;else if(!this[yt]){this[yt]=!0,new e(this),n[q]&&n[q].call(this);var t=wt[kt.get(e)];(!Ct||t.create.length>1)&&v(this)}}}),jt(r,X,{value:function(t){-1<at.call(o,t)&&n[X]&&n[X].apply(this,arguments)}}),n[G]&&jt(r,U,{value:n[G]}),n[H]&&jt(r,J,{value:n[H]}),s&&(a[z]=s),t=t.toUpperCase(),wt[t]={constructor:e,create:s?[s,At(t)]:[t]},kt.set(e,t),_[D](t.toLowerCase(),a),C(t),Et[t].r()}function b(t){var e=wt[t.toUpperCase()];return e&&e.constructor}function y(t){return"string"==typeof t?t:t&&t.is||""}function v(t){for(var e,i=t[X],s=i?t.attributes:ut,n=s.length;n--;)i.call(t,(e=s[n]).name||e.nodeName,null,e.value||e.nodeValue)}function C(t){return(t=t.toUpperCase())in Et||(Et[t]={},Et[t].p=new Pt((function(e){Et[t].r=e}))),Et[t].p}function x(){vt&&delete t.customElements,dt(t,"customElements",{configurable:!0,value:new m}),dt(t,"CustomElementRegistry",{configurable:!0,value:m});for(var e=S.get(/^HTML[A-Z]*[a-z]/),i=e.length;i--;function(e){var i=t[e];if(i){t[e]=function(t){var e,s;return t||(t=this),t[yt]||(St=!0,e=wt[kt.get(t.constructor)],(t=(s=Ct&&1===e.create.length)?Reflect.construct(i,ut,e.constructor):_.createElement.apply(_,e.create))[yt]=!0,St=!1,s||v(t)),t},t[e].prototype=i.prototype;try{i.prototype.constructor=t[e]}catch(s){dt(i,yt,{value:t[e]})}}}(e[i]));_.createElement=function(t,e){var i=y(e);return i?Vt.call(this,t,At(i)):Vt.call(this,t)},Zt||(te=!0,_[D](""))}var _=t.document,P=t.Object,S=function(t){var e,i,s,n,r=/^[A-Z]+[a-z]/,o=function(t,e){(e=e.toLowerCase())in a||(a[t]=(a[t]||[]).concat(e),a[e]=a[e.toUpperCase()]=t)},a=(P.create||P)(null),l={};for(i in t)for(n in t[i])for(a[n]=s=t[i][n],e=0;e<s.length;e++)a[s[e].toLowerCase()]=a[s[e].toUpperCase()]=n;return l.get=function(t){return"string"==typeof t?a[t]||(r.test(t)?[]:""):function(t){var e,i=[];for(e in a)t.test(e)&&i.push(e);return i}(t)},l.set=function(t,e){return r.test(t)?o(t,e):o(e,t),l},l}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof e&&(e={type:e||"auto"});var w,E,k,A,T,M,O,N,L,D="registerElement",j=1e5*t.Math.random()>>0,I="__"+D+j,R="addEventListener",B="attached",F="Callback",Y="detached",z="extends",X="attributeChanged"+F,U=B+F,G="connected"+F,H="disconnected"+F,q="created"+F,J=Y+F,V="ADDITION",$="REMOVAL",W="DOMAttrModified",K="DOMContentLoaded",Z="DOMSubtreeModified",Q="<",tt="=",et=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,it=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],st=[],nt=[],rt="",ot=_.documentElement,at=st.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},lt=P.prototype,ht=lt.hasOwnProperty,ct=lt.isPrototypeOf,dt=P.defineProperty,ut=[],pt=P.getOwnPropertyDescriptor,ft=P.getOwnPropertyNames,mt=P.getPrototypeOf,gt=P.setPrototypeOf,bt=!!P.__proto__,yt="__dreCEv1",vt=t.customElements,Ct=!/^force/.test(e.type)&&!!(vt&&vt.define&&vt.get&&vt.whenDefined),xt=P.create||P,_t=t.Map||function(){var t,e=[],i=[];return{get:function(t){return i[at.call(e,t)]},set:function(s,n){(t=at.call(e,s))<0?i[e.push(s)-1]=n:i[t]=n}}},Pt=t.Promise||function(t){function e(t){for(s=!0;i.length;)i.shift()(t)}var i=[],s=!1,n={catch:function(){return n},then:function(t){return i.push(t),s&&setTimeout(e,1),n}};return t(e),n},St=!1,wt=xt(null),Et=xt(null),kt=new _t,At=function(t){return t.toLowerCase()},Tt=P.create||function t(e){return e?(t.prototype=e,new t):this},Mt=gt||(bt?function(t,e){return t.__proto__=e,t}:ft&&pt?function(){function t(t,e){for(var i,s=ft(e),n=0,r=s.length;n<r;n++)ht.call(t,i=s[n])||dt(t,i,pt(e,i))}return function(e,i){do{t(e,i)}while((i=mt(i))&&!ct.call(i,e));return e}}():function(t,e){for(var i in e)t[i]=e[i];return t}),Ot=t.MutationObserver||t.WebKitMutationObserver,Nt=t.HTMLAnchorElement,Lt=(t.HTMLElement||t.Element||t.Node).prototype,Dt=!ct.call(Lt,ot),jt=Dt?function(t,e,i){return t[e]=i.value,t}:dt,It=Dt?function(t){return 1===t.nodeType}:function(t){return ct.call(Lt,t)},Rt=Dt&&[],Bt=Lt.attachShadow,Ft=Lt.cloneNode,Yt=Lt.closest||function(t){for(var e=this;e&&e.nodeName!==t;)e=e.parentNode;return e},zt=Lt.dispatchEvent,Xt=Lt.getAttribute,Ut=Lt.hasAttribute,Gt=Lt.removeAttribute,Ht=Lt.setAttribute,qt=_.createElement,Jt=_.importNode,Vt=qt,$t=Ot&&{attributes:!0,characterData:!0,attributeOldValue:!0},Wt=Ot||function(t){ee=!1,ot.removeEventListener(W,Wt)},Kt=0,Zt=D in _&&!/^force-all/.test(e.type),Qt=!0,te=!1,ee=!0,ie=!0,se=!0;if(Ot&&((L=_.createElement("div")).innerHTML="<div><div></div></div>",new Ot((function(t,e){if(t[0]&&"childList"==t[0].type&&!t[0].removedNodes[0].childNodes.length){var i=(L=pt(Lt,"innerHTML"))&&L.set;i&&dt(Lt,"innerHTML",{set:function(t){for(;this.lastChild;)this.removeChild(this.lastChild);i.call(this,t)}})}e.disconnect(),L=null})).observe(L,{childList:!0,subtree:!0}),L.innerHTML=""),Zt||(gt||bt?(O=function(t,e){ct.call(e,t)||u(t,e)},N=u):N=O=function(t,e){t[I]||(t[I]=P(!0),u(t,e))},Dt?(ee=!1,function(){var t=pt(Lt,R),e=t.value,i=function(t){var e=new CustomEvent(W,{bubbles:!0});e.attrName=t,e.prevValue=Xt.call(this,t),e.newValue=null,e[$]=e.attrChange=2,Gt.call(this,t),zt.call(this,e)},s=function(t,e){var i=Ut.call(this,t),s=i&&Xt.call(this,t),n=new CustomEvent(W,{bubbles:!0});Ht.call(this,t,e),n.attrName=t,n.prevValue=i?s:null,n.newValue=e,i?n.MODIFICATION=n.attrChange=1:n[V]=n.attrChange=0,zt.call(this,n)},n=function(t){var e,i=t.currentTarget,s=i[I],n=t.propertyName;s.hasOwnProperty(n)&&(s=s[n],(e=new CustomEvent(W,{bubbles:!0})).attrName=s.name,e.prevValue=s.value||null,e.newValue=s.value=i[n]||null,null==e.prevValue?e[V]=e.attrChange=0:e.MODIFICATION=e.attrChange=1,zt.call(i,e))};t.value=function(t,r,o){t===W&&this[X]&&this.setAttribute!==s&&(this[I]={className:{name:"class",value:this.className}},this.setAttribute=s,this.removeAttribute=i,e.call(this,"propertychange",n)),e.call(this,t,r,o)},dt(Lt,R,t)}()):Ot||(ot[R](W,Wt),ot.setAttribute(I,1),ot.removeAttribute(I),ee&&(E=function(t){var e,i,s,n=this;if(n===t.target){for(s in e=n[I],n[I]=i=A(n),i){if(!(s in e))return k(0,n,s,e[s],i[s],V);if(i[s]!==e[s])return k(1,n,s,e[s],i[s],"MODIFICATION")}for(s in e)if(!(s in i))return k(2,n,s,e[s],i[s],$)}},k=function(t,e,i,s,n,r){var o={attrChange:t,currentTarget:e,attrName:i,prevValue:s,newValue:n};o[r]=t,a(o)},A=function(t){for(var e,i,s={},n=t.attributes,r=0,o=n.length;r<o;r++)"setAttribute"!==(i=(e=n[r]).name)&&(s[i]=e.value);return s})),_[D]=function(t,e){if(i=t.toUpperCase(),Qt&&(Qt=!1,Ot?(T=function(t,e){function i(t,e){for(var i=0,s=t.length;i<s;e(t[i++]));}return new Ot((function(s){for(var n,r,o,a=0,l=s.length;a<l;a++)"childList"===(n=s[a]).type?(i(n.addedNodes,t),i(n.removedNodes,e)):(r=n.target,se&&r[X]&&"style"!==n.attributeName&&(o=Xt.call(r,n.attributeName))!==n.oldValue&&r[X](n.attributeName,n.oldValue,o))}))}(n(B),n(Y)),(M=function(t){return T.observe(t,{childList:!0,subtree:!0}),t})(_),Bt&&(Lt.attachShadow=function(){return M(Bt.apply(this,arguments))})):(w=[],_[R]("DOMNodeInserted",l(B)),_[R]("DOMNodeRemoved",l(Y))),_[R](K,h),_[R]("readystatechange",h),_.importNode=function(t,e){switch(t.nodeType){case 1:return d(_,Jt,[t,!!e]);case 11:for(var i=_.createDocumentFragment(),s=t.childNodes,n=s.length,r=0;r<n;r++)i.appendChild(_.importNode(s[r],!!e));return i;default:return Ft.call(t,!!e)}},Lt.cloneNode=function(t){return d(this,Ft,[!!t])}),te)return te=!1;if(-2<at.call(st,tt+i)+at.call(st,Q+i)&&p(t),!et.test(i)||-1<at.call(it,i))throw new Error("The type "+t+" is invalid");var i,r,o=function(){return c?_.createElement(u,i):_.createElement(u)},a=e||lt,c=ht.call(a,z),u=c?e[z].toUpperCase():i;return c&&-1<at.call(st,Q+u)&&p(u),r=st.push((c?tt:Q)+i)-1,rt=rt.concat(rt.length?",":"",c?u+'[is="'+t.toLowerCase()+'"]':u),o.prototype=nt[r]=ht.call(a,"prototype")?a.prototype:Tt(Lt),rt.length&&s(_.querySelectorAll(rt),B),o},_.createElement=Vt=function(t,e){var i=y(e),s=i?qt.call(_,t,At(i)):qt.call(_,t),n=""+t,r=at.call(st,(i?tt:Q)+(i||n).toUpperCase()),a=-1<r;return i&&(s.setAttribute("is",i=i.toLowerCase()),a&&(a=o(n.toUpperCase(),i))),se=!_.createElement.innerHTMLHelper,a&&N(s,nt[r]),s}),addEventListener("beforeunload",(function(){delete _.createElement,delete _.importNode,delete _[D]}),!1),m.prototype={constructor:m,define:Ct?function(t,e,i){if(i)g(t,e,i);else{var s=t.toUpperCase();wt[s]={constructor:e,create:[s]},kt.set(e,s),vt.define(t,e)}}:g,get:Ct?function(t){return vt.get(t)||b(t)}:b,whenDefined:Ct?function(t){return Pt.race([vt.whenDefined(t),C(t)])}:C},!vt||/^force/.test(e.type))x();else if(!e.noBuiltIn)try{!function(e,i,s){var n=new RegExp("^<a\\s+is=('|\")"+s+"\\1></a>$");if(i[z]="a",(e.prototype=Tt(Nt.prototype)).constructor=e,t.customElements.define(s,e,i),!n.test(_.createElement("a",{is:s}).outerHTML)||!n.test((new e).outerHTML))throw i}((function t(){return Reflect.construct(Nt,[],t)}),{},"document-register-element-a"+j)}catch(ne){x()}if(!e.noBuiltIn)try{if(qt.call(_,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(re){At=function(t){return{is:t.toLowerCase()}}}}(window),(function(){function t(t,e){return[3*t[1][e]-t[0][e]+-3*t[2][e]+t[3][e],3*t[0][e]-6*t[1][e]+3*t[2][e],-3*t[0][e]+3*t[1][e],t[0][e]]}function e(e){return[t(e,"x"),t(e,"y")]}function i(t){return 0>t?-1:t>0?1:0}function s(t,e,s,n){var r,o,a=e/t,l=s/t,h=n/t,c=(3*l-Math.pow(a,2))/9,d=(9*a*l-27*h-2*Math.pow(a,3))/54,u=Math.pow(c,3)+Math.pow(d,2),p=[];if(u>=0)r=i(d+Math.sqrt(u))*Math.pow(Math.abs(d+Math.sqrt(u)),1/3),o=i(d-Math.sqrt(u))*Math.pow(Math.abs(d-Math.sqrt(u)),1/3),p[0]=-a/3+(r+o),p[1]=-a/3-(r+o)/2,p[2]=-a/3-(r+o)/2,0!==Math.abs(Math.sqrt(3)*(r-o)/2)&&(p[1]=-1,p[2]=-1);else{var f=Math.acos(d/Math.sqrt(-Math.pow(c,3)));p[0]=2*Math.sqrt(-c)*Math.cos(f/3)-a/3,p[1]=2*Math.sqrt(-c)*Math.cos((f+2*Math.PI)/3)-a/3,p[2]=2*Math.sqrt(-c)*Math.cos((f+4*Math.PI)/3)-a/3}for(var m=0;3>m;m++)(p[m]<0||p[m]>1)&&(p[m]=-1);return p}void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:t>0?1:-1});var n=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},r=function(t,e){return t.x*e.x+t.y*e.y},o=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},a=function(t,e){return{x:t.x*e,y:t.y*e}},l=Math.pow(2,-65),h=function(t,e){for(var i=[],s=c(t,e),r=e.length-1,a=d(s,2*r-1,i,0),l=n(t,e[0]),h=o(l),u=0,p=0;a>p;p++){l=n(t,m(e,r,i[p],null,null));var f=o(l);h>f&&(h=f,u=i[p])}return l=n(t,e[r]),h>(f=o(l))&&(h=f,u=1),{location:u,distance:h}},c=function(t,e){for(var i=e.length-1,s=2*i-1,o=[],l=[],h=[],c=[],d=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;i>=u;u++)o[u]=n(e[u],t);for(u=0;i-1>=u;u++)l[u]=n(e[u+1],e[u]),l[u]=a(l[u],3);for(var p=0;i-1>=p;p++)for(var f=0;i>=f;f++)h[p]||(h[p]=[]),h[p][f]=r(l[p],o[f]);for(u=0;s>=u;u++)c[u]||(c[u]=[]),c[u].y=0,c[u].x=parseFloat(u)/s;for(var m=i,g=i-1,b=0;m+g>=b;b++){var y=Math.max(0,b-g),v=Math.min(b,m);for(u=y;v>=u;u++){var C=b-u;c[u+C].y+=h[C][u]*d[C][u]}}return c},d=function(t,e,i,s){var n,r,o=[],a=[],l=[],h=[];switch(u(t,e)){case 0:return 0;case 1:if(s>=64)return i[0]=(t[0].x+t[e].x)/2,1;if(p(t,e))return i[0]=f(t,e),1}m(t,e,.5,o,a),n=d(o,e,l,s+1),r=d(a,e,h,s+1);for(var c=0;n>c;c++)i[c]=l[c];for(c=0;r>c;c++)i[c+n]=h[c];return n+r},u=function(t,e){var i,s,n=0;i=s=Math.sgn(t[0].y);for(var r=1;e>=r;r++)(i=Math.sgn(t[r].y))!=s&&n++,s=i;return n},p=function(t,e){var i,s,n,r,o,a,h,c,d,u;o=t[0].y-t[e].y,a=t[e].x-t[0].x,h=t[0].x*t[e].y-t[e].x*t[0].y,d=u=0;for(var p=1;e>p;p++){var f=o*t[p].x+a*t[p].y+h;f>d?d=f:u>f&&(u=f)}return i=(1*(h-d)-0*(c=a))*(1/(0*c-1*o)),s=(1*(h-u)-0*(c=a))*(1/(0*c-1*o)),n=Math.min(i,s),r=Math.max(i,s),l>r-n?1:0},f=function(t,e){var i=t[e].x-t[0].x,s=t[e].y-t[0].y;return 0+1/(0*i-1*s)*(i*(t[0].y-0)-s*(t[0].x-0))*1},m=function(t,e,i,s,n){for(var r=[[]],o=0;e>=o;o++)r[0][o]=t[o];for(var a=1;e>=a;a++)for(o=0;e-a>=o;o++)r[a]||(r[a]=[]),r[a][o]||(r[a][o]={}),r[a][o].x=(1-i)*r[a-1][o].x+i*r[a-1][o+1].x,r[a][o].y=(1-i)*r[a-1][o].y+i*r[a-1][o+1].y;if(null!=s)for(o=0;e>=o;o++)s[o]=r[o][0];if(null!=n)for(o=0;e>=o;o++)n[o]=r[e-o][o];return r[e][0]},g={},b=function(t,e){for(var i=function(t){var e=g[t];if(!e){var i=function(t){return function(e){return t}},s=function(){return function(t){return t}},n=function(){return function(t){return 1-t}},r=function(t){return function(e){for(var i=1,s=0;s<t.length;s++)i*=t[s](e);return i}};(e=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var o=1;t>o;o++){for(var a=[new i(t)],l=0;t-o>l;l++)a.push(new s);for(l=0;o>l;l++)a.push(new n);e.push(new r(a))}e.push(new function(){return function(e){return Math.pow(1-e,t)}}),g[t]=e}return e}(t.length-1),s=0,n=0,r=0;r<t.length;r++)s+=t[r].x*i[r](e),n+=t[r].y*i[r](e);return{x:s,y:n}},y=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},v=function(t){return t[0].x===t[1].x&&t[0].y===t[1].y},C=function(t,e,i){if(v(t))return{point:t[0],location:e};for(var s=b(t,e),n=0,r=e,o=i>0?1:-1,a=null;n<Math.abs(i);)a=b(t,r+=.005*o),n+=y(a,s),s=a;return{point:a,location:r}},x=function(t,e){var i=b(t,e),s=b(t.slice(0,t.length-1),e),n=s.y-i.y;return 0===n?1/0:Math.atan(n/(s.x-i.x))},_=function(t,i,n,r,o){var a=r-i,l=t-n,h=t*(i-r)+i*(n-t),c=e(o),d=s.apply(null,[a*c[0][0]+l*c[1][0],a*c[0][1]+l*c[1][1],a*c[0][2]+l*c[1][2],a*c[0][3]+l*c[1][3]+h]),u=[];if(null!=d)for(var p=0;3>p;p++){var f,m=d[p],g=Math.pow(m,2),b=Math.pow(m,3),y=[c[0][0]*b+c[0][1]*g+c[0][2]*m+c[0][3],c[1][0]*b+c[1][1]*g+c[1][2]*m+c[1][3]];f=n-t!=0?(y[0]-t)/(n-t):(y[1]-i)/(r-i),m>=0&&1>=m&&f>=0&&1>=f&&u.push(y)}return u},P=this.jsBezier={distanceFromCurve:h,gradientAtPoint:x,gradientAtPointAlongCurveFrom:function(t,e,i){var s=C(t,e,i);return s.location>1&&(s.location=1),s.location<0&&(s.location=0),x(t,s.location)},nearestPointOnCurve:function(t,e){var i=h(t,e);return{point:m(e,e.length-1,i.location,null,null),location:i.location}},pointOnCurve:b,pointAlongCurveFrom:function(t,e,i){return C(t,e,i).point},perpendicularToCurveAt:function(t,e,i,s){var n=C(t,e,s=null==s?0:s),r=x(t,n.location),o=Math.atan(-1/r),a=i/2*Math.sin(o),l=i/2*Math.cos(o);return[{x:n.point.x+l,y:n.point.y+a},{x:n.point.x-l,y:n.point.y-a}]},locationAlongCurveFrom:function(t,e,i){return C(t,e,i).location},getLength:function(t){if(v(t))return 0;for(var e=b(t,0),i=0,s=0,n=null;1>s;)n=b(t,s+=.005),i+=y(n,e),e=n;return i},lineIntersection:_,boxIntersection:function(t,e,i,s,n){var r=[];return r.push.apply(r,_(t,e,t+i,e,n)),r.push.apply(r,_(t+i,e,t+i,e+s,n)),r.push.apply(r,_(t+i,e+s,t,e+s,n)),r.push.apply(r,_(t,e+s,t,e,n)),r},boundingBoxIntersection:function(t,e){var i=[];return i.push.apply(i,_(t.x,t.y,t.x+t.w,t.y,e)),i.push.apply(i,_(t.x+t.w,t.y,t.x+t.w,t.y+t.h,e)),i.push.apply(i,_(t.x+t.w,t.y+t.h,t.x,t.y+t.h,e)),i.push.apply(i,_(t.x,t.y+t.h,t.x,t.y,e)),i},version:"0.9.0"};"undefined"!=typeof exports&&(exports.jsBezier=P)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.Biltong={version:"0.4.0"};"undefined"!=typeof exports&&(exports.Biltong=t);var e=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=function(t,i,s){return s(t=e(t)?t:[t.x,t.y],i=e(i)?i:[i.x,i.y])},s=t.gradient=function(t,e){return i(t,e,(function(t,e){return e[0]==t[0]?e[1]>t[1]?1/0:-1/0:e[1]==t[1]?e[0]>t[0]?0:-0:(e[1]-t[1])/(e[0]-t[0])}))},n=(t.normal=function(t,e){return-1/s(t,e)},t.lineLength=function(t,e){return i(t,e,(function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))}))},t.quadrant=function(t,e){return i(t,e,(function(t,e){return e[0]>t[0]?e[1]>t[1]?2:1:e[0]==t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4}))}),r=(t.theta=function(t,e){return i(t,e,(function(t,e){var i=s(t,e),r=Math.atan(i),o=n(t,e);return(4==o||3==o)&&(r+=Math.PI),0>r&&(r+=2*Math.PI),r}))},t.intersects=function(t,e){var i=t.x,s=t.x+t.w,n=t.y,r=t.y+t.h,o=e.x,a=e.x+e.w,l=e.y,h=e.y+e.h;return o>=i&&s>=o&&l>=n&&r>=l||a>=i&&s>=a&&l>=n&&r>=l||o>=i&&s>=o&&h>=n&&r>=h||a>=i&&s>=o&&h>=n&&r>=h||i>=o&&a>=i&&n>=l&&h>=n||s>=o&&a>=s&&n>=l&&h>=n||i>=o&&a>=i&&r>=l&&h>=r||s>=o&&a>=i&&r>=l&&h>=r},t.encloses=function(t,e,i){var s=t.y,n=t.y+t.h,r=e.y,o=e.y+e.h,a=function(t,e,s,n){return i?e>=t&&s>=n:e>t&&s>n};return a(t.x,e.x,t.x+t.w,e.x+e.w)&&a(s,r,n,o)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),o=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(t,e,i){var a=s(t,e),l=n(t,e),h=i>0?r[l]:o[l],c=Math.atan(a),d=Math.abs(i*Math.sin(c))*h[1],u=Math.abs(i*Math.cos(c))*h[0];return{x:t.x+u,y:t.y+d}},t.perpendicularLineTo=function(t,e,i){var n=s(t,e),r=Math.atan(-1/n),o=i/2*Math.sin(r),a=i/2*Math.cos(r);return[{x:e.x+a,y:e.y+o},{x:e.x-a,y:e.y-o}]}}).call("undefined"!=typeof window?window:this),(function(){"use strict";function t(t,e,i,s,n,r,o,a){return new Touch({target:e,identifier:O(),pageX:i,pageY:s,screenX:n,screenY:r,clientX:o||n,clientY:a||r})}function e(e,i,s,n,r,o,a,l){return function(){var t=[];return Array.prototype.push.apply(t,arguments),t.item=function(t){return this[t]},t}(t.apply(null,arguments))}var i=this,s=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},n=function(t){return"string"==typeof t||t.constructor===String?document.getElementById(t):t},r=function(t){return t.srcElement||t.target},o=function(t,e,i,s){if(s){if(void 0!==t.path&&t.path.indexOf)return{path:t.path,end:t.path.indexOf(i)};var n={path:[],end:-1},r=function(t){n.path.push(t),t===i?n.end=n.path.length-1:null!=t.parentNode&&r(t.parentNode)};return r(e),n}return{path:[e],end:1}},a=function(t,e){for(var i=0,s=t.length;s>i&&t[i]!=e;i++);i<t.length&&t.splice(i,1)},l=1,h=function(t,e,i){var s=l++;return t.__ta=t.__ta||{},t.__ta[e]=t.__ta[e]||{},t.__ta[e][s]=i,i.__tauid=s,s},c=function(t,e,i,n){if(null==t)return i;var a=t.split(","),l=function(n){l.__tauid=i.__tauid;var h=r(n),c=h,d=o(n,h,e,null!=t);if(-1!=d.end)for(var u=0;u<d.end;u++){c=d.path[u];for(var p=0;p<a.length;p++)s(c,a[p],e)&&i.apply(c,arguments)}};return d(i,n,l),l},d=function(t,e,i){t.__taExtra=t.__taExtra||[],t.__taExtra.push([e,i])},u=function(t,e,i,s){if(y&&C[e]){var n=c(s,t,i,C[e]);A(t,C[e],n,i)}"focus"===e&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1"),A(t,e,c(s,t,i,e),i)},p=function(t,e,i,s){null==t.__taSmartClicks&&(u(t,"mousedown",(function(e){t.__tad=S(e)}),s),u(t,"mouseup",(function(e){t.__tau=S(e)}),s),u(t,"click",(function(e){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1])for(var i=0;i<t.__taSmartClicks.length;i++)t.__taSmartClicks[i].apply(r(e),[e])}),s),t.__taSmartClicks=[]),t.__taSmartClicks.push(i),i.__taUnstore=function(){a(t.__taSmartClicks,i)}},f={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},m=function(t,e){return function(i,n,l,h){if("contextmenu"==n&&v)u(i,n,l,h);else{if(null==i.__taTapHandler){var c=i.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},d=function(){c.down=!1},p=function(){c.taps=0};u(i,"mousedown",(function(n){for(var a=r(n),l=o(n,a,i,null!=h),u=!1,f=0;f<l.end;f++){if(u)return;a=l.path[f];for(var m=0;m<c.downSelectors.length;m++)if(null==c.downSelectors[m]||s(a,c.downSelectors[m],i)){c.down=!0,setTimeout(d,t),setTimeout(p,e),u=!0;break}}})),u(i,"mouseup",(function(t){if(c.down){var e,n,a=r(t);c.taps++;var l=k(t);for(var h in f)if(f.hasOwnProperty(h)){var d=f[h];if(d.touches===l&&(1===d.taps||d.taps===c.taps))for(var u=0;u<c[h].length;u++){n=o(t,a,i,null!=c[h][u][1]);for(var p=0;p<n.end;p++)if(e=n.path[p],null==c[h][u][1]||s(e,c[h][u][1],i)){c[h][u][0].apply(e,[t]);break}}}}}))}i.__taTapHandler.downSelectors.push(h),i.__taTapHandler[n].push([l,h]),l.__taUnstore=function(){a(i.__taTapHandler[n],l)}}}},g=function(t,e,i,s){for(var n in i.__tamee[t])i.__tamee[t].hasOwnProperty(n)&&i.__tamee[t][n].apply(s,[e])},b=function(){var t=[];return function(e,i,n,o){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};var a=function(i){var n=r(i);(null==o&&n==e&&!e.__tamee.over||s(n,o,e)&&(null==n.__tamee||!n.__tamee.over))&&(g("mouseenter",i,e,n),n.__tamee=n.__tamee||{},n.__tamee.over=!0,t.push(n))},l=function(i){for(var n=r(i),o=0;o<t.length;o++)n!=t[o]||s(i.relatedTarget||i.toElement,"*",n)||(n.__tamee.over=!1,t.splice(o,1),g("mouseexit",i,e,n))};A(e,"mouseover",c(o,e,a,"mouseover"),a),A(e,"mouseout",c(o,e,l,"mouseout"),l)}n.__taUnstore=function(){delete e.__tamee[i][n.__tauid]},h(e,i,n),e.__tamee[i][n.__tauid]=n}},y="ontouchstart"in document.documentElement,v="onmousedown"in document.documentElement,C={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},x=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),_=x>-1&&9>x,P=function(t,e){if(null==t)return[0,0];var i=E(t),s=w(i,0);return[s[e+"X"],s[e+"Y"]]},S=function(t){return null==t?[0,0]:_?[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]:P(t,"page")},w=function(t,e){return t.item?t.item(e):t[e]},E=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},k=function(t){return E(t).length},A=function(t,e,i,s){if(h(t,e,i),s.__tauid=i.__tauid,t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent){var n=e+i.__tauid;t["e"+n]=i,t[n]=function(){t["e"+n]&&t["e"+n](window.event)},t.attachEvent("on"+e,t[n])}},T=function(t,e,i){null!=i&&M(t,(function(){var s=n(this);if(function(t,e,i){if(t.__ta&&t.__ta[e]&&delete t.__ta[e][i.__tauid],i.__taExtra){for(var s=0;s<i.__taExtra.length;s++)T(t,i.__taExtra[s][0],i.__taExtra[s][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()}(s,e,i),null!=i.__tauid)if(s.removeEventListener)s.removeEventListener(e,i,!1),y&&C[e]&&s.removeEventListener(C[e],i,!1);else if(this.detachEvent){var r=e+i.__tauid;s[r]&&s.detachEvent("on"+e,s[r]),s[r]=null,s["e"+r]=null}i.__taTouchProxy&&T(t,i.__taTouchProxy[1],i.__taTouchProxy[0])}))},M=function(t,e){if(null!=t){t="undefined"!=typeof Window&&"unknown"!=typeof t.top&&t==t.top?[t]:"string"!=typeof t&&null==t.tagName&&null!=t.length?t:"string"==typeof t?document.querySelectorAll(t):[t];for(var i=0;i<t.length;i++)e.apply(t[i])}},O=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))};i.Mottle=function(t){var i=(t=t||{}).clickThreshold||250,s=t.dblClickThreshold||450,r=new b,o=new m(i,s),a=t.smartClicks,l=function(t,e,i,s){null!=i&&M(t,(function(){var t=n(this);a&&"click"===e?p(t,0,i,s):"tap"===e||"dbltap"===e||"contextmenu"===e?o(t,e,i,s):"mouseenter"===e||"mouseexit"==e?r(t,e,i,s):u(t,e,i,s)}))};this.remove=function(t){return M(t,(function(){var t=n(this);if(t.__ta)for(var e in t.__ta)if(t.__ta.hasOwnProperty(e))for(var i in t.__ta[e])t.__ta[e].hasOwnProperty(i)&&T(t,e,t.__ta[e][i]);t.parentNode&&t.parentNode.removeChild(t)})),this},this.on=function(t,e,i,s){var n=arguments[0],r=4==arguments.length?arguments[2]:null,o=arguments[1],a=arguments[arguments.length-1];return l(n,o,a,r),this},this.off=function(t,e,i){return T(t,e,i),this},this.trigger=function(t,i,s,r){var o=v&&("undefined"==typeof MouseEvent||null==s||s.constructor===MouseEvent),a=y&&!v&&C[i]?C[i]:i,l=!(y&&!v&&C[i]),h=S(s),c=function(t){return P(t,"screen")}(s),d=function(t){return P(t,"client")}(s);return M(t,(function(){var t,u=n(this);s=s||{screenX:c[0],screenY:c[1],clientX:d[0],clientY:d[1]};var p=function(t){r&&(t.payload=r)},f={TouchEvent:function(t){var i=e(window,u,0,h[0],h[1],c[0],c[1],d[0],d[1]);(t.initTouchEvent||t.initEvent)(a,!0,!0,window,null,c[0],c[1],d[0],d[1],!1,!1,!1,!1,i,i,i,1,0)},MouseEvents:function(t){t.initMouseEvent(a,!0,!0,window,0,c[0],c[1],d[0],d[1],!1,!1,!1,!1,1,u)}};if(document.createEvent){var m=!l&&!o&&y&&C[i]?"TouchEvent":"MouseEvents";t=document.createEvent(m),f[m](t),p(t),u.dispatchEvent(t)}else document.createEventObject&&((t=document.createEventObject()).eventType=t.eventName=a,t.screenX=c[0],t.screenY=c[1],t.clientX=d[0],t.clientY=d[1],p(t),u.fireEvent("on"+a,t))})),this}},i.Mottle.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},i.Mottle.pageLocation=S,i.Mottle.setForceTouchEvents=function(t){y=t},i.Mottle.setForceMouseEvents=function(t){v=t},i.Mottle.version="0.8.0","undefined"!=typeof exports&&(exports.Mottle=i.Mottle)}).call("undefined"==typeof window?this:window),(function(){"use strict";var t=this,e=function(t,e,i){return-1===t.indexOf(e)&&(i?t.unshift(e):t.push(e),!0)},i=function(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},s=function(t,e){for(var i=[],s=0;s<t.length;s++)-1===e.indexOf(t[s])&&i.push(t[s]);return i},n=function(t){return null!=t&&("string"==typeof t||t.constructor===String)},r=function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,r=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=e.left+r-(s.clientLeft||i.clientLeft||0);return{top:Math.round(e.top+n-(s.clientTop||i.clientTop||0)),left:Math.round(o)}},o=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},a=function(t,e,i){if(o(e,i,t))return e;for(var s=e.parentNode;null!=s&&s!==t;){if(o(s,i,t))return s;s=s.parentNode}},l=function(t,e,i){for(var s=null,n=e.getAttribute("katavorio-draggable"),r=null!=n?"[katavorio-draggable='"+n+"'] ":"",l=0;l<t.length;l++)if(null!=(s=a(e,i,r+t[l].selector))){if(t[l].filter){var h=o(i,t[l].filter,s);if(!0===t[l].filterExclude&&!h||h)return null}return[t[l],s]}return null},h=function(){var t=-1;if("Microsoft Internet Explorer"===navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),c=h>-1&&9>h,d=9===h,u=function(t){if(c)return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop];var e=f(t),i=p(e,0);return d?[i.pageX||i.clientX,i.pageY||i.clientY]:[i.pageX,i.pageY]},p=function(t,e){return t.item?t.item(e):t[e]},f=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},m={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},g=["stop","start","drag","drop","over","out","beforeStart"],b=function(){},y=function(){return!0},v=function(t,e,i){for(var s=0;s<t.length;s++)t[s]!=i&&e(t[s])},C=function(t,e,i,s){v(t,(function(t){t.setActive(e),e&&t.updatePosition(),i&&t.setHover(s,e)}))},x=function(t,e){if(null!=t){t=n(t)||null!=t.tagName||null==t.length?[t]:t;for(var i=0;i<t.length;i++)e.apply(t[i],[t[i]])}},_=function(t){t.stopPropagation?(t.stopPropagation(),t.preventDefault()):t.returnValue=!1},P=function(t,e,i){return!o(t.srcElement||t.target,i.getInputFilterSelector(),e)},S=function(t,e,i,s){this.params=e||{},this.el=t,this.params.addClass(this.el,this._class),this.uuid=T();var n=!0;return this.setEnabled=function(t){n=t},this.isEnabled=function(){return n},this.toggleEnabled=function(){n=!n},this.setScope=function(t){this.scopes=t?t.split(/\s+/):[s]},this.addScope=function(t){var e={};for(var i in x(this.scopes,(function(t){e[t]=!0})),x(t?t.split(/\s+/):[],(function(t){e[t]=!0})),this.scopes=[],e)this.scopes.push(i)},this.removeScope=function(t){var e={};for(var i in x(this.scopes,(function(t){e[t]=!0})),x(t?t.split(/\s+/):[],(function(t){delete e[t]})),this.scopes=[],e)this.scopes.push(i)},this.toggleScope=function(t){var e={};for(var i in x(this.scopes,(function(t){e[t]=!0})),x(t?t.split(/\s+/):[],(function(t){e[t]?delete e[t]:e[t]=!0})),this.scopes=[],e)this.scopes.push(i)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},w=function(){return!0},E=function(){return!1},k=function(t,e,i,s){this._class=i.draggable;var a=S.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var h,c,d,p,f=[0,0],g=null,b=null,v=[0,0],x=!1,k=[0,0],A=!1!==this.params.consumeStartEvent,O=this.el,N=this.params.clone,L=!1!==e.multipleDrop,D=!1,j=!0===e.ghostProxy?w:e.ghostProxy&&"function"==typeof e.ghostProxy?e.ghostProxy:E,I=function(t){return t.cloneNode(!0)},R=null,B=[],F=null,Y=e.ghostProxyParent;if(e.selector){var z=t.getAttribute("katavorio-draggable");null==z&&(z=""+(new Date).getTime(),t.setAttribute("katavorio-draggable",z)),B.push(e)}var X=e.snapThreshold,U=function(t,e,i,s,n){var r=e*Math.floor(t[0]/e),o=r+e,a=Math.abs(t[0]-r)<=s?r:Math.abs(o-t[0])<=s?o:t[0],l=i*Math.floor(t[1]/i),h=l+i;return[a,Math.abs(t[1]-l)<=n?l:Math.abs(h-t[1])<=n?h:t[1]]};this.posses=[],this.posseRoles={},this.toGrid=function(t){return null==this.params.grid?t:U(t,this.params.grid[0],this.params.grid[1],this.params.grid?this.params.grid[0]/2:X||5,this.params.grid?this.params.grid[1]/2:X||5)},this.snap=function(t,e){if(null!=O){t=t||(this.params.grid?this.params.grid[0]:10),e=e||(this.params.grid?this.params.grid[1]:10);var i=this.params.getPosition(O),s=U(i,t,e,this.params.grid?this.params.grid[0]/2:X,this.params.grid?this.params.grid[1]/2:X);return this.params.setPosition(O,s),s}},this.setUseGhostProxy=function(t){j=t?w:E};var G,H,q=function(t){return!1===e.allowNegative?[Math.max(0,t[0]),Math.max(0,t[1])]:t},J=(function(t){G="function"==typeof t?t:t?(function(t,e,i,s){return q([Math.max(0,Math.min(i.w-s[0],t[0])),Math.max(0,Math.min(i.h-s[1],t[1]))])}).bind(this):function(t){return q(t)}}).bind(this);J("function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(t){J(t)},this.setRevert=function(t){H=t},this.params.revert&&(H=this.params.revert);var V=function(t){return"function"==typeof t?(t._katavorioId=T(),t._katavorioId):t},$={},W=function(t){for(var e in $){var i=$[e],s=i[0](t);if(i[1]&&(s=!s),!s)return!1}return!0},K=this.setFilter=function(e,i){if(e){var s=V(e);$[s]=[function(i){var s,r=i.srcElement||i.target;return n(e)?s=o(r,e,t):"function"==typeof e&&(s=e(i,t)),s},!1!==i]}};this.addFilter=K,this.removeFilter=function(t){delete $["function"==typeof t?t._katavorioId:t]},this.clearAllFilters=function(){$={}},this.canDrag=this.params.canDrag||y;var Z,Q=[],tt=[];this.addSelector=function(t){t.selector&&B.push(t)},this.downListener=(function(t){if(!t.defaultPrevented&&(this.rightButtonCanDrag||3!==t.which&&2!==t.button)&&this.isEnabled()&&this.canDrag())if(W(t)&&P(t,this.el,this.k)){if(F=null,R=null,B.length>0){var e=l(B,this.el,t.target||t.srcElement);if(null!=e&&(F=e[0],R=e[1]),null==R)return}else R=this.el;if(N)if(O=R.cloneNode(!0),this.params.addClass(O,m.clonedDrag),O.setAttribute("id",null),O.style.position="absolute",null!=this.params.parent){var s=this.params.getPosition(this.el);O.style.left=s[0]+"px",O.style.top=s[1]+"px",this.params.parent.appendChild(O)}else{var n=r(R);O.style.left=n.left+"px",O.style.top=n.top+"px",document.body.appendChild(O)}else O=R;A&&_(t),f=u(t),O&&O.parentNode&&(k=[O.parentNode.scrollLeft,O.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),a.markSelection(this),a.markPosses(this),this.params.addClass(document.body,i.noSelect),st("beforeStart",{el:this.el,pos:g,e:t,drag:this})}else this.params.consumeFilteredEvents&&_(t)}).bind(this),this.moveListener=(function(t){if(f){if(!x)if(!1!==st("start",{el:this.el,pos:g,e:t,drag:this})){if(!f)return;this.mark(!0),x=!0}else this.abort();if(f){tt.length=0;var e=u(t),i=e[0]-f[0],s=e[1]-f[1],n=this.params.ignoreZoom?1:a.getZoom();O&&O.parentNode&&(i+=O.parentNode.scrollLeft-k[0],s+=O.parentNode.scrollTop-k[1]),this.moveBy(i/=n,s/=n,t),a.updateSelection(i,s,this),a.updatePosses(i,s,this)}}}).bind(this),this.upListener=(function(t){f&&(f=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(t),a.unmarkSelection(this,t),a.unmarkPosses(this,t),this.stop(t),a.notifyPosseDragStop(this,t),x=!1,tt.length=0,N?(O&&O.parentNode&&O.parentNode.removeChild(O),O=null):H&&!0===H(O,this.params.getPosition(O))&&(this.params.setPosition(O,g),st("revert",O)))}).bind(this),this.getFilters=function(){return $},this.abort=function(){null!=f&&this.upListener()},this.getDragElement=function(t){return t?R||this.el:O||this.el};var et={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&et.start.push(e.events.start),e.events.beforeStart&&et.beforeStart.push(e.events.beforeStart),e.events.stop&&et.stop.push(e.events.stop),e.events.drag&&et.drag.push(e.events.drag),e.events.revert&&et.revert.push(e.events.revert),this.on=function(t,e){et[t]&&et[t].push(e)},this.off=function(t,e){if(et[t]){for(var i=[],s=0;s<et[t].length;s++)et[t][s]!==e&&i.push(et[t][s]);et[t]=i}};var it,st=function(t,e){var i=null;if(F&&F[t])i=F[t](e);else if(et[t])for(var s=0;s<et[t].length;s++)try{var n=et[t][s](e);null!=n&&(i=n)}catch(r){}return i};this.notifyStart=function(t){st("start",{el:this.el,pos:this.params.getPosition(O),e:t,drag:this})},this.stop=function(t,e){if(e||x){var i=[],s=a.getSelection(),n=this.params.getPosition(O);if(s.length>0)for(var r=0;r<s.length;r++){var o=this.params.getPosition(s[r].el);i.push([s[r].el,{left:o[0],top:o[1]},s[r]])}else i.push([O,{left:n[0],top:n[1]},this]);st("stop",{el:O,pos:it||n,finalPos:n,e:t,drag:this,selection:i})}},this.mark=function(t){var e;g=this.params.getPosition(O),b=this.params.getPosition(O,!0),v=[b[0]-g[0],b[1]-g[1]],this.size=this.params.getSize(O),Q=a.getMatchingDroppables(this),C(Q,!0,!1,this),this.params.addClass(O,this.params.dragClass||i.drag),e=this.params.getConstrainingRectangle?this.params.getConstrainingRectangle(O):this.params.getSize(O.parentNode),Z={w:e[0],h:e[1]},d=0,p=0,t&&a.notifySelectionDragStart(this)},this.unmark=function(t,s){if(C(Q,!1,!0,this),D&&j(R,O)?(it=[O.offsetLeft-d,O.offsetTop-p],O.parentNode.removeChild(O),O=R):it=null,this.params.removeClass(O,this.params.dragClass||i.drag),Q.length=0,D=!1,!s){tt.length>0&&it&&e.setPosition(R,it),tt.sort(M);for(var n=0;n<tt.length&&!0!==tt[n].drop(this,t);n++);}},this.moveBy=function(t,i,s){tt.length=0;var n=this.toGrid([g[0]+t,g[1]+i]),r=G(n,O,Z,this.size);if(j(this.el,O))if(n[0]!==r[0]||n[1]!==r[1]){if(!D){var o=I(R);e.addClass(o,m.ghostProxy),Y?(Y.appendChild(o),h=e.getPosition(R.parentNode,!0),c=e.getPosition(e.ghostProxyParent,!0),d=h[0]-c[0],p=h[1]-c[1]):R.parentNode.appendChild(o),O=o,D=!0}r=n}else D&&(O.parentNode.removeChild(O),O=R,D=!1,h=null,c=null,d=0,p=0);var a={x:r[0],y:r[1],w:this.size[0],h:this.size[1]},l={x:a.x+v[0],y:a.y+v[1],w:a.w,h:a.h},u=null;this.params.setPosition(O,[r[0]+d,r[1]+p]);for(var f=0;f<Q.length;f++)this.params.intersects(l,{x:Q[f].pagePosition[0],y:Q[f].pagePosition[1],w:Q[f].size[0],h:Q[f].size[1]})&&(L||null==u||u===Q[f].el)&&Q[f].canDrop(this)?(u||(u=Q[f].el),tt.push(Q[f]),Q[f].setHover(this,!0,s)):Q[f].isHover()&&Q[f].setHover(this,!1,s);st("drag",{el:this.el,pos:r,e:s,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?K(this.params.handle,!1):K(this.params.filter,this.params.filterExclude)},A=function(t,e,i,s){this._class=i.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||i.active,this._hoverClass=this.params.hoverClass||i.hover,S.apply(this,arguments);var n=!1;this.allowLoopback=!1!==this.params.allowLoopback,this.setActive=function(t){this.params[t?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(t){return!0},this.isHover=function(){return n},this.setHover=function(t,e,i){(e||null==this.el._katavorioDragHover||this.el._katavorioDragHover===t.el._katavorio)&&(this.params[e?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=e?t.el._katavorio:null,n!==e&&this.params.events[e?"over":"out"]({el:this.el,e:i,drag:t,drop:this}),n=e)},this.drop=function(t,e){return this.params.events.drop({drag:t,e:e,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,n=null}},T=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},M=function(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:0},O=function(t){return null==t?null:null==(t="string"==typeof t||t.constructor===String?document.getElementById(t):t)?null:(t._katavorio=t._katavorio||T(),t)};t.Katavorio=function(t){var r=[],o={};this._dragsByScope={},this._dropsByScope={};var a=1,l=function(t,e){x(t,(function(t){for(var i=0;i<t.scopes.length;i++)e[t.scopes[i]]=e[t.scopes[i]]||[],e[t.scopes[i]].push(t)}))},h=function(e,i){var s=0;return x(e,(function(e){for(var n=0;n<e.scopes.length;n++)if(i[e.scopes[n]]){var r=t.indexOf(i[e.scopes[n]],e);-1!==r&&(i[e.scopes[n]].splice(r,1),s++)}})),s>0},c=(this.getMatchingDroppables=function(t){for(var e=[],i={},s=0;s<t.scopes.length;s++){var n=this._dropsByScope[t.scopes[s]];if(n)for(var r=0;r<n.length;r++)!n[r].canDrop(t)||i[n[r].uuid]||!n[r].allowLoopback&&n[r].el===t.el||(i[n[r].uuid]=!0,e.push(n[r]))}return e.sort(M),e},(function(e){e=e||{};var i,s={events:{}};for(i in t)s[i]=t[i];for(i in e)s[i]=e[i];for(i=0;i<g.length;i++)s.events[g[i]]=e[g[i]]||b;return s.katavorio=this,s}).bind(this)),d=(function(t,e){for(var i=0;i<g.length;i++)e[g[i]]&&t.on(g[i],e[g[i]])}).bind(this),u={},p=t.css||{},f=t.scope||"katavorio-drag-scope";for(var y in m)u[y]=m[y];for(var y in p)u[y]=p[y];var C=t.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return C},this.setInputFilterSelector=function(t){return C=t,this},this.draggable=function(e,i){var s=[];return x(e,(function(e){if(null!=(e=O(e)))if(null==e._katavorioDrag){var n=c(i);e._katavorioDrag=new k(e,n,u,f),l(e._katavorioDrag,this._dragsByScope),s.push(e._katavorioDrag),t.addClass(e,n.selector?u.delegatedDraggable:u.draggable)}else d(e._katavorioDrag,i)}).bind(this)),s},this.droppable=function(e,i){var s=[];return x(e,(function(e){if(null!=(e=O(e))){var n=new A(e,c(i),u,f);e._katavorioDrop=e._katavorioDrop||[],e._katavorioDrop.push(n),l(n,this._dropsByScope),s.push(n),t.addClass(e,u.droppable)}}).bind(this)),s},this.select=function(e){return x(e,(function(){var e=O(this);e&&e._katavorioDrag&&(o[e._katavorio]||(r.push(e._katavorioDrag),o[e._katavorio]=[e,r.length-1],t.addClass(e,u.selected)))})),this},this.deselect=function(e){return x(e,(function(){var e=O(this);if(e&&e._katavorio&&o[e._katavorio]){for(var i=[],s=0;s<r.length;s++)r[s].el!==e&&i.push(r[s]);r=i,delete o[e._katavorio],t.removeClass(e,u.selected)}})),this},this.deselectAll=function(){for(var e in o)t.removeClass(o[e][0],u.selected);r.length=0,o={}},this.markSelection=function(t){v(r,(function(t){t.mark()}),t)},this.markPosses=function(t){t.posses&&x(t.posses,(function(e){t.posseRoles[e]&&E[e]&&v(E[e].members,(function(t){t.mark()}),t)}))},this.unmarkSelection=function(t,e){v(r,(function(t){t.unmark(e)}),t)},this.unmarkPosses=function(t,e){t.posses&&x(t.posses,(function(i){t.posseRoles[i]&&E[i]&&v(E[i].members,(function(t){t.unmark(e,!0)}),t)}))},this.getSelection=function(){return r.slice(0)},this.updateSelection=function(t,e,i){v(r,(function(i){i.moveBy(t,e)}),i)};var _=function(t,e){e.posses&&x(e.posses,(function(i){e.posseRoles[i]&&E[i]&&v(E[i].members,(function(e){t(e)}),e)}))};this.updatePosses=function(t,e,i){_((function(i){i.moveBy(t,e)}),i)},this.notifyPosseDragStop=function(t,e){_((function(t){t.stop(e,!0)}),t)},this.notifySelectionDragStop=function(t,e){v(r,(function(t){t.stop(e,!0)}),t)},this.notifySelectionDragStart=function(t,e){v(r,(function(t){t.notifyStart(e)}),t)},this.setZoom=function(t){a=t},this.getZoom=function(){return a};var P=function(t,e,i,s){x(t,(function(t){h(t,i),t[s](e),l(t,i)}))};x(["set","add","remove","toggle"],(function(t){this[t+"Scope"]=(function(e,i){P(e._katavorioDrag,i,this._dragsByScope,t+"Scope"),P(e._katavorioDrop,i,this._dropsByScope,t+"Scope")}).bind(this),this[t+"DragScope"]=(function(e,i){P(e.constructor===k?e:e._katavorioDrag,i,this._dragsByScope,t+"Scope")}).bind(this),this[t+"DropScope"]=(function(e,i){P(e.constructor===A?e:e._katavorioDrop,i,this._dropsByScope,t+"Scope")}).bind(this)}).bind(this)),this.snapToGrid=function(t,e){for(var i in this._dragsByScope)v(this._dragsByScope[i],(function(i){i.snap(t,e)}))},this.getDragsForScope=function(t){return this._dragsByScope[t]},this.getDropsForScope=function(t){return this._dropsByScope[t]};var S=function(t,e,i){if((t=O(t))[e]){var s=r.indexOf(t[e]);s>=0&&r.splice(s,1),h(t[e],i)&&x(t[e],(function(t){t.destroy()})),delete t[e]}},w=function(t,e,i,s){(t=O(t))[e]&&t[e].off(i,s)};this.elementRemoved=function(t){this.destroyDraggable(t),this.destroyDroppable(t)},this.destroyDraggable=function(t,e,i){1===arguments.length?S(t,"_katavorioDrag",this._dragsByScope):w(t,"_katavorioDrag",e,i)},this.destroyDroppable=function(t,e,i){1===arguments.length?S(t,"_katavorioDrop",this._dropsByScope):w(t,"_katavorioDrop",e,i)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},r=[],o={},E={}};var E={},T=function(t,i,s){var r=n(i)?i:i.id,o=!!n(i)||!1!==i.active,a=E[r]||function(){var t={name:r,members:[]};return E[r]=t,t}();return x(t,(function(t){if(t._katavorioDrag){if(s&&null!=t._katavorioDrag.posseRoles[a.name])return;e(a.members,t._katavorioDrag),e(t._katavorioDrag.posses,a.name),t._katavorioDrag.posseRoles[a.name]=o}})),a};this.addToPosse=function(t,e){for(var i=[],s=1;s<arguments.length;s++)i.push(T(t,arguments[s]));return 1===i.length?i[0]:i},this.setPosse=function(t,e){for(var i=[],n=1;n<arguments.length;n++)i.push(T(t,arguments[n],!0).name);return x(t,(function(t){if(t._katavorioDrag){var e=s(t._katavorioDrag.posses,i);Array.prototype.push.apply([],t._katavorioDrag.posses);for(var n=0;n<e.length;n++)this.removeFromPosse(t,e[n])}}).bind(this)),1===i.length?i[0]:i},this.removeFromPosse=function(t,e){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var s=1;s<arguments.length;s++)e=arguments[s],x(t,(function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var s=t._katavorioDrag;x(e,(function(t){i(E[t].members,s),i(s.posses,t),delete s.posseRoles[t]}))}}))},this.removeFromAllPosses=function(t){x(t,(function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var e=t._katavorioDrag;x(e.posses,(function(t){i(E[t].members,e)})),e.posses.length=0,e.posseRoles={}}}))},this.setPosseState=function(t,e,i){var s=E[e];s&&x(t,(function(t){t._katavorioDrag&&t._katavorioDrag.posses&&(t._katavorioDrag.posseRoles[s.name]=i)}))}},t.Katavorio.version="1.0.0","undefined"!=typeof exports&&(exports.Katavorio=t.Katavorio)}).call("undefined"!=typeof window?window:this),(function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(t){return"string"==typeof t}function i(t){return"boolean"==typeof t}function s(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function n(t){return"[object Date]"===Object.prototype.toString.call(t)}function r(t){return"[object Function]"===Object.prototype.toString.call(t)}function o(a){if(e(a))return""+a;if(i(a))return!!a;if(n(a))return new Date(a.getTime());if(r(a))return a;if(t(a)){for(var l=[],h=0;h<a.length;h++)l.push(o(a[h]));return l}if(s(a)){var c={};for(var d in a)c[d]=o(a[d]);return c}return a}function a(n,r,a,l){var h,c,d={},u={};for(a=a||[],l=l||[],c=0;c<a.length;c++)d[a[c]]=!0;for(c=0;c<l.length;c++)u[l[c]]=!0;var p=o(n);for(c in r)if(null==p[c]||u[c])p[c]=r[c];else if(e(r[c])||i(r[c]))d[c]?((h=[]).push.apply(h,t(p[c])?p[c]:[p[c]]),h.push.apply(h,i(r[c])?r[c]:[r[c]]),p[c]=h):p[c]=r[c];else if(t(r[c]))h=[],t(p[c])&&h.push.apply(h,p[c]),h.push.apply(h,r[c]),p[c]=h;else if(s(r[c]))for(var f in s(p[c])||(p[c]={}),r[c])p[c][f]=r[c][f];return p}function l(t,e){if(t)for(var i=0;i<t.length;i++)if(e(t[i]))return i;return-1}function h(t,e){var i=t.indexOf(e);return i>-1&&t.splice(i,1),-1!==i}function c(t,e,i,s){var n=t[e];return null==n&&(t[e]=n=[]),n[s?"unshift":"push"](i),n}function d(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(f.logEnabled&&"undefined"!=typeof console)try{console.log(arguments[arguments.length-1])}catch(i){}}var p=this;p.jsPlumbUtil=p.jsPlumbUtil||{};var f=p.jsPlumbUtil;"undefined"!=typeof exports&&(exports.jsPlumbUtil=f),f.isArray=t,f.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},f.isString=e,f.isBoolean=i,f.isNull=function(t){return null==t},f.isObject=s,f.isDate=n,f.isFunction=r,f.isNamedFunction=function(t){return r(t)&&null!=t.name&&t.name.length>0},f.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},f.clone=o,f.merge=a,f.replace=function(t,e,i){if(null!=t){var s=t;return e.replace(/([^\.])+/g,(function(t,e,n,r){var o=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),a=function(){return s[o[1]]||(s[o[1]]=[],s[o[1]])};if(n+t.length>=r.length)o?a()[o[3]]=i:s[t]=i;else if(o){var l=a();s=l[o[3]]||(l[o[3]]={},l[o[3]])}else s=s[t]||(s[t]={},s[t]);return""})),t}},f.functionChain=function(t,e,i){for(var s=0;s<i.length;s++){var n=i[s][0][i[s][1]].apply(i[s][0],i[s][2]);if(n===e)return n}return t},f.populate=function(i,n,o,a){var l=function(i){if(null!=i){if(e(i))return function(t){var e=t.match(/(\${.*?})/g);if(null!=e)for(var i=0;i<e.length;i++){var s=n[e[i].substring(2,e[i].length-1)]||"";null!=s&&(t=t.replace(e[i],s))}return t}(i);if(!r(i)||a||null!=o&&0!==(i.name||"").indexOf(o)){if(t(i)){for(var h=[],c=0;c<i.length;c++)h.push(l(i[c]));return h}if(s(i)){var d={};for(var u in i)d[u]=l(i[u]);return d}return i}return i(n)}};return l(i)},f.findWithFunction=l,f.removeWithFunction=function(t,e){var i=l(t,e);return i>-1&&t.splice(i,1),-1!==i},f.remove=h,f.addWithFunction=function(t,e,i){-1===l(t,i)&&t.push(e)},f.addToList=c,f.suggest=function(t,e,i){return-1===t.indexOf(e)&&(i?t.unshift(e):t.push(e),!0)},f.extend=function(e,i,s){var n;i=t(i)?i:[i];var r=function(t){for(var i=t.__proto__;null!=i;)if(null!=i.prototype){for(var s in i.prototype)i.prototype.hasOwnProperty(s)&&!e.prototype.hasOwnProperty(s)&&(e.prototype[s]=i.prototype[s]);i=i.prototype.__proto__}else i=null};for(n=0;n<i.length;n++){for(var o in i[n].prototype)i[n].prototype.hasOwnProperty(o)&&!e.prototype.hasOwnProperty(o)&&(e.prototype[o]=i[n].prototype[o]);r(i[n])}var a=function(t,e){return function(){for(n=0;n<i.length;n++)i[n].prototype[t]&&i[n].prototype[t].apply(this,arguments);return e.apply(this,arguments)}},l=function(t){for(var i in t)e.prototype[i]=a(i,t[i])};if(arguments.length>2)for(n=2;n<arguments.length;n++)l(arguments[n]);return e},f.uuid=d,f.fastTrim=function(t){if(null==t)return null;for(var e=t.replace(/^\s\s*/,""),i=/\s/,s=e.length;i.test(e.charAt(--s)););return e.slice(0,s+1)},f.each=function(t,e){t=null==t.length||"string"==typeof t?[t]:t;for(var i=0;i<t.length;i++)e(t[i])},f.map=function(t,e){for(var i=[],s=0;s<t.length;s++)i.push(e(t[s]));return i},f.mergeWithParents=function(t,e,i){i=i||"parent";var s=function(t){return t?e[t]:null},n=function(t){return t?s(t[i]):null},r=function(t,e){if(null==t)return e;var i=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];"override"===e.mergeStrategy&&Array.prototype.push.apply(i,["events","overlays"]);var s=a(t,e,[],i);return r(n(t),s)},o=function(t){if(null==t)return{};if("string"==typeof t)return s(t);if(t.length){for(var e=!1,i=0,n=void 0;!e&&i<t.length;)(n=o(t[i]))?e=!0:i++;return n}},l=o(t);return l?r(n(l),l):{}},f.logEnabled=!0,f.log=u,f.wrap=function(t,e,i){return function(){var s=null;try{null!=e&&(s=e.apply(this,arguments))}catch(n){u("jsPlumb function failed : "+n)}if(null!=t&&(null==i||s!==i))try{s=t.apply(this,arguments)}catch(n){u("wrapped function failed : "+n)}return s}},f.EventGenerator=function(){var t=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(e,i,s){var n=function(e){c(t._listeners,e,i,s),i.__jsPlumb=i.__jsPlumb||{},i.__jsPlumb[d()]=e};if("string"==typeof e)n(e);else if(null!=e.length)for(var r=0;r<e.length;r++)n(e[r]);return t},this.fire=function(t,e,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[t]){var s=this._listeners[t].length,n=0,o=!1,a=null;if(!this.shouldFireEvent||this.shouldFireEvent(t,e,i))for(;!o&&s>n&&!1!==a;){if(this.eventsToDieOn[t])this._listeners[t][n].apply(this,[e,i]);else try{a=this._listeners[t][n].apply(this,[e,i])}catch(r){u("jsPlumb: fire failed for event "+t+" : "+r)}n++,(null==this._listeners||null==this._listeners[t])&&(o=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var e=t.queue.pop();e&&t.fire.apply(t,e)},this.unbind=function(t,e){if(0===arguments.length)this._listeners={};else if(1===arguments.length){if("string"==typeof t)delete this._listeners[t];else if(t.__jsPlumb)for(var i in t.__jsPlumb)h(this._listeners[t.__jsPlumb[i]]||[],t)}else 2===arguments.length&&h(this._listeners[t]||[],e);return this},this.getListener=function(e){return t._listeners[e]},this.setSuspendEvents=function(e){t.eventsSuspended=e},this.isSuspendEvents=function(){return t.eventsSuspended},this.silently=function(i){t.setSuspendEvents(!0);try{i()}catch(e){u("Cannot execute silent function "+e)}t.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var e in t._listeners)t._listeners[e]=null}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this;t.jsPlumbUtil.matchesSelector=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},t.jsPlumbUtil.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},t.jsPlumbUtil.sizeElement=function(t,e,i,s,n){t&&(t.style.height=n+"px",t.height=n,t.style.width=s+"px",t.width=s,t.style.left=e+"px",t.style.top=i+"px")}}).call("undefined"!=typeof window?window:this),(function(){var t={deriveAnchor:function(t,e,i,s){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[t][e]}},e=function(t){this.count=0,this.instance=t,this.lists={},this.instance.addList=function(t,e){return this.listManager.addList(t,e)},this.instance.removeList=function(t){this.listManager.removeList(t)},this.instance.bind("manageElement",(function(t){for(var e=this.instance.getSelector(t.el,"[jtk-scrollable-list]"),i=0;i<e.length;i++)this.addList(e[i])}).bind(this)),this.instance.bind("unmanageElement",(function(t){this.removeList(t.el)})),this.instance.bind("connection",(function(t,e){null==e&&(this._maybeUpdateParentList(t.source),this._maybeUpdateParentList(t.target))}).bind(this))};this.jsPlumbListManager=e,e.prototype={addList:function(e,s){var n=this.instance.extend({},t);s=this.instance.extend(n,s||{});var r=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[r]=new i(this.instance,e,s,r)},removeList:function(t){var e=this.lists[t._jsPlumbList];e&&(e.destroy(),delete this.lists[t._jsPlumbList])},_maybeUpdateParentList:function(t){for(var e=t.parentNode,i=this.instance.getContainer();null!=e&&e!==i;){if(null!=e._jsPlumbList&&null!=this.lists[e._jsPlumbList])return void e._jsPlumbScrollHandler();e=e.parentNode}}};var i=function(t,e,i,s){function n(t,e,s,n){return i.anchor?i.anchor:i.deriveAnchor(t,e,s,n)}function r(t,e,s,n){return i.deriveEndpoint?i.deriveEndpoint(t,e,s,n):i.endpoint?i.endpoint:s.type}e._jsPlumbList=s;var o=function(i){for(var s=t.getSelector(e,".jtk-managed"),o=t.getId(e),a=0;a<s.length;a++){if(s[a].offsetTop<e.scrollTop)s[a]._jsPlumbProxies||(s[a]._jsPlumbProxies=s[a]._jsPlumbProxies||[],t.select({source:s[a]}).each((function(i){t.proxyConnection(i,0,e,o,(function(){return r("top",0,i.endpoints[0],i)}),(function(){return n("top",0,i.endpoints[0],i)})),s[a]._jsPlumbProxies.push([i,0])})),t.select({target:s[a]}).each((function(i){t.proxyConnection(i,1,e,o,(function(){return r("top",1,i.endpoints[1],i)}),(function(){return n("top",1,i.endpoints[1],i)})),s[a]._jsPlumbProxies.push([i,1])})));else if(s[a].offsetTop>e.scrollTop+e.offsetHeight)s[a]._jsPlumbProxies||(s[a]._jsPlumbProxies=s[a]._jsPlumbProxies||[],t.select({source:s[a]}).each((function(i){t.proxyConnection(i,0,e,o,(function(){return r("bottom",0,i.endpoints[0],i)}),(function(){return n("bottom",0,i.endpoints[0],i)})),s[a]._jsPlumbProxies.push([i,0])})),t.select({target:s[a]}).each((function(i){t.proxyConnection(i,1,e,o,(function(){return r("bottom",1,i.endpoints[1],i)}),(function(){return n("bottom",1,i.endpoints[1],i)})),s[a]._jsPlumbProxies.push([i,1])})));else if(s[a]._jsPlumbProxies){for(var l=0;l<s[a]._jsPlumbProxies.length;l++)t.unproxyConnection(s[a]._jsPlumbProxies[l][0],s[a]._jsPlumbProxies[l][1],o);delete s[a]._jsPlumbProxies}t.revalidate(s[a])}!function(e){for(var i=e.parentNode,s=t.getContainer();null!=i&&i!==s;){if(t.hasClass(i,"jtk-managed"))return void t.recalculateOffsets(i);i=i.parentNode}}(e)};t.setAttribute(e,"jtk-scrollable-list","true"),e._jsPlumbScrollHandler=o,t.on(e,"scroll",o),o(),this.destroy=function(){t.off(e,"scroll",o),delete e._jsPlumbScrollHandler;for(var i=t.getSelector(e,".jtk-managed"),s=t.getId(e),n=0;n<i.length;n++)if(i[n]._jsPlumbProxies){for(var r=0;r<i[n]._jsPlumbProxies.length;r++)t.unproxyConnection(i[n]._jsPlumbProxies[r][0],i[n]._jsPlumbProxies[r][1],s);delete i[n]._jsPlumbProxies}}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=function(){return""+(new Date).getTime()},s=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var e={};p.extend(e,t._jsPlumb.paintStyle),p.extend(e,t._jsPlumb.hoverPaintStyle),delete t._jsPlumb.hoverPaintStyle,e.gradient&&t._jsPlumb.paintStyle.fill&&delete e.gradient,t._jsPlumb.hoverPaintStyle=e}},n=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],r=function(t){return null==t?null:t.split(" ")},o=function(t,e,i){for(var s in e)t[s]=i},a=function(t,i,s){if(t.getDefaultType){var n=t.getTypeDescriptor(),r={},a=t.getDefaultType(),l=e.merge({},a);o(r,a,"__default");for(var h=0,c=t._jsPlumb.types.length;c>h;h++){var d=t._jsPlumb.types[h];if("__default"!==d){var u=t._jsPlumb.instance.getType(d,n);if(null!=u){var p=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],f=[];"override"===u.mergeStrategy?Array.prototype.push.apply(p,["events","overlays","cssClass"]):f.push("cssClass"),l=e.merge(l,u,f,p),o(r,u,d)}}}i&&(l=e.populate(l,i,"_")),t.applyType(l,s,r),s||t.repaint()}},l=t.jsPlumbUIComponent=function(t){e.EventGenerator.apply(this,arguments);var i=this,s=arguments,n=i.idPrefix,r=n+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(t,e,i){this._jsPlumb.typeCache[i]=this._jsPlumb.typeCache[i]||{},this._jsPlumb.typeCache[i][t]=e},this.getCachedTypeItem=function(t,e){return this._jsPlumb.typeCache[e]?this._jsPlumb.typeCache[e][t]:null},this.getId=function(){return r};var o=t.overlays||[],a={};if(this.defaultOverlayKeys){for(var l=0;l<this.defaultOverlayKeys.length;l++)Array.prototype.push.apply(o,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[l]]||[]);for(l=0;l<o.length;l++){var h=p.convertToFullOverlaySpec(o[l]);a[h[1].id]=h}}var c={overlays:a,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return c},this.appendToDefaultType=function(t){for(var e in t)c[e]=t[e]},t.events)for(var d in t.events)i.bind(d,t.events[d]);this.clone=(function(){var t=Object.create(this.constructor.prototype);return this.constructor.apply(t,s),t}).bind(this),this.isDetachAllowed=function(t){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(t)}catch(s){e.log("jsPlumb: beforeDetach callback failed",s)}return i},this.isDropAllowed=function(t,i,s,n,r,o,a){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:i,scope:s,connection:n,dropEndpoint:r,source:o,target:a});if(this._jsPlumb.beforeDrop)try{l=this._jsPlumb.beforeDrop({sourceId:t,targetId:i,scope:s,connection:n,dropEndpoint:r,source:o,target:a})}catch(h){e.log("jsPlumb: beforeDrop callback failed",h)}return l};var u=[];this.setListenerComponent=function(t){for(var e=0;e<u.length;e++)u[e][3]=t}},h=function(t,e){var i=t._jsPlumb.instance.getType(t._jsPlumb.types[e],t.getTypeDescriptor());null!=i&&i.cssClass&&t.canvas&&t._jsPlumb.instance.removeClass(t.canvas,i.cssClass)};e.extend(t.jsPlumbUIComponent,e.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,e){this._jsPlumb.parameters[t]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},getClass:function(){return p.getClass(this.canvas)},hasClass:function(t){return p.hasClass(this.canvas,t)},addClass:function(t){p.addClass(this.canvas,t)},removeClass:function(t){p.removeClass(this.canvas,t)},updateClasses:function(t,e){p.updateClasses(this.canvas,t,e)},setType:function(t,e,i){this.clearTypes(),this._jsPlumb.types=r(t)||[],a(this,e,i)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,e){a(this,t,e)},hasType:function(t){return-1!==this._jsPlumb.types.indexOf(t)},addType:function(t,e,i){var s=r(t),n=!1;if(null!=s){for(var o=0,l=s.length;l>o;o++)this.hasType(s[o])||(this._jsPlumb.types.push(s[o]),n=!0);n&&a(this,e,i)}},removeType:function(t,e,i){var s=r(t),n=!1,o=(function(t){var e=this._jsPlumb.types.indexOf(t);return-1!==e&&(h(this,e),this._jsPlumb.types.splice(e,1),!0)}).bind(this);if(null!=s){for(var l=0,c=s.length;c>l;l++)n=o(s[l])||n;n&&a(this,e,i)}},clearTypes:function(t,e){for(var i=this._jsPlumb.types.length,s=0;i>s;s++)h(this,0),this._jsPlumb.types.splice(0,1);a(this,t,e)},toggleType:function(t,e,i){var s=r(t);if(null!=s){for(var n=0,o=s.length;o>n;n++){var l=this._jsPlumb.types.indexOf(s[n]);-1!==l?(h(this,l),this._jsPlumb.types.splice(l,1)):this._jsPlumb.types.push(s[n])}a(this,e,i)}},applyType:function(t,e){if(this.setPaintStyle(t.paintStyle,e),this.setHoverPaintStyle(t.hoverPaintStyle,e),t.parameters)for(var i in t.parameters)this.setParameter(i,t.parameters[i]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(t,e){this._jsPlumb.paintStyle=t,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,s(this),e||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,e){this._jsPlumb.hoverPaintStyle=t,s(this),e||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(t){(t||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(t,e,s){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=t;var n=t?"addClass":"removeClass";null!=this.canvas&&(null!=this._jsPlumb.instance.hoverClass&&this._jsPlumb.instance[n](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[n](this.canvas,this._jsPlumb.hoverClass)),null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(s=s||i(),this.repaint({timestamp:s,recalc:!1}))),this.getAttachedElements&&!e&&function(t,e,i,s){var n=t.getAttachedElements();if(n)for(var r=0,o=n.length;o>r;r++)s&&s===n[r]||n[r].setHover(e,!0,i)}(this,t,i(),this)}}});var c=0,d=function(){var t=c+1;return c++,t},u=t.jsPlumbInstance=function(s){this.version="2.12.0",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},s&&p.extend(this.Defaults,s),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},e.EventGenerator.apply(this);var r=this,o=d(),a=r.bind,h={},c=1,u=function(t){if(null==t)return null;if(3===t.nodeType||8===t.nodeType)return{el:t,text:!0};var i=r.getElement(t);return{el:i,id:e.isString(t)&&null==i?t:z(i)}};for(var f in this.getInstanceIndex=function(){return o},this.setZoom=function(t,e){return r.fire("zoom",c=t),e&&r.repaintEverything(),!0},this.getZoom=function(){return c},this.Defaults)h[f]=this.Defaults[f];var m,g=[];this.unbindContainer=function(){if(null!=m&&g.length>0)for(var t=0;t<g.length;t++)r.off(m,g[t][0],g[t][1])},this.setContainer=function(t){this.unbindContainer(),t=this.getElement(t),this.select().each((function(e){e.moveParent(t)})),this.selectEndpoints().each((function(e){e.moveParent(t)}));var e=m;m=t,g.length=0;for(var i={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},s=function(t,e,s){var n=e.srcElement||e.target,o=(n&&n.parentNode?n.parentNode._jsPlumb:null)||(n?n._jsPlumb:null)||(n&&n.parentNode&&n.parentNode.parentNode?n.parentNode.parentNode._jsPlumb:null);o&&(o.fire(t,o,e),r.fire(s&&i[s+t]||t,o.component||o,e))},o=function(t,e,i){g.push([t,i]),r.on(m,t,e,i)},a=function(t){o(t,".jtk-connector",(function(e){s(t,e)})),o(t,".jtk-endpoint",(function(e){s(t,e,"endpoint")})),o(t,".jtk-overlay",(function(e){s(t,e)}))},l=0;l<n.length;l++)a(n[l]);for(var h in _){var c=_[h].el;c.parentNode===e&&(e.removeChild(c),m.appendChild(c))}},this.getContainer=function(){return m},this.bind=function(t,e){"ready"===t&&y?e():a.apply(r,[t,e])},r.importDefaults=function(t){for(var e in t)r.Defaults[e]=t[e];return t.Container&&r.setContainer(t.Container),r},r.restoreDefaults=function(){return r.Defaults=p.extend({},h),r};var b=null,y=!1,v=[],C={},x={},_={},P={},S={},w=!1,E=[],k=!1,A=null,T=this.Defaults.Scope,M=1,O=function(){return""+M++},N=(function(t,e){m?m.appendChild(t):e?this.getElement(e).appendChild(t):this.appendToRoot(t)}).bind(this),L=function(t,e,s,n){if(!k){var o,a=z(t),l=r.getDragManager();l&&(o=l.getElementsForDraggable(a)),null==s&&(s=i());var h=at({elId:a,offset:e,recalc:!1,timestamp:s});if(o&&h&&h.o)for(var c in o)at({elId:o[c].id,offset:{left:h.o.left+o[c].offset.left,top:h.o.top+o[c].offset.top},recalc:!1,timestamp:s});if(r.anchorManager.redraw(a,e,s,null,n),o)for(var d in o)r.anchorManager.redraw(o[d].id,e,s,o[d].offset,n,!0)}},D=function(t){return x[t]},j=(function(t,i){var s=p.extend({},t);if(i&&p.extend(s,i),s.source&&(s.source.endpoint?s.sourceEndpoint=s.source:s.source=r.getElement(s.source)),s.target&&(s.target.endpoint?s.targetEndpoint=s.target:s.target=r.getElement(s.target)),t.uuids&&(s.sourceEndpoint=D(t.uuids[0]),s.targetEndpoint=D(t.uuids[1])),s.sourceEndpoint&&s.sourceEndpoint.isFull())e.log(r,"could not add connection; source endpoint is full");else{if(!s.targetEndpoint||!s.targetEndpoint.isFull()){if(!s.type&&s.sourceEndpoint&&(s.type=s.sourceEndpoint.connectionType),s.sourceEndpoint&&s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var n=0,o=s.sourceEndpoint.connectorOverlays.length;o>n;n++)s.overlays.push(s.sourceEndpoint.connectorOverlays[n])}s.sourceEndpoint&&s.sourceEndpoint.scope&&(s.scope=s.sourceEndpoint.scope),!s["pointer-events"]&&s.sourceEndpoint&&s.sourceEndpoint.connectorPointerEvents&&(s["pointer-events"]=s.sourceEndpoint.connectorPointerEvents);var a=function(t,e,i,n){if(s[t]&&!s[t].endpoint&&!s[t+"Endpoint"]&&!s.newConnection){var o=i[z(s[t])];if(o=o?o[n]:null){if(!o.enabled)return!1;var a=null!=o.endpoint&&o.endpoint._jsPlumb?o.endpoint:function(t,e,i){return r.addEndpoint(t,function(t,e){var i=p.extend({},t);for(var s in e)e[s]&&(i[s]=e[s]);return i}(e,{anchor:s.anchors?s.anchors[i]:s.anchor,endpoint:s.endpoints?s.endpoints[i]:s.endpoint,paintStyle:s.endpointStyles?s.endpointStyles[i]:s.endpointStyle,hoverPaintStyle:s.endpointHoverStyles?s.endpointHoverStyles[i]:s.endpointHoverStyle}))}(s[t],o.def,e);if(a.isFull())return!1;s[t+"Endpoint"]=a,!s.scope&&o.def.scope&&(s.scope=o.def.scope),o.uniqueEndpoint?o.endpoint?a.finalEndpoint=o.endpoint:(o.endpoint=a,a.setDeleteOnEmpty(!1)):a.setDeleteOnEmpty(!0),0===e&&o.def.connectorOverlays&&(s.overlays=s.overlays||[],Array.prototype.push.apply(s.overlays,o.def.connectorOverlays))}}};return!1!==a("source",0,this.sourceEndpointDefinitions,s.type||"default")&&!1!==a("target",1,this.targetEndpointDefinitions,s.type||"default")?(s.sourceEndpoint&&s.targetEndpoint&&(function(t,e){for(var i=t.scope.split(/\s/),s=e.scope.split(/\s/),n=0;n<i.length;n++)for(var r=0;r<s.length;r++)if(s[r]===i[n])return!0;return!1}(s.sourceEndpoint,s.targetEndpoint)||(s=null)),s):void 0}e.log(r,"could not add connection; target endpoint is full")}}).bind(r),I=function(t){var e=r.Defaults.ConnectionType||r.getDefaultConnectionType();t._jsPlumb=r,t.newConnection=I,t.newEndpoint=B,t.endpointsByUUID=x,t.endpointsByElement=C,t.finaliseConnection=R,t.id="con_"+O();var i=new e(t);return i.isDetachable()&&(i.endpoints[0].initDraggable("_jsPlumbSource"),i.endpoints[1].initDraggable("_jsPlumbTarget")),i},R=r.finaliseConnection=function(t,e,i,s){e=e||{},t.suspendedEndpoint||v.push(t),t.pending=null,t.endpoints[0].isTemporarySource=!1,!1!==s&&r.anchorManager.newConnection(t),L(t.source),e.doNotFireConnectionEvent||!1===e.fireEvent||r.fire("connection",{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]},i)},B=function(t,e){var i=r.Defaults.EndpointType||p.Endpoint,s=p.extend({},t);s._jsPlumb=r,s.newConnection=I,s.newEndpoint=B,s.endpointsByUUID=x,s.endpointsByElement=C,s.fireDetachEvent=G,s.elementId=e||z(s.source);var n=new i(s);return n.id="ep_"+O(),ot(s.elementId,s.source),p.headless||r.getDragManager().endpointAdded(s.source,e),n},F=function(t,e,i){var s=C[t];if(s&&s.length)for(var n=0,r=s.length;r>n;n++){for(var o=0,a=s[n].connections.length;a>o;o++)if(e(s[n].connections[o]))return;i&&i(s[n])}},Y=function(t,e,i){e="block"===e;var s=null;i&&(s=function(t){t.setVisible(e,!0,!0)});var n=u(t);F(n.id,(function(t){e&&i?t.endpoints[t.sourceId===n.id?1:0].isVisible()&&t.setVisible(!0):t.setVisible(e)}),s)},z=function(t,i,s){if(e.isString(t))return t;if(null==t)return null;var n=r.getAttribute(t,"id");return n&&"undefined"!==n||(2===arguments.length&&void 0!==arguments[1]?n=i:(1===arguments.length||3===arguments.length&&!arguments[2])&&(n="jsPlumb_"+o+"_"+O()),s||r.setAttribute(t,"id",n)),n};this.setConnectionBeingDragged=function(t){w=t},this.isConnectionBeingDragged=function(){return w},this.getManagedElements=function(){return _},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(t,i,s){var n=p.extend({},s=s||{});p.extend(n,i),n.endpoint=n.endpoint||r.Defaults.Endpoint,n.paintStyle=n.paintStyle||r.Defaults.EndpointStyle;for(var o=[],a=e.isArray(t)||null!=t.length&&!e.isString(t)?t:[t],l=0,h=a.length;h>l;l++){n.source=r.getElement(a[l]),rt(n.source);var c=z(n.source),d=B(n,c),u=ot(c,n.source).info.o;e.addToList(C,c,d),k||d.paint({anchorLoc:d.anchor.compute({xy:[u.left,u.top],wh:E[c],element:d,timestamp:A}),timestamp:A}),o.push(d)}return 1===o.length?o[0]:o},this.addEndpoints=function(t,i,s){for(var n=[],o=0,a=i.length;a>o;o++){var l=r.addEndpoint(t,i[o],s);e.isArray(l)?Array.prototype.push.apply(n,l):n.push(l)}return n},this.animate=function(t,i,s){if(!this.animationSupported)return!1;s=s||{};var n=r.getElement(t),o=z(n),a=p.animEvents.step,l=p.animEvents.complete;s[a]=e.wrap(s[a],(function(){r.revalidate(o)})),s[l]=e.wrap(s[l],(function(){r.revalidate(o)})),r.doAnimate(n,i,s)},this.checkCondition=function(t,i){var s=r.getListener(t),n=!0;if(s&&s.length>0){var o=Array.prototype.slice.call(arguments,1);try{for(var a=0,h=s.length;h>a;a++)n=n&&s[a].apply(s[a],o)}catch(l){e.log(r,"cannot check condition ["+t+"]"+l)}}return n},this.connect=function(t,i){var s,n=j(t,i);if(n){if(null==n.source&&null==n.sourceEndpoint)return void e.log("Cannot establish connection - source does not exist");if(null==n.target&&null==n.targetEndpoint)return void e.log("Cannot establish connection - target does not exist");rt(n.source),s=I(n),R(s,n)}return s};var X=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],U=(function(t,e,i,s){var n,r,o,a=X[i],l=t[a.elId],h=t.endpoints[i],c={index:i,originalSourceId:0===i?l:t.sourceId,newSourceId:t.sourceId,originalTargetId:1===i?l:t.targetId,newTargetId:t.targetId,connection:t};if(e.constructor===p.Endpoint)(n=e).addConnection(t),e=n.element;else if(r=z(e),o=this[a.epDefs][r],r===t[a.elId])n=null;else if(o)for(var d in o){if(!o[d].enabled)return;n=null!=o[d].endpoint&&o[d].endpoint._jsPlumb?o[d].endpoint:this.addEndpoint(e,o[d].def),o[d].uniqueEndpoint&&(o[d].endpoint=n),n.addConnection(t)}else n=t.makeEndpoint(0===i,e,r);return null!=n&&(h.detachFromConnection(t),t.endpoints[i]=n,t[a.el]=n.element,t[a.elId]=n.elementId,c[0===i?"newSourceId":"newTargetId"]=n.elementId,H(c),s||t.repaint()),c.element=e,c}).bind(this);this.setSource=function(t,e,i){var s=U(t,e,0,i);this.anchorManager.sourceChanged(s.originalSourceId,s.newSourceId,t,s.el)},this.setTarget=function(t,e,i){var s=U(t,e,1,i);this.anchorManager.updateOtherEndpoint(s.originalSourceId,s.originalTargetId,s.newTargetId,t)},this.deleteEndpoint=function(t,e,i){var s="string"==typeof t?x[t]:t;return s&&r.deleteObject({endpoint:s,dontUpdateHover:e,deleteAttachedObjects:i}),r},this.deleteEveryEndpoint=function(){var t=r.setSuspendDrawing(!0);for(var e in C){var i=C[e];if(i&&i.length)for(var s=0,n=i.length;n>s;s++)r.deleteEndpoint(i[s],!0)}C={},_={},x={},P={},S={},r.anchorManager.reset();var o=r.getDragManager();return o&&o.reset(),t||r.setSuspendDrawing(!1),r};var G=function(t,e,i){var s=r.Defaults.ConnectionType||r.getDefaultConnectionType(),n=t.constructor===s?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&r.fire("connectionDetached",n,i),r.fire("internal.connectionDetached",n,i),r.anchorManager.connectionDetached(n)},H=r.fireMoveEvent=function(t,e){r.fire("connectionMoved",t,e)};this.unregisterEndpoint=function(t){for(var e in t._jsPlumb.uuid&&(x[t._jsPlumb.uuid]=null),r.anchorManager.deleteEndpoint(t),C){var i=C[e];if(i){for(var s=[],n=0,o=i.length;o>n;n++)i[n]!==t&&s.push(i[n]);C[e]=s}C[e].length<1&&delete C[e]}};var q="isDetachAllowed";this.deleteConnection=function(t,i){return!(null==t||(i=i||{},!i.force&&!e.functionChain(!0,!1,[[t.endpoints[0],q,[t]],[t.endpoints[1],q,[t]],[t,q,[t]],[r,"checkCondition",["beforeDetach",t]]]))||(t.setHover(!1),G(t,!t.pending&&!1!==i.fireEvent,i.originalEvent),t.endpoints[0].detachFromConnection(t),t.endpoints[1].detachFromConnection(t),e.removeWithFunction(v,(function(e){return t.id===e.id})),t.cleanup(),t.destroy(),0))},this.deleteEveryConnection=function(t){t=t||{};var e=v.length,i=0;return r.batch((function(){for(var s=0;e>s;s++)i+=r.deleteConnection(v[0],t)?1:0})),i},this.deleteConnectionsForElement=function(t,e){e=e||{},t=r.getElement(t);var i=z(t),s=C[i];if(s&&s.length)for(var n=0,o=s.length;o>n;n++)s[n].deleteEveryConnection(e);return r},this.deleteObject=function(t){var i={endpoints:{},connections:{},endpointCount:0,connectionCount:0},s=!1!==t.deleteAttachedObjects,n=function(e){null!=e&&null==i.connections[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),i.connections[e.id]=e,i.connectionCount++)};for(var o in t.connection?n(t.connection):function(e){if(null!=e&&null==i.endpoints[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),i.endpoints[e.id]=e,i.endpointCount++,s))for(var r=0;r<e.connections.length;r++)n(e.connections[r])}(t.endpoint),i.connections){var a=i.connections[o];if(a._jsPlumb){e.removeWithFunction(v,(function(t){return a.id===t.id})),G(a,!1!==t.fireEvent&&!a.pending,t.originalEvent);var l=null==t.deleteAttachedObjects?null:!t.deleteAttachedObjects;a.endpoints[0].detachFromConnection(a,null,l),a.endpoints[1].detachFromConnection(a,null,l),a.cleanup(!0),a.destroy(!0)}}for(var h in i.endpoints){var c=i.endpoints[h];c._jsPlumb&&(r.unregisterEndpoint(c),c.cleanup(!0),c.destroy(!0))}return i};var J=function(t,e,i,s){for(var n=0,r=t.length;r>n;n++)t[n][e].apply(t[n],i);return s(t)},V=function(t,e,i){for(var s=[],n=0,r=t.length;r>n;n++)s.push([t[n][e].apply(t[n],i),t[n]]);return s},$=function(t,e,i){return function(){return J(t,e,arguments,i)}},W=function(t,e){return function(){return V(t,e,arguments)}},K=function(t,e){var i=[];if(t)if("string"==typeof t){if("*"===t)return t;i.push(t)}else if(e)i=t;else if(t.length)for(var s=0,n=t.length;n>s;s++)i.push(u(t[s]).id);else i.push(u(t).id);return i},Z=function(t,e,i){return"*"===t||(t.length>0?-1!==t.indexOf(e):!i)};this.getConnections=function(t,e){t?t.constructor===String&&(t={scope:t}):t={};for(var i=t.scope||r.getDefaultScope(),s=K(i,!0),n=K(t.source),o=K(t.target),a=!e&&s.length>1?{}:[],l=function(t,i){if(!e&&s.length>1){var n=a[t];null==n&&(n=a[t]=[]),n.push(i)}else a.push(i)},h=0,c=v.length;c>h;h++){var d=v[h],u=d.proxies&&d.proxies[0]?d.proxies[0].originalEp.elementId:d.sourceId,p=d.proxies&&d.proxies[1]?d.proxies[1].originalEp.elementId:d.targetId;Z(s,d.scope)&&Z(n,u)&&Z(o,p)&&l(d.scope,d)}return a};var Q=function(t,e){return function(i){for(var s=0,n=t.length;n>s;s++)i(t[s]);return e(t)}},tt=function(t){return function(e){return t[e]}},et=function(t,e){var i,s,n={length:t.length,each:Q(t,e),get:tt(t)},r=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],o=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(i=0,s=r.length;s>i;i++)n[r[i]]=$(t,r[i],e);for(i=0,s=o.length;s>i;i++)n[o[i]]=W(t,o[i]);return n},it=function(t){var e=et(t,it);return p.extend(e,{setDetachable:$(t,"setDetachable",it),setReattach:$(t,"setReattach",it),setConnector:$(t,"setConnector",it),delete:function(){for(var e=0,i=t.length;i>e;e++)r.deleteConnection(t[e])},isDetachable:W(t,"isDetachable"),isReattach:W(t,"isReattach")})},st=function(t){var e=et(t,st);return p.extend(e,{setEnabled:$(t,"setEnabled",st),setAnchor:$(t,"setAnchor",st),isEnabled:W(t,"isEnabled"),deleteEveryConnection:function(){for(var e=0,i=t.length;i>e;e++)t[e].deleteEveryConnection()},delete:function(){for(var e=0,i=t.length;i>e;e++)r.deleteEndpoint(t[e])}})};this.select=function(t){return(t=t||{}).scope=t.scope||"*",it(t.connections||r.getConnections(t,!0))},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,i=e?"*":K(t.element),s=e?"*":K(t.source),n=e?"*":K(t.target),r=K(t.scope,!0),o=[];for(var a in C){var l=Z(i,a,!0),h=Z(s,a,!0),c="*"!==s,d=Z(n,a,!0),u="*"!==n;if(l||h||d)t:for(var p=0,f=C[a].length;f>p;p++){var m=C[a][p];if(Z(r,m.scope,!0)){if(c&&s.length>0&&!m.isSource||u&&n.length>0&&!m.isTarget)continue t;o.push(m)}}}return st(o)},this.getAllConnections=function(){return v},this.getDefaultScope=function(){return T},this.getEndpoint=D,this.getEndpoints=function(t){return C[u(t).id]||[]},this.getDefaultEndpointType=function(){return p.Endpoint},this.getDefaultConnectionType=function(){return p.Connection},this.getId=z,this.draw=L,this.info=u,this.appendElement=N;var nt=!1;this.isHoverSuspended=function(){return nt},this.setHoverSuspended=function(t){nt=t},this.hide=function(t,e){return Y(t,"none",e),r},this.idstamp=O;var rt=function(t){if(!m&&t){var e=r.getElement(t);e.offsetParent&&r.setContainer(e.offsetParent)}},ot=r.manage=function(t,e,i){return _[t]||(_[t]={el:e,endpoints:[],connections:[]},_[t].info=at({elId:t,timestamp:A}),r.addClass(e,"jtk-managed"),i||r.fire("manageElement",{id:t,info:_[t].info,el:e})),_[t]},at=(r.unmanage=function(t){if(_[t]){var e=_[t].el;r.removeClass(e,"jtk-managed"),delete _[t],r.fire("unmanageElement",{id:t,el:e})}},function(t){var e,i=t.timestamp,s=t.recalc,n=t.offset,o=t.elId;return k&&!i&&(i=A),!s&&i&&i===S[o]?{o:t.offset||P[o],s:E[o]}:(s||!n&&null==P[o]?null!=(e=_[o]?_[o].el:null)&&(E[o]=r.getSize(e),P[o]=r.getOffset(e),S[o]=i):(P[o]=n||P[o],null==E[o]&&null!=(e=_[o].el)&&(E[o]=r.getSize(e)),S[o]=i),P[o]&&!P[o].right&&(P[o].right=P[o].left+E[o][0],P[o].bottom=P[o].top+E[o][1],P[o].width=E[o][0],P[o].height=E[o][1],P[o].centerx=P[o].left+P[o].width/2,P[o].centery=P[o].top+P[o].height/2),{o:P[o],s:E[o]})});this.updateOffset=at,this.init=(function(){y||(r.Defaults.Container&&r.setContainer(r.Defaults.Container),r.anchorManager=new t.jsPlumb.AnchorManager({jsPlumbInstance:r}),y=!0,r.fire("ready",r))}).bind(this),this.log=b,this.jsPlumbUIComponent=l,this.makeAnchor=function(){var i,s=function(e,i){if(t.jsPlumb.Anchors[e])return new t.jsPlumb.Anchors[e](i);if(!r.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}};if(0===arguments.length)return null;var n=arguments[0],o=arguments[1],a=null;if(n.compute&&n.getOrientation)return n;if("string"==typeof n)a=s(arguments[0],{elementId:o,jsPlumbInstance:r});else if(e.isArray(n))if(e.isArray(n[0])||e.isString(n[0]))2===n.length&&e.isObject(n[1])?e.isString(n[0])?(i=t.jsPlumb.extend({elementId:o,jsPlumbInstance:r},n[1]),a=s(n[0],i)):(i=t.jsPlumb.extend({elementId:o,jsPlumbInstance:r,anchors:n[0]},n[1]),a=new t.jsPlumb.DynamicAnchor(i)):a=new p.DynamicAnchor({anchors:n,selector:null,elementId:o,jsPlumbInstance:r});else{var l={x:n[0],y:n[1],orientation:n.length>=4?[n[2],n[3]]:[0,0],offsets:n.length>=6?[n[4],n[5]]:[0,0],elementId:o,jsPlumbInstance:r,cssClass:7===n.length?n[6]:null};(a=new t.jsPlumb.Anchor(l)).clone=function(){return new t.jsPlumb.Anchor(l)}}return a.id||(a.id="anchor_"+O()),a},this.makeAnchors=function(i,s,n){for(var o=[],a=0,l=i.length;l>a;a++)"string"==typeof i[a]?o.push(t.jsPlumb.Anchors[i[a]]({elementId:s,jsPlumbInstance:n})):e.isArray(i[a])&&o.push(r.makeAnchor(i[a],s,n));return o},this.makeDynamicAnchor=function(e,i){return new t.jsPlumb.DynamicAnchor({anchors:e,selector:i,elementId:null,jsPlumbInstance:r})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var lt=function(i,s,n,o,a){var h=new l(s),c=s._jsPlumb.EndpointDropHandler({jsPlumb:r,enabled:function(){return i.def.enabled},isFull:function(){var t=r.select({target:i.id}).length;return i.def.maxConnections>0&&t>=i.def.maxConnections},element:i.el,elementId:i.id,isSource:o,isTarget:a,addClass:function(t){r.addClass(i.el,t)},removeClass:function(t){r.removeClass(i.el,t)},onDrop:function(t){t.endpoints[0].anchor.unlock()},isDropAllowed:function(){return h.isDropAllowed.apply(h,arguments)},isRedrop:function(t){return null!=t.suspendedElement&&null!=t.suspendedEndpoint&&t.suspendedEndpoint.element===i.el},getEndpoint:function(e){var n=i.def.endpoint;if(null==n||null==n._jsPlumb){var o=r.deriveEndpointAndAnchorSpec(e.getType().join(" "),!0),a=o.endpoints?t.jsPlumb.extend(s,{endpoint:i.def.def.endpoint||o.endpoints[1]}):s;o.anchors&&(a=t.jsPlumb.extend(a,{anchor:i.def.def.anchor||o.anchors[1]})),(n=r.addEndpoint(i.el,a))._mtNew=!0}if(s.uniqueEndpoint&&(i.def.endpoint=n),n.setDeleteOnEmpty(!0),e.isDetachable()&&n.initDraggable(),null!=n.anchor.positionFinder){var l=r.getUIPosition(arguments,r.getZoom()),h=r.getOffset(i.el),c=r.getSize(i.el),d=null==l?[0,0]:n.anchor.positionFinder(l,h,c,n.anchor.constructorParams);n.anchor.x=d[0],n.anchor.y=d[1]}return n},maybeCleanup:function(t){t._mtNew&&0===t.connections.length?r.deleteObject({endpoint:t}):delete t._mtNew}}),d=t.jsPlumb.dragEvents.drop;return n.scope=n.scope||s.scope||r.Defaults.Scope,n[d]=e.wrap(n[d],c,!0),n.rank=s.rank||0,a&&(n[t.jsPlumb.dragEvents.over]=function(){return!0}),!1===s.allowLoopback&&(n.canDrop=function(t){return t.getDragElement()._jsPlumbRelatedElement!==i.el}),r.initDroppable(i.el,n,"internal"),c};this.makeTarget=function(e,i,s){var n=t.jsPlumb.extend({_jsPlumb:this},s);t.jsPlumb.extend(n,i);for(var o=n.maxConnections||-1,a=(function(e){var i=u(e),s=i.id,a=t.jsPlumb.extend({},n.dropOptions||{}),l=n.connectionType||"default";this.targetEndpointDefinitions[s]=this.targetEndpointDefinitions[s]||{},rt(s),i.el._isJsPlumbGroup&&null==a.rank&&(a.rank=-1);var h={def:t.jsPlumb.extend({},n),uniqueEndpoint:n.uniqueEndpoint,maxConnections:o,enabled:!0};n.createEndpoint&&(h.uniqueEndpoint=!0,h.endpoint=r.addEndpoint(e,h.def),h.endpoint.setDeleteOnEmpty(!1)),i.def=h,this.targetEndpointDefinitions[s][l]=h,lt(i,n,a,!0===n.isSource,!0),i.el._katavorioDrop[i.el._katavorioDrop.length-1].targetDef=h}).bind(this),l=e.length&&e.constructor!==String?e:[e],h=0,c=l.length;c>h;h++)a(l[h]);return this},this.unmakeTarget=function(t,e){var i=u(t);return r.destroyDroppable(i.el,"internal"),e||delete this.targetEndpointDefinitions[i.id],this},this.makeSource=function(i,s,n){var o=t.jsPlumb.extend({_jsPlumb:this},n);t.jsPlumb.extend(o,s);var a=o.connectionType||"default",l=r.deriveEndpointAndAnchorSpec(a);o.endpoint=o.endpoint||l.endpoints[0],o.anchor=o.anchor||l.anchors[0];for(var h=o.maxConnections||-1,d=o.onMaxConnections,p=(function(s){var n=s.id,l=this.getElement(s.el);this.sourceEndpointDefinitions[n]=this.sourceEndpointDefinitions[n]||{},rt(n);var u={def:t.jsPlumb.extend({},o),uniqueEndpoint:o.uniqueEndpoint,maxConnections:h,enabled:!0};o.createEndpoint&&(u.uniqueEndpoint=!0,u.endpoint=r.addEndpoint(i,u.def),u.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[n][a]=u,s.def=u;var p=t.jsPlumb.dragEvents.stop,f=t.jsPlumb.dragEvents.drag,m=t.jsPlumb.extend({},o.dragOptions||{}),g=m.drag,b=m.stop,y=null,v=!1;m.scope=m.scope||o.scope,m[f]=e.wrap(m[f],(function(){g&&g.apply(this,arguments),v=!1})),m[p]=e.wrap(m[p],(function(){if(b&&b.apply(this,arguments),this.currentlyDragging=!1,null!=y._jsPlumb){var t=o.anchor||this.Defaults.Anchor,e=y.anchor,i=y.connections[0],s=this.makeAnchor(t,n,this),a=y.element;if(null!=s.positionFinder){var l=r.getOffset(a),h=this.getSize(a),c={left:l.left+e.x*h[0],top:l.top+e.y*h[1]},d=s.positionFinder(c,l,h,s.constructorParams);s.x=d[0],s.y=d[1]}y.setAnchor(s,!0),y.repaint(),this.repaint(y.elementId),null!=i&&this.repaint(i.targetId)}}).bind(this));var C=(function(i){if(3!==i.which&&2!==i.button){var u=this.sourceEndpointDefinitions[n][a];if(u.enabled){if(n=this.getId(this.getElement(s.el)),o.filter&&!1===(e.isString(o.filter)?function(t,e,i,s,n){for(var r=t.target||t.srcElement,o=!1,a=s.getSelector(e,i),l=0;l<a.length;l++)if(a[l]===r){o=!0;break}return n?!o:o}(i,s.el,o.filter,this,o.filterExclude):o.filter(i,s.el)))return;var p=this.select({source:n}).length;if(u.maxConnections>=0&&p>=u.maxConnections)return d&&d({element:s.el,maxConnections:h},i),!1;var f=t.jsPlumb.getPositionOnElement(i,l,c),g={};t.jsPlumb.extend(g,u.def),g.isTemporarySource=!0,g.anchor=[f[0],f[1],0,0],g.dragOptions=m,u.def.scope&&(g.scope=u.def.scope),y=this.addEndpoint(n,g),v=!0,y.setDeleteOnEmpty(!0),u.uniqueEndpoint&&(u.endpoint?y.finalEndpoint=u.endpoint:(u.endpoint=y,y.setDeleteOnEmpty(!1)));var b=function(){r.off(y.canvas,"mouseup",b),r.off(s.el,"mouseup",b),v&&(v=!1,r.deleteEndpoint(y))};r.on(y.canvas,"mouseup",b),r.on(s.el,"mouseup",b);var C={};if(u.def.extract)for(var x in u.def.extract){var _=(i.srcElement||i.target).getAttribute(x);_&&(C[u.def.extract[x]]=_)}r.trigger(y.canvas,"mousedown",i,C),e.consume(i)}}}).bind(this);this.on(s.el,"mousedown",C),u.trigger=C,o.filter&&(e.isString(o.filter)||e.isFunction(o.filter))&&r.setDragFilter(s.el,o.filter);var x=t.jsPlumb.extend({},o.dropOptions||{});lt(s,o,x,!0,!0===o.isTarget)}).bind(this),f=i.length&&i.constructor!==String?i:[i],m=0,g=f.length;g>m;m++)p(u(f[m]));return this},this.unmakeSource=function(t,e,i){var s=u(t);r.destroyDroppable(s.el,"internal");var n=this.sourceEndpointDefinitions[s.id];if(n)for(var o in n)if(null==e||e===o){var a=n[o].trigger;a&&r.off(s.el,"mousedown",a),i||delete this.sourceEndpointDefinitions[s.id][o]}return this},this.unmakeEverySource=function(){for(var t in this.sourceEndpointDefinitions)r.unmakeSource(t,null,!0);return this.sourceEndpointDefinitions={},this};var ht=(function(t,i,s){i=e.isArray(i)?i:[i];var n=z(t);s=s||"default";for(var r=0;r<i.length;r++){var o=this[i[r]][n];if(o&&o[s])return o[s].def.scope||this.Defaults.Scope}}).bind(this),ct=(function(t,i,s,n){s=e.isArray(s)?s:[s];var r=z(t);n=n||"default";for(var o=0;o<s.length;o++){var a=this[s[o]][r];a&&a[n]&&(a[n].def.scope=i)}}).bind(this);this.getScope=function(t,e){return ht(t,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(t){return ht(t,"sourceEndpointDefinitions")},this.getTargetScope=function(t){return ht(t,"targetEndpointDefinitions")},this.setScope=function(t,e,i){this.setSourceScope(t,e,i),this.setTargetScope(t,e,i)},this.setSourceScope=function(t,e,i){ct(t,e,"sourceEndpointDefinitions",i),this.setDragScope(t,e)},this.setTargetScope=function(t,e,i){ct(t,e,"targetEndpointDefinitions",i),this.setDropScope(t,e)},this.unmakeEveryTarget=function(){for(var t in this.targetEndpointDefinitions)r.unmakeTarget(t,!0);return this.targetEndpointDefinitions={},this};var dt=(function(t,i,s,n,o){var a,l,h,c="source"===t?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(o=o||"default",i.length&&!e.isString(i)){a=[];for(var d=0,p=i.length;p>d;d++)c[(l=u(i[d])).id]&&c[l.id][o]&&(a[d]=c[l.id][o].enabled,c[l.id][o].enabled=h=n?!a[d]:s,r[h?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}else{var f=(l=u(i)).id;c[f]&&c[f][o]&&(a=c[f][o].enabled,c[f][o].enabled=h=n?!a:s,r[h?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}return a}).bind(this),ut=(function(t,i){return e.isString(t)||!t.length?i.apply(this,[t]):t.length?i.apply(this,[t[0]]):void 0}).bind(this);this.toggleSourceEnabled=function(t,e){return dt("source",t,null,!0,e),this.isSourceEnabled(t,e)},this.setSourceEnabled=function(t,e,i){return dt("source",t,e,null,i)},this.isSource=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.sourceEndpointDefinitions[u(t).id];return null!=i&&null!=i[e]}).bind(this))},this.isSourceEnabled=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.sourceEndpointDefinitions[u(t).id];return i&&i[e]&&!0===i[e].enabled}).bind(this))},this.toggleTargetEnabled=function(t,e){return dt("target",t,null,!0,e),this.isTargetEnabled(t,e)},this.isTarget=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.targetEndpointDefinitions[u(t).id];return null!=i&&null!=i[e]}).bind(this))},this.isTargetEnabled=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.targetEndpointDefinitions[u(t).id];return i&&i[e]&&!0===i[e].enabled}).bind(this))},this.setTargetEnabled=function(t,e,i){return dt("target",t,e,null,i)},this.ready=function(t){r.bind("ready",t)};var pt=function(t,e){if("object"==typeof t&&t.length)for(var i=0,s=t.length;s>i;i++)e(t[i]);else e(t);return r};this.repaint=function(t,e,i){return pt(t,(function(t){L(t,e,i)}))},this.revalidate=function(t,e,i){return pt(t,(function(t){var s=i?t:r.getId(t);r.updateOffset({elId:s,recalc:!0,timestamp:e});var n=r.getDragManager();n&&n.updateOffsets(s),r.repaint(t)}))},this.repaintEverything=function(){var t,e=i();for(t in C)r.updateOffset({elId:t,recalc:!0,timestamp:e});for(t in C)L(t,null,e);return this},this.removeAllEndpoints=function(t,e,i){i=i||[];var s=function(t){var n,o,a=u(t),l=C[a.id];if(l)for(i.push(a),n=0,o=l.length;o>n;n++)r.deleteEndpoint(l[n],!1);if(delete C[a.id],e&&a.el&&3!==a.el.nodeType&&8!==a.el.nodeType)for(n=0,o=a.el.childNodes.length;o>n;n++)s(a.el.childNodes[n])};return s(t),this};var ft=function(t,e){r.removeAllEndpoints(t.id,!0,e);for(var i=r.getDragManager(),s=function(t){i&&i.elementRemoved(t.id),r.anchorManager.clearFor(t.id),r.anchorManager.removeFloatingConnection(t.id),r.isSource(t.el)&&r.unmakeSource(t.el),r.isTarget(t.el)&&r.unmakeTarget(t.el),r.destroyDraggable(t.el),r.destroyDroppable(t.el),delete r.floatingConnections[t.id],delete _[t.id],delete P[t.id],t.el&&(r.removeElement(t.el),t.el._jsPlumb=null)},n=1;n<e.length;n++)s(e[n]);s(t)};this.remove=function(t,e){var i=u(t),s=[];return i.text?i.el.parentNode.removeChild(i.el):i.id&&r.batch((function(){ft(i,s)}),!0===e),r},this.empty=function(t,e){var i=[],s=function(t,e){var n=u(t);if(n.text)n.el.parentNode.removeChild(n.el);else if(n.el){for(;n.el.childNodes.length>0;)s(n.el.childNodes[0]);e||ft(n,i)}};return r.batch((function(){s(t,!0)}),!1===e),r},this.reset=function(t){r.silently((function(){nt=!1,r.removeAllGroups(),r.removeGroupManager(),r.deleteEveryEndpoint(),t||r.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},v.length=0,this.doReset&&this.doReset()}).bind(this))};var mt=function(t){t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),t.cleanup(),t.destroy()};this.clear=function(){r.select().each(mt),r.selectEndpoints().each(mt),C={},x={}},this.setDefaultScope=function(t){return T=t,r},this.deriveEndpointAndAnchorSpec=function(t,e){for(var i=((e?"":"default ")+t).split(/[\s]/),s=null,n=null,o=null,a=null,l=0;l<i.length;l++){var h=r.getType(i[l],"connection");h&&(h.endpoints&&(s=h.endpoints),h.endpoint&&(n=h.endpoint),h.anchors&&(a=h.anchors),h.anchor&&(o=h.anchor))}return{endpoints:s||[n,n],anchors:a||[o,o]}},this.setId=function(t,i,s){var n;e.isString(t)?n=t:(t=this.getElement(t),n=this.getId(t));var r=this.getConnections({source:n,scope:"*"},!0),o=this.getConnections({target:n,scope:"*"},!0);i=""+i,s?t=this.getElement(i):(t=this.getElement(n),this.setAttribute(t,"id",i)),C[i]=C[n]||[];for(var a=0,l=C[i].length;l>a;a++)C[i][a].setElementId(i),C[i][a].setReferenceElement(t);delete C[n],this.sourceEndpointDefinitions[i]=this.sourceEndpointDefinitions[n],delete this.sourceEndpointDefinitions[n],this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[n],delete this.targetEndpointDefinitions[n],this.anchorManager.changeId(n,i);var h=this.getDragManager();h&&h.changeId(n,i),_[i]=_[n],delete _[n];var c=function(e,s,n){for(var r=0,o=e.length;o>r;r++)e[r].endpoints[s].setElementId(i),e[r].endpoints[s].setReferenceElement(t),e[r][n+"Id"]=i,e[r][n]=t};c(r,0,"source"),c(o,1,"target"),this.repaint(i)},this.setDebugLog=function(t){b=t},this.setSuspendDrawing=function(t,e){var i=k;return k=t,A=t?(new Date).getTime():null,e&&this.repaintEverything(),i},this.isSuspendDrawing=function(){return k},this.getSuspendedAt=function(){return A},this.batch=function(t,i){var s=this.isSuspendDrawing();s||this.setSuspendDrawing(!0);try{t()}catch(n){e.log("Function run while suspended failed",n)}s||this.setSuspendDrawing(!1,!i)},this.doWhileSuspended=this.batch,this.getCachedData=function(t){var e=P[t];return e?{o:e,s:E[t]}:at({elId:t})},this.timestamp=i,this.show=function(t,e){return Y(t,"block",e),r},this.toggleVisible=function(t,e){var i=null;e&&(i=function(t){var e=t.isVisible();t.setVisible(!e)}),F(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),i)},this.addListener=this.bind;var gt=[];this.registerFloatingConnection=function(t,i,s){gt[t.id]=i,e.addToList(C,t.id,s)},this.getFloatingConnectionFor=function(t){return gt[t]},this.listManager=new t.jsPlumbListManager(this)};e.extend(t.jsPlumbInstance,e.EventGenerator,{setAttribute:function(t,e,i){this.setAttribute(t,e,i)},getAttribute:function(e,i){return this.getAttribute(t.jsPlumb.getElement(e),i)},convertToFullOverlaySpec:function(t){return e.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||e.uuid(),t},registerConnectionType:function(e,i){if(this._connectionTypes[e]=t.jsPlumb.extend({},i),i.overlays){for(var s={},n=0;n<i.overlays.length;n++){var r=this.convertToFullOverlaySpec(i.overlays[n]);s[r[1].id]=r}this._connectionTypes[e].overlays=s}},registerConnectionTypes:function(t){for(var e in t)this.registerConnectionType(e,t[e])},registerEndpointType:function(e,i){if(this._endpointTypes[e]=t.jsPlumb.extend({},i),i.overlays){for(var s={},n=0;n<i.overlays.length;n++){var r=this.convertToFullOverlaySpec(i.overlays[n]);s[r[1].id]=r}this._endpointTypes[e].overlays=s}},registerEndpointTypes:function(t){for(var e in t)this.registerEndpointType(e,t[e])},getType:function(t,e){return"connection"===e?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,e){this.setId(t,e,!0)},setParent:function(t,e){var i=this.getElement(t),s=this.getId(i),n=this.getElement(e),r=this.getId(n),o=this.getDragManager();i.parentNode.removeChild(i),n.appendChild(i),o&&o.setParent(i,s,n,r)},extend:function(t,e,i){var s;if(i)for(s=0;s<i.length;s++)t[i[s]]=e[i[s]];else for(s in e)t[s]=e[s];return t},floatingConnections:{},getFloatingAnchorIndex:function(t){return t.endpoints[0].isFloating()?0:t.endpoints[1].isFloating()?1:-1},proxyConnection:function(t,e,i,s,n,r){var o,a=t.endpoints[e].elementId,l=t.endpoints[e];t.proxies=t.proxies||[],(o=t.proxies[e]?t.proxies[e].ep:this.addEndpoint(i,{endpoint:n(t,e),anchor:r(t,e),parameters:{isProxyEndpoint:!0}})).setDeleteOnEmpty(!0),t.proxies[e]={ep:o,originalEp:l},0===e?this.anchorManager.sourceChanged(a,s,t,i):(this.anchorManager.updateOtherEndpoint(t.endpoints[0].elementId,a,s,t),t.target=i,t.targetId=s),l.detachFromConnection(t,null,!0),o.connections=[t],t.endpoints[e]=o,l.setVisible(!1),t.setVisible(!0),this.revalidate(i)},unproxyConnection:function(t,e,i){if(null!=t._jsPlumb&&null!=t.proxies&&null!=t.proxies[e]){var s=t.proxies[e].originalEp.element,n=t.proxies[e].originalEp.elementId;t.endpoints[e]=t.proxies[e].originalEp,0===e?this.anchorManager.sourceChanged(i,n,t,s):(this.anchorManager.updateOtherEndpoint(t.endpoints[0].elementId,i,n,t),t.target=s,t.targetId=n),t.proxies[e].ep.detachFromConnection(t,null),t.proxies[e].originalEp.addConnection(t),t.isVisible()&&t.proxies[e].originalEp.setVisible(!0),delete t.proxies[e]}}});var p=new u;t.jsPlumb=p,p.getInstance=function(t,e){var i=new u(t);if(e)for(var s in e)i[s]=e[s];return i.init(),i},p.each=function(t,e){if(null!=t)if("string"==typeof t)e(p.getElement(t));else if(null!=t.length)for(var i=0;i<t.length;i++)e(p.getElement(t[i]));else e(t)},"undefined"!=typeof exports&&(exports.jsPlumb=p)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s="__label",n=function(t,i){var n=e.extend({cssClass:i.cssClass,labelStyle:t.labelStyle,id:s,component:t,_jsPlumb:t._jsPlumb.instance},i);return new(e.Overlays[t._jsPlumb.instance.getRenderMode()].Label)(n)},r=function(t,s){var n=null;if(i.isArray(s)){var r=s[0],o=e.extend({component:t,_jsPlumb:t._jsPlumb.instance},s[1]);3===s.length&&e.extend(o,s[2]),n=new(e.Overlays[t._jsPlumb.instance.getRenderMode()][r])(o)}else n=s.constructor===String?new(e.Overlays[t._jsPlumb.instance.getRenderMode()][s])({component:t,_jsPlumb:t._jsPlumb.instance}):s;return n.id=n.id||i.uuid(),t.cacheTypeItem("overlay",n,n.id),t._jsPlumb.overlays[n.id]=n,n};e.OverlayCapableJsPlumbUIComponent=function(e){t.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},e.label&&(this.getDefaultType().overlays[s]=["Label",{label:e.label,location:e.labelLocation||this.defaultLabelLocation||.5,labelStyle:e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:s}]),this.setListenerComponent=function(t){if(this._jsPlumb)for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].setListenerComponent(t)}},e.OverlayCapableJsPlumbUIComponent.applyType=function(t,e){if(e.overlays){var i,s={};for(i in e.overlays){var n=t._jsPlumb.overlays[e.overlays[i][1].id];if(n)n.updateFrom(e.overlays[i][1]),s[e.overlays[i][1].id]=!0;else{var r=t.getCachedTypeItem("overlay",e.overlays[i][1].id);null!=r?(r.reattach(t._jsPlumb.instance,t),r.setVisible(!0),r.updateFrom(e.overlays[i][1]),t._jsPlumb.overlays[r.id]=r):r=t.addOverlay(e.overlays[i],!0),s[r.id]=!0}}for(i in t._jsPlumb.overlays)null==s[t._jsPlumb.overlays[i].id]&&t.removeOverlay(t._jsPlumb.overlays[i].id,!0)}},i.extend(e.OverlayCapableJsPlumbUIComponent,t.jsPlumbUIComponent,{setHover:function(t,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var i in this._jsPlumb.overlays)this._jsPlumb.overlays[i][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(t,e){var s=r(this,t);if(this.getData&&"Label"===s.type&&i.isArray(t)){var n=this.getData();if(n){var o=n?n[t[1].labelLocationAttribute||"labelLocation"]:null;o&&(s.loc=o)}}return e||this.repaint(),s},getOverlay:function(t){return this._jsPlumb.overlays[t]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var e=this.getOverlay(t);e&&e.hide()},hideOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].hide()},showOverlay:function(t){var e=this.getOverlay(t);e&&e.show()},showOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].show()},removeAllOverlays:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup&&this._jsPlumb.overlays[e].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},t||this.repaint()},removeOverlay:function(t,e){var i=this._jsPlumb.overlays[t];i&&(i.setVisible(!1),!e&&i.cleanup&&i.cleanup(),delete this._jsPlumb.overlays[t],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[t],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[t])},removeOverlays:function(){for(var t=0,e=arguments.length;e>t;t++)this.removeOverlay(arguments[t])},moveParent:function(t){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),t.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode)for(var e in this.canvas.parentNode.removeChild(this.canvas),t.appendChild(this.canvas),this._jsPlumb.overlays)if(this._jsPlumb.overlays[e].isAppendedAtTopLevel){var i=this._jsPlumb.overlays[e].getElement();i.parentNode.removeChild(i),t.appendChild(i)}},getLabel:function(){var t=this.getOverlay(s);return null!=t?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(s)},setLabel:function(t){var e=this.getOverlay(s);if(e)t.constructor===String||t.constructor===Function?e.setLabel(t):(t.label&&e.setLabel(t.label),t.location&&e.setLocation(t.location));else{var i=t.constructor===String||t.constructor===Function?{label:t}:t;e=n(this,i),this._jsPlumb.overlays[s]=e}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup(t),this._jsPlumb.overlays[e].destroy(t);t&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(t){this[t?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(t,e){this._jsPlumb.overlayPositions[t.id]=e},getAbsoluteOverlayPosition:function(t){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[t.id]:null},_clazzManip:function(t,e,i){if(!i)for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s][t+"Class"](e)},addClass:function(t,e){this._clazzManip("add",t,e)},removeClass:function(t,e){this._clazzManip("remove",t,e)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=function(t,e,i){var s=!1;return{drag:function(){if(s)return s=!1,!0;if(e.element){var n=i.getUIPosition(arguments,i.getZoom());null!=n&&i.setPosition(e.element,n),i.repaint(e.element,n),t.paint({anchorPoint:t.anchor.getCurrentLocation({element:t})})}},stopDrag:function(){s=!0}}},n=function(t,e,i,s){var n=e.createElement("div",{position:"absolute"});e.appendElement(n);var r=e.getId(n);e.setPosition(n,i),n.style.width=s[0]+"px",n.style.height=s[1]+"px",e.manage(r,n,!0),t.id=r,t.element=n},r=function(t,i,s,n,r,o,a,l){return a({paintStyle:t,endpoint:s,anchor:new e.FloatingAnchor({reference:i,referenceCanvas:n,jsPlumbInstance:o}),source:r,scope:l})},o=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],a=function(t,e){var i=0;if(null!=e)for(var s=0;s<t.connections.length;s++)if(t.connections[s].sourceId===e||t.connections[s].targetId===e){i=s;break}return t.connections[i]};e.Endpoint=function(t){var l=t._jsPlumb,h=t.newConnection,c=t.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:t.connectionType,maxConnections:null==t.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:t.maxConnections,paintStyle:t.endpointStyle||t.paintStyle||t.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:t.endpointHoverStyle||t.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:t.connectorStyle,connectorHoverStyle:t.connectorHoverStyle,connectorClass:t.connectorClass,connectorHoverClass:t.connectorHoverClass,connectorOverlays:t.connectorOverlays,connector:t.connector,connectorTooltip:t.connectorTooltip}),this._jsPlumb.enabled=!(!1===t.enabled),this._jsPlumb.visible=!0,this.element=e.getElement(t.source),this._jsPlumb.uuid=t.uuid,this._jsPlumb.floatingEndpoint=null;var d=null;this._jsPlumb.uuid&&(t.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=t.elementId,this.dragProxy=t.dragProxy,this._jsPlumb.connectionCost=t.connectionCost,this._jsPlumb.connectionsDirected=t.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var u=!0===t.deleteOnEmpty;this.setDeleteOnEmpty=function(t){u=t};var p=(function(){var t=l.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var i=l.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(t),this.addClass(i),e.updateClasses(this.element,i,t)}).bind(this);this.prepareAnchor=function(t){var e=this._jsPlumb.instance.makeAnchor(t,this.elementId,l);return e.bind("anchorChanged",(function(t){this.fire("anchorChanged",{endpoint:this,anchor:t}),p()}).bind(this)),e},this.setPreparedAnchor=function(t,e){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=t,p(),e||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(t,e){var i=this.prepareAnchor(t);return this.setPreparedAnchor(i,e),this};var f=(function(t){if(this.connections.length>0)for(var e=0;e<this.connections.length;e++)this.connections[e].setHover(t,!1);else this.setHover(t)}).bind(this);this.bind("mouseover",(function(){f(!0)})),this.bind("mouseout",(function(){f(!1)})),t._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(s,n){var r,o=function(t,i){var s=l.getRenderMode();if(e.Endpoints[s][t])return new e.Endpoints[s][t](i);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}},a={_jsPlumb:this._jsPlumb.instance,cssClass:t.cssClass,container:t.container,tooltip:t.tooltip,connectorTooltip:t.connectorTooltip,endpoint:this};return i.isString(s)?r=o(s,a):i.isArray(s)?(a=i.merge(s[1],a),r=o(s[0],a)):r=s.clone(),r.clone=(function(){return i.isString(s)?o(s,a):i.isArray(s)?(a=i.merge(s[1],a),o(s[0],a)):void 0}).bind(this),r.typeId=n,r},this.setEndpoint=function(t,e){var i=this.prepareEndpoint(t);this.setPreparedEndpoint(i,!0)},this.setPreparedEndpoint=function(t,e){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=t,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},e.extend(this,t,o),this.isSource=t.isSource||!1,this.isTemporarySource=t.isTemporarySource||!1,this.isTarget=t.isTarget||!1,this.connections=t.connections||[],this.connectorPointerEvents=t["connector-pointer-events"],this.scope=t.scope||l.getDefaultScope(),this.timestamp=null,this.reattachConnections=t.reattach||l.Defaults.ReattachConnections,this.connectionsDetachable=l.Defaults.ConnectionsDetachable,(!1===t.connectionsDetachable||!1===t.detachable)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=!1!==t.dragAllowedWhenFull,t.onMaxConnections&&this.bind("maxConnections",t.onMaxConnections),this.addConnection=function(t){this.connections.push(t),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)},this.detachFromConnection=function(t,e,i){(e=null==e?this.connections.indexOf(t):e)>=0&&(this.connections.splice(e,1),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)),!i&&u&&0===this.connections.length&&l.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!0!==i})},this.deleteEveryConnection=function(t){for(var e=this.connections.length,i=0;e>i;i++)l.deleteConnection(this.connections[0],t)},this.detachFrom=function(t,e,i){for(var s=[],n=0;n<this.connections.length;n++)(this.connections[n].endpoints[1]===t||this.connections[n].endpoints[0]===t)&&s.push(this.connections[n]);for(var r=0,o=s.length;o>r;r++)l.deleteConnection(s[0]);return this},this.getElement=function(){return this.element},this.setElement=function(s){var n=this._jsPlumb.instance.getId(s),r=this.elementId;return i.removeWithFunction(t.endpointsByElement[this.elementId],(function(t){return t.id===this.id}).bind(this)),this.element=e.getElement(s),this.elementId=l.getId(this.element),l.anchorManager.rehomeEndpoint(this,r,this.element),l.dragManager.endpointAdded(this.element),i.addToList(t.endpointsByElement,n,this),this},this.makeInPlaceCopy=function(){var e=this.anchor.getCurrentLocation({element:this}),i=this.anchor.getOrientation(this),s=this.anchor.getCssClass();return c({dropOptions:t.dropOptions,anchor:{bind:function(){},compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return i},getCssClass:function(){return s}},source:this.element,paintStyle:this.getPaintStyle(),endpoint:t.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(t){var e=(t=t||{}).timestamp,i=!(!1===t.recalc);if(!e||this.timestamp!==e){var s=l.updateOffset({elId:this.elementId,timestamp:e}),n=t.offset?t.offset.o:s.o;if(null!=n){var r=t.anchorPoint,o=t.connectorPaintStyle;if(null==r){var h={xy:[n.left,n.top],wh:t.dimensions||s.s,element:this,timestamp:e};if(i&&this.anchor.isDynamic&&this.connections.length>0){var c=a(this,t.elementWithPrecedence),d=c.endpoints[0]===this?1:0,u=l.getCachedData(0===d?c.sourceId:c.targetId),p=u.o,f=u.s;h.index=0===d?1:0,h.connection=c,h.txy=[p.left,p.top],h.twh=f,h.tElement=c.endpoints[d]}else this.connections.length>0&&(h.connection=this.connections[0]);r=this.anchor.compute(h)}for(var m in this.endpoint.compute(r,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,o||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=e,this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(m)){var g=this._jsPlumb.overlays[m];g.isVisible()&&(this._jsPlumb.overlayPlacements[m]=g.draw(this.endpoint,this._jsPlumb.paintStyleInUse),g.paint(this._jsPlumb.overlayPlacements[m]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var m=!1;this.initDraggable=function(){if(!m&&e.isDragSupported(this.element)){var o,a={id:null,element:null},u=null,p=!1,f=null,g=s(this,a,l),b=t.dragOptions||{},y=e.dragEvents.start,v=e.dragEvents.stop,C=e.dragEvents.drag,x=e.dragEvents.beforeStart,_=(function(i){u=this.connectorSelector();var s=!0;this.isEnabled()||(s=!1),null!=u||this.isSource||this.isTemporarySource||(s=!1),!this.isSource||!this.isFull()||null!=u&&this.dragAllowedWhenFull||(s=!1),null==u||u.isDetachable(this)||(this.isFull()?s=!1:u=null);var d=l.checkCondition(null==u?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:u});if(!1===d?s=!1:"object"==typeof d?e.extend(d,o||{}):d=o||{},!1===s)return l.stopDrag&&l.stopDrag(this.canvas),g.stopDrag(),!1;for(var m=0;m<this.connections.length;m++)this.connections[m].setHover(!1);this.addClass("endpointDrag"),l.setConnectionBeingDragged(!0),u&&!this.isFull()&&this.isSource&&(u=null),l.updateOffset({elId:this.elementId});var b=this._jsPlumb.instance.getOffset(this.canvas),y=this.canvas,v=this._jsPlumb.instance.getSize(this.canvas);n(a,l,b,v),l.setAttributes(this.canvas,{dragId:a.id,elId:this.elementId});var C=this.dragProxy||this.endpoint;if(null==this.dragProxy&&null!=this.connectionType){var x=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);x.endpoints[1]&&(C=x.endpoints[1])}var _=this._jsPlumb.instance.makeAnchor("Center");_.isFloating=!0,this._jsPlumb.floatingEndpoint=r(this.getPaintStyle(),_,C,this.canvas,a.element,l,c,this.scope);var P=this._jsPlumb.floatingEndpoint.anchor;if(null==u)this.setHover(!1,!1),(u=h({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:a.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:t.connectorStyle,hoverPaintStyle:t.connectorHoverStyle,connector:t.connector,overlays:t.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:t.scope,data:d})).pending=!0,u.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.anchor=P,l.fire("connectionDrag",u),l.anchorManager.newConnection(u);else{p=!0,u.setHover(!1);var S=u.endpoints[0].id===this.id?0:1;this.detachFromConnection(u,null,!0);var w=l.getDragScope(y);l.setAttribute(this.canvas,"originalScope",w),l.fire("connectionDrag",u),0===S?(f=[u.source,u.sourceId,y,w],l.anchorManager.sourceChanged(u.endpoints[S].elementId,a.id,u,a.element)):(f=[u.target,u.targetId,y,w],u.target=a.element,u.targetId=a.id,l.anchorManager.updateOtherEndpoint(u.sourceId,u.endpoints[S].elementId,u.targetId,u)),u.suspendedEndpoint=u.endpoints[S],u.suspendedElement=u.endpoints[S].getElement(),u.suspendedElementId=u.endpoints[S].elementId,u.suspendedElementType=0===S?"source":"target",u.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=u.suspendedEndpoint,u.endpoints[S]=this._jsPlumb.floatingEndpoint,u.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass)}l.registerFloatingConnection(a,u,this._jsPlumb.floatingEndpoint),l.currentlyDragging=!0}).bind(this),P=(function(){if(l.setConnectionBeingDragged(!1),u&&null!=u.endpoints){var t=l.getDropEvent(arguments),e=l.getFloatingAnchorIndex(u);if(u.endpoints[0===e?1:0].anchor.unlock(),u.removeClass(l.draggingClass),this._jsPlumb&&(u.deleteConnectionNow||u.endpoints[e]===this._jsPlumb.floatingEndpoint)&&p&&u.suspendedEndpoint){0===e?(u.floatingElement=u.source,u.floatingId=u.sourceId,u.floatingEndpoint=u.endpoints[0],u.floatingIndex=0,u.source=f[0],u.sourceId=f[1]):(u.floatingElement=u.target,u.floatingId=u.targetId,u.floatingEndpoint=u.endpoints[1],u.floatingIndex=1,u.target=f[0],u.targetId=f[1]);var i=this._jsPlumb.floatingEndpoint;l.setDragScope(f[2],f[3]),u.endpoints[e]=u.suspendedEndpoint,u.isReattach()||u._forceReattach||u._forceDetach||!l.deleteConnection(u,{originalEvent:t})?(u.setHover(!1),u._forceDetach=null,u._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(u),u.suspendedEndpoint.addConnection(u),1===e?l.anchorManager.updateOtherEndpoint(u.sourceId,u.floatingId,u.targetId,u):l.anchorManager.sourceChanged(u.floatingId,u.sourceId,u,u.source),l.repaint(f[1])):l.deleteObject({endpoint:i})}this.deleteAfterDragStop?l.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),l.fire("connectionDragStop",u,t),u.pending&&l.fire("connectionAborted",u,t),l.currentlyDragging=!1,u.suspendedElement=null,u.suspendedEndpoint=null,u=null}a&&a.element&&l.remove(a.element,!1,!1),d&&l.deleteObject({endpoint:d}),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}).bind(this);(b=e.extend({},b)).scope=this.scope||b.scope,b[x]=i.wrap(b[x],(function(t){o=t.e.payload||{}}),!1),b[y]=i.wrap(b[y],_,!1),b[C]=i.wrap(b[C],g.drag),b[v]=i.wrap(b[v],P),b.multipleDrop=!1,b.canDrag=(function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&!1!==this.connectionsDetachable}).bind(this),l.initDraggable(this.canvas,b,"internal"),this.canvas._jsPlumbRelatedElement=this.element,m=!0}};var g=t.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(g,!0);var b=t.anchor?t.anchor:t.anchors?t.anchors:l.Defaults.Anchor||"Top";this.setAnchor(b,!0);var y=["default",t.type||""].join(" ");this.addType(y,t.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var v=(function(s,n,r,o){if(e.isDropSupported(this.element)){var a=t.dropOptions||l.Defaults.DropOptions||e.Defaults.DropOptions;(a=e.extend({},a)).scope=a.scope||this.scope;var h=e.dragEvents.drop,c=e.dragEvents.over,d=e.dragEvents.out,u=this,p=l.EndpointDropHandler({getEndpoint:function(){return u},jsPlumb:l,enabled:function(){return null==r||r.isEnabled()},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(t){u.addClass(t)},removeClass:function(t){u.removeClass(t)},isDropAllowed:function(){return u.isDropAllowed.apply(u,arguments)},reference:o,isRedrop:function(t,e){return t.suspendedEndpoint&&e.reference&&t.suspendedEndpoint.id===e.reference.id}});a[h]=i.wrap(a[h],p,!0),a[c]=i.wrap(a[c],(function(){var t=e.getDragObject(arguments),i=l.getAttribute(e.getElement(t),"dragId"),s=l.getFloatingConnectionFor(i);if(null!=s){var n=l.getFloatingAnchorIndex(s),r=this.isTarget&&0!==n||s.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===s.suspendedEndpoint.id;if(r){var o=l.checkCondition("checkDropAllowed",{sourceEndpoint:s.endpoints[n],targetEndpoint:this,connection:s});this[(o?"add":"remove")+"Class"](l.endpointDropAllowedClass),this[(o?"remove":"add")+"Class"](l.endpointDropForbiddenClass),s.endpoints[n].anchor.over(this.anchor,this)}}}).bind(this)),a[d]=i.wrap(a[d],(function(){var t=e.getDragObject(arguments),i=null==t?null:l.getAttribute(e.getElement(t),"dragId"),s=i?l.getFloatingConnectionFor(i):null;if(null!=s){var n=l.getFloatingAnchorIndex(s),r=this.isTarget&&0!==n||s.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===s.suspendedEndpoint.id;r&&(this.removeClass(l.endpointDropAllowedClass),this.removeClass(l.endpointDropForbiddenClass),s.endpoints[n].anchor.out())}}).bind(this)),l.initDroppable(s,a,"internal",n)}}).bind(this);return this.anchor.isFloating||v(this.canvas,!(t._transient||this.anchor.isFloating),this,t.reference),this},i.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(t,e,i){if(this._jsPlumb.visible=t,this.canvas&&(this.canvas.style.display=t?"block":"none"),this[t?"showOverlays":"hideOverlays"](),!e)for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(t),!i){var n=this===this.connections[s].endpoints[0]?1:0;1===this.connections[s].endpoints[n].connections.length&&this.connections[s].endpoints[n].setVisible(t,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(t,i){this.setPaintStyle(t.endpointStyle||t.paintStyle,i),this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,i),null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections),t.scope&&(this.scope=t.scope),e.extend(this,t,o),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){e.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"")),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(t){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(t)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(t){var e=!1;if(t)for(var i=0;i<this.connections.length;i++)if(this.connections[i].endpoints[1]===t||this.connections[i].endpoints[0]===t){e=!0;break}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t,this.anchor.elementId=t},setReferenceElement:function(t){this.element=e.getElement(t)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}}),t.jsPlumbInstance.prototype.EndpointDropHandler=function(t){return function(e){var s=t.jsPlumb;t.removeClass(s.endpointDropAllowedClass),t.removeClass(s.endpointDropForbiddenClass);var n=s.getDropEvent(arguments),r=s.getDragObject(arguments),o=s.getAttribute(r,"dragId"),a=(s.getAttribute(r,"elId"),s.getAttribute(r,"originalScope")),l=s.getFloatingConnectionFor(o);if(null!=l){var h=null!=l.suspendedEndpoint;if(!h||null!=l.suspendedEndpoint._jsPlumb){var c=t.getEndpoint(l);if(null!=c){if(t.isRedrop(l,t))return l._forceReattach=!0,l.setHover(!1),void(t.maybeCleanup&&t.maybeCleanup(c));var d=s.getFloatingAnchorIndex(l);if(0===d&&!t.isSource||1===d&&!t.isTarget)return void(t.maybeCleanup&&t.maybeCleanup(c));t.onDrop&&t.onDrop(l),a&&s.setDragScope(r,a);var u=t.isFull(e);if(u&&c.fire("maxConnections",{endpoint:this,connection:l,maxConnections:c._jsPlumb.maxConnections},n),!u&&t.enabled()){var p=!0;0===d?(l.floatingElement=l.source,l.floatingId=l.sourceId,l.floatingEndpoint=l.endpoints[0],l.floatingIndex=0,l.source=t.element,l.sourceId=t.elementId):(l.floatingElement=l.target,l.floatingId=l.targetId,l.floatingEndpoint=l.endpoints[1],l.floatingIndex=1,l.target=t.element,l.targetId=t.elementId),h&&l.suspendedEndpoint.id!==c.id&&(l.isDetachAllowed(l)&&l.endpoints[d].isDetachAllowed(l)&&l.suspendedEndpoint.isDetachAllowed(l)&&s.checkCondition("beforeDetach",l)||(p=!1));var f=(function(e){l.endpoints[d].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),l.endpoints[d]=c,c.addConnection(l);var r=c.getParameters();for(var o in r)l.setParameter(o,r[o]);if(h){var a=l.suspendedEndpoint.elementId;s.fireMoveEvent({index:d,originalSourceId:0===d?a:l.sourceId,newSourceId:0===d?c.elementId:l.sourceId,originalTargetId:1===d?a:l.targetId,newTargetId:1===d?c.elementId:l.targetId,originalSourceEndpoint:0===d?l.suspendedEndpoint:l.endpoints[0],newSourceEndpoint:0===d?c:l.endpoints[0],originalTargetEndpoint:1===d?l.suspendedEndpoint:l.endpoints[1],newTargetEndpoint:1===d?c:l.endpoints[1],connection:l},n)}else r.draggable&&s.initDraggable(this.element,t.dragOptions,"internal",s);1===d?s.anchorManager.updateOtherEndpoint(l.sourceId,l.floatingId,l.targetId,l):s.anchorManager.sourceChanged(l.floatingId,l.sourceId,l,l.source),l.endpoints[0].finalEndpoint&&(l.endpoints[0].detachFromConnection(l),l.endpoints[0]=l.endpoints[0].finalEndpoint,l.endpoints[0].addConnection(l)),i.isObject(e)&&l.mergeData(e),s.finaliseConnection(l,null,n,!1),l.setHover(!1),s.revalidate(l.endpoints[0].element)}).bind(this),m=function(){l.suspendedEndpoint&&(l.endpoints[d]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,0===d?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),1===d?s.anchorManager.updateOtherEndpoint(l.sourceId,l.floatingId,l.targetId,l):s.anchorManager.sourceChanged(l.floatingId,l.sourceId,l,l.source),s.repaint(l.sourceId),l._forceDetach=!1)};if(p=p&&t.isDropAllowed(l.sourceId,l.targetId,l.scope,l,c))return f(p),!0;m()}t.maybeCleanup&&t.maybeCleanup(c),s.currentlyDragging=!1}}}}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=function(t,s,n,r,o){if(e.Connectors[s]=e.Connectors[s]||{},null==e.Connectors[s][n]){if(null==e.Connectors[n]){if(t.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+n+"'")}e.Connectors[s][n]=function(){e.Connectors[n].apply(this,arguments),e.ConnectorRenderers[s].apply(this,arguments)},i.extend(e.Connectors[s][n],[e.Connectors[n],e.ConnectorRenderers[s]])}return new e.Connectors[s][n](r,o)},n=function(t,e,i){return t?i.makeAnchor(t,e,i):null},r=function(t,e,s,n){null!=e&&(e._jsPlumbConnections=e._jsPlumbConnections||{},n?delete e._jsPlumbConnections[t.id]:e._jsPlumbConnections[t.id]=!0,i.isEmpty(e._jsPlumbConnections)?s.removeClass(e,s.connectedClass):s.addClass(e,s.connectedClass))};e.Connection=function(t){var s=t.newEndpoint;this.id=t.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=t.previousConnection,this.source=e.getElement(t.source),this.target=e.getElement(t.target),e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),t.sourceEndpoint?(this.source=t.sourceEndpoint.getElement(),this.sourceId=t.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),t.targetEndpoint?(this.target=t.targetEndpoint.getElement(),this.targetId=t.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var n=this._jsPlumb.instance;n.manage(this.sourceId,this.source),n.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams,overlays:t.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",(function(){this.setHover(!0)}).bind(this)),this.bind("mouseout",(function(){this.setHover(!1)}).bind(this)),this.makeEndpoint=function(e,i,r,o,a){return r=r||this._jsPlumb.instance.getId(i),this.prepareEndpoint(n,s,this,o,e?0:1,t,i,r,a)},t.type&&(t.endpoints=t.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(t.type).endpoints);var r=this.makeEndpoint(!0,this.source,this.sourceId,t.sourceEndpoint),o=this.makeEndpoint(!1,this.target,this.targetId,t.targetEndpoint);r&&i.addToList(t.endpointsByElement,this.sourceId,r),o&&i.addToList(t.endpointsByElement,this.targetId,o),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnEmpty&&(this.endpoints[0].setDeleteOnEmpty(t.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(t.deleteEndpointsOnEmpty));var a=n.Defaults.ConnectionsDetachable;!1===t.detachable&&(a=!1),!1===this.endpoints[0].connectionsDetachable&&(a=!1),!1===this.endpoints[1].connectionsDetachable&&(a=!1);var l=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||n.Defaults.ReattachConnections;this.appendToDefaultType({detachable:a,reattach:l,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||n.Defaults.PaintStyle||e.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||n.Defaults.HoverPaintStyle||e.Defaults.HoverPaintStyle});var h=n.getSuspendedAt();if(!n.isSuspendDrawing()){var c=n.getCachedData(this.sourceId),d=c.o,u=c.s,p=n.getCachedData(this.targetId),f=p.o,m=p.s,g=h||n.timestamp(),b=this.endpoints[0].anchor.compute({xy:[d.left,d.top],wh:u,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[f.left,f.top],twh:m,tElement:this.endpoints[1],timestamp:g});this.endpoints[0].paint({anchorLoc:b,timestamp:g}),b=this.endpoints[1].anchor.compute({xy:[f.left,f.top],wh:m,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[d.left,d.top],twh:u,tElement:this.endpoints[0],timestamp:g}),this.endpoints[1].paint({anchorLoc:b,timestamp:g})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(t){return!1!==this._jsPlumb.detachable&&(null!=t?!0===t.connectionsDetachable:!0===this._jsPlumb.detachable)},this.setDetachable=function(t){this._jsPlumb.detachable=!0===t},this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections},this.setReattach=function(t){this._jsPlumb.reattach=!0===t},this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var y=e.extend({},this.endpoints[1].getParameters());e.extend(y,this.endpoints[0].getParameters()),e.extend(y,this.getParameters()),this.setParameters(y),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||n.Defaults.Connector||e.Defaults.Connector,!0);var v=null!=t.data&&i.isObject(t.data)?t.data:{};this.getData=function(){return v},this.setData=function(t){v=t||{}},this.mergeData=function(t){v=e.extend(v,t)};var C=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,t.type].join(" ");/[^\s]/.test(C)&&this.addType(C,t.data,!0),this.updateConnectedClass()},i.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(t,i,s){var n=null;null!=t.connector&&(null==(n=this.getCachedTypeItem("connector",s.connector))&&(n=this.prepareConnector(t.connector,s.connector),this.cacheTypeItem("connector",n,s.connector)),this.setPreparedConnector(n)),null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var r=null;t.anchor?null==(r=this.getCachedTypeItem("anchors",s.anchor))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",r,s.anchor)):t.anchors&&null==(r=this.getCachedTypeItem("anchors",s.anchors))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",r,s.anchors)),null!=r&&(this.endpoints[0].anchor=r[0],this.endpoints[1].anchor=r[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(t,e){e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,e){e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this.connector&&this.connector.setVisible(t),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(t){this._jsPlumb&&(r(this,this.source,this._jsPlumb.instance,t),r(this,this.target,this._jsPlumb.instance,t))},setHover:function(e){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(e),t.jsPlumb[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),t.jsPlumb[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(t,e){var n,r={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},o=this._jsPlumb.instance.getRenderMode();return i.isString(t)?n=s(this._jsPlumb.instance,o,t,r,this):i.isArray(t)&&(n=s(this._jsPlumb.instance,o,t[0],1===t.length?r:i.merge(t[1],r),this)),null!=e&&(n.typeId=e),n},setPreparedConnector:function(t,e,i,s){if(this.connector!==t){var n,r="";if(null!=this.connector&&(r=(n=this.connector).getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=t,s&&this.cacheTypeItem("connector",t,s),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(r),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=n)for(var o=this.getOverlays(),a=0;a<o.length;a++)o[a].transfer&&o[a].transfer(this.connector);i||this.setListenerComponent(this.connector),e||this.repaint()}},setConnector:function(t,e,i,s){var n=this.prepareConnector(t,s);this.setPreparedConnector(n,e,i,s)},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){var e=(t=t||{}).timestamp,i=this.targetId;if(null==e||e!==this._jsPlumb.lastPaintedAt){var s=this._jsPlumb.instance.updateOffset({elId:this.sourceId}).o,n=this._jsPlumb.instance.updateOffset({elId:i}).o,r=this.endpoints[0],o=this.endpoints[1],a=r.anchor.getCurrentLocation({xy:[s.left,s.top],wh:[s.width,s.height],element:r,timestamp:e}),l=o.anchor.getCurrentLocation({xy:[n.left,n.top],wh:[n.width,n.height],element:o,timestamp:e});this.connector.resetBounds(),this.connector.compute({sourcePos:a,targetPos:l,sourceOrientation:r.anchor.getOrientation(r),targetOrientation:o.anchor.getOrientation(o),sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:s,targetInfo:n});var h={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var c in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(c)){var d=this._jsPlumb.overlays[c];d.isVisible()&&(this._jsPlumb.overlayPlacements[c]=d.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(d)),h.minX=Math.min(h.minX,this._jsPlumb.overlayPlacements[c].minX),h.maxX=Math.max(h.maxX,this._jsPlumb.overlayPlacements[c].maxX),h.minY=Math.min(h.minY,this._jsPlumb.overlayPlacements[c].minY),h.maxY=Math.max(h.maxY,this._jsPlumb.overlayPlacements[c].maxY))}var u=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,p=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),f={xmin:Math.min(this.connector.bounds.minX-(u+p),h.minX),ymin:Math.min(this.connector.bounds.minY-(u+p),h.minY),xmax:Math.max(this.connector.bounds.maxX+(u+p),h.maxX),ymax:Math.max(this.connector.bounds.maxY+(u+p),h.maxY)};for(var m in this.connector.paint(this._jsPlumb.paintStyleInUse,null,f),this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(m)){var g=this._jsPlumb.overlays[m];g.isVisible()&&g.paint(this._jsPlumb.overlayPlacements[m],f)}}this._jsPlumb.lastPaintedAt=e}},repaint:function(t){var e=jsPlumb.extend(t||{},{});e.elId=this.sourceId,this.paint(e)},prepareEndpoint:function(t,i,s,r,o,a,l,h,c){var d;if(r)s.endpoints[o]=r,r.addConnection(s);else{a.endpoints||(a.endpoints=[null,null]);var u=c||a.endpoints[o]||a.endpoint||t.Defaults.Endpoints[o]||e.Defaults.Endpoints[o]||t.Defaults.Endpoint||e.Defaults.Endpoint;a.endpointStyles||(a.endpointStyles=[null,null]),a.endpointHoverStyles||(a.endpointHoverStyles=[null,null]);var p=a.endpointStyles[o]||a.endpointStyle||t.Defaults.EndpointStyles[o]||e.Defaults.EndpointStyles[o]||t.Defaults.EndpointStyle||e.Defaults.EndpointStyle;null==p.fill&&null!=a.paintStyle&&(p.fill=a.paintStyle.stroke),null==p.outlineStroke&&null!=a.paintStyle&&(p.outlineStroke=a.paintStyle.outlineStroke),null==p.outlineWidth&&null!=a.paintStyle&&(p.outlineWidth=a.paintStyle.outlineWidth);var f=a.endpointHoverStyles[o]||a.endpointHoverStyle||t.Defaults.EndpointHoverStyles[o]||e.Defaults.EndpointHoverStyles[o]||t.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle;null!=a.hoverPaintStyle&&(null==f&&(f={}),null==f.fill&&(f.fill=a.hoverPaintStyle.stroke));var m=a.anchors?a.anchors[o]:a.anchor?a.anchor:n(t.Defaults.Anchors[o],h,t)||n(e.Defaults.Anchors[o],h,t)||n(t.Defaults.Anchor,h,t)||n(e.Defaults.Anchor,h,t);d=i({paintStyle:p,hoverPaintStyle:f,endpoint:u,connections:[s],uuid:a.uuids?a.uuids[o]:null,anchor:m,source:l,scope:a.scope,reattach:a.reattach||t.Defaults.ReattachConnections,detachable:a.detachable||t.Defaults.ConnectionsDetachable}),null==r&&d.setDeleteOnEmpty(!0),s.endpoints[o]=d,!1===a.drawEndpoints&&d.setVisible(!1,!0,!0)}return d},replaceEndpoint:function(t,e){var i=this.endpoints[t],s=i.elementId,n=this._jsPlumb.instance.getEndpoints(s),r=n.indexOf(i),o=this.makeEndpoint(0===t,i.element,s,null,e);this.endpoints[t]=o,n.splice(r,1,o),this._jsPlumb.instance.deleteObject({endpoint:i,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:i,current:o}),this._jsPlumb.instance.anchorManager.updateOtherEndpoint(this.endpoints[0].elementId,this.endpoints[1].elementId,this.endpoints[1].elementId,this)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=t.jsPlumb;i.AnchorManager=function(t){var s={},n={},r={},o={},a=this,l={},h=t.jsPlumbInstance,c={},d=function(t){return function(e,i){return 0==(t?e[0][0]<i[0][0]:e[0][0]>i[0][0])?-1:1}},u={top:function(t,e){return t[0]>e[0]?1:-1},right:d(!0),bottom:d(!0),left:function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])>(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])?1:-1}},p=function(t,e){var i=h.getCachedData(t),s=i.s,o=i.o,a=function(e,i,s,o,a,l,h){if(o.length>0)for(var c=function(t,e,i,s,n,r,o){for(var a=[],l=e[n?0:1]/(s.length+1),h=0;h<s.length;h++){var c=(h+1)*l,d=r*e[n?1:0];o&&(c=e[n?0:1]-c);var u=n?c:d,p=n?d:c;a.push([i[0]+u,i[1]+p,u/e[0],p/e[1],s[h][1],s[h][2]])}return a}(0,i,s,function(t,e){return t.sort(e)}(o,u[e]),a,l,"right"===e||"top"===e),d=function(t,e){n[t.id]=[e[0],e[1],e[2],e[3]],r[t.id]=h},p=0;p<c.length;p++){var f=c[p][4],m=f.endpoints[1].elementId===t;f.endpoints[0].elementId===t&&d(f.endpoints[0],c[p]),m&&d(f.endpoints[1],c[p])}};a("bottom",s,[o.left,o.top],e.bottom,!0,1,[0,1]),a("top",s,[o.left,o.top],e.top,!0,0,[0,-1]),a("left",s,[o.left,o.top],e.left,!1,0,[-1,0]),a("right",s,[o.left,o.top],e.right,!1,1,[1,0])};this.reset=function(){s={},o={},l={}},this.addFloatingConnection=function(t,e){c[t]=e},this.removeFloatingConnection=function(t){delete c[t]},this.newConnection=function(t){var s=t.sourceId,n=t.targetId,r=t.endpoints,a=!0,l=function(l,h,c,d,u){s===n&&c.isContinuous&&(t._jsPlumb.instance.removeElement(r[1].canvas),a=!1),e.addToList(o,d,[u,h,c.constructor===i.DynamicAnchor])};l(0,r[0],r[0].anchor,n,t),a&&l(0,r[1],r[1].anchor,s,t)};var f=function(t){!function(t,i){if(t){var s=function(t){return t[4]===i};e.removeWithFunction(t.top,s),e.removeWithFunction(t.left,s),e.removeWithFunction(t.bottom,s),e.removeWithFunction(t.right,s)}}(l[t.elementId],t.id)};this.connectionDetached=function(t,i){var s=t.connection||t,n=t.targetId,r=function(t,i,s,n,r){e.removeWithFunction(o[n],(function(t){return t[0].id===r.id}))};r(0,0,0,t.sourceId,s),r(0,0,0,n,s),s.floatingId&&(r(0,0,0,s.floatingId,s),f(s.floatingEndpoint)),f(s.endpoints[0]),f(s.endpoints[1]),i||(a.redraw(s.sourceId),s.targetId!==s.sourceId&&a.redraw(s.targetId))},this.add=function(t,i){e.addToList(s,i,t)},this.changeId=function(t,e){o[e]=o[t],s[e]=s[t],delete o[t],delete s[t]},this.getConnectionsFor=function(t){return o[t]||[]},this.getEndpointsFor=function(t){return s[t]||[]},this.deleteEndpoint=function(t){e.removeWithFunction(s[t.elementId],(function(e){return e.id===t.id})),f(t)},this.clearFor=function(t){delete s[t],s[t]=[]};var m=function(i,s,n,r,o,a,l,h,c,d,u,p){var f,m,g=-1,b=r.endpoints[l],y=b.id,v=[1,0][l],C=[[s,n],r,o,a,y],x=i[c],_=b._continuousAnchorEdge?i[b._continuousAnchorEdge]:null;if(_){var P=e.findWithFunction(_,(function(t){return t[4]===y}));if(-1!==P)for(_.splice(P,1),f=0;f<_.length;f++)e.addWithFunction(u,m=_[f][1],(function(t){return t.id===m.id})),e.addWithFunction(p,_[f][1].endpoints[l],(function(t){return t.id===m.endpoints[l].id})),e.addWithFunction(p,_[f][1].endpoints[v],(function(t){return t.id===m.endpoints[v].id}))}for(f=0;f<x.length;f++)1===t.idx&&x[f][3]===a&&-1===g&&(g=f),e.addWithFunction(u,m=x[f][1],(function(t){return t.id===m.id})),e.addWithFunction(p,x[f][1].endpoints[l],(function(t){return t.id===m.endpoints[l].id})),e.addWithFunction(p,x[f][1].endpoints[v],(function(t){return t.id===m.endpoints[v].id}));x.splice(h?-1!==g?g:0:x.length,0,C),b._continuousAnchorEdge=c};this.updateOtherEndpoint=function(t,s,n,r){var a=e.findWithFunction(o[t],(function(t){return t[0].id===r.id})),l=e.findWithFunction(o[s],(function(t){return t[0].id===r.id}));-1!==a&&(o[t][a][0]=r,o[t][a][1]=r.endpoints[1],o[t][a][2]=r.endpoints[1].anchor.constructor===i.DynamicAnchor),l>-1&&(o[s].splice(l,1),e.addToList(o,n,[r,r.endpoints[0],r.endpoints[0].anchor.constructor===i.DynamicAnchor])),r.updateConnectedClass()},this.sourceChanged=function(t,s,n,r){if(t!==s){n.sourceId=s,n.source=r,e.removeWithFunction(o[t],(function(t){return t[0].id===n.id}));var a=e.findWithFunction(o[n.targetId],(function(t){return t[0].id===n.id}));a>-1&&(o[n.targetId][a][0]=n,o[n.targetId][a][1]=n.endpoints[0],o[n.targetId][a][2]=n.endpoints[0].anchor.constructor===i.DynamicAnchor),e.addToList(o,s,[n,n.endpoints[1],n.endpoints[1].anchor.constructor===i.DynamicAnchor]),n.endpoints[1].anchor.isContinuous&&(n.source===n.target?n._jsPlumb.instance.removeElement(n.endpoints[1].canvas):null==n.endpoints[1].canvas.parentNode&&n._jsPlumb.instance.appendElement(n.endpoints[1].canvas)),n.updateConnectedClass()}},this.rehomeEndpoint=function(t,e,i){var n=s[e]||[],r=h.getId(i);if(r!==e){var o=n.indexOf(t);if(o>-1){var l=n.splice(o,1)[0];a.add(l,r)}}for(var c=0;c<t.connections.length;c++)t.connections[c].sourceId===e?a.sourceChanged(e,t.elementId,t.connections[c],t.element):t.connections[c].targetId===e&&(t.connections[c].targetId=t.elementId,t.connections[c].target=t.element,a.updateOtherEndpoint(t.connections[c].sourceId,e,t.elementId,t.connections[c]))},this.redraw=function(t,n,r,a,d,u){if(!h.isSuspendDrawing()){var f=s[t]||[],g=o[t]||[],b=[],y=[],v=[];r=r||h.timestamp(),a=a||{left:0,top:0},n&&(n={left:n.left+a.left,top:n.top+a.top});for(var C=h.updateOffset({elId:t,offset:n,recalc:!1,timestamp:r}),x={},_=0;_<g.length;_++){var P=g[_][0],S=P.sourceId,w=P.targetId,E=P.endpoints[0].anchor.isContinuous,k=P.endpoints[1].anchor.isContinuous;if(E||k){var A=S+"_"+w,T=x[A],M=P.sourceId===t?1:0;E&&!l[S]&&(l[S]={top:[],right:[],bottom:[],left:[]}),k&&!l[w]&&(l[w]={top:[],right:[],bottom:[],left:[]}),t!==w&&h.updateOffset({elId:w,timestamp:r}),t!==S&&h.updateOffset({elId:S,timestamp:r});var O=h.getCachedData(w),N=h.getCachedData(S);w===S&&(E||k)?(m(l[S],-Math.PI/2,0,P,!1,w,0,!1,"top",0,b,y),m(l[w],-Math.PI/2,0,P,!1,S,1,!1,"top",0,b,y)):(T||(T=this.calculateOrientation(S,w,N.o,O.o,P.endpoints[0].anchor,P.endpoints[1].anchor,P),x[A]=T),E&&m(l[S],T.theta,0,P,!1,w,0,!1,T.a[0],0,b,y),k&&m(l[w],T.theta2,-1,P,!0,S,1,!0,T.a[1],0,b,y)),E&&e.addWithFunction(v,S,(function(t){return t===S})),k&&e.addWithFunction(v,w,(function(t){return t===w})),e.addWithFunction(b,P,(function(t){return t.id===P.id})),(E&&0===M||k&&1===M)&&e.addWithFunction(y,P.endpoints[M],(function(t){return t.id===P.endpoints[M].id}))}}for(_=0;_<f.length;_++)0===f[_].connections.length&&f[_].anchor.isContinuous&&(l[t]||(l[t]={top:[],right:[],bottom:[],left:[]}),m(l[t],-Math.PI/2,0,{endpoints:[f[_],f[_]],paint:function(){}},!1,t,0,!1,f[_].anchor.getDefaultFace(),0,b,y),e.addWithFunction(v,t,(function(e){return e===t})));for(_=0;_<v.length;_++)p(v[_],l[v[_]]);for(_=0;_<f.length;_++)f[_].paint({timestamp:r,offset:C,dimensions:C.s,recalc:!0!==u});for(_=0;_<y.length;_++){var L=h.getCachedData(y[_].elementId);y[_].paint({timestamp:null,offset:L,dimensions:L.s})}for(_=0;_<g.length;_++){var D=g[_][1];if(D.anchor.constructor===i.DynamicAnchor){D.paint({elementWithPrecedence:t,timestamp:r}),e.addWithFunction(b,g[_][0],(function(t){return t.id===g[_][0].id}));for(var j=0;j<D.connections.length;j++)D.connections[j]!==g[_][0]&&e.addWithFunction(b,D.connections[j],(function(t){return t.id===D.connections[j].id}))}else e.addWithFunction(b,g[_][0],(function(t){return t.id===g[_][0].id}))}var I=c[t];for(I&&I.paint({timestamp:r,recalc:!1,elId:t}),_=0;_<b.length;_++)b[_].paint({elId:t,timestamp:null,recalc:!1,clearEdits:d})}};var g=function(t){e.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var i=t.faces||["top","right","bottom","left"],s=!(!1===t.clockwise),o={},a={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},h={top:"left",right:"top",left:"bottom",bottom:"right"},c=s?l:h,d=s?h:l,u=t.cssClass||"",p=null,f=null,m=["left","right"],g=["top","bottom"],b=null,y=0;y<i.length;y++)o[i[y]]=!0;this.getDefaultFace=function(){return 0===i.length?"top":i[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(t){return o[t]?t:o[a[t]]?a[t]:o[c[t]]?c[t]:o[d[t]]?d[t]:t},this.isEdgeSupported=function(t){return null==b?null==f?!0===o[t]:f===t:-1!==b.indexOf(t)},this.setCurrentFace=function(t,e){p=t,e&&null!=f&&(f=p)},this.getCurrentFace=function(){return p},this.getSupportedFaces=function(){var t=[];for(var e in o)o[e]&&t.push(e);return t},this.lock=function(){f=p},this.unlock=function(){f=null},this.isLocked=function(){return null!=f},this.lockCurrentAxis=function(){null!=p&&(b="left"===p||"right"===p?m:g)},this.unlockCurrentAxis=function(){b=null},this.compute=function(t){return n[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return n[t.element.id]||[0,0]},this.getOrientation=function(t){return r[t.id]||[0,0]},this.getCssClass=function(){return u}};h.continuousAnchorFactory={get:function(t){return new g(t)},clear:function(t){delete n[t]}}},i.AnchorManager.prototype.calculateOrientation=function(t,e,i,s,n,r){var o=["left","top","right","bottom"];if(t===e)return{orientation:"identity",a:["top","top"]};var a=Math.atan2(s.centery-i.centery,s.centerx-i.centerx),l=Math.atan2(i.centery-s.centery,i.centerx-s.centerx),h=[],c={};!function(t,e){for(var i=0;i<t.length;i++)c[t[i]]={left:[e[i].left,e[i].centery],right:[e[i].right,e[i].centery],top:[e[i].centerx,e[i].top],bottom:[e[i].centerx,e[i].bottom]}}(["source","target"],[i,s]);for(var d=0;d<o.length;d++)for(var u=0;u<o.length;u++)h.push({source:o[d],target:o[u],dist:Biltong.lineLength(c.source[o[d]],c.target[o[u]])});h.sort((function(t,e){return t.dist<e.dist?-1:t.dist>e.dist?1:0}));for(var p=h[0].source,f=h[0].target,m=0;m<h.length&&(p=!n.isContinuous||n.isEdgeSupported(h[m].source)?h[m].source:null,f=!r.isContinuous||r.isEdgeSupported(h[m].target)?h[m].target:null,null==p||null==f);m++);return n.isContinuous&&n.setCurrentFace(p),r.isContinuous&&r.setCurrentFace(f),{a:[p,f],theta:a,theta2:l}},i.Anchor=function(t){this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,this.cssClass=t.cssClass||"",this.userDefinedLocation=null,this.orientation=t.orientation||[0,0],this.lastReturnValue=null,this.offsets=t.offsets||[0,0],this.timestamp=null;var i=!1!==t.relocatable;this.isRelocatable=function(){return i},this.setRelocatable=function(t){i=t};var s=!1!==t.snapOnRelocate;this.isSnapOnRelocate=function(){return s};var n=!1;this.lock=function(){n=!0},this.unlock=function(){n=!1},this.isLocked=function(){return n},e.EventGenerator.apply(this),this.compute=function(t){var e=t.xy,i=t.wh,s=t.timestamp;return t.clearUserDefinedLocation&&(this.userDefinedLocation=null),s&&s===this.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[e[0]+this.x*i[0]+this.offsets[0],e[1]+this.y*i[1]+this.offsets[1],this.x,this.y],this.timestamp=s,this.lastReturnValue)},this.getCurrentLocation=function(t){return t=t||{},null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!==t.timestamp?this.compute(t):this.lastReturnValue},this.setPosition=function(t,e,i,s,r){(!n||r)&&(this.x=t,this.y=e,this.orientation=[i,s],this.lastReturnValue=null)}},e.extend(i.Anchor,e.EventGenerator,{equals:function(t){if(!t)return!1;var e=t.getOrientation(),i=this.getOrientation();return this.x===t.x&&this.y===t.y&&this.offsets[0]===t.offsets[0]&&this.offsets[1]===t.offsets[1]&&i[0]===e[0]&&i[1]===e[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),i.FloatingAnchor=function(t){i.Anchor.apply(this,arguments);var e=t.reference,s=t.referenceCanvas,n=i.getSize(s),r=0,o=0,a=null,l=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,i=[e[0]+n[0]/2,e[1]+n[1]/2];return l=i,i},this.getOrientation=function(t){if(a)return a;var i=e.getOrientation(t);return[Math.abs(i[0])*r*-1,Math.abs(i[1])*o*-1]},this.over=function(t,e){a=t.getOrientation(e)},this.out=function(){a=null},this.getCurrentLocation=function(t){return null==l?this.compute(t):l}},e.extend(i.FloatingAnchor,i.Anchor);var s=function(t,e,s){return t.constructor===i.Anchor?t:e.makeAnchor(t,s,e)};i.DynamicAnchor=function(t){i.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=t.elementId,this.jsPlumbInstance=t.jsPlumbInstance;for(var e=0;e<t.anchors.length;e++)this.anchors[e]=s(t.anchors[e],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var n=this.anchors.length>0?this.anchors[0]:null,r=n,o=this,a=function(t,e,i,s,n){var r=s[0]+t.x*n[0],o=s[1]+t.y*n[1],a=s[0]+n[0]/2,l=s[1]+n[1]/2;return Math.sqrt(Math.pow(e-r,2)+Math.pow(i-o,2))+Math.sqrt(Math.pow(a-r,2)+Math.pow(l-o,2))},l=t.selector||function(t,e,i,s,n){for(var r=i[0]+s[0]/2,o=i[1]+s[1]/2,l=-1,h=1/0,c=0;c<n.length;c++){var d=a(n[c],r,o,t,e);h>d&&(l=c+0,h=d)}return n[l]};this.compute=function(t){var e=t.xy,i=t.wh,s=t.txy,a=t.twh;this.timestamp=t.timestamp;var h=o.getUserDefinedLocation();return null!=h?h:this.isLocked()||null==s||null==a?n.compute(t):(t.timestamp=null,n=l(e,i,s,a,this.anchors),this.x=n.x,this.y=n.y,n!==r&&this.fire("anchorChanged",n),r=n,n.compute(t))},this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(null!=n?n.getCurrentLocation(t):null)},this.getOrientation=function(t){return null!=n?n.getOrientation(t):[0,0]},this.over=function(t,e){null!=n&&n.over(t,e)},this.out=function(){null!=n&&n.out()},this.setAnchor=function(t){n=t},this.getCssClass=function(){return n&&n.getCssClass()||""},this.setAnchorCoordinates=function(t){var e=jsPlumbUtil.findWithFunction(this.anchors,(function(e){return e.x===t[0]&&e.y===t[1]}));return-1!==e&&(this.setAnchor(this.anchors[e]),!0)}},e.extend(i.DynamicAnchor,i.Anchor);var n=function(t,e,s,n,r,o){i.Anchors[r]=function(i){var a=i.jsPlumbInstance.makeAnchor([t,e,s,n,0,0],i.elementId,i.jsPlumbInstance);return a.type=r,o&&o(a,i),a}};n(.5,0,0,-1,"TopCenter"),n(.5,1,0,1,"BottomCenter"),n(0,.5,-1,0,"LeftMiddle"),n(1,.5,1,0,"RightMiddle"),n(.5,0,0,-1,"Top"),n(.5,1,0,1,"Bottom"),n(0,.5,-1,0,"Left"),n(1,.5,1,0,"Right"),n(.5,.5,0,0,"Center"),n(1,0,0,-1,"TopRight"),n(1,1,0,1,"BottomRight"),n(0,0,0,-1,"TopLeft"),n(0,1,0,1,"BottomLeft"),i.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},i.Anchors.AutoDefault=function(t){var e=t.jsPlumbInstance.makeDynamicAnchor(i.Defaults.DynamicAnchors(t));return e.type="AutoDefault",e};var r=function(t,e){i.Anchors[t]=function(i){var s=i.jsPlumbInstance.makeAnchor(["Continuous",{faces:e}],i.elementId,i.jsPlumbInstance);return s.type=t,s}};i.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},r("ContinuousLeft",["left"]),r("ContinuousTop",["top"]),r("ContinuousBottom",["bottom"]),r("ContinuousRight",["right"]),n(0,0,0,0,"Assign",(function(t,e){var i=e.position||"Fixed";t.positionFinder=i.constructor===String?e.jsPlumbInstance.AnchorPositionFinders[i]:i,t.constructorParams=e})),t.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,e,i){return[(t.left-e.left)/i[0],(t.top-e.top)/i[1]]},Grid:function(t,e,i,s){var n=t.top-e.top,r=i[0]/s.grid[0],o=i[1]/s.grid[1],a=Math.floor((t.left-e.left)/r),l=Math.floor(n/o);return[(a*r+r/2)/i[0],(l*o+o/2)/i[1]]}},i.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,i=t.shape;if(!i)throw new Error("no shape supplied to Perimeter Anchor type");var s=function(){for(var t=2*Math.PI/e,i=0,s=[],n=0;e>n;n++){var r=.5+.5*Math.sin(i),o=.5+.5*Math.cos(i);s.push([r,o,0,0]),i+=t}return s},n=function(t){for(var i=e/t.length,s=[],n=function(t,n,r,o,a,l,h){for(var c=(r-t)/(i=e*a),d=(o-n)/i,u=0;i>u;u++)s.push([t+c*u,n+d*u,null==l?0:l,null==h?0:h])},r=0;r<t.length;r++)n.apply(null,t[r]);return s},r=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i][0],t[i][1],t[i][2],t[i][3],1/t.length,t[i][4],t[i][5]]);return n(e)},o=function(){return r([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},a={Circle:s,Ellipse:s,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:o,Square:o,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var e=t.points,i=[],s=0,r=0;r<e.length-1;r++){var o=Math.sqrt(Math.pow(e[r][2]-e[r][0])+Math.pow(e[r][3]-e[r][1]));s+=o,i.push([e[r][0],e[r][1],e[r+1][0],e[r+1][1],o])}for(var a=0;a<i.length;a++)i[a][4]=i[a][4]/s;return n(i)}};if(!a[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");var l=a[i](t);t.rotation&&(l=function(t,e){for(var i=[],s=e/180*Math.PI,n=0;n<t.length;n++){var r=t[n][0]-.5,o=t[n][1]-.5;i.push([r*Math.cos(s)-o*Math.sin(s)+.5,r*Math.sin(s)+o*Math.cos(s)+.5,t[n][2],t[n][3]])}return i}(l,t.rotation));var h=t.jsPlumbInstance.makeDynamicAnchor(l);return h.type="Perimeter",h}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=t.Biltong;e.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,e){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(t,e,i,s){return[]},this.boxIntersection=function(t,e,i,s){var n=[];return n.push.apply(n,this.lineIntersection(t,e,t+i,e)),n.push.apply(n,this.lineIntersection(t+i,e,t+i,e+s)),n.push.apply(n,this.lineIntersection(t+i,e+s,t,e+s)),n.push.apply(n,this.lineIntersection(t,e+s,t,e)),n},this.boundingBoxIntersection=function(t){return this.boxIntersection(t.x,t.y,t.w,t.y)}},Straight:function(t){var i,n,r,o,a,l,h,c=(e.Segments.AbstractSegment.apply(this,arguments),function(){i=Math.sqrt(Math.pow(a-o,2)+Math.pow(h-l,2)),n=s.gradient({x:o,y:l},{x:a,y:h}),r=-1/n});this.type="Straight",this.getLength=function(){return i},this.getGradient=function(){return n},this.getCoordinates=function(){return{x1:o,y1:l,x2:a,y2:h}},this.setCoordinates=function(t){o=t.x1,l=t.y1,a=t.x2,h=t.y2,c()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(o,a),minY:Math.min(l,h),maxX:Math.max(o,a),maxY:Math.max(l,h)}},this.pointOnPath=function(t,e){return 0!==t||e?1!==t||e?s.pointOnLine({x:o,y:l},{x:a,y:h},e?t>0?t:i+t:t*i):{x:a,y:h}:{x:o,y:l}},this.gradientAtPoint=function(t){return n},this.pointAlongPathFrom=function(t,e,i){var n=this.pointOnPath(t,i),r=0>=e?{x:o,y:l}:{x:a,y:h};return 0>=e&&Math.abs(e)>1&&(e*=-1),s.pointOnLine(n,r,e)};var d=function(t,e,i){return i>=Math.min(t,e)&&i<=Math.max(t,e)},u=function(t,e,i){return Math.abs(i-t)<Math.abs(i-e)?t:e};this.findClosestPointOnPath=function(t,e){var c={d:1/0,x:null,y:null,l:null,x1:o,x2:a,y1:l,y2:h};if(0===n)c.y=l,c.x=d(o,a,t)?t:u(o,a,t);else if(n===1/0||n===-1/0)c.x=o,c.y=d(l,h,e)?e:u(l,h,e);else{var p=l-n*o,f=(e-r*t-p)/(n-r),m=n*f+p;c.x=d(o,a,f)?f:u(o,a,f),c.y=d(l,h,m)?m:u(l,h,m)}var g=s.lineLength([c.x,c.y],[o,l]);return c.d=s.lineLength([t,e],[c.x,c.y]),c.l=g/i,c};var p=function(t,e,i){return i>e?t>=e&&i>=t:e>=t&&t>=i},f=p;this.lineIntersection=function(t,e,i,r){var c=Math.abs(s.gradient({x:t,y:e},{x:i,y:r})),d=Math.abs(n),u=d===1/0?o:l-d*o,p=[],m=c===1/0?t:e-c*t;if(c!==d)if(c===1/0&&0===d)f(t,o,a)&&f(l,e,r)&&(p=[t,l]);else if(0===c&&d===1/0)f(e,l,h)&&f(o,t,i)&&(p=[o,e]);else{var g,b;c===1/0?f(g=t,o,a)&&f(b=d*t+u,e,r)&&(p=[g,b]):0===c?f(b=e,l,h)&&f(g=(e-u)/d,t,i)&&(p=[g,b]):(b=d*(g=(m-u)/(d-c))+u,f(g,o,a)&&f(b,l,h)&&(p=[g,b]))}return p},this.boxIntersection=function(t,e,i,s){var n=[];return n.push.apply(n,this.lineIntersection(t,e,t+i,e)),n.push.apply(n,this.lineIntersection(t+i,e,t+i,e+s)),n.push.apply(n,this.lineIntersection(t+i,e+s,t,e+s)),n.push.apply(n,this.lineIntersection(t,e+s,t,e)),n},this.boundingBoxIntersection=function(t){return this.boxIntersection(t.x,t.y,t.w,t.h)}},Arc:function(t){var i=(e.Segments.AbstractSegment.apply(this,arguments),function(e,i){return s.theta([t.cx,t.cy],[e,i])}),n=function(t,e){if(t.anticlockwise){var i=t.startAngle<t.endAngle?t.startAngle+r:t.startAngle;return i-Math.abs(i-t.endAngle)*e}var s=Math.abs((t.endAngle<t.startAngle?t.endAngle+r:t.endAngle)-t.startAngle);return t.startAngle+s*e},r=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=i(t.x1,t.y1),this.endAngle=i(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=r),this.startAngle<0&&(this.startAngle+=r);var o=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(o-this.startAngle),this.anticlockwise&&(this.sweep=r-this.sweep);var a=2*Math.PI*this.radius,l=this.sweep/r,h=a*l;this.getLength=function(){return h},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var c=1e-10,d=function(t){var e=Math.floor(t),i=Math.ceil(t);return c>t-e?e:c>i-t?i:t};this.pointOnPath=function(e,i){if(0===e)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===e)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(e/=h);var s=n(this,e),r=t.cx+t.r*Math.cos(s),o=t.cy+t.r*Math.sin(s);return{x:d(r),y:d(o),theta:s}},this.gradientAtPoint=function(e,i){var n=this.pointOnPath(e,i),r=s.normal([t.cx,t.cy],[n.x,n.y]);return this.anticlockwise||r!==1/0&&r!==-1/0||(r*=-1),r},this.pointAlongPathFrom=function(e,i,s){var n=this.pointOnPath(e,s),r=i/a*2*Math.PI,o=n.theta+(this.anticlockwise?-1:1)*r;return{x:t.cx+this.radius*Math.cos(o),y:t.cy+this.radius*Math.sin(o)}}},Bezier:function(i){this.curve=[{x:i.x1,y:i.y1},{x:i.cp1x,y:i.cp1y},{x:i.cp2x,y:i.cp2y},{x:i.x2,y:i.y2}],e.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(i.x1,i.x2,i.cp1x,i.cp2x),minY:Math.min(i.y1,i.y2,i.cp1y,i.cp2y),maxX:Math.max(i.x1,i.x2,i.cp1x,i.cp2x),maxY:Math.max(i.y1,i.y2,i.cp1y,i.cp2y)},this.type="Bezier";var s=function(e,i,s){return s&&(i=t.jsBezier.locationAlongCurveFrom(e,i>0?0:1,i)),i};this.pointOnPath=function(e,i){return e=s(this.curve,e,i),t.jsBezier.pointOnCurve(this.curve,e)},this.gradientAtPoint=function(e,i){return e=s(this.curve,e,i),t.jsBezier.gradientAtPoint(this.curve,e)},this.pointAlongPathFrom=function(e,i,n){return e=s(this.curve,e,n),t.jsBezier.pointAlongCurveFrom(this.curve,e,i)},this.getLength=function(){return t.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(e,i){var s=t.jsBezier.nearestPointOnCurve({x:e,y:i},this.curve);return{d:Math.sqrt(Math.pow(s.point.x-e,2)+Math.pow(s.point.y-i,2)),x:s.point.x,y:s.point.y,l:s.location,s:this}},this.lineIntersection=function(e,i,s,n){return t.jsBezier.lineIntersection(e,i,s,n,this.curve)}}},e.SegmentRenderer={getPath:function(t,e){return{Straight:function(e){var i=t.getCoordinates();return(e?"M "+i.x1+" "+i.y1+" ":"")+"L "+i.x2+" "+i.y2},Bezier:function(e){var i=t.params;return(e?"M "+i.x2+" "+i.y2+" ":"")+"C "+i.cp2x+" "+i.cp2y+" "+i.cp1x+" "+i.cp1y+" "+i.x1+" "+i.y1},Arc:function(e){var i=t.sweep>Math.PI?1:0;return(e?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+t.params.r+" 0 "+i+","+(t.anticlockwise?0:1)+" "+t.x2+" "+t.y2}}[t.type](e)}};var n=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};e.Connectors.AbstractConnector=function(t){n.apply(this,arguments);var r=[],o=0,a=[],l=[],h=t.stub||0,c=i.isArray(h)?h[0]:h,d=i.isArray(h)?h[1]:h,u=t.gap||0,p=i.isArray(u)?u[0]:u,f=i.isArray(u)?u[1]:u,m=null,g=null;this.getPathData=function(){for(var t="",i=0;i<r.length;i++)t+=e.SegmentRenderer.getPath(r[i],0===i),t+=" ";return t},this.findSegmentForPoint=function(t,e){for(var i={d:1/0,s:null,x:null,y:null,l:null},s=0;s<r.length;s++){var n=r[s].findClosestPointOnPath(t,e);n.d<i.d&&(i.d=n.d,i.l=n.l,i.x=n.x,i.y=n.y,i.s=r[s],i.x1=n.x1,i.x2=n.x2,i.y1=n.y1,i.y2=n.y2,i.index=s)}return i},this.lineIntersection=function(t,e,i,s){for(var n=[],o=0;o<r.length;o++)n.push.apply(n,r[o].lineIntersection(t,e,i,s));return n},this.boxIntersection=function(t,e,i,s){for(var n=[],o=0;o<r.length;o++)n.push.apply(n,r[o].boxIntersection(t,e,i,s));return n},this.boundingBoxIntersection=function(t){for(var e=[],i=0;i<r.length;i++)e.push.apply(e,r[i].boundingBoxIntersection(t));return e};var b=function(){for(var t=0,e=0;e<r.length;e++){var i=r[e].getLength();l[e]=i/o,a[e]=[t,t+=i/o]}},y=function(t,e){e&&(t=t>0?t/o:(o+t)/o);for(var i=a.length-1,s=1,n=0;n<a.length;n++)if(a[n][1]>=t){i=n,s=1===t?1:0===t?0:(t-a[n][0])/l[n];break}return{segment:r[i],proportion:s,index:i}},v=function(t,i,s){if(s.x1!==s.x2||s.y1!==s.y2){var n=new e.Segments[i](s);r.push(n),o+=n.getLength(),t.updateBounds(n)}},C=function(){o=r.length=a.length=l.length=0};this.setSegments=function(t){m=[],o=0;for(var e=0;e<t.length;e++)m.push(t[e]),o+=t[e].getLength()},this.getLength=function(){return o};var x=function(t){this.strokeWidth=t.strokeWidth;var e=s.quadrant(t.sourcePos,t.targetPos),i=t.targetPos[0]<t.sourcePos[0],n=t.targetPos[1]<t.sourcePos[1],r=t.strokeWidth||1,o=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),a=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),l=i?t.targetPos[0]:t.sourcePos[0],h=n?t.targetPos[1]:t.sourcePos[1],u=Math.abs(t.targetPos[0]-t.sourcePos[0]),m=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===o[0]&&0===o[1]||0===a[0]&&0===a[1]){var g=u>m?0:1,b=[1,0][g];a=[],(o=[])[g]=t.sourcePos[g]>t.targetPos[g]?-1:1,a[g]=t.sourcePos[g]>t.targetPos[g]?1:-1,o[b]=0,a[b]=0}var y=i?u+p*o[0]:p*o[0],v=n?m+p*o[1]:p*o[1],C=i?f*a[0]:u+f*a[0],x=n?f*a[1]:m+f*a[1],_=o[0]*a[0]+o[1]*a[1],P={sx:y,sy:v,tx:C,ty:x,lw:r,xSpan:Math.abs(C-y),ySpan:Math.abs(x-v),mx:(y+C)/2,my:(v+x)/2,so:o,to:a,x:l,y:h,w:u,h:m,segment:e,startStubX:y+o[0]*c,startStubY:v+o[1]*c,endStubX:C+a[0]*d,endStubY:x+a[1]*d,isXGreaterThanStubTimes2:Math.abs(y-C)>c+d,isYGreaterThanStubTimes2:Math.abs(v-x)>c+d,opposite:-1===_,perpendicular:0===_,orthogonal:1===_,sourceAxis:0===o[0]?"y":"x",points:[l,h,u,m,y,v,C,x],stubs:[c,d]};return P.anchorOrientation=P.opposite?"opposite":P.orthogonal?"orthogonal":"perpendicular",P};return this.getSegments=function(){return r},this.updateBounds=function(t){var e=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,e.minX),this.bounds.maxX=Math.max(this.bounds.maxX,e.maxX),this.bounds.minY=Math.min(this.bounds.minY,e.minY),this.bounds.maxY=Math.max(this.bounds.maxY,e.maxY)},this.pointOnPath=function(t,e){var i=y(t,e);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(t,e){var i=y(t,e);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(t,e,i){var s=y(t,i);return s.segment&&s.segment.pointAlongPathFrom(s.proportion,e,!1)||[0,0]},this.compute=function(t){g=x.call(this,t),C(),this._compute(g,t),this.x=g.points[0],this.y=g.points[1],this.w=g.points[2],this.h=g.points[3],this.segment=g.segment,b()},{addSegment:v,prepareCompute:x,sourceStub:c,targetStub:d,maxStub:Math.max(c,d),sourceGap:p,targetGap:f,maxGap:Math.max(p,f)}},i.extend(e.Connectors.AbstractConnector,n),e.Endpoints.AbstractEndpoint=function(t){n.apply(this,arguments);var e=this.compute=function(t,e,i,s){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:e,cssClass:t.cssClass}},i.extend(e.Endpoints.AbstractEndpoint,n),e.Endpoints.Dot=function(t){this.type="Dot",e.Endpoints.AbstractEndpoint.apply(this,arguments),this.radius=(t=t||{}).radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,e,i,s){this.radius=i.radius||this.radius;var n=t[0]-this.radius,r=t[1]-this.radius,o=2*this.radius,a=2*this.radius;if(i.stroke){var l=i.strokeWidth||1;n-=l,r-=l,o+=2*l,a+=2*l}return[n,r,o,a,this.radius]}},i.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint),e.Endpoints.Rectangle=function(t){this.type="Rectangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),this.width=(t=t||{}).width||20,this.height=t.height||20,this._compute=function(t,e,i,s){var n=i.width||this.width,r=i.height||this.height;return[t[0]-n/2,t[1]-r/2,n,r]}},i.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var r=function(t){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};i.extend(r,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),e.Endpoints.Image=function(s){this.type="Image",r.apply(this,arguments),e.Endpoints.AbstractEndpoint.apply(this,arguments);var n=s.onload,o=s.src||s.url,a=s.cssClass?" "+s.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=s.width,this._jsPlumb.heightToUse=s.height,this._jsPlumb.endpoint=s.endpoint,this._jsPlumb.img.onload=(function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,n&&n(this))}).bind(this),this._jsPlumb.endpoint.setImage=(function(t,e){var i=t.constructor===String?t:t.src;n=e,this._jsPlumb.img.src=i,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}).bind(this),this._jsPlumb.endpoint.setImage(o,n),this._compute=function(t,e,i,s){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=e.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+a),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(t,e,s){this._jsPlumb.deleted||(this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0),i.sizeElement(this.canvas,this.anchorPoint[0]-this._jsPlumb.widthToUse/2,this.anchorPoint[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse))},this.paint=function(e,i){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,i):t.setTimeout((function(){this.paint(e,i)}).bind(this),200))}},i.extend(e.Endpoints.Image,[r,e.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),e.Endpoints.Blank=function(t){e.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",r.apply(this,arguments),this._compute=function(t,e,i,s){return[t[0],t[1],10,0]};var s=t.cssClass?" "+t.cssClass:"";this.canvas=e.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+s),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(t,e){i.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},i.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,r],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),e.Endpoints.Triangle=function(t){this.type="Triangle",e.Endpoints.AbstractEndpoint.apply(this,arguments);var i=this;(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,e,s,n){var r=s.width||i.width,o=s.height||i.height;return[t[0]-r/2,t[1]-o/2,r,o]}};var o=e.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.visible=!1!==t.visible};o.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,e){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},e.Overlays.Arrow=function(t){this.type="Arrow",o.apply(this,arguments),this.isAppendedAtTopLevel=!1;var n=this;this.length=(t=t||{}).length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;var r=t.paintStyle||{"stroke-width":1},a=t.foldback||.623;this.computeMaxSize=function(){return 1.5*n.width},this.elementCreated=function(i,s){if(this.path=i,t.events)for(var n in t.events)e.on(i,n,t.events[n])},this.draw=function(t,e){var n,o,l,h;if(t.pointAlongPathFrom){if(i.isString(this.loc)||this.loc>1||this.loc<0){var c=parseInt(this.loc,10),d=this.loc<0?1:0;n=t.pointAlongPathFrom(d,c,!1),o=t.pointAlongPathFrom(d,c-this.direction*this.length/2,!1),l=s.pointOnLine(n,o,this.length)}else if(1===this.loc){if(n=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,-this.length),l=s.pointOnLine(n,o,this.length),-1===this.direction){var u=l;l=n,n=u}}else if(0===this.loc){if(l=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,this.length),n=s.pointOnLine(l,o,this.length),-1===this.direction){var p=l;l=n,n=p}}else n=t.pointAlongPathFrom(this.loc,this.direction*this.length/2),o=t.pointOnPath(this.loc),l=s.pointOnLine(n,o,this.length);return{component:t,d:{hxy:n,tail:h=s.perpendicularLineTo(n,l,this.width),cxy:s.pointOnLine(n,l,a*this.length)},"stroke-width":r.strokeWidth||e.strokeWidth,stroke:r.stroke||e.stroke,fill:r.fill||e.stroke,minX:Math.min(n.x,h[0].x,h[1].x),maxX:Math.max(n.x,h[0].x,h[1].x),minY:Math.min(n.y,h[0].y,h[1].y),maxY:Math.max(n.y,h[0].y,h[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},i.extend(e.Overlays.Arrow,o,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=null!=t.direction?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.canvas&&this.canvas.removeChild(this.path)}}),e.Overlays.PlainArrow=function(t){var i=e.extend(t=t||{},{foldback:1});e.Overlays.Arrow.call(this,i),this.type="PlainArrow"},i.extend(e.Overlays.PlainArrow,e.Overlays.Arrow),e.Overlays.Diamond=function(t){var i=e.extend(t=t||{},{length:(t.length||40)/2,foldback:2});e.Overlays.Arrow.call(this,i),this.type="Diamond"},i.extend(e.Overlays.Diamond,e.Overlays.Arrow);var a=function(t,e){return(null==t._jsPlumb.cachedDimensions||e)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},l=function(t){e.jsPlumbUIComponent.apply(this,arguments),o.apply(this,arguments);var s=this.fire;this.fire=function(){s.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=!1===t.visible,this.getElement=function(){if(null==this._jsPlumb.div){var i=this._jsPlumb.div=e.getElement(this._jsPlumb.create(this._jsPlumb.component));i.style.position="absolute",jsPlumb.addClass(i,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(i),this._jsPlumb.instance.getId(i),this.canvas=i;var s="translate(-50%, -50%)";i.style.webkitTransform=s,i.style.mozTransform=s,i.style.msTransform=s,i.style.oTransform=s,i.style.transform=s,i._jsPlumb=this,!1===t.visible&&(i.style.display="none")}return this._jsPlumb.div},this.draw=function(t,e,s){var n=a(this);if(null!=n&&2===n.length){var r={x:0,y:0};if(s)r={x:s[0],y:s[1]};else if(t.pointOnPath){var o=this.loc,l=!1;(i.isString(this.loc)||this.loc<0||this.loc>1)&&(o=parseInt(this.loc,10),l=!0),r=t.pointOnPath(o,l)}else{var h=this.loc.constructor===Array?this.loc:this.endpointLoc;r={x:h[0]*t.w,y:h[1]*t.h}}var c=r.x-n[0]/2,d=r.y-n[1]/2;return{component:t,d:{minx:c,miny:d,td:n,cxy:r},minX:c,maxX:c+n[0],minY:d,maxY:d+n[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};i.extend(l,[e.jsPlumbUIComponent,o],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(a(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,e){null!=this._jsPlumb.div&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var t=a(this);return Math.max(t[0],t[1])},paint:function(t,e){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),e.Overlays.Custom=function(t){this.type="Custom",l.apply(this,arguments)},i.extend(e.Overlays.Custom,l),e.Overlays.GuideLines=function(){var t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",o.apply(this,arguments),e.jsPlumbUIComponent.apply(this,arguments),this.draw=function(e,i){var n=e.pointAlongPathFrom(t.loc,t.length/2),r=e.pointOnPath(t.loc),o=s.pointOnLine(n,r,t.length),a=s.perpendicularLineTo(n,o,40),l=s.perpendicularLineTo(o,n,20);return{connector:e,head:n,tail:o,headLine:l,tailLine:a,minX:Math.min(n.x,o.x,l[0].x,l[1].x),minY:Math.min(n.y,o.y,l[0].y,l[1].y),maxX:Math.max(n.x,o.x,l[0].x,l[1].x),maxY:Math.max(n.y,o.y,l[0].y,l[1].y)}}},e.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var i=e.extend({create:function(){return e.createElement("div")}},t);if(e.Overlays.Custom.call(this,i),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var s=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif",s.style.font=this.labelStyle.font,s.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(s.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0&&(s.style.border=this.labelStyle.borderWidth+"px solid "+(this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black")),this.labelStyle.padding&&(s.style.padding=this.labelStyle.padding)}},i.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),l.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){null!=t.label&&this.setLabel(t.label)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=t.jsPlumbInstance,s="jtk-group-collapsed",n="jtk-group-expanded",r="stop",o="revert",a="_groupManager",l="_jsPlumbGroup",h="show",c="hide",d=function(t){function i(e,i){for(var s=e.getMembers(),n=0;n<s.length;n++)t[i?h:c](s[n],!0)}function r(e){var i=e.getMembers(),s=t.getConnections({source:i,scope:"*"},!0),n=t.getConnections({target:i,scope:"*"},!0),r={};e.connections.source.length=0,e.connections.target.length=0;var o=function(t){for(var i=0;i<t.length;i++)r[t[i].id]||(r[t[i].id]=!0,t[i].source._jsPlumbGroup===e?(t[i].target._jsPlumbGroup!==e&&e.connections.source.push(t[i]),a[t[i].id]=e):t[i].target._jsPlumbGroup===e&&(e.connections.target.push(t[i]),d[t[i].id]=e))};o(s),o(n)}var o={},a={},d={},u=this;t.bind("connection",(function(t){null!=t.source[l]&&null!=t.target[l]&&t.source[l]===t.target[l]?(a[t.connection.id]=t.source[l],d[t.connection.id]=t.source[l]):(null!=t.source[l]&&(e.suggest(t.source[l].connections.source,t.connection),a[t.connection.id]=t.source[l]),null!=t.target[l]&&(e.suggest(t.target[l].connections.target,t.connection),d[t.connection.id]=t.target[l]))})),t.bind("internal.connectionDetached",(function(t){!function(t){delete t.proxies;var i,s=a[t.id];null!=s&&(e.removeWithFunction(s.connections.source,i=function(e){return e.id===t.id}),e.removeWithFunction(s.connections.target,i),delete a[t.id]),null!=(s=d[t.id])&&(e.removeWithFunction(s.connections.source,i=function(e){return e.id===t.id}),e.removeWithFunction(s.connections.target,i),delete d[t.id])}(t.connection)})),t.bind("connectionMoved",(function(t){var e=(0===t.index?a:d)[t.connection.id];if(e){var i=e.connections[0===t.index?"source":"target"],s=i.indexOf(t.connection);-1!==s&&i.splice(s,1)}})),this.addGroup=function(e){t.addClass(e.getEl(),n),o[e.id]=e,e.manager=this,r(e),t.fire("group:add",{group:e})},this.addToGroup=function(e,i,s){if(e=this.getGroup(e)){var n=e.getEl();if(i._isJsPlumbGroup)return;var r=i._jsPlumbGroup;if(r!==e){var o=t.getOffset(i,!0),a=t.getOffset(e.collapsed?n:e.getDragArea(),!0);null!=r&&(r.remove(i,!1,s,!1,e),u.updateConnectionsForGroup(r)),e.add(i,s);var l=function(t,i){var s=0===i?1:0;t.each((function(t){t.setVisible(!1),t.endpoints[s].element._jsPlumbGroup===e?(t.endpoints[s].setVisible(!1),f(t,s,e)):(t.endpoints[i].setVisible(!1),p(t,i,e))}))};e.collapsed&&(l(t.select({source:i}),0),l(t.select({target:i}),1));var h=t.getId(i);t.dragManager.setParent(i,h,n,t.getId(n),o);var c={left:o.left-a.left,top:o.top-a.top};if(t.setPosition(i,c),t.dragManager.revalidateParent(i,h,o),u.updateConnectionsForGroup(e),t.revalidate(h),!s){var d={group:e,el:i,pos:c};r&&(d.sourceGroup=r),t.fire("group:addMember",d)}}}},this.removeFromGroup=function(t,e,i){(t=this.getGroup(t))&&t.remove(e,null,i)},this.getGroup=function(t){var i=t;if(e.isString(t)&&null==(i=o[t]))throw new TypeError("No such group ["+t+"]");return i},this.getGroups=function(){var t=[];for(var e in o)t.push(o[e]);return t},this.removeGroup=function(e,i,s,n){e=this.getGroup(e),this.expandGroup(e,!0);var r=e[i?"removeAll":"orphanAll"](s,n);return t.remove(e.getEl()),delete o[e.id],delete t._groups[e.id],t.fire("group:remove",{group:e}),r},this.removeAllGroups=function(t,e,i){for(var s in o)this.removeGroup(o[s],t,e,i)};var p=function(e,i,s){var n=e.endpoints[0===i?1:0].element;if(!n[l]||n[l].shouldProxy()||!n[l].collapsed){var r=s.getEl(),o=t.getId(r);t.proxyConnection(e,i,r,o,(function(t,e){return s.getEndpoint(t,e)}),(function(t,e){return s.getAnchor(t,e)}))}};this.collapseGroup=function(e){if(null!=(e=this.getGroup(e))&&!e.collapsed){var r=e.getEl();if(i(e,!1),e.shouldProxy()){var o=function(t,i){for(var s=0;s<t.length;s++)p(t[s],i,e)};o(e.connections.source,0),o(e.connections.target,1)}e.collapsed=!0,t.removeClass(r,n),t.addClass(r,s),t.revalidate(r),t.fire("group:collapse",{group:e})}};var f=function(e,i,s){t.unproxyConnection(e,i,t.getId(s.getEl()))};this.expandGroup=function(e,r){if(null!=(e=this.getGroup(e))&&e.collapsed){var o=e.getEl();if(i(e,!0),e.shouldProxy()){var a=function(t,i){for(var s=0;s<t.length;s++)f(t[s],i,e)};a(e.connections.source,0),a(e.connections.target,1)}e.collapsed=!1,t.addClass(o,n),t.removeClass(o,s),t.revalidate(o),this.repaintGroup(e),r||t.fire("group:expand",{group:e})}},this.repaintGroup=function(e){for(var i=(e=this.getGroup(e)).getMembers(),s=0;s<i.length;s++)t.revalidate(i[s])},this.updateConnectionsForGroup=r,this.refreshAllGroups=function(){for(var e in o)r(o[e]),t.dragManager.updateOffsets(t.getId(o[e].getEl()))}},u=function(i,s){function n(t,e){var s=function(t){return t.offsetParent}(t),n=i.getSize(s),r=i.getSize(t),o=e[0],a=e[1];return o+r[0]>0&&o<n[0]&&a+r[1]>0&&a<n[1]}function a(t){var e=i.getId(t),s=i.getOffset(t);return t.parentNode.removeChild(t),i.getContainer().appendChild(t),i.setPosition(t,s),delete t._jsPlumbGroup,d(t),i.dragManager.clearParent(t,e),[e,s]}function h(t){var e=null;if(!n(t.el,t.pos)){var s=t.el._jsPlumbGroup;C?i.remove(t.el):e=a(t.el),s.remove(t.el)}return e}function c(t){var e=i.getId(t);i.revalidate(t),i.dragManager.revalidateParent(t,e)}function d(t){t._katavorioDrag&&((C||v)&&t._katavorioDrag.off(r,h),C||v||!y||(t._katavorioDrag.off(o,c),t._katavorioDrag.setRevert(null)))}function u(t){t._katavorioDrag&&((C||v)&&t._katavorioDrag.on(r,h),b&&t._katavorioDrag.setConstrain(!0),g&&t._katavorioDrag.setUseGhostProxy(!0),C||v||!y||(t._katavorioDrag.on(o,c),t._katavorioDrag.setRevert((function(t,e){return!n(t,e)}))))}var p=this,f=s.el;this.getEl=function(){return f},this.id=s.id||e.uuid(),f._isJsPlumbGroup=!0;var m=this.getDragArea=function(){var t=i.getSelector(f,"[jtk-group-content]");return t&&t.length>0?t[0]:f},g=!0===s.ghost,b=g||!0===s.constrain,y=!1!==s.revert,v=!0===s.orphan,C=!0===s.prune,x=!0===s.dropOverride,_=!1!==s.proxied,P=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(t,e){return s.anchor||"Continuous"},this.getEndpoint=function(t,e){return s.endpoint||["Dot",{radius:10}]},this.collapsed=!1,!1!==s.draggable){var S={stop:function(t){i.fire("groupDragStop",jsPlumb.extend(t,{group:p}))},scope:"_jsPlumbGroupDrag"};s.dragOptions&&t.jsPlumb.extend(S,s.dragOptions),i.draggable(s.el,S)}!1!==s.droppable&&i.droppable(s.el,{drop:function(t){var e=t.drag.el;if(!e._isJsPlumbGroup){var s=e._jsPlumbGroup;if(s!==p){if(null!=s&&s.overrideDrop(e,p))return;i.getGroupManager().addToGroup(p,e,!1)}}}});var w=function(t,e){for(var i=null==t.nodeType?t:[t],s=0;s<i.length;s++)e(i[s])};this.overrideDrop=function(t,e){return x&&(y||C||v)},this.add=function(t,e){var s=m();w(t,(function(t){if(null!=t._jsPlumbGroup){if(t._jsPlumbGroup===p)return;t._jsPlumbGroup.remove(t,!0,e,!1)}t._jsPlumbGroup=p,P.push(t),i.isAlreadyDraggable(t)&&u(t),t.parentNode!==s&&s.appendChild(t)})),i.getGroupManager().updateConnectionsForGroup(p)},this.remove=function(t,s,n,r,o){w(t,(function(t){if(delete t._jsPlumbGroup,e.removeWithFunction(P,(function(e){return e===t})),s)try{p.getDragArea().removeChild(t)}catch(r){jsPlumbUtil.log("Could not remove element from Group "+r)}if(d(t),!n){var a={group:p,el:t};o&&(a.targetGroup=o),i.fire("group:removeMember",a)}})),r||i.getGroupManager().updateConnectionsForGroup(p)},this.removeAll=function(t,e){for(var s=0,n=P.length;n>s;s++){var r=P[0];p.remove(r,t,e,!0),i.remove(r,!0)}P.length=0,i.getGroupManager().updateConnectionsForGroup(p)},this.orphanAll=function(){for(var t={},e=0;e<P.length;e++){var i=a(P[e]);t[i[0]]=i[1]}return P.length=0,t},this.getMembers=function(){return P},f[l]=this,i.bind("elementDraggable",(function(t){t.el._jsPlumbGroup===this&&u(t.el)}).bind(this)),this.shouldProxy=function(){return _},i.getGroupManager().addGroup(this)};i.prototype.addGroup=function(t){var e=this;if(e._groups=e._groups||{},null!=e._groups[t.id])throw new TypeError("cannot create Group ["+t.id+"]; a Group with that ID exists");if(null!=t.el[l])throw new TypeError("cannot create Group ["+t.id+"]; the given element is already a Group");var i=new u(e,t);return e._groups[i.id]=i,t.collapsed&&this.collapseGroup(i),i},i.prototype.addToGroup=function(t,e,i){var s=(function(e){var s=this.getId(e);this.manage(s,e),this.getGroupManager().addToGroup(t,e,i)}).bind(this);if(Array.isArray(e))for(var n=0;n<e.length;n++)s(e[n]);else s(e)},i.prototype.removeFromGroup=function(t,e,i){this.getGroupManager().removeFromGroup(t,e,i)},i.prototype.removeGroup=function(t,e,i,s){return this.getGroupManager().removeGroup(t,e,i,s)},i.prototype.removeAllGroups=function(t,e,i){this.getGroupManager().removeAllGroups(t,e,i)},i.prototype.getGroup=function(t){return this.getGroupManager().getGroup(t)},i.prototype.getGroups=function(){return this.getGroupManager().getGroups()},i.prototype.expandGroup=function(t){this.getGroupManager().expandGroup(t)},i.prototype.collapseGroup=function(t){this.getGroupManager().collapseGroup(t)},i.prototype.repaintGroup=function(t){this.getGroupManager().repaintGroup(t)},i.prototype.toggleGroup=function(t){null!=(t=this.getGroupManager().getGroup(t))&&this.getGroupManager()[t.collapsed?"expandGroup":"collapseGroup"](t)},i.prototype.getGroupManager=function(){var t=this[a];return null==t&&(t=this[a]=new d(this)),t},i.prototype.removeGroupManager=function(){delete this[a]},i.prototype.getGroupFor=function(t){return(t=this.getElement(t))?t[l]:void 0}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i="Straight";t.Connectors.Flowchart=function(e){this.type="Flowchart",(e=e||{}).stub=null==e.stub?30:e.stub;var s,n=t.Connectors.AbstractConnector.apply(this,arguments),r=null==e.midpoint?.5:e.midpoint,o=!0===e.alwaysRespectStubs,a=null,l=null,h=null!=e.cornerRadius?e.cornerRadius:0,c=function(t){return 0>t?-1:0===t?0:1},d=function(t){return[c(t[2]-t[0]),c(t[3]-t[1])]},u=function(t,e,i,s){if(a!==e||l!==i){var n=null==a?s.sx:a,r=null==l?s.sy:l;a=e,l=i,t.push([n,r,e,i,n===e?"v":"h"])}},p=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},f=function(t){var e=[];return e.push.apply(e,t),e},m=function(t,e,s){for(var r,o,a,l=null,c=0;c<e.length-1;c++){if(l=l||f(e[c]),r=f(e[c+1]),o=d(l),a=d(r),h>0&&l[4]!==r[4]){var u=Math.min(p(l),p(r)),m=Math.min(h,u/2);l[2]-=o[0]*m,l[3]-=o[1]*m,r[0]+=a[0]*m,r[1]+=a[1]*m;var g=o[1]===a[0]&&1===a[0]||o[1]===a[0]&&0===a[0]&&o[0]!==a[1]||o[1]===a[0]&&-1===a[0],b=(r[1]>l[3]?1:-1)==(r[0]>l[2]?1:-1),y=b&&g||!b&&!g?r[0]:l[2],v=b&&g||!b&&!g?l[3]:r[1];n.addSegment(t,i,{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),n.addSegment(t,"Arc",{r:m,x1:l[2],y1:l[3],x2:r[0],y2:r[1],cx:y,cy:v,ac:g})}else{var C=l[2]===l[0]?0:l[2]>l[0]?s.lw/2:-s.lw/2,x=l[3]===l[1]?0:l[3]>l[1]?s.lw/2:-s.lw/2;n.addSegment(t,i,{x1:l[0]-C,y1:l[1]-x,x2:l[2]+C,y2:l[3]+x})}l=r}null!=r&&n.addSegment(t,i,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})};this._compute=function(t,e){s=[],a=null,l=null;var i=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},h={perpendicular:i,orthogonal:i,opposite:function(e){var i=t,s="x"===e?0:1;return!o&&{x:function(){return 1===i.so[s]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1===i.so[s]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1===i.so[s]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1===i.so[s]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}}[t.anchorOrientation](t.sourceAxis),c="x"===t.sourceAxis?0:1,d="x"===t.sourceAxis?1:0,p=h[c],f=h[d],g=h[c+2],b=h[d+2];u(s,h[0],h[1],t);var y=t.startStubX+(t.endStubX-t.startStubX)*r,v=t.startStubY+(t.endStubY-t.startStubY)*r,C={x:[0,1],y:[1,0]},x={perpendicular:function(e){var i={x:[[t.startStubX,t.endStubX],null,[t.endStubX,t.startStubX]],y:[[t.startStubY,t.endStubY],null,[t.endStubY,t.startStubY]]},s={x:[t.startStubY,t.endStubY],y:[t.startStubX,t.endStubX]},n=C[e][1],r=t.so[C[e][0]]+1,o=-1===t.to[n]&&s[e][1]<s[e][0]||1===t.to[n]&&s[e][1]>s[e][0],a=i[e][r][0],l=i[e][r][1],h={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][r][t.to[n]+1];return t.segment===h[3]||t.segment===h[2]&&o?{x:[[y,t.startStubY],[y,t.endStubY]],y:[[t.startStubX,v],[t.endStubX,v]]}[e]:t.segment===h[2]&&a>l?{x:[[t.endStubX,t.startStubY]],y:[[t.startStubX,t.endStubY]]}[e]:t.segment===h[2]&&l>=a||t.segment===h[1]&&!o?{x:[[t.startStubX,v],[t.endStubX,v],[t.endStubX,t.endStubY]],y:[[y,t.startStubY],[y,t.endStubY],[t.endStubX,t.endStubY]]}[e]:t.segment===h[0]||t.segment===h[1]&&o?{x:[[t.startStubX,t.endStubY],[t.endStubX,t.endStubY]],y:[[t.endStubX,t.startStubY],[t.endStubX,t.endStubY]]}[e]:void 0},orthogonal:function(e,i,s,n,r){var o=t,a={x:-1===o.so[0]?Math.min(i,n):Math.max(i,n),y:-1===o.so[1]?Math.min(i,n):Math.max(i,n)}[e];return{x:[[a,s],[a,r],[n,r]],y:[[s,a],[r,a],[r,n]]}[e]},opposite:function(i,s,r,o){var a=t,l={x:"y",y:"x"}[i],h={x:"height",y:"width"}[i],d=a["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var u=r+(1-e.sourceEndpoint.anchor[l])*e.sourceInfo[h]+n.maxStub;return{x:[[s,u],[o,u]],y:[[u,s],[u,o]]}[i]}return!d||1===a.so[c]&&s>o||-1===a.so[c]&&o>s?{x:[[s,v],[o,v]],y:[[y,s],[y,o]]}[i]:1===a.so[c]&&o>s||-1===a.so[c]&&s>o?{x:[[y,a.sy],[y,a.ty]],y:[[a.sx,v],[a.tx,v]]}[i]:void 0}}[t.anchorOrientation](t.sourceAxis,p,f,g,b);if(x)for(var _=0;_<x.length;_++)u(s,x[_][0],x[_][1],t);u(s,h[2],h[3],t),u(s,t.tx,t.ty,t),m(this,s,t)}},e.extend(t.Connectors.Flowchart,t.Connectors.AbstractConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil;t.Connectors.AbstractBezierConnector=function(e){var i,s=!1!==(e=e||{}).showLoopback,n=e.margin||5,r=e.orientation&&"clockwise"===e.orientation,o=e.loopbackRadius||25;return this._compute=function(t,e){var a=e.sourcePos,l=e.targetPos,h=Math.abs(a[0]-l[0]),c=Math.abs(a[1]-l[1]);if(s&&e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var d=e.sourcePos[0],u=e.sourcePos[1]-n,p=d,f=u-o,m=p-o,g=f-o;h=2*o,c=2*o,t.points[0]=m,t.points[1]=g,t.points[2]=h,t.points[3]=c,i.addSegment(this,"Arc",{loopback:!0,x1:d-m+4,y1:u-g,startAngle:0,endAngle:2*Math.PI,r:o,ac:!r,x2:d-m-4,y2:u-g,cx:p-m,cy:f-g})}else this._computeBezier(t,e,a,l,h,c)},i=t.Connectors.AbstractConnector.apply(this,arguments)},e.extend(t.Connectors.AbstractBezierConnector,t.Connectors.AbstractConnector);var i=function(e){e=e||{},this.type="Bezier";var i=t.Connectors.AbstractBezierConnector.apply(this,arguments),s=e.curviness||150,n=10;this.getCurviness=function(){return s},this._findControlPoint=function(t,e,i,r,o,a,l){var h=[];return a[0]!==l[0]||a[1]===l[1]?(h.push(0===l[0]?i[0]<e[0]?t[0]+n:t[0]-n:t[0]+s*l[0]),h.push(0===l[1]?i[1]<e[1]?t[1]+n:t[1]-n:t[1]+s*a[1])):(h.push(0===a[0]?e[0]<i[0]?t[0]+n:t[0]-n:t[0]-s*a[0]),h.push(0===a[1]?e[1]<i[1]?t[1]+n:t[1]-n:t[1]+s*l[1])),h},this._computeBezier=function(t,e,s,n,r,o){var a,l,h=s[0]<n[0]?r:0,c=s[1]<n[1]?o:0,d=s[0]<n[0]?0:r,u=s[1]<n[1]?0:o;a=this._findControlPoint([h,c],s,n,e.sourceEndpoint,e.targetEndpoint,t.so,t.to),l=this._findControlPoint([d,u],n,s,e.targetEndpoint,e.sourceEndpoint,t.to,t.so),i.addSegment(this,"Bezier",{x1:h,y1:c,x2:d,y2:u,cp1x:a[0],cp1y:a[1],cp2x:l[0],cp2y:l[1]})}};t.Connectors.Bezier=i,e.extend(i,t.Connectors.AbstractBezierConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i=function(t,e,i,s){return i>=t&&e>=s?1:i>=t&&s>=e?2:t>=i&&s>=e?3:4},s=function(t,e,i,s,n,r,o,a,l){return l>=a?[t,e]:1===i?s[3]<=0&&n[3]>=1?[t+(s[2]<.5?-1*r:r),e]:s[2]>=1&&n[2]<=0?[t,e+(s[3]<.5?-1*o:o)]:[t+-1*r,e+-1*o]:2===i?s[3]>=1&&n[3]<=0?[t+(s[2]<.5?-1*r:r),e]:s[2]>=1&&n[2]<=0?[t,e+(s[3]<.5?-1*o:o)]:[t+r,e+-1*o]:3===i?s[3]>=1&&n[3]<=0?[t+(s[2]<.5?-1*r:r),e]:s[2]<=0&&n[2]>=1?[t,e+(s[3]<.5?-1*o:o)]:[t+-1*r,e+-1*o]:4===i?s[3]<=0&&n[3]>=1?[t+(s[2]<.5?-1*r:r),e]:s[2]<=0&&n[2]>=1?[t,e+(s[3]<.5?-1*o:o)]:[t+r,e+-1*o]:void 0},n=function(e){e=e||{},this.type="StateMachine";var n,r=t.Connectors.AbstractBezierConnector.apply(this,arguments),o=e.curviness||10,a=e.margin||5,l=e.proximityLimit||80;this._computeBezier=function(t,e,h,c,d,u){var p=e.sourcePos[0]<e.targetPos[0]?0:d,f=e.sourcePos[1]<e.targetPos[1]?0:u,m=e.sourcePos[0]<e.targetPos[0]?d:0,g=e.sourcePos[1]<e.targetPos[1]?u:0;0===e.sourcePos[2]&&(p-=a),1===e.sourcePos[2]&&(p+=a),0===e.sourcePos[3]&&(f-=a),1===e.sourcePos[3]&&(f+=a),0===e.targetPos[2]&&(m-=a),1===e.targetPos[2]&&(m+=a),0===e.targetPos[3]&&(g-=a),1===e.targetPos[3]&&(g+=a);var b=(p+m)/2,y=(f+g)/2,v=i(p,f,m,g),C=Math.sqrt(Math.pow(m-p,2)+Math.pow(g-f,2));n=s(b,y,v,e.sourcePos,e.targetPos,o,o,C,l),r.addSegment(this,"Bezier",{x1:m,y1:g,x2:p,y2:f,cp1x:n[0],cp1y:n[1],cp2x:n[0],cp2y:n[1]})}};t.Connectors.StateMachine=n,e.extend(n,t.Connectors.AbstractBezierConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i="Straight",s=function(e){this.type=i;var s=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,e){s.addSegment(this,i,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),s.addSegment(this,i,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),s.addSegment(this,i,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};t.Connectors.Straight=s,e.extend(s,t.Connectors.AbstractConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},s="stroke-dasharray",n="dashstyle",r="fill",o="stroke",a="none",l="http://www.w3.org/2000/svg",h=function(t,e){for(var i in e)t.setAttribute(i,""+e[i])},c=function(e,i){return(i=i||{}).version="1.1",i.xmlns=l,t.createElementNS(l,e,null,null,i)},d=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},u=function(t){for(var e=t.querySelectorAll(" defs,linearGradient,radialGradient"),i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i])},p=function(t,e,l,h,d){if(e.setAttribute(r,l.fill?l.fill:a),e.setAttribute(o,l.stroke?l.stroke:a),l.gradient?function(t,e,i,s,n){var a,l="jsplumb_gradient_"+n._jsPlumb.instance.idstamp();u(t),a=i.gradient.offset?c("radialGradient",{id:l}):c("linearGradient",{id:l,gradientUnits:"userSpaceOnUse"});var h=c("defs");t.appendChild(h),h.appendChild(a);for(var d=0;d<i.gradient.stops.length;d++){var p=i.gradient.stops[1===n.segment||2===n.segment?d:i.gradient.stops.length-1-d][1],f=c("stop",{offset:Math.floor(100*i.gradient.stops[d][0])+"%","stop-color":p});a.appendChild(f)}e.setAttribute(i.stroke?o:r,"url(#"+l+")")}(t,e,l,0,d):(u(t),e.setAttribute("style","")),l.strokeWidth&&e.setAttribute("stroke-width",l.strokeWidth),l[n]&&l.strokeWidth&&!l[s]){var p=-1===l[n].indexOf(",")?" ":",",f=l[n].split(p),m="";f.forEach((function(t){m+=Math.floor(t*l.strokeWidth)+p})),e.setAttribute(s,m)}else l[s]&&e.setAttribute(s,l[s]);for(var g in i)l[g]&&e.setAttribute(i[g],l[g])},f=function(t,e,i){t.childNodes.length>i?t.insertBefore(e,t.childNodes[i]):t.appendChild(e)};e.svg={node:c,attr:h,pos:d};var m=function(i){var s=i.pointerEventsSpec||"all",n={};t.jsPlumbUIComponent.apply(this,i.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var r=i.cssClass+" "+(i.originalArgs[0].cssClass||"");this.svg=c("svg",{style:"",width:0,height:0,"pointer-events":s,position:"absolute"}),i.useDivWrapper?(this.canvas=t.createElement("div",{position:"absolute"}),e.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(h(this.svg,{class:r}),this.canvas=this.svg),i._jsPlumb.appendElement(this.canvas,i.originalArgs[0].parent),i.useDivWrapper&&this.canvas.appendChild(this.svg);var o=[this.canvas];return this.getDisplayElements=function(){return o},this.appendDisplayElement=function(t){o.push(t)},this.paint=function(t,s,r){if(null!=t){var o,a=[this.x,this.y],l=[this.w,this.h];null!=r&&(r.xmin<0&&(a[0]+=r.xmin),r.ymin<0&&(a[1]+=r.ymin),l[0]=r.xmax+(r.xmin<0?-r.xmin:0),l[1]=r.ymax+(r.ymin<0?-r.ymin:0)),i.useDivWrapper?(e.sizeElement(this.canvas,a[0],a[1],l[0],l[1]),a[0]=0,a[1]=0,o=d([0,0])):o=d([a[0],a[1]]),n.paint.apply(this,arguments),h(this.svg,{style:o,width:l[0]||0,height:l[1]||0})}},{renderer:n}};e.extend(m,t.jsPlumbUIComponent,{cleanup:function(t){t||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(t){var e=t.getContainer();this.canvas&&null==this.canvas.parentNode&&e.appendChild(this.canvas),this.bgCanvas&&null==this.bgCanvas.parentNode&&e.appendChild(this.bgCanvas)},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none")}}),t.ConnectorRenderers.svg=function(e){var i=this,s=m.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);s.renderer.paint=function(s,n,r){var o=i.getSegments(),a=[0,0];if(r.xmin<0&&(a[0]=-r.xmin),r.ymin<0&&(a[1]=-r.ymin),o.length>0){var l={d:i.getPathData(),transform:"translate("+a[0]+","+a[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},d=null;if(s.outlineStroke){var u=s.strokeWidth+2*(s.outlineWidth||1);delete(d=t.extend({},s)).gradient,d.stroke=s.outlineStroke,d.strokeWidth=u,null==i.bgPath?(i.bgPath=c("path",l),t.addClass(i.bgPath,t.connectorOutlineClass),f(i.svg,i.bgPath,0)):h(i.bgPath,l),p(i.svg,i.bgPath,d,0,i)}null==i.path?(i.path=c("path",l),f(i.svg,i.path,s.outlineStroke?1:0)):h(i.path,l),p(i.svg,i.path,s,0,i)}}},e.extend(t.ConnectorRenderers.svg,m);var g=t.SvgEndpoint=function(e){var i=m.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]);i.renderer.paint=(function(e){var i=t.extend({},e);i.outlineStroke&&(i.stroke=i.outlineStroke),null==this.node?(this.node=this.makeNode(i),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),p(this.svg,this.node,i,0,this),d(this.node)}).bind(this)};e.extend(g,m),t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments),g.apply(this,arguments),this.makeNode=function(t){return c("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){h(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},e.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,g]),t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),g.apply(this,arguments),this.makeNode=function(t){return c("rect",{width:this.w,height:this.h})},this.updateNode=function(t){h(t,{width:this.w,height:this.h})}},e.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,g]),t.Endpoints.svg.Image=t.Endpoints.Image,t.Endpoints.svg.Blank=t.Endpoints.Blank,t.Overlays.svg.Label=t.Overlays.Label,t.Overlays.svg.Custom=t.Overlays.Custom;var b=function(e,i){e.apply(this,i),t.jsPlumbUIComponent.apply(this,i),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(t,e){if(t.component.svg&&e){null==this.path&&(this.path=c("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,t.component),this.canvas=t.component.svg);var n=i&&1===i.length&&i[0].cssClass||"",r=[0,0];e.xmin<0&&(r[0]=-e.xmin),e.ymin<0&&(r[1]=-e.ymin),h(this.path,{d:s(t.d),class:n,stroke:t.stroke?t.stroke:null,fill:t.fill?t.fill:null,transform:"translate("+r[0]+","+r[1]+")"})}};var s=function(t){return isNaN(t.cxy.x)||isNaN(t.cxy.y)?"":"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.transfer=function(t){t.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),t.canvas.appendChild(this.path))}};e.extend(b,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay],{cleanup:function(t){null!=this.path&&(t?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(t,e){this.path&&e.canvas&&e.canvas.appendChild(this.path)},setVisible:function(t){null!=this.path&&(this.path.style.display=t?"block":"none")}}),t.Overlays.svg.Arrow=function(){b.apply(this,[t.Overlays.Arrow,arguments])},e.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,b]),t.Overlays.svg.PlainArrow=function(){b.apply(this,[t.Overlays.PlainArrow,arguments])},e.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,b]),t.Overlays.svg.Diamond=function(){b.apply(this,[t.Overlays.Diamond,arguments])},e.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,b]),t.Overlays.svg.GuideLines=function(){var e,i,s=null,n=this;t.Overlays.GuideLines.apply(this,arguments),this.paint=function(t,o){null==s&&(s=c("path"),t.connector.svg.appendChild(s),n.attachListeners(s,t.connector),n.attachListeners(s,n),e=c("path"),t.connector.svg.appendChild(e),n.attachListeners(e,t.connector),n.attachListeners(e,n),i=c("path"),t.connector.svg.appendChild(i),n.attachListeners(i,t.connector),n.attachListeners(i,n));var a=[0,0];o.xmin<0&&(a[0]=-o.xmin),o.ymin<0&&(a[1]=-o.ymin),h(s,{d:r(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),h(e,{d:r(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),h(i,{d:r(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var r=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}},e.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=t.Katavorio,n=t.Biltong,r=function(t,i){var r="_katavorio_"+(i=i||"main"),o=t[r],a=t.getEventManager();return o||((o=new s({bind:a.on,unbind:a.off,getSize:e.getSize,getConstrainingRectangle:function(t){return[t.parentNode.scrollWidth,t.parentNode.scrollHeight]},getPosition:function(e,i){var s=t.getOffset(e,i,e._katavorioDrag?e.offsetParent:null);return[s.left,s.top]},setPosition:function(t,e){t.style.left=e[0]+"px",t.style.top=e[1]+"px"},addClass:e.addClass,removeClass:e.removeClass,intersects:n.intersects,indexOf:function(t,e){return t.indexOf(e)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}})).setZoom(t.getZoom()),t[r]=o,t.bind("zoom",o.setZoom)),o},o=function(t){var e=t.el._jsPlumbDragOptions,i=!0;return e.canDrag&&(i=e.canDrag()),i&&(this.setHoverSuspended(!0),this.select({source:t.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:t.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),i},a=function(t){var e=this.getUIPosition(arguments,this.getZoom());if(null!=e){var i=t.el._jsPlumbDragOptions;this.draw(t.el,e,null,!0),i._dragging&&this.addClass(t.el,"jtk-dragged"),i._dragging=!0}},l=function(t){for(var e,i=t.selection,s=(function(t){null!=t[1]&&(e=this.getUIPosition([{el:t[2].el,pos:[t[1].left,t[1].top]}]),this.draw(t[2].el,e)),delete t[0]._jsPlumbDragOptions._dragging,this.removeClass(t[0],"jtk-dragged"),this.select({source:t[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:t[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.getDragManager().dragEnded(t[2].el)}).bind(this),n=0;n<i.length;n++)s(i[n]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},h=function(t,e){var s=function(s){if(null!=e[s]){if(i.isString(e[s])){var n=e[s].match(/-=/)?-1:1,r=e[s].substring(2);return t[s]+n*r}return e[s]}return t[s]};return[s("left"),s("top")]},c=function(t,e){if(null==e)return[0,0];var i=m(e),s=f(i,0);return[s[t+"X"],s[t+"Y"]]},d=c.bind(this,"page"),u=c.bind(this,"screen"),p=c.bind(this,"client"),f=function(t,e){return t.item?t.item(e):t[e]},m=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},g=function(t){var e={},i=[],s={},n={},r={};this.register=function(o){var a,l=t.getId(o);e[l]||(e[l]=o,i.push(o),s[l]={});var h=function(e){if(e)for(var i=0;i<e.childNodes.length;i++)if(3!==e.childNodes[i].nodeType&&8!==e.childNodes[i].nodeType){var c=jsPlumb.getElement(e.childNodes[i]),d=t.getId(e.childNodes[i],null,!0);if(d&&n[d]&&n[d]>0){a||(a=t.getOffset(o));var u=t.getOffset(c);s[l][d]={id:d,offset:{left:u.left-a.left,top:u.top-a.top}},r[d]=l}h(e.childNodes[i])}};h(o)},this.updateOffsets=function(e,i){if(null!=e){i=i||{};var n,o=jsPlumb.getElement(e),a=t.getId(o),l=s[a];if(l)for(var h in l)if(l.hasOwnProperty(h)){var c=jsPlumb.getElement(h),d=i[h]||t.getOffset(c);if(null==c.offsetParent&&null!=s[a][h])continue;n||(n=t.getOffset(o)),s[a][h]={id:h,offset:{left:d.left-n.left,top:d.top-n.top}},r[h]=a}}},this.endpointAdded=function(i,o){o=o||t.getId(i);var a=document.body,l=i.parentNode;for(n[o]=n[o]?n[o]+1:1;null!=l&&l!==a;){var h=t.getId(l,null,!0);if(h&&e[h]){var c=t.getOffset(l);if(null==s[h][o]){var d=t.getOffset(i);s[h][o]={id:o,offset:{left:d.left-c.left,top:d.top-c.top}},r[o]=h}break}l=l.parentNode}},this.endpointDeleted=function(t){if(n[t.elementId]&&(n[t.elementId]--,n[t.elementId]<=0))for(var e in s)s.hasOwnProperty(e)&&s[e]&&(delete s[e][t.elementId],delete r[t.elementId])},this.changeId=function(t,e){s[e]=s[t],s[t]={},r[e]=r[t],r[t]=null},this.getElementsForDraggable=function(t){return s[t]},this.elementRemoved=function(t){var e=r[t];e&&(delete s[e][t],delete r[t])},this.reset=function(){e={},i=[],s={},n={}},this.dragEnded=function(e){if(null!=e.offsetParent){var i=t.getId(e),s=r[i];s&&this.updateOffsets(s)}},this.setParent=function(e,i,n,o,a){var l=r[i];s[o]||(s[o]={});var h=t.getOffset(n),c=a||t.getOffset(e);l&&s[l]&&delete s[l][i],s[o][i]={id:i,offset:{left:c.left-h.left,top:c.top-h.top}},r[i]=o},this.clearParent=function(t,e){var i=r[e];i&&(delete s[i][e],delete r[e])},this.revalidateParent=function(e,i,s){var n=r[i];if(n){var o={};o[i]=s,this.updateOffsets(n,o),t.revalidate(n)}},this.getDragAncestor=function(e){var i=jsPlumb.getElement(e),s=t.getId(i),n=r[s];return n?jsPlumb.getElement(n):null}},b=function(t,e,s){e=i.fastTrim(e),void 0!==t.className.baseVal?t.className.baseVal=e:t.className=e;try{var n=t.classList;if(null!=n){for(;n.length>0;)n.remove(n.item(0));for(var o=0;o<s.length;o++)s[o]&&n.add(s[o])}}catch(r){i.log("JSPLUMB: cannot set class list",r)}},y=function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},v=function(t,e,s){e=null==e?[]:i.isArray(e)?e:e.split(/\s+/),s=null==s?[]:i.isArray(s)?s:s.split(/\s+/);var n=y(t).split(/\s+/),r=function(t,e){for(var i=0;i<e.length;i++)if(t)-1===n.indexOf(e[i])&&n.push(e[i]);else{var s=n.indexOf(e[i]);-1!==s&&n.splice(s,1)}};r(!0,e),r(!1,s),b(t,n.join(" "),n)};t.jsPlumb.extend(t.jsPlumbInstance.prototype,{headless:!1,pageLocation:d,screenLocation:u,clientLocation:p,getDragManager:function(){return null==this.dragManager&&(this.dragManager=new g(this)),this.dragManager},recalculateOffsets:function(t){this.getDragManager().updateOffsets(t)},createElement:function(t,e,i,s){return this.createElementNS(null,t,e,i,s)},createElementNS:function(t,e,i,s,n){var r,o=null==t?document.createElement(e):document.createElementNS(t,e);for(r in i=i||{})o.style[r]=i[r];for(r in s&&(o.className=s),n=n||{})o.setAttribute(r,""+n[r]);return o},getAttribute:function(t,e){return null!=t.getAttribute?t.getAttribute(e):null},setAttribute:function(t,e,i){null!=t.setAttribute&&t.setAttribute(e,i)},setAttributes:function(t,e){for(var i in e)e.hasOwnProperty(i)&&t.setAttribute(i,e[i])},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["svg"]},getClass:y,addClass:function(t,e){jsPlumb.each(t,(function(t){v(t,e)}))},hasClass:function(t,e){return(t=jsPlumb.getElement(t)).classList?t.classList.contains(e):-1!==y(t).indexOf(e)},removeClass:function(t,e){jsPlumb.each(t,(function(t){v(t,null,e)}))},toggleClass:function(t,e){jsPlumb.hasClass(t,e)?jsPlumb.removeClass(t,e):jsPlumb.addClass(t,e)},updateClasses:function(t,e,i){jsPlumb.each(t,(function(t){v(t,e,i)}))},setClass:function(t,e){null!=e&&jsPlumb.each(t,(function(t){b(t,e,e.split(/\s+/))}))},setPosition:function(t,e){t.style.left=e.left+"px",t.style.top=e.top+"px"},getPosition:function(t){var e=function(e){var i=t.style[e];return i?i.substring(0,i.length-2):0};return{left:e("left"),top:e("top")}},getStyle:function(t,e){return void 0!==window.getComputedStyle?getComputedStyle(t,null).getPropertyValue(e):t.currentStyle[e]},getSelector:function(t,e){return 1===arguments.length?null!=t.nodeType?t:document.querySelectorAll(t):t.querySelectorAll(e)},getOffset:function(t,e,i){t=jsPlumb.getElement(t),i=i||this.getContainer();for(var s={left:t.offsetLeft,top:t.offsetTop},n=e||null!=i&&t!==i&&t.offsetParent!==i?t.offsetParent:null,r=(function(t){null!=t&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(s.left-=t.scrollLeft,s.top-=t.scrollTop)}).bind(this);null!=n;)s.left+=n.offsetLeft,s.top+=n.offsetTop,r(n),n=e?n.offsetParent:n.offsetParent===i?null:n.offsetParent;if(null!=i&&!e&&(i.scrollTop>0||i.scrollLeft>0)){var o=null!=t.offsetParent?this.getStyle(t.offsetParent,"position"):"static",a=this.getStyle(t,"position");"absolute"!==a&&"fixed"!==a&&"absolute"!==o&&"fixed"!==o&&(s.left-=i.scrollLeft,s.top-=i.scrollTop)}return s},getPositionOnElement:function(t,e,i){var s=void 0!==e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},n=document.body,r=document.documentElement,o=window.pageYOffset||r.scrollTop||n.scrollTop,a=window.pageXOffset||r.scrollLeft||n.scrollLeft,l=s.top+o-(r.clientTop||n.clientTop||0)+0*i,h=s.left+a-(r.clientLeft||n.clientLeft||0)+0*i,c=jsPlumb.pageLocation(t);return[(c[0]-h)/(s.width||e.offsetWidth*i),(c[1]-l)/(s.height||e.offsetHeight*i)]},getAbsolutePosition:function(t){var e=function(e){var i=t.style[e];return i?parseFloat(i.substring(0,i.length-2)):void 0};return[e("left"),e("top")]},setAbsolutePosition:function(t,e,i,s){i?this.animate(t,{left:"+="+(e[0]-i[0]),top:"+="+(e[1]-i[1])},s):(t.style.left=e[0]+"px",t.style.top=e[1]+"px")},getSize:function(t){return[t.offsetWidth,t.offsetHeight]},getWidth:function(t){return t.offsetWidth},getHeight:function(t){return t.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(t,e){var s;return t=i.isArray(t)||null!=t.length&&!i.isString(t)?t:[t],Array.prototype.slice.call(t).forEach((function(t){(s=this.info(t)).el&&this._initDraggableIfNecessary(s.el,!0,e,s.id,!0)}).bind(this)),this},snapToGrid:function(t,e,i){var s=[],n=(function(t){var n=this.info(t);if(null!=n.el&&n.el._katavorioDrag){var r=n.el._katavorioDrag.snap(e,i);this.revalidate(n.el),s.push([n.el,r])}}).bind(this);if(1===arguments.length||3===arguments.length)n(t,e,i);else{var r=this.getManagedElements();for(var o in r)n(o,arguments[0],arguments[1])}return s},initDraggable:function(t,e,i){r(this,i).draggable(t,e),t._jsPlumbDragOptions=e},destroyDraggable:function(t,e){r(this,e).destroyDraggable(t),delete t._jsPlumbDragOptions},unbindDraggable:function(t,e,i,s){r(this,s).destroyDraggable(t,e,i)},setDraggable:function(t,e){return jsPlumb.each(t,(function(t){this.isDragSupported(t)&&(this._draggableStates[this.getAttribute(t,"id")]=e,this.setElementDraggable(t,e))}).bind(this))},_draggableStates:{},toggleDraggable:function(t){var e;return jsPlumb.each(t,(function(t){var i=this.getAttribute(t,"id");return this._draggableStates[i]=e=!(e=null!=this._draggableStates[i]&&this._draggableStates[i]),this.setDraggable(t,e),e}).bind(this)),e},_initDraggableIfNecessary:function(t,e,s,n,r){if(!jsPlumb.headless&&null!=e&&e&&jsPlumb.isDragSupported(t,this)){var h=s||this.Defaults.DragOptions;if(h=jsPlumb.extend({},h),jsPlumb.isAlreadyDraggable(t,this))s.force&&this.initDraggable(t,h);else{var c=jsPlumb.dragEvents.drag,d=jsPlumb.dragEvents.stop,u=jsPlumb.dragEvents.start;this.manage(n,t),h[u]=i.wrap(h[u],o.bind(this)),h[c]=i.wrap(h[c],a.bind(this)),h[d]=i.wrap(h[d],l.bind(this));var p=this.getId(t);this._draggableStates[p]=!0;var f=this._draggableStates[p];h.disabled=null!=f&&!f,this.initDraggable(t,h),this.getDragManager().register(t),r&&this.fire("elementDraggable",{el:t,options:h})}}},animationSupported:!0,getElement:function(t){return null==t?null:"string"==typeof(t="string"==typeof t?t:null!=t.length&&null==t.enctype?t[0]:t)?document.getElementById(t):t},removeElement:function(t){r(this).elementRemoved(t),this.getEventManager().remove(t)},doAnimate:function(t,i,s){s=s||{};var n=this.getOffset(t),r=h(n,i),o=s.duration||250,a=o/15,l=15/o*(r[0]-n.left),c=15/o*(r[1]-n.top),d=0,u=setInterval((function(){e.setPosition(t,{left:n.left+l*(d+1),top:n.top+c*(d+1)}),null!=s.step&&s.step(d,Math.ceil(a)),++d>=a&&(window.clearInterval(u),null!=s.complete&&s.complete())}),15)},destroyDroppable:function(t,e){r(this,e).destroyDroppable(t)},unbindDroppable:function(t,e,i,s){r(this,s).destroyDroppable(t,e,i)},droppable:function(t,e){var s;return t=i.isArray(t)||null!=t.length&&!i.isString(t)?t:[t],(e=e||{}).allowLoopback=!1,Array.prototype.slice.call(t).forEach((function(t){(s=this.info(t)).el&&this.initDroppable(s.el,e)}).bind(this)),this},initDroppable:function(t,e,i){r(this,i).droppable(t,e)},isAlreadyDraggable:function(t){return null!=t._katavorioDrag},isDragSupported:function(t,e){return!0},isDropSupported:function(t,e){return!0},isElementDraggable:function(t){return(t=e.getElement(t))._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(t){return t[0].drag.getDragElement()},getDragScope:function(t){return t._katavorioDrag&&t._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(t){return t[0].e},getUIPosition:function(t,e){var i=t[0].el;if(null==i.offsetParent)return null;var s=t[0].finalPos||t[0].pos,n={left:s[0],top:s[1]};if(i._katavorioDrag&&i.offsetParent!==this.getContainer()){var r=this.getOffset(i.offsetParent);n.left+=r.left,n.top+=r.top}return n},setDragFilter:function(t,e,i){t._katavorioDrag&&t._katavorioDrag.setFilter(e,i)},setElementDraggable:function(t,i){(t=e.getElement(t))._katavorioDrag&&t._katavorioDrag.setEnabled(i)},setDragScope:function(t,e){t._katavorioDrag&&t._katavorioDrag.k.setDragScope(t,e)},setDropScope:function(t,e){t._katavorioDrop&&t._katavorioDrop.length>0&&t._katavorioDrop[0].k.setDropScope(t,e)},addToPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.addToPosse.apply(n,t)}))},setPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.setPosse.apply(n,t)}))},removeFromPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.removeFromPosse.apply(n,t)}))},removeFromAllPosses:function(t){var i=r(this);e.each(t,(function(t){i.removeFromAllPosses(e.getElement(t))}))},setPosseState:function(t,i,s){var n=r(this);e.each(t,(function(t){n.setPosseState(e.getElement(t),i,s)}))},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(t){t._katavorioDrag&&t._katavorioDrag.abort()},addToDragSelection:function(t){r(this).select(t)},removeFromDragSelection:function(t){r(this).deselect(t)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(t,e,i,s){this.getEventManager().trigger(t,e,i,s)},doReset:function(){for(var t in this)0===t.indexOf("_katavorio_")&&this[t].reset()},getEventManager:function(){return function(e){var i=e._mottle;return i||(i=e._mottle=new t.Mottle),i}(this)},on:function(t,e,i){return this.getEventManager().on.apply(this,arguments),this},off:function(t,e,i){return this.getEventManager().off.apply(this,arguments),this}}),function(t){var e=function(){/complete|loaded|interactive/.test(document.readyState)&&void 0!==document.body&&null!=document.body?t():setTimeout(e,9)};e()}(e.init)}).call("undefined"!=typeof window?window:this),function(t,e){"function"==typeof define&&define.amd?define("jsxgraphcore",[],e):"object"==typeof module&&module.exports?module.exports=e():t.returnExports=e()}(this,(function(){var requirejs,require,define;return function(t){function e(t,e){return b.call(t,e)}function i(t,e){var i,s,n,r,o,a,l,h,c,d,u,p=e&&e.split("/"),f=m.map,g=f&&f["*"]||{};if(t){for(o=(t=t.split("/")).length-1,m.nodeIdCompat&&v.test(t[o])&&(t[o]=t[o].replace(v,"")),"."===t[0].charAt(0)&&p&&(t=p.slice(0,p.length-1).concat(t)),c=0;c<t.length;c++)if("."===(u=t[c]))t.splice(c,1),c-=1;else if(".."===u){if(0===c||1===c&&".."===t[2]||".."===t[c-1])continue;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}if((p||g)&&f){for(c=(i=t.split("/")).length;c>0;c-=1){if(s=i.slice(0,c).join("/"),p)for(d=p.length;d>0;d-=1)if((n=f[p.slice(0,d).join("/")])&&(n=n[s])){r=n,a=c;break}if(r)break;!l&&g&&g[s]&&(l=g[s],h=c)}!r&&l&&(r=l,a=h),r&&(i.splice(0,a,r),t=i.join("/"))}return t}function s(e,i){return function(){var s=y.call(arguments,0);return"string"!=typeof s[0]&&1===s.length&&s.push(null),c.apply(t,s.concat([e,i]))}}function n(t){return function(e){p[t]=e}}function r(i){if(e(f,i)){var s=f[i];delete f[i],g[i]=!0,h.apply(t,s)}if(!e(p,i)&&!e(g,i))throw new Error("No "+i);return p[i]}function o(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function a(t){return t?o(t):[]}function l(t){return function(){return m&&m.config&&m.config[t]||{}}}var h,c,d,u,p={},f={},m={},g={},b=Object.prototype.hasOwnProperty,y=[].slice,v=/\.js$/;d=function(t,e){var s,n=o(t),a=n[0],l=e[1];return t=n[1],a&&(s=r(a=i(a,l))),a?t=s&&s.normalize?s.normalize(t,function(t){return function(e){return i(e,t)}}(l)):i(t,l):(t=(n=o(t=i(t,l)))[1],(a=n[0])&&(s=r(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:s}},u={require:function(t){return s(t)},exports:function(t){var e=p[t];return void 0!==e?e:p[t]={}},module:function(t){return{id:t,uri:"",exports:p[t],config:l(t)}}},h=function(i,o,l,h){var c,m,b,y,v,C,x,_=[],P=typeof l;if(C=a(h=h||i),"undefined"===P||"function"===P){for(o=!o.length&&l.length?["require","exports","module"]:o,v=0;v<o.length;v+=1)if("require"===(m=(y=d(o[v],C)).f))_[v]=u.require(i);else if("exports"===m)_[v]=u.exports(i),x=!0;else if("module"===m)c=_[v]=u.module(i);else if(e(p,m)||e(f,m)||e(g,m))_[v]=r(m);else{if(!y.p)throw new Error(i+" missing "+m);y.p.load(y.n,s(h,!0),n(m),{}),_[v]=p[m]}b=l?l.apply(p[i],_):void 0,i&&(c&&c.exports!==t&&c.exports!==p[i]?p[i]=c.exports:b===t&&x||(p[i]=b))}else i&&(p[i]=l)},requirejs=require=c=function(e,i,s,n,o){if("string"==typeof e)return u[e]?u[e](i):r(d(e,a(i)).f);if(!e.splice){if((m=e).deps&&c(m.deps,m.callback),!i)return;i.splice?(e=i,i=s,s=null):e=t}return i=i||function(){},"function"==typeof s&&(s=n,n=o),n?h(t,e,i,s):setTimeout((function(){h(t,e,i,s)}),4),c},c.config=function(t){return c(t)},requirejs._defined=p,(define=function(t,i,s){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");i.splice||(s=i,i=[]),e(p,t)||e(f,t)||(f[t]=[t,i,s])}).amd={jQuery:!0}}(),define("../node_modules/almond/almond",(function(){})),define("jxg",[],(function(){"use strict";var t={};return"object"!=typeof JXG||JXG.extend||(t=JXG),t.extend=function(t,e,i,s){var n;for(n in i=i||!1,s=s||!1,e)(!i||i&&e.hasOwnProperty(n))&&(t[s?n.toLowerCase():n]=e[n])},t.extend(t,{boards:{},readers:{},elements:{},registerElement:function(t,e){t=t.toLowerCase(),this.elements[t]=e},registerReader:function(t,e){var i,s;for(i=0;i<e.length;i++)s=e[i].toLowerCase(),"function"!=typeof this.readers[s]&&(this.readers[s]=t)},shortcut:function(t,e){return function(){return t[e].apply(this,arguments)}},getRef:function(e,i){return t.deprecated("JXG.getRef()","Board.select()"),e.select(i)},getReference:function(e,i){return t.deprecated("JXG.getReference()","Board.select()"),e.select(i)},getBoardByContainerId:function(t){var e;for(e in JXG.boards)if(JXG.boards.hasOwnProperty(e)&&JXG.boards[e].container===t)return JXG.boards[e];return null},deprecated:function(e,i){var s=e+" is deprecated.";i&&(s+=" Please use "+i+" instead."),t.warn(s)},warn:function(t){"object"==typeof window&&window.console&&console.warn?console.warn("WARNING:",t):"object"==typeof document&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+t+"<br />")},debugInt:function(t){var e,i;for(e=0;e<arguments.length;e++)i=arguments[e],"object"==typeof window&&window.console&&console.log?console.log(i):"object"==typeof document&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=i+"<br/>")},debugWST:function(e){var i=new Error;t.debugInt.apply(this,arguments),i&&i.stack&&(t.debugInt("stacktrace"),t.debugInt(i.stack.split("\n").slice(1).join("\n")))},debugLine:function(e){var i=new Error;t.debugInt.apply(this,arguments),i&&i.stack&&t.debugInt("Called from",i.stack.split("\n").slice(2,3).join("\n"))},debug:function(e){t.debugInt.apply(this,arguments)}}),t})),define("base/constants",["jxg"],(function(t){"use strict";var e;return t.extend(t,e={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82}),e})),define("utils/type",["jxg","base/constants"],(function(t,e){"use strict";return t.extend(t,{isId:function(t,e){return"string"==typeof e&&!!t.objects[e]},isName:function(t,e){return"string"==typeof e&&!!t.elementsByName[e]},isGroup:function(t,e){return"string"==typeof e&&!!t.groups[e]},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t||"[Object Number]"===Object.prototype.toString.call(t)},isFunction:function(t){return"function"==typeof t},isArray:function(t){return Array.isArray?Array.isArray(t):null!==t&&"object"==typeof t&&"function"==typeof t.splice&&"function"==typeof t.join},isObject:function(t){return"object"==typeof t&&!this.isArray(t)},isPoint:function(t){return null!==t&&"object"==typeof t&&t.elementClass===e.OBJECT_CLASS_POINT},isPointType:function(t,e){var i,s;return!!this.isArray(e)||!!(this.isFunction(e)&&(i=e(),this.isArray(i)&&i.length>1))||(s=t.select(e),this.isPoint(s))},isTransformationOrArray:function(t){if(null!==t){if(this.isArray(t)&&t.length>0)return this.isTransformationOrArray(t[0]);if("object"==typeof t)return t.type===e.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(t){return!(null==t)},def:function(t,e){return this.exists(t)?t:e},str2Bool:function(t){return!this.exists(t)||("boolean"==typeof t?t:!!this.isString(t)&&"true"===t.toLowerCase())},createEvalFunction:function(e,i,s){var n,r=[];for(n=0;n<s;n++)r[n]=t.createFunction(i[n],e,"",!0);return function(t){return r[t]()}},createFunction:function(t,e,i,s){var n=null;return this.exists(s)&&!s||!this.isString(t)?this.isFunction(t)?n=t:this.isNumber(t)?n=function(){return t}:this.isString(t)&&(n=function(){return t}):n=e.jc.snippet(t,!0,i,!0),null!==n&&(n.origin=t),n},providePoints:function(t,e,i,s,n){var r,o,a,l,h,c=0,d=[];for(this.isArray(e)||(e=[e]),a=e.length,this.exists(n)&&(c=n.length),0===c&&(l=this.copyAttributes(i,t.options,s)),r=0;r<a;++r)if(c>0&&(o=Math.min(r,c-1),l=this.copyAttributes(i,t.options,s,n[o])),this.isArray(e[r])&&e[r].length>1?d.push(t.create("point",e[r],l)):this.isFunction(e[r])?(h=e[r](),this.isArray(h)&&h.length>1&&d.push(t.create("point",[e[r]],l))):d.push(t.select(e[r])),!this.isPoint(d[r]))return!1;return d},bind:function(t,e){return function(){return t.apply(e,arguments)}},evaluate:function(t){return this.isFunction(t)?t():t},indexOf:function(t,e,i){var s,n=this.exists(i);if(Array.indexOf&&!n)return t.indexOf(e);for(s=0;s<t.length;s++)if(n&&t[s][i]===e||!n&&t[s]===e)return s;return-1},eliminateDuplicates:function(t){var e,i=t.length,s=[],n={};for(e=0;e<i;e++)n[t[e]]=0;for(e in n)n.hasOwnProperty(e)&&s.push(e);return s},swap:function(t,e,i){var s;return s=t[e],t[e]=t[i],t[i]=s,t},uniqueArray:function(e){var i,s,n,r=[];if(0===e.length)return[];for(i=0;i<e.length;i++)if(n=this.isArray(e[i]),this.exists(e[i]))for(s=i+1;s<e.length;s++)n&&t.cmpArrays(e[i],e[s])?e[i]=[]:n||e[i]!==e[s]||(e[i]="");else e[i]="";for(s=0,i=0;i<e.length;i++)(n=this.isArray(e[i]))||""===e[i]?n&&0!==e[i].length&&(r[s]=e[i].slice(0),s++):(r[s]=e[i],s++);return e=r,r},isInArray:function(e,i){return t.indexOf(e,i)>-1},coordsArrayToMatrix:function(t,e){var i,s=[],n=[];for(i=0;i<t.length;i++)e?(s.push(t[i].usrCoords[1]),n.push(t[i].usrCoords[2])):n.push([t[i].usrCoords[1],t[i].usrCoords[2]]);return e&&(n=[s,n]),n},cmpArrays:function(t,e){var i;if(t===e)return!0;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(this.isArray(t[i])&&this.isArray(e[i])){if(!this.cmpArrays(t[i],e[i]))return!1}else if(t[i]!==e[i])return!1;return!0},removeElementFromArray:function(t,e){var i;for(i=0;i<t.length;i++)if(t[i]===e)return t.splice(i,1),t;return t},trunc:function(e,i){return i=t.def(i,0),this.toFixed(e,i)},_decimalAdjust:function(t,e,i){return void 0===i||0==+i?Math[t](e):(e=+e,i=+i,isNaN(e)||"number"!=typeof i||i%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math[t](+(e[0]+"e"+(e[1]?+e[1]-i:-i)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+i:i))))},_round10:function(t,e){return this._decimalAdjust("round",t,e)},_floor10:function(t,e){return this._decimalAdjust("floor",t,e)},_ceil10:function(t,e){return this._decimalAdjust("ceil",t,e)},toFixed:function(t,e){return this._round10(t,-e).toFixed(e)},autoDigits:function(t){var e=Math.abs(t);return e>.1?this.toFixed(t,2):e>=.01?this.toFixed(t,4):e>=1e-4?this.toFixed(t,6):t},keys:function(t,e){var i,s=[];for(i in t)e?t.hasOwnProperty(i)&&s.push(i):s.push(i);return s},clone:function(t){var e={};return e.prototype=t,e},cloneAndCopy:function(t,e){var i,s=function(){};for(i in s.prototype=t,e)s[i]=e[i];return s},merge:function(t,e){var i,s;for(i in e)if(e.hasOwnProperty(i))if(this.isArray(e[i]))for(t[i]||(t[i]=[]),s=0;s<e[i].length;s++)t[i][s]="object"==typeof e[i][s]?this.merge(t[i][s],e[i][s]):e[i][s];else"object"==typeof e[i]?(t[i]||(t[i]={}),t[i]=this.merge(t[i],e[i])):t[i]=e[i];return t},deepCopy:function(t,e,i){var s,n,r,o;if(i=i||!1,"object"!=typeof t||null===t)return t;if(this.isArray(t))for(s=[],n=0;n<t.length;n++)s[n]="object"==typeof(r=t[n])?this.exists(r.board)?r.id:this.deepCopy(r):r;else{for(n in s={},t)t.hasOwnProperty(n)&&(s[o=i?n.toLowerCase():n]=null!==(r=t[n])&&"object"==typeof r?this.exists(r.board)?r.id:this.deepCopy(r):r);for(n in e)e.hasOwnProperty(n)&&(s[o=i?n.toLowerCase():n]="object"==typeof(r=e[n])?this.isArray(r)||!this.exists(s[o])?this.deepCopy(r):this.deepCopy(s[o],r,i):r)}return s},copyAttributes:function(e,i,s){var n,r,o,a,l,h={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(n=(o=arguments.length)<3||h[s]?t.deepCopy(i.elements,null,!0):{},o<4&&this.exists(s)&&this.exists(i.layer[s])&&(n.layer=i.layer[s]),a=i,l=!0,r=2;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}for(l&&(n=t.deepCopy(n,a,!0)),a=e,l=!0,r=3;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}for(l&&this.extend(n,a,null,!0),a=i,l=!0,r=2;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}return l&&this.exists(a.label)&&(n.label=t.deepCopy(a.label,n.label)),n.label=t.deepCopy(i.label,n.label),n},copyPrototypeMethods:function(t,e,i){var s;for(s in t.prototype[i]=e.prototype.constructor,e.prototype)e.prototype.hasOwnProperty(s)&&(t.prototype[s]=e.prototype[s])},toJSON:function(e,i){var s,n,r,o;if(i=t.def(i,!1),JSON.stringify&&!i)try{return JSON.stringify(e)}catch(t){}switch(typeof e){case"object":if(e){if(s=[],this.isArray(e)){for(r=0;r<e.length;r++)s.push(t.toJSON(e[r],i));return"["+s.join(",")+"]"}for(n in e)if(e.hasOwnProperty(n)){try{o=t.toJSON(e[n],i)}catch(t){o=""}s.push(i?n+":"+o:'"'+n+'":'+o)}return"{"+s.join(",")+"} "}return"null";case"string":return"'"+e.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return e.toString()}return"0"},clearVisPropOld:function(t){return t.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},t},isInObject:function(t,e){var i;for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1},escapeHTML:function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(t){return t.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()},trimNumber:function(t){return"."!==(t=(t=t.replace(/^0+/,"")).replace(/0+$/,""))[t.length-1]&&","!==t[t.length-1]||(t=t.slice(0,-1)),"."!==t[0]&&","!==t[0]||(t="0"+t),t},filterElements:function(t,e){var i,s,n,r,o,a,l,h=t.length,c=[];if("function"!=typeof e&&"object"!=typeof e)return c;for(i=0;i<h;i++){if(l=!0,n=t[i],"object"==typeof e){for(s in e)if(e.hasOwnProperty(s)&&(r=s.toLowerCase(),o="function"==typeof n[s]?n[s]():n[s],a=n.visProp&&"function"==typeof n.visProp[r]?n.visProp[r]():n.visProp&&n.visProp[r],!(l="function"==typeof e[s]?e[s](o)||e[s](a):o===e[s]||a===e[s])))break}else"function"==typeof e&&(l=e(n));l&&c.push(n)}return c},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(t,e){return"function"==typeof html_sanitize&&e?html_sanitize(t,(function(){}),(function(t){return t})):(t&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;")),t)},evalSlider:function(t){return t&&t.type===e.OBJECT_TYPE_GLIDER&&"function"==typeof t.Value?t.Value():t}}),t})),define("utils/env",["jxg","utils/type"],(function(t,e){"use strict";return t.extend(t,{touchProperty:"touches",isBrowser:"object"==typeof window&&"object"==typeof document,supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var e=!1;if(this.isNode())try{e=!!("object"==typeof module?module.require("canvas"):require("canvas"))}catch(t){}return e||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&("object"==typeof module&&!!module.exports||"object"==typeof global&&global.requirejsVars&&!global.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&"object"==typeof self&&"function"==typeof self.postMessage},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&void 0!==window.ontouchstart},isAndroid:function(){return e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return e.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return"object"==typeof window&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&-1===navigator.userAgent.toLowerCase().indexOf("apple")},isFirefoxOS:function(){return e.exists(navigator)&&-1===navigator.userAgent.toLowerCase().indexOf("android")&&-1===navigator.userAgent.toLowerCase().indexOf("apple")&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var t,e,i=3;if("object"!=typeof document)return 0;e=(t=document.createElement("div")).getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++i+"]><i></i><![endif]--\x3e"}while(e[0]);return i>4?i:void 0}(),getDimensions:function(t,i){var s,n,r,o,a,l,h,c,d,u=/\d+(\.\d*)?px/;if(!this.isBrowser||null===t)return{width:500,height:500};if(s=(i=i||document).getElementById(t),!e.exists(s))throw new Error("\nJSXGraph: HTML container element '"+t+"' not found.");return"none"!==(n=s.style.display)&&null!==n?s.clientWidth>0&&s.clientHeight>0?{width:s.clientWidth,height:s.clientHeight}:(d=window.getComputedStyle?window.getComputedStyle(s):s.style,{width:u.test(d.width)?parseFloat(d.width):0,height:u.test(d.height)?parseFloat(d.height):0}):(o=(r=s.style).visibility,a=r.position,l=r.display,r.visibility="hidden",r.position="absolute",r.display="block",h=s.clientWidth,c=s.clientHeight,r.display=l,r.position=a,r.visibility=o,{width:h,height:c})},addEvent:function(t,i,s,n){var r=function(){return s.apply(n,arguments)};r.origin=s,n["x_internal"+i]=n["x_internal"+i]||[],n["x_internal"+i].push(r),e.exists(t)&&e.exists(t.addEventListener)&&t.addEventListener(i,r,!1),e.exists(t)&&e.exists(t.attachEvent)&&t.attachEvent("on"+i,r)},removeEvent:function(i,s,n,r){var o;if(e.exists(r))if(e.exists(r["x_internal"+s]))if(e.isArray(r["x_internal"+s]))if(-1!==(o=e.indexOf(r["x_internal"+s],n,"origin"))){try{e.exists(i)&&e.exists(i.removeEventListener)&&i.removeEventListener(s,r["x_internal"+s][o],!1),e.exists(i)&&e.exists(i.detachEvent)&&i.detachEvent("on"+s,r["x_internal"+s][o])}catch(e){t.debug("event not registered in browser: ("+s+" -- "+n+")")}r["x_internal"+s].splice(o,1)}else t.debug("no such event function in internal list: "+n);else t.debug("owner[x_internal + "+s+"] is not an array");else t.debug("no such type: "+s);else t.debug("no such owner")},removeAllEvents:function(e,i,s){var n;if(s["x_internal"+i]){for(n=s["x_internal"+i].length-1;n>=0;n--)t.removeEvent(e,i,s["x_internal"+i][n].origin,s);s["x_internal"+i].length>0&&t.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(i,s,n){var r,o,a,l=0,h=0;if(i||(i=window.event),n=n||document,e.exists(a=i[t.touchProperty])&&0===a.length&&(a=i.changedTouches),e.exists(s)&&e.exists(a))if(-1===s){for(o=a.length,r=0;r<o;r++)if(a[r]){i=a[r];break}}else i=a[s];return i.clientX&&(l=i.clientX,h=i.clientY),[l,h]},getOffset:function(t){var e,i=t,s=t,n=i.offsetLeft-i.scrollLeft,r=i.offsetTop-i.scrollTop;for(n=(e=this.getCSSTransform([n,r],i))[0],r=e[1],i=i.offsetParent;i;){for(n+=i.offsetLeft,r+=i.offsetTop,i.offsetParent&&(n+=i.clientLeft-i.scrollLeft,r+=i.clientTop-i.scrollTop),n=(e=this.getCSSTransform([n,r],i))[0],r=e[1],s=s.parentNode;s!==i;)n=(e=this.getCSSTransform([n+=s.clientLeft-s.scrollLeft,r+=s.clientTop-s.scrollTop],s))[0],r=e[1],s=s.parentNode;i=i.offsetParent}return[n,r]},getStyle:function(e,i){var s,n=e.ownerDocument;return n.defaultView&&n.defaultView.getComputedStyle?s=n.defaultView.getComputedStyle(e,null).getPropertyValue(i):e.currentStyle&&t.ieVersion>=9?s=e.currentStyle[i]:e.style&&(i=i.replace(/-([a-z]|[0-9])/gi,(function(t,e){return e.toUpperCase()})),s=e.style[i]),s},getProp:function(t,e){var i=parseInt(this.getStyle(t,e),10);return isNaN(i)?0:i},getCSSTransform:function(t,i){var s,n,r,o,a,l,h,c=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(a=c.length,s=0,r="";s<a;s++)if(e.exists(i.style[c[s]])){r=i.style[c[s]];break}if(""!==r&&(o=r.indexOf("("))>0){for(n=0,l=(h=r.substring(o+1,(a=r.length)-1).split(",")).length;n<l;n++)h[n]=parseFloat(h[n]);0===r.indexOf("matrix")?(t[0]+=h[4],t[1]+=h[5]):0===r.indexOf("translateX")?t[0]+=h[0]:0===r.indexOf("translateY")?t[1]+=h[0]:0===r.indexOf("translate")&&(t[0]+=h[0],t[1]+=h[1])}return e.exists(i.style.zoom)&&""!==(r=i.style.zoom)&&(t[0]*=parseFloat(r),t[1]*=parseFloat(r)),t},getCSSTransformMatrix:function(t){var i,s,n,r,o,a,l,h,c=t.ownerDocument,d=["transform","webkitTransform","MozTransform","msTransform","oTransform"],u=[[1,0,0],[0,1,0],[0,0,1]];if(c.defaultView&&c.defaultView.getComputedStyle)n=(h=c.defaultView.getComputedStyle(t,null)).getPropertyValue("-webkit-transform")||h.getPropertyValue("-moz-transform")||h.getPropertyValue("-ms-transform")||h.getPropertyValue("-o-transform")||h.getPropertyValue("transform");else for(o=d.length,i=0,n="";i<o;i++)if(e.exists(t.style[d[i]])){n=t.style[d[i]];break}if(""!==n&&(r=n.indexOf("("))>0){for(s=0,a=(l=n.substring(r+1,(o=n.length)-1).split(",")).length;s<a;s++)l[s]=parseFloat(l[s]);0===n.indexOf("matrix")?u=[[1,0,0],[0,l[0],l[1]],[0,l[2],l[3]]]:0===n.indexOf("scaleX")?u[1][1]=l[0]:0===n.indexOf("scaleY")?u[2][2]=l[0]:0===n.indexOf("scale")&&(u[1][1]=l[0],u[2][2]=l[1])}return e.exists(t.style.zoom)&&""!==(n=t.style.zoom)&&(u[1][1]*=parseFloat(n),u[2][2]*=parseFloat(n)),u},timedChunk:function(t,e,i,s){var n=t.concat(),r=function(){var o=+new Date;do{e.call(i,n.shift())}while(n.length>0&&+new Date-o<300);n.length>0?window.setTimeout(r,1):s(t)};window.setTimeout(r,1)}}),t})),define("utils/xml",["jxg","utils/type"],(function(t,e){"use strict";return t.XML={cleanWhitespace:function(t){for(var i=t.firstChild;e.exists(i);)3!==i.nodeType||/\S/.test(i.nodeValue)?1===i.nodeType&&this.cleanWhitespace(i):t.removeChild(i),i=i.nextSibling},parse:function(t){var e;return e=(new("function"==typeof DOMParser||"object"==typeof DOMParser?DOMParser:function(){this.parseFromString=function(t){var e;return"function"==typeof ActiveXObject&&(e=new ActiveXObject("MSXML.DomDocument")).loadXML(t),e}})).parseFromString(t,"text/xml"),this.cleanWhitespace(e),e}},t.XML})),define("utils/event",["jxg","utils/type"],(function(t,e){"use strict";return t.EventEmitter={eventHandlers:{},suspended:{},trigger:function(t,e){var i,s,n,r,o,a;for(o=t.length,s=0;s<o;s++)if(r=this.eventHandlers[t[s]],!this.suspended[t[s]]){if(this.suspended[t[s]]=!0,r)for(a=r.length,i=0;i<a;i++)(n=r[i]).handler.apply(n.context,e);this.suspended[t[s]]=!1}return this},on:function(t,i,s){return e.isArray(this.eventHandlers[t])||(this.eventHandlers[t]=[]),s=e.def(s,this),this.eventHandlers[t].push({handler:i,context:s}),this},off:function(t,i){var s;return t&&e.isArray(this.eventHandlers[t])?(i?((s=e.indexOf(this.eventHandlers[t],i,"handler"))>-1&&this.eventHandlers[t].splice(s,1),0===this.eventHandlers[t].length&&delete this.eventHandlers[t]):delete this.eventHandlers[t],this):this},eventify:function(t){t.eventHandlers={},t.on=this.on,t.off=this.off,t.triggerEventHandlers=this.trigger,t.trigger=this.trigger,t.suspended={}}},t.EventEmitter})),define("math/math",["jxg","utils/type"],(function(t,e){"use strict";var i=function(t){var e,i;return t.memo?t.memo:(e={},i=Array.prototype.join,t.memo=function(){var s=i.call(arguments);return void 0!==e[s]?e[s]:e[s]=t.apply(this,arguments)},t.memo)};return t.Math={eps:1e-6,relDif:function(t,e){var i=Math.abs(t),s=Math.abs(e);return 0===(s=Math.max(i,s))?0:Math.abs(t-e)/s},mod:function(t,e){return t-Math.floor(t/e)*e},vector:function(t,e){var i,s;for(e=e||0,i=[],s=0;s<t;s++)i[s]=e;return i},matrix:function(t,e,i){var s,n,r;for(i=i||0,e=e||t,s=[],n=0;n<t;n++)for(s[n]=[],r=0;r<e;r++)s[n][r]=i;return s},identity:function(t,e){var i,s;for(void 0===e&&"number"!=typeof e&&(e=t),i=this.matrix(t,e),s=0;s<Math.min(t,e);s++)i[s][s]=1;return i},frustum:function(t,e,i,s,n,r){var o=this.matrix(4,4);return o[0][0]=2*n/(e-t),o[0][1]=0,o[0][2]=(e+t)/(e-t),o[0][3]=0,o[1][0]=0,o[1][1]=2*n/(s-i),o[1][2]=(s+i)/(s-i),o[1][3]=0,o[2][0]=0,o[2][1]=0,o[2][2]=-(r+n)/(r-n),o[2][3]=-r*n*2/(r-n),o[3][0]=0,o[3][1]=0,o[3][2]=-1,o[3][3]=0,o},projection:function(t,e,i,s){var n=i*Math.tan(t/2),r=n*e;return this.frustum(-r,r,-n,n,i,s)},matVecMult:function(t,e){var i,s,n,r=t.length,o=e.length,a=[];if(3===o)for(i=0;i<r;i++)a[i]=t[i][0]*e[0]+t[i][1]*e[1]+t[i][2]*e[2];else for(i=0;i<r;i++){for(s=0,n=0;n<o;n++)s+=t[i][n]*e[n];a[i]=s}return a},matMatMult:function(t,e){var i,s,n,r,o=t.length,a=o>0?e[0].length:0,l=e.length,h=this.matrix(o,a);for(i=0;i<o;i++)for(s=0;s<a;s++){for(n=0,r=0;r<l;r++)n+=t[i][r]*e[r][s];h[i][s]=n}return h},transpose:function(t){var e,i,s,n,r;for(e=this.matrix(r=t.length>0?t[0].length:0,n=t.length),i=0;i<r;i++)for(s=0;s<n;s++)e[i][s]=t[s][i];return e},inverse:function(t){var e,i,s,n,r,o,a,l=t.length,h=[],c=[],d=[];for(e=0;e<l;e++){for(h[e]=[],i=0;i<l;i++)h[e][i]=t[e][i];c[e]=e}for(i=0;i<l;i++){for(r=Math.abs(h[i][i]),o=i,e=i+1;e<l;e++)Math.abs(h[e][i])>r&&(r=Math.abs(h[e][i]),o=e);if(r<=this.eps)return[];if(o>i){for(s=0;s<l;s++)a=h[i][s],h[i][s]=h[o][s],h[o][s]=a;a=c[i],c[i]=c[o],c[o]=a}for(n=1/h[i][i],e=0;e<l;e++)h[e][i]*=n;for(h[i][i]=n,s=0;s<l;s++)if(s!==i){for(e=0;e<l;e++)e!==i&&(h[e][s]-=h[e][i]*h[i][s]);h[i][s]=-n*h[i][s]}}for(e=0;e<l;e++){for(s=0;s<l;s++)d[c[s]]=h[e][s];for(s=0;s<l;s++)h[e][s]=d[s]}return h},innerProduct:function(t,i,s){var n,r=0;for(void 0!==s&&e.isNumber(s)||(s=t.length),n=0;n<s;n++)r+=t[n]*i[n];return r},crossProduct:function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},factorial:i((function(t){return t<0?NaN:0===(t=Math.floor(t))||1===t?1:t*this.factorial(t-1)})),binomial:i((function(t,e){var i,s;if(e>t||e<0)return NaN;if(e=Math.round(e),t=Math.round(t),0===e||e===t)return 1;for(i=1,s=0;s<e;s++)i*=t-s,i/=s+1;return i})),cosh:function(t){return.5*(Math.exp(t)+Math.exp(-t))},sinh:function(t){return.5*(Math.exp(t)-Math.exp(-t))},pow:function(t,e){return 0===t?0===e?1:0:Math.floor(e)===e?Math.pow(t,e):t>0?Math.exp(e*Math.log(Math.abs(t))):NaN},log10:function(t){return Math.log(t)/Math.log(10)},log2:function(t){return Math.log(t)/Math.log(2)},log:function(t,i){return void 0!==i&&e.isNumber(i)?Math.log(t)/Math.log(i):Math.log(t)},sign:Math.sign||function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1},squampow:function(t,e){var i;if(Math.floor(e)===e){for(i=1,e<0&&(t=1/t,e*=-1);0!==e;)1&e&&(i*=t),e>>=1,t*=t;return i}return this.pow(t,e)},gcd:function(t,i){if(t=Math.abs(t),i=Math.abs(i),!e.isNumber(t)||!e.isNumber(i))return NaN;if(i>t){var s=t;t=i,i=s}for(;;){if(0==(t%=i))return i;if(0==(i%=t))return t}},lcm:function(t,i){var s;return e.isNumber(t)&&e.isNumber(i)?0!=(s=t*i)?s/this.gcd(t,i):0:NaN},normalize:function(t){var e,i,s=2*t[3],n=t[4]/s;return t[5]=n,t[6]=-t[1]/s,t[7]=-t[2]/s,isFinite(n)?Math.abs(n)>=1?(t[0]=(t[6]*t[6]+t[7]*t[7]-n*n)/(2*n),t[1]=-t[6]/n,t[2]=-t[7]/n,t[3]=1/(2*n),t[4]=1):(t[0]=(i=n<=0?-1:1)*(t[6]*t[6]+t[7]*t[7]-n*n)*.5,t[1]=-i*t[6],t[2]=-i*t[7],t[3]=i/2,t[4]=i*n):(e=Math.sqrt(t[1]*t[1]+t[2]*t[2]),t[0]/=e,t[1]/=e,t[2]/=e,t[3]=0,t[4]=1),t},toGL:function(t){var e,i,s;if(e="function"==typeof Float32Array?new Float32Array(16):new Array(16),4!==t.length&&4!==t[0].length)return e;for(i=0;i<4;i++)for(s=0;s<4;s++)e[i+4*s]=t[i][s];return e}},t.Math})),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],(function(t,e,i,s,n){"use strict";return t.Coords=function(t,e,n,r){this.board=n,this.usrCoords=[],this.scrCoords=[],this.emitter=!s.exists(r)||r,this.emitter&&i.eventify(this),this.setCoordinates(t,e,!0,!0)},t.extend(t.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>n.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(t){var e=Math.round,i=this.board,s=this.usrCoords,n=i.origin.scrCoords;!0===t?(this.scrCoords[0]=e(s[0]),this.scrCoords[1]=e(s[0]*n[1]+s[1]*i.unitX),this.scrCoords[2]=e(s[0]*n[2]-s[2]*i.unitY)):(this.scrCoords[0]=s[0],this.scrCoords[1]=s[0]*n[1]+s[1]*i.unitX,this.scrCoords[2]=s[0]*n[2]-s[2]*i.unitY)},screen2usr:function(){var t=this.board.origin.scrCoords,e=this.scrCoords,i=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(e[1]-t[1])/i.unitX,this.usrCoords[2]=(t[2]-e[2])/i.unitY},distance:function(t,i){var s,r,o=0,a=this.usrCoords,l=this.scrCoords;if(t===e.COORDS_BY_USER){if((o=(r=a[0]-(s=i.usrCoords)[0])*r)>n.eps*n.eps)return Number.POSITIVE_INFINITY;o+=(r=a[1]-s[1])*r,o+=(r=a[2]-s[2])*r}else o+=(r=l[1]-(s=i.scrCoords)[1])*r,o+=(r=l[2]-s[2])*r;return Math.sqrt(o)},setCoordinates:function(t,i,s,n){var r=this.usrCoords,o=this.scrCoords,a=[r[0],r[1],r[2]],l=[o[0],o[1],o[2]];return t===e.COORDS_BY_USER?(2===i.length?(r[0]=1,r[1]=i[0],r[2]=i[1]):(r[0]=i[0],r[1]=i[1],r[2]=i[2],this.normalizeUsrCoords()),this.usr2screen(s)):(2===i.length?(o[1]=i[0],o[2]=i[1]):(o[1]=i[1],o[2]=i[2]),this.screen2usr()),!this.emitter||n||l[1]===o[1]&&l[2]===o[2]||this.triggerEventHandlers(["update"],[a,l]),this},copy:function(t,e){return void 0===e&&(e=0),this[t].slice(e)},__evt__update:function(t,e){},__evt:function(){}}),t.Coords})),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],(function(t,e,i,s){"use strict";var n={each:function(t,i,s){var n,r,o=[];if(e.exists(t.length))for(r=t.length,n=0;n<r;n++)o.push(i.call(this,t[n],s));return o},coords:function(t,e){var n=t;return t&&t.elementClass===i.OBJECT_CLASS_POINT?n=t.coords:t.usrCoords&&t.scrCoords&&t.usr2screen&&(n=t),e&&(n=new s(i.COORDS_BY_USER,n.usrCoords,n.board)),n},coordsArray:function(t,i){var s;return(s=e.isArray(t)?t:this.coords(t).usrCoords).length<3&&s.unshift(1),i&&(s=[s[0],s[1],s[2]]),s}};return t.Expect=n,n})),define("math/qdt",["math/math","utils/type"],(function(t,e){"use strict";var i=function(t){this.capacity=10,this.points=[],this.xlb=t[0],this.xub=t[2],this.ylb=t[3],this.yub=t[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return e.extend(i.prototype,{contains:function(t,e){return this.xlb<t&&t<=this.xub&&this.ylb<e&&e<=this.yub},insert:function(t){return!!this.contains(t.usrCoords[1],t.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(t),!0):(null===this.northWest&&this.subdivide(),!!(this.northWest.insert(t)||this.northEast.insert(t)||this.southEast.insert(t)||this.southWest.insert(t))))},subdivide:function(){var t,e=this.points.length,s=this.xlb+(this.xub-this.xlb)/2,n=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new i([this.xlb,this.yub,s,n]),this.northEast=new i([s,this.yub,this.xub,n]),this.southEast=new i([this.xlb,n,s,this.ylb]),this.southWest=new i([s,n,this.xub,this.ylb]),t=0;t<e;t+=1)this.northWest.insert(this.points[t]),this.northEast.insert(this.points[t]),this.southEast.insert(this.points[t]),this.southWest.insert(this.points[t])},_query:function(t,e){var i;if(this.contains(t,e)){if(null===this.northWest)return this;if(i=this.northWest._query(t,e))return i;if(i=this.northEast._query(t,e))return i;if(i=this.southEast._query(t,e))return i;if(i=this.southWest._query(t,e))return i}return!1},query:function(t,i){var s,n;return e.exists(i)?(s=t,n=i):(s=t.usrCoords[1],n=t.usrCoords[2]),this._query(s,n)}}),t.Quadtree=i,i})),define("math/numerics",["jxg","utils/type","math/math"],(function(t,e,i){"use strict";var s={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return i.Numerics={Gauss:function(t,s){var n,r,o,a,l,h=i.eps,c=t.length>0?t[0].length:0;if(c!==s.length||c!==t.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(a=[],l=s.slice(0,c),n=0;n<c;n++)a[n]=t[n].slice(0,c);for(r=0;r<c;r++){for(n=c-1;n>r;n--)if(Math.abs(a[n][r])>h)if(Math.abs(a[r][r])<h)e.swap(a,n,r),e.swap(l,n,r);else for(a[n][r]/=a[r][r],l[n]-=a[n][r]*l[r],o=r+1;o<c;o++)a[n][o]-=a[n][r]*a[r][o];if(Math.abs(a[r][r])<h)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(a,l,!0),l},backwardSolve:function(t,e,i){var s,n,r,o;for(s=i?e:e.slice(0,e.length),n=t.length>0?t[0].length:0,r=t.length-1;r>=0;r--){for(o=n-1;o>r;o--)s[r]-=t[r][o]*s[o];s[r]/=t[r][r]}return s},gaussBareiss:function(t){var e,s,n,r,o,a,l,h,c,d=i.eps;if((l=t.length)<=0)return 0;for(t[0].length<l&&(l=t[0].length),h=[],r=0;r<l;r++)h[r]=t[r].slice(0,l);for(s=1,n=1,e=0;e<l-1;e++){if(a=h[e][e],Math.abs(a)<d){for(r=e+1;r<l&&!(Math.abs(h[r][e])>=d);r++);if(r===l)return 0;for(o=e;o<l;o++)c=h[r][o],h[r][o]=h[e][o],h[e][o]=c;n=-n,a=h[e][e]}for(r=e+1;r<l;r++)for(o=e+1;o<l;o++)h[r][o]=(c=a*h[r][o]-h[r][e]*h[e][o])/s;s=a}return n*h[l-1][l-1]},det:function(t){return 2===t.length&&2===t[0].length?t[0][0]*t[1][1]-t[1][0]*t[0][1]:this.gaussBareiss(t)},Jacobi:function(t){var e,s,n,r,o,a,l,h,c,d=i.eps,u=0,p=t.length,f=[[0,0,0],[0,0,0],[0,0,0]],m=[[0,0,0],[0,0,0],[0,0,0]],g=0;for(e=0;e<p;e++){for(s=0;s<p;s++)f[e][s]=0,m[e][s]=t[e][s],u+=Math.abs(m[e][s]);f[e][e]=1}if(1===p)return[m,f];if(u<=0)return[m,f];u/=p*p;do{for(h=0,c=0,s=1;s<p;s++)for(e=0;e<s;e++)if((r=Math.abs(m[e][s]))>c&&(c=r),h+=r,r>=d){for(r=.5*Math.atan2(2*m[e][s],m[e][e]-m[s][s]),o=Math.sin(r),a=Math.cos(r),n=0;n<p;n++)m[n][e]=a*(l=m[n][e])+o*m[n][s],m[n][s]=-o*l+a*m[n][s],f[n][e]=a*(l=f[n][e])+o*f[n][s],f[n][s]=-o*l+a*f[n][s];for(m[e][e]=a*m[e][e]+o*m[s][e],m[s][s]=-o*m[e][s]+a*m[s][s],m[e][s]=0,n=0;n<p;n++)m[e][n]=m[n][e],m[s][n]=m[n][s]}g+=1}while(Math.abs(h)/u>d&&g<2e3);return[m,f]},NewtonCotes:function(t,i,s){var n,r,o,a=0,l=s&&e.isNumber(s.number_of_nodes)?s.number_of_nodes:28,h={trapez:!0,simpson:!0,milne:!0},c=s&&s.integration_type&&h.hasOwnProperty(s.integration_type)&&h[s.integration_type]?s.integration_type:"milne",d=(t[1]-t[0])/l;switch(c){case"trapez":for(a=.5*(i(t[0])+i(t[1])),n=t[0],r=0;r<l-1;r++)a+=i(n+=d);a*=d;break;case"simpson":if(l%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(o=l/2,a=i(t[0])+i(t[1]),n=t[0],r=0;r<o-1;r++)a+=2*i(n+=2*d);for(n=t[0]-d,r=0;r<o;r++)a+=4*i(n+=2*d);a*=d/3;break;default:if(l%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(o=.25*l,a=7*(i(t[0])+i(t[1])),n=t[0],r=0;r<o-1;r++)a+=14*i(n+=4*d);for(n=t[0]-3*d,r=0;r<o;r++)a+=32*(i(n+=4*d)+i(n+2*d));for(n=t[0]-2*d,r=0;r<o;r++)a+=12*i(n+=4*d);a*=2*d/45}return a},Romberg:function(t,i,s){var n,r,o,a,l,h,c,d,u=[],p=0,f=1/0,m=s&&e.isNumber(s.max_iterations)?s.max_iterations:20,g=s&&e.isNumber(s.eps)?s.eps:s.eps||1e-7;for(l=1,u[0]=.5*(o=(r=t[1])-(n=t[0]))*(i(n)+i(r)),h=0;h<m;++h){for(a=0,o*=.5,l*=2,d=1,c=1;c<l;c+=2)a+=i(n+c*o);for(u[h+1]=.5*u[h]+a*o,p=u[h+1],c=h-1;c>=0;--c)u[c]=u[c+1]+(u[c+1]-u[c])/((d*=4)-1),p=u[c];if(Math.abs(p-f)<g*Math.abs(p))break;f=p}return p},GaussLegendre:function(t,i,s){var n,r,o,a,l,h,c,d,u=0,p=[],f=[],m=s&&e.isNumber(s.n)?s.n:12;if(m>18&&(m=18),p[2]=[.5773502691896257],f[2]=[1],p[4]=[.33998104358485626,.8611363115940526],f[4]=[.6521451548625461,.34785484513745385],p[6]=[.2386191860831969,.6612093864662645,.932469514203152],f[6]=[.46791393457269104,.3607615730481386,.17132449237917036],p[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],f[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],p[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],f[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],p[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],f[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],p[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],f[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],p[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],f[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],p[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],f[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],p[3]=[0,.7745966692414834],f[3]=[.8888888888888888,.5555555555555556],p[5]=[0,.5384693101056831,.906179845938664],f[5]=[.5688888888888889,.47862867049936647,.23692688505618908],p[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],f[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],p[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],f[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],p[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],f[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],p[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],f[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],p[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],f[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],p[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],f[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],a=m+1>>1,c=p[m],d=f[m],h=.5*((r=t[1])-(n=t[0])),l=.5*(r+n),!0&m)for(u=d[0]*i(l),o=1;o<a;++o)u+=d[o]*(i(l+h*c[o])+i(l-h*c[o]));else for(u=0,o=0;o<a;++o)u+=d[o]*(i(l+h*c[o])+i(l-h*c[o]));return h*u},_rescale_error:function(t,e,i){var s,n;return t=Math.abs(t),0!==i&&0!==t&&(t=(s=Math.pow(200*t/i,1.5))<1?i*s:i),e>20041683600089728e-310&&(n=11102230246251565e-30*e)>t&&(t=n),t},_gaussKronrod:function(t,e,i,s,n,r,o){var a,l,h,c,d,u,p,f,m,g,b,y=t[0],v=t[1],C=.5*(y+v),x=.5*(v-y),_=Math.abs(x),P=e(C),S=0,w=P*r[i-1],E=Math.abs(w),k=0,A=[],T=[];for(i%2==0&&(S=P*n[i/2-1]),a=Math.floor((i-1)/2),h=0;h<a;h++)f=(u=e(C-(d=x*s[c=2*h+1])))+(p=e(C+d)),A[c]=u,T[c]=p,S+=n[h]*f,w+=r[c]*f,E+=r[c]*(Math.abs(u)+Math.abs(p));for(a=Math.floor(i/2),h=0;h<a;h++)u=e(C-(d=x*s[m=2*h])),p=e(C+d),A[m]=u,T[m]=p,w+=r[m]*(u+p),E+=r[m]*(Math.abs(u)+Math.abs(p));for(g=.5*w,k=r[i-1]*Math.abs(P-g),h=0;h<i-1;h++)k+=r[h]*(Math.abs(A[h]-g)+Math.abs(T[h]-g));return b=(w-S)*x,l=w*=x,o.abserr=this._rescale_error(b,E*=_,k*=_),o.resabs=E,o.resasc=k,l},GaussKronrod15:function(t,e,i){return this._gaussKronrod(t,e,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],i)},GaussKronrod21:function(t,e,i){return this._gaussKronrod(t,e,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],i)},GaussKronrod31:function(t,e,i){return this._gaussKronrod(t,e,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],i)},_workspace:function(t,e){return{limit:e,size:0,nrmax:0,i:0,alist:[t[0]],blist:[t[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var t,e,i,s,n,r=this.size-1,o=this.limit,a=this.nrmax,l=this.order[a];if(r<2)return this.order[0]=0,this.order[1]=1,void(this.i=l);for(t=this.elist[l];a>0&&t>this.elist[this.order[a-1]];)this.order[a]=this.order[a-1],a--;for(n=r<o/2+2?r:o-r+1,i=a+1;i<n&&t<this.elist[this.order[i]];)this.order[i-1]=this.order[i],i++;for(this.order[i-1]=l,e=this.elist[r],s=n-1;s>i-2&&e>=this.elist[this.order[s]];)this.order[s+1]=this.order[s],s--;this.order[s+1]=r,this.i=l=this.order[a],this.nrmax=a},set_initial_result:function(t,e){this.size=1,this.rlist[0]=t,this.elist[0]=e},update:function(t,e,i,s,n,r,o,a){var l=this.i,h=this.size,c=this.level[this.i]+1;a>s?(this.alist[l]=n,this.rlist[l]=o,this.elist[l]=a,this.level[l]=c,this.alist[h]=t,this.blist[h]=e,this.rlist[h]=i,this.elist[h]=s,this.level[h]=c):(this.blist[l]=e,this.rlist[l]=i,this.elist[l]=s,this.level[l]=c,this.alist[h]=n,this.blist[h]=r,this.rlist[h]=o,this.elist[h]=a,this.level[h]=c),this.size++,c>this.maximum_level&&(this.maximum_level=c),this.qpsrt()},retrieve:function(){var t=this.i;return{a:this.alist[t],b:this.blist[t],r:this.rlist[t],e:this.elist[t]}},sum_results:function(){var t,e=this.size,i=0;for(t=0;t<e;t++)i+=this.rlist[t];return i},subinterval_too_small:function(t,e,i){var s=1.0000000000000222*(Math.abs(e)+22250738585072014e-321);return Math.abs(t)<=s&&Math.abs(i)<=s}}},Qag:function(s,n,r){var o,a,l,h,c,d,u,p,f,m,g,b,y,v,C,x,_,P=this._workspace(s,1e3),S=r&&e.isNumber(r.limit)?r.limit:15,w=r&&e.isNumber(r.epsrel)?r.epsrel:1e-7,E=r&&e.isNumber(r.epsabs)?r.epsabs:1e-7,k=r&&e.isFunction(r.q)?r.q:this.GaussKronrod15,A={},T=0,M=0,O=0,N=0,L=0,D=0,j=0,I=0,R=0,B=0;if(S>P.limit&&t.warn("iteration limit exceeds available workspace"),E<=0&&(w<50*i.eps||w<5e-29)&&t.warn("tolerance cannot be acheived with given epsabs and epsrel"),l=k.apply(this,[s,n,A]),c=A.resabs,d=A.resasc,P.set_initial_result(l,h=A.abserr),u=Math.max(E,w*Math.abs(l)),h<=11102230246251565e-30*c&&h>u)return t.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(h<=u&&h!==d||0===h)return l;if(1===S)return t.warn("a maximum of one iteration was insufficient"),-1/0;o=l,a=h,T=1;do{L=0,D=0,j=0,I=0,R=0,B=0,v=(_=P.retrieve()).r,C=_.e,m=f=.5*((b=_.a)+(y=_.b)),g=y,L=k.apply(this,[[p=b,f],n,A]),I=A.abserr,x=A.resasc,D=k.apply(this,[[m,g],n,A]),a+=(B=I+(R=A.abserr))-C,o+=(j=L+D)-v,x!==I&&A.resasc!==R&&(Math.abs(v-j)<=1e-5*Math.abs(j)&&B>=.99*C&&M++,T>=10&&B>C&&O++),a>(u=Math.max(E,w*Math.abs(o)))&&((M>=6||O>=20)&&(N=2),P.subinterval_too_small(p,m,g)&&(N=3)),P.update(p,f,L,I,m,g,D,R),b=(_=P.retrieve()).a_i,y=_.b_i,v=_.r_i,C=_.e_i,T++}while(T<S&&!N&&a>u);return P.sum_results()},I:function(t,e){return this.Qag(t,e,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(t,s,n){var r,o=0,a=i.eps,l=t.apply(n,[s]);for(e.isArray(s)&&(s=s[0]);o<50&&Math.abs(l)>a;)r=this.D(t,n)(s),Math.abs(r)>a?s-=l/r:s+=.2*Math.random()-1,l=t.apply(n,[s]),o+=1;return s},root:function(t,e,i){return this.fzero(t,e,i)},generalizedNewton:function(t,e,s,n){var r,o,a,l,h,c,d,u,p,f,m,g,b,y,v=0;for(this.generalizedNewton.t1memo?(r=this.generalizedNewton.t1memo,o=this.generalizedNewton.t2memo):(r=s,o=n),f=(u=t.X(r)-e.X(o))*u+(p=t.Y(r)-e.Y(o))*p,m=this.D(t.X,t),g=this.D(e.X,e),b=this.D(t.Y,t),y=this.D(e.Y,e);f>i.eps&&v<10;)a=m(r),l=-g(o),o-=(a*p-(h=b(r))*u)/(d=a*(c=-y(o))-l*h),f=(u=t.X(r-=(c*u-l*p)/d)-e.X(o))*u+(p=t.Y(r)-e.Y(o))*p,v+=1;return this.generalizedNewton.t1memo=r,this.generalizedNewton.t2memo=o,Math.abs(r)<Math.abs(o)?[t.X(r),t.Y(r)]:[e.X(o),e.Y(o)]},Neville:function(t){var e=[],s=function(s){return function(n,r){var o,a,l,h=i.binomial,c=t.length,d=c-1,u=0,p=0;if(!r)for(l=1,o=0;o<c;o++)e[o]=h(d,o)*l,l*=-1;for(a=n,o=0;o<c;o++){if(0===a)return t[o][s]();l=e[o]/a,a-=1,u+=t[o][s]()*l,p+=l}return u/p}};return[s("X"),s("Y"),0,function(){return t.length-1}]},splineDef:function(t,e){var i,s,n=Math.min(t.length,e.length),r=[],o=[],a=[],l=[],h=[],c=[];if(2===n)return[0,0];for(i=0;i<n;i++)a.push({X:t[i],Y:e[i]});for(a.sort((function(t,e){return t.X-e.X})),i=0;i<n;i++)t[i]=a[i].X,e[i]=a[i].Y;for(i=0;i<n-1;i++)l.push(t[i+1]-t[i]);for(i=0;i<n-2;i++)h.push(6*(e[i+2]-e[i+1])/l[i+1]-6*(e[i+1]-e[i])/l[i]);for(r.push(2*(l[0]+l[1])),o.push(h[0]),i=0;i<n-3;i++)r.push(2*(l[i+1]+l[i+2])-(s=l[i+1]/r[i])*l[i+1]),o.push(h[i+1]-s*o[i]);for(c[n-3]=o[n-3]/r[n-3],i=n-4;i>=0;i--)c[i]=(o[i]-l[i+1]*c[i+1])/r[i];for(i=n-3;i>=0;i--)c[i+1]=c[i];return c[0]=0,c[n-1]=0,c},splineEval:function(t,i,s,n){var r,o,a,l=Math.min(i.length,s.length),h=1,c=!1,d=[];for(e.isArray(t)?(h=t.length,c=!0):t=[t],r=0;r<h;r++){if(t[r]<i[0]||i[r]>i[l-1])return NaN;for(o=1;o<l&&!(t[r]<=i[o]);o++);d.push(s[o-=1]+((s[o+1]-s[o])/(i[o+1]-i[o])-(i[o+1]-i[o])/6*(n[o+1]+2*n[o])+(n[o]/2+(n[o+1]-n[o])/(6*(i[o+1]-i[o]))*(a=t[r]-i[o]))*a)*a)}return c?d:d[0]},generatePolynomialTerm:function(t,e,i,s){var n,r=[];for(n=e;n>=0;n--)r=r.concat(["(",t[n].toPrecision(s),")"]),n>1?r=r.concat(["*",i,"<sup>",n,"<","/sup> + "]):1===n&&(r=r.concat(["*",i," + "]));return r.join("")},lagrangePolynomial:function(t){var e=[],i=function(i,s){var n,r,o,a,l=t.length,h=0,c=0;if(!s)for(n=0;n<l;n++){for(e[n]=1,o=t[n].X(),r=0;r<l;r++)r!==n&&(e[n]*=o-t[r].X());e[n]=1/e[n]}for(n=0;n<l;n++){if(i===(o=t[n].X()))return t[n].Y();c+=a=e[n]/(i-o),h+=a*t[n].Y()}return h/c};return i.getTerm=function(){return""},i},_initCubicPoly:function(t,e,i,s){return[t,i,-3*t+3*e-2*i-s,2*t-2*e+i+s]},CardinalSpline:function(t,s,n){var r,o,a,l,h=[],c=this;return l=e.isFunction(s)?s:function(){return s},void 0===n&&(n="uniform"),[(o=function(e){return function(s,o){var d,u,p,f,m,g,b,y,v;if(t.length<2)return NaN;if(!o)for(a=l(),p={X:function(){return 2*t[t.length-1].X()-t[t.length-2].X()},Y:function(){return 2*t[t.length-1].Y()-t[t.length-2].Y()},Dist:function(t){var e=this.X()-t.X(),i=this.Y()-t.Y();return Math.sqrt(e*e+i*i)}},v=(r=[{X:function(){return 2*t[0].X()-t[1].X()},Y:function(){return 2*t[0].Y()-t[1].Y()},Dist:function(t){var e=this.X()-t.X(),i=this.Y()-t.Y();return Math.sqrt(e*e+i*i)}}].concat(t,[p])).length,h[e]=[],d=0;d<v-3;d++)"centripetal"===n?(g=r[d].Dist(r[d+1]),b=r[d+2].Dist(r[d+1]),y=r[d+3].Dist(r[d+2]),g=Math.sqrt(g),b=Math.sqrt(b),y=Math.sqrt(y),b<i.eps&&(b=1),g<i.eps&&(g=b),y<i.eps&&(y=b),f=(r[d+1][e]()-r[d][e]())/g-(r[d+2][e]()-r[d][e]())/(b+g)+(r[d+2][e]()-r[d+1][e]())/b,m=(r[d+2][e]()-r[d+1][e]())/b-(r[d+3][e]()-r[d+1][e]())/(y+b)+(r[d+3][e]()-r[d+2][e]())/y,f*=b,m*=b,h[e][d]=c._initCubicPoly(r[d+1][e](),r[d+2][e](),a*f,a*m)):h[e][d]=c._initCubicPoly(r[d+1][e](),r[d+2][e](),a*(r[d+2][e]()-r[d][e]()),a*(r[d+3][e]()-r[d+1][e]()));return isNaN(s)?NaN:(v=t.length,s<=0?t[0][e]():s>=v?t[v-1][e]():(d=Math.floor(s))===s?t[d][e]():(s-=d,void 0===(u=h[e][d])?NaN:((u[3]*s+u[2])*s+u[1])*s+u[0]))}})("X"),o("Y"),0,function(){return t.length-1}]},CatmullRomSpline:function(t,e){return this.CardinalSpline(t,.5,e)},regressionPolynomial:function(t,s,n){var r,o,a,l,h,c,d="";if(e.isPoint(t)&&e.isFunction(t.Value))o=function(){return t.Value()};else if(e.isFunction(t))o=t;else{if(!e.isNumber(t))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof t+"'.");o=function(){return t}}if(3===arguments.length&&e.isArray(s)&&e.isArray(n))h=0;else if(2===arguments.length&&e.isArray(s)&&s.length>0&&e.isPoint(s[0]))h=1;else{if(!(2===arguments.length&&e.isArray(s)&&s.length>0&&s[0].usrCoords&&s[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");h=2}return(c=function(t,c){var u,p,f,m,g,b,y,v,C,x=s.length;if(C=Math.floor(o()),!c){if(1===h)for(a=[],l=[],u=0;u<x;u++)a[u]=s[u].X(),l[u]=s[u].Y();if(2===h)for(a=[],l=[],u=0;u<x;u++)a[u]=s[u].usrCoords[1],l[u]=s[u].usrCoords[2];if(0===h)for(a=[],l=[],u=0;u<x;u++)e.isFunction(s[u])?a.push(s[u]()):a.push(s[u]),e.isFunction(n[u])?l.push(n[u]()):l.push(n[u]);for(f=[],p=0;p<x;p++)f.push([1]);for(u=1;u<=C;u++)for(p=0;p<x;p++)f[p][u]=f[p][u-1]*a[p];g=l,m=i.transpose(f),b=i.matMatMult(m,f),y=i.matVecMult(m,g),r=i.Numerics.Gauss(b,y),d=i.Numerics.generatePolynomialTerm(r,C,"x",3)}for(v=r[C],u=C-1;u>=0;u--)v=v*t+r[u];return v}).getTerm=function(){return d},c},bezier:function(t){var e,i,s=function(s){return function(n,r){var o=3*Math.floor(n),a=n%1,l=1-a;return r||(i=3*Math.floor((t.length-1)/3),e=Math.floor(i/3)),n<0?t[0][s]():n>=e?t[i][s]():isNaN(n)?NaN:l*l*(l*t[o][s]()+3*a*t[o+1][s]())+(3*l*t[o+2][s]()+a*t[o+3][s]())*a*a}};return[s("X"),s("Y"),0,function(){return Math.floor(t.length/3)}]},bspline:function(t,e){var i,s=[],n=function(n){return function(r,o){var a,l,h,c=t.length,d=c-1,u=e;if(d<=0)return NaN;if(d+2<=u&&(u=d+1),r<=0)return t[0][n]();if(r>=d-u+2)return t[d][n]();for(h=Math.floor(r)+u-1,i=function(t,e){var i,s=[];for(i=0;i<t+e+1;i++)s[i]=i<e?0:i<=t?i-e+1:t-e+2;return s}(d,u),s=function(t,e,i,s,n){var r,o,a,l,h=[];for(h[n]=e[n]<=t&&t<e[n+1]?1:0,r=2;r<=s;r++)for(o=n-r+1;o<=n;o++)a=o>=n?0:h[o+1],h[o]=0==(l=e[o+r-1]-e[o])?0:(t-e[o])/l*(o<=n-r+1||o<0?0:h[o]),0!=(l=e[o+r]-e[o+1])&&(h[o]+=(e[o+r]-t)/l*a);return h}(r,i,0,u,h),a=0,l=h-u+1;l<=h;l++)l<c&&l>=0&&(a+=t[l][n]()*s[l]);return a}};return[n("X"),n("Y"),0,function(){return t.length-1}]},D:function(t,i){return e.exists(i)?function(e,s){return(t.apply(i,[e+1e-5,s])-t.apply(i,[e-1e-5,s]))/2e-5}:function(e,i){return(t(e+1e-5,i)-t(e-1e-5,i))/2e-5}},_riemannValue:function(t,e,i,s){var n,r,o,a;if(s<0&&("trapezoidal"!==i&&(t+=s),s*=-1,"lower"===i?i="upper":"upper"===i&&(i="lower")),a=.01*s,"right"===i)n=e(t+s);else if("middle"===i)n=e(t+.5*s);else if("left"===i||"trapezoidal"===i)n=e(t);else if("lower"===i){for(n=e(t),o=t+a;o<=t+s;o+=a)(r=e(o))<n&&(n=r);(r=e(t+s))<n&&(n=r)}else if("upper"===i){for(n=e(t),o=t+a;o<=t+s;o+=a)(r=e(o))>n&&(n=r);(r=e(t+s))>n&&(n=r)}else n="random"===i?e(t+s*Math.random()):"simpson"===i?(e(t)+4*e(t+.5*s)+e(t+s))/6:e(t);return n},riemann:function(t,i,s,n,r){var o,a,l,h,c,d,u,p=[],f=[],m=0,g=n,b=0;if(e.isArray(t)?(c=t[0],h=t[1]):h=t,(i=Math.floor(i))<=0)return[p,f,b];for(a=(r-n)/i,o=0;o<i;o++)l=this._riemannValue(g,h,s,a),p[m]=g,f[m]=l,m+=1,g+=a,"trapezoidal"===s&&(l=h(g)),p[m]=g,f[m]=l,m+=1;for(o=0;o<i;o++)l=c?this._riemannValue(g,c,s,-a):0,p[m]=g,f[m]=l,m+=1,g-=a,"trapezoidal"===s&&c&&(l=c(g)),p[m]=g,f[m]=l,"trapezoidal"!==s?(d=l,u=f[2*(i-1)-2*o]):(u=.5*(h(g+a)+h(g)),d=c?.5*(c(g+a)+c(g)):0),b+=(u-d)*a,p[m+=1]=g,f[m]=f[2*(i-1)-2*o],m+=1;return[p,f,b]},riemannsum:function(e,i,s,n,r){return t.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(e,i,s,n,r)[2]},rungeKutta:function(t,i,n,r,o){var a,l,h,c,d,u,p=[],f=[],m=(n[1]-n[0])/r,g=n[0],b=i.length,y=[],v=0;for(e.isString(t)&&(t=s[t]||s.euler),u=t.s,a=0;a<b;a++)p[a]=i[a];for(l=0;l<r;l++){for(y[v]=[],a=0;a<b;a++)y[v][a]=p[a];for(v+=1,c=[],h=0;h<u;h++){for(a=0;a<b;a++)f[a]=0;for(d=0;d<h;d++)for(a=0;a<b;a++)f[a]+=t.A[h][d]*m*c[d][a];for(a=0;a<b;a++)f[a]+=p[a];c.push(o(g+t.c[h]*m,f))}for(a=0;a<b;a++)f[a]=0;for(d=0;d<u;d++)for(a=0;a<b;a++)f[a]+=t.b[d]*c[d][a];for(a=0;a<b;a++)p[a]=p[a]+m*f[a];g+=m}return y},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(t,s,n){var r,o,a,l,h,c,d,u,p,f,m,g,b,y,v,C,x,_,P,S,w=i.eps,E=this.maxIterationsRoot,k=0;if(e.isArray(s)){if(s.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");l=t.call(n,r=s[0]),h=t.call(n,o=s[1])}else{for(l=t.call(n,r=s),f=(u=[.9*(d=0===r?1:r),1.1*d,d-1,d+1,.5*d,1.5*d,-d,2*d,-10*d,10*d]).length,p=0;p<f&&!(l*(h=t.call(n,o=u[p]))<=0);p++);o<r&&(m=r,r=o,o=m,g=l,l=h,h=g)}if(l*h>0)return e.isArray(s)?this.fminbr(t,[r,o],n):this.Newton(t,r,n);for(a=r,c=l;k<E;){if(b=o-r,Math.abs(c)<Math.abs(h)&&(r=o,o=a,a=r,l=h,h=c,c=l),x=2*w*Math.abs(o)+.5*w,S=.5*(a-o),Math.abs(S)<=x&&Math.abs(h)<=w)return o;Math.abs(b)>=x&&Math.abs(l)>Math.abs(h)&&(v=a-o,r===a?(_=v*(y=h/l),P=1-y):(_=(C=h/l)*(v*(P=l/c)*(P-(y=h/c))-(o-r)*(y-1)),P=(P-1)*(y-1)*(C-1)),_>0?P=-P:_=-_,_<.75*v*P-.5*Math.abs(x*P)&&_<Math.abs(b*P*.5)&&(S=_/P)),Math.abs(S)<x&&(S=S>0?x:-x),r=o,l=h,((h=t.call(n,o+=S))>0&&c>0||h<0&&c<0)&&(a=r,c=l),k++}return o},fminbr:function(t,s,n){var r,o,a,l,h,c,d,u,p,f,m,g,b,y,v,C,x=.5*(3-Math.sqrt(5)),_=i.eps,P=i.eps,S=this.maxIterationsMinimize,w=0;if(!e.isArray(s)||s.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(a=l=(r=s[0])+x*((o=s[1])-r),h=l,c=d=t.call(n,l),u=d;w<S;){if(p=o-r,f=.5*(r+o),m=P*Math.abs(a)+_/3,Math.abs(a-f)+.5*p<=2*m)return a;g=x*(a<f?o-a:r-a),Math.abs(a-h)>=m&&(b=(a-l)*(y=(a-l)*(c-u))-(a-h)*(v=(a-h)*(c-d)),(y=2*(y-v))>0?b=-b:y=-y,Math.abs(b)<Math.abs(g*y)&&b>y*(r-a+2*m)&&b<y*(o-a-2*m)&&(g=b/y)),Math.abs(g)<m&&(g=g>0?m:-m),(C=t.call(n,v=a+g))<=c?(v<a?o=a:r=a,l=h,h=a,a=v,d=u,u=c,c=C):(v<a?r=v:o=v,C<=u||h===a?(l=h,h=v,d=u,u=C):(C<=d||l===a||l===h)&&(l=v,d=C)),w+=1}return a},RamerDouglasPeucker:function(t,e){var s,n,r,o=[],a=function(t,e,s){var n,r,o,a,l,h,c,d,u,p,f,m=0,g=e;if(s-e<2)return[-1,0];if(o=t[e].scrCoords,a=t[s].scrCoords,isNaN(o[1]+o[2]))return[NaN,e];if(isNaN(a[1]+a[2]))return[NaN,s];for(r=e+1;r<s;r++){if(l=t[r].scrCoords,isNaN(l[1]+l[2]))return[NaN,r];h=l[1]-o[1],c=l[2]-o[2],(p=(d=a[1]-o[1])*d+(u=a[2]-o[2])*u)>=i.eps?((f=(h*d+c*u)/p)<0?f=0:f>1&&(f=1),n=(h-=f*d)*h+(c-=f*u)*c):(f=0,n=h*h+c*c),n>m&&(m=n,g=r)}return[Math.sqrt(m),g]},l=function(t,e,i,s,n){var r=a(t,e,i),o=r[1];if(isNaN(r[0])){l(t,e,o-1,s,n),n.push(t[o]);do{++o}while(o<=i&&isNaN(t[o].scrCoords[1]+t[o].scrCoords[2]));o<=i&&n.push(t[o]),l(t,o+1,i,s,n)}else r[0]>s?(l(t,e,o,s,n),l(t,o,i,s,n)):n.push(t[i])};for(r=t.length,s=0;s<r&&isNaN(t[s].scrCoords[1]+t[s].scrCoords[2]);)s+=1;for(n=r-1;n>s&&isNaN(t[n].scrCoords[1]+t[n].scrCoords[2]);)n-=1;return s>n||s===r||(o[0]=t[s],l(t,s,n,e,o)),o},RamerDouglasPeuker:function(e,i){return t.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(e,i)},Visvalingam:function(e,i){var s,n,r,o,a,l,h,c,d,u=[],p=[],f=[];if((n=e.length)<=2)return e;for(u[0]={used:!0,lft:null,node:null},a=0,s=1;s<n-1;s++)r=Math.abs(t.Math.Numerics.det([e[s-1].usrCoords,e[s].usrCoords,e[s+1].usrCoords])),isNaN(r)||(p.push(d={v:r,idx:s}),u[s]={used:!0,lft:a,node:d},u[a].rt=s,a=s);for(u[n-1]={used:!0,rt:null,lft:a,node:null},u[a].rt=n-1,o=-1/0;p.length>i;)p.sort((function(t,e){return e.v-t.v})),u[s=p.pop().idx].used=!1,o=u[s].node.v,u[a=u[s].lft].rt=l=u[s].rt,u[l].lft=a,null!==(h=u[a].lft)&&(r=Math.abs(t.Math.Numerics.det([e[h].usrCoords,e[a].usrCoords,e[l].usrCoords])),u[a].node.v=r>=o?r:o),null!==(c=u[l].rt)&&(r=Math.abs(t.Math.Numerics.det([e[a].usrCoords,e[l].usrCoords,e[c].usrCoords])),u[l].node.v=r>=o?r:o);f=[e[s=0]];do{f.push(e[s=u[s].rt])}while(null!==u[s].rt);return f}},i.Numerics})),define("math/statistics",["jxg","math/math","utils/type"],(function(t,e,i){"use strict";return e.Statistics={sum:function(t){var e,i=t.length,s=0;for(e=0;e<i;e++)s+=t[e];return s},prod:function(t){var e,i=t.length,s=1;for(e=0;e<i;e++)s*=t[e];return s},mean:function(t){return t.length>0?this.sum(t)/t.length:0},median:function(t){var e,i;return t.length>0?((e=t.slice(0)).sort((function(t,e){return t-e})),(i=e.length)%2==1?e[parseInt(.5*i,10)]:.5*(e[.5*i-1]+e[.5*i])):0},variance:function(t){var e,i,s,n=t.length;if(n>1){for(e=this.mean(t),i=0,s=0;s<n;s++)i+=(t[s]-e)*(t[s]-e);return i/(t.length-1)}return 0},sd:function(t){return Math.sqrt(this.variance(t))},weightedMean:function(t,e){if(t.length!==e.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return t.length>0?this.mean(this.multiply(t,e)):0},max:function(t){return Math.max.apply(this,t)},min:function(t){return Math.min.apply(this,t)},range:function(t){return[this.min(t),this.max(t)]},abs:function(t){var e,s,n;if(i.isArray(t))for(s=t.length,n=[],e=0;e<s;e++)n[e]=Math.abs(t[e]);else n=Math.abs(t);return n},add:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]+e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t+e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]+e[s];else r=t+e;return r},div:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]/e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t/e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]/e[s];else r=t/e;return r},divide:function(){t.deprecated("Statistics.divide()","Statistics.div()"),e.Statistics.div.apply(e.Statistics,arguments)},mod:function(t,s,n){var r,o,a=[],l=function(t,e){return t%e};if((n=i.def(n,!1))&&(l=e.mod),t=i.evalSlider(t),s=i.evalSlider(s),i.isArray(t)&&i.isNumber(s))for(o=t.length,r=0;r<o;r++)a[r]=l(t[r],s);else if(i.isNumber(t)&&i.isArray(s))for(o=s.length,r=0;r<o;r++)a[r]=l(t,s[r]);else if(i.isArray(t)&&i.isArray(s))for(o=Math.min(t.length,s.length),r=0;r<o;r++)a[r]=l(t[r],s[r]);else a=l(t,s);return a},multiply:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]*e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t*e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]*e[s];else r=t*e;return r},subtract:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]-e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t-e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]-e[s];else r=t-e;return r},TheilSenRegression:function(t){var i,s,n=[],r=[],o=[];for(i=0;i<t.length;i++){for(r.length=0,s=0;s<t.length;s++)Math.abs(t[s].usrCoords[1]-t[i].usrCoords[1])>e.eps&&(r[s]=(t[s].usrCoords[2]-t[i].usrCoords[2])/(t[s].usrCoords[1]-t[i].usrCoords[1]));n[i]=this.median(r),o.push(t[i].usrCoords[2]-n[i]*t[i].usrCoords[1])}return[this.median(o),this.median(n),-1]}},e.Statistics})),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],(function(t,e,i,s,n,r,o){"use strict";return s.Geometry={},t.extend(s.Geometry,{angle:function(e,i,s){var n,r,o,a,l=[],h=[],c=[];return t.deprecated("Geometry.angle()","Geometry.rad()"),e.coords?(l[0]=e.coords.usrCoords[1],l[1]=e.coords.usrCoords[2]):(l[0]=e[0],l[1]=e[1]),i.coords?(h[0]=i.coords.usrCoords[1],h[1]=i.coords.usrCoords[2]):(h[0]=i[0],h[1]=i[1]),s.coords?(c[0]=s.coords.usrCoords[1],c[1]=s.coords.usrCoords[2]):(c[0]=s[0],c[1]=s[1]),n=l[0]-h[0],r=l[1]-h[1],o=c[0]-h[0],a=c[1]-h[1],Math.atan2(n*a-r*o,n*o+r*a)},trueAngle:function(t,e,i){return 57.29577951308232*this.rad(t,e,i)},rad:function(t,e,i){var s,n,r,o,a,l,h;return t.coords?(s=t.coords.usrCoords[1],n=t.coords.usrCoords[2]):(s=t[0],n=t[1]),e.coords?(r=e.coords.usrCoords[1],o=e.coords.usrCoords[2]):(r=e[0],o=e[1]),i.coords?(a=i.coords.usrCoords[1],l=i.coords.usrCoords[2]):(a=i[0],l=i[1]),(h=Math.atan2(l-o,a-r)-Math.atan2(n-o,s-r))<0&&(h+=6.283185307179586),h},angleBisector:function(t,s,n,o){var a,l,h,c,d,u=t.coords.usrCoords,p=s.coords.usrCoords,f=n.coords.usrCoords;return r.exists(o)||(o=t.board),0===p[0]?new i(e.COORDS_BY_USER,[1,.5*(u[1]+f[1]),.5*(u[2]+f[2])],o):(c=u[1]-p[1],d=u[2]-p[2],a=Math.atan2(d,c),c=f[1]-p[1],d=f[2]-p[2],h=.5*(a+(l=Math.atan2(d,c))),a>l&&(h+=Math.PI),c=Math.cos(h)+p[1],d=Math.sin(h)+p[2],new i(e.COORDS_BY_USER,[1,c,d],o))},reflection:function(t,s,n){var o,a,l,h=s.coords.usrCoords,c=t.point1.coords.usrCoords,d=t.point2.coords.usrCoords;return r.exists(n)||(n=s.board),new i(e.COORDS_BY_USER,[h[1]+2*(l=((o=d[1]-c[1])*(h[2]-c[2])-(a=d[2]-c[2])*(h[1]-c[1]))/(o*o+a*a))*a,h[2]-2*l*o],n)},rotation:function(t,s,n,o){var a,l,h,c,d=s.coords.usrCoords,u=t.coords.usrCoords;return r.exists(o)||(o=s.board),a=d[1]-u[1],l=d[2]-u[2],h=Math.cos(n),c=Math.sin(n),new i(e.COORDS_BY_USER,[a*h-l*c+u[1],a*c+l*h+u[2]],o)},perpendicular:function(t,n,o){var a,l,h,c,d,u=t.point1.coords.usrCoords,p=t.point2.coords.usrCoords,f=n.coords.usrCoords;return r.exists(o)||(o=n.board),n===t.point1?(a=u[1]+p[2]-u[2],l=u[2]-p[1]+u[1],d=u[0]*p[0],Math.abs(d)<s.eps&&(a=p[2],l=-p[1]),c=[d,a,l],h=!0):n===t.point2?(a=p[1]+u[2]-p[2],l=p[2]-u[1]+p[1],d=u[0]*p[0],Math.abs(d)<s.eps&&(a=u[2],l=-u[1]),c=[d,a,l],h=!1):Math.abs(s.innerProduct(f,t.stdform,3))<s.eps?(a=f[1]+p[2]-f[2],l=f[2]-p[1]+f[1],d=p[0],Math.abs(d)<s.eps&&(a=p[2],l=-p[1]),h=!0,Math.abs(d)>s.eps&&Math.abs(a-f[1])<s.eps&&Math.abs(l-f[2])<s.eps&&(a=f[1]+u[2]-f[2],l=f[2]-u[1]+f[1],h=!1),c=[d,a,l]):(c=s.crossProduct(c=[0,t.stdform[1],t.stdform[2]],f),c=s.crossProduct(c,t.stdform),h=!0),[new i(e.COORDS_BY_USER,c,o),h]},circumcenterMidpoint:function(){t.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(t,n,o,a){var l,h,c=t.coords.usrCoords,d=n.coords.usrCoords,u=o.coords.usrCoords;return r.exists(a)||(a=t.board),l=s.crossProduct([d[0]-c[0],-d[2]+c[2],d[1]-c[1]],[.5*(c[0]+d[0]),.5*(c[1]+d[1]),.5*(c[2]+d[2])]),h=s.crossProduct([u[0]-d[0],-u[2]+d[2],u[1]-d[1]],[.5*(d[0]+u[0]),.5*(d[1]+u[1]),.5*(d[2]+u[2])]),new i(e.COORDS_BY_USER,s.crossProduct(l,h),a)},distance:function(t,e,i){var s,n=0;for(i||(i=Math.min(t.length,e.length)),s=0;s<i;s++)n+=(t[s]-e[s])*(t[s]-e[s]);return Math.sqrt(n)},affineDistance:function(t,e,i){var n;return(n=this.distance(t,e,i))>s.eps&&(Math.abs(t[0])<s.eps||Math.abs(e[0])<s.eps)?1/0:n},sortVertices:function(t){var e,i,n=o.each(t,o.coordsArray),a=n.length;for(e=1;e<a;e++)(n[e][2]<n[0][2]||Math.abs(n[e][2]-n[0][2])<s.eps&&n[e][1]<n[0][1])&&(n=r.swap(n,e,0));return i=n.shift(),n.sort((function(t,e){return Math.atan2(t[2]-i[2],t[1]-i[1])-Math.atan2(e[2]-i[2],e[1]-i[1])})),n.unshift(i),n.unshift(n[n.length-1]),n},signedTriangle:function(t,e,i){var s=o.coordsArray(t),n=o.coordsArray(e),r=o.coordsArray(i);return.5*((n[1]-s[1])*(r[2]-s[2])-(n[2]-s[2])*(r[1]-s[1]))},signedPolygon:function(t,e){var i,s,n=0,r=o.each(t,o.coordsArray);for(void 0===e&&(e=!0),e?r.unshift(r[r.length-1]):r=this.sortVertices(r),s=r.length,i=1;i<s;i++)n+=r[i-1][1]*r[i][2]-r[i][1]*r[i-1][2];return.5*n},GrahamScan:function(t){var e,i,s=1,n=o.each(t,o.coordsArray);for(i=(n=this.sortVertices(n)).length,e=2;e<i;e++){for(;this.signedTriangle(n[s-1],n[s],n[e])<=0;)if(s>1)s-=1;else{if(e===i-1)break;e+=1}n=r.swap(n,s+=1,e)}return n.slice(0,s)},calcStraight:function(t,i,n,o){var a,l,h,c,d,u,p,f,m,g;if(r.exists(o)||(o=10),u=r.evaluate(t.visProp.straightfirst),p=r.evaluate(t.visProp.straightlast),Math.abs(i.scrCoords[0])<s.eps&&(u=!0),Math.abs(n.scrCoords[0])<s.eps&&(p=!0),(u||p)&&((f=[])[0]=t.stdform[0]-t.stdform[1]*t.board.origin.scrCoords[1]/t.board.unitX+t.stdform[2]*t.board.origin.scrCoords[2]/t.board.unitY,f[1]=t.stdform[1]/t.board.unitX,f[2]=-t.stdform[2]/t.board.unitY,!isNaN(f[0]+f[1]+f[2]))){if(a=!u&&Math.abs(i.usrCoords[0])>=s.eps&&i.scrCoords[1]>=0&&i.scrCoords[1]<=t.board.canvasWidth&&i.scrCoords[2]>=0&&i.scrCoords[2]<=t.board.canvasHeight,l=!p&&Math.abs(n.usrCoords[0])>=s.eps&&n.scrCoords[1]>=0&&n.scrCoords[1]<=t.board.canvasWidth&&n.scrCoords[2]>=0&&n.scrCoords[2]<=t.board.canvasHeight,c=(h=this.meetLineBoard(f,t.board,o))[0],d=h[1],!a&&!l){if(!u&&p&&!this.isSameDirection(i,n,c)&&!this.isSameDirection(i,n,d))return;if(u&&!p&&!this.isSameDirection(n,i,c)&&!this.isSameDirection(n,i,d))return}a?l||(g=this.isSameDir(i,n,c,d)?d:c):l?m=this.isSameDir(i,n,c,d)?c:d:this.isSameDir(i,n,c,d)?(m=c,g=d):(g=c,m=d),m&&i.setCoordinates(e.COORDS_BY_USER,m.usrCoords),g&&n.setCoordinates(e.COORDS_BY_USER,g.usrCoords)}},calcLineDelimitingPoints:function(t,i,n){var o,a,l,h,c,d,u,p,f,m=!1,g=!1;if(c=r.evaluate(t.visProp.straightfirst),d=r.evaluate(t.visProp.straightlast),Math.abs(i.scrCoords[0])<s.eps&&(c=!0),Math.abs(n.scrCoords[0])<s.eps&&(d=!0),(u=[])[0]=t.stdform[0]-t.stdform[1]*t.board.origin.scrCoords[1]/t.board.unitX+t.stdform[2]*t.board.origin.scrCoords[2]/t.board.unitY,u[1]=t.stdform[1]/t.board.unitX,u[2]=-t.stdform[2]/t.board.unitY,!isNaN(u[0]+u[1]+u[2])){if(m=!c,g=!d,a=t.board.getBoundingBox(),t.getSlope()>=0?(l=this.projectPointToLine({coords:{usrCoords:[1,a[2],a[1]]}},t,t.board),h=this.projectPointToLine({coords:{usrCoords:[1,a[0],a[3]]}},t,t.board)):(l=this.projectPointToLine({coords:{usrCoords:[1,a[0],a[1]]}},t,t.board),h=this.projectPointToLine({coords:{usrCoords:[1,a[2],a[3]]}},t,t.board)),!m&&!g){if(!c&&!d){if(o=i.distance(e.COORDS_BY_USER,n),Math.abs(i.distance(e.COORDS_BY_USER,l)+l.distance(e.COORDS_BY_USER,n)-o)>s.eps)return;if(Math.abs(i.distance(e.COORDS_BY_USER,h)+h.distance(e.COORDS_BY_USER,n)-o)>s.eps)return}if(!c&&d&&!this.isSameDirection(i,n,l)&&!this.isSameDirection(i,n,h))return;if(c&&!d&&!this.isSameDirection(n,i,l)&&!this.isSameDirection(n,i,h))return}m?g||(f=this.isSameDir(i,n,l,h)?h:l):g?p=this.isSameDir(i,n,l,h)?l:h:this.isSameDir(i,n,l,h)?(p=l,f=h):(f=l,p=h),p&&i.setCoordinates(e.COORDS_BY_USER,p.usrCoords),f&&n.setCoordinates(e.COORDS_BY_USER,f.usrCoords)}},calcLabelQuadrant:function(t){return t<0&&(t+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((t+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(t,e,i,n){var r=e.usrCoords[1]-t.usrCoords[1],o=e.usrCoords[2]-t.usrCoords[2],a=n.usrCoords[1]-i.usrCoords[1],l=n.usrCoords[2]-i.usrCoords[2];return Math.abs(e.usrCoords[0])<s.eps&&(r=e.usrCoords[1],o=e.usrCoords[2]),Math.abs(t.usrCoords[0])<s.eps&&(r=-t.usrCoords[1],o=-t.usrCoords[2]),r*a+o*l>=0},isSameDirection:function(t,e,i){var n,r,o,a,l=!1;return n=e.usrCoords[1]-t.usrCoords[1],r=e.usrCoords[2]-t.usrCoords[2],o=i.usrCoords[1]-t.usrCoords[1],a=i.usrCoords[2]-t.usrCoords[2],Math.abs(n)<s.eps&&(n=0),Math.abs(r)<s.eps&&(r=0),Math.abs(o)<s.eps&&(o=0),Math.abs(a)<s.eps&&(a=0),n>=0&&o>=0?l=r>=0&&a>=0||r<=0&&a<=0:n<=0&&o<=0&&(l=r>=0&&a>=0||r<=0&&a<=0),l},intersectionFunction:function(t,s,n,o,a,l){var h=this;return s.elementClass===e.OBJECT_CLASS_CURVE&&n.elementClass===e.OBJECT_CLASS_CURVE?function(){return h.meetCurveCurve(s,n,o,a,s.board)}:s.elementClass===e.OBJECT_CLASS_CURVE&&n.elementClass===e.OBJECT_CLASS_LINE||n.elementClass===e.OBJECT_CLASS_CURVE&&s.elementClass===e.OBJECT_CLASS_LINE?function(){return h.meetCurveLine(s,n,o,s.board,l)}:s.elementClass===e.OBJECT_CLASS_LINE&&n.elementClass===e.OBJECT_CLASS_LINE?function(){var t,a,c,d,u;return a=c=r.evaluate(s.visProp.straightfirst),d=u=r.evaluate(s.visProp.straightlast),r.evaluate(l)||a&&d&&c&&u?h.meet(s.stdform,n.stdform,o,s.board):(t=h.meetSegmentSegment(s.point1.coords.usrCoords,s.point2.coords.usrCoords,n.point1.coords.usrCoords,n.point2.coords.usrCoords,s.board),new i(e.COORDS_BY_USER,!a&&t[1]<0||!d&&t[1]>1||!c&&t[2]<0||!u&&t[2]>1?[0,NaN,NaN]:t[0],s.board))}:function(){return h.meet(s.stdform,n.stdform,o,s.board)}},meet:function(t,e,i,n){var r=s.eps;return Math.abs(t[3])<r&&Math.abs(e[3])<r?this.meetLineLine(t,e,i,n):Math.abs(t[3])>=r&&Math.abs(e[3])<r?this.meetLineCircle(e,t,i,n):Math.abs(t[3])<r&&Math.abs(e[3])>=r?this.meetLineCircle(t,e,i,n):this.meetCircleCircle(t,e,i,n)},meetLineBoard:function(t,n,o){var a,l,h,c,d=[];for(r.exists(o)||(o=0),d[0]=s.crossProduct(t,[o,0,1]),d[1]=s.crossProduct(t,[o,1,0]),d[2]=s.crossProduct(t,[-o-n.canvasHeight,0,1]),d[3]=s.crossProduct(t,[-o-n.canvasWidth,1,0]),h=0;h<4;h++)if(Math.abs(d[h][0])>s.eps){for(c=2;c>0;c--)d[h][c]/=d[h][0];d[h][0]=1}return Math.abs(d[1][0])<s.eps?(a=d[0],l=d[2]):Math.abs(d[0][0])<s.eps?(a=d[1],l=d[3]):d[1][2]<0?(a=d[0],l=d[3][2]>n.canvasHeight?d[2]:d[3]):d[1][2]>n.canvasHeight?(a=d[2],l=d[3][2]<0?d[0]:d[3]):(a=d[1],l=d[3][2]<0?d[0]:d[3][2]>n.canvasHeight?d[2]:d[3]),[a=new i(e.COORDS_BY_SCREEN,a.slice(1),n),l=new i(e.COORDS_BY_SCREEN,l.slice(1),n)]},meetLineLine:function(t,n,r,o){var a=isNaN(t[5]+n[5])?[0,0,0]:s.crossProduct(t,n);return new i(e.COORDS_BY_USER,a,o)},meetLineCircle:function(t,n,r,o){var a,l,h,c,d,u,p,f,m;return n[4]<s.eps?Math.abs(s.innerProduct([1,n[6],n[7]],t,3))<s.eps?new i(e.COORDS_BY_USER,n.slice(6,8),o):new i(e.COORDS_BY_USER,[NaN,NaN],o):(h=n[0],l=n.slice(1,3),a=n[3],c=t[0],d=t.slice(1,3),(f=(p=l[0]*d[1]-l[1]*d[0])*p-4*(u=a)*(a*c*c-(l[0]*d[0]+l[1]*d[1])*c+h))>-s.eps*s.eps?(m=[(-p+(f=Math.sqrt(Math.abs(f))))/(2*u),(-p-f)/(2*u)],new i(e.COORDS_BY_USER,0===r?[-m[0]*-d[1]-c*d[0],-m[0]*d[0]-c*d[1]]:[-m[1]*-d[1]-c*d[0],-m[1]*d[0]-c*d[1]],o)):new i(e.COORDS_BY_USER,[0,0,0],o))},meetCircleCircle:function(t,n,r,o){var a;return t[4]<s.eps?Math.abs(this.distance(t.slice(6,2),n.slice(6,8))-n[4])<s.eps?new i(e.COORDS_BY_USER,t.slice(6,8),o):new i(e.COORDS_BY_USER,[0,0,0],o):n[4]<s.eps?Math.abs(this.distance(n.slice(6,2),t.slice(6,8))-t[4])<s.eps?new i(e.COORDS_BY_USER,n.slice(6,8),o):new i(e.COORDS_BY_USER,[0,0,0],o):(a=s.normalize(a=[n[3]*t[0]-t[3]*n[0],n[3]*t[1]-t[3]*n[1],n[3]*t[2]-t[3]*n[2],0,1,1/0,1/0,1/0]),this.meetLineCircle(a,t,r,o))},meetCurveCurve:function(t,s,o,a,l,h){var c;return c=r.exists(h)&&"newton"===h?n.generalizedNewton(t,s,o,a):3===t.bezierDegree&&3===s.bezierDegree?this.meetBezierCurveRedBlueSegments(t,s,o):this.meetCurveRedBlueSegments(t,s,o),new i(e.COORDS_BY_USER,c,l)},meetCurveLine:function(t,i,s,n,o){var a,l;return r.exists(n)||(n=t.board),t.elementClass===e.OBJECT_CLASS_CURVE?(a=t,l=i):(a=i,l=t),this.meetCurveLineDiscrete(a,l,s,n,!o)},meetCurveLineContinuous:function(t,r,o,a,l){var h,c,d,u,p,f,m,g,b,y,v,C,x,_=s.eps,P=s.eps;for(u=this.meetCurveLineDiscrete(t,r,o,a,l),p=u.usrCoords[1],f=u.usrCoords[2],c=function(e){var i,s;return e>t.maxX()||e<t.minX()?1/0:(i=p-t.X(e))*i+(s=f-t.Y(e))*s},d=function(e){var i=r.stdform[0]+r.stdform[1]*t.X(e)+r.stdform[2]*t.Y(e);return i*i},g=(t.maxX()-t.minX())/50,b=t.minX(),C=1e-4,v=NaN,y=0;y<50&&(h=n.root(c,[Math.max(b,t.minX()),Math.min(b+g,t.maxX())]),!((x=Math.abs(c(h)))<=C&&(C=x,v=h,C<_)));y++)b+=g;return h=v,x=d(h=n.root(d,[Math.max(h-g,t.minX()),Math.min(h+g,t.maxX())])),m=isNaN(x)||Math.abs(x)>P?0:1,new i(e.COORDS_BY_USER,[m,t.X(h),t.Y(h)],a)},meetCurveLineContinuousOld:function(r,o,a,l){var h,c,d,u,p,f,m,g,b,y,v,C=10*s.eps;if(t.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),u=function(t){var e=o.stdform[0]+o.stdform[1]*r.X(t)+o.stdform[2]*r.Y(t);return e*e},this.meetCurveLineContinuous.t1memo?h=n.root(u,g=this.meetCurveLineContinuous.t1memo):(g=r.minX(),b=r.maxX(),h=n.root(u,[g,b])),this.meetCurveLineContinuous.t1memo=h,y=r.X(h),v=r.Y(h),1===a){if(this.meetCurveLineContinuous.t2memo&&(g=this.meetCurveLineContinuous.t2memo),c=n.root(u,g),!(Math.abs(c-h)>.1&&Math.abs(y-r.X(c))>.1&&Math.abs(v-r.Y(c))>.1))for(m=(r.maxX()-r.minX())/20,f=r.minX(),d=0;d<20&&(c=n.root(u,[f,f+m]),!(Math.abs(u(c))<=C&&Math.abs(c-h)>.1&&Math.abs(y-r.X(c))>.1&&Math.abs(v-r.Y(c))>.1));d++)f+=m;this.meetCurveLineContinuous.t2memo=h=c}return p=Math.abs(u(h))>C?NaN:1,new i(e.COORDS_BY_USER,[p,r.X(h),r.Y(h)],l)},meetCurveLineDiscrete:function(t,n,o,a,l){var h,c,d,u,p,f,m,g=n.point1.coords.usrCoords,b=n.point2.coords.usrCoords,y=0,v=t.numberPoints,C=r.evaluate(n.visProp.straightfirst),x=r.evaluate(n.visProp.straightlast);for(f=new i(e.COORDS_BY_USER,[0,NaN,NaN],a),0===g[0]?g=[1,b[1]+n.stdform[2],b[2]-n.stdform[1]]:0===b[0]&&(b=[1,g[1]+n.stdform[2],g[2]-n.stdform[1]]),u=t.points[0].usrCoords,h=1;h<v;h++)if(d=u.slice(0),this.distance(d,u=t.points[h].usrCoords)>s.eps)for(3===t.bezierDegree?(m=this.meetBeziersegmentBeziersegment([t.points[h-1].usrCoords.slice(1),t.points[h].usrCoords.slice(1),t.points[h+1].usrCoords.slice(1),t.points[h+2].usrCoords.slice(1)],[g.slice(1),b.slice(1)],l),h+=2):m=[this.meetSegmentSegment(d,u,g,b)],c=0;c<m.length;c++)if(0<=(p=m[c])[1]&&p[1]<=1){if(y===o)return l&&(!C&&p[2]<0||!x&&p[2]>1)?f:f=new i(e.COORDS_BY_USER,p[0],a);y+=1}return f},meetCurveRedBlueSegments:function(t,e,i){var s,n,r,o,a,l,h,c,d,u=0,p=e.numberPoints,f=t.numberPoints;if(p<=1||f<=1)return[0,NaN,NaN];for(s=1;s<f;s++)for(r=t.points[s-1].usrCoords,o=t.points[s].usrCoords,c=Math.min(r[1],o[1]),d=Math.max(r[1],o[1]),l=e.points[0].usrCoords,n=1;n<p;n++)if(a=l,l=e.points[n].usrCoords,Math.min(a[1],l[1])<d&&Math.max(a[1],l[1])>c&&(h=this.meetSegmentSegment(r,o,a,l))[1]>=0&&h[2]>=0&&(h[1]<1&&h[2]<1||s===f-1&&1===h[1]||n===p-1&&1===h[2])){if(u===i)return h[0];u++}return[0,NaN,NaN]},meetSegmentSegment:function(t,e,i,n){var r,o=s.crossProduct(t,e),a=s.crossProduct(i,n),l=s.crossProduct(o,a),h=l[0];return Math.abs(h)<s.eps?[l,1/0,1/0]:[l,((r=[i[1]-t[1],i[2]-t[2]])[0]*(n[2]-i[2])-r[1]*(n[1]-i[1]))/h,(r[0]*(e[2]-t[2])-r[1]*(e[1]-t[1]))/h]},_bezierSplit:function(t){var e,i,s,n,r,o;return[[t[0],e=[.5*(t[0][0]+t[1][0]),.5*(t[0][1]+t[1][1])],n=[.5*(e[0]+(i=[.5*(t[1][0]+t[2][0]),.5*(t[1][1]+t[2][1])])[0]),.5*(e[1]+i[1])],o=[.5*(n[0]+(r=[.5*(i[0]+(s=[.5*(t[2][0]+t[3][0]),.5*(t[2][1]+t[3][1])])[0]),.5*(i[1]+s[1])])[0]),.5*(n[1]+r[1])]],[o,r,s,t[3]]]},_bezierBbox:function(t){var e=[];return 4===t.length?(e[0]=Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),e[1]=Math.max(t[0][1],t[1][1],t[2][1],t[3][1]),e[2]=Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),e[3]=Math.min(t[0][1],t[1][1],t[2][1],t[3][1])):(e[0]=Math.min(t[0][0],t[1][0]),e[1]=Math.max(t[0][1],t[1][1]),e[2]=Math.max(t[0][0],t[1][0]),e[3]=Math.min(t[0][1],t[1][1])),e},_bezierOverlap:function(t,e){return t[2]>=e[0]&&t[0]<=e[2]&&t[1]>=e[3]&&t[3]<=e[1]},_bezierListConcat:function(t,e,i,s){var n,o=r.exists(s),a=0,l=e.length,h=t.length;for(h>0&&l>0&&(1===t[h-1][1]&&0===e[0][1]||o&&1===t[h-1][2]&&0===e[0][2])&&(a=1),n=a;n<l;n++)o&&(e[n][2]*=.5,e[n][2]+=s),e[n][1]*=.5,e[n][1]+=i,t.push(e[n])},_bezierMeetSubdivision:function(t,e,i){var s,n,r,o,a,l,h,c,d,u,p,f,m=[];return n=this._bezierBbox(e),s=this._bezierBbox(t),this._bezierOverlap(n,s)?i<5?(l=(r=this._bezierSplit(t))[0],h=r[1],a=(r=this._bezierSplit(e))[1],this._bezierListConcat(m,this._bezierMeetSubdivision(l,o=r[0],i+1),0,0),this._bezierListConcat(m,this._bezierMeetSubdivision(l,a,i+1),0,.5),this._bezierListConcat(m,this._bezierMeetSubdivision(h,o,i+1),.5,0),this._bezierListConcat(m,this._bezierMeetSubdivision(h,a,i+1),.5,.5),m):(p=[1].concat(t[0]),f=[1].concat(t[3]),d=[1].concat(e[0]),u=[1].concat(e[3]),(c=this.meetSegmentSegment(p,f,d,u))[1]>=0&&c[2]>=0&&c[1]<=1&&c[2]<=1?[c]:[]):[]},_bezierLineMeetSubdivision:function(t,e,i,s){var n,r,o,a,l,h,c,d,u,p=[];return n=this._bezierBbox(e),r=this._bezierBbox(t),s&&!this._bezierOverlap(r,n)?[]:i<5?(a=(o=this._bezierSplit(t))[1],this._bezierListConcat(p,this._bezierLineMeetSubdivision(o[0],e,i+1),0),this._bezierListConcat(p,this._bezierLineMeetSubdivision(a,e,i+1),.5),p):(d=[1].concat(t[0]),u=[1].concat(t[3]),h=[1].concat(e[0]),c=[1].concat(e[1]),(l=this.meetSegmentSegment(d,u,h,c))[1]>=0&&l[1]<=1&&(!s||l[2]>=0&&l[2]<=1)?[l]:[])},meetBeziersegmentBeziersegment:function(t,e,i){var s,n,r;for((s=4===t.length&&4===e.length?this._bezierMeetSubdivision(t,e,0):this._bezierLineMeetSubdivision(t,e,0,i)).sort((function(t,e){return 1e7*(t[1]-e[1])+(t[2]-e[2])})),n=[],r=0;r<s.length;r++)0!==r&&s[r][1]===s[r-1][1]&&s[r][2]===s[r-1][2]||n.push(s[r]);return n},meetBezierCurveRedBlueSegments:function(t,e,i){var s,n,r,o,a,l,h,c=e.numberPoints,d=t.numberPoints,u=[];if(c<4||d<4)return[0,NaN,NaN];for(n=0;n<d-3;n+=3)for(l=this._bezierBbox(o=[[(s=t.points)[n].usrCoords[1],s[n].usrCoords[2]],[s[n+1].usrCoords[1],s[n+1].usrCoords[2]],[s[n+2].usrCoords[1],s[n+2].usrCoords[2]],[s[n+3].usrCoords[1],s[n+3].usrCoords[2]]]),r=0;r<c-3;r+=3)if(h=this._bezierBbox(a=[[(s=e.points)[r].usrCoords[1],s[r].usrCoords[2]],[s[r+1].usrCoords[1],s[r+1].usrCoords[2]],[s[r+2].usrCoords[1],s[r+2].usrCoords[2]],[s[r+3].usrCoords[1],s[r+3].usrCoords[2]]]),this._bezierOverlap(l,h)&&(u=u.concat(this.meetBeziersegmentBeziersegment(o,a))).length>i)return u[i][0];return u.length>i?u[i][0]:[0,NaN,NaN]},bezierSegmentEval:function(t,e){var i,s,n,r=1-t;return s=0,n=0,s+=(i=r*r*r)*e[0][0],n+=i*e[0][1],s+=(i=3*t*r*r)*e[1][0],n+=i*e[1][1],s+=(i=3*t*t*r)*e[2][0],n+=i*e[2][1],[1,s+=(i=t*t*t)*e[3][0],n+=i*e[3][1]]},bezierArc:function(t,e,i,n,r){var o,a,l,h,c,d,u,p,f,m,g,b,y,v,C,x,_=.5*Math.PI,P=e[1],S=e[2],w=e[0],E=[],k=[];for(c=this.distance(e,t),P/=w,S/=w,d=this.rad(t.slice(1),e.slice(1),i.slice(1)),-1===r&&(d=2*Math.PI-d),(o=t)[1]/=o[0],o[2]/=o[0],o[0]/=o[0],h=o.slice(0),n?(E=[P,P+.333*(o[1]-P),P+.666*(o[1]-P),o[1]],k=[S,S+.333*(o[2]-S),S+.666*(o[2]-S),o[2]]):(E=[o[1]],k=[o[2]]);d>s.eps;)d>_?(u=_,d-=_):(u=d,d=0),p=Math.cos(r*u),f=Math.sin(r*u),C=s.matVecMult([[1,0,0],[P*(1-p)+S*f,p,-f],[S*(1-p)-P*f,f,p]],o),m=o[1]-P,g=o[2]-S,b=(h=[C[0]/C[0],C[1]/C[0],C[2]/C[0]])[1]-P,y=h[2]-S,x=Math.sqrt((m+b)*(m+b)+(g+y)*(g+y)),v=Math.abs(y-g)>s.eps?(m+b)*(c/x-.5)/(y-g)*8/3:(g+y)*(c/x-.5)/(m-b)*8/3,E=E.concat([(a=[1,o[1]-v*g,o[2]+v*m])[1],(l=[1,h[1]+v*y,h[2]-v*b])[1],h[1]]),k=k.concat([a[2],l[2],h[2]]),o=h.slice(0);return n&&(E=E.concat([h[1]+.333*(P-h[1]),h[1]+.666*(P-h[1]),P]),k=k.concat([h[2]+.333*(S-h[2]),h[2]+.666*(S-h[2]),S])),[E,k]},projectPointToCircle:function(t,n,o){var a,l,h,c=n.center.coords.usrCoords;return r.exists(o)||(o=t.board),r.isPoint(t)?(a=t.coords.distance(e.COORDS_BY_USER,n.center.coords),l=t.coords.usrCoords):(a=t.distance(e.COORDS_BY_USER,n.center.coords),l=t.usrCoords),Math.abs(a)<s.eps&&(a=s.eps),h=n.Radius()/a,new i(e.COORDS_BY_USER,[c[1]+h*(l[1]-c[1]),c[2]+h*(l[2]-c[2])],o)},projectPointToLine:function(t,n,o){var a=[0,n.stdform[1],n.stdform[2]];return r.exists(o)||(o=t.board),a=s.crossProduct(a,t.coords.usrCoords),new i(e.COORDS_BY_USER,s.crossProduct(a,n.stdform),o)},projectCoordsToSegment:function(t,e,i){var n,r=[i[1]-e[1],i[2]-e[2]],o=[t[1]-e[1],t[2]-e[2]];return Math.abs(r[0])<s.eps&&Math.abs(r[1])<s.eps?[e,0]:(n=s.innerProduct(o,r),[[1,(n/=s.innerProduct(r,r))*r[0]+e[1],n*r[1]+e[2]],n])},projectCoordsToBeziersegment:function(e,i,s){var n;return n=t.Math.Numerics.fminbr((function(t){var n=[1,i.X(s+t),i.Y(s+t)];return n[1]-=e[1],n[2]-=e[2],n[1]*n[1]+n[2]*n[2]}),[0,1]),[[1,i.X(n+s),i.Y(n+s)],n]},projectPointToCurve:function(t,e,i){r.exists(i)||(i=t.board);var s=t.X(),n=t.Y(),o=this.projectCoordsToCurve(s,n,t.position||0,e,i);return t.position=o[1],o[0]},projectCoordsToCurve:function(t,s,o,a,l){var h,c,d,u,p,f,m,g,b,y,v,C,x,_,P,S,w,E,k,A,T=Number.POSITIVE_INFINITY;if(r.exists(l)||(l=a.board),"plot"===r.evaluate(a.visProp.curvetype)){if(o=0,p=T,h=0===a.numberPoints?[0,1,1]:[a.Z(0),a.X(0),a.Y(0)],a.numberPoints>1)for(g=[1,t,s],3===a.bezierDegree?u=0:v=[a.Z(0),a.X(0),a.Y(0)],d=0;d<a.numberPoints-1;d++)3===a.bezierDegree?x=this.projectCoordsToBeziersegment(g,a,u):(C=[a.Z(d+1),a.X(d+1),a.Y(d+1)],x=this.projectCoordsToSegment(g,v,C)),b=x[0],0<=(m=x[1])&&m<=1?(f=this.distance(b,g),y=d+m):m<0?(b=v,f=this.distance(v,g),y=d):m>1&&d===a.numberPoints-2&&(f=this.distance(b=C,g),y=a.numberPoints-1),f<p&&(p=f,o=y,h=b),3===a.bezierDegree?(u++,d+=2):v=C;c=new i(e.COORDS_BY_USER,h,l)}else{for(w=(_=function(e){var i,n;return e<a.minX()||e>a.maxX()?NaN:(i=t-a.X(e))*i+(n=s-a.Y(e))*n})(o),E=(a.maxX()-a.minX())/50,P=a.minX(),d=0;d<50;d++)((S=_(P))<w||isNaN(w))&&(o=P,w=S),P+=E;o=n.fminbr(_,[o-E,o+E]),k=a.minX(),A=a.maxX(),c=new i(e.COORDS_BY_USER,[a.X(o=(o=o<k?k:o)>A?A:o),a.Y(o)],l)}return[a.updateTransform(c),o]},projectCoordsToPolygon:function(e,i){var s,n,r,o,a=i.vertices.length,l=1/0;for(s=0;s<a;s++)r=t.Math.Geometry.projectCoordsToSegment(e,i.vertices[s].coords.usrCoords,i.vertices[(s+1)%a].coords.usrCoords),n=t.Math.Geometry.distance(r[0],e,3),0<=r[1]&&r[1]<=1&&n<l&&(o=r[0].slice(0),l=n);return o},projectPointToTurtle:function(t,s,n){var o,a,l,h,c,d,u,p,f=0,m=0,g=Number.POSITIVE_INFINITY,b=s.objects.length;for(r.exists(n)||(n=t.board),c=0;c<b;c++)(u=s.objects[c]).elementClass===e.OBJECT_CLASS_CURVE&&(o=this.projectPointToCurve(t,u),(d=this.distance(o.usrCoords,t.coords.usrCoords))<g&&(l=o.usrCoords[1],h=o.usrCoords[2],a=t.position,g=d,p=u,m=f),f+=u.numberPoints);return o=new i(e.COORDS_BY_USER,[l,h],n),t.position=a+m,p.updateTransform(o)},projectPointToPoint:function(t,e){return e.coords},projectPointToBoard:function(t,e){var i,n,r,o=e||t.board,a=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],l=t.coords||t,h=o.getBoundingBox();for(i=0;i<4;i++)(r=a[i])[0]*l.usrCoords[r[1]]<r[0]*h[r[2]]&&((n=s.crossProduct([1,h[r[3]],h[r[4]]],[1,h[r[5]],h[r[6]]]))[3]=0,n=s.normalize(n),l=this.projectPointToLine({coords:l},{stdform:n},o));return l},distPointLine:function(t,e){var i,n=e[1],r=e[2],o=e[0];return Math.abs(n)+Math.abs(r)<s.eps?Number.POSITIVE_INFINITY:(i=n*t[1]+r*t[2]+o,n*=n,r*=r,Math.abs(i)/Math.sqrt(n+r))},reuleauxPolygon:function(t,e){var i,n=2*Math.PI,r=n/e,o=(e-1)/2,a=0,l=function(l,h){return function(c,d){var u=(c%n+n)%n,p=Math.floor(u/r)%e;return d||(a=t[0].Dist(t[o]),i=s.Geometry.rad([t[0].X()+1,t[0].Y()],t[0],t[o%e])),isNaN(p)?p:(u=.5*u+p*r*.5+i,t[p][l]()+a*Math[h](u))}};return[l("X","cos"),l("Y","sin"),0,n]}}),s.Geometry})),define("utils/zip",["jxg"],(function(t){"use strict";var e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],a=256;return t.Util=t.Util||{},t.Util.Unzip=function(l){function h(){return L<N?l[L++]:-1}function c(){D=1}function d(){var t;try{return t=1&D,0==(D>>=1)&&(t=1&(D=h()),D=D>>1|128),t}catch(t){throw t}}function u(t){var i=0,s=t;try{for(;s--;)i=i<<1|d();t&&(i=e[i]>>8-t)}catch(t){throw t}return i}function p(){M=0}function f(t){T[M++]=t,E.push(String.fromCharCode(t)),32768===M&&(M=0)}function m(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function g(){for(;;){if(Y[F]>=S)return-1;if(P[Y[F]]===F)return Y[F]++;Y[F]++}}function b(t,e,i,s){var n;for(B=t,R=0,P=i,S=e,n=0;n<17;n++)Y[n]=0;return F=0,function t(){var e,i=B[R];if(17===F)return-1;if(R++,F++,(e=g())>=0)i.b0=e;else if(i.b0=32768,t())return-1;if((e=g())>=0)i.b1=e,i.jump=null;else if(i.b1=32768,i.jump=B[R],i.jumppos=R,t())return-1;return F--,0}()?-1:0}function y(t){for(var e,i,s=0,n=t[s];;)if(d()){if(!(32768&n.b1))return n.b1;for(n=n.jump,e=t.length,i=0;i<e;i++)if(t[i]===n){s=i;break}}else{if(!(32768&n.b0))return n.b0;n=t[++s]}}function v(){var a,l,g,v,C,x,_,P,S,w,E,k,A,O,N;do{if(a=d(),0===(l=u(2)))for(c(),S=h(),S|=h()<<8,E=h(),65535&(S^~(E|=h()<<8))&&t.debug("BlockLen checksum mismatch\n");S--;)f(h());else if(1===l)for(;;)if((v=e[u(7)]>>1)>23?(v=v<<1|d())>199?v=(v-=128)<<1|d():(v-=48)>143&&(v+=136):v+=256,v<256)f(v);else{if(256===v)break;for(P=u(s[v-=257])+i[v],v=e[u(5)]>>3,r[v]>8?(w=u(8),w|=u(r[v]-8)<<8):w=u(r[v]),w+=n[v],v=0;v<P;v++)f(T[M-w&32767])}else if(2===l){for(x=new Array(320),A=257+u(5),O=1+u(5),N=4+u(4),v=0;v<19;v++)x[v]=0;for(v=0;v<N;v++)x[o[v]]=u(3);for(P=I.length,g=0;g<P;g++)I[g]=new m;if(b(I,19,x))return p(),1;for(k=A+O,g=0;g<k;)if((v=y(I))<16)x[g++]=v;else if(16===v){if(g+(v=3+u(2))>k)return p(),1;for(C=g?x[g-1]:0;v--;)x[g++]=C}else{if(g+(v=17===v?3+u(3):11+u(7))>k)return p(),1;for(;v--;)x[g++]=0}for(P=j.length,g=0;g<P;g++)j[g]=new m;if(b(j,A,x))return p(),1;for(P=j.length,g=0;g<P;g++)I[g]=new m;for(_=[],g=A;g<x.length;g++)_[g-A]=x[g];if(b(I,O,_))return p(),1;for(;;)if((v=y(j))>=256){if(0==(v-=256))break;for(P=u(s[v-=1])+i[v],v=y(I),r[v]>8?(w=u(8),w|=u(r[v]-8)<<8):w=u(r[v]),w+=n[v];P--;)f(T[M-w&32767])}else f(v)}}while(!a);return p(),c(),0}function C(){var t,e,i,s,n,r=[];try{if(E=[],O=!1,r[0]=h(),r[1]=h(),120===r[0]&&218===r[1]&&(v(),A[k]=[E.join(""),"geonext.gxt"],k++),31===r[0]&&139===r[1]&&(w(),A[k]=[E.join(""),"file"],k++),80===r[0]&&75===r[1]&&(O=!0,r[2]=h(),r[3]=h(),3===r[2]&&4===r[3])){for(r[0]=h(),r[1]=h(),x=h(),x|=h()<<8,n=h(),n|=h()<<8,h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),h(),s=h(),s|=h()<<8,i=h(),i|=h()<<8,t=0,z=[];s--;)"/"===(e=h())|":"===e?t=0:t<a-1&&(z[t++]=String.fromCharCode(e));for(_||(_=z),t=0;t<i;)e=h(),t++;8===n&&(v(),A[k]=new Array(2),A[k][0]=E.join(""),A[k][1]=z.join(""),k++),w()}}catch(t){throw t}}var x,_,P,S,w,E=[],k=0,A=[],T=new Array(32768),M=0,O=!1,N=l.length,L=0,D=1,j=new Array(288),I=new Array(32),R=0,B=null,F=(new Array(64),new Array(64),0),Y=new Array(17),z=[];Y[0]=0,w=function(){var t,e,i=[];if(8&x&&(i[0]=h(),i[1]=h(),i[2]=h(),i[3]=h(),80===i[0]&&75===i[1]&&7===i[2]&&8===i[3]&&(h(),h(),h(),h()),h(),h(),h(),h(),h(),h(),h(),h()),O&&C(),i[0]=h(),8===i[0]){if(x=h(),h(),h(),h(),h(),h(),h(),4&x)for(i[0]=h(),i[2]=h(),F=i[0]+256*i[1],t=0;t<F;t++)h();if(8&x)for(t=0,z=[],e=h();e;)"7"!==e&&":"!==e||(t=0),t<a-1&&(z[t++]=e),e=h();if(16&x)for(e=h();e;)e=h();2&x&&(h(),h()),v(),h(),h(),h(),h(),h(),h(),h(),h(),O&&C()}},t.Util.Unzip.prototype.unzipFile=function(t){var e;for(this.unzip(),e=0;e<A.length;e++)if(A[e][1]===t)return A[e][0];return""},t.Util.Unzip.prototype.unzip=function(){return C(),A}},t.Util})),define("utils/encoding",["jxg"],(function(t){"use strict";var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return t.Util=t.Util||{},t.Util.UTF8={encode:function(t){var e,i,s="",n=t.length;if(t=t.replace(/\r\n/g,"\n"),"function"==typeof unescape&&"function"==typeof encodeURIComponent)return unescape(encodeURIComponent(t));for(e=0;e<n;e++)(i=t.charCodeAt(e))<128?s+=String.fromCharCode(i):i>127&&i<2048?(s+=String.fromCharCode(i>>6|192),s+=String.fromCharCode(63&i|128)):(s+=String.fromCharCode(i>>12|224),s+=String.fromCharCode(i>>6&63|128),s+=String.fromCharCode(63&i|128));return s},decode:function(t){var i,s,n,r=0,o=0,a=0,l=[],h=t.length,c=[];for(i=0;i<h;i++)s=t.charCodeAt(i),n=e[s],o=0!==a?63&s|o<<6:255>>n&s,0===(a=e[256+a+n])&&(o>65535?l.push(55232+(o>>10),56320+(1023&o)):l.push(o),++r%1e4==0&&(c.push(String.fromCharCode.apply(null,l)),l=[]));return c.push(String.fromCharCode.apply(null,l)),c.join("")},asciiCharCodeAt:function(t,e){var i=t.charCodeAt(e);if(i>255)switch(i){case 8364:i=128;break;case 8218:i=130;break;case 402:i=131;break;case 8222:i=132;break;case 8230:i=133;break;case 8224:i=134;break;case 8225:i=135;break;case 710:i=136;break;case 8240:i=137;break;case 352:i=138;break;case 8249:i=139;break;case 338:i=140;break;case 381:i=142;break;case 8216:i=145;break;case 8217:i=146;break;case 8220:i=147;break;case 8221:i=148;break;case 8226:i=149;break;case 8211:i=150;break;case 8212:i=151;break;case 732:i=152;break;case 8482:i=153;break;case 353:i=154;break;case 8250:i=155;break;case 339:i=156;break;case 382:i=158;break;case 376:i=159}return i}},t.Util.UTF8})),define("utils/base64",["jxg","utils/encoding"],(function(t,e){"use strict";function i(t,e){return 255&t.charCodeAt(e)}function s(t,e){return n.indexOf(t.charAt(e))}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t.Util=t.Util||{},t.Util.Base64={encode:function(t){var s,r,o,a,l,h=[];for(a=(o=(l=e.encode(t)).length)%3,s=0;s<o-a;s+=3)r=i(l,s)<<16|i(l,s+1)<<8|i(l,s+2),h.push(n.charAt(r>>18),n.charAt(r>>12&63),n.charAt(r>>6&63),n.charAt(63&r));switch(a){case 1:r=i(l,o-1),h.push(n.charAt(r>>2),n.charAt(r<<4&63),"=","=");break;case 2:r=i(l,o-2)<<8|i(l,o-1),h.push(n.charAt(r>>10),n.charAt(r>>4&63),n.charAt(r<<2&63),"=")}return h.join("")},decode:function(t,i){var n,r,o,a,l,h,c=[],d=[];if((o=(n=t.replace(/[^A-Za-z0-9\+\/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for("="===n.charAt(o-1)&&(a=1,"="===n.charAt(o-2)&&(a=2),o-=4),r=0;r<o;r+=4)l=s(n,r)<<18|s(n,r+1)<<12|s(n,r+2)<<6|s(n,r+3),d.push(l>>16,l>>8&255,255&l),r%1e4==0&&(c.push(String.fromCharCode.apply(null,d)),d=[]);switch(a){case 1:l=s(n,o)<<12|s(n,o+1)<<6|s(n,o+2),d.push(l>>10,l>>2&255);break;case 2:l=s(n,r)<<6|s(n,r+1),d.push(l>>4)}return c.push(String.fromCharCode.apply(null,d)),h=c.join(""),i&&(h=e.decode(h)),h},decodeAsArray:function(t){var e,i=this.decode(t),s=[],n=i.length;for(e=0;e<n;e++)s[e]=i.charCodeAt(e);return s}},t.Util.Base64})),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],(function(t,e,i,s){"use strict";return t.Server={modules:{},runningCalls:{},handleError:function(e){t.debug("error occured, server says: "+e.message)},callServer:function(n,r,o,a){var l,h,c,d,u,p;for(p in a=a||!1,o)o.hasOwnProperty(p)&&(escape(p),escape(o[p]));u=s.toJSON(o);do{d=n+Math.floor(4096*Math.random())}while(s.exists(this.runningCalls[d]));return this.runningCalls[d]={action:n},s.exists(o.module)&&(this.runningCalls[d].module=o.module),l=t.serverBase+"JXGServer.py",h="action="+escape(n)+"&id="+d+"&dataJSON="+escape(i.encode(u)),this.cbp=function(t){var n,o,a,l,h,c,d,u;if(n=new e.Unzip(i.decodeAsArray(t)).unzip(),s.isArray(n)&&n.length>0&&(n=n[0][0]),s.exists(n))if("error"===(o=window.JSON&&window.JSON.parse?window.JSON.parse(n):new Function("return "+n)()).type)this.handleError(o);else if("response"===o.type){for(c=o.id,d=0;d<o.fields.length;d++)l=(a=o.fields[d]).namespace+("object"==typeof new Function("return "+a.namespace)()?".":".prototype.")+a.name+" = "+a.value,new Function(l)();for(d=0;d<o.handler.length;d++){for(a=o.handler[d],h=[],u=0;u<a.parameters.length;u++)h[u]='"'+a.parameters[u]+'": '+a.parameters[u];l="if(typeof JXG.Server.modules."+this.runningCalls[c].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[c].module+" = {};",l+="JXG.Server.modules."+this.runningCalls[c].module+"."+a.name+"_cb = "+a.callback+";",l+="JXG.Server.modules."+this.runningCalls[c].module+"."+a.name+" = function ("+a.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[c].module+"."+a.name+"_cb;var __JXGSERVER_PAR__ = {"+h.join(",")+', "module": "'+this.runningCalls[c].module+'", "handler": "'+a.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(l)()}delete this.runningCalls[c],r(o.data)}},this.cb=t.bind(this.cbp,this),window.XMLHttpRequest?(c=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):c=new ActiveXObject("Microsoft.XMLHTTP"),!(!c||(c.open("POST",l,!a),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a||(c.onreadystatechange=function(t){return function(){return 4===c.readyState&&200===c.status&&(t(c.responseText),!0)}}(this.cb)),c.send(h),!a)||(this.cb(c.responseText),0))},loadModule_cb:function(e){var i;for(i=0;i<e.length;i++)t.debug(e[i].name+": "+e[i].value)},loadModule:function(e){return t.Server.callServer("load",t.Server.loadModule_cb,{module:e},!0)}},t.Server.load=t.Server.loadModule,t.Server})),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],(function(t,e,i,s,n,r){"use strict";return i.Symbolic={generateSymbolicCoordinatesPartial:function(t,e,i,s){var n,o,a,l=e.ancestors,h=0,c=function(t){return"underscore"===s?i+"_{"+t+"}":"brace"===s?i+"["+t+"]":i+t};for(o in t.listOfFreePoints=[],t.listOfDependantPoints=[],l)if(l.hasOwnProperty(o)&&(n=0,r.isPoint(l[o]))){for(a in l[o].ancestors)l[o].ancestors.hasOwnProperty(a)&&n++;0===n?(l[o].symbolic.x=l[o].coords.usrCoords[1],l[o].symbolic.y=l[o].coords.usrCoords[2],t.listOfFreePoints.push(l[o])):(l[o].symbolic.x=c(h+=1),l[o].symbolic.y=c(h+=1),t.listOfDependantPoints.push(l[o]))}return r.isPoint(e)&&(e.symbolic.x="x",e.symbolic.y="y"),h},clearSymbolicCoordinates:function(t){var e=function(t){var e,i=t&&t.length||0;for(e=0;e<i;e++)r.isPoint(t[e])&&(t[e].symbolic.x="",t[e].symbolic.y="")};e(t.listOfFreePoints),e(t.listOfDependantPoints),delete t.listOfFreePoints,delete t.listOfDependantPoints},generatePolynomials:function(t,e,i){var s,n,o,a,l=e.ancestors,h=[],c=[];for(s in i&&this.generateSymbolicCoordinatesPartial(t,e,"u","brace"),l[e.id]=e,l)if(l.hasOwnProperty(s)&&(a=0,h=[],r.isPoint(l[s]))){for(n in l[s].ancestors)l[s].ancestors.hasOwnProperty(n)&&a++;if(a>0)for(h=l[s].generatePolynomial(),o=0;o<h.length;o++)c.push(h[o])}return i&&this.clearSymbolicCoordinates(t),c},geometricLocusByGroebnerBase:function(o,a){var l,h,c,d,u,p,f,m,g,b,y,v,C=o.options.locus,x={},_=this.generateSymbolicCoordinatesPartial(o,a,"u","brace"),P=new e(t.COORDS_BY_USR,[0,0],o),S=new e(t.COORDS_BY_USR,[o.canvasWidth,o.canvasHeight],o),w=1,E=0,k=0,A=0;if(void 0===n.modules.geoloci&&n.loadModule("geoloci"),void 0===n.modules.geoloci)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(p=P.usrCoords[1],f=S.usrCoords[1],m=S.usrCoords[2],g=P.usrCoords[2],C.translateToOrigin&&o.listOfFreePoints.length>0){for(E=(c=null!=C.toOrigin&&r.isInArray(o.listOfFreePoints,C.toOrigin.id)?C.toOrigin:o.listOfFreePoints[0]).symbolic.x,k=c.symbolic.y,u=0;u<o.listOfFreePoints.length;u++)o.listOfFreePoints[u].symbolic.x-=E,o.listOfFreePoints[u].symbolic.y-=k;if(p-=E,f-=E,m-=k,g-=k,C.translateTo10&&o.listOfFreePoints.length>1){for(d=null!=C.to10&&C.to10.id!==C.toOrigin.id&&r.isInArray(o.listOfFreePoints,C.to10.id)?C.to10:o.listOfFreePoints[0].id===c.id?o.listOfFreePoints[1]:o.listOfFreePoints[0],A=s.rad([1,0],[0,0],[d.symbolic.x,d.symbolic.y]),b=Math.cos(-A),y=Math.sin(-A),u=0;u<o.listOfFreePoints.length;u++)v=o.listOfFreePoints[u].symbolic.x,o.listOfFreePoints[u].symbolic.x=b*o.listOfFreePoints[u].symbolic.x-y*o.listOfFreePoints[u].symbolic.y,o.listOfFreePoints[u].symbolic.y=y*v+b*o.listOfFreePoints[u].symbolic.y;if(d.symbolic.y=0,v=p,p=b*p-y*m,m=y*v+b*m,v=f,f=b*f-y*g,g=y*v+b*g,C.stretch&&Math.abs(d.symbolic.x)>i.eps){for(w=d.symbolic.x,u=0;u<o.listOfFreePoints.length;u++)o.listOfFreePoints[u].symbolic.x/=w,o.listOfFreePoints[u].symbolic.y/=w;for(u=0;u<o.objectsList.length;u++)o.objectsList[u].elementClass===t.OBJECT_CLASS_CIRCLE&&"pointRadius"===o.objectsList[u].method&&(x[u]=o.objectsList[u].radius,o.objectsList[u].radius/=w);p/=w,f/=w,m/=w,g/=w,d.symbolic.x=1}}for(u=0;u<o.listOfFreePoints.length;u++)v=o.listOfFreePoints[u].symbolic.x,Math.abs(v)<i.eps&&(o.listOfFreePoints[u].symbolic.x=0),Math.abs(v-Math.round(v))<i.eps&&(o.listOfFreePoints[u].symbolic.x=Math.round(v)),v=o.listOfFreePoints[u].symbolic.y,Math.abs(v)<i.eps&&(o.listOfFreePoints[u].symbolic.y=0),Math.abs(v-Math.round(v))<i.eps&&(o.listOfFreePoints[u].symbolic.y=Math.round(v))}for(u in l=this.generatePolynomials(o,a).join(","),this.cbp=function(t){h=t},this.cb=r.bind(this.cbp,this),n.modules.geoloci.lociCoCoA(p,f,m,g,_,l,w,A,E,k,this.cb,!0),this.clearSymbolicCoordinates(o),x)x.hasOwnProperty(u)&&(o.objects[u].radius=x[u]);return h}},i.Symbolic})),define("math/poly",["jxg","math/math","utils/type"],(function(t,e,i){"use strict";return e.Poly={},e.Poly.Ring=function(t){this.vars=t},t.extend(e.Poly.Ring.prototype,{}),e.Poly.Monomial=function(t,e,s){var n;if(!i.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(i.isArray(s)||(s=[]),n=(s=s.slice(0,t.vars.length)).length;n<t.vars.length;n++)s.push(0);this.ring=t,this.coefficient=e||0,this.exponents=i.deepCopy(s)},t.extend(e.Poly.Monomial.prototype,{copy:function(){return new e.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var t,e=[];for(t=0;t<this.ring.vars.length;t++)e.push(this.ring.vars[t]+"^"+this.exponents[t]);return this.coefficient+"*"+e.join("*")}}),e.Poly.Polynomial=function(t,e){var s;if(!i.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");s=i.exists(e)&&i.isString(e)?void 0:[],this.ring=t,this.monomials=s},t.extend(e.Poly.Polynomial.prototype,{findSignature:function(t){var e;for(e=0;e<this.monomials.length;e++)if(i.cmpArrays(this.monomials[e].exponents,t))return e;return-1},addSubMonomial:function(t,e){var i;(i=this.findSignature(t.exponents))>-1?this.monomials[i].coefficient+=e*t.coefficient:(t.coefficient*=e,this.monomials.push(t))},add:function(t){var e;if(!i.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(i.isArray(t.exponents))this.addSubMonomial(t,1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],1)},sub:function(t){var e;if(!i.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(i.isArray(t.exponents))this.addSubMonomial(t,-1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],-1)},copy:function(){var t,i;for(i=new e.Poly.Polynomial(this.ring),t=0;t<this.monomials.length;t++)i.monomials.push(this.monomials[t].copy());return i},print:function(){var t,e=[];for(t=0;t<this.monomials.length;t++)e.push("("+this.monomials[t].print()+")");return e.join("+")}}),e.Poly})),define("math/complex",["jxg","utils/type"],(function(t,e){"use strict";return t.Complex=function(t,e){this.isComplex=!0,t&&t.isComplex&&(e=t.imaginary,t=t.real),this.real=t||0,this.imaginary=e||0,this.absval=0,this.angle=0},t.extend(t.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(t){return e.isNumber(t)?this.real+=t:(this.real+=t.real,this.imaginary+=t.imaginary),this},sub:function(t){return e.isNumber(t)?this.real-=t:(this.real-=t.real,this.imaginary-=t.imaginary),this},mult:function(t){var i,s;return e.isNumber(t)?(this.real*=t,this.imaginary*=t):(this.real=(i=this.real)*t.real-(s=this.imaginary)*t.imaginary,this.imaginary=i*t.imaginary+s*t.real),this},div:function(t){var i,s,n;if(e.isNumber(t)){if(Math.abs(t)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=t,this.imaginary/=t}else{if(Math.abs(t.real)<Math.eps&&Math.abs(t.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real=((n=this.real)*t.real+(s=this.imaginary)*t.imaginary)/(i=t.real*t.real+t.imaginary*t.imaginary),this.imaginary=(s*t.real-n*t.imaginary)/i}return this},conj:function(){return this.imaginary*=-1,this}}),t.C={},t.C.add=function(e,i){var s=new t.Complex(e);return s.add(i),s},t.C.sub=function(e,i){var s=new t.Complex(e);return s.sub(i),s},t.C.mult=function(e,i){var s=new t.Complex(e);return s.mult(i),s},t.C.div=function(e,i){var s=new t.Complex(e);return s.div(i),s},t.C.conj=function(e){var i=new t.Complex(e);return i.conj(),i},t.C.abs=function(e){var i=new t.Complex(e);return i.conj(),i.mult(e),Math.sqrt(i.real)},t.Complex.C=t.C,t.Complex})),define("utils/color",["jxg","utils/type","math/math"],(function(t,e,i){"use strict";var s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},n=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}];return t.rgbParser=function(t,i,r){var o,a,l,h,c,d,u,p,f,m=t;if(!e.exists(t))return[];if(e.exists(i)&&e.exists(r)&&(m=[t,i,r]),f=!1,e.isArray(o=m)){for(c=0;c<3;c++)f=f||/\./.test(m[c].toString());for(c=0;c<3;c++)f=f&&m[c]>=0&&m[c]<=1;return f?[Math.ceil(255*m[0]),Math.ceil(255*m[1]),Math.ceil(255*m[2])]:m}for("string"==typeof m&&(o=m),"#"===o.charAt(0)&&(o=o.substr(1,6)),o=o.replace(/ /g,"").toLowerCase(),o=s[o]||o,c=0;c<n.length;c++)l=n[c].process,(h=n[c].re.exec(o))&&(d=(a=l(h))[0],u=a[1],p=a[2]);return isNaN(d)||isNaN(u)||isNaN(p)?[]:[d=d<0||isNaN(d)?0:d>255?255:d,u=u<0||isNaN(u)?0:u>255?255:u,p=p<0||isNaN(p)?0:p>255?255:p]},t.rgb2css=function(e,i,s){var n;return"rgb("+(n=t.rgbParser(e,i,s))[0]+", "+n[1]+", "+n[2]+")"},t.rgb2hex=function(e,i,s){var n,r,o;return r=(n=t.rgbParser(e,i,s))[1],o=n[2],n=(n=n[0]).toString(16),r=r.toString(16),o=o.toString(16),1===n.length&&(n="0"+n),1===r.length&&(r="0"+r),1===o.length&&(o="0"+o),"#"+n+r+o},t.hex2rgb=function(e){return t.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),t.rgb2css(e)},t.hsv2rgb=function(t,e,s){var n,r,o,a,l,h,c,d,u;if(t=(t%360+360)%360,0===e){if(!(isNaN(t)||t<i.eps))return"#ffffff";n=s,r=s,o=s}else switch(h=t>=360?0:t,h/=60,l=Math.floor(h),a=h-l,c=s*(1-e),d=s*(1-e*a),u=s*(1-e*(1-a)),l){case 0:n=s,r=u,o=c;break;case 1:n=d,r=s,o=c;break;case 2:n=c,r=s,o=u;break;case 3:n=c,r=d,o=s;break;case 4:n=u,r=c,o=s;break;case 5:n=s,r=c,o=d}return["#",n=2===(n=Math.round(255*n).toString(16)).length?n:1===n.length?"0"+n:"00",r=2===(r=Math.round(255*r).toString(16)).length?r:1===r.length?"0"+r:"00",o=2===(o=Math.round(255*o).toString(16)).length?o:1===o.length?"0"+o:"00"].join("")},t.rgb2hsv=function(e,i,s){var n,r,o,a,l,h,c,d,u,p,f,m,g;return r=(n=t.rgbParser(e,i,s))[1],o=n[2],a=(n=n[0])/255,l=r/255,h=o/255,m=Math.max(n,r,o),d=(g=Math.min(n,r,o))/255,p=0,(f=c=m/255)>0&&(p=(f-d)/f),u=1/(c-d),p>0&&(m===n?u*=l-h:u=m===r?2+(h-a)*u:4+(a-l)*u),(u*=60)<0&&(u+=360),m===g&&(u=0),[u,p,f]},t.rgb2LMS=function(e,i,s){var n,r,o,a,l,h,c,d=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return r=(n=t.rgbParser(e,i,s))[1],o=n[2],n=n[0],n=Math.pow(n,.476190476),r=Math.pow(r,.476190476),o=Math.pow(o,.476190476),(c=[a=n*d[0][0]+r*d[0][1]+o*d[0][2],l=n*d[1][0]+r*d[1][1]+o*d[1][2],h=n*d[2][0]+r*d[2][1]+o*d[2][2]]).l=a,c.m=l,c.s=h,c},t.LMS2rgb=function(t,e,i){var s,n,r,o,a=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],l=function(t){for(var e=127,i=64;i>0;){if(Math.pow(e,.476190476)>t)e-=i;else{if(Math.pow(e+1,.476190476)>t)return e;e+=i}i/=2}return 254===e&&13.994955247<t?255:e};return n=t*a[1][0]+e*a[1][1]+i*a[1][2],r=t*a[2][0]+e*a[2][1]+i*a[2][2],(o=[s=l(s=t*a[0][0]+e*a[0][1]+i*a[0][2]),n=l(n),r=l(r)]).r=s,o.g=n,o.b=r,o},t.rgba2rgbo=function(t){var e;return 9===t.length&&"#"===t.charAt(0)?(e=parseInt(t.substr(7,2).toUpperCase(),16)/255,t=t.substr(0,7)):e=1,[t,e]},t.rgbo2rgba=function(t,e){var i;return"none"===t?t:(1===(i=Math.round(255*e).toString(16)).length&&(i="0"+i),t+i)},t.rgb2bw=function(e){var i,s,n,r="0123456789ABCDEF";return"none"===e?e:(n=t.rgbParser(e),i=Math.floor(.3*n[0]+.59*n[1]+.11*n[2]),e="#"+(s=r.charAt(i>>4&15)+r.charAt(15&i))+s+s)},t.rgb2cb=function(e,i){var s,n,r,o,a,l,h,c,d,u,p,f="0123456789ABCDEF";if("none"===e)return e;switch(n=(a=t.rgb2LMS(e))[0],r=a[1],o=a[2],i=i.toLowerCase()){case"protanopia":l=-.06150039994295001,h=.08277001656812001,c=-.013200141220000003,d=.05858939668799999,u=-.07934519995360001,p=.013289415272000003,n=o/r<.6903216543277437?-(h*r+c*o)/l:-(u*r+p*o)/d;break;case"tritanopia":l=-.00058973116217,h=.007690316482,c=-.01011703519052,d=.025495080838999994,u=-.0422740347,p=.017005316784,o=r/n<.8349489908460004?-(l*n+h*r)/c:-(d*n+u*r)/p;break;default:l=-.06150039994295001,h=.08277001656812001,c=-.013200141220000003,d=.05858939668799999,u=-.07934519995360001,p=.013289415272000003,r=o/n<.5763833686400911?-(l*n+c*o)/h:-(d*n+p*o)/u}return s=t.LMS2rgb(n,r,o),e="#"+(f.charAt(s[0]>>4&15)+f.charAt(15&s[0])),(e+=f.charAt(s[1]>>4&15)+f.charAt(15&s[1]))+(f.charAt(s[2]>>4&15)+f.charAt(15&s[2]))},t.autoHighlight=function(e){var i=t.rgba2rgbo(e),s=i[0],n=i[1];return"#"===e.charAt(0)?t.rgbo2rgba(s,n*=n<.3?1.8:.4):e},t})),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],(function(t,e,i,s,n){"use strict";return t.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},t.Validator=function(){var e,s=function(t){return n.isString(t)},r=function(t){return Math.abs(t-Math.round(t))<i.eps},o=function(t){return r(t)&&t>0},a=function(t){return t>0},l=function(t){return t>=0},h={},c={attractorDistance:l,color:s,defaultDistance:n.isNumber,display:function(t){return"html"===t||"internal"===t},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(e){return n.exists(t.normalizePointFace(e))},factor:n.isNumber,fillColor:s,fillOpacity:n.isNumber,firstArrow:!1,fontSize:r,dash:r,gridX:n.isNumber,gridY:n.isNumber,hasGrid:!1,highlightFillColor:s,highlightFillOpacity:n.isNumber,highlightStrokeColor:s,highlightStrokeOpacity:n.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:r,minorHeight:r,minorTicks:l,minTicksDistance:o,numberPointsHigh:o,numberPointsLow:o,opacity:n.isNumber,radius:n.isNumber,RDPsmoothing:!1,renderer:function(t){return"vml"===t||"svg"===t||"canvas"===t||"no"===t},right:function(t){return/^[0-9]+px$/.test(t)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:r,snapSizeX:a,snapSizeY:a,snapWidth:n.isNumber,snapToGrid:!1,snatchDistance:l,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:s,strokeOpacity:n.isNumber,strokeWidth:r,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(e in c)c.hasOwnProperty(e)&&(h[e.toLowerCase()]=c[e]);return h}(),t.normalizePointFace=function(t){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[t]},t.useStandardOptions=function(i){var s,n,r,o,a=t.Options,l=i.hasGrid;for(s in i.options.grid.hasGrid=a.grid.hasGrid,i.options.grid.gridX=a.grid.gridX,i.options.grid.gridY=a.grid.gridY,i.options.grid.gridColor=a.grid.gridColor,i.options.grid.gridOpacity=a.grid.gridOpacity,i.options.grid.gridDash=a.grid.gridDash,i.options.grid.snapToGrid=a.grid.snapToGrid,i.options.grid.snapSizeX=a.grid.SnapSizeX,i.options.grid.snapSizeY=a.grid.SnapSizeY,i.takeSizeFromFile=a.takeSizeFromFile,o=function(t,e){t.visProp.fillcolor=e.fillColor,t.visProp.highlightfillcolor=e.highlightFillColor,t.visProp.strokecolor=e.strokeColor,t.visProp.highlightstrokecolor=e.highlightStrokeColor},i.objects)if(i.objects.hasOwnProperty(s))if((r=i.objects[s]).elementClass===e.OBJECT_CLASS_POINT)o(r,a.point);else if(r.elementClass===e.OBJECT_CLASS_LINE)for(o(r,a.line),n=0;n<r.ticks.length;n++)r.ticks[n].majorTicks=a.line.ticks.majorTicks,r.ticks[n].minTicksDistance=a.line.ticks.minTicksDistance,r.ticks[n].visProp.minorheight=a.line.ticks.minorHeight,r.ticks[n].visProp.majorheight=a.line.ticks.majorHeight;else r.elementClass===e.OBJECT_CLASS_CIRCLE?o(r,a.circle):r.type===e.OBJECT_TYPE_ANGLE?o(r,a.angle):r.type===e.OBJECT_TYPE_ARC?o(r,a.arc):r.type===e.OBJECT_TYPE_POLYGON?o(r,a.polygon):r.type===e.OBJECT_TYPE_CONIC?o(r,a.conic):r.type===e.OBJECT_TYPE_CURVE?o(r,a.curve):r.type===e.OBJECT_TYPE_SECTOR&&(r.arc.visProp.fillcolor=a.sector.fillColor,r.arc.visProp.highlightfillcolor=a.sector.highlightFillColor,r.arc.visProp.fillopacity=a.sector.fillOpacity,r.arc.visProp.highlightfillopacity=a.sector.highlightFillOpacity);i.fullUpdate(),l&&!i.hasGrid?i.removeGrids(i):!l&&i.hasGrid&&i.create("grid",[])},t.useBlackWhiteOptions=function(e){var i=t.Options;i.point.fillColor=s.rgb2bw(i.point.fillColor),i.point.highlightFillColor=s.rgb2bw(i.point.highlightFillColor),i.point.strokeColor=s.rgb2bw(i.point.strokeColor),i.point.highlightStrokeColor=s.rgb2bw(i.point.highlightStrokeColor),i.line.fillColor=s.rgb2bw(i.line.fillColor),i.line.highlightFillColor=s.rgb2bw(i.line.highlightFillColor),i.line.strokeColor=s.rgb2bw(i.line.strokeColor),i.line.highlightStrokeColor=s.rgb2bw(i.line.highlightStrokeColor),i.circle.fillColor=s.rgb2bw(i.circle.fillColor),i.circle.highlightFillColor=s.rgb2bw(i.circle.highlightFillColor),i.circle.strokeColor=s.rgb2bw(i.circle.strokeColor),i.circle.highlightStrokeColor=s.rgb2bw(i.circle.highlightStrokeColor),i.arc.fillColor=s.rgb2bw(i.arc.fillColor),i.arc.highlightFillColor=s.rgb2bw(i.arc.highlightFillColor),i.arc.strokeColor=s.rgb2bw(i.arc.strokeColor),i.arc.highlightStrokeColor=s.rgb2bw(i.arc.highlightStrokeColor),i.polygon.fillColor=s.rgb2bw(i.polygon.fillColor),i.polygon.highlightFillColor=s.rgb2bw(i.polygon.highlightFillColor),i.sector.fillColor=s.rgb2bw(i.sector.fillColor),i.sector.highlightFillColor=s.rgb2bw(i.sector.highlightFillColor),i.curve.strokeColor=s.rgb2bw(i.curve.strokeColor),i.grid.gridColor=s.rgb2bw(i.grid.gridColor),t.useStandardOptions(e)},t.Options.normalizePointFace=t.normalizePointFace,t.Options})),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],(function(t,e,i,s,n,r,o,a){"use strict";return t.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},t.extend(t.AbstractRenderer.prototype,{_updateVisual:function(t,e,i){(i||this.enhancedRendering)&&(e=e||{},this.setObjectTransition(t),o.evaluate(t.visProp.draft)?this.setDraft(t):(e.stroke||(t.highlighted?(this.setObjectStrokeColor(t,t.visProp.highlightstrokecolor,t.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(t,t.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))),e.fill||(t.highlighted?this.setObjectFillColor(t,t.visProp.highlightfillcolor,t.visProp.highlightfillopacity):this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity)),e.dash||this.setDashStyle(t,t.visProp),e.shadow||this.setShadow(t),e.gradient||this.setShadow(t)))},drawPoint:function(t){var i,s=e.normalizePointFace(o.evaluate(t.visProp.face));t.rendNode=this.appendChildPrim(this.createPrim(i="o"===s?"ellipse":"[]"===s?"rect":"path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,i),this._updateVisual(t,{dash:!0,shadow:!0},!0),this.updatePoint(t)},updatePoint:function(t){var i,s=o.evaluate(t.visProp.size),n=e.normalizePointFace(o.evaluate(t.visProp.face)),r=o.evaluate(t.visProp.sizeunit),a=o.evaluate(t.visProp.zoom);isNaN(t.coords.scrCoords[2]+t.coords.scrCoords[1])||("user"===r&&(s*=Math.sqrt(t.board.unitX*t.board.unitY)),i=0==(s*=t.board&&a?Math.sqrt(t.board.zoomX*t.board.zoomY):1)?0:s+1,"o"===n?this.updateEllipsePrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2],i,i):"[]"===n?this.updateRectPrim(t.rendNode,t.coords.scrCoords[1]-s,t.coords.scrCoords[2]-s,2*s,2*s):this.updatePathPrim(t.rendNode,this.updatePathStringPoint(t,s,n),t.board),this._updateVisual(t,{dash:!1,shadow:!1}),this.setShadow(t))},changePointStyle:function(t){var e=this.getElementById(t.id);o.exists(e)&&this.remove(e),this.drawPoint(t),o.clearVisPropOld(t),t.visPropCalc.visible||this.hide(t),o.evaluate(t.visProp.draft)&&this.setDraft(t)},drawLine:function(t){t.rendNode=this.appendChildPrim(this.createPrim("line",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"lines"),this.updateLine(t)},updateLineEndings:function(t,e){var n,a,l=new i(s.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),h=new i(s.COORDS_BY_USER,t.point2.coords.usrCoords,t.board);return a=o.evaluate(t.visProp.margin),r.calcStraight(t,l,h,a),n=this.getPositionArrowHead(t,l,h,e),this.updateLinePrim(t.rendNode,n.c1.scrCoords[1]+n.d1x,n.c1.scrCoords[2]+n.d1y,n.c2.scrCoords[1]-n.d2x,n.c2.scrCoords[2]-n.d2y,t.board),n},updateArrowSize:function(t,e){var i,s,n;return(s=o.evaluate(t.visProp.firstarrow))&&(i=o.exists(s.size)?o.evaluate(s.size):3,this._setArrowWidth(t.rendNodeTriangleStart,e.sFirst,t.rendNode,i)),(n=o.evaluate(t.visProp.lastarrow))&&(i=o.exists(n.size)?o.evaluate(n.size):3,this._setArrowWidth(t.rendNodeTriangleEnd,e.sLast,t.rendNode,i)),this},updateLine:function(t){var e;e=this.updateLineEndings(t,o.evaluate(t.visProp.strokewidth)),this.makeArrows(t),this._updateVisual(t),this.updateArrowSize(t,e),this.setLineCap(t)},getPositionArrowHead:function(t,e,r,a){var l,h,c,d,u,p,f,m,g,b,y,v=n.eps,C=0,x=0,_=o.evaluate(t.visProp.firstarrow),P=o.evaluate(t.visProp.lastarrow);return u=p=f=m=0,(_||P)&&(l=(h=o.evaluate(t.point1.visProp.size)+o.evaluate(t.point1.visProp.strokewidth))+(c=o.evaluate(t.point2.visProp.size)+o.evaluate(t.point2.visProp.strokewidth)),P&&o.evaluate(t.visProp.touchlastpoint)&&(d=e.distance(s.COORDS_BY_SCREEN,r))>l&&(r=new i(s.COORDS_BY_SCREEN,[r.scrCoords[1]-(f=(r.scrCoords[1]-e.scrCoords[1])*c/d),r.scrCoords[2]-(m=(r.scrCoords[2]-e.scrCoords[2])*c/d)],t.board)),_&&o.evaluate(t.visProp.touchfirstpoint)&&(d=e.distance(s.COORDS_BY_SCREEN,r))>l&&(e=new i(s.COORDS_BY_SCREEN,[e.scrCoords[1]+(u=(r.scrCoords[1]-e.scrCoords[1])*h/d),e.scrCoords[2]+(p=(r.scrCoords[2]-e.scrCoords[2])*h/d)],t.board)),u=p=f=m=0,d=e.distance(s.COORDS_BY_SCREEN,r),o.exists(_.type)&&(g=o.evaluate(_.type)),o.exists(P.type)&&(b=o.evaluate(P.type)),_&&(C=a*(y=o.exists(_.size)?o.evaluate(_.size):3),2===g?(C*=.5,v+=a*y):3===g?(C=a,v+=a):v+=a*y),P&&(x=a*(y=o.exists(P.size)?o.evaluate(P.size):3),2===b?(x*=.5,v+=a*y):3===b?(x=a,v+=a):v+=a*y),_&&"vml"!==t.board.renderer.type&&(d>=v?(u=(r.scrCoords[1]-e.scrCoords[1])*C/d,p=(r.scrCoords[2]-e.scrCoords[2])*C/d):C=0),P&&"vml"!==t.board.renderer.type&&(d>=v?(f=(r.scrCoords[1]-e.scrCoords[1])*x/d,m=(r.scrCoords[2]-e.scrCoords[2])*x/d):x=0)),{c1:e,c2:r,d1x:u,d1y:p,d2x:f,d2y:m,sFirst:C,sLast:x}},setLineCap:function(t){},drawTicks:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path")},updateTicks:function(t){},drawCurve:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path"),t.numberPoints>1&&this.makeArrows(t),this._updateVisual(t,{shadow:!0},!0),this.updateCurve(t)},updateCurve:function(t){var e,i,s,n=o.evaluate(t.visProp.strokewidth);o.evaluate(t.visProp.handdrawing)?this.updatePathPrim(t.rendNode,this.updatePathStringBezierPrim(t),t.board):this.updatePathPrim(t.rendNode,this.updatePathStringPrim(t),t.board),t.numberPoints>1&&(this.makeArrows(t),(i=o.evaluate(t.visProp.firstarrow))&&(e=o.exists(i.size)?o.evaluate(i.size):3,this._setArrowWidth(t.rendNodeTriangleStart,n,t.rendNode,e)),(s=o.evaluate(t.visProp.lastarrow))&&(e=o.exists(s.size)?o.evaluate(s.size):3,this._setArrowWidth(t.rendNodeTriangleEnd,n,t.rendNode,e))),this._updateVisual(t)},drawEllipse:function(t){t.rendNode=this.appendChildPrim(this.createPrim("ellipse",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"ellipse"),this.updateEllipse(t)},updateEllipse:function(t){this._updateVisual(t);var e=t.Radius();e>0&&Math.abs(t.center.coords.usrCoords[0])>n.eps&&!isNaN(e+t.center.coords.scrCoords[1]+t.center.coords.scrCoords[2])&&e*t.board.unitX<2e6&&this.updateEllipsePrim(t.rendNode,t.center.coords.scrCoords[1],t.center.coords.scrCoords[2],e*t.board.unitX,e*t.board.unitY)},drawPolygon:function(t){t.rendNode=this.appendChildPrim(this.createPrim("polygon",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"polygon"),this.updatePolygon(t)},updatePolygon:function(t){this._updateVisual(t,{stroke:!0,dash:!0}),this.updatePolygonPrim(t.rendNode,t)},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){var e,i,s;"html"===o.evaluate(t.visProp.display)&&a.isBrowser&&"no"!==this.type?((e=this.container.ownerDocument.createElement("div")).style.position="absolute",e.className=o.evaluate(t.visProp.cssclass),s=o.evaluate(t.visProp.layer),o.exists(s)||(s=0),i=""===this.container.style.zIndex?0:parseInt(this.container.style.zIndex,10),e.style.zIndex=i+s,this.container.appendChild(e),e.setAttribute("id",this.container.id+"_"+t.id)):e=this.drawInternalText(t),t.rendNode=e,t.htmlStr="",this.updateText(t)},updateText:function(e){var i,s,n,r,a,l=e.plaintext;if(e.visPropCalc.visible)if(this.updateTextStyle(e,!1),"html"===o.evaluate(e.visProp.display)&&"no"!==this.type){if(isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(s=e.coords.scrCoords[1],s=Math.abs(s)<1e6?s:1e6,i="right"===(r=e.getAnchorX())?Math.floor(e.board.canvasWidth-s):"middle"===r?Math.floor(s-.5*e.size[0]):Math.floor(s),e.visPropOld.left!==r+i&&("right"===r?(e.rendNode.style.right=i+"px",e.rendNode.style.left="auto"):(e.rendNode.style.left=i+"px",e.rendNode.style.right="auto"),e.visPropOld.left=r+i),s=e.coords.scrCoords[2]+this.vOffsetText,s=Math.abs(s)<1e6?s:1e6,i="bottom"===(a=e.getAnchorY())?Math.floor(e.board.canvasHeight-s):"middle"===a?Math.floor(s-.5*e.size[1]):Math.floor(s),e.visPropOld.top!==a+i&&("bottom"===a?(e.rendNode.style.top="auto",e.rendNode.style.bottom=i+"px"):(e.rendNode.style.bottom="auto",e.rendNode.style.top=i+"px"),e.visPropOld.top=a+i)),e.htmlStr!==l){try{e.rendNode.innerHTML=l}catch(t){n=e.rendNode.parentNode,e.rendNode.parentNode.removeChild(e.rendNode),e.rendNode.innerHTML=l,n.appendChild(e.rendNode)}if(e.htmlStr=l,o.evaluate(e.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,e.rendNode])}catch(e){t.debug("MathJax (not yet) loaded")}else if(o.evaluate(e.visProp.useasciimathml))try{AMprocessNode(e.rendNode,!1)}catch(e){t.debug("AsciiMathML (not yet) loaded")}}this.transformImage(e,e.transformations)}else this.updateInternalText(e)},_css2js:function(t){var e,i,s,n,r,a=[],l=o.trim(t).replace(/;$/,"").split(";");for(i=l.length,e=0;e<i;++e)""!==o.trim(l[e])&&(r=l[e].split(":"),s=o.trim(r[0].replace(/-([a-z])/gi,(function(t,e){return e.toUpperCase()}))),n=o.trim(r[1]),a.push({key:s,val:n}));return a},updateTextStyle:function(t,e){var i,s,n,r,l,h,c,d,u,p=t.visProp,f=a.isBrowser?p.display:"internal",m=["rendNode","rendNodeTag","rendNodeLabel"],g=m.length,b=["cssdefaultstyle","cssstyle"],y=b.length;if(e?(n=p.highlightstrokecolor,s=p.highlightstrokeopacity,r=p.highlightcssclass):(n=p.strokecolor,s=p.strokeopacity,r=p.cssclass),"no"!==this.type&&("html"===f||"canvas"!==this.type)){for(d=0;d<y;d++)if(""!==(u=o.evaluate(p[(e?"highlight":"")+b[d]]))&&t.visPropOld[b[d]]!==u){for(h=this._css2js(u),l=0;l<g;l++)if(o.exists(t[m[l]]))for(c in h)h.hasOwnProperty(c)&&(t[m[l]].style[h[c].key]=h[c].val);t.visPropOld[b[d]]=u}if(i=o.evaluate(p.fontsize),t.visPropOld.fontsize!==i){t.needsSizeUpdate=!0;try{for(l=0;l<g;l++)o.exists(t[m[l]])&&(t[m[l]].style.fontSize=i+"px")}catch(e){for(l=0;l<g;l++)o.exists(t[m[l]])&&(t[m[l]].style.fontSize=i)}t.visPropOld.fontsize=i}}return this.setObjectTransition(t),"html"===f&&"no"!==this.type?(t.visPropOld.cssclass!==r&&(t.rendNode.className=r,t.visPropOld.cssclass=r,t.needsSizeUpdate=!0),this.setObjectStrokeColor(t,n,s)):this.updateInternalTextStyle(t,n,s),this},updateInternalTextStyle:function(t,e,i){this.setObjectStrokeColor(t,e,i)},drawImage:function(t){},updateImage:function(t){this.updateRectPrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),this.updateImageURL(t),this.transformImage(t,t.transformations),this._updateVisual(t,{stroke:!0,dash:!0},!0)},joinTransforms:function(t,e){var i,s=t.board.origin.scrCoords[1],r=t.board.origin.scrCoords[2],o=t.board.unitX,a=t.board.unitY,l=e.length,h=[[1,0,0],[-s/o,1/o,0],[r/a,0,-1/a]];for(i=0;i<l;i++)h=n.matMatMult(e[i].matrix,h);return n.matMatMult([[1,0,0],[s,o,0],[r,0,-a]],h)},transformImage:function(t,e){},updateImageURL:function(t){},updateImageStyle:function(t,e){t.rendNode.className=o.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass)},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t){},_setArrowWidth:function(t,e,i){},updateEllipsePrim:function(t,e,i,s,n){},updateLinePrim:function(t,e,i,s,n,r){},updatePathPrim:function(t,e,i){},updatePathStringPoint:function(t,e,i){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,i,s,n){},setPropertyPrim:function(t,e,i){},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){if(o.evaluate(t.visProp.draft)){var e=t.board.options.elements.draft.color,i=t.board.options.elements.draft.opacity;this.setObjectTransition(t),t.type===s.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,e,i):(t.elementClass===s.OBJECT_CLASS_POINT?this.setObjectFillColor(t,e,i):this.setObjectFillColor(t,"none",0),this.setObjectStrokeColor(t,e,i),this.setObjectStrokeWidth(t,t.board.options.elements.draft.strokeWidth))}},removeDraft:function(t){this.setObjectTransition(t),t.type===s.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity):(t.type===s.OBJECT_CLASS_POINT&&this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity),this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,i){},setObjectStrokeColor:function(t,e,i){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){var e,i,n,r=t.visProp;if(this.setObjectTransition(t),!r.draft){if(t.type===s.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.highlightstrokecolor,t.borders[e].visProp.highlightstrokeopacity);else t.elementClass===s.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!0):t.type===s.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!0),this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity)):(this.setObjectStrokeColor(t,r.highlightstrokecolor,r.highlightstrokeopacity),this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity));r.highlightstrokewidth&&(i=Math.max(o.evaluate(r.highlightstrokewidth),o.evaluate(r.strokewidth)),this.setObjectStrokeWidth(t,i),t.elementClass===s.OBJECT_CLASS_LINE&&(n=this.updateLineEndings(t,i),this.makeArrows(t),this.updateArrowSize(t,n)))}return this},noHighlight:function(t){var e,i,n,r=t.visProp;if(this.setObjectTransition(t),!o.evaluate(t.visProp.draft)){if(t.type===s.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,r.fillcolor,r.fillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.strokecolor,t.borders[e].visProp.strokeopacity);else t.elementClass===s.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!1):t.type===s.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!1),this.setObjectFillColor(t,r.fillcolor,r.fillopacity)):(this.setObjectStrokeColor(t,r.strokecolor,r.strokeopacity),this.setObjectFillColor(t,r.fillcolor,r.fillopacity));n=o.evaluate(r.strokewidth),this.setObjectStrokeWidth(t,n),t.elementClass===s.OBJECT_CLASS_LINE&&(i=this.updateLineEndings(t,n),this.makeArrows(t),this.updateArrowSize(t,i))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t,e){var i,s,n=function(t){t||(t=window.event),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},r=function(r,l){var h;h=i.createElement("span"),s.appendChild(h),h.appendChild(i.createTextNode(r)),h.style.paddingLeft="7px",h.style.paddingRight="7px",a.addEvent(h,"mouseover",(function(){this.style.backgroundColor=e.highlightfillcolor}),h),a.addEvent(h,"mouseover",(function(){this.style.backgroundColor=e.highlightfillcolor}),h),a.addEvent(h,"mouseout",(function(){this.style.backgroundColor=e.fillcolor}),h),a.addEvent(h,"click",(function(e){return o.bind(l,t)(),!1}),t),a.addEvent(h,"mouseup",n,t),a.addEvent(h,"mousedown",n,t),a.addEvent(h,"touchend",n,t),a.addEvent(h,"touchstart",n,t)};a.isBrowser&&"no"!==this.type&&((s=(i=t.containerObj.ownerDocument).createElement("div")).setAttribute("id",t.containerObj.id+"_navigationbar"),s.style.color=e.strokecolor,s.style.backgroundColor=e.fillcolor,s.style.padding=e.padding,s.style.position=e.position,s.style.fontSize=e.fontsize,s.style.cursor=e.cursor,s.style.zIndex=e.zindex,t.containerObj.appendChild(s),s.style.right=e.right,s.style.bottom=e.bottom,t.attr.showscreenshot&&r(t.attr.screenshot.symbol,(function(){setTimeout((function(){t.renderer.screenshot(t,"",!1)}),330)})),t.attr.showreload&&r("↻",(function(){t.reload()})),t.attr.showcleartraces&&r("⊗",(function(){t.clearTraces()})),t.attr.shownavigation&&(t.attr.showzoom&&(r("–",t.zoomOut),r("o",t.zoom100),r("+",t.zoomIn)),r("←",t.clickLeftArrow),r("↓",t.clickUpArrow),r("↑",t.clickDownArrow),r("→",t.clickRightArrow)))},getElementById:function(t){return o.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+t):""},removeToInsertLater:function(t){var e=t.parentNode,i=t.nextSibling;return e.removeChild(t),function(){i?e.insertBefore(t,i):e.appendChild(t)}},resize:function(t,e){},createTouchpoints:function(t){},showTouchpoint:function(t){},hideTouchpoint:function(t){},updateTouchpoint:function(t,e){},dumpToCanvas:function(t){},screenshot:function(t){}}),t.AbstractRenderer})),define("renderer/no",["jxg","renderer/abstract"],(function(t,e){"use strict";return t.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},t.extend(t.NoRenderer.prototype,{drawPoint:function(t){},updatePoint:function(t){},changePointStyle:function(t){},drawLine:function(t){},updateLine:function(t){},drawTicks:function(t){},updateTicks:function(t){},drawCurve:function(t){},updateCurve:function(t){},drawEllipse:function(t){},updateEllipse:function(t){},drawPolygon:function(t){},updatePolygon:function(t){},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){},updateText:function(t){},updateTextStyle:function(t,e){},updateInternalTextStyle:function(t,e,i){},drawImage:function(t){},updateImage:function(t){},transformImage:function(t,e){},updateImageURL:function(t){},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t){},updateEllipsePrim:function(t,e,i,s,n){},updateLinePrim:function(t,e,i,s,n,r){},updatePathPrim:function(t,e,i){},updatePathStringPoint:function(t,e,i){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,i,s,n){},setPropertyPrim:function(t,e,i){},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){},removeDraft:function(t){},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,i){},setObjectStrokeColor:function(t,e,i){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){},noHighlight:function(t){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t){},getElementById:function(t){return null},resize:function(t,e){},removeToInsertLater:function(){return function(){}}}),t.NoRenderer.prototype=new e,t.NoRenderer})),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],(function(t,e,i,s,n){"use strict";return t.FileReader={parseFileContent:function(e,r,o,a,l){var h=!1;i.exists(a)||(a=!0);try{h=new XMLHttpRequest,"raw"===o.toLowerCase()?h.overrideMimeType("text/plain; charset=iso-8859-1"):h.overrideMimeType("text/xml; charset=iso-8859-1")}catch(t){try{h=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{h=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){h=!1}}}if(h){h.open("GET",e,a),this.cbp="raw"===o.toLowerCase()?function(){4===h.readyState&&r(h.responseText)}:function(){var t=h,e="";4===t.readyState&&(e=!i.exists(t.responseStream)||"PK"!==t.responseText.slice(0,2)&&31!==s.asciiCharCodeAt(t.responseText.slice(0,1),0)?t.responseText:n.decode(jxgBinFileReader(t)),this.parseString(e,r,o,l))},this.cb=i.bind(this.cbp,this),h.onreadystatechange=this.cb;try{h.send(null)}catch(t){throw new Error("JSXGraph: A problem occurred while trying to read '"+e+"'.")}}else t.debug("AJAX not activated!")},parseString:function(e,s,n,r){var o;if(n=n.toLowerCase(),!i.exists(o=t.readers[n]))throw new Error("JSXGraph: There is no reader available for '"+n+"'.");new o(s,e).read(),i.isFunction(r)&&r(s)}},!e.isMetroApp()&&e.isBrowser&&"object"==typeof navigator&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction jxgBinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    jxgBinFileReader = b64String\nEnd Function\n<\/script>\n'),t.FileReader})),define("parser/geonext",["jxg","base/constants","utils/type"],(function(t,e,i){"use strict";return t.GeonextParser={replacePow:function(t){var e,i,s,n,r,o,a,l,h,c,d,u;for(c=(t=t.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),n=-1;c>=0&&c<t.length-1;){if(n===c)throw new Error("JSXGraph: Error while parsing expression '"+t+"'");if(n=c,h=t.slice(0,c),d=t.slice(c+1),")"===h.charAt(h.length-1)){for(e=1,i=h.length-2;i>=0&&e>0;)")"===(s=h.charAt(i))?e++:"("===s&&(e-=1),i-=1;if(0!==e)throw new Error("JSXGraph: Missing '(' in expression");for(r="",a=h.substring(0,i+1),l=i;l>=0&&a.substr(l,1).match(/([\w\.]+)/);)r=RegExp.$1+r,l-=1;r=(r+=h.substring(i+1,h.length)).replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else r="[\\w\\.]+";if(d.match(/^([\w\.]*\()/)){for(e=1,i=RegExp.$1.length;i<d.length&&e>0;)")"===(s=d.charAt(i))?e-=1:"("===s&&(e+=1),i+=1;if(0!==e)throw new Error("JSXGraph: Missing ')' in expression");o=(o=d.substring(0,i)).replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else o="[\\w\\.]+";u=new RegExp("("+r+")\\^("+o+")"),c=(t=t.replace(u,"pow($1,$2)")).indexOf("^")}return t},replaceIf:function(t){var e,i,s,n,r,o,a,l,h,c="",d=null,u=null,p=null;if((s=t.indexOf("If("))<0)return t;for(t=t.replace(/""/g,"0");s>=0;){for(e=t.slice(0,s),i=t.slice(s+3),r=1,n=0,o=-1,a=-1;n<i.length&&r>0;)")"===(l=i.charAt(n))?r-=1:"("===l?r+=1:","===l&&1===r&&(o<0?o=n:a=n),n+=1;if(h=i.slice(0,n-1),i=i.slice(n),o<0)return"";if(a<0)return"";d=h.slice(0,o),u=h.slice(o+1,a),p=h.slice(a+1),c+=e+"(("+(d=this.replaceIf(d))+")?("+(u=this.replaceIf(u))+"):("+(p=this.replaceIf(p))+"))",d=null,u=null,s=(t=i).indexOf("If(")}return c+i},replaceNameById:function(t,e,i){var s,n,r,o,a=0,l=["X","Y","L","V"],h=function(t){return i?"$('"+t+"')":t};for(o=0;o<l.length;o++)for(a=t.indexOf(l[o]+"(");a>=0;)a>=0&&(s=t.indexOf(")",a+2))>=0&&(n=(n=t.slice(a+2,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+2)+(i?"$('":"")+h(r.id)+t.slice(s))),s=t.indexOf(")",a+2),a=t.indexOf(l[o]+"(",s);for(a=t.indexOf("Dist(");a>=0;)a>=0&&(s=t.indexOf(",",a+5))>=0&&(n=(n=t.slice(a+5,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+5)+h(r.id)+t.slice(s))),s=t.indexOf(",",a+5),a=t.indexOf(",",s),(s=t.indexOf(")",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+h(r.id)+t.slice(s))),s=t.indexOf(")",a+1),a=t.indexOf("Dist(",s);for(l=["Deg","Rad"],o=0;o<l.length;o++)for(a=t.indexOf(l[o]+"(");a>=0;)a>=0&&(s=t.indexOf(",",a+4))>=0&&(n=(n=t.slice(a+4,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+4)+h(r.id)+t.slice(s))),s=t.indexOf(",",a+4),a=t.indexOf(",",s),(s=t.indexOf(",",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+h(r.id)+t.slice(s))),s=t.indexOf(",",a+1),a=t.indexOf(",",s),(s=t.indexOf(")",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+h(r.id)+t.slice(s))),s=t.indexOf(")",a+1),a=t.indexOf(l[o]+"(",s);return t},replaceIdByObj:function(t){var e;return(t=(t=(t=(t=(t=t.replace(e,"$('$2').$1()")).replace(e=/(V)\(([\w_]+)\)/g,"$('$2').Value()")).replace(/(Dist)\(([\w_]+),([\w_]+)\)/g,"dist($('$2'), $('$3'))")).replace(/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,"deg($('$2'),$('$3'),$('$4'))")).replace(/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,"rad($('$1'),$('$2'),$('$3'))")).replace(/N\((.+)\)/g,"($1)")},geonext2JS:function(t,e){var i,s,n,r=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],o=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),s=this.replaceNameById(s=t,e),s=this.replaceIf(s),s=this.replacePow(s),s=this.replaceIdByObj(s),n=0;n<r.length;n++)i=new RegExp(["(\\W|^)(",r[n],")"].join(""),"ig"),s=s.replace(i,["$1",o[n]].join(""));return(s=(s=(s=(s=s.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(t,s,n){var r,o,a,l;for(o in i.exists(n)||(n=t.board),r=n.elementsByName)r.hasOwnProperty(o)&&o!==t.name&&(r[o].elementClass===e.OBJECT_CLASS_TEXT&&i.evaluate(r[o].visProp.islabel)||(l=(l=o.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),a=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+l+")(,[\\w\\[\\]'_ ]+)*\\)","g"),s.search(a)>=0&&r[o].addChild(t)))},gxt2jc:function(t,e){return t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),this.replaceNameById(t,e,!0).replace(/True/g,"true").replace(/False/g,"false").replace(/fasle/g,"false")}},t.GeonextParser})),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],(function(t,e,i,s,n,r,o,a,l,h){"use strict";return t.GeometryElement=function(t,i,s,n){var r,o,l;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},a.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(o in this.board=t,this.type=s,this._org_type=s,this.elementClass=n||e.OBJECT_CLASS_OTHER,this.id=i.id,h.exists(r=i.name)||(r=this.board.generateName(this)),""!==r&&(this.board.elementsByName[r]=this),this.name=r,this.needsRegularUpdate=i.needsregularupdate,h.clearVisPropOld(this),l=this.resolveShortcuts(i))l.hasOwnProperty(o)&&this._set(o,l[o]);this.visProp.draft=l.draft&&l.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=h.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},t.extend(t.GeometryElement.prototype,{addChild:function(t){var e,i;for(e in this.childElements[t.id]=t,this.addDescendants(t),t.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(e))for(i in this.descendants[e].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(i)&&(this.descendants[e].ancestors[this.ancestors[i].id]=this.ancestors[i]);for(e in this.ancestors)if(this.ancestors.hasOwnProperty(e))for(i in this.descendants)this.descendants.hasOwnProperty(i)&&(this.ancestors[e].descendants[this.descendants[i].id]=this.descendants[i]);return this},addDescendants:function(t){var e;for(e in this.descendants[t.id]=t,t.childElements)t.childElements.hasOwnProperty(e)&&this.addDescendants(t.childElements[e]);return this},addParents:function(t){var e,i,s;for(i=(s=h.isArray(t)?t:arguments).length,e=0;e<i;++e)h.exists(s[e])&&(h.isId(this.board,s[e])?this.parents.push(s[e]):h.exists(s[e].id)&&this.parents.push(s[e].id));this.parents=h.uniqueArray(this.parents)},setParents:function(t){this.parents=[],this.addParents(t)},removeChild:function(t){return delete this.childElements[t.id],this.removeDescendants(t),delete t.ancestors[this.id],this},removeDescendants:function(t){var e;for(e in delete this.descendants[t.id],t.childElements)t.childElements.hasOwnProperty(e)&&this.removeDescendants(t.childElements[e]);return this},countChildren:function(){var t,e,i=0;for(t in e=this.childElements)e.hasOwnProperty(t)&&t.indexOf("Label")<0&&i++;return i},getName:function(){return this.name},addTransform:function(t){return this},draggable:function(){return this.isDraggable&&!h.evaluate(this.visProp.fixed)&&this.type!==e.OBJECT_TYPE_GLIDER},setPosition:function(t,i){var s,n,r,o,a=[];if(!h.exists(this.parents))return this;for(r=this.parents.length,n=0;n<r;++n)if(s=this.board.select(this.parents[n]),h.isPoint(s)){if(!s.draggable())return this;a.push(s)}for(3===i.length&&(i=i.slice(1)),o=this.board.create("transform",i,{type:"translate"}),(r=a.length)>0?o.applyOnce(a):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(o):this.addTransform(o),n=0;n<r;++n)a[n].type===e.OBJECT_TYPE_GLIDER&&a[n].updateGlider();return this},setPositionDirectly:function(t,s,r){var o=new i(t,s,this.board,!1),a=new i(t,r,this.board,!1),l=n.subtract(o.usrCoords,a.usrCoords);return this.setPosition(e.COORDS_BY_USER,l),this},generatePolynomial:function(){return[]},animate:function(t,e,i){i=i||{};var s,n,r,o=Math.ceil(e/this.board.attr.animationdelay),a=this,c=function(t,e,i,s){var n,l;if(t=parseFloat(t),e=parseFloat(e),!isNaN(t)&&!isNaN(e))for(l=(e-t)/o,a.animationData[i]=[],r=0;r<o;r++)n=t+(r+1)*l,a.animationData[i][o-r-1]=s?Math.floor(n):n};for(s in this.animationData={},t)if(t.hasOwnProperty(s))switch(n=s.toLowerCase()){case"strokecolor":case"fillcolor":!function(t,e,i){var s,n,h,c,d;for(s=l.rgb2hsv(t),h=((n=l.rgb2hsv(e))[0]-s[0])/o,c=(n[1]-s[1])/o,d=(n[2]-s[2])/o,a.animationData[i]=[],r=0;r<o;r++)a.animationData[i][o-r-1]=l.hsv2rgb(s[0]+(r+1)*h,s[1]+(r+1)*c,s[2]+(r+1)*d)}(this.visProp[n],t[s],n);break;case"size":if(!h.isPoint(this))break;c(this.visProp[n],t[s],n,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":c(this.visProp[n],t[s],n,!1)}return this.animationCallback=i.callback,this.board.addAnimation(this),this},update:function(){return h.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(t){return this.prepareUpdate().update().updateVisibility(t).updateRenderer()},setDisplayRendNode:function(t){var e,i,s,n,r;if(void 0===t&&(t=this.visPropCalc.visible),t===this.visPropOld.visible)return this;for(this.board.renderer.display(this,t),i=this.inherits.length,s=0;s<i;s++)if(h.isArray(r=this.inherits[s]))for(n=r.length,e=0;e<n;e++)h.exists(r[e])&&h.exists(r[e].rendNode)&&"inherit"===h.evaluate(r[e].visProp.visible)&&r[e].setDisplayRendNode(t);else h.exists(r)&&h.exists(r.rendNode)&&"inherit"===h.evaluate(r.visProp.visible)&&r.setDisplayRendNode(t);return this.hasLabel&&h.exists(this.label)&&h.exists(this.label.rendNode)&&"inherit"===h.evaluate(this.label.visProp.visible)&&this.label.setDisplayRendNode(t),this},hideElement:function(){return t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),h.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),h.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(t){var e,i,s,n,r,o;if(this.needsUpdate){for(void 0!==t?this.visPropCalc.visible=t:(o=h.evaluate(this.visProp.visible),h.exists(this.hiddenByParent)&&this.hiddenByParent&&(o=!1),"inherit"!==o&&(this.visPropCalc.visible=o)),i=this.inherits.length,s=0;s<i;s++)if(h.isArray(r=this.inherits[s]))for(n=r.length,e=0;e<n;e++)h.exists(r[e])&&"inherit"===h.evaluate(r[e].visProp.visible)&&r[e].prepareUpdate().updateVisibility(this.visPropCalc.visible);else h.exists(r)&&"inherit"===h.evaluate(r.visProp.visible)&&r.prepareUpdate().updateVisibility(this.visPropCalc.visible);h.exists(this.label)&&h.exists(this.label.visProp)&&h.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(t,e){t=t.toLocaleLowerCase(),this.visProp.hasOwnProperty(t)&&t.indexOf("color")>=0&&h.isString(e)&&9===e.length&&"#"===e.charAt(0)?(e=l.rgba2rgbo(e),this.visProp[t]=e[0],this.visProp[t.replace("color","opacity")]=e[1]):this.visProp[t]=e},resolveShortcuts:function(t){var e,i;for(e in r.shortcuts)if(r.shortcuts.hasOwnProperty(e)&&h.exists(t[e]))for(i=0;i<r.shortcuts[e].length;i++)h.exists(t[r.shortcuts[e][i]])||(t[r.shortcuts[e][i]]=t[e]);return t},setLabel:function(t){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(t)},setLabelText:function(t){return h.exists(this.label)&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(t)),this},setName:function(t){t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"slider"!==this.elType&&this.setLabelText(t),this.setAttribute({name:t})},setProperty:function(){t.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(i){var s,n,r,o,a,c,d,u,p,f={};for(s=0;s<arguments.length;s++)h.isString(c=arguments[s])?(u=c.split(":"),f[h.trim(u[0])]=h.trim(u[1])):h.isArray(c)?f[c[0]]=c[1]:t.extend(f,c);for(s in f=this.resolveShortcuts(f))if(f.hasOwnProperty(s)){if(o=s.replace(/\s+/g,"").toLowerCase(),p=this.visProp[o],h.isObject(a=f[s])&&h.exists(this.visProp[o])){if(this.visProp[o]=h.merge(this.visProp[o],a),this.type===e.OBJECT_TYPE_TICKS&&h.exists(this.labels))for(r=this.labels.length,n=0;n<r;n++)this.labels[n].setAttribute(a);continue}switch(o){case"name":p=this.name,delete this.board.elementsByName[this.name],this.name=a,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"===a||!1===a),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":d=(a=l.rgba2rgbo(a))[1],a=a[0],0===d&&h.exists(this.label)&&this.hasLabel&&this.label.hideElement(),h.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=a,this.board.renderer.setObjectStrokeColor(this.label,a,d)),this.elementClass===e.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=a,this.visProp.strokeopacity=d,this.board.renderer.setObjectStrokeColor(this,a,d));break;case"infoboxtext":this.infoboxText=!!h.isString(a)&&a;break;case"visible":this.visProp.visible="false"!==a&&("true"===a||a),this.setDisplayRendNode(h.evaluate(this.visProp.visible));break;case"face":h.isPoint(this)&&(this.visProp.face=a,this.board.renderer.changePointStyle(this));break;case"trace":"false"===a||!1===a?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=a,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":a=l.rgba2rgbo(a),this.visProp.gradientsecondcolor=a[0],this.visProp.gradientsecondopacity=a[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=a,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=a,h.evaluate(a)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=a;break;case"radius":this.type!==e.OBJECT_TYPE_ANGLE&&this.type!==e.OBJECT_TYPE_SECTOR||this.setRadius(a);break;case"rotate":(this.elementClass===e.OBJECT_CLASS_TEXT&&"internal"===h.evaluate(this.visProp.display)||this.type===e.OBJECT_TYPE_IMAGE)&&this.addRotation(a);break;case"ticksdistance":this.type===e.OBJECT_TYPE_TICKS&&h.isNumber(a)&&(this.ticksFunction=this.makeTicksFunction(a));break;case"generatelabelvalue":this.type===e.OBJECT_TYPE_TICKS&&h.isFunction(a)&&(this.generateLabelValue=a);break;case"onpolygon":this.type===e.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!a);break;case"disabled":h.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!a);break;case"checked":h.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!a);break;case"maxlength":h.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!a);break;default:h.exists(this.visProp[o])&&(!t.Validator[o]||t.Validator[o]&&t.Validator[o](a)||t.Validator[o]&&h.isFunction(a)&&t.Validator[o](a()))&&(a=(!a.toLowerCase||"false"!==a.toLowerCase())&&a,this._set(o,a))}this.triggerEventHandlers(["attribute:"+o],[p,a,this])}return this.triggerEventHandlers(["attribute"],[f,this]),h.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){t.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(t){var e;switch(t=t.toLowerCase()){case"needsregularupdate":e=this.needsRegularUpdate;break;case"labelcolor":e=this.label.visProp.strokecolor;break;case"infoboxtext":e=this.infoboxText;break;case"withlabel":e=this.hasLabel;break;default:e=this.visProp[t]}return e},setDash:function(t){return this.setAttribute({dash:t}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new i(e.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new i(e.COORDS_BY_USER,[0,0],this.board)},setArrow:function(t,i){return this.visProp.firstarrow=t,this.visProp.lastarrow=i,i&&(this.type=e.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var t=h.evaluate(this.visProp.gradient);"linear"!==t&&"radial"!==t||this.board.renderer.setGradient(this)},createLabel:function(){var e,i=this;return t.elements.text?((e=h.deepCopy(this.visProp.label,null)).id=this.id+"Label",e.isLabel=!0,e.anchor=this,e.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=t.elements.text(this.board,[0,0,function(){return h.isFunction(i.name)?i.name():i.name}],e),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):t.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(t){return t=h.def(t,!1),!h.evaluate(this.visProp.highlight)||this.highlighted&&!t||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var t;for(t in this.traces)this.traces.hasOwnProperty(t)&&this.board.renderer.remove(this.traces[t]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=s.normalize(this.stdform),this},toJSON:function(){var t,e,i=['{"name":',this.name];for(e in i.push(', "id":'+this.id),t=[],this.visProp)this.visProp.hasOwnProperty(e)&&h.exists(this.visProp[e])&&t.push('"'+e+'":'+this.visProp[e]);return i.push(', "visProp":{'+t.toString()+"}"),i.push("}"),i.join("")},addRotation:function(t){var i,s,n,r,o,a=this;return(this.elementClass===e.OBJECT_CLASS_TEXT&&"internal"===h.evaluate(this.visProp.display)||this.type===e.OBJECT_TYPE_IMAGE)&&0!==t&&(i=this.board.create("transform",[function(){return-a.X()},function(){return-a.Y()}],{type:"translate"}),s=this.board.create("transform",[function(){return a.X()},function(){return a.Y()}],{type:"translate"}),n=this.board.create("transform",[function(){return a.board.unitX/a.board.unitY},function(){return 1}],{type:"scale"}),r=this.board.create("transform",[function(){return a.board.unitY/a.board.unitX},function(){return 1}],{type:"scale"}),o=this.board.create("transform",[t*Math.PI/180],{type:"rotate"}),i.bindTo(this),n.bindTo(this),o.bindTo(this),r.bindTo(this),s.bindTo(this)),this},highlightStrokeColor:function(e){return t.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:e}),this},strokeColor:function(e){return t.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:e}),this},strokeWidth:function(e){return t.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:e}),this},fillColor:function(e){return t.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:e}),this},highlightFillColor:function(e){return t.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:e}),this},labelColor:function(e){return t.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:e}),this},dash:function(e){return t.deprecated("dash()","setAttribute()"),this.setAttribute({dash:e}),this},visible:function(e){return t.deprecated("visible()","setAttribute()"),this.setAttribute({visible:e}),this},shadow:function(e){return t.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:e}),this},getType:function(){return this.elType},getParents:function(){return h.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var t,e=h.deepCopy(this.visProp),i=[],s=i.length;for(e.id=this.id,e.name=this.name,t=0;t<s;t++)delete e[i[t]];return e},hasPoint:function(t,e){return!1},handleSnapToGrid:function(t,i){var s,n,r,o,a=h.evaluate(this.visProp.snapsizex),l=h.evaluate(this.visProp.snapsizey);return h.exists(this.coords)?((h.evaluate(this.visProp.snaptogrid)||!0===t)&&(s=this.coords.usrCoords[1],n=this.coords.usrCoords[2],a<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(a=(r=this.board.defaultAxes.x.defaultTicks).ticksDelta*(h.evaluate(r.visProp.minorticks)+1)),l<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(l=(r=this.board.defaultAxes.y.defaultTicks).ticksDelta*(h.evaluate(r.visProp.minorticks)+1)),a>0&&l>0&&(o=this.board.getBoundingBox(),s=Math.round(s/a)*a,n=Math.round(n/l)*l,i||(s<o[0]?s+=a:s>o[2]&&(s-=a),n<o[3]?n+=l:n>o[1]&&(n-=l)),this.coords.setCoordinates(e.COORDS_BY_USER,[s,n]))),this):this},addEvent:t.shortcut(t.GeometryElement.prototype,"on"),removeEvent:t.shortcut(t.GeometryElement.prototype,"off"),__evt__over:function(t){},__evt__mouseover:function(t){},__evt__out:function(t){},__evt__mouseout:function(t){},__evt__move:function(t){},__evt__mousemove:function(t){},__evt__drag:function(t){},__evt__mousedrag:function(t){},__evt__touchdrag:function(t){},__evt__down:function(t){},__evt__mousedown:function(t){},__evt__touchdown:function(t){},__evt__up:function(t){},__evt__mouseup:function(t){},__evt__touchup:function(t){},__evt__attribute:function(t,e){},__evt__attribute_:function(t,e,i){},__evt:function(){}}),t.GeometryElement})),define("base/transformation",["jxg","base/constants","math/math","utils/type"],(function(t,e,i,s){"use strict";return t.Transformation=function(t,i,s){this.elementClass=e.OBJECT_CLASS_OTHER,this.type=e.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=t,this.isNumericMatrix=!1,this.setMatrix(t,i,s),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},t.Transformation.prototype={},t.extend(t.Transformation.prototype,{update:function(){return this},setMatrix:function(t,e,n){var r;for(this.isNumericMatrix=!0,r=0;r<n.length;r++)if("number"!=typeof n[r]){this.isNumericMatrix=!1;break}if("translate"===e){if(2!==n.length)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if("scale"===e){if(2!==n.length)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===e)n.length<4&&(n[0]=t.select(n[0])),2===n.length&&(n[1]=t.select(n[1])),4===n.length&&(this.evalParam=s.createEvalFunction(t,n,4)),this.update=function(){var t,e,s,r,o,a,l,h;1===n.length?l=n[0].stdform:2===n.length?l=i.crossProduct(n[1].coords.usrCoords,n[0].coords.usrCoords):4===n.length&&(l=i.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),r=(h=[-(s=l[0])*(t=l[1]),-s*(e=l[2]),t*t+e*e])[0]/h[2],o=h[1]/h[2],this.matrix[1][1]=((t=-l[2])*t-(e=l[1])*e)/(a=h[2]),this.matrix[1][2]=2*t*e/a,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=r*(1-this.matrix[1][1])-o*this.matrix[1][2],this.matrix[2][0]=o*(1-this.matrix[2][2])-r*this.matrix[2][1]};else if("rotate"===e)3===n.length?this.evalParam=s.createEvalFunction(t,n,3):n.length>0&&n.length<=2&&(this.evalParam=s.createEvalFunction(t,n,1),2!==n.length||s.isArray(n[1])||(n[1]=t.select(n[1]))),this.update=function(){var t,e,i=this.evalParam(0),r=Math.cos(i),o=Math.sin(i);this.matrix[1][1]=r,this.matrix[1][2]=-o,this.matrix[2][1]=o,this.matrix[2][2]=r,n.length>1&&(3===n.length?(t=this.evalParam(1),e=this.evalParam(2)):s.isArray(n[1])?(t=n[1][0],e=n[1][1]):(t=n[1].X(),e=n[1].Y()),this.matrix[1][0]=t*(1-r)+e*o,this.matrix[2][0]=e*(1-r)-t*o)};else if("shear"===e){if(2!==n.length)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if("generic"===e){if(9!==n.length)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=s.createEvalFunction(t,n,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(t,e){return this.update(),s.exists(e)?i.matVecMult(this.matrix,t.initialCoords.usrCoords):i.matVecMult(this.matrix,t.coords.usrCoords)},applyOnce:function(t){var n,r,o;for(s.isArray(t)||(t=[t]),r=t.length,o=0;o<r;o++)this.update(),n=i.matVecMult(this.matrix,t[o].coords.usrCoords),t[o].coords.setCoordinates(e.COORDS_BY_USER,n)},bindTo:function(t){var e,i;if(s.isArray(t))for(i=t.length,e=0;e<i;e++)t[e].transformations.push(this);else t.transformations.push(this)},setProperty:function(e){t.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(t){},melt:function(t){var e,i,s,n,r,o,a=[];for(i=t.matrix.length,s=this.matrix[0].length,e=0;e<i;e++)a[e]=[];for(this.update(),t.update(),e=0;e<i;e++)for(o=0;o<s;o++){for(r=0,n=0;n<i;n++)r+=t.matrix[e][n]*this.matrix[n][o];a[e][o]=r}return this.update=function(){var t=this.matrix.length,i=this.matrix[0].length;for(e=0;e<t;e++)for(o=0;o<i;o++)this.matrix[e][o]=a[e][o]},this},getParents:function(){var t=[[].concat.apply([],this.matrix)];return 0!==this.parents.length&&(t=this.parents),t}}),t.createTransform=function(e,i,s){return new t.Transformation(e,s.type,i)},t.registerElement("transform",t.createTransform),{Transformation:t.Transformation,createTransform:t.createTransform}})),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],(function(t,e,i,s,n,r,o,a,l,h,c,d){"use strict";return t.CoordsElement=function(t,e){var i;for(c.exists(t)||(t=[1,0,0]),i=0;i<t.length;++i)t[i]=parseFloat(t[i]);this.coords=new o(a.COORDS_BY_USER,t,this.board),this.initialCoords=new o(a.COORDS_BY_USER,t,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=c.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),c.exists(this.element)&&this.addAnchor(t,e),this.isDraggable=!0},t.extend(t.CoordsElement.prototype,{updateCoords:function(t){return this.needsUpdate?(c.exists(t)||(t=!1),this.type===a.OBJECT_TYPE_GLIDER&&(t?this.updateGliderFromParent():this.updateGlider()),c.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var t,e,n,r,l,h,d,u,p,f,m,g,b,y,v,C,x,_=2*Math.PI,P=!1,S=this.slideObject;if(this.needsUpdateFromParent=!1,S.elementClass===a.OBJECT_CLASS_CIRCLE)c.evaluate(this.visProp.isgeonext)&&(_=1),v=s.projectPointToCircle(this,S,this.board),C=s.rad([S.center.X()+1,S.center.Y()],S.center,this)/_;else if(S.elementClass===a.OBJECT_CLASS_LINE){if(this.onPolygon){if(r=(n=S.point2.coords.usrCoords)[t=1]-(e=S.point1.coords.usrCoords)[t],Math.abs(r)<i.eps&&(r=n[t=2]-e[t]),d=s.projectPointToLine(this,S,this.board),h=S.parentPolygon,(u=(d.usrCoords[t]-e[t])/r)<0){for(t=0;t<h.borders.length;t++)if(S===h.borders[t]){S=h.borders[(t-1+h.borders.length)%h.borders.length];break}}else if(u>1)for(t=0;t<h.borders.length;t++)if(S===h.borders[t]){S=h.borders[(t+1+h.borders.length)%h.borders.length];break}S.id!==this.slideObject.id&&(this.slideObject=S)}(r=(e=S.point1.coords).distance(a.COORDS_BY_USER,n=S.point2.coords))<i.eps?(v=e,P=!0,C=0):(v=s.projectPointToLine(this,S,this.board),e=e.usrCoords.slice(0),n=n.usrCoords.slice(0),Math.abs(n[0])<i.eps?(r=n[t=1],Math.abs(r)<i.eps&&(r=n[t=2]),C=((r=(v.usrCoords[t]-e[t])/r)>=0?1:-1)*(r=Math.abs(r))/(r+1)):Math.abs(e[0])<i.eps?(r=e[t=1],Math.abs(r)<i.eps&&(r=e[t=2]),C=(r=(v.usrCoords[t]-n[t])/r)<0?(1-2*r)/(1-r):1/(r+1)):(r=n[t=1]-e[t],Math.abs(r)<i.eps&&(r=n[t=2]-e[t]),C=(v.usrCoords[t]-e[t])/r)),x=c.evaluate(this.visProp.snapwidth),c.evaluate(x)>0&&Math.abs(this._smax-this._smin)>=i.eps&&(l=(C=Math.max(Math.min(C,1),0))*(this._smax-this._smin)+this._smin,C=((l=Math.round(l/x)*x)-this._smin)/(this._smax-this._smin),this.update(!0)),e=S.point1.coords,!c.evaluate(S.visProp.straightfirst)&&Math.abs(e.usrCoords[0])>i.eps&&C<0&&(v=e,P=!0,C=0),n=S.point2.coords,!c.evaluate(S.visProp.straightlast)&&Math.abs(n.usrCoords[0])>i.eps&&C>1&&(v=n,P=!0,C=1)}else S.type===a.OBJECT_TYPE_TURTLE?(this.updateConstraint(),v=s.projectPointToTurtle(this,S,this.board),C=this.position):S.elementClass===a.OBJECT_CLASS_CURVE?S.type===a.OBJECT_TYPE_ARC||S.type===a.OBJECT_TYPE_SECTOR?(v=s.projectPointToCircle(this,S,this.board),m=s.rad(S.radiuspoint,S.center,this),p=0,f=s.rad(S.radiuspoint,S.center,S.anglepoint),C=m,("minor"===(x=c.evaluate(S.visProp.selection))&&f>Math.PI||"major"===x&&f<Math.PI)&&(p=f,f=2*Math.PI),(m<p||m>f)&&(C=f,(m<p&&m>.5*p||m>f&&m>.5*f+Math.PI)&&(C=p),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),_=f-p,this.visProp.isgeonext&&(_=1),Math.abs(_)>i.eps&&(C/=_)):(this.updateConstraint(),S.transformations.length>0?(S.updateTransformMatrix(),y=i.inverse(S.transformMat),b=i.matVecMult(y,this.coords.usrCoords),g=new o(a.COORDS_BY_USER,b,this.board).usrCoords,v=(b=s.projectCoordsToCurve(g[1],g[2],this.position||0,S,this.board))[0],C=b[1]):(v=s.projectPointToCurve(this,S,this.board),C=this.position)):c.isPoint(S)&&(v=s.projectPointToPoint(this,S,this.board),C=this.position);this.coords.setCoordinates(a.COORDS_BY_USER,v.usrCoords,P),this.position=C},updateGliderFromParent:function(){var t,e,n,r,o,l,h,d,u,p=this.slideObject,f=2*Math.PI;this.needsUpdateFromParent?(p.elementClass===a.OBJECT_CLASS_CIRCLE?(n=p.Radius(),c.evaluate(this.visProp.isgeonext)&&(f=1),o=[p.center.X()+n*Math.cos(this.position*f),p.center.Y()+n*Math.sin(this.position*f)]):p.elementClass===a.OBJECT_CLASS_LINE?(e=p.point2.coords.usrCoords,0===(t=p.point1.coords.usrCoords)[0]&&0===t[1]&&0===t[2]||0===e[0]&&0===e[1]&&0===e[2]?o=[0,0,0]:Math.abs(e[0])<i.eps?(r=Math.min(Math.abs(this.position),1-i.eps),r/=1-r,this.position<0&&(r=-r),o=[t[0]+r*e[0],t[1]+r*e[1],t[2]+r*e[2]]):Math.abs(t[0])<i.eps?(r=Math.max(this.position,i.eps),r=Math.min(r,2-i.eps),o=[e[0]+(r=r>1?(r-1)/(r-2):(1-r)/r)*t[0],e[1]+r*t[1],e[2]+r*t[2]]):o=[t[0]+(r=this.position)*(e[0]-t[0]),t[1]+r*(e[1]-t[1]),t[2]+r*(e[2]-t[2])]):p.type===a.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(a.COORDS_BY_USER,[p.Z(this.position),p.X(this.position),p.Y(this.position)]),this.updateConstraint(),o=s.projectPointToTurtle(this,p,this.board).usrCoords):p.elementClass===a.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(a.COORDS_BY_USER,[p.Z(this.position),p.X(this.position),p.Y(this.position)]),p.type===a.OBJECT_TYPE_ARC||p.type===a.OBJECT_TYPE_SECTOR?(l=s.rad([p.center.X()+1,p.center.Y()],p.center,p.radiuspoint),h=0,u=s.rad(p.radiuspoint,p.center,p.anglepoint),("minor"===p.visProp.selection&&u>Math.PI||"major"===p.visProp.selection&&u<Math.PI)&&(h=u,u=2*Math.PI),f=u-h,c.evaluate(this.visProp.isgeonext)&&(f=1),((d=this.position*f)<h||d>u)&&(((d=u)<h&&d>.5*h||d>u&&d>.5*u+Math.PI)&&(d=h),this.position=d,Math.abs(f)>i.eps&&(this.position/=f)),n=p.Radius(),o=[p.center.X()+n*Math.cos(this.position*f+l),p.center.Y()+n*Math.sin(this.position*f+l)]):(this.updateConstraint(),o=s.projectPointToCurve(this,p,this.board).usrCoords)):c.isPoint(p)&&(o=s.projectPointToPoint(this,p,this.board).usrCoords),this.coords.setCoordinates(a.COORDS_BY_USER,o,!1)):this.needsUpdateFromParent=!0},updateRendererGeneric:function(t){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>i.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[t](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(t){return this.isReal&&t.isReal?this.coords.distance(a.COORDS_BY_USER,t.coords):NaN},snapToGrid:function(t){return this.handleSnapToGrid(t)},handleSnapToPoints:function(t){var e,i,n,r,o,l,h,d,u=0,p=1/0,f=null,m=c.evaluate(this.visProp.ignoredsnaptopoints),g=!1;if(r=this.board.objectsList.length,m&&(h=m.length),c.evaluate(this.visProp.snaptopoints)||t){for(o=c.evaluate(this.visProp.attractorunit),l=c.evaluate(this.visProp.attractordistance),e=0;e<r;e++){if(i=this.board.objectsList[e],m){for(g=!1,d=0;d<h;d++)if(i==this.board.select(m[d])){g=!0;break}if(g)continue}c.isPoint(i)&&i!==this&&i.visPropCalc.visible&&(u=(n=s.projectPointToPoint(this,i,this.board)).distance("screen"===o?a.COORDS_BY_SCREEN:a.COORDS_BY_USER,this.coords))<l&&u<p&&(p=u,f=n)}null!==f&&this.coords.setCoordinates(a.COORDS_BY_USER,f.usrCoords)}return this},snapToPoints:function(t){return this.handleSnapToPoints(t)},handleAttractors:function(){var t,e,i,n,r=0,l=c.evaluate(this.visProp.attractorunit),h=c.evaluate(this.visProp.attractordistance),d=c.evaluate(this.visProp.snatchdistance),u=c.evaluate(this.visProp.attractors),p=u.length;if(0!==h){for(t=0;t<p;t++)if(e=this.board.select(u[t]),c.exists(e)&&e!==this){if(c.isPoint(e)?i=s.projectPointToPoint(this,e,this.board):e.elementClass===a.OBJECT_CLASS_LINE?(n=s.projectCoordsToSegment(this.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords),i=!c.evaluate(e.visProp.straightfirst)&&n[1]<0?e.point1.coords:!c.evaluate(e.visProp.straightlast)&&n[1]>1?e.point2.coords:new o(a.COORDS_BY_USER,n[0],this.board)):e.elementClass===a.OBJECT_CLASS_CIRCLE?i=s.projectPointToCircle(this,e,this.board):e.elementClass===a.OBJECT_CLASS_CURVE?i=s.projectPointToCurve(this,e,this.board):e.type===a.OBJECT_TYPE_TURTLE&&(i=s.projectPointToTurtle(this,e,this.board)),(r=i.distance("screen"===l?a.COORDS_BY_SCREEN:a.COORDS_BY_USER,this.coords))<h){this.type===a.OBJECT_TYPE_GLIDER&&this.slideObject===e||this.makeGlider(e);break}e===this.slideObject&&r>=d&&this.popSlideObject()}return this}},setPositionDirectly:function(t,e){var s,n,l,h,d=this.coords;if(this.relativeCoords)return n=new o(t,e,this.board),c.evaluate(this.visProp.islabel)?(l=r.subtract(n.scrCoords,d.scrCoords),this.relativeCoords.scrCoords[1]+=l[1],this.relativeCoords.scrCoords[2]+=l[2]):(l=r.subtract(n.usrCoords,d.usrCoords),this.relativeCoords.usrCoords[1]+=l[1],this.relativeCoords.usrCoords[2]+=l[2]),this;for(this.coords.setCoordinates(t,e),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),s=this.transformations.length-1;s>=0;s--)t===a.COORDS_BY_SCREEN?h=new o(t,e,this.board).usrCoords:(2===e.length&&(e=[1].concat(e)),h=e),this.initialCoords.setCoordinates(a.COORDS_BY_USER,i.matVecMult(i.inverse(this.transformations[s].matrix),h));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===a.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(t,e){var i;return e=new o(t,e,this.board),i=this.board.create("transform",e.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(i):this.addTransform(this,i),this.prepareUpdate().update(),this},setPosition:function(t,e){return this.setPositionDirectly(t,e)},setGliderPosition:function(t){return this.type===a.OBJECT_TYPE_GLIDER&&(this.position=t,this.board.update()),this},makeGlider:function(e){var i,s,n,r=this.board.select(e),o=!1;if(r.type===a.OBJECT_TYPE_POLYGON){for(i=Number.MAX_VALUE,s=0;s<r.borders.length;s++)(n=t.Math.Geometry.distPointLine(this.coords.usrCoords,r.borders[s].stdform))<i&&(i=n,e=r.borders[s]);r=this.board.select(e),o=!0}if(!c.exists(r))throw new Error("JSXGraph: slide object undefined.");if(r.type===a.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(e),this.slideObjects.push(this.slideObject),this.addParents(e),this.type=a.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=o,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),0===this.slideObjects.length?(this.type=this._org_type,this.type===a.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===a.OBJECT_CLASS_TEXT?this.elType="text":this.type===a.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var t,e;if(this.type!==a.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===a.OBJECT_CLASS_POINT&&(this.type=a.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(t in this.board.objects)this.board.objects.hasOwnProperty(t)&&(e=this.board.objects[t]).descendants&&(delete e.descendants[this.id],delete e.childElements[this.id],this.hasLabel&&(delete e.descendants[this.label.id],delete e.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===a.OBJECT_CLASS_POINT?(this.type=a.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===a.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===a.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(t){var e,i,s=[],n=["X","Y"];for(this.elementClass===a.OBJECT_CLASS_POINT&&(this.type=a.OBJECT_TYPE_CAS),this.isDraggable=!1,e=0;e<t.length;e++)c.isString(i=t[e])?(s[e]=this.board.jc.snippet(i,!0,null,!0),2===t.length&&(this[n[e]+"jc"]=t[e])):c.isFunction(i)?s[e]=i:c.isNumber(i)?s[e]=function(t){return function(){return t}}(i):c.isObject(i)&&c.isFunction(i.Value)&&(s[e]=function(t){return function(){return t.Value()}}(i)),s[e].origin=i;return 1===t.length?this.updateConstraint=function(){var t=s[0]();c.isArray(t)?this.coords.setCoordinates(a.COORDS_BY_USER,t):this.coords=t}:2===t.length?(this.XEval=s[0],this.YEval=s[1],this.setParents([s[0].origin,s[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=s[0],this.XEval=s[1],this.YEval=s[2],this.setParents([s[0].origin,s[1].origin,s[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(t,e){this.relativeCoords=e?new o(a.COORDS_BY_SCREEN,t.slice(0,2),this.board):new o(a.COORDS_BY_USER,t,this.board),this.element.addChild(this),e&&this.addParents(this.element),this.XEval=function(){var t,e,i=c.evaluate(this.visProp.offset);return c.evaluate(this.visProp.islabel)?(t=parseFloat(i[0]),e=this.element.getLabelAnchor(),new o(a.COORDS_BY_SCREEN,[t+this.relativeCoords.scrCoords[1]+e.scrCoords[1],0],this.board).usrCoords[1]):(e=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+e.usrCoords[1])},this.YEval=function(){var t,e,i=c.evaluate(this.visProp.offset);return c.evaluate(this.visProp.islabel)?(t=-parseFloat(i[1]),e=this.element.getLabelAnchor(),new o(a.COORDS_BY_SCREEN,[0,t+this.relativeCoords.scrCoords[2]+e.scrCoords[2]],this.board).usrCoords[2]):(e=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+e.usrCoords[2])},this.ZEval=c.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new o(a.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var t;if(0===this.transformations.length)return this;for(t=0;t<this.transformations.length;t++)this.transformations[t].update();return this},addTransform:function(t,e){var i,s=c.isArray(e)?e:[e],n=s.length;for(0===this.transformations.length&&(this.baseElement=t),i=0;i<n;i++)this.transformations.push(s[i]);return this},startAnimation:function(t,e){var i=this;return this.type!==a.OBJECT_TYPE_GLIDER||c.exists(this.intervalCode)||(this.intervalCode=window.setInterval((function(){i._anim(t,e)}),250),c.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return c.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(t,e,i){i=i||{};var s,r,o,l,h,d=[],u=[],p=e/this.board.attr.animationdelay,f=function(e,i){return function(){return t[e][i]}};if(c.isArray(t)){for(o=t.length,s=0;s<o;s++)u[s]=c.isPoint(t[s])?t[s]:{elementClass:a.OBJECT_CLASS_POINT,X:f(s,0),Y:f(s,1)};if(0===(e=e||0))return this.setPosition(a.COORDS_BY_USER,[u[u.length-1].X(),u[u.length-1].Y()]),this.board.update(this);if(!c.exists(i.interpolate)||i.interpolate)for(r=n.Neville(u),s=0;s<p;s++)d[s]=[],d[s][0]=r[0]((p-s)/p*r[3]()),d[s][1]=r[1]((p-s)/p*r[3]());else{for(o=t.length-1,s=0;s<p;++s)h=s/p*o-(l=Math.floor(s/p*o)),d[s]=[],d[s][0]=(1-h)*u[l].X()+h*u[l+1].X(),d[s][1]=(1-h)*u[l].Y()+h*u[l+1].Y();d.push([u[o].X(),u[o].Y()]),d.reverse()}this.animationPath=d}else c.isFunction(t)&&(this.animationPath=t,this.animationStart=(new Date).getTime());return this.animationCallback=i.callback,this.board.addAnimation(this),this},moveTo:function(t,e,s){s=s||{},t=new o(a.COORDS_BY_USER,t,this.board);var n,r=Math.ceil(e/this.board.attr.animationdelay),l=[],h=this.coords.usrCoords[1],d=this.coords.usrCoords[2],u=t.usrCoords[1]-h,p=t.usrCoords[2]-d,f=function(t){return s.effect&&"<>"===s.effect?Math.pow(Math.sin(t/r*Math.PI/2),2):t/r};if(!c.exists(e)||0===e||Math.abs(t.usrCoords[0]-this.coords.usrCoords[0])>i.eps)return this.setPosition(a.COORDS_BY_USER,t.usrCoords),this.board.update(this);if(!c.exists(s.callback)&&Math.abs(u)<i.eps&&Math.abs(p)<i.eps)return this;for(n=r;n>=0;n--)l[r-n]=[t.usrCoords[0],h+u*f(n),d+p*f(n)];return this.animationPath=l,this.animationCallback=s.callback,this.board.addAnimation(this),this},visit:function(t,e,i){t=new o(a.COORDS_BY_USER,t,this.board);var s,n,r,l=this.board.attr.animationdelay,h=[],d=this.coords.usrCoords[1],u=this.coords.usrCoords[2],p=t.usrCoords[1]-d,f=t.usrCoords[2]-u,m=function(t){var e=t<r/2?2*t/r:2*(r-t)/r;return i.effect&&"<>"===i.effect?Math.pow(Math.sin(e*Math.PI/2),2):e};for(c.isNumber(i)?i={repeat:i}:c.exists((i=i||{}).repeat)||(i.repeat=1),r=Math.ceil(e/(l*i.repeat)),n=0;n<i.repeat;n++)for(s=r;s>=0;s--)h[n*(r+1)+r-s]=[t.usrCoords[0],d+p*m(s),u+f*m(s)];return this.animationPath=h,this.animationCallback=i.callback,this.board.addAnimation(this),this},_anim:function(t,e){var i,n,r,o,l,h,c,d,u=1;return this.intervalCount+=1,this.intervalCount>e&&(this.intervalCount=0),this.slideObject.elementClass===a.OBJECT_CLASS_LINE?(i=this.slideObject.point1.coords.distance(a.COORDS_BY_SCREEN,this.slideObject.point2.coords),(n=this.slideObject.getSlope())!==1/0?(l=Math.atan(n),r=Math.round(this.intervalCount/e*i*Math.cos(l)),o=Math.round(this.intervalCount/e*i*Math.sin(l))):(r=0,o=Math.round(this.intervalCount/e*i)),t<0?(h=this.slideObject.point2,this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0?u=-1:this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0&&(u=-1)):(h=this.slideObject.point1,this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0?u=-1:this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0&&(u=-1)),this.coords.setCoordinates(a.COORDS_BY_SCREEN,[h.coords.scrCoords[1]+u*r,h.coords.scrCoords[2]+u*o])):this.slideObject.elementClass===a.OBJECT_CLASS_CURVE?(c=t>0?Math.round(this.intervalCount/e*this.board.canvasWidth):Math.round((e-this.intervalCount)/e*this.board.canvasWidth),this.coords.setCoordinates(a.COORDS_BY_SCREEN,[c,0]),this.coords=s.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===a.OBJECT_CLASS_CIRCLE&&(l=t<0?this.intervalCount/e*2*Math.PI:(e-this.intervalCount)/e*2*Math.PI,d=this.slideObject.Radius(),this.coords.setCoordinates(a.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+d*Math.cos(l),this.slideObject.center.coords.usrCoords[2]+d*Math.sin(l)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var t=[this.Z(),this.X(),this.Y()];return 0!==this.parents.length&&(t=this.parents),this.type===a.OBJECT_TYPE_GLIDER&&(t=[this.X(),this.Y(),this.slideObject.id]),t}}),t.CoordsElement.create=function(t,e,i,s,n,r){var o,a,l=!1;for(a=0;a<i.length;a++)(c.isFunction(i[a])||c.isString(i[a]))&&(l=!0);if(l)(o=new t(e,[0,0],s,n,r)).addConstraint(i);else if(c.isNumber(i[0])&&c.isNumber(i[1]))o=new t(e,i,s,n,r),c.exists(s.slideobject)?o.makeGlider(s.slideobject):o.baseElement=o,o.isDraggable=!0;else{if(!c.isObject(i[0])||!c.isTransformationOrArray(i[1]))return!1;(o=new t(e,[0,0],s,n,r)).addTransform(i[0],i[1]),o.isDraggable=!1}return o.handleSnapToGrid(),o.handleSnapToPoints(),o.handleAttractors(),o.addParents(i),o},t.CoordsElement})),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],(function(t,e,i,s,n,r,o,a,l,h){"use strict";var c=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};return t.Text=function(t,i,s,n){this.constructor(t,s,e.OBJECT_TYPE_TEXT,e.OBJECT_CLASS_TEXT),this.element=this.board.select(s.anchor),this.coordsConstructor(i,a.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(n),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),a.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=a.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},t.Text.prototype=new s,a.copyPrototypeMethods(t.Text,h,"coordsConstructor"),t.extend(t.Text.prototype,{hasPoint:function(t,e){var i,s,n,r,o,h,c=this.board.options.precision.hasPoint;return this.transformations.length>0&&(t=(i=l.matVecMult(l.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,t,e]))[1],e=i[2]),s=(i="right"===(o=this.getAnchorX())?this.coords.scrCoords[1]-this.size[0]:"middle"===o?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],n=(r="top"===(h=this.getAnchorY())?this.coords.scrCoords[2]+this.size[1]:"middle"===h?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],"all"===a.evaluate(this.visProp.dragarea)?t>=i-c&&t<s+c&&e>=n-c&&e<=r+c:e>=n-c&&e<=r+c&&(t>=i-c&&t<=i+2*c||t>=s-2*c&&t<=s+c)},_setUpdateText:function(t){var e,i,s=a.evaluate(this.visProp.parse),n=a.evaluate(this.visProp.usemathjax);this.orgText=t,a.isFunction(t)?this.updateText=function(){i=t().toString(),this.plaintext=s&&!n?this.replaceSub(this.replaceSup(this.convertGeonext2CSS(i))):i}:a.isString(t)&&!s?this.updateText=function(){this.plaintext=t}:(this.content=a.isNumber(t)?a.toFixed(t,a.evaluate(this.visProp.digits)):a.evaluate(this.visProp.useasciimathml)?"'`"+t+"`'":n?"'"+t+"'":this.generateTerm(t,!0,!0),e=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=e()})},_setText:function(t){return this._setUpdateText(t),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(t){var e;return this.visProp.castext=t,e=a.isFunction(t)?function(){return a.sanitizeHTML(t())}:a.isNumber(t)?t:a.sanitizeHTML(t),this._setText(e)},setText:function(t){return this._setText(t)},updateSize:function(){var t,e,i,s,n=a.evaluate(this.visProp.display);if(!o.isBrowser||"no"===this.board.renderer.type)return this;if(s=this.rendNode,"html"===n||"vml"===this.board.renderer.type)a.exists(s.offsetWidth)?0===(e=[s.offsetWidth,s.offsetHeight])[0]&&0===e[1]?(i=this,window.setTimeout((function(){i.size=[s.offsetWidth,s.offsetHeight],i.needsUpdate=!0,i.updateRenderer()}),0)):this.size=e:this.size=this.crudeSizeEstimate();else if("internal"===n)if("svg"===this.board.renderer.type)try{t=s.getBBox(),this.size=[t.width,t.height]}catch(t){}else"canvas"===this.board.renderer.type&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var t=parseFloat(a.evaluate(this.visProp.fontsize));return[t*this.plaintext.length*.45,.9*t]},utf8_decode:function(t){return t.replace(/&#x(\w+);/g,(function(t,e){return String.fromCharCode(parseInt(e,16))}))},replaceSub:function(t){if(!t.indexOf)return t;for(var e,i=t.indexOf("_{");i>=0;)(e=(t=t.substr(0,i)+t.substr(i).replace(/_\{/,"<sub>")).substr(i).indexOf("}"))>=0&&(t=t.substr(0,e)+t.substr(e).replace(/\}/,"</sub>")),i=t.indexOf("_{");for(i=t.indexOf("_");i>=0;)i=(t=t.substr(0,i)+t.substr(i).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return t},replaceSup:function(t){if(!t.indexOf)return t;for(var e,i=t.indexOf("^{");i>=0;)(e=(t=t.substr(0,i)+t.substr(i).replace(/\^\{/,"<sup>")).substr(i).indexOf("}"))>=0&&(t=t.substr(0,e)+t.substr(e).replace(/\}/,"</sup>")),i=t.indexOf("^{");for(i=t.indexOf("^");i>=0;)i=(t=t.substr(0,i)+t.substr(i).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return t},getSize:function(){return this.size},setCoords:function(t,i){var s;return a.isArray(t)&&t.length>1&&(i=t[1],t=t[0]),a.evaluate(this.visProp.islabel)&&a.exists(this.element)?(s=this.element.getLabelAnchor(),this.relativeCoords.setCoordinates(e.COORDS_BY_SCREEN,[(t-s.usrCoords[1])*this.board.unitX,-(i-s.usrCoords[2])*this.board.unitY])):this.coords.setCoordinates(e.COORDS_BY_USER,[t,i]),this.fullUpdate(),this},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateText(),"internal"===a.evaluate(this.visProp.display)&&a.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(t){return t.replace(/([\)0-9\.])\s*([\(a-zA-Z_])/g,"$1*$2")},generateTerm:function(t,e,i){var s,r,o,l,h='""';if(o=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),l=t.indexOf("</value>"),o>=0)for(;o>=0;)h+=' + "'+this.replaceSub(this.replaceSup(t.slice(0,o)))+'"',r=(r=t.slice(o+7,l)).replace(/\s+/g,""),!0===e&&(r=this.expandShortMath(r)),(s=(s=(s=i?r:n.geonext2JS(r,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&a.isNumber(a.bind(this.board.jc.snippet(s,!0,"",!1),this)())?h+="+("+s+").toFixed("+a.evaluate(this.visProp.digits)+")":h+="+("+s+")",o=(t=t.slice(l+8)).indexOf("<value>"),l=t.indexOf("</value>");return h+=' + "'+this.replaceSub(this.replaceSup(t))+'"',(h=(h=this.convertGeonext2CSS(h)).replace(/&amp;/g,"&")).replace(/"/g,"'")},convertGeonext2CSS:function(t){return a.isString(t)&&(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<overline>/g,"<span style=text-decoration:overline>")).replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>")).replace(/<\/overline>/g,"</span>")).replace(/&lt;\/overline&gt;/g,"</span>")).replace(/<arrow>/g,"<span style=text-decoration:overline>")).replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>")).replace(/<\/arrow>/g,"</span>")).replace(/&lt;\/arrow&gt;/g,"</span>")),t},notifyParents:function(t){var e,i=null;t=(t=t.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do{null!==(i=(e=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/).exec(t))&&(n.findDependencies(this,i[1],this.board),t=(t=t.substr(i.index)).replace(e,""))}while(null!==i);return this},getParents:function(){var t;return t=void 0!==this.relativeCoords?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],0!==this.parents.length&&(t=this.parents),t},bounds:function(){var t=this.coords.usrCoords;return a.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX?[0,0,0,0]:[t[1],t[2]+this.size[1]/this.board.unitY,t[1]+this.size[0]/this.board.unitX,t[2]]},getAnchorX:function(){var t=a.evaluate(this.visProp.anchorx);if("auto"==t)switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return t},getAnchorY:function(){var t=a.evaluate(this.visProp.anchory);if("auto"==t)switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return t}}),t.createText=function(e,i,s){var n,r=a.copyAttributes(s,e.options,"text"),o=i.slice(0,-1),l=i[i.length-1];if(r.anchor=r.parent||r.anchor,!(n=h.create(t.Text,e,o,r,l)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==a.evaluate(r.rotate)&&"internal"===r.display&&n.addRotation(a.evaluate(r.rotate)),n},t.registerElement("text",t.createText),t.createHTMLSlider=function(e,i,s){var n,r=a.copyAttributes(s,e.options,"htmlslider");if(2!==i.length||2!==i[0].length||3!==i[1].length)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parents are: [[x,y], [min, start, max]]");r.anchor=r.parent||r.anchor,r.fixed=r.fixed||!0,(n=t.createText(e,[i[0][0],i[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],r)).type=a.OBJECT_TYPE_HTMLSLIDER,n.rendNodeForm=n.rendNode.childNodes[0],n.rendNodeRange=n.rendNodeForm.childNodes[0],n.rendNodeRange.min=i[1][0],n.rendNodeRange.max=i[1][2],n.rendNodeRange.step=r.step,n.rendNodeRange.value=i[1][1],n.rendNodeLabel=n.rendNodeForm.childNodes[1],n.rendNodeLabel.id=n.rendNode.id+"_label",r.withlabel&&(n.rendNodeLabel.innerHTML=n.name+"="),n.rendNodeOut=n.rendNodeForm.childNodes[2],n.rendNodeOut.value=i[1][1];try{n.rendNodeForm.id=n.rendNode.id+"_form",n.rendNodeRange.id=n.rendNode.id+"_range",n.rendNodeOut.id=n.rendNode.id+"_out"}catch(e){t.debug(e)}return n.rendNodeRange.style.width=r.widthrange+"px",n.rendNodeRange.style.verticalAlign="middle",n.rendNodeOut.style.width=r.widthout+"px",n._val=i[1][1],t.supportsVML()?o.addEvent(n.rendNodeForm,"change",c,n):o.addEvent(n.rendNodeForm,"input",c,n),n.Value=function(){return this._val},n},t.registerElement("htmlslider",t.createHTMLSlider),{Text:t.Text,createText:t.createText,createHTMLSlider:t.createHTMLSlider}})),define("utils/uuid",["jxg"],(function(t){"use strict";var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return t.Util=t.Util||{},t.Util.genUUID=function(){var t,i,s=[],n=0;for(i=0;i<36;i++)8===i||13===i||18===i||23===i?s[i]="-":14===i?s[i]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,s[i]=e[19===i?3&t|8:t]);return s.join("")},t.Util})),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],(function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(t,e){function i(){}if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object: "+t);if(null===t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return i.prototype=t,new i});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}},t,e;JXG.JessieCode=function(t,e){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="","string"==typeof t&&this.parse(t,e)},JXG.extend(JXG.JessieCode.prototype,{node:function(t,e,i){return{type:t,value:e,children:i}},createNode:function(t,e,i){var s,n=this.node(t,e,[]);for(s=2;s<arguments.length;s++)n.children.push(arguments[s]);return"node_const"==n.type&&Type.isNumber(n.value)&&(n.isMath=!0),n.line=this.parCurLine,n.col=this.parCurColumn,n},pushScope:function(t){var e={args:t,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=e,e.id=this.scopes.push(e)-1,e},popScope:function(){var t=this.scope.previous;return this.scope=null!==t?t:this.scope,this.scope},getElementById:function(t){return this.board.objects[t]},log:function(){this.$log.push(arguments),"object"==typeof console&&console.log&&console.log.apply(console,arguments)},creator:(e={},(t=function(t){var i;return"function"==typeof e[this.board.id+t]?i=e[this.board.id+t]:((i=function(e){return function(i,s){var n;return n=Type.exists(s)?s:{name:0!==e.lhs[e.scope]?e.lhs[e.scope]:""},e.board.create(t,i,n)}}(this)).creator=!0,e[this.board.id+t]=i),i}).clearCache=function(){e={}},t),letvar:function(t,e){this.builtIn[t]&&this._warn('"'+t+'" is a predefined value.'),this.scope.locals[t]=e},isLocalVariable:function(t){for(var e=this.scope;null!==e;){if(Type.exists(e.locals[t]))return e;e=e.previous}return null},isParameter:function(t){for(var e=this.scope;null!==e;){if(Type.indexOf(e.args,t)>-1)return e;e=e.previous}return null},isCreator:function(t){return!!JXG.elements[t]},isMathMethod:function(t){return"E"!==t&&!!Math[t]},isBuiltIn:function(t){return!!this.builtIn[t]},getvar:function(t,e){var i;return e=Type.def(e,!1),null!==(i=this.isLocalVariable(t))?i.locals[t]:this.isCreator(t)?this.creator(t):this.isBuiltIn(t)?this.builtIn[t]:this.isMathMethod(t)?Math[t]:e||(i=this.board.select(t))===t?void 0:i},resolve:function(t){for(var e=this.scope;null!==e;){if(Type.exists(e.locals[t]))return e.locals[t];e=e.previous}},getvarJS:function(t,e,i){var s="";return e=Type.def(e,!1),i=Type.def(i,!1),null!==this.isParameter(t)?t:null===this.isLocalVariable(t)||i?this.isCreator(t)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(i?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+t+"'].concat([a, props])); })":(i&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(t)?this.builtIn[t].src||this.builtIn[t]:this.isMathMethod(t)?"Math."+t:e?"":(Type.isId(this.board,t)?s="$jc$.board.objects['"+t+"']":Type.isName(this.board,t)?s="$jc$.board.elementsByName['"+t+"']":Type.isGroup(this.board,t)&&(s="$jc$.board.groups['"+t+"']"),s)):"$jc$.resolve('"+t+"')"},makeMap:function(t){return t.isMap=!0,t},functionCodeJS:function(t){var e=t.children[0].join(", "),i="",s="";return"op_map"===t.value&&(i="{ return  ",s=" }"),"function ("+e+") {\nvar $oldscope$ = $jc$.scope;\n$jc$.scope = $jc$.scopes["+this.scope.id+"];\nvar r = (function () "+i+this.compile(t.children[1],!0)+s+")();\n$jc$.scope = $oldscope$;\nreturn r;\n}"},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return eval(str)}catch(t){return $jc$._warn("error compiling function\n\n"+str+"\n\n"+t.toString()),function(){}}}(this),this.popScope()}else fun=function(t,e,i){return function(){var s,n;for(n=e.scope,e.scope=e.scopes[i],s=0;s<t.length;s++)e.scope.locals[t[s]]=arguments[s];return s=e.execute(node.children[1]),e.scope=n,s}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(t){return function(){return t.compile(t.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(t){var e,i={};for(e=0;e<arguments.length;e++)i=Type.deepCopy(i,arguments[e],!0);return i},setProp:function(t,e,i){var s,n,r={};t.elementClass!==Const.OBJECT_CLASS_POINT||"X"!==e&&"Y"!==e?t.elementClass!==Const.OBJECT_CLASS_TEXT||"X"!==e&&"Y"!==e?t.type&&t.elementClass&&t.visProp?Type.exists(t[t.methodMap[e]])&&"function"!=typeof t[t.methodMap[e]]?t[t.methodMap[e]]=i:(r[e]=i,t.setAttribute(r)):t[e]=i:("number"==typeof i?t[e]=function(){return i}:"function"==typeof i?(t.isDraggable=!1,t[e]=i):"string"==typeof i&&(t.isDraggable=!1,t[e]=Type.createFunction(i,this.board,null,!0),t[e+"jc"]=i),t[e].origin=i,this.board.update()):(e=e.toLowerCase(),t.isDraggable&&"number"==typeof i?(s="x"===e?i:t.X(),n="y"===e?i:t.Y(),t.setPosition(Const.COORDS_BY_USER,[s,n])):!t.isDraggable||"function"!=typeof i&&"string"!=typeof i?t.isDraggable||t.addConstraint([s="x"===e?i:t.XEval.origin,n="y"===e?i:t.YEval.origin]):t.addConstraint([s="x"===e?i:t.coords.usrCoords[1],n="y"===e?i:t.coords.usrCoords[2]]),this.board.update())},_genericParse:function(t,e,i,s){var n,r,o,a,l=t.replace(/\r\n/g,"\n").split("\n"),h=[];s||(this.code+=t+"\n"),Text&&(r=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(i)||(i=!1),n=0;n<l.length;n++)i&&(l[n]=JXG.GeonextParser.geonext2JS(l[n],this.board)),h.push(l[n]);switch(t=h.join("\n"),o=parser.parse(t),this.CA&&(o=this.CA.expandDerivatives(o,null,o),o=this.CA.removeTrivialNodes(o)),e){case"parse":a=this.execute(o);break;case"manipulate":a=this.compile(o);break;case"getAst":a=o;break;default:a=!1}}catch(t){console.log(t)}finally{Text&&(Text.Text.prototype.setText=r)}return a},parse:function(t,e,i){return this._genericParse(t,"parse",e,i)},manipulate:function(t,e,i){return this._genericParse(t,"manipulate",e,i)},getAST:function(t,e,i){return this._genericParse(t,"getAst",e,i)},snippet:function(t,e,i,s){return e=Type.def(e,!0),i=Type.def(i,""),s=Type.def(s,!1),this.parse((e?" function ("+i+") { return ":"")+t+(e?"; }":"")+";",s,!0)},replaceIDs:function(t){var e,i;if(t.replaced&&Type.exists(i=this.board.objects[t.children[1][0].value])&&""!==i.name&&(t.type="node_var",t.value=i.name,t.children.length=0,delete t.replaced),t.children)for(e=t.children.length;e>0;e--)Type.exists(t.children[e-1])&&(t.children[e-1]=this.replaceIDs(t.children[e-1]));return t},replaceNames:function(t){var e,i;if(i=t.value,"node_op"===t.type&&"op_lhs"===i&&1===t.children.length?this.isLHS=!0:"node_var"===t.type&&(this.isLHS?this.letvar(i,!0):!Type.exists(this.getvar(i,!0))&&Type.exists(this.board.elementsByName[i])&&(t=this.createReplacementNode(t))),t.children)for(e=t.children.length;e>0;e--)Type.exists(t.children[e-1])&&(t.children[e-1]=this.replaceNames(t.children[e-1]));return"node_op"===t.type&&"op_lhs"===t.value&&1===t.children.length&&(this.isLHS=!1),t},createReplacementNode:function(t){var e=this.board.elementsByName[t.value];return(t=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",e.id)])).replaced=!0,t},collectDependencies:function(t,e){var i,s,n;if(Type.isArray(t))for(n=t.length,i=0;i<n;i++)this.collectDependencies(t[i],e);else if("node_var"===t.type&&(s=this.getvar(t.value))&&s.visProp&&s.type&&s.elementClass&&s.id&&(e[s.id]=s),"node_op"===t.type&&"op_execfun"===t.value&&t.children.length>1&&"$"===t.children[0].value&&t.children[1].length>0&&(e[s=t.children[1][0].value]=this.board.objects[s]),t.children)for(i=t.children.length;i>0;i--)Type.exists(t.children[i-1])&&this.collectDependencies(t.children[i-1],e)},resolveProperty:function(t,e,i){return i=Type.def(i,!1),t&&t.methodMap&&(Type.exists(t.subs)&&Type.exists(t.subs[e])?t=t.subs:Type.exists(t.methodMap[e])?e=t.methodMap[e]:(t=t.visProp,e=e.toLowerCase())),Type.isFunction(t)&&this._error("Accessing function properties is not allowed."),Type.exists(t)||this._error(t+" is not an object"),Type.exists(t[e])||this._error("unknown property "+e),i&&"function"==typeof t[e]?function(){return t[e].apply(t,arguments)}:t[e]},getLHS:function(t){var e;if("node_var"===t.type)e={o:this.scope.locals,what:t.value};else if("node_op"===t.type&&"op_property"===t.value)e={o:this.execute(t.children[0]),what:t.children[1]};else{if("node_op"!==t.type||"op_extvalue"!==t.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");e={o:this.execute(t.children[0]),what:this.execute(t.children[1])}}return e},getLHSCompiler:function(t,e){var i;if("node_var"===t.type)i=t.value;else if("node_op"===t.type&&"op_property"===t.value)i=[this.compile(t.children[0],e),"'"+t.children[1]+"'"];else{if("node_op"!==t.type||"op_extvalue"!==t.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");i=[this.compile(t.children[0],e),"node_const"===t.children[1].type?t.children[1].value:this.compile(t.children[1],e)]}return i},execute:function(t){var e,i,s,n,r,o,a,l,h,c,d=[];if(e=0,!t)return e;switch(this.line=t.line,this.col=t.col,t.type){case"node_op":switch(t.value){case"op_none":t.children[0]&&this.execute(t.children[0]),t.children[1]&&(e=this.execute(t.children[1]));break;case"op_assign":i=this.getLHS(t.children[0]),this.lhs[this.scope.id]=i[1],i.o.type&&i.o.elementClass&&i.o.methodMap&&"label"===i.what&&this._error("Left-hand side of assignment is read-only."),e=this.execute(t.children[1]),i.o!==this.scope.locals||Type.isArray(i.o)&&"number"==typeof i.what?this.setProp(i.o,i.what,e):this.letvar(i.what,e),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(t.children[0])&&(e=this.execute(t.children[1]));break;case"op_conditional":case"op_if_else":e=this.execute(t.children[0])?this.execute(t.children[1]):this.execute(t.children[2]);break;case"op_while":for(;this.execute(t.children[0]);)this.execute(t.children[1]);break;case"op_do":do{this.execute(t.children[0])}while(this.execute(t.children[1]));break;case"op_for":for(this.execute(t.children[0]);this.execute(t.children[1]);this.execute(t.children[2]))this.execute(t.children[3]);break;case"op_proplst":t.children[0]&&this.execute(t.children[0]),t.children[1]&&this.execute(t.children[1]);break;case"op_emptyobject":e={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(t.children[0]),e=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][t.children[0]]=this.execute(t.children[1]);break;case"op_array":for(e=[],r=t.children[0].length,s=0;s<r;s++)e.push(this.execute(t.children[0][s]));break;case"op_extvalue":e=this.execute(t.children[0]),e="number"==typeof(s=this.execute(t.children[1]))&&Math.abs(Math.round(s)-s)<Mat.eps?e[s]:void 0;break;case"op_return":if(0!==this.scope)return this.execute(t.children[0]);this._error("Unexpected return.");break;case"op_map":t.children[1].isMath||"node_var"===t.children[1].type||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(l=this.defineFunction(t)).isMap=!0,e=l;break;case"op_function":(l=this.defineFunction(t)).isMap=!1,e=l;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,o=t.children[1],Type.exists(t.children[2]))if(t.children[3])for(a=t.children[2],h={},s=0;s<a.length;s++)h=Type.deepCopy(h,this.execute(a[s]),!0);else h=this.execute(t.children[2]);for(c=(l=this.execute(t.children[0]))&&l.sc?l.sc:this,!l.creator&&Type.exists(t.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),s=0;s<o.length;s++)d[s]=this.execute(o[s]),this.dpstack[this.pscope].push({line:t.children[1][s].line,col:t.children[1][s].ecol});if("function"!=typeof l||l.creator)if("function"==typeof l&&l.creator){n=this.line;try{for((e=l(d,h)).jcLineStart=n,e.jcLineEnd=t.eline,s=n;s<=t.line;s++)this.lineToElement[s]=e;e.debugParents=this.dpstack[this.pscope]}catch(t){this._error(t.toString())}}else this._error("Function '"+l+"' is undefined.");else e=l.apply(c,d);this.dpstack.pop(),this.pscope--;break;case"op_property":n=this.execute(t.children[0]),e=this.resolveProperty(n,i=t.children[1],!1),Type.exists(e)&&(e.sc=n);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(t.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),i=this.getvar(t.children[0]),e=this.del(i);break;case"op_equ":e=this.execute(t.children[0])==this.execute(t.children[1]);break;case"op_neq":e=this.execute(t.children[0])!=this.execute(t.children[1]);break;case"op_approx":e=Math.abs(this.execute(t.children[0])-this.execute(t.children[1]))<Mat.eps;break;case"op_grt":e=this.execute(t.children[0])>this.execute(t.children[1]);break;case"op_lot":e=this.execute(t.children[0])<this.execute(t.children[1]);break;case"op_gre":e=this.execute(t.children[0])>=this.execute(t.children[1]);break;case"op_loe":e=this.execute(t.children[0])<=this.execute(t.children[1]);break;case"op_or":e=this.execute(t.children[0])||this.execute(t.children[1]);break;case"op_and":e=this.execute(t.children[0])&&this.execute(t.children[1]);break;case"op_not":e=!this.execute(t.children[0]);break;case"op_add":e=this.add(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_sub":e=this.sub(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_div":e=this.div(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_mod":e=this.mod(this.execute(t.children[0]),this.execute(t.children[1]),!0);break;case"op_mul":e=this.mul(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_exp":e=this.pow(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_neg":e=this.neg(this.execute(t.children[0]))}break;case"node_var":e=this.getvar(t.value);break;case"node_const":e=Number(t.value);break;case"node_const_bool":e=t.value;break;case"node_str":e=t.value.replace(/\\(.)/,"$1")}return e},compile:function(t,e){var i,s,n,r="";if(Type.exists(e)||(e=!1),!t)return r;switch(t.type){case"node_op":switch(t.value){case"op_none":t.children[0]&&(r=this.compile(t.children[0],e)),t.children[1]&&(r+=this.compile(t.children[1],e));break;case"op_assign":e?(i=this.getLHSCompiler(t.children[0],e),Type.isArray(i)?r="$jc$.setProp("+i[0]+", "+i[1]+", "+this.compile(t.children[1],e)+");\n":(this.isLocalVariable(i)!==this.scope&&(this.scope.locals[i]=!0),r="$jc$.scopes["+this.scope.id+"].locals['"+i+"'] = "+this.compile(t.children[1],e)+";\n")):r=(i=this.compile(t.children[0]))+" = "+this.compile(t.children[1],e)+";\n";break;case"op_if":r=" if ("+this.compile(t.children[0],e)+") "+this.compile(t.children[1],e);break;case"op_if_else":r=" if ("+this.compile(t.children[0],e)+")"+this.compile(t.children[1],e),r+=" else "+this.compile(t.children[2],e);break;case"op_conditional":r="(("+this.compile(t.children[0],e)+")?("+this.compile(t.children[1],e),r+="):("+this.compile(t.children[2],e)+"))";break;case"op_while":r=" while ("+this.compile(t.children[0],e)+") {\n"+this.compile(t.children[1],e)+"}\n";break;case"op_do":r=" do {\n"+this.compile(t.children[0],e)+"} while ("+this.compile(t.children[1],e)+");\n";break;case"op_for":r=" for ("+this.compile(t.children[0],e)+"; "+this.compile(t.children[1],e)+"; "+this.compile(t.children[2],e)+") {\n"+this.compile(t.children[3],e)+"\n}\n";break;case"op_proplst":t.children[0]&&(r=this.compile(t.children[0],e)+", "),r+=this.compile(t.children[1],e);break;case"op_prop":r=t.children[0]+": "+this.compile(t.children[1],e);break;case"op_emptyobject":r=e?"{}":"<< >>";break;case"op_proplst_val":r=this.compile(t.children[0],e);break;case"op_array":for(n=[],s=0;s<t.children[0].length;s++)n.push(this.compile(t.children[0][s],e));r="["+n.join(", ")+"]";break;case"op_extvalue":r=this.compile(t.children[0],e)+"["+this.compile(t.children[1],e)+"]";break;case"op_return":r=" return "+this.compile(t.children[0],e)+";\n";break;case"op_map":t.children[1].isMath||"node_var"===t.children[1].type||this._error("compile: In a map only function calls and mathematical expressions are allowed."),n=t.children[0],r=e?" $jc$.makeMap(function ("+n.join(", ")+") { return "+this.compile(t.children[1],e)+"; })":"map ("+n.join(", ")+") -> "+this.compile(t.children[1],e);break;case"op_function":this.pushScope(n=t.children[0]),r=e?this.functionCodeJS(t):" function ("+n.join(", ")+") "+this.compile(t.children[1],e),this.popScope();break;case"op_execfunmath":console.log("TODO"),r="-1";break;case"op_execfun":if(t.children[2]){for(n=[],s=0;s<t.children[2].length;s++)n.push(this.compile(t.children[2][s],e));e&&(i="$jc$.mergeAttributes("+n.join(", ")+")")}for(t.children[0].withProps=!!t.children[2],n=[],s=0;s<t.children[1].length;s++)n.push(this.compile(t.children[1][s],e));r=this.compile(t.children[0],e)+"("+n.join(", ")+(t.children[2]&&e?", "+i:"")+")"+(t.children[2]&&!e?i:""),e&&"$"===t.children[0].value&&(r="$jc$.board.objects["+this.compile(t.children[1][0],e)+"]");break;case"op_property":r=e&&"X"!==t.children[1]&&"Y"!==t.children[1]?"$jc$.resolveProperty("+this.compile(t.children[0],e)+", '"+t.children[1]+"', true)":this.compile(t.children[0],e)+"."+t.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),r=e?"$jc$.use('":"use('",r+=t.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),r=e?"$jc$.del(":"remove(",r+=this.compile(t.children[0],e)+")";break;case"op_equ":r="("+this.compile(t.children[0],e)+" == "+this.compile(t.children[1],e)+")";break;case"op_neq":r="("+this.compile(t.children[0],e)+" != "+this.compile(t.children[1],e)+")";break;case"op_approx":r="("+this.compile(t.children[0],e)+" ~= "+this.compile(t.children[1],e)+")";break;case"op_grt":r="("+this.compile(t.children[0],e)+" > "+this.compile(t.children[1],e)+")";break;case"op_lot":r="("+this.compile(t.children[0],e)+" < "+this.compile(t.children[1],e)+")";break;case"op_gre":r="("+this.compile(t.children[0],e)+" >= "+this.compile(t.children[1],e)+")";break;case"op_loe":r="("+this.compile(t.children[0],e)+" <= "+this.compile(t.children[1],e)+")";break;case"op_or":r="("+this.compile(t.children[0],e)+" || "+this.compile(t.children[1],e)+")";break;case"op_and":r="("+this.compile(t.children[0],e)+" && "+this.compile(t.children[1],e)+")";break;case"op_not":r="!("+this.compile(t.children[0],e)+")";break;case"op_add":r=e?"$jc$.add("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" + "+this.compile(t.children[1],e)+")";break;case"op_sub":r=e?"$jc$.sub("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" - "+this.compile(t.children[1],e)+")";break;case"op_div":r=e?"$jc$.div("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" / "+this.compile(t.children[1],e)+")";break;case"op_mod":r=e?"$jc$.mod("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+", true)":"("+this.compile(t.children[0],e)+" % "+this.compile(t.children[1],e)+")";break;case"op_mul":r=e?"$jc$.mul("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" * "+this.compile(t.children[1],e)+")";break;case"op_exp":r=e?"$jc$.pow("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+"^"+this.compile(t.children[1],e)+")";break;case"op_neg":r=e?"$jc$.neg("+this.compile(t.children[0],e)+")":"(-"+this.compile(t.children[0],e)+")"}break;case"node_var":r=e?this.getvarJS(t.value,!1,t.withProps):t.value;break;case"node_const":case"node_const_bool":r=t.value;break;case"node_str":r="'"+t.value+"'"}return t.needsBrackets&&(r="{\n"+r+"}\n"),r},X:function(t){return t.X()},Y:function(t){return t.Y()},V:function(t){return t.Value()},L:function(t){return t.L()},dist:function(t,e){return Type.exists(t)&&Type.exists(t.Dist)||this._error("Error: Can't calculate distance."),t.Dist(e)},add:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isArray(e))for(s=Math.min(t.length,e.length),n=[],i=0;i<s;i++)n[i]=t[i]+e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t+e:Type.isString(t)||Type.isString(e)?n=t.toString()+e.toString():this._error("Operation + not defined on operands "+typeof t+" and "+typeof e);return n},sub:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isArray(e))for(s=Math.min(t.length,e.length),n=[],i=0;i<s;i++)n[i]=t[i]-e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t-e:this._error("Operation - not defined on operands "+typeof t+" and "+typeof e);return n},neg:function(t){var e,i,s;if(t=Type.evalSlider(t),Type.isArray(t))for(i=t.length,s=[],e=0;e<i;e++)s[e]=-t[e];else Type.isNumber(t)?s=-t:this._error("Unary operation - not defined on operand "+typeof t);return s},mul:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e)&&(i=t,e=t=e),Type.isArray(t)&&Type.isArray(e))s=Math.min(t.length,e.length),n=Mat.innerProduct(t,e,s);else if(Type.isNumber(t)&&Type.isArray(e))for(s=e.length,n=[],i=0;i<s;i++)n[i]=t*e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t*e:this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},div:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e))for(s=t.length,n=[],i=0;i<s;i++)n[i]=t[i]/e;else Type.isNumber(t)&&Type.isNumber(e)?n=t/e:this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},mod:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e))for(s=t.length,n=[],i=0;i<s;i++)n[i]=Mat.mod(t[i],e,!0);else Type.isNumber(t)&&Type.isNumber(e)?n=Mat.mod(t,e,!0):this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},pow:function(t,e){return t=Type.evalSlider(t),e=Type.evalSlider(e),Math.pow(t,e)},DDD:function(t){console.log("Dummy derivative function. This should never appear!")},ifthen:function(t,e,i){return t?e:i},del:function(t){"object"==typeof t&&JXG.exists(t.type)&&JXG.exists(t.elementClass)&&this.board.removeObject(t)},use:function(t){var e,i,s=!1;if("string"==typeof t){for(e in JXG.boards)if(JXG.boards.hasOwnProperty(e)&&JXG.boards[e].container===t){i=JXG.boards[e],s=!0;break}}else i=t,s=!0;s?(this.board=i,this.builtIn.$board=i,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+t+"' not found!")},findSymbol:function(t,e){var i,s;for(s=-1===(e=Type.def(e,-1))?this.scope:this.scopes[e];null!==s;){for(i in s.locals)if(s.locals.hasOwnProperty(i)&&s.locals[i]===t)return[i,s];s=s.previous}return[]},importModule:function(t){return priv.modules[t.toLowerCase()]},defineBuiltIn:function(){var t=this,e={PI:Math.PI,EULER:Math.E,X:t.X,Y:t.Y,V:t.V,L:t.L,dist:t.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:t.ifthen,import:t.importModule,use:t.use,remove:t.del,$:t.getElementById,$board:t.board,$log:t.log,D:t.DDD};return e.rad.sc=Geometry,e.deg.sc=Geometry,e.factorial.sc=Mat,e.X.src="$jc$.X",e.Y.src="$jc$.Y",e.V.src="$jc$.V",e.L.src="$jc$.L",e.dist.src="$jc$.dist",e.rad.src="JXG.Math.Geometry.rad",e.deg.src="JXG.Math.Geometry.trueAngle",e.factorial.src="JXG.Math.factorial",e.trunc.src="JXG.trunc",e.ln.src="Math.log",e.log10.src="JXG.Math.log10",e.lg.src="JXG.Math.log10",e.log2.src="JXG.Math.log2",e.lb.src="JXG.Math.log2",e.ld.src="JXG.Math.log2",e.cosh.src="JXG.Math.cosh",e.sinh.src="JXG.Math.sinh",e.import.src="$jc$.importModule",e.use.src="$jc$.use",e.remove.src="$jc$.del",e.IfThen.src="$jc$.ifthen",e.$.src="(function (n) { return $jc$.board.select(n); })",e.$board&&(e.$board.src="$jc$.board"),e.$log.src="$jc$.log",e},_debug:function(t){"object"==typeof console?console.log(t):Env.isBrowser&&document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=t+"<br />")},_error:function(t){var e=new Error("Error("+this.line+"): "+t);throw e.line=this.line,e},_warn:function(t){"object"==typeof console?console.log("Warning("+this.line+"): "+t):Env.isBrowser&&document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+t+"<br />")},_log:function(t){"object"!=typeof window&&"object"==typeof self&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+t.toString()}):console.log("Log: ",arguments)}});var parser=function(){function t(){this.yy={}}var e=function(t,e,i,s){for(i=i||{},s=t.length;s--;i[t[s]]=e);return i},i=[2,14],s=[1,13],n=[1,37],r=[1,14],o=[1,15],a=[1,21],l=[1,16],h=[1,17],c=[1,33],d=[1,18],u=[1,19],p=[1,12],f=[1,59],m=[1,60],g=[1,58],b=[1,46],y=[1,48],v=[1,49],C=[1,50],x=[1,51],_=[1,52],P=[1,53],S=[1,54],w=[1,45],E=[1,38],k=[1,39],A=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],T=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],M=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],O=[2,48],N=[1,72],L=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],D=[1,78],j=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],I=[1,82],R=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],B=[1,83],F=[1,84],Y=[1,85],z=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],X=[1,89],U=[1,90],G=[1,91],H=[1,92],q=[1,97],J=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],V=[1,103],$=[1,104],W=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],K=[1,105],Z=[1,106],Q=[1,107],tt=[1,126],et=[1,139],it=[83,86],st=[1,149],nt=[10,66,86],rt=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ot=[1,166],at=[10,86],lt={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(t,e,i,s,n,r,o){var a=r.length-1;switch(n){case 1:return r[a-1];case 2:this.$=ht.createNode(ct(o[a-4]),"node_op","op_if",r[a-2],r[a]);break;case 3:this.$=ht.createNode(ct(o[a-6]),"node_op","op_if_else",r[a-4],r[a-2],r[a]);break;case 4:this.$=ht.createNode(ct(o[a-4]),"node_op","op_while",r[a-2],r[a]);break;case 5:this.$=ht.createNode(ct(o[a-8]),"node_op","op_for",r[a-6],r[a-4],r[a-2],r[a]);break;case 6:this.$=ht.createNode(ct(o[a-6]),"node_op","op_do",r[a-5],r[a-2]);break;case 7:this.$=ht.createNode(ct(o[a-1]),"node_op","op_use",r[a]);break;case 8:this.$=ht.createNode(ct(o[a-1]),"node_op","op_delete",r[a]);break;case 9:this.$=ht.createNode(ct(o[a-1]),"node_op","op_return",void 0);break;case 10:this.$=ht.createNode(ct(o[a-2]),"node_op","op_return",r[a-1]);break;case 11:case 14:this.$=ht.createNode(ct(o[a]),"node_op","op_none");break;case 12:this.$=r[a-1],this.$.needsBrackets=!0;break;case 13:this.$=ht.createNode(ct(o[a-1]),"node_op","op_none",r[a-1],r[a]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=r[a];break;case 22:case 65:case 93:this.$=r[a-1];break;case 25:this.$=ht.createNode(ct(o[a-2]),"node_op","op_assign",r[a-2],r[a]),this.$.isMath=!1;break;case 27:this.$=ht.createNode(ct(o[a-4]),"node_op","op_conditional",r[a-4],r[a-2],r[a]),this.$.isMath=!1;break;case 29:this.$=ht.createNode(ct(o[a-2]),"node_op","op_or",r[a-2],r[a]),this.$.isMath=!1;break;case 31:this.$=ht.createNode(ct(o[a-2]),"node_op","op_and",r[a-2],r[a]),this.$.isMath=!1;break;case 33:this.$=ht.createNode(ct(o[a-2]),"node_op","op_equ",r[a-2],r[a]),this.$.isMath=!1;break;case 34:this.$=ht.createNode(ct(o[a-2]),"node_op","op_neq",r[a-2],r[a]),this.$.isMath=!1;break;case 35:this.$=ht.createNode(ct(o[a-2]),"node_op","op_approx",r[a-2],r[a]),this.$.isMath=!1;break;case 37:this.$=ht.createNode(ct(o[a-2]),"node_op","op_lot",r[a-2],r[a]),this.$.isMath=!1;break;case 38:this.$=ht.createNode(ct(o[a-2]),"node_op","op_grt",r[a-2],r[a]),this.$.isMath=!1;break;case 39:this.$=ht.createNode(ct(o[a-2]),"node_op","op_loe",r[a-2],r[a]),this.$.isMath=!1;break;case 40:this.$=ht.createNode(ct(o[a-2]),"node_op","op_gre",r[a-2],r[a]),this.$.isMath=!1;break;case 42:this.$=ht.createNode(ct(o[a-2]),"node_op","op_add",r[a-2],r[a]),this.$.isMath=!0;break;case 43:this.$=ht.createNode(ct(o[a-2]),"node_op","op_sub",r[a-2],r[a]),this.$.isMath=!0;break;case 45:this.$=ht.createNode(ct(o[a-2]),"node_op","op_mul",r[a-2],r[a]),this.$.isMath=!0;break;case 46:this.$=ht.createNode(ct(o[a-2]),"node_op","op_div",r[a-2],r[a]),this.$.isMath=!0;break;case 47:this.$=ht.createNode(ct(o[a-2]),"node_op","op_mod",r[a-2],r[a]),this.$.isMath=!0;break;case 49:this.$=ht.createNode(ct(o[a-2]),"node_op","op_exp",r[a-2],r[a]),this.$.isMath=!0;break;case 51:this.$=ht.createNode(ct(o[a-1]),"node_op","op_not",r[a]),this.$.isMath=!1;break;case 53:this.$=ht.createNode(ct(o[a-1]),"node_op","op_neg",r[a]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=r[a],this.$.isMath=!1;break;case 59:case 91:this.$=ht.createNode(ct(o[a-2]),"node_op","op_property",r[a-2],r[a]),this.$.isMath=!0;break;case 60:case 90:this.$=ht.createNode(ct(o[a-3]),"node_op","op_extvalue",r[a-3],r[a-1]),this.$.isMath=!0;break;case 61:this.$=ht.createNode(ct(o[a]),"node_var",r[a]);break;case 69:this.$=r[a],this.$.isMath=!0;break;case 70:this.$=ht.createNode(ct(o[a]),"node_const",null);break;case 71:this.$=ht.createNode(ct(o[a]),"node_const_bool",!0);break;case 72:this.$=ht.createNode(ct(o[a]),"node_const_bool",!1);break;case 73:this.$=ht.createNode(ct(o[a]),"node_str",r[a].substring(1,r[a].length-1));break;case 74:this.$=ht.createNode(ct(o[a]),"node_const",parseFloat(r[a]));break;case 75:this.$=ht.createNode(ct(o[a]),"node_const",NaN);break;case 76:this.$=ht.createNode(ct(o[a]),"node_const",1/0);break;case 77:this.$=ht.createNode(ct(o[a-1]),"node_op","op_array",[]);break;case 78:this.$=ht.createNode(ct(o[a-2]),"node_op","op_array",r[a-1]);break;case 79:this.$=ht.createNode(ct(o[a-1]),"node_op","op_emptyobject",{});break;case 80:this.$=ht.createNode(ct(o[a-2]),"node_op","op_proplst_val",r[a-1]);break;case 82:this.$=ht.createNode(ct(o[a-2]),"node_op","op_proplst",r[a-2],r[a]);break;case 83:this.$=ht.createNode(ct(o[a-2]),"node_op","op_prop",r[a-2],r[a]);break;case 87:case 89:this.$=ht.createNode(ct(o[a-1]),"node_op","op_execfun",r[a-1],r[a]),this.$.isMath=!0;break;case 88:this.$=ht.createNode(ct(o[a-2]),"node_op","op_execfun",r[a-2],r[a-1],r[a],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[r[a]];break;case 95:case 99:case 104:this.$=r[a-2].concat(r[a]);break;case 96:this.$=ht.createNode(ct(o[a]),"node_var",r[a]),this.$.isMath=!0;break;case 100:this.$=ht.createNode(ct(o[a-3]),"node_op","op_function",[],r[a]),this.$.isMath=!1;break;case 101:this.$=ht.createNode(ct(o[a-4]),"node_op","op_function",r[a-2],r[a]),this.$.isMath=!1;break;case 102:this.$=ht.createNode(ct(o[a-5]),"node_op","op_map",r[a-3],r[a])}},table:[e([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],i,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:s,8:n,9:20,11:4,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{1:[2,1]},e(A,[2,13]),e(T,[2,15]),e(T,[2,16]),e(T,[2,17]),e(T,[2,18]),e(T,[2,19]),e(T,[2,20]),e(T,[2,21]),e([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],i,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:s,8:n,9:20,11:65,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{20:[1,66]},{20:[1,67]},{8:n,9:69,16:[1,68],20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{16:[1,70]},e(T,[2,11]),e(M,[2,23]),e(M,[2,24]),e([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],O,{32:[1,71],57:N}),e([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),e(L,[2,54],{88:77,8:D,64:[1,75],65:[1,76]}),e(L,[2,55],{88:79,8:D,64:[1,81],65:[1,80]}),e(j,[2,28],{39:I}),e(M,[2,56]),e(M,[2,57]),e(M,[2,58]),e(R,[2,30],{41:B,42:F,43:Y}),e(M,[2,61]),e(M,[2,62]),e(M,[2,63]),e(M,[2,64]),{8:n,9:86,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:[1,87]},{8:[1,88]},e(z,[2,32],{45:X,46:U,47:G,48:H}),e(M,[2,66]),e(M,[2,67]),e(M,[2,68]),e(M,[2,69]),{20:q,72:98,73:99,77:x,78:_,79:P,80:S,83:[1,93],84:94,85:95,87:96},{8:n,20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,81:101,82:w,91:E,93:k},e(J,[2,36],{50:V,51:$}),e(M,[2,70]),e(M,[2,71]),e(M,[2,72]),e(M,[2,73]),e(M,[2,74]),e(M,[2,75]),e(M,[2,76]),e(W,[2,41],{53:K,54:Z,55:Q}),e(M,[2,44]),e(M,[2,50]),{8:n,20:c,31:109,50:f,51:m,52:108,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:110,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:111,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{6:6,7:s,8:n,9:20,11:4,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:113,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:114,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:115,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{14:[1,116]},e(T,[2,7]),e(T,[2,8]),e(T,[2,9]),{16:[1,117]},e(T,[2,22]),{8:n,20:c,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:119,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,36:121,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{20:[1,122]},{8:n,9:123,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(M,[2,87],{89:124,90:125,68:127,20:tt,82:w}),{8:n,10:[1,128],20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,81:129,82:w,91:E,93:k},e(M,[2,89]),{8:n,9:130,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{20:[1,131]},{8:n,20:c,31:109,38:132,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,40:133,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,40:134,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,40:135,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{10:[1,136]},{10:[1,137],20:et,92:138},{20:et,92:140},{8:n,20:c,31:109,44:141,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,44:142,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,44:143,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,44:144,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(M,[2,79]),{83:[1,145],86:[1,146]},e(it,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},e(M,[2,77]),{66:[1,148],86:st},e(nt,[2,98]),{8:n,20:c,31:109,49:150,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,49:151,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:152,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:153,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,31:109,50:f,51:m,52:154,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(M,[2,51]),e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],O,{57:N}),e(M,[2,52]),e(M,[2,53]),e([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},e(T,[2,10]),e(M,[2,25]),e(M,[2,49]),{35:[1,159]},e(j,[2,29],{39:I}),e(M,[2,59]),{66:[1,160]},e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),e(M,[2,94]),e(M,[2,96]),e(M,[2,97]),e(rt,[2,92]),{10:[1,162],86:st},{66:[1,163]},e(M,[2,91]),e(R,[2,31],{41:B,42:F,43:Y}),e(z,[2,33],{45:X,46:U,47:G,48:H}),e(z,[2,34],{45:X,46:U,47:G,48:H}),e(z,[2,35],{45:X,46:U,47:G,48:H}),e(M,[2,65]),{25:164,26:p},{10:[1,165],86:ot},e(at,[2,103]),{10:[1,167],86:ot},e(J,[2,37],{50:V,51:$}),e(J,[2,38],{50:V,51:$}),e(J,[2,39],{50:V,51:$}),e(J,[2,40],{50:V,51:$}),e(M,[2,80]),{20:q,72:98,73:99,77:x,78:_,79:P,80:S,85:168,87:96},{8:n,20:c,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(M,[2,78]),{8:n,20:c,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(W,[2,42],{53:K,54:Z,55:Q}),e(W,[2,43],{53:K,54:Z,55:Q}),e(M,[2,45]),e(M,[2,46]),e(M,[2,47]),{6:6,7:s,8:n,9:20,11:171,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{6:6,7:s,8:n,9:20,11:172,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:173,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:174,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,20:c,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(M,[2,60]),{20:tt,68:127,82:w,90:176},e(rt,[2,93]),e(M,[2,90]),e(M,[2,100]),{25:177,26:p},{20:[1,178]},{94:[1,179]},e(it,[2,82]),e(it,[2,83]),e(nt,[2,99]),e(A,[2,2],{12:[1,180]}),e(T,[2,4]),{16:[1,181]},{10:[1,182]},e(M,[2,27]),e(M,[2,95]),e(M,[2,101]),e(at,[2,104]),{8:n,9:183,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{6:6,7:s,8:n,9:20,11:184,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{8:n,9:185,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},{16:[1,186]},e(M,[2,102]),e(T,[2,3]),{10:[1,187]},e(T,[2,6]),{6:6,7:s,8:n,9:20,11:188,13:7,14:r,15:o,16:a,17:l,18:8,19:h,20:c,21:d,22:9,23:u,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:C,77:x,78:_,79:P,80:S,82:w,91:E,93:k},e(T,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(t,e){if(!e.recoverable){var i=new Error(t);throw i.hash=e,i}this.trace(t)},parse:function(t){var e=this,i=[0],s=[null],n=[],r=this.table,o="",a=0,l=0,h=0,c=n.slice.call(arguments,1),d=Object.create(this.lexer),u={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(u.yy[p]=this.yy[p]);d.setInput(t,u.yy),u.yy.lexer=d,u.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var f=d.yylloc;n.push(f);var m=d.options&&d.options.ranges;this.parseError="function"==typeof u.yy.parseError?u.yy.parseError:Object.getPrototypeOf(this).parseError;for(var g,b,y,v,C,x,_,P,S=function(){var t;return"number"!=typeof(t=d.lex()||1)&&(t=e.symbols_[t]||t),t},w={};;){if(this.defaultActions[y=i[i.length-1]]?v=this.defaultActions[y]:(null!=g||(g=S()),v=r[y]&&r[y][g]),void 0===v||!v.length||!v[0]){var E="";for(x in P=[],r[y])this.terminals_[x]&&x>2&&P.push("'"+this.terminals_[x]+"'");E=d.showPosition?"Parse error on line "+(a+1)+":\n"+d.showPosition()+"\nExpecting "+P.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(E,{text:d.match,token:this.terminals_[g]||g,line:d.yylineno,loc:f,expected:P})}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+g);switch(v[0]){case 1:i.push(g),s.push(d.yytext),n.push(d.yylloc),i.push(v[1]),g=null,b?(g=b,b=null):(l=d.yyleng,o=d.yytext,a=d.yylineno,f=d.yylloc,h>0&&h--);break;case 2:if(w.$=s[s.length-(_=this.productions_[v[1]][1])],w._$={first_line:n[n.length-(_||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(_||1)].first_column,last_column:n[n.length-1].last_column},m&&(w._$.range=[n[n.length-(_||1)].range[0],n[n.length-1].range[1]]),void 0!==(C=this.performAction.apply(w,[o,l,a,u.yy,v[1],s,n].concat(c))))return C;_&&(i=i.slice(0,-1*_*2),s=s.slice(0,-1*_),n=n.slice(0,-1*_)),i.push(this.productions_[v[1]][0]),s.push(w.$),n.push(w._$),i.push(r[i[i.length-2]][i[i.length-1]]);break;case 3:return!0}}return!0}},ht={node:function(t,e,i){return{type:t,value:e,children:i}},createNode:function(t,e,i,s){var n,r=this.node(e,i,[]);for(n=3;n<arguments.length;n++)r.children.push(arguments[n]);return r.line=t[0],r.col=t[1],r.eline=t[2],r.ecol=t[3],r}},ct=function(t){return[t.first_line,t.first_column,t.last_line,t.last_column]};return lt.lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===s.length?this.yylloc.first_column:0)+s[s.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var i,s,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),(s=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],i=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return i;if(this._backtrack){for(var r in n)this[r]=n[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,i,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),r=0;r<n.length;r++)if((i=this._input.match(this.rules[n[r]]))&&(!e||i[0].length>e[0].length)){if(e=i,s=r,this.options.backtrack_lexer){if(!1!==(t=this.test_match(i,n[r])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,n[s]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,i,s){switch(i){case 0:break;case 1:case 2:return 78;case 3:case 4:return 77;case 5:case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}},t.prototype=lt,lt.Parser=t,new t}();return void 0!==require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode})),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],(function(t,e,i,s,n,r,o,a,l,h,c,d){"use strict";return t.Point=function(t,e,i){this.constructor(t,i,o.OBJECT_TYPE_POINT,o.OBJECT_CLASS_POINT),this.element=this.board.select(i.anchor),this.coordsConstructor(e),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},t.Point.prototype=new a,h.copyPrototypeMethods(t.Point,d,"coordsConstructor"),t.extend(t.Point.prototype,{hasPoint:function(t,e){var i,s=this.coords.scrCoords,n=h.evaluate(this.visProp.sizeunit);return i=parseFloat(h.evaluate(this.visProp.size)),"user"===n&&(i*=Math.sqrt(this.board.unitX*this.board.unitY)),(i+=.5*parseFloat(h.evaluate(this.visProp.strokewidth)))<this.board.options.precision.hasPoint&&(i=this.board.options.precision.hasPoint),Math.abs(s[1]-t)<i+2&&Math.abs(s[2]-e)<i+2},update:function(t){return this.needsUpdate?(this.updateCoords(t),h.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var t,e;if(0===this.transformations.length||null===this.baseElement)return this;for(t=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(o.COORDS_BY_USER,t),e=1;e<this.transformations.length;e++)this.coords.setCoordinates(o.COORDS_BY_USER,this.transformations[e].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(t,e,i,n){var r;t=this.board.select(t),e=this.board.select(e),r=s.intersectionFunction(this.board,t,e,i,n,h.evaluate(this.visProp.alwaysintersect)),this.addConstraint([r]);try{t.addChild(this),e.addChild(this)}catch(i){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof t+"' and '"+typeof e+"'.")}this.type=o.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[t.id,e.id,i,n],this.generatePolynomial=function(){var i=t.generatePolynomial(this),s=e.generatePolynomial(this);return 0===i.length||0===s.length?[]:[i[0],s[0]]},this.prepareUpdate().update()},setStyle:function(t){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][t],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][t],this.board.renderer.changePointStyle(this),this},normalizeFace:function(i){return t.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),e.normalizePointFace(i)},face:function(e){t.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:e})},size:function(e){t.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:e})},cloneToBackground:function(){var t={};return t.id=this.id+"T"+this.numTraces,this.numTraces+=1,t.coords=this.coords,t.visProp=h.deepCopy(this.visProp,this.visProp.traceattributes,!0),t.visProp.layer=this.board.options.layer.trace,t.elementClass=o.OBJECT_CLASS_POINT,t.board=this.board,h.clearVisPropOld(t),t.visPropCalc={visible:h.evaluate(t.visProp.visible)},this.board.renderer.drawPoint(t),this.traces[t.id]=t.rendNode,this}}),t.createPoint=function(e,i,s){var n,r;if(r=h.copyAttributes(s,e.options,"point"),!(n=d.create(t.Point,e,i,r)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return n},t.createGlider=function(t,e,i){var s,n,r=h.copyAttributes(i,t.options,"glider");return n=1===e.length?[0,0]:e.slice(0,2),(s=t.create("point",n,r)).makeGlider(e[e.length-1]),s},t.createIntersectionPoint=function(t,e,i){var n,r,a,l,c,d,u=h.copyAttributes(i,t.options,"intersection");e.push(0,0),r=t.select(e[0]),a=t.select(e[1]),c=e[2]||0,d=e[3]||0,n=t.create("point",[0,0,0],u),l=s.intersectionFunction(t,r,a,c,d,n.visProp.alwaysintersect),n.addConstraint([l]);try{r.addChild(n),a.addChild(n)}catch(t){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.")}return n.type=o.OBJECT_TYPE_INTERSECTION,n.elType="intersection",n.setParents([r.id,a.id]),n.intersectionNumbers=[c,d],n.getParents=function(){return this.parents.concat(this.intersectionNumbers)},n.generatePolynomial=function(){var t=r.generatePolynomial(n),e=a.generatePolynomial(n);return 0===t.length||0===e.length?[]:[t[0],e[0]]},n},t.createOtherIntersectionPoint=function(t,e,n){var r,a,l,c;if(3!==e.length||!h.isPoint(e[2])||e[0].elementClass!==o.OBJECT_CLASS_LINE&&e[0].elementClass!==o.OBJECT_CLASS_CIRCLE||e[1].elementClass!==o.OBJECT_CLASS_LINE&&e[1].elementClass!==o.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof e[0]+"',  '"+typeof e[1]+"'and  '"+typeof e[2]+"'.\nPossible parent types: [circle|line,circle|line,point]");return a=t.select(e[0]),l=t.select(e[1]),c=t.select(e[2]),(r=t.create("point",[function(){var t=s.meet(a.stdform,l.stdform,0,a.board);return Math.abs(c.X()-t.usrCoords[1])>i.eps||Math.abs(c.Y()-t.usrCoords[2])>i.eps||Math.abs(c.Z()-t.usrCoords[0])>i.eps?t:s.meet(a.stdform,l.stdform,1,a.board)}],n)).type=o.OBJECT_TYPE_INTERSECTION,r.elType="otherintersection",r.setParents([a.id,l.id,c]),a.addChild(r),l.addChild(r),r.generatePolynomial=function(){var t=a.generatePolynomial(r),e=l.generatePolynomial(r);return 0===t.length||0===e.length?[]:[t[0],e[0]]},r},t.createPolePoint=function(e,i,s){var n,r,a,l,h,c,d;if(i.length>1&&(l=i[0].type===o.OBJECT_TYPE_CONIC||i[0].elementClass===o.OBJECT_CLASS_CIRCLE,h=i[1].type===o.OBJECT_TYPE_CONIC||i[1].elementClass===o.OBJECT_CLASS_CIRCLE,c=i[0].elementClass===o.OBJECT_CLASS_LINE,d=i[1].elementClass===o.OBJECT_CLASS_LINE),2!==i.length||!(l&&d||c&&h))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent type: [conic|circle,line], [line,conic|circle]");return d?(r=e.select(i[0]),a=e.select(i[1])):(r=e.select(i[1]),a=e.select(i[0])),(n=e.create("point",[function(){var e=r.quadraticform,i=a.stdform.slice(0,3);return[t.Math.Numerics.det([i,e[1],e[2]]),t.Math.Numerics.det([e[0],i,e[2]]),t.Math.Numerics.det([e[0],e[1],i])]}],s)).elType="polepoint",n.setParents([r.id,a.id]),r.addChild(n),a.addChild(n),n},t.registerElement("point",t.createPoint),t.registerElement("glider",t.createGlider),t.registerElement("intersection",t.createIntersectionPoint),t.registerElement("otherintersection",t.createOtherIntersectionPoint),t.registerElement("polepoint",t.createPolePoint),{Point:t.Point,createPoint:t.createPoint,createGlider:t.createGlider,createIntersection:t.createIntersectionPoint,createOtherIntersection:t.createOtherIntersectionPoint,createPolePoint:t.createPolePoint}})),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],(function(t,e,i,s,n,r,o,a,l,h){"use strict";return t.Line=function(e,i,s,n){this.constructor(e,n,r.OBJECT_TYPE_LINE,r.OBJECT_CLASS_LINE),this.point1=this.board.select(i),this.point2=this.board.select(s),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=t.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},t.Line.prototype=new a,t.extend(t.Line.prototype,{hasPoint:function(t,s){var n,a,h,c,d,u,p,f,m=[],g=[1,t,s],b=l.evaluate(this.visProp.strokewidth);return f=this.board.options.precision.hasPoint+.5*b,m[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,m[1]=this.stdform[1]/this.board.unitX,m[2]=this.stdform[2]/-this.board.unitY,n=i.distPointLine(g,m),!(isNaN(n)||n>f||(!l.evaluate(this.visProp.straightfirst)||!l.evaluate(this.visProp.straightlast))&&(h=this.point1.coords,c=this.point2.coords,a=[0,m[1],m[2]],a=e.crossProduct(a,g),a=e.crossProduct(a,m),a[1]/=a[0],a[2]/=a[0],a[0]=1,a=new o(r.COORDS_BY_SCREEN,a.slice(1),this.board).usrCoords,d=h.distance(r.COORDS_BY_USER,c),h=h.usrCoords.slice(0),c=c.usrCoords.slice(0),d<e.eps?u=0:(d===Number.POSITIVE_INFINITY&&(d=1/e.eps,Math.abs(c[0])<e.eps?(d/=i.distance([0,0,0],c),c=[1,h[1]+c[1]*d,h[2]+c[2]*d]):(d/=i.distance([0,0,0],h),h=[1,c[1]+h[1]*d,c[2]+h[2]*d])),p=1,d=c[p]-h[p],Math.abs(d)<e.eps&&(p=2,d=c[p]-h[p]),u=(a[p]-h[p])/d),!l.evaluate(this.visProp.straightfirst)&&u<0||!l.evaluate(this.visProp.straightlast)&&u>1))},update:function(){var t;return this.needsUpdate?(this.constrained&&(l.isFunction(this.funps)?(t=this.funps())&&t.length&&2===t.length&&(this.point1=t[0],this.point2=t[1]):(l.isFunction(this.funp1)&&(t=this.funp1(),l.isPoint(t)?this.point1=t:t&&t.length&&2===t.length&&this.point1.setPositionDirectly(r.COORDS_BY_USER,t)),l.isFunction(this.funp2)&&(t=this.funp2(),l.isPoint(t)?this.point2=t:t&&t.length&&2===t.length&&this.point2.setPositionDirectly(r.COORDS_BY_USER,t)))),this.updateSegmentFixedLength(),this.updateStdform(),l.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var t,i,s,n,o,a,h,c;return this.hasFixedLength?(t=this.point1.Dist(this.point2),i=this.fixedLength(),s=this.fixedLengthOldCoords[0].distance(r.COORDS_BY_USER,this.point1.coords),n=this.fixedLengthOldCoords[1].distance(r.COORDS_BY_USER,this.point2.coords),(s>e.eps||n>e.eps||t!==i)&&(o=this.point1.isDraggable&&this.point1.type!==r.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point1.visProp.fixed),a=this.point2.isDraggable&&this.point2.type!==r.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point2.visProp.fixed),t>e.eps?s>n&&a||s<=n&&a&&!o?(this.point2.setPositionDirectly(r.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*i/t,this.point1.Y()+(this.point2.Y()-this.point1.Y())*i/t]),this.point2.fullUpdate()):(s<=n&&o||s>n&&o&&!a)&&(this.point1.setPositionDirectly(r.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*i/t,this.point2.Y()+(this.point1.Y()-this.point2.Y())*i/t]),this.point1.fullUpdate()):(h=Math.random()-.5,c=Math.random()-.5,t=Math.sqrt(h*h+c*c),a?(this.point2.setPositionDirectly(r.COORDS_BY_USER,[this.point1.X()+h*i/t,this.point1.Y()+c*i/t]),this.point2.fullUpdate()):o&&(this.point1.setPositionDirectly(r.COORDS_BY_USER,[this.point2.X()+h*i/t,this.point2.Y()+c*i/t]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(r.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(r.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var t=e.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=t[0],this.stdform[1]=t[1],this.stdform[2]=t[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&e.innerProduct(this.stdform,this.stdform,3)>=e.eps*e.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(t){var e=this.point1.symbolic.x,i=this.point1.symbolic.y,s=this.point2.symbolic.x,n=this.point2.symbolic.y,r=t.symbolic.x,o=t.symbolic.y;return[["(",i,")*(",r,")-(",i,")*(",s,")+(",o,")*(",s,")-(",e,")*(",o,")+(",e,")*(",n,")-(",r,")*(",n,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=e.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=e.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(t,e){return this.visProp.straightfirst=t,this.visProp.straightlast=e,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new o(r.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(t){l.exists(this.label)&&(this.label.relativeCoords=new o(r.COORDS_BY_SCREEN,[t[0],-t[1]],this.board))},getLabelAnchor:function(){var t,s,n=0,a=new o(r.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),h=new o(r.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),c=l.evaluate(this.visProp.straightfirst),d=l.evaluate(this.visProp.straightlast);if((c||d)&&i.calcStraight(this,a,h,0),a=a.scrCoords,h=h.scrCoords,!l.exists(this.label))return new o(r.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(l.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":a[1]<=h[1]?(t=a[1],s=a[2]):(t=h[1],s=h[2]);break;case"rt":case"lrt":case"urt":a[1]>h[1]?(t=a[1],s=a[2]):(t=h[1],s=h[2]);break;default:t=.5*(a[1]+h[1]),s=.5*(a[2]+h[2])}return(c||d)&&(l.exists(this.label)&&(n=l.evaluate(this.label.visProp.fontsize)),Math.abs(t)<e.eps?t=n+0:this.board.canvasWidth+e.eps>t&&t>this.board.canvasWidth-n-e.eps&&(t=this.board.canvasWidth-n),e.eps+n>s&&s>-e.eps?s=n:this.board.canvasHeight+e.eps>s&&s>this.board.canvasHeight-n-e.eps&&(s=this.board.canvasHeight-n)),new o(r.COORDS_BY_SCREEN,[t,s],this.board)},cloneToBackground:function(){var t,e,i,s={};return s.id=this.id+"T"+this.numTraces,s.elementClass=r.OBJECT_CLASS_LINE,this.numTraces++,s.point1=this.point1,s.point2=this.point2,s.stdform=this.stdform,s.board=this.board,s.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0),s.visProp.layer=this.board.options.layer.trace,l.clearVisPropOld(s),s.visPropCalc={visible:l.evaluate(s.visProp.visible)},e=this.getSlope(),t=this.getRise(),s.getSlope=function(){return e},s.getRise=function(){return t},i=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(s),this.board.renderer.enhancedRendering=i,this.traces[s.id]=s.rendNode,this},addTransform:function(t){var e,i=l.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.point1.transformations.push(i[e]),this.point2.transformations.push(i[e]);return this},snapToGrid:function(t){var e,s,a,h,c,d,u,p;return l.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):l.exists(t)&&(u=l.evaluate(this.visProp.snapsizex),p=l.evaluate(this.visProp.snapsizey),c=(e=new o(r.COORDS_BY_SCREEN,[t.Xprev,t.Yprev],this.board)).usrCoords[1],d=e.usrCoords[2],u<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(u=(h=this.board.defaultAxes.x.defaultTicks).ticksDelta*(l.evaluate(h.visProp.minorticks)+1)),p<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(p=(h=this.board.defaultAxes.y.defaultTicks).ticksDelta*(l.evaluate(h.visProp.minorticks)+1)),u>0&&p>0&&(s=i.projectPointToLine({coords:e},this,this.board),a=n.subtract([1,Math.round(c/u)*u,Math.round(d/p)*p],s.usrCoords),this.board.create("transform",a.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var t=l.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(t),this.point2.handleSnapToPoints(t)),this},X:function(t){var i,s=this.stdform[2];return i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],t=2*(t-.5),(1-Math.abs(t))*i-t*s},Y:function(t){var i,s=this.stdform[1];return i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],t=2*(t-.5),(1-Math.abs(t))*i+t*s},Z:function(t){var i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return t=2*(t-.5),(1-Math.abs(t))*i},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var t=this.point1.coords.usrCoords,e=this.point2.coords.usrCoords;return[Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[1],e[1]),Math.min(t[2],e[2])]},addTicks:function(t){return""!==t.id&&l.exists(t.id)||(t.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(t),this.ticks.push(t),t.id},remove:function(){this.removeAllTicks(),a.prototype.remove.call(this)},removeAllTicks:function(){var t;for(t=this.ticks.length;t>0;t--)this.removeTicks(this.ticks[t-1]);this.ticks=[],this.board.update()},removeTicks:function(t){var e,i;for(l.exists(this.defaultTicks)&&this.defaultTicks===t&&(this.defaultTicks=null),e=this.ticks.length;e>0;e--)if(this.ticks[e-1]===t){if(this.board.removeObject(this.ticks[e-1]),this.ticks[e-1].ticks)for(i=0;i<this.ticks[e-1].ticks.length;i++)l.exists(this.ticks[e-1].labels[i])&&this.board.removeObject(this.ticks[e-1].labels[i]);delete this.ticks[e-1];break}}}),t.createLine=function(e,i,s){var n,r,o,a,c,d,u,p=[],f=!1,m=!1;if(2===i.length){if(l.isArray(i[0])&&i[0].length>1)d=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",i[0],d);else if(l.isString(i[0])||l.isPoint(i[0]))o=e.select(i[0]);else if(l.isFunction(i[0])&&l.isPoint(i[0]()))o=i[0](),m=!0;else if(l.isFunction(i[0])&&i[0]().length&&i[0]().length>=2)d=l.copyAttributes(s,e.options,"line","point1"),o=h.createPoint(e,i[0](),d),m=!0;else{if(!l.isObject(i[0])||!l.isTransformationOrArray(i[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");f=!0,d=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",[i[0].point1,i[1]],d)}if(f)d=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",[i[0].point2,i[1]],d);else if(l.isArray(i[1])&&i[1].length>1)d=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",i[1],d);else if(l.isString(i[1])||l.isPoint(i[1]))a=e.select(i[1]);else if(l.isFunction(i[1])&&l.isPoint(i[1]()))a=i[1](),m=!0;else{if(!(l.isFunction(i[1])&&i[1]().length&&i[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");d=l.copyAttributes(s,e.options,"line","point2"),a=h.createPoint(e,i[1](),d),m=!0}d=l.copyAttributes(s,e.options,"line"),r=new t.Line(e,o,a,d),m?(r.constrained=!0,r.funp1=i[0],r.funp2=i[1]):f||(r.isDraggable=!0),r.setParents([o.id,a.id])}else if(3===i.length){for(u=!0,c=0;c<3;c++)if(l.isNumber(i[c]))p[c]=l.createFunction(i[c]);else{if(!l.isFunction(i[c]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");p[c]=i[c],u=!1}d=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",u?[p[2]()*p[2]()+p[1]()*p[1](),p[2]()-p[1]()*p[0]()+p[2](),-p[1]()-p[2]()*p[0]()-p[1]()]:[function(){return.5*(p[2]()*p[2]()+p[1]()*p[1]())},function(){return.5*(p[2]()-p[1]()*p[0]()+p[2]())},function(){return.5*(-p[1]()-p[2]()*p[0]()-p[1]())}],d),d=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",u?[p[2]()*p[2]()+p[1]()*p[1](),-p[1]()*p[0]()+p[2](),-p[2]()*p[0]()-p[1]()]:[function(){return p[2]()*p[2]()+p[1]()*p[1]()},function(){return-p[1]()*p[0]()+p[2]()},function(){return-p[2]()*p[0]()-p[1]()}],d),o.prepareUpdate().update(),a.prepareUpdate().update(),d=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,o,a,d)).isDraggable=u,r.setParents([o,a])}else if(1===i.length&&l.isFunction(i[0])&&2===i[0]().length&&l.isPoint(i[0]()[0])&&l.isPoint(i[0]()[1]))n=i[0](),d=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,n[0],n[1],d)).constrained=!0,r.funps=i[0],r.setParents(n);else{if(!(1===i.length&&l.isFunction(i[0])&&3===i[0]().length&&l.isNumber(i[0]()[0])&&l.isNumber(i[0]()[1])&&l.isNumber(i[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");n=i[0],d=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",[function(){var t=n();return[.5*(t[2]*t[2]+t[1]*t[1]),.5*(t[2]-t[1]*t[0]+t[2]),.5*(-t[1]-t[2]*t[0]-t[1])]}],d),d=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",[function(){var t=n();return[t[2]*t[2]+t[1]*t[1],-t[1]*t[0]+t[2],-t[2]*t[0]-t[1]]}],d),d=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,o,a,d)).constrained=!0,r.funps=i[0],r.setParents([o,a])}return r},t.registerElement("line",t.createLine),t.createSegment=function(t,e,i){var s,n;if(i.straightFirst=!1,i.straightLast=!1,n=l.copyAttributes(i,t.options,"segment"),s=t.create("line",e.slice(0,2),n),3===e.length){if(s.hasFixedLength=!0,l.isNumber(e[2]))s.fixedLength=function(){return e[2]};else{if(!l.isFunction(e[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof e[2]+"'.\nPossible third parent types: number or function");s.fixedLength=e[2]}s.getParents=function(){return this.parents.concat(this.fixedLength())},s.fixedLengthOldCoords=[],s.fixedLengthOldCoords[0]=new o(r.COORDS_BY_USER,s.point1.coords.usrCoords.slice(1,3),t),s.fixedLengthOldCoords[1]=new o(r.COORDS_BY_USER,s.point2.coords.usrCoords.slice(1,3),t)}return s.elType="segment",s},t.registerElement("segment",t.createSegment),t.createArrow=function(t,e,i){var s;return i.firstArrow=!1,i.lastArrow=!0,(s=t.create("line",e,i).setStraight(!1,!1)).type=r.OBJECT_TYPE_VECTOR,s.elType="arrow",s},t.registerElement("arrow",t.createArrow),t.createAxis=function(t,e,i){var s,n,o,a,h;if(!l.isArray(e[0])&&!l.isPoint(e[0])||!l.isArray(e[1])&&!l.isPoint(e[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");for(a in s=l.copyAttributes(i,t.options,"axis"),(o=t.create("line",e,s)).type=r.OBJECT_TYPE_AXIS,o.isDraggable=!1,o.point1.isDraggable=!1,o.point2.isDraggable=!1,o.ancestors)o.ancestors.hasOwnProperty(a)&&(o.ancestors[a].type=r.OBJECT_TYPE_AXISPOINT);return n=l.copyAttributes(i,t.options,"axis","ticks"),h=l.exists(n.ticksdistance)?n.ticksdistance:l.isArray(n.ticks)?n.ticks:1,o.defaultTicks=t.create("ticks",[o,h],n),o.defaultTicks.dump=!1,o.elType="axis",o.subs={ticks:o.defaultTicks},o.inherits.push(o.defaultTicks),o},t.registerElement("axis",t.createAxis),t.createTangent=function(t,i,n){var o,a,h,c,d,u,p;if(1===i.length)a=(o=i[0]).slideObject;else{if(2!==i.length)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(l.isPoint(i[0]))o=i[0],a=i[1];else{if(!l.isPoint(i[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");a=i[0],o=i[1]}}if(a.elementClass===r.OBJECT_CLASS_LINE?(p=t.create("line",[a.point1,a.point2],n)).glider=o:a.elementClass===r.OBJECT_CLASS_CURVE&&a.type!==r.OBJECT_TYPE_CONIC?"plot"!==l.evaluate(a.visProp.curvetype)?(h=a.X,c=a.Y,p=t.create("line",[function(){return-o.X()*s.D(c)(o.position)+o.Y()*s.D(h)(o.position)},function(){return s.D(c)(o.position)},function(){return-s.D(h)(o.position)}],n),o.addChild(p),p.glider=o):(p=t.create("line",[function(){var t,e,i=Math.floor(o.position);return i===a.numberPoints-1&&i--,i<0?1:(t=a.points[i].usrCoords)[2]*(e=a.points[i+1].usrCoords)[1]-t[1]*e[2]},function(){var t=Math.floor(o.position);return t===a.numberPoints-1&&t--,t<0?0:a.points[t+1].usrCoords[2]-a.points[t].usrCoords[2]},function(){var t=Math.floor(o.position);return t===a.numberPoints-1&&t--,t<0?0:a.points[t].usrCoords[1]-a.points[t+1].usrCoords[1]}],n),o.addChild(p),p.glider=o):a.type===r.OBJECT_TYPE_TURTLE?(p=t.create("line",[function(){var t=Math.floor(o.position);for(d=0;d<a.objects.length;d++)if((u=a.objects[d]).type===r.OBJECT_TYPE_CURVE){if(t<u.numberPoints)break;t-=u.numberPoints}return t===u.numberPoints-1&&t--,t<0?1:u.Y(t)*u.X(t+1)-u.X(t)*u.Y(t+1)},function(){var t=Math.floor(o.position);for(d=0;d<a.objects.length;d++)if((u=a.objects[d]).type===r.OBJECT_TYPE_CURVE){if(t<u.numberPoints)break;t-=u.numberPoints}return t===u.numberPoints-1&&t--,t<0?0:u.Y(t+1)-u.Y(t)},function(){var t=Math.floor(o.position);for(d=0;d<a.objects.length;d++)if((u=a.objects[d]).type===r.OBJECT_TYPE_CURVE){if(t<u.numberPoints)break;t-=u.numberPoints}return t===u.numberPoints-1&&t--,t<0?0:u.X(t)-u.X(t+1)}],n),o.addChild(p),p.glider=o):a.elementClass!==r.OBJECT_CLASS_CIRCLE&&a.type!==r.OBJECT_TYPE_CONIC||(p=t.create("line",[function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[0]},function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[1]},function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[2]}],n),o.addChild(p),p.glider=o),!l.exists(p))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return p.elType="tangent",p.type=r.OBJECT_TYPE_TANGENT,p.setParents(i),p},t.createRadicalAxis=function(t,i,s){var n,o,a;if(2!==i.length||i[0].elementClass!==r.OBJECT_CLASS_CIRCLE||i[1].elementClass!==r.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent type: [circle,circle]");return o=t.select(i[0]),a=t.select(i[1]),(n=t.create("line",[function(){var t=o.stdform,i=a.stdform;return e.matVecMult(e.transpose([t.slice(0,3),i.slice(0,3)]),[i[3],-t[3]])}],s)).elType="radicalaxis",n.setParents([o.id,a.id]),o.addChild(n),a.addChild(n),n},t.createPolarLine=function(t,e,i){var s,n,o,a,h,c,d;if(e.length>1&&(a=e[0].type===r.OBJECT_TYPE_CONIC||e[0].elementClass===r.OBJECT_CLASS_CIRCLE,h=e[1].type===r.OBJECT_TYPE_CONIC||e[1].elementClass===r.OBJECT_CLASS_CIRCLE,c=l.isPoint(e[0]),d=l.isPoint(e[1])),2!==e.length||!(a&&d||c&&h))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent type: [conic|circle,point], [point,conic|circle]");return d?(n=t.select(e[0]),o=t.select(e[1])):(n=t.select(e[1]),o=t.select(e[0])),(s=t.create("tangent",[n,o],i)).elType="polarline",s},t.registerElement("tangent",t.createTangent),t.registerElement("polar",t.createTangent),t.registerElement("radicalaxis",t.createRadicalAxis),t.registerElement("polarline",t.createPolarLine),{Line:t.Line,createLine:t.createLine,createTangent:t.createTangent,createPolar:t.createTangent,createSegment:t.createSegment,createAxis:t.createAxis,createArrow:t.createArrow,createRadicalAxis:t.createRadicalAxis,createPolarLine:t.createPolarLine}})),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],(function(t,e,i,s,n,r,o,a,l,h,c,d){"use strict";return t.Curve=function(t,i,s){this.constructor(t,s,e.OBJECT_TYPE_CURVE,e.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=h.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,this.varname=h.exists(i[0])?i[0]:"x",this.xterm=i[1],this.yterm=i[2],this.generateTerm(this.varname,this.xterm,this.yterm,i[3],i[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),h.isString(this.xterm)&&this.notifyParents(this.xterm),h.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=h.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},t.Curve.prototype=new s,t.extend(t.Curve.prototype,{minX:function(){return"polar"===h.evaluate(this.visProp.curvetype)?0:new i(e.COORDS_BY_SCREEN,[0,0],this.board,!1).usrCoords[1]},maxX:function(){return"polar"===h.evaluate(this.visProp.curvetype)?2*Math.PI:new i(e.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(t){return NaN},Y:function(t){return NaN},Z:function(t){return 1},hasPoint:function(t,s,r){var o,l,c,d,u,p,f,m,g,b,y,v,C,x=[],_=h.evaluate(this.visProp.numberpointslow),P=(this.maxX()-this.minX())/_,S=this.board.options.precision.hasPoint,w=1/0;if(t=(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board,!1)).usrCoords[1],s=l.usrCoords[2],S+=.5*h.evaluate(this.visProp.strokewidth),S*=S,y=this.board.unitX*this.board.unitX,v=this.board.unitY*this.board.unitY,"parameter"===(C=h.evaluate(this.visProp.curvetype))||"polar"===C)for(this.transformations.length>0&&(this.updateTransformMatrix(),d=n.inverse(this.transformMat),t=(u=n.matVecMult(d,[1,t,s]))[1],s=u[2]),p=0,o=this.minX();p<_;p++){if((w=(t-(f=this.X(o,!0)))*(t-f)*y+(s-(m=this.Y(o,!0)))*(s-m)*v)<=S)return!0;o+=P}else if("plot"===C||"functiongraph"===C){for((!h.exists(r)||r<0)&&(r=0),h.exists(this.qdt)&&h.evaluate(this.visProp.useqdt)&&3!==this.bezierDegree?c=(g=(b=this.qdt.query(new i(e.COORDS_BY_USER,[t,s],this.board))).points).length:(g=this.points,c=this.numberPoints-1),p=r;p<c;p++)if(3===this.bezierDegree?x.push(a.projectCoordsToBeziersegment([1,t,s],this,p)):b?(g[p].prev&&(x=a.projectCoordsToSegment([1,t,s],g[p].prev.usrCoords,g[p].usrCoords)),g[p].next&&g[p+1]!==g[p].next&&(x=a.projectCoordsToSegment([1,t,s],g[p].usrCoords,g[p].next.usrCoords))):x=a.projectCoordsToSegment([1,t,s],g[p].usrCoords,g[p+1].usrCoords),x[1]>=0&&x[1]<=1&&(t-x[0][1])*(t-x[0][1])*y+(s-x[0][2])*(s-x[0][2])*v<=S)return!0;return!1}return w<S},allocatePoints:function(){var t,s;if(s=this.numberPoints,this.points.length<this.numberPoints)for(t=this.points.length;t<s;t++)this.points[t]=new i(e.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(h.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var t,i,s,n,r,a,l=!1;if(this.updateTransformMatrix(),this.updateDataArray(),i=this.minX(),s=this.maxX(),h.exists(this.dataX))for(this.numberPoints=this.dataX.length,t=this.numberPoints,this.allocatePoints(),a=0;a<t;a++)n=a,h.exists(this.dataY)?(r=a,this.points[a].setCoordinates(e.COORDS_BY_USER,[this.dataX[a],this.dataY[a]],!1)):(r=this.X(n),this.points[a].setCoordinates(e.COORDS_BY_USER,[this.dataX[a],this.Y(r,l)],!1)),this.points[a]._t=a,this.updateTransform(this.points[a]),l=!0;else{if(h.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(i,s):h.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(i,s):(this.numberPoints=h.evaluate(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.visProp.numberpointshigh:this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(i,s,this.numberPoints)),t=this.numberPoints,h.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new d(this.board.getBoundingBox()),a=0;a<this.points.length;a++)this.qdt.insert(this.points[a]),a>0&&(this.points[a].prev=this.points[a-1]),a<t-1&&(this.points[a].next=this.points[a+1]);for(a=0;a<t;a++)this.updateTransform(this.points[a])}return"plot"!==h.evaluate(this.visProp.curvetype)&&h.evaluate(this.visProp.rdpsmoothing)&&(this.points=o.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var t,e,i=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],e=0;e<i;e++)(t=this.transformations[e]).update(),this.transformMat=n.matMatMult(t.matrix,this.transformMat);return this},checkReal:function(){var t,e,i=!1,s=this.numberPoints;for(t=0;t<s;t++)if(e=this.points[t].usrCoords,!isNaN(e[1])&&!isNaN(e[2])&&Math.abs(e[0])>n.eps){i=!0;break}this.isReal=i},updateParametricCurveNaive:function(t,i,s){var n,r,o=!1,a=(i-t)/s;for(n=0;n<s;n++)this.points[n].setCoordinates(e.COORDS_BY_USER,[this.X(r=t+n*a,o),this.Y(r,o)],!1),this.points[n]._t=r,o=!0;return this},updateParametricCurveOld:function(s,r){var o,a,l,h,c,d,u,p,f,m,g,b=!1,y=new i(e.COORDS_BY_USER,[0,0],this.board,!1),v=[],C=[],x=[],_=[],P=!1,S=0;for(t.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(f=15,m=10,g=10):(f=21,m=.7,g=.7),_[0]=r-s,o=1;o<f;o++)_[o]=.5*_[o-1];o=1,v[0]=1,C[0]=0,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=s,b),this.Y(a,b)],!1),b=!0,c=y.scrCoords[1],d=y.scrCoords[2],t0=a,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=r,b),this.Y(a,b)],!1),x[0]=[l=y.scrCoords[1],h=y.scrCoords[2]],u=1,p=0,this.points=[],this.points[S++]=new i(e.COORDS_BY_SCREEN,[c,d],this.board,!1);do{for(P=this.isDistOK(l-c,h-d,m,g)||this.isSegmentOutside(c,d,l,h);p<f&&(!P||p<6)&&(p<=7||this.isSegmentDefined(c,d,l,h));)v[u]=o,C[u]=p,x[u]=[l,h],u+=1,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=s+(o=2*o-1)*_[++p],b),this.Y(a,b)],!1,!0),P=this.isDistOK((l=y.scrCoords[1])-c,(h=y.scrCoords[2])-d,m,g)||this.isSegmentOutside(c,d,l,h);S>1&&function(t,e,i){var s,r=i[1]-t[1],o=i[2]-t[2],a=e[0]-t[1],l=e[1]-t[2],h=a*a+l*l;return h>=n.eps&&(s=(r*a+o*l)/h)>0&&(s<=1?(r-=s*a,o-=s*l):(r-=a,o-=l)),Math.sqrt(r*r+o*o)}(this.points[S-2].scrCoords,[l,h],this.points[S-1].scrCoords)<.015&&(S-=1),this.points[S]=new i(e.COORDS_BY_SCREEN,[l,h],this.board,!1),this.points[S]._t=a,S+=1,c=l,d=h,t0=a,l=x[u-=1][0],h=x[u][1],p=C[u]+1,o=2*v[u]}while(u>0&&S<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(t,e,i,s){return e<0&&s<0||e>this.board.canvasHeight&&s>this.board.canvasHeight||t<0&&i<0||t>this.board.canvasWidth&&i>this.board.canvasWidth},isDistOK:function(t,e,i,s){return Math.abs(t)<i&&Math.abs(e)<s&&!isNaN(t+e)},isSegmentDefined:function(t,e,i,s){return!(isNaN(t+e)&&isNaN(i+s))},_insertPoint:function(t,e){var i=!isNaN(this._lastCrds[1]+this._lastCrds[2]),s=!isNaN(t.scrCoords[1]+t.scrCoords[2]);(!(s=s&&t.scrCoords[1]>-500&&t.scrCoords[2]>-500&&t.scrCoords[1]<this.board.canvasWidth+500&&t.scrCoords[2]<this.board.canvasHeight+500)&&i||s&&(!i||Math.abs(t.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(t.scrCoords[2]-this._lastCrds[2])>.7))&&(t._t=e,this.points.push(t),this._lastCrds=t.copy("scrCoords"))},_intersectWithBorder:function(t,e,i){var s,r,o;return i<=0?(0!==(s=n.crossProduct([-e[0],1,0],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):o=1/0,o<e[3]?0!==(s=n.crossProduct([-e[3],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0:o>e[1]&&(0!==(s=n.crossProduct([-e[1],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0)):(0!==(s=n.crossProduct([-e[2],1,0],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):o=1/0,o<e[3]?0!==(s=n.crossProduct([-e[3],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0:o>e[1]&&(0!==(s=n.crossProduct([-e[1],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0)),[1,r,o]},_borderCase:function(t,s,n,r,o,a,l){var h,c,d,u,p,f,m,g,b,y,v,C,x,_=null,P=!1;if(l<=1){c=new i(e.COORDS_BY_USER,[0,0],this.board,!1),u=0;do{if(isNaN(t[1]+t[2])&&!isNaN(n[1]+n[2]))p=r,f=a,m=o;else if(isNaN(s[1]+s[2])&&!isNaN(n[1]+n[2]))p=o,f=a,m=r;else if(isNaN(n[1]+n[2])&&!isNaN(s[1]+s[2]))p=a,f=o,m=o+(o-a);else{if(!isNaN(n[1]+n[2])||isNaN(t[1]+t[2]))return!1;p=a,f=r,m=r-(a-r)}c.setCoordinates(e.COORDS_BY_USER,[this.X(h=.5*(p+f),!0),this.Y(h,!0)],!1),d=c.usrCoords,(P=isNaN(d[1]+d[2]))?p=h:(m=f,f=h),++u}while(P&&u<30);if(u<30&&(_=d.slice(),n=d.slice(),f=h),C=((b=this.X(f,!0))-(v=this.X(m,!0)))/(f-m),x=((y=this.Y(f,!0))-this.Y(m,!0))/(f-m),g=this.board.getBoundingBox(),Math.sqrt(C*C+x*x)>500&&(_=this._intersectWithBorder([C*y-x*b,x,-C],g,b-v)),null!==_)return this._insertPoint(new i(e.COORDS_BY_USER,_,this.board,!1)),!0}return!1},_triangleDists:function(t,e,i){var s;return s=[t[0]*e[0],.5*(t[1]+e[1]),.5*(t[2]+e[2])],[a.distance(t,e,3),a.distance(t,i,3),a.distance(i,e,3),a.distance(i,s,3)]},_isUndefined:function(t,s,n,r){var o,a,l;if(!isNaN(t[1]+t[2])||!isNaN(n[1]+n[2]))return!1;for(l=new i(e.COORDS_BY_USER,[0,0],this.board,!1),a=0;a<20;++a)if(o=s+Math.random()*(r-s),l.setCoordinates(e.COORDS_BY_USER,[this.X(o,!0),this.Y(o,!0)],!1),!isNaN(l.scrCoords[0]+l.scrCoords[1]+l.scrCoords[2]))return!1;return!0},_isOutside:function(t,e,i,s){var n=this.board.canvasWidth,r=this.board.canvasHeight;return!!(t[1]<-500&&i[1]<-500||t[2]<-500&&i[2]<-500||t[1]>n+500&&i[1]>n+500||t[2]>r+500&&i[2]>r+500)},_plotRecursive:function(t,s,n,r,o,a){var l,h,c,d,u,p=0,f=new i(e.COORDS_BY_USER,[0,0],this.board,!1);if(!(this.numberPoints>65536))return o<this.nanLevel&&this._isUndefined(t,s,n,r)?this:o<this.nanLevel&&this._isOutside(t,s,n,r)?this:(f.setCoordinates(e.COORDS_BY_USER,[this.X(l=.5*(s+r),!0),this.Y(l,!0)],!1),this._borderCase(t,n,h=f.scrCoords,s,r,l,o)?this:(c=this._triangleDists(t,n,h),d=o<this.smoothLevel&&c[3]<a,u=o<this.jumpLevel&&(c[2]>.99*c[0]||c[1]>.99*c[0]||c[0]===1/0||c[1]===1/0||c[2]===1/0),o<this.smoothLevel+2&&c[0]<.5*(c[1]+c[2])&&(p=0,d=!1),--o,u?this._insertPoint(new i(e.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),l):o<=p||d?this._insertPoint(f,l):(this._plotRecursive(t,s,h,l,o,a),this._insertPoint(f,l),this._plotRecursive(h,l,n,r,o,a)),this))},updateParametricCurve:function(t,s){var n,r,o,a,l,c,d=!1,u=new i(e.COORDS_BY_USER,[0,0],this.board,!1),p=new i(e.COORDS_BY_USER,[0,0],this.board,!1);return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(l=h.evaluate(this.visProp.recursiondepthlow)||13,c=2,this.smoothLevel=5,this.jumpLevel=5):(l=h.evaluate(this.visProp.recursiondepthhigh)||17,c=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=l-4,this.points=[],u.setCoordinates(e.COORDS_BY_USER,[this.X(n=t,d),this.Y(n,d)],!1),o=u.copy("scrCoords"),p.setCoordinates(e.COORDS_BY_USER,[this.X(r=s,d=!0),this.Y(r,d)],!1),a=p.copy("scrCoords"),u._t=n,this.points.push(u),this._lastCrds=u.copy("scrCoords"),this._plotRecursive(o,n,a,r,l,c),p._t=r,this.points.push(p),this.numberPoints=this.points.length,this},updateTransform:function(t){var i;return this.transformations.length>0&&(i=n.matVecMult(this.transformMat,t.usrCoords),t.setCoordinates(e.COORDS_BY_USER,[i[1],i[2]],!1,!0)),t},addTransform:function(t){var e,i=h.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.transformations.push(i[e]);return this},interpolationFunctionFromArray:function(t){var e="data"+t;return function(t,i){var s,n,r,o,a=this[e],l=a.length,c=[];if(isNaN(t))return NaN;if(t<0)return h.isFunction(a[0])?a[0]():a[0];if(3===this.bezierDegree){if(t>=(l/=3))return h.isFunction(a[a.length-1])?a[a.length-1]():a[a.length-1];for(s=3*Math.floor(t),o=1-(r=t%1),n=0;n<4;n++)c[n]=h.isFunction(a[s+n])?a[s+n]():a[s+n];return o*o*(o*c[0]+3*r*c[1])+(3*o*c[2]+r*c[3])*r*r}if((s=t>l-2?l-2:parseInt(Math.floor(t),10))===t)return h.isFunction(a[s])?a[s]():a[s];for(n=0;n<2;n++)c[n]=h.isFunction(a[s+n])?a[s+n]():a[s+n];return c[0]+(c[1]-c[0])*(t-s)}},generateTerm:function(t,e,i,s,n){var r,o;h.isArray(e)?(this.dataX=e,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=h.createFunction(e,this.board,t),h.isString(e)?this.visProp.curvetype="functiongraph":(h.isFunction(e)||h.isNumber(e))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),h.isArray(i)?(this.dataY=i,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=h.createFunction(i,this.board,t),h.isFunction(e)&&h.isArray(i)&&(r=h.createFunction(i[0],this.board,""),o=h.createFunction(i[1],this.board,""),this.X=function(t){return e(t)*Math.cos(t)+r()},this.Y=function(t){return e(t)*Math.sin(t)+o()},this.visProp.curvetype="polar"),h.exists(s)&&(this.minX=h.createFunction(s,this.board,"")),h.exists(n)&&(this.maxX=h.createFunction(n,this.board,""))},notifyParents:function(t){var e,i,s,n=!1;for(e in s={xterm:1,yterm:1})if(s.hasOwnProperty(e)&&this.hasOwnProperty(e)&&this[e].origin)for(i in n=!0,this[e].origin.deps)this[e].origin.deps.hasOwnProperty(i)&&this[e].origin.deps[i].addChild(this);n||l.findDependencies(this,t,this.board)},getLabelAnchor:function(){var t,s,n,r=.05*this.board.canvasWidth,o=.05*this.board.canvasHeight,l=.95*this.board.canvasWidth,c=.95*this.board.canvasHeight;switch(h.evaluate(this.visProp.label.position)){case"ulft":s=r,n=o;break;case"llft":s=r,n=c;break;case"rt":s=l,n=.5*c;break;case"lrt":s=l,n=c;break;case"urt":s=l,n=o;break;case"top":s=.5*l,n=o;break;case"bot":s=.5*l,n=c;break;default:s=r,n=.5*c}return t=new i(e.COORDS_BY_SCREEN,[s,n],this.board,!1),a.projectCoordsToCurve(t.usrCoords[1],t.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var t,i={id:this.id+"T"+this.numTraces,elementClass:e.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:h.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return i.visProp.layer=this.board.options.layer.trace,i.visProp.curvetype=this.visProp.curvetype,this.numTraces++,h.clearVisPropOld(i),i.visPropCalc={visible:h.evaluate(i.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(i),this.board.renderer.enhancedRendering=t,this.traces[i.id]=i.rendNode,this},bounds:function(){var t,e,i,s=1/0,n=-1/0,r=1/0,a=-1/0,l=this.points.length;if(3===this.bezierDegree){for(t=0;t<l;t++)this.points[t].X=h.bind((function(){return this.usrCoords[1]}),this.points[t]),this.points[t].Y=h.bind((function(){return this.usrCoords[2]}),this.points[t]);return i=(e=o.bezier(this.points))[3](),s=o.fminbr((function(t){return e[0](t)}),[0,i]),n=o.fminbr((function(t){return-e[0](t)}),[0,i]),r=o.fminbr((function(t){return e[1](t)}),[0,i]),a=o.fminbr((function(t){return-e[1](t)}),[0,i]),s=e[0](s),n=e[0](n),r=e[1](r),[s,a=e[1](a),n,r]}for(t=0;t<l;t++)s>this.points[t].usrCoords[1]&&(s=this.points[t].usrCoords[1]),n<this.points[t].usrCoords[1]&&(n=this.points[t].usrCoords[1]),r>this.points[t].usrCoords[2]&&(r=this.points[t].usrCoords[2]),a<this.points[t].usrCoords[2]&&(a=this.points[t].usrCoords[2]);return[s,a,n,r]},getParents:function(){var t=[this.xterm,this.yterm,this.minX(),this.maxX()];return 0!==this.parents.length&&(t=this.parents),t},moveTo:function(t){var i;return this.points.length>0&&!h.evaluate(this.visProp.fixed)&&(i=this.points[0],this.setPosition(e.COORDS_BY_USER,3===t.length?[t[0]-i.usrCoords[0],t[1]-i.usrCoords[1],t[2]-i.usrCoords[2]]:[t[0]-i.usrCoords[1],t[1]-i.usrCoords[2]])),this}}),t.createCurve=function(i,s,n){var r,o,a=h.copyAttributes(n,i.options,"curve");return r=i.select(s[0]),h.isObject(r)&&(r.type===e.OBJECT_TYPE_CURVE||r.type===e.OBJECT_TYPE_ANGLE||r.type===e.OBJECT_TYPE_ARC||r.type===e.OBJECT_TYPE_CONIC||r.type===e.OBJECT_TYPE_SECTOR)&&h.isTransformationOrArray(s[1])?(r.type===e.OBJECT_TYPE_SECTOR?a=h.copyAttributes(n,i.options,"sector"):r.type===e.OBJECT_TYPE_ARC?a=h.copyAttributes(n,i.options,"arc"):r.type===e.OBJECT_TYPE_ANGLE?(h.exists(n.withLabel)||(n.withLabel=!1),a=h.copyAttributes(n,i.options,"angle")):a=h.copyAttributes(n,i.options,"curve"),a=h.copyAttributes(a,i.options,"curve"),(o=new t.Curve(i,["x",[],[]],a)).updateDataArray=function(){var t,e=r.numberPoints;for(this.bezierDegree=r.bezierDegree,this.dataX=[],this.dataY=[],t=0;t<e;t++)this.dataX.push(r.points[t].usrCoords[1]),this.dataY.push(r.points[t].usrCoords[2]);return this},o.addTransform(s[1]),o):(a=h.copyAttributes(n,i.options,"curve"),new t.Curve(i,["x"].concat(s),a))},t.registerElement("curve",t.createCurve),t.createFunctiongraph=function(e,i,s){var n,r=["x","x"].concat(i);return(n=h.copyAttributes(s,e.options,"curve")).curvetype="functiongraph",new t.Curve(e,r,n)},t.registerElement("functiongraph",t.createFunctiongraph),t.registerElement("plot",t.createFunctiongraph),t.createSpline=function(e,i,s){var n,r;return r=function(){var t,e=[],s=[];return function(n,r){var a,l,c;if(!r){if(e=[],s=[],2===i.length&&h.isArray(i[0])&&h.isArray(i[1])&&i[0].length===i[1].length)for(a=0;a<i[0].length;a++)h.isFunction(i[0][a])?e.push(i[0][a]()):e.push(i[0][a]),h.isFunction(i[1][a])?s.push(i[1][a]()):s.push(i[1][a]);else for(a=0;a<i.length;a++)if(h.isPoint(i[a]))e.push(i[a].X()),s.push(i[a].Y());else if(h.isArray(i[a])&&2===i[a].length)for(l=0;l<i.length;l++)h.isFunction(i[l][0])?e.push(i[l][0]()):e.push(i[l][0]),h.isFunction(i[l][1])?s.push(i[l][1]()):s.push(i[l][1]);else h.isFunction(i[a])&&2===i[a]().length&&(c=i[a](),e.push(c[0]),s.push(c[1]));t=o.splineDef(e,s)}return o.splineEval(n,e,s,t)}},(s=h.copyAttributes(s,e.options,"curve")).curvetype="functiongraph",(n=new t.Curve(e,["x","x",r()],s)).setParents(i),n.elType="spline",n},t.registerElement("spline",t.createSpline),t.createCardinalSpline=function(e,i,s){var n,r,a,l,c,d,u,p="\nPossible parent types: [points:array, tau:number|function, type:string]";if(!h.exists(i[0])||!h.isArray(i[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+p);if(!h.exists(i[1])||!h.isNumber(i[1])&&!h.isFunction(i[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+p);if(!h.exists(i[2])||!h.isString(i[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+p);if(s=h.copyAttributes(s,e.options,"curve"),(s=h.copyAttributes(s,e.options,"cardinalspline")).curvetype="parameter",a=i[0],l=[],!s.isarrayofcoordinates&&2===a.length&&h.isArray(a[0])&&h.isArray(a[1])&&a[0].length===a[1].length)for(c=0;c<a[0].length;c++)l[c]=[],h.isFunction(a[0][c])?l[c].push(a[0][c]()):l[c].push(a[0][c]),h.isFunction(a[1][c])?l[c].push(a[1][c]()):l[c].push(a[1][c]);else for(c=0;c<a.length;c++)h.isString(a[c])?l.push(e.select(a[c])):h.isPoint(a[c])?l.push(a[c]):h.isArray(a[c])&&2===a[c].length?(l[c]=[],h.isFunction(a[c][0])?l[c].push(a[c][0]()):l[c].push(a[c][0]),h.isFunction(a[c][1])?l[c].push(a[c][1]()):l[c].push(a[c][1])):h.isFunction(a[c])&&2===a[c]().length&&l.push(i[c]());if(!0===s.createpoints)r=h.providePoints(e,l,s,"cardinalspline",["points"]);else for(r=[],c=0;c<l.length;c++)h.isPoint(l[c])?r.push(l[c]):r.push(function(t){return{X:function(){return l[t][0]},Y:function(){return l[t][1]}}}(c));for(u=["x"].concat(o.CardinalSpline(r,i[1])),n=new t.Curve(e,u,s),d=r.length,n.setParents(r),c=0;c<d;c++)h.isPoint(r[c])&&r[c].addChild(n);return n.elType="cardinalspline",n},t.registerElement("cardinalspline",t.createCardinalSpline),t.createRiemannsum=function(t,e,i){var s,n,r,a,l,c;if((c=h.copyAttributes(i,t.options,"riemannsum")).curvetype="plot",r=e[0],s=h.createFunction(e[1],t,""),!h.exists(s))throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(n=h.createFunction(e[2],t,"",!1),!h.exists(n))throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return a=[[0],[0]].concat(e.slice(3)),(l=t.create("curve",a,c)).sum=0,l.Value=function(){return this.sum},l.updateDataArray=function(){var t=o.riemann(r,s(),n(),this.minX(),this.maxX());this.dataX=t[0],this.dataY=t[1],this.sum=t[2]},l},t.registerElement("riemannsum",t.createRiemannsum),t.createTracecurve=function(t,i,s){var n,r,o,a;if(2!==i.length)throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(r=t.select(i[0]),o=t.select(i[1]),r.type!==e.OBJECT_TYPE_GLIDER||!h.isPoint(o))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider, point]");return(a=h.copyAttributes(s,t.options,"tracecurve")).curvetype="plot",(n=t.create("curve",[[0],[0]],a)).updateDataArray=function(){var t,i,s,n,l,h,c,d,u,p=a.numberpoints,f=r.position,m=r.slideObject,g=m.minX();for(i=(m.maxX()-g)/p,this.dataX=[],this.dataY=[],m.elementClass!==e.OBJECT_CLASS_CURVE&&p++,t=0;t<p;t++){for(n in h=m.X(s=g+t*i)/m.Z(s),c=m.Y(s)/m.Z(s),r.setPositionDirectly(e.COORDS_BY_USER,[h,c]),d=!1,this.board.objects)if(this.board.objects.hasOwnProperty(n)&&((l=this.board.objects[n])===r&&(d=!0),d&&l.needsRegularUpdate&&(u=l.visProp.trace,l.visProp.trace=!1,l.needsUpdate=!0,l.update(!0),l.visProp.trace=u,l===o)))break;this.dataX[t]=o.X(),this.dataY[t]=o.Y()}for(n in r.position=f,d=!1,this.board.objects)if(this.board.objects.hasOwnProperty(n)&&((l=this.board.objects[n])===r&&(d=!0),d&&l.needsRegularUpdate&&(u=l.visProp.trace,l.visProp.trace=!1,l.needsUpdate=!0,l.update(!0),l.visProp.trace=u,l===o)))break},n},t.registerElement("tracecurve",t.createTracecurve),t.createStepfunction=function(t,e,i){var s,n;if(2!==e.length)throw new Error("JSXGraph: Can't create step function with given parent'\nPossible parent types: [array, array|function]");return n=h.copyAttributes(i,t.options,"stepfunction"),(s=t.create("curve",e,n)).updateDataArray=function(){var t,e=0,i=this.xterm.length;if(this.dataX=[],this.dataY=[],0!==i)for(this.dataX[e]=this.xterm[0],this.dataY[e]=this.yterm[0],++e,t=1;t<i;++t)this.dataX[e]=this.xterm[t],this.dataY[e]=this.dataY[e-1],this.dataX[++e]=this.xterm[t],this.dataY[e]=this.yterm[t],++e},s},t.registerElement("stepfunction",t.createStepfunction),t.createDerivative=function(t,i,s){var n,r,a,l,c;if(1!==i.length&&i[0].class!==e.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create derivative curve with given parent'\nPossible parent types: [curve]");return c=h.copyAttributes(s,t.options,"curve"),a=o.D((r=i[0]).X),l=o.D(r.Y),(n=t.create("curve",[function(t){return r.X(t)},function(t){return l(t)/a(t)},r.minX(),r.maxX()],c)).setParents(r),n},t.registerElement("derivative",t.createDerivative),{Curve:t.Curve,createCurve:t.createCurve,createFunctiongraph:t.createFunctiongraph,createPlot:t.createPlot,createSpline:t.createSpline,createRiemannsum:t.createRiemannsum,createTracecurve:t.createTracecurve,createStepfunction:t.createStepfunction}})),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.createEllipse=function(t,s,n){var r,a,l,h,c,d,u,p=[],f=o.copyAttributes(n,t.options,"conic","foci"),m=o.copyAttributes(n,t.options,"conic","center"),g=o.copyAttributes(n,t.options,"conic");for(d=0;d<2;d++)if(s[d].length>1)p[d]=t.create("point",s[d],f);else if(o.isPoint(s[d]))p[d]=t.select(s[d]);else if(o.isFunction(s[d])&&o.isPoint(s[d]()))p[d]=s[d]();else{if(!o.isString(s[d]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");p[d]=t.select(s[d])}if(o.isNumber(s[2]))c=o.createFunction(s[2],t);else if(o.isFunction(s[2])&&o.isNumber(s[2]()))c=s[2];else{if(o.isPoint(s[2]))h=t.select(s[2]);else if(s[2].length>1)h=t.create("point",s[2],f);else if(o.isFunction(s[2])&&o.isPoint(s[2]()))h=s[2]();else{if(!o.isString(s[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"' and '"+typeof s[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");h=t.select(s[2])}c=function(){return h.Dist(p[0])+h.Dist(p[1])}}for(o.exists(s[4])||(s[4]=2*Math.PI),o.exists(s[3])||(s[3]=0),l=t.create("point",[function(){return.5*(p[0].X()+p[1].X())},function(){return.5*(p[0].Y()+p[1].Y())}],m),(a=t.create("curve",[function(t){return 0},function(t){return 0},s[3],s[4]],g)).majorAxis=c,u=a.hasPoint,r=function(t,e){var i,s,n,r,o,l,h,d,u;e||(s=(i=c())*i,n=p[0].X(),r=p[0].Y(),o=p[1].X(),l=p[1].Y(),a.quadraticform=[[(u=(s-n*n-r*r+o*o+l*l)/(2*i))*u-o*o-l*l,u*(h=n-o)/i+o,u*(d=r-l)/i+l],[u*h/i+o,h*h/s-1,h*d/s],[u*d/i+l,h*d/s,d*d/s-1]])},a.X=function(t,e){var i=c(),s=p[1].Dist(p[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)-i),o=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return e||r(0,e),p[0].X()+Math.cos(o+t)*n},a.Y=function(t,e){var i=c(),s=p[1].Dist(p[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)-i),r=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return p[0].Y()+Math.sin(r+t)*n},a.midpoint=a.center=l,a.type=e.OBJECT_TYPE_CONIC,a.subs={center:a.center},a.inherits.push(a.center,p[0],p[1]),o.isPoint(h)&&a.inherits.push(h),a.hasPoint=function(t,s){var n,r,a,l;return o.evaluate(this.visProp.hasinnerpoints)?(n=p[0].coords,r=p[1].coords,a=this.majorAxis(),(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board)).distance(e.COORDS_BY_USER,n)+l.distance(e.COORDS_BY_USER,r)<=a):u.apply(this,arguments)},l.addChild(a),d=0;d<2;d++)o.isPoint(p[d])&&p[d].addChild(a);return o.isPoint(h)&&h.addChild(a),a.setParents(s),a},t.createHyperbola=function(t,i,s){var n,r,a,l,h,c,d=[],u=o.copyAttributes(s,t.options,"conic","foci"),p=o.copyAttributes(s,t.options,"conic","center"),f=o.copyAttributes(s,t.options,"conic");for(c=0;c<2;c++)if(i[c].length>1)d[c]=t.create("point",i[c],u);else if(o.isPoint(i[c]))d[c]=t.select(i[c]);else if(o.isFunction(i[c])&&o.isPoint(i[c]()))d[c]=i[c]();else{if(!o.isString(i[c]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");d[c]=t.select(i[c])}if(o.isNumber(i[2]))h=o.createFunction(i[2],t);else if(o.isFunction(i[2])&&o.isNumber(i[2]()))h=i[2];else{if(o.isPoint(i[2]))l=t.select(i[2]);else if(i[2].length>1)l=t.create("point",i[2],u);else if(o.isFunction(i[2])&&o.isPoint(i[2]()))l=i[2]();else{if(!o.isString(i[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");l=t.select(i[2])}h=function(){return l.Dist(d[0])-l.Dist(d[1])}}for(o.exists(i[4])||(i[4]=1.0001*Math.PI),o.exists(i[3])||(i[3]=-1.0001*Math.PI),a=t.create("point",[function(){return.5*(d[0].X()+d[1].X())},function(){return.5*(d[0].Y()+d[1].Y())}],p),(r=t.create("curve",[function(t){return 0},function(t){return 0},i[3],i[4]],f)).majorAxis=h,n=function(t,e){var i,s,n,o,a,l,c,u,p;e||(s=(i=h())*i,n=d[0].X(),o=d[0].Y(),a=d[1].X(),l=d[1].Y(),r.quadraticform=[[(p=(s-n*n-o*o+a*a+l*l)/(2*i))*p-a*a-l*l,p*(c=n-a)/i+a,p*(u=o-l)/i+l],[p*c/i+a,c*c/s-1,c*u/s],[p*u/i+l,c*u/s,u*u/s-1]])},r.X=function(t,e){var i=h(),s=d[1].Dist(d[0]),r=.5*(s*s-i*i)/(s*Math.cos(t)+i),o=Math.atan2(d[1].Y()-d[0].Y(),d[1].X()-d[0].X());return e||n(0,e),d[0].X()+Math.cos(o+t)*r},r.Y=function(t,e){var i=h(),s=d[1].Dist(d[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)+i),r=Math.atan2(d[1].Y()-d[0].Y(),d[1].X()-d[0].X());return d[0].Y()+Math.sin(r+t)*n},r.midpoint=r.center=a,r.subs={center:r.center},r.inherits.push(r.center,d[0],d[1]),o.isPoint(l)&&r.inherits.push(l),r.type=e.OBJECT_TYPE_CONIC,a.addChild(r),c=0;c<2;c++)o.isPoint(d[c])&&d[c].addChild(r);return o.isPoint(l)&&l.addChild(r),r.setParents(i),r},t.createParabola=function(t,i,s){var n,a,l,h=i[0],c=i[1],d=o.copyAttributes(s,t.options,"conic","foci"),u=o.copyAttributes(s,t.options,"conic","center"),p=o.copyAttributes(s,t.options,"conic");if(i[0].length>1)h=t.create("point",i[0],d);else if(o.isPoint(i[0]))h=t.select(i[0]);else if(o.isFunction(i[0])&&o.isPoint(i[0]()))h=i[0]();else{if(!o.isString(i[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line]");h=t.select(i[0])}return o.exists(i[3])||(i[3]=10),o.exists(i[2])||(i[2]=-10),l=t.create("point",[function(){return r.projectPointToLine(h,c,t).usrCoords}],u),(a=t.create("curve",[function(t){return 0},function(t){return 0},i[2],i[3]],p)).midpoint=a.center=l,a.subs={center:a.center},a.inherits.push(a.center),n=function(t,e){var i,s,n,r,o,l;e||(n=c.stdform[0],r=(i=c.stdform[1])*i+(s=c.stdform[2])*s,o=h.X(),l=h.Y(),a.quadraticform=[[n*n-r*(o*o+l*l),n*i+r*o,n*s+r*l],[n*i+r*o,-s*s,i*s],[n*s+r*l,i*s,-i*i]])},a.X=function(t,e){var i,s=c.getAngle(),o=r.distPointLine(h.coords.usrCoords,c.stdform),a=c.point1.coords.usrCoords,l=c.point2.coords.usrCoords,d=h.coords.usrCoords;return 0===a[0]?a=[1,l[1]+c.stdform[2],l[2]-c.stdform[1]]:0===l[0]&&(l=[1,a[1]+c.stdform[2],a[2]-c.stdform[1]]),i=((l[1]-a[1])*(d[2]-a[2])-(l[2]-a[2])*(d[1]-a[1])>=0?1:-1)*o/(1-Math.sin(t)),e||n(0,e),h.X()+Math.cos(t+s)*i},a.Y=function(t,e){var i,s=c.getAngle(),n=r.distPointLine(h.coords.usrCoords,c.stdform),o=c.point1.coords.usrCoords,a=c.point2.coords.usrCoords,l=h.coords.usrCoords;return 0===o[0]?o=[1,a[1]+c.stdform[2],a[2]-c.stdform[1]]:0===a[0]&&(a=[1,o[1]+c.stdform[2],o[2]-c.stdform[1]]),i=((a[1]-o[1])*(l[2]-o[2])-(a[2]-o[2])*(l[1]-o[1])>=0?1:-1)*n/(1-Math.sin(t)),h.Y()+Math.sin(t+s)*i},a.type=e.OBJECT_TYPE_CONIC,l.addChild(a),o.isPoint(h)&&(h.addChild(a),a.inherits.push(h)),c.addChild(a),a.setParents(i),a},t.createConic=function(t,i,r){var a,l,h,c,d,u,p,f,m,g,b,y,v,C,x=[[1,0,0],[0,1,0],[0,0,1]],_=[[1,0,0],[0,1,0],[0,0,1]],P=[],S=[],w=o.copyAttributes(r,t.options,"conic","point"),E=o.copyAttributes(r,t.options,"conic","center"),k=o.copyAttributes(r,t.options,"conic");if(5===i.length)C=!0;else{if(6!==i.length)throw new Error("JSXGraph: Can't create generic Conic with "+i.length+" parameters.");C=!1}if(C)for(y=0;y<5;y++)if(i[y].length>1)P[y]=t.create("point",i[y],w);else if(o.isPoint(i[y]))P[y]=t.select(i[y]);else if(o.isFunction(i[y])&&o.isPoint(i[y]()))P[y]=i[y]();else{if(!o.isString(i[y]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof i[y]+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");P[y]=t.select(i[y])}else(v=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=o.isFunction(i[2])?function(){return i[2]()}:function(){return i[2]},v[0][1]=o.isFunction(i[4])?function(){return i[4]()}:function(){return i[4]},v[0][2]=o.isFunction(i[5])?function(){return i[5]()}:function(){return i[5]},v[1][1]=o.isFunction(i[0])?function(){return i[0]()}:function(){return i[0]},v[1][2]=o.isFunction(i[3])?function(){return i[3]()}:function(){return i[3]},v[2][2]=o.isFunction(i[1])?function(){return i[1]()}:function(){return i[1]};if(d=function(t){var e,i;for(e=0;e<3;e++)for(i=e;i<3;i++)t[e][i]+=t[i][e];for(e=0;e<3;e++)for(i=0;i<e;i++)t[e][i]=t[i][e];return t},c=function(t,e){var i,s,n=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i++)for(s=0;s<3;s++)n[i][s]=t[i]*e[s];return d(n)},h=function(t,e,i){var n,r,o,a,l,h=[[0,0,0],[0,0,0],[0,0,0]];for(l=s.matVecMult(e,i),o=s.innerProduct(i,l),l=s.matVecMult(t,i),a=s.innerProduct(i,l),n=0;n<3;n++)for(r=0;r<3;r++)h[n][r]=o*t[n][r]-a*e[n][r];return h},l=t.create("curve",[function(t){return 0},function(t){return 0},0,2*Math.PI],k),a=function(t,e){var i,r,a,d;if(!e){if(C){for(i=0;i<5;i++)S[i]=P[i].coords.usrCoords;g=c(s.crossProduct(S[0],S[1]),s.crossProduct(S[2],S[3])),b=c(s.crossProduct(S[0],S[2]),s.crossProduct(S[1],S[3])),_=h(g,b,S[4])}else for(i=0;i<3;i++)for(r=i;r<3;r++)_[i][r]=v[i][r](),r>i&&(_[r][i]=_[i][r]);for(l.quadraticform=_,(u=n.Jacobi(_))[0][0][0]<0&&(u[0][0][0]*=-1,u[0][1][1]*=-1,u[0][2][2]*=-1),i=0;i<3;i++){for(a=0,r=0;r<3;r++)a+=u[1][r][i]*u[1][r][i];a=Math.sqrt(a)}x=u[1],m=Math.sqrt(Math.abs(u[0][0][0])),p=Math.sqrt(Math.abs(u[0][1][1])),f=Math.sqrt(Math.abs(u[0][2][2]))}return u[0][1][1]<=0&&u[0][2][2]<=0?d=s.matVecMult(x,[1/m,Math.cos(t)/p,Math.sin(t)/f]):u[0][1][1]<=0&&u[0][2][2]>0?d=s.matVecMult(x,[Math.cos(t)/m,1/p,Math.sin(t)/f]):u[0][2][2]<0&&(d=s.matVecMult(x,[Math.sin(t)/m,Math.cos(t)/p,1/f])),o.exists(d)?(d[1]/=d[0],d[2]/=d[0],d[0]=1):d=[1,NaN,NaN],d},l.X=function(t,e){return a(t,e)[1]},l.Y=function(t,e){return a(t,e)[2]},l.midpoint=t.create("point",[function(){var t=l.quadraticform;return[t[1][1]*t[2][2]-t[1][2]*t[1][2],t[1][2]*t[0][2]-t[2][2]*t[0][1],t[0][1]*t[1][2]-t[1][1]*t[0][2]]}],E),l.type=e.OBJECT_TYPE_CONIC,l.center=l.midpoint,l.subs={center:l.center},l.inherits.push(l.center),l.inherits=l.inherits.concat(P),C){for(y=0;y<5;y++)o.isPoint(P[y])&&P[y].addChild(l);l.setParents(i)}return l.addChild(l.center),l},t.registerElement("ellipse",t.createEllipse),t.registerElement("hyperbola",t.createHyperbola),t.registerElement("parabola",t.createParabola),t.registerElement("conic",t.createConic),{createEllipse:t.createEllipse,createHyperbola:t.createHyperbola,createParabola:t.createParabola,createConic:t.createConic}})),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],(function(t,e,i,s,n,r,o){"use strict";return t.Circle=function(t,e,i,n,r){this.constructor(t,r,s.OBJECT_TYPE_CIRCLE,s.OBJECT_CLASS_CIRCLE),this.method=e,this.midpoint=this.board.select(i),this.center=this.board.select(i),this.point2=null,this.radius=0,this.line=null,this.circle=null,"twoPoints"===e?(this.point2=t.select(n),this.radius=this.Radius()):"pointRadius"===e?(this.gxtterm=n,this.updateRadius=o.createFunction(n,this.board,null,!0),this.updateRadius()):"pointLine"===e?(this.line=t.select(n),this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"===e&&(this.circle=t.select(n),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),"pointRadius"===e?this.notifyParents(n):"pointLine"===e?this.line.addChild(this):"pointCircle"===e?this.circle.addChild(this):"twoPoints"===e&&this.point2.addChild(this),this.methodMap=o.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},t.Circle.prototype=new e,t.extend(t.Circle.prototype,{hasPoint:function(t,e){var n,r,a,l=this.board.options.precision.hasPoint,h=this.center.coords.usrCoords,c=new i(s.COORDS_BY_SCREEN,[t,e],this.board),d=this.Radius();return n=h[1]-c.usrCoords[1],r=h[2]-c.usrCoords[2],a=Math.sqrt(n*n+r*r),l+=.5*o.evaluate(this.visProp.strokewidth),l/=Math.sqrt(this.board.unitX*this.board.unitY),o.evaluate(this.visProp.hasinnerpoints)?a<d+l:Math.abs(a-d)<l},generatePolynomial:function(t){var e=this.center.symbolic.x,i=this.center.symbolic.y,s=t.symbolic.x,n=t.symbolic.y,r=this.generateRadiusSquared();return""===r?[]:["(("+s+")-("+e+"))^2 + (("+n+")-("+i+"))^2 - ("+r+")"]},generateRadiusSquared:function(){var t="";return"twoPoints"===this.method?t="(("+this.point2.symbolic.x+")-("+this.center.symbolic.x+"))^2 + (("+this.point2.symbolic.y+")-("+this.center.symbolic.y+"))^2":"pointRadius"===this.method?o.isNumber(this.radius)&&(t=(this.radius*this.radius).toString()):"pointLine"===this.method?t="(("+this.line.point1.symbolic.x+")-("+this.line.point2.symbolic.x+"))^2 + (("+this.line.point1.symbolic.y+")-("+this.line.point2.symbolic.y+"))^2":"pointCircle"===this.method&&(t=this.circle.Radius()),t},update:function(){return this.needsUpdate&&(o.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),"pointLine"===this.method?this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords):"pointCircle"===this.method?this.radius=this.circle.Radius():"pointRadius"===this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var t=this.center,e=t.X(),i=t.Y(),s=this.Radius();this.quadraticform=[[e*e+i*i-s*s,-e,-i],[-e,1,0],[-i,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=o.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(t){o.isString(t)&&r.findDependencies(this,t,this.board)},setRadius:function(t){return this.updateRadius=o.createFunction(t,this.board,null,!0),this.board.update(),this},Radius:function(t){return o.exists(t)?(this.setRadius(t),this.Radius()):"twoPoints"===this.method?o.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||o.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):"pointLine"===this.method||"pointCircle"===this.method?this.radius:"pointRadius"===this.method?this.updateRadius():NaN},getRadius:function(){return t.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var t,e,n=this.Radius(),r=this.center.coords.usrCoords;switch(o.evaluate(this.visProp.label.position)){case"lft":t=r[1]-n,e=r[2];break;case"llft":t=r[1]-Math.sqrt(.5)*n,e=r[2]-Math.sqrt(.5)*n;break;case"rt":t=r[1]+n,e=r[2];break;case"lrt":t=r[1]+Math.sqrt(.5)*n,e=r[2]-Math.sqrt(.5)*n;break;case"urt":t=r[1]+Math.sqrt(.5)*n,e=r[2]+Math.sqrt(.5)*n;break;case"top":t=r[1],e=r[2]+n;break;case"bot":t=r[1],e=r[2]-n;break;default:t=r[1]-Math.sqrt(.5)*n,e=r[2]+Math.sqrt(.5)*n}return new i(s.COORDS_BY_USER,[t,e],this.board)},cloneToBackground:function(){var t,e=this.Radius(),i={id:this.id+"T"+this.numTraces,elementClass:s.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return e},getRadius:function(){return e},board:this.board,visProp:o.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return i.visProp.layer=this.board.options.layer.trace,this.numTraces++,o.clearVisPropOld(i),i.visPropCalc={visible:o.evaluate(i.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(i),this.board.renderer.enhancedRendering=t,this.traces[i.id]=i.rendNode,this},addTransform:function(t){var e,i=o.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.center.transformations.push(i[e]),"twoPoints"===this.method&&this.point2.transformations.push(i[e]);return this},snapToGrid:function(){var t=o.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(t,!0),"twoPoints"===this.method&&this.point2.handleSnapToGrid(t,!0),this},snapToPoints:function(){var t=o.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(t),"twoPoints"===this.method&&this.point2.handleSnapToPoints(t),this},X:function(t){return this.Radius()*Math.cos(2*t*Math.PI)+this.center.coords.usrCoords[1]},Y:function(t){return this.Radius()*Math.sin(2*t*Math.PI)+this.center.coords.usrCoords[2]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var t=this.Radius();return t*t*Math.PI},bounds:function(){var t=this.center.coords.usrCoords,e=this.Radius();return[t[1]-e,t[2]+e,t[1]+e,t[2]-e]},getParents:function(){return 1===this.parents.length?this.parents.concat(this.radius):this.parents}}),t.createCircle=function(e,i,r){var a,l,h,c,d;if(l=[],d=e.select(i[0]),o.isObject(d)&&d.elementClass===s.OBJECT_CLASS_CIRCLE&&o.isTransformationOrArray(i[1]))return c=o.copyAttributes(r,e.options,"circle"),(a=n.createEllipse(e,[d.center,d.center,function(){return 2*d.Radius()}],c)).addTransform(i[1]),a;for(h=0;h<i.length;h++)if(o.isPointType(e,i[h])){if(!1===(l=l.concat(o.providePoints(e,[i[h]],r,"circle",["center"])))[l.length-1])throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else l.push(i[h]);if(c=o.copyAttributes(r,e.options,"circle"),2===l.length&&o.isPoint(l[0])&&o.isPoint(l[1]))a=new t.Circle(e,"twoPoints",l[0],l[1],c);else if((o.isNumber(l[0])||o.isFunction(l[0])||o.isString(l[0]))&&o.isPoint(l[1]))a=new t.Circle(e,"pointRadius",l[1],l[0],c);else if((o.isNumber(l[1])||o.isFunction(l[1])||o.isString(l[1]))&&o.isPoint(l[0]))a=new t.Circle(e,"pointRadius",l[0],l[1],c);else if(l[0].elementClass===s.OBJECT_CLASS_CIRCLE&&o.isPoint(l[1]))a=new t.Circle(e,"pointCircle",l[1],l[0],c);else if(l[1].elementClass===s.OBJECT_CLASS_CIRCLE&&o.isPoint(l[0]))a=new t.Circle(e,"pointCircle",l[0],l[1],c);else if(l[0].elementClass===s.OBJECT_CLASS_LINE&&o.isPoint(l[1]))a=new t.Circle(e,"pointLine",l[1],l[0],c);else if(l[1].elementClass===s.OBJECT_CLASS_LINE&&o.isPoint(l[0]))a=new t.Circle(e,"pointLine",l[0],l[1],c);else{if(!(3===i.length&&o.isPoint(l[0])&&o.isPoint(l[1])&&o.isPoint(l[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]");if(!t.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");a=t.elements.circumcircle(e,l,c)}for(a.isDraggable=!0,a.setParents(l),a.elType="circle",h=0;h<l.length;h++)o.isPoint(l[h])&&a.inherits.push(l[h]);return a},t.registerElement("circle",t.createCircle),{Circle:t.Circle,createCircle:t.createCircle}})),define("base/composition",["jxg","utils/type"],(function(t,e){"use strict";return t.Composition=function(t){var i,s=this,n=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"];for(i=0;i<n.length;i++)this[n[i]]=function(t){return function(){var i;for(i in s.elements)s.elements.hasOwnProperty(i)&&e.exists(s.elements[i][t])&&s.elements[i][t].apply(s.elements[i],arguments);return s}}(n[i]);for(i in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},t)t.hasOwnProperty(i)&&this.add(i,t[i]);this.dump=!0,this.subs={}},t.extend(t.Composition.prototype,{add:function(t,i){return!(e.exists(this[t])||!e.exists(i)||(e.exists(i.id)?this.elements[i.id]=i:this.elements[t]=i,e.exists(i.name)&&(this.elementsByName[i.name]=i),i.on("attribute:name",this.nameListener,this),this.objectsList.push(i),this[t]=i,this.methodMap[t]=i,0))},remove:function(t){var e,i=!1;for(e in this.elements)if(this.elements.hasOwnProperty(e)&&this.elements[e].id===this[t].id){i=!0;break}return i&&(delete this.elements[this[t].id],delete this[t]),i},nameListener:function(t,e,i){delete this.elementsByName[t],this.elementsByName[e]=i},select:function(i){return e.exists(t.Board)?t.Board.prototype.select.call(this,i):new t.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var t,e={};for(t in this.subs)this.subs.hasOwnProperty(t)&&(e[t]=this.subs[t].visProp);return this.attr}}),t.Composition})),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.Polygon=function(i,s,n){this.constructor(i,n,e.OBJECT_TYPE_POLYGON,e.OBJECT_CLASS_AREA);var o,a,l,h,c=r.copyAttributes(n,i.options,"polygon","borders");for(this.withLines=n.withlines,this.attr_line=c,this.vertices=[],o=0;o<s.length;o++)this.vertices[o]=this.board.select(s[o]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(l=this.vertices.length-1,h=0;h<l;h++)o=(h+1)%l,c.id=c.ids&&c.ids[o],c.name=c.names&&c.names[o],c.strokecolor=r.isArray(c.colors)&&c.colors[o%c.colors.length]||c.strokecolor,c.visible=r.exists(n.borders.visible)?n.borders.visible:n.visible,!1===c.strokecolor&&(c.strokecolor="none"),(a=i.create("segment",[this.vertices[o],this.vertices[o+1]],c)).dump=!1,this.borders[o]=a,a.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),o=0;o<this.vertices.length-1;o++)this.board.select(this.vertices[o]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=t.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},t.Polygon.prototype=new o,t.extend(t.Polygon.prototype,{hasPoint:function(t,e){var i,s,n,o=!1;if(r.evaluate(this.visProp.hasinnerpoints)){for(i=0,s=(n=this.vertices.length)-2;i<n-1;s=i++)this.vertices[i].coords.scrCoords[2]>e!=this.vertices[s].coords.scrCoords[2]>e&&t<(this.vertices[s].coords.scrCoords[1]-this.vertices[i].coords.scrCoords[1])*(e-this.vertices[i].coords.scrCoords[2])/(this.vertices[s].coords.scrCoords[2]-this.vertices[i].coords.scrCoords[2])+this.vertices[i].coords.scrCoords[1]&&(o=!o);if(o)return!0}for(n=this.borders.length,i=0;i<n;i++)if(this.borders[i].hasPoint(t,e)){o=!0;break}return o},updateRenderer:function(){var t,e;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(e=this.vertices.length,this.isReal=!0,t=0;t<e;++t)if(!this.vertices[t].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var t,s,n,r,o;if(0===this.vertices.length)return new i(e.COORDS_BY_USER,[1,0,0],this.board);for(n=t=this.vertices[0].X(),r=s=this.vertices[0].Y(),o=0;o<this.vertices.length;o++)this.vertices[o].X()<t&&(t=this.vertices[o].X()),this.vertices[o].X()>n&&(n=this.vertices[o].X()),this.vertices[o].Y()>s&&(s=this.vertices[o].Y()),this.vertices[o].Y()<r&&(r=this.vertices[o].Y());return new i(e.COORDS_BY_USER,[.5*(t+n),.5*(s+r)],this.board)},getLabelAnchor:t.shortcut(t.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var t,e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.vertices=this.vertices,e.visProp=r.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.board=this.board,r.clearVisPropOld(e),e.visPropCalc={visible:r.evaluate(e.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(e),this.board.renderer.enhancedRendering=t,this.traces[e.id]=e.rendNode,this},hideElement:function(e){var i;if(t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!e)for(i=0;i<this.borders.length;i++)this.borders[i].hideElement();this.hasLabel&&r.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(e){var i;if(t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!e)for(i=0;i<this.borders.length;i++)this.borders[i].showElement().updateRenderer();return r.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(n.signedPolygon(this.vertices,!0))},Perimeter:function(){var t,e=this.vertices.length,i=0;for(t=1;t<e;++t)i+=this.vertices[t].Dist(this.vertices[t-1]);return i},boundingBox:function(){var t,e,i=[0,0,0,0],s=this.vertices.length-1;if(0===s)return i;for(i[0]=this.vertices[0].X(),i[2]=i[0],i[1]=this.vertices[0].Y(),i[3]=i[1],t=1;t<s;++t)(e=this.vertices[t].X())<i[0]?i[0]=e:e>i[2]&&(i[2]=e),(e=this.vertices[t].Y())>i[1]?i[1]=e:e<i[3]&&(i[3]=e);return i},bounds:function(){return this.boundingBox()},remove:function(){var t;for(t=0;t<this.borders.length;t++)this.board.removeObject(this.borders[t]);o.prototype.remove.call(this)},findPoint:function(t){var e;if(!r.isPoint(t))return-1;for(e=0;e<this.vertices.length;e++)if(this.vertices[e].id===t.id)return e;return-1},addPoints:function(t){var e=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(e))},insertPoints:function(t,e){var i,s,n=[];if(0===arguments.length)return this;if(t<0||t>this.vertices.length-2)return this;for(i=1;i<arguments.length;i++)r.isPoint(arguments[i])&&n.push(arguments[i]);if(s=this.vertices.slice(0,t+1).concat(n),this.vertices=s.concat(this.vertices.slice(t+1)),this.withLines){for(s=this.borders.slice(0,t),this.board.removeObject(this.borders[t]),i=0;i<n.length;i++)s.push(this.board.create("segment",[this.vertices[t+i],this.vertices[t+i+1]],this.attr_line));s.push(this.board.create("segment",[this.vertices[t+n.length],this.vertices[t+n.length+1]],this.attr_line)),this.borders=s.concat(this.borders.slice(t+1))}return this.board.update(),this},removePoints:function(t){var e,i,s,n=[],o=[],a=[],l=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),e=0;e<arguments.length;e++)r.isPoint(s=arguments[e])&&(s=this.findPoint(s)),r.isNumber(s)&&s>-1&&s<this.vertices.length&&-1===r.indexOf(a,s)&&a.push(s);for(e=0;e<a.length;e++)this.vertices[a[e]].removeChild(this);for(a=a.sort(),n=this.vertices.slice(),o=this.borders.slice(),this.withLines&&l.push([a[a.length-1]]),e=a.length-1;e>-1;e--)n[a[e]]=-1,this.withLines&&a[e]-1>a[e-1]&&(l[l.length-1][1]=a[e],l.push([a[e-1]]));for(this.withLines&&(l[l.length-1][1]=a[0]),this.vertices=[],e=0;e<n.length;e++)r.isPoint(n[e])&&this.vertices.push(n[e]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;e<l.length;e++){for(i=l[e][1]-1;i<l[e][0]+1;i++)i<0?(i=0,this.board.removeObject(this.borders[o.length-1]),o[o.length-1]=-1):i>o.length-1&&(i=o.length-1),this.board.removeObject(this.borders[i]),o[i]=-1;0!==l[e][1]&&l[e][0]!==n.length-1&&(o[l[e][0]-1]=this.board.create("segment",[n[Math.max(l[e][1]-1,0)],n[Math.min(l[e][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],e=0;e<o.length;e++)-1!==o[e]&&this.borders.push(o[e]);l[0][1]!==this.vertices.length-1&&0!==l[l.length-1][1]||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var t,e=o.prototype.getAttributes.call(this);if(this.withLines)for(e.lines=e.lines||{},e.lines.ids=[],e.lines.colors=[],t=0;t<this.borders.length;t++)e.lines.ids.push(this.borders[t].id),e.lines.colors.push(this.borders[t].visProp.strokecolor);return e},snapToGrid:function(){var t,e;for(e=!!r.evaluate(this.visProp.snaptogrid),t=0;t<this.vertices.length;t++)this.vertices[t].handleSnapToGrid(e,!0)},setPositionDirectly:function(t,e,n){var r,o,a,l=new i(t,e,this.board),h=new i(t,n,this.board);for(a=this.vertices.length-1,o=0;o<a;o++)if(!this.vertices[o].draggable())return this;return r=s.subtract(l.usrCoords,h.usrCoords),this.board.create("transform",r.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(e){var i,s,n,r,o,a,l,h=t.Math.Geometry.sortVertices(this.vertices),c=t.Math.Geometry.sortVertices(e.vertices),d=h.length-1,u=c.length-1,p=[],f=function(t,e,i){return(e[1]-t[1])*(i[2]-t[2])-(e[2]-t[2])*(i[1]-t[1])>=0};for(n=0;n<u;n++)p.push(c[n]);for(n=0;n<d;n++)for(s=p.slice(0),p=[],o=s[(i=s.length)-1],r=0;r<i;r++)f(h[n],h[n+1],a=s[r])?(f(h[n],h[n+1],o)||((l=t.Math.Geometry.meetSegmentSegment(o,a,h[n],h[n+1]))[0][1]/=l[0][0],l[0][2]/=l[0][0],l[0][0]=1,p.push(l[0])),p.push(a)):f(h[n],h[n+1],o)&&((l=t.Math.Geometry.meetSegmentSegment(o,a,h[n],h[n+1]))[0][1]/=l[0][0],l[0][2]/=l[0][0],l[0][0]=1,p.push(l[0])),o=a;return p},intersect:function(t){return this.sutherlandHodgman(t)}}),t.createPolygon=function(i,s,n){var o,a,l,h,c,d,u=[],p=!1;if(r.copyAttributes(n,i.options,"polygon"),h=i.select(s[0]),r.isObject(h)&&h.type===e.OBJECT_TYPE_POLYGON&&r.isTransformationOrArray(s[1]))for(p=!0,l=h.vertices.length-1,d=r.copyAttributes(n,i.options,"polygon","vertices"),a=0;a<l;a++)d.withlabel&&(d.name=""===h.vertices[a].name?"":h.vertices[a].name+"'"),u.push(i.create("point",[h.vertices[a],s[1]],d));else if(!1===(u=r.providePoints(i,s,n,"polygon",["vertices"])))throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(c=r.copyAttributes(n,i.options,"polygon"),(o=new t.Polygon(i,u,c)).isDraggable=!0,p)for(l=h.vertices.length-1,a=0;a<l;a++)u[a].prepareUpdate().update().updateVisibility(r.evaluate(o.visProp.visible)).updateRenderer();return o},t.createRegularPolygon=function(t,i,s){var n,o,a,l,h,c,d,u=[];if(r.isNumber(a=i[(h=i.length)-1])&&(3!==i.length||a<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(r.isNumber(t.select(a))?(h--,c=!1):(a=h,c=!0),!1===(u=r.providePoints(t,i.slice(0,h),s,"regularpolygon",["vertices"])))throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(d=r.copyAttributes(s,t.options,"regularpolygon","vertices"),o=2;o<a;o++)l=t.create("transform",[Math.PI*(2-(a-2)/a),u[o-1]],{type:"rotate"}),c?(u[o].addTransform(u[o-2],l),u[o].fullUpdate()):(r.isArray(d.ids)&&d.ids.length>=a-2&&(d.id=d.ids[o-2]),u[o]=t.create("point",[u[o-2],l],d),u[o].type=e.OBJECT_TYPE_CAS,u[o].isDraggable=!0,u[o].visProp.fixed=!1);return d=r.copyAttributes(s,t.options,"regularpolygon"),(n=t.create("polygon",u,d)).elType="regularpolygon",n},t.registerElement("polygon",t.createPolygon),t.registerElement("regularpolygon",t.createRegularPolygon),{Polygon:t.Polygon,createPolygon:t.createPolygon,createRegularPolygon:t.createRegularPolygon}})),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.createArc=function(a,l,h){var c,d,u;if(!1===(u=r.providePoints(a,l,h,"arc",["center","radiuspoint","anglepoint"]))||u.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof l[0]+"' and '"+typeof l[1]+"' and '"+typeof l[2]+"'.\nPossible parent types: [point,point,point], [arc, transformation]");return d=r.copyAttributes(h,a.options,"arc"),(c=a.create("curve",[[0],[0]],d)).elType="arc",c.setParents(u),c.type=o.OBJECT_TYPE_ARC,c.center=u[0],c.radiuspoint=u[1],c.point2=c.radiuspoint,c.anglepoint=u[2],c.point3=c.anglepoint,c.center.addChild(c),c.radiuspoint.addChild(c),c.anglepoint.addChild(c),c.useDirection=d.usedirection,c.updateDataArray=function(){var t,i,s,n,o,a=1,l=this.radiuspoint,h=this.center,c=this.anglepoint,d=r.evaluate(this.visProp.selection);i=e.rad(l,h,c),("minor"===d&&i>Math.PI||"major"===d&&i<Math.PI)&&(a=-1),this.useDirection&&(((s=u[1].coords.usrCoords)[1]-(o=u[2].coords.usrCoords)[1])*(s[2]-(n=u[3].coords.usrCoords)[2])-(s[2]-o[2])*(s[1]-n[1])<0?(this.radiuspoint=u[1],this.anglepoint=u[2]):(this.radiuspoint=u[2],this.anglepoint=u[1])),t=e.bezierArc(l=l.coords.usrCoords,h=h.coords.usrCoords,c=c.coords.usrCoords,!1,a),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},c.Radius=function(){return this.radiuspoint.Dist(this.center)},c.getRadius=function(){return t.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},c.Value=function(){return this.Radius()*e.rad(this.radiuspoint,this.center,this.anglepoint)},c.hasPoint=function(t,n){var a,l,h,c,d,u,p,f,m,g=this.Radius(),b=r.evaluate(this.visProp.selection);return r.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(t,n):(m=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),l=new s(o.COORDS_BY_SCREEN,[t,n],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),p=i.inverse(this.transformMat),f=i.matVecMult(p,l.usrCoords),l=new s(o.COORDS_BY_USER,f,this.board)),a=this.center.coords.distance(o.COORDS_BY_USER,l),(h=Math.abs(a-g)<m)&&(c=e.rad(this.radiuspoint,this.center,l.usrCoords.slice(1)),d=0,u=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===b&&u>Math.PI||"major"===b&&u<Math.PI)&&(d=u,u=2*Math.PI),(c<d||c>u)&&(h=!1)),h)},c.hasPointSector=function(t,i){var n,a,l,h=new s(o.COORDS_BY_SCREEN,[t,i],this.board),c=this.Radius(),d=this.center.coords.distance(o.COORDS_BY_USER,h)<c,u=r.evaluate(this.visProp.selection);return d&&(n=e.rad(this.radiuspoint,this.center,h.usrCoords.slice(1)),a=0,l=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===u&&l>Math.PI||"major"===u&&l<Math.PI)&&(a=l,l=2*Math.PI),(n<a||n>l)&&(d=!1)),d},c.getTextAnchor=function(){return this.center.coords},c.getLabelAnchor=function(){var t,i,n,a,l,h=e.rad(this.radiuspoint,this.center,this.anglepoint),c=10/this.board.unitX,d=10/this.board.unitY,u=this.point2.coords.usrCoords,p=this.center.coords.usrCoords,f=u[1]-p[1],m=u[2]-p[2],g=r.evaluate(this.visProp.selection),b=this.label?this.label.visProp:this.visProp.label;return("minor"===g&&h>Math.PI||"major"===g&&h<Math.PI)&&(h=-(2*Math.PI-h)),n=(t=new s(o.COORDS_BY_USER,[p[1]+Math.cos(.5*h)*f-Math.sin(.5*h)*m,p[2]+Math.sin(.5*h)*f+Math.cos(.5*h)*m],this.board)).usrCoords[1]-p[1],a=t.usrCoords[2]-p[2],l=Math.sqrt(n*n+a*a),b.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],i=[p[1]+(n=n*(l+c)/l),p[2]+(a=a*(l+d)/l)])),new s(o.COORDS_BY_USER,i,this.board)},c.updateQuadraticform=n.Circle.prototype.updateQuadraticform,c.updateStdform=n.Circle.prototype.updateStdform,c.methodMap=t.deepCopy(c.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),c.prepareUpdate().update(),c},t.registerElement("arc",t.createArc),t.createSemicircle=function(t,e,i){var s,n,o,a;if(!1===(a=r.providePoints(t,e,i,"point"))||2!==a.length)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point]");return o=r.copyAttributes(i,t.options,"semicircle","center"),(n=t.create("midpoint",a,o)).dump=!1,o=r.copyAttributes(i,t.options,"semicircle"),(s=t.create("arc",[n,a[1],a[0]],o)).elType="semicircle",s.setParents([a[0].id,a[1].id]),s.subs={midpoint:n},s.inherits.push(n),s.midpoint=s.center=n,s},t.registerElement("semicircle",t.createSemicircle),t.createCircumcircleArc=function(t,e,i){var s,n,o,a;if(!1===(a=r.providePoints(t,e,i,"point"))||3!==a.length)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]");return o=r.copyAttributes(i,t.options,"circumcirclearc","center"),(n=t.create("circumcenter",a,o)).dump=!1,(o=r.copyAttributes(i,t.options,"circumcirclearc")).usedirection=!0,(s=t.create("arc",[n,a[0],a[2],a[1]],o)).elType="circumcirclearc",s.setParents([a[0].id,a[1].id,a[2].id]),s.subs={center:n},s.inherits.push(n),s.center=n,s},t.registerElement("circumcirclearc",t.createCircumcircleArc),t.createMinorArc=function(e,i,s){return s.selection="minor",t.createArc(e,i,s)},t.registerElement("minorarc",t.createMinorArc),t.createMajorArc=function(e,i,s){return s.selection="major",t.createArc(e,i,s)},t.registerElement("majorarc",t.createMajorArc),{createArc:t.createArc,createSemicircle:t.createSemicircle,createCircumcircleArc:t.createCircumcircleArc,createMinorArc:t.createMinorArc,createMajorArc:t.createMajorArc}})),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],(function(t,e,i,s,n,r,o,a,l,h,c){"use strict";return t.createSector=function(a,l,h){var c,d,u,p,f,m="invalid";if(l[0].elementClass===r.OBJECT_CLASS_LINE&&l[1].elementClass===r.OBJECT_CLASS_LINE&&(o.isArray(l[2])||o.isNumber(l[2]))&&(o.isArray(l[3])||o.isNumber(l[3]))&&(o.isNumber(l[4])||o.isFunction(l[4])))m="2lines";else{if(!1===(f=o.providePoints(a,l,h,"sector",["center","radiuspoint","anglepoint"])))throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof l[0]+"' and '"+typeof l[1]+"' and '"+typeof l[2]+"'.");m="3points"}return d=o.copyAttributes(h,a.options,"sector"),(c=a.create("curve",[[0],[0]],d)).type=r.OBJECT_TYPE_SECTOR,c.elType="sector","2lines"===m?(c.Radius=function(){return o.evaluate(l[4])},c.line1=a.select(l[0]),c.line2=a.select(l[1]),c.line1.addChild(c),c.line2.addChild(c),c.setParents(l),c.point1={visProp:{}},c.point2={visProp:{}},c.point3={visProp:{}},u=e.meetLineLine(c.line1.stdform,c.line2.stdform,0,a),o.isArray(l[2])?(2===l[2].length&&(l[2]=[1].concat(l[2])),p=e.projectPointToLine({coords:{usrCoords:l[2]}},c.line1,a),p=s.subtract(p.usrCoords,u.usrCoords),c.direction1=i.innerProduct(p,[0,c.line1.stdform[2],-c.line1.stdform[1]],3)>=0?1:-1):c.direction1=l[2]>=0?1:-1,o.isArray(l[3])?(2===l[3].length&&(l[3]=[1].concat(l[3])),p=e.projectPointToLine({coords:{usrCoords:l[3]}},c.line2,a),p=s.subtract(p.usrCoords,u.usrCoords),c.direction2=i.innerProduct(p,[0,c.line2.stdform[2],-c.line2.stdform[1]],3)>=0?1:-1):c.direction2=l[3]>=0?1:-1,c.updateDataArray=function(){var t,o,a,l,h,d,u=[0,0,0];if(u=i.crossProduct((o=this.line1).stdform,(a=this.line2).stdform),Math.abs(u[0])>i.eps*i.eps&&(u[1]/=u[0],u[2]/=u[0],u[0]/=u[0]),t=this.direction1*this.Radius(),h=s.add(u,[0,t*o.stdform[2],-t*o.stdform[1]]),t=this.direction2*this.Radius(),d=s.add(u,[0,t*a.stdform[2],-t*a.stdform[1]]),this.point2.coords=new n(r.COORDS_BY_USER,h,c.board),this.point1.coords=new n(r.COORDS_BY_USER,u,c.board),this.point3.coords=new n(r.COORDS_BY_USER,d,c.board),Math.abs(h[0])<i.eps||Math.abs(u[0])<i.eps||Math.abs(d[0])<i.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);l=e.bezierArc(h,u,d,!0,1),this.dataX=l[0],this.dataY=l[1],this.bezierDegree=3},c.methodMap=t.deepCopy(c.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),c.prepareUpdate().update()):"3points"===m&&(c.point1=f[0],c.point2=f[1],c.point3=f[2],c.point1.addChild(c),c.point2.addChild(c),c.point3.addChild(c),c.useDirection=h.usedirection,c.setParents(f),o.exists(f[3])&&(c.point4=f[3],c.point4.addChild(c)),c.methodMap=t.deepCopy(c.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),c.updateDataArray=function(){var t,i,s,n,r,a=this.point2,l=this.point1,h=this.point3,c=1,d=o.evaluate(this.visProp.selection);if(!a.isReal||!l.isReal||!h.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);r=e.rad(a,l,h),("minor"===d&&r>Math.PI||"major"===d&&r<Math.PI)&&(c=-1),this.useDirection&&o.exists(this.point4)&&((i=this.point2.coords.usrCoords)[1]-(n=this.point3.coords.usrCoords)[1])*(i[2]-(s=this.point4.coords.usrCoords)[2])-(i[2]-n[2])*(i[1]-s[1])>=0&&(h=this.point2,a=this.point3),t=e.bezierArc(a=a.coords.usrCoords,l=l.coords.usrCoords,h=h.coords.usrCoords,!0,c),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3},c.Radius=function(){return this.point2.Dist(this.point1)},(d=o.copyAttributes(h,a.options,"sector","arc")).withLabel=!1,d.name+="_arc",c.arc=a.create("arc",[c.point1,c.point2,c.point3],d),c.addChild(c.arc)),c.center=c.point1,c.radiuspoint=c.point2,c.anglepoint=c.point3,c.hasPointCurve=function(t,i){var s,a,l,h,c,d=new n(r.COORDS_BY_SCREEN,[t,i],this.board),u=this.Radius(),p=this.center.coords.distance(r.COORDS_BY_USER,d),f=o.evaluate(this.visProp.selection);return h=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),(c=Math.abs(p-u)<h)&&(s=e.rad(this.point2,this.center,d.usrCoords.slice(1)),a=0,l=e.rad(this.point2,this.center,this.point3),("minor"===f&&l>Math.PI||"major"===f&&l<Math.PI)&&(a=l,l=2*Math.PI),(s<a||s>l)&&(c=!1)),c},c.hasPointSector=function(t,i){var s,a,l,h=new n(r.COORDS_BY_SCREEN,[t,i],this.board),c=this.Radius(),d=this.point1.coords.distance(r.COORDS_BY_USER,h)<c,u=o.evaluate(this.visProp.selection);return d&&(s=e.rad(this.radiuspoint,this.center,h.usrCoords.slice(1)),a=0,l=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===u&&l>Math.PI||"major"===u&&l<Math.PI)&&(a=l,l=2*Math.PI),(s<a||s>l)&&(d=!1)),d},c.hasPoint=function(t,e){return o.evaluate(this.visProp.highlightonsector)||o.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(t,e):this.hasPointCurve(t,e)},c.getTextAnchor=function(){return this.point1.coords},c.getLabelAnchor=function(){var t,i,s,a,l,h=e.rad(this.point2,this.point1,this.point3),c=13/this.board.unitX,d=13/this.board.unitY,u=this.point2.coords.usrCoords,p=this.point1.coords.usrCoords,f=u[1]-p[1],m=u[2]-p[2],g=o.evaluate(this.visProp.selection),b=this.label?this.label.visProp:this.visProp.label;return("minor"===g&&h>Math.PI||"major"===g&&h<Math.PI)&&(h=-(2*Math.PI-h)),s=(t=new n(r.COORDS_BY_USER,[p[1]+Math.cos(.5*h)*f-Math.sin(.5*h)*m,p[2]+Math.sin(.5*h)*f+Math.cos(.5*h)*m],this.board)).usrCoords[1]-p[1],a=t.usrCoords[2]-p[2],l=Math.sqrt(s*s+a*a),b.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],i=[p[1]+(s=s*(l+c)/l),p[2]+(a=a*(l+d)/l)])),new n(r.COORDS_BY_USER,i,this.board)},c.setRadius=function(t){c.Radius=function(){return o.evaluate(t)}},c.getRadius=function(){return t.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},"3points"===m&&(c.setPositionDirectly=function(t,e,i){var r,o=new n(t,e,this.board),a=new n(t,i,this.board);return c.point1.draggable()&&c.point2.draggable()&&c.point3.draggable()?(r=s.subtract(o.usrCoords,a.usrCoords),this.board.create("transform",r.slice(1),{type:"translate"}).applyOnce([c.point1,c.point2,c.point3]),this):this}),c.prepareUpdate().update(),c},t.registerElement("sector",t.createSector),t.createCircumcircleSector=function(t,e,i){var s,n,r,a;if(!1===(a=o.providePoints(t,e,i,"point")))throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");return(n=t.create("circumcenter",a.slice(0,3),r)).dump=!1,r=o.copyAttributes(i,t.options,"circumcirclesector"),(s=t.create("sector",[n,a[0],a[2],a[1]],r)).elType="circumcirclesector",s.setParents(a),s.center=n,s.subs={center:n},s},t.registerElement("circumcirclesector",t.createCircumcircleSector),t.createMinorSector=function(e,i,s){return s.selection="minor",t.createSector(e,i,s)},t.registerElement("minorsector",t.createMinorSector),t.createMajorSector=function(e,i,s){return s.selection="major",t.createSector(e,i,s)},t.registerElement("majorsector",t.createMajorSector),t.createAngle=function(t,s,a){var l,h,c,d,u,p,f="invalid";if(s[0].elementClass===r.OBJECT_CLASS_LINE&&s[1].elementClass===r.OBJECT_CLASS_LINE&&(o.isArray(s[2])||o.isNumber(s[2]))&&(o.isArray(s[3])||o.isNumber(s[3])))f="2lines";else{if(!1===(p=o.providePoints(t,s,a,"point")))throw new Error("JSXGraph: Can't create angle with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"' and '"+typeof s[2]+"'.");f="3points"}if(c=o.copyAttributes(a,t.options,"angle"),o.exists(c.name)&&""!==c.name||(c.name=t.generateName({type:r.OBJECT_TYPE_ANGLE})),h=o.exists(c.radius)?c.radius:0,"2lines"===f?(s.push(h),(l=t.create("sector",s,c)).updateDataArraySector=l.updateDataArray,l.setAngle=function(t){},l.free=function(t){}):((l=t.create("sector",[p[1],p[0],p[2]],c)).arc.visProp.priv=!0,l.point=l.point2=l.radiuspoint=p[0],l.pointsquare=l.point3=l.anglepoint=p[2],l.Radius=function(){return o.evaluate(h)},l.updateDataArraySector=function(){var t,i,s=this.point2,n=this.point1,r=this.point3,a=this.Radius(),l=n.Dist(s),h=1,c=o.evaluate(this.visProp.selection);i=e.rad(s,n,r),("minor"===c&&i>Math.PI||"major"===c&&i<Math.PI)&&(h=-1),t=e.bezierArc(s=[1,(n=n.coords.usrCoords)[1]+((s=s.coords.usrCoords)[1]-n[1])*a/l,n[2]+(s[2]-n[2])*a/l],n,r=[1,n[1]+((r=r.coords.usrCoords)[1]-n[1])*a/l,n[2]+(r[2]-n[2])*a/l],!0,h),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3},l.setAngle=function(t){var e,i=this.anglepoint,s=this.radiuspoint;return i.draggable()&&(e=this.board.create("transform",[t,this.center],{type:"rotate"}),i.addTransform(s,e),i.isDraggable=!1,i.setParents(s)),this},l.free=function(){var t=this.anglepoint;return t.transformations.length>0&&(t.transformations.pop(),t.isDraggable=!0,t.parents=[]),this},l.setParents(p)),o.exists(l.visProp.text)&&l.label.setText(o.evaluate(l.visProp.text)),l.elType="angle",l.type=r.OBJECT_TYPE_ANGLE,l.subs={},l.updateDataArraySquare=function(){var t,s,n,r,o,a,l,h=this.Radius();"2lines"===f&&this.updateDataArraySector(),n=(n=this.point3).coords.usrCoords,r=e.distance(t=(t=this.point2).coords.usrCoords,s=(s=this.point1).coords.usrCoords,3),o=e.distance(n,s,3),t=[1,s[1]+(t[1]-s[1])*h/r,s[2]+(t[2]-s[2])*h/r],a=i.crossProduct(n=[1,s[1]+(n[1]-s[1])*h/o,s[2]+(n[2]-s[2])*h/o],s),l=[-t[1]*a[1]-t[2]*a[2],t[0]*a[1],t[0]*a[2]],a=i.crossProduct(t,s),(a=i.crossProduct(l,[-n[1]*a[1]-n[2]*a[2],n[0]*a[1],n[0]*a[2]]))[1]/=a[0],a[2]/=a[0],this.dataX=[s[1],t[1],a[1],n[1],s[1]],this.dataY=[s[2],t[2],a[2],n[2],s[2]],this.bezierDegree=1},l.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},l.updateDataArray=function(){var t=o.evaluate(this.visProp.type),s=e.trueAngle(this.point2,this.point1,this.point3),n=o.evaluate(this.visProp.selection);("minor"===n&&s>180||"major"===n&&s<180)&&(s=360-s),Math.abs(s-90)<o.evaluate(this.visProp.orthosensitivity)+i.eps&&(t=o.evaluate(this.visProp.orthotype)),"none"===t?this.updateDataArrayNone():"square"===t?this.updateDataArraySquare():"sector"===t?this.updateDataArraySector():"sectordot"===t&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||"sectordot"!==t&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},d=o.copyAttributes(a,t.options,"angle","dot"),l.dot=t.create("point",[function(){var t,s,n,r,a,h,c,d;return o.exists(l.dot)&&!l.dot.visProp.visible?[0,0]:(t=l.point2.coords.usrCoords,s=l.point1.coords.usrCoords,n=l.Radius(),r=e.distance(t,s,3),a=e.rad(l.point2,l.point1,l.point3),("minor"===(d=o.evaluate(l.visProp.selection))&&a>Math.PI||"major"===d&&a<Math.PI)&&(a=-(2*Math.PI-a)),a*=.5,h=Math.cos(a),c=Math.sin(a),i.matVecMult([[1,0,0],[s[1]-.5*s[1]*h+.5*s[2]*c,.5*h,.5*-c],[s[2]-.5*s[1]*c-.5*s[2]*h,.5*c,.5*h]],t=[1,s[1]+(t[1]-s[1])*n/r,s[2]+(t[2]-s[2])*n/r]))}],d),l.dot.dump=!1,l.subs.dot=l.dot,"2lines"===f)for(u=0;u<2;u++)t.select(s[u]).addChild(l.dot);else for(u=0;u<3;u++)t.select(p[u]).addChild(l.dot);return l.getLabelAnchor=function(){var t,s,a,h,c,d,u,p,f=12,m=o.evaluate(l.visProp.selection),g=this.label?this.label.visProp:this.visProp.label;return o.exists(this.label.visProp.fontSize)&&(f=dy=o.evaluate(this.label.visProp.fontSize)),f/=this.board.unitX,s=l.point2.coords.usrCoords,a=l.point1.coords.usrCoords,h=l.Radius(),c=e.distance(s,a,3),d=e.rad(l.point2,l.point1,l.point3),("minor"===m&&d>Math.PI||"major"===m&&d<Math.PI)&&(d=-(2*Math.PI-d)),d*=.5,u=Math.cos(d),p=Math.sin(d),(t=i.matVecMult([[1,0,0],[a[1]-.5*a[1]*u+.5*a[2]*p,.5*u,.5*-p],[a[2]-.5*a[1]*p-.5*a[2]*u,.5*p,.5*u]],s=[1,a[1]+(s[1]-a[1])*h/c,a[2]+(s[2]-a[2])*h/c]))[1]/=t[0],t[2]/=t[0],t[0]/=t[0],c=e.distance(t,a,3),g.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],t=[t[0],a[1]+(t[1]-a[1])*(h+f)/c,a[2]+(t[2]-a[2])*(h+f)/c])),new n(r.COORDS_BY_USER,t,this.board)},l.Value=function(){return e.rad(this.point2,this.point1,this.point3)},l.methodMap=o.deepCopy(l.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),l},t.registerElement("angle",t.createAngle),t.createNonreflexAngle=function(i,s,n){var r;return n.selection="minor",(r=t.createAngle(i,s,n)).Value=function(){var t=e.rad(this.point2,this.point1,this.point3);return t<Math.PI?t:2*Math.PI-t},r},t.registerElement("nonreflexangle",t.createNonreflexAngle),t.createReflexAngle=function(i,s,n){var r;return n.selection="major",(r=t.createAngle(i,s,n)).Value=function(){var t=e.rad(this.point2,this.point1,this.point3);return t>=Math.PI?t:2*Math.PI-t},r},t.registerElement("reflexangle",t.createReflexAngle),{createSector:t.createSector,createCircumcircleSector:t.createCircumcircleSector,createMinorSector:t.createMinorSector,createMajorSector:t.createMajorSector,createAngle:t.createAngle,createReflexAngle:t.createReflexAngle,createNonreflexAngle:t.createNonreflexAngle}})),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],(function(t,e,i,s,n,r,o,a,l,h,c,d,u,p,f,m,g,b){"use strict";return t.createOrthogonalProjection=function(t,e,s){var n,r,l,h;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],s,"point")[0],n=e[1];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,line]");r=o.providePoints(t,[e[1]],s,"point")[0],n=e[0]}return h=o.copyAttributes(s,t.options,"orthogonalprojection"),l=t.create("point",[function(){return i.projectPointToLine(r,n,t)}],h),r.addChild(l),n.addChild(l),l.elType="orthogonalprojection",l.setParents([r.id,l.id]),l.update(),l.generatePolynomial=function(){var t=n.point1.symbolic.x,e=n.point1.symbolic.y,i=n.point2.symbolic.x,s=n.point2.symbolic.y,o=r.symbolic.x,a=r.symbolic.y,h=l.symbolic.x,c=l.symbolic.y;return["("+e+")*("+h+")-("+e+")*("+i+")+("+c+")*("+i+")-("+t+")*("+c+")+("+t+")*("+s+")-("+h+")*("+s+")","("+a+")*("+e+")-("+a+")*("+s+")-("+c+")*("+e+")+("+c+")*("+s+")+("+o+")*("+t+")-("+o+")*("+i+")-("+h+")*("+t+")+("+h+")*("+i+")"]},l},t.createPerpendicular=function(t,e,i){var s,n,r,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)n=e[1],s=o.providePoints(t,[e[0]],i,"point")[0];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [line,point]");n=e[0],s=o.providePoints(t,[e[1]],i,"point")[0]}return l=o.copyAttributes(i,t.options,"perpendicular"),(r=h.createLine(t,[function(){return n.stdform[2]*s.X()-n.stdform[1]*s.Y()},function(){return-n.stdform[2]*s.Z()},function(){return n.stdform[1]*s.Z()}],l)).elType="perpendicular",r.setParents([n.id,s.id]),r},t.createPerpendicularPoint=function(t,e,s){var n,r,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],s,"point")[0],n=e[1];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,line]");r=o.providePoints(t,[e[1]],s,"point")[0],n=e[0]}return l=t.create("point",[function(){return i.perpendicular(n,r,t)[0]}],s),r.addChild(l),n.addChild(l),l.elType="perpendicularpoint",l.setParents([r.id,n.id]),l.update(),l.generatePolynomial=function(){var t=n.point1.symbolic.x,e=n.point1.symbolic.y,i=n.point2.symbolic.x,s=n.point2.symbolic.y,o=r.symbolic.x,a=r.symbolic.y,h=l.symbolic.x,c=l.symbolic.y;return["("+e+")*("+h+")-("+e+")*("+i+")+("+c+")*("+i+")-("+t+")*("+c+")+("+t+")*("+s+")-("+h+")*("+s+")","("+a+")*("+e+")-("+a+")*("+s+")-("+c+")*("+e+")+("+c+")*("+s+")+("+o+")*("+t+")-("+o+")*("+i+")-("+h+")*("+t+")+("+h+")*("+i+")"]},l},t.createPerpendicularSegment=function(e,s,n){var r,l,c,d,u;if(s[0]=e.select(s[0]),s[1]=e.select(s[1]),o.isPointType(e,s[0])&&s[1].elementClass===a.OBJECT_CLASS_LINE)l=s[1],r=o.providePoints(e,[s[0]],n,"point")[0];else{if(!o.isPointType(e,s[1])||s[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"'.\nPossible parent types: [line,point]");l=s[0],r=o.providePoints(e,[s[1]],n,"point")[0]}return u=o.copyAttributes(n,e.options,"perpendicularsegment","point"),(d=t.createPerpendicularPoint(e,[l,r],u)).dump=!1,o.exists(n.layer)||(n.layer=e.options.layer.line),u=o.copyAttributes(n,e.options,"perpendicularsegment"),(c=h.createLine(e,[function(){return i.perpendicular(l,r,e)[1]?[d,r]:[r,d]}],u)).point=d,c.elType="perpendicularsegment",c.setParents([r.id,l.id]),c.subs={point:d},c.inherits.push(d),c},t.createMidpoint=function(t,i,s){var n,r,l,h,c;for(h=0;h<i.length;++h)i[h]=t.select(i[h]);if(2===i.length&&o.isPointType(t,i[0])&&o.isPointType(t,i[1]))i=o.providePoints(t,i,s,"point"),n=i[0],r=i[1];else{if(1!==i.length||i[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");n=i[0].point1,r=i[0].point2}return c=o.copyAttributes(s,t.options,"midpoint"),l=t.create("point",[function(){var t=n.coords.usrCoords[1]+r.coords.usrCoords[1];return isNaN(t)||Math.abs(n.coords.usrCoords[0])<e.eps||Math.abs(r.coords.usrCoords[0])<e.eps?NaN:.5*t},function(){var t=n.coords.usrCoords[2]+r.coords.usrCoords[2];return isNaN(t)||Math.abs(n.coords.usrCoords[0])<e.eps||Math.abs(r.coords.usrCoords[0])<e.eps?NaN:.5*t}],c),n.addChild(l),r.addChild(l),l.elType="midpoint",l.setParents([n.id,r.id]),l.prepareUpdate().update(),l.generatePolynomial=function(){var t=n.symbolic.x,e=n.symbolic.y,i=r.symbolic.x,s=r.symbolic.y,o=l.symbolic.x,a=l.symbolic.y;return["("+e+")*("+o+")-("+e+")*("+i+")+("+a+")*("+i+")-("+t+")*("+a+")+("+t+")*("+s+")-("+o+")*("+s+")","("+t+")^2 - 2*("+t+")*("+o+")+("+e+")^2-2*("+e+")*("+a+")-("+i+")^2+2*("+i+")*("+o+")-("+s+")^2+2*("+s+")*("+a+")"]},l},t.createParallelPoint=function(t,e,i){var s,n,r,l,h;for(h=0;h<e.length;++h)e[h]=t.select(e[h]);if(3===e.length&&o.isPointType(t,e[0])&&o.isPointType(t,e[1])&&o.isPointType(t,e[2]))e=o.providePoints(t,e,i,"point"),s=e[0],n=e[1],r=e[2];else if(o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],i,"point")[0],s=e[1].point1,n=e[1].point2;else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [line,point], [point,point,point]");r=o.providePoints(t,[e[1]],i,"point")[0],s=e[0].point1,n=e[0].point2}return l=t.create("point",[function(){return r.coords.usrCoords[1]+n.coords.usrCoords[1]-s.coords.usrCoords[1]},function(){return r.coords.usrCoords[2]+n.coords.usrCoords[2]-s.coords.usrCoords[2]}],i),s.addChild(l),n.addChild(l),r.addChild(l),l.elType="parallelpoint",l.setParents([s.id,n.id,r.id]),l.prepareUpdate().update(),l.generatePolynomial=function(){var t=s.symbolic.x,e=s.symbolic.y,i=n.symbolic.x,o=n.symbolic.y,a=r.symbolic.x,h=r.symbolic.y,c=l.symbolic.x,d=l.symbolic.y;return["("+o+")*("+c+")-("+o+")*("+a+")-("+e+")*("+c+")+("+e+")*("+a+")-("+d+")*("+i+")+("+d+")*("+t+")+("+h+")*("+i+")-("+h+")*("+t+")","("+d+")*("+t+")-("+d+")*("+a+")-("+o+")*("+t+")+("+o+")*("+a+")-("+c+")*("+e+")+("+c+")*("+h+")+("+i+")*("+e+")-("+i+")*("+h+")"]},l},t.createParallel=function(t,i,s){var n,r,a,l,h,c;for(h=0;h<i.length;++h)i[h]=t.select(i[h]);return n=null,3===i.length?(n=(i=o.providePoints(t,i,s,"point"))[2],l=function(){return e.crossProduct(i[0].coords.usrCoords,i[1].coords.usrCoords)}):o.isPointType(t,i[0])?(n=o.providePoints(t,[i[0]],s,"point")[0],l=function(){return i[1].stdform}):o.isPointType(t,i[1])&&(n=o.providePoints(t,[i[1]],s,"point")[0],l=function(){return i[0].stdform}),o.exists(s.layer)||(s.layer=t.options.layer.line),c=o.copyAttributes(s,t.options,"parallel","point"),(r=t.create("point",[function(){return e.crossProduct([1,0,0],l())}],c)).isDraggable=!0,c=o.copyAttributes(s,t.options,"parallel"),(a=t.create("line",[n,r],c)).elType="parallel",a.subs={point:r},a.inherits.push(r),a.setParents([i[0].id,i[1].id]),3===i.length&&a.addParents(i[2].id),a.point=r,a},t.createArrowParallel=function(e,i,s){var n;try{return s.firstArrow=!1,s.lastArrow=!0,(n=t.createParallel(e,i,s).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",n}catch(t){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [line,point], [point,point,point]")}},t.createNormal=function(t,i,n){var r,l,h,c,d,u,p,f,m;for(c=0;c<i.length;++c)i[c]=t.select(i[c]);if(1===i.length)l=(r=i[0]).slideObject;else{if(2!==i.length)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");if(o.isPointType(t,i[0]))r=o.providePoints(t,[i[0]],n,"point")[0],l=i[1];else{if(!o.isPointType(t,i[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");l=i[0],r=o.providePoints(t,[i[1]],n,"point")[0]}}if(p=o.copyAttributes(n,t.options,"normal"),l.elementClass===a.OBJECT_CLASS_LINE)m=o.copyAttributes(n,t.options,"normal","point"),(f=t.create("point",[function(){var t=e.crossProduct([1,0,0],l.stdform);return[t[0],-t[2],t[1]]}],m)).isDraggable=!0,(h=t.create("line",[r,f],p)).point=f,h.subs={point:f},h.inherits.push(f);else if(l.elementClass===a.OBJECT_CLASS_CIRCLE)h=t.create("line",[l.midpoint,r],p);else if(l.elementClass===a.OBJECT_CLASS_CURVE)"plot"!==o.evaluate(l.visProp.curvetype)?(d=l.X,u=l.Y,h=t.create("line",[function(){return-r.X()*s.D(d)(r.position)-r.Y()*s.D(u)(r.position)},function(){return s.D(d)(r.position)},function(){return s.D(u)(r.position)}],p)):h=t.create("line",[function(){var t=Math.floor(r.position),e=r.position-t;return t===l.numberPoints-1&&(t-=1,e=1),t<0?1:(l.Y(t)+e*(l.Y(t+1)-l.Y(t)))*(l.Y(t)-l.Y(t+1))-(l.X(t)+e*(l.X(t+1)-l.X(t)))*(l.X(t+1)-l.X(t))},function(){var t=Math.floor(r.position);return t===l.numberPoints-1&&(t-=1),t<0?0:l.X(t+1)-l.X(t)},function(){var t=Math.floor(r.position);return t===l.numberPoints-1&&(t-=1),t<0?0:l.Y(t+1)-l.Y(t)}],p);else{if(l.type!==a.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");h=t.create("line",[function(){var t,e,i=Math.floor(r.position),s=r.position-i;for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1,s=1),i<0?1:(t.Y(i)+s*(t.Y(i+1)-t.Y(i)))*(t.Y(i)-t.Y(i+1))-(t.X(i)+s*(t.X(i+1)-t.X(i)))*(t.X(i+1)-t.X(i))},function(){var t,e,i=Math.floor(r.position);for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1),i<0?0:t.X(i+1)-t.X(i)},function(){var t,e,i=Math.floor(r.position);for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1),i<0?0:t.Y(i+1)-t.Y(i)}],p)}return h.elType="normal",h.setParents(i),h},t.createBisector=function(t,e,s){var n,r,a,l;if(e=o.providePoints(t,e,s,"point"),o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])){for((l=o.copyAttributes(s,t.options,"bisector","point")).snapToGrid=!1,(n=t.create("point",[function(){return i.angleBisector(e[0],e[1],e[2],t)}],l)).dump=!1,a=0;a<3;a++)e[a].addChild(n);return o.exists(s.layer)||(s.layer=t.options.layer.line),l=o.copyAttributes(s,t.options,"bisector"),(r=h.createLine(t,[e[1],n],l)).point=n,r.elType="bisector",r.setParents(e),r.subs={point:n},r.inherits.push(n),r}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point,point]")},t.createAngularBisectorsOfTwoLines=function(t,e,i){var s,n,r,l,h=t.select(e[0]),c=t.select(e[1]);if(h.elementClass!==a.OBJECT_CLASS_LINE||c.elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [line,line]");return o.exists(i.layer)||(i.layer=t.options.layer.line),r=o.copyAttributes(i,t.options,"bisectorlines","line1"),s=t.create("line",[function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[0]/t-c.stdform[0]/e},function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[1]/t-c.stdform[1]/e},function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[2]/t-c.stdform[2]/e}],r),o.exists(i.layer)||(i.layer=t.options.layer.line),r=o.copyAttributes(i,t.options,"bisectorlines","line2"),n=t.create("line",[function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[0]/t+c.stdform[0]/e},function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[1]/t+c.stdform[1]/e},function(){var t=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]),e=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]);return h.stdform[2]/t+c.stdform[2]/e}],r),l=new u({line1:s,line2:n}),s.dump=!1,n.dump=!1,l.elType="bisectorlines",l.setParents([h.id,c.id]),l.subs={line1:s,line2:n},l},t.createCircumcenter=function(t,e,s){var n,r,a,h,c;if(e=o.providePoints(t,e,s,"point"),o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])){for(a=e[0],h=e[1],c=e[2],n=l.createPoint(t,[function(){return i.circumcenter(a,h,c,t)}],s),r=0;r<3;r++)e[r].addChild(n);return n.elType="circumcenter",n.setParents(e),n.generatePolynomial=function(){var t=a.symbolic.x,e=a.symbolic.y,i=c.symbolic.x,s=c.symbolic.y,r=n.symbolic.x,o=n.symbolic.y;return[["((",r,")-(",t,"))^2+((",o,")-(",e,"))^2-((",r,")-(",h.symbolic.x,"))^2-((",o,")-(",h.symbolic.y,"))^2"].join(""),["((",r,")-(",t,"))^2+((",o,")-(",e,"))^2-((",r,")-(",i,"))^2-((",o,")-(",s,"))^2"].join("")]},n}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]")},t.createIncenter=function(t,e,i){var s,n,l,h;if(!((e=o.providePoints(t,e,i,"point")).length>=3&&o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]");return n=e[0],l=e[1],h=e[2],(s=t.create("point",[function(){var e,i,s;return e=Math.sqrt((l.X()-h.X())*(l.X()-h.X())+(l.Y()-h.Y())*(l.Y()-h.Y())),i=Math.sqrt((n.X()-h.X())*(n.X()-h.X())+(n.Y()-h.Y())*(n.Y()-h.Y())),s=Math.sqrt((l.X()-n.X())*(l.X()-n.X())+(l.Y()-n.Y())*(l.Y()-n.Y())),new r(a.COORDS_BY_USER,[(e*n.X()+i*l.X()+s*h.X())/(e+i+s),(e*n.Y()+i*l.Y()+s*h.Y())/(e+i+s)],t)}],i)).elType="incenter",s.setParents(e),s},t.createCircumcircle=function(e,i,s){var n,r,a;if(!1===(i=o.providePoints(e,i,s,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]");try{a=o.copyAttributes(s,e.options,"circumcircle","center"),(n=t.createCircumcenter(e,i,a)).dump=!1,o.exists(s.layer)||(s.layer=e.options.layer.circle),a=o.copyAttributes(s,e.options,"circumcircle"),(r=c.createCircle(e,[n,i[0]],a)).elType="circumcircle",r.setParents(i),r.subs={center:n},r.inherits.push(r)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]")}return r},t.createIncircle=function(e,i,s){var n,r,a;if(!1===(i=o.providePoints(e,i,s,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]");try{a=o.copyAttributes(s,e.options,"incircle","center"),(n=t.createIncenter(e,i,a)).dump=!1,o.exists(s.layer)||(s.layer=e.options.layer.circle),a=o.copyAttributes(s,e.options,"incircle"),(r=c.createCircle(e,[n,function(){var t=Math.sqrt((i[1].X()-i[2].X())*(i[1].X()-i[2].X())+(i[1].Y()-i[2].Y())*(i[1].Y()-i[2].Y())),e=Math.sqrt((i[0].X()-i[2].X())*(i[0].X()-i[2].X())+(i[0].Y()-i[2].Y())*(i[0].Y()-i[2].Y())),s=Math.sqrt((i[1].X()-i[0].X())*(i[1].X()-i[0].X())+(i[1].Y()-i[0].Y())*(i[1].Y()-i[0].Y())),n=(t+e+s)/2;return Math.sqrt((n-t)*(n-e)*(n-s)/n)}],a)).elType="incircle",r.setParents(i),r.center=n,r.subs={center:r.center},r.inherits.push(n)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]")}return r},t.createReflection=function(t,e,i){var s,n,r,u,f,g="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]";for(f=0;f<e.length;++f)e[f]=t.select(e[f]);if(o.isPoint(e[0]))n=o.providePoints(t,[e[0]],i,"point")[0];else{if(e[0].elementClass!==a.OBJECT_CLASS_CURVE&&e[0].elementClass!==a.OBJECT_CLASS_LINE&&e[0].type!==a.OBJECT_TYPE_POLYGON&&e[0].elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);n=e[0]}if(e[1].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);if(u=d.createTransform(t,[s=e[1]],{type:"reflect"}),o.isPoint(n))r=l.createPoint(t,[n,u],i);else if(n.elementClass===a.OBJECT_CLASS_CURVE)r=p.createCurve(t,[n,u],i);else if(n.elementClass===a.OBJECT_CLASS_LINE)r=h.createLine(t,[n,u],i);else if(n.type===a.OBJECT_TYPE_POLYGON)r=m.createPolygon(t,[n,u],i);else{if(n.elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);r=c.createCircle(t,[n,u],i)}return n.addChild(r),s.addChild(r),r.elType="reflection",r.setParents([n,s]),r.prepareUpdate().update(),o.isPoint(r)&&(r.generatePolynomial=function(){var t=s.point1.symbolic.x,e=s.point1.symbolic.y,i=n.symbolic.x,o=n.symbolic.y,a=r.symbolic.x,l=r.symbolic.y;return[["((",l,")-(",o,"))*((",e,")-(",s.point2.symbolic.y,"))+((",t,")-(",s.point2.symbolic.x,"))*((",a,")-(",i,"))"].join(""),["((",a,")-(",t,"))^2+((",l,")-(",e,"))^2-((",i,")-(",t,"))^2-((",o,")-(",e,"))^2"].join("")]}),r},t.createMirrorElement=function(t,e,i){var s,n,r,u,f="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]";if(o.isPoint(e[0]))s=o.providePoints(t,[e[0]],i,"point")[0];else{if(e[0].elementClass!==a.OBJECT_CLASS_CURVE&&e[0].elementClass!==a.OBJECT_CLASS_LINE&&e[0].type!==a.OBJECT_TYPE_POLYGON&&e[0].elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);s=e[0]}if(!o.isPoint(e[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);if(n=o.providePoints(t,[e[1]],i,"point")[0],u=d.createTransform(t,[Math.PI,n],{type:"rotate"}),o.isPoint(s))r=l.createPoint(t,[s,u],i);else if(s.elementClass===a.OBJECT_CLASS_CURVE)r=p.createCurve(t,[s,u],i);else if(s.elementClass===a.OBJECT_CLASS_LINE)r=h.createLine(t,[s,u],i);else if(s.type===a.OBJECT_TYPE_POLYGON)r=m.createPolygon(t,[s,u],i);else{if(s.elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);r=c.createCircle(t,[s,u],i)}return s.addChild(r),n.addChild(r),r.elType="mirrorpoint",r.setParents([s,n]),r.prepareUpdate().update(),r},t.createMirrorPoint=function(e,i,s){return t.createMirrorElement(e,i,s)},t.createIntegral=function(e,i,n){var l,h,c,d,u,p,f,m,g,b,y,v,C,x,_=null;if(o.isArray(i[0])&&i[1].elementClass===a.OBJECT_CLASS_CURVE)l=i[0],h=i[1];else{if(!o.isArray(i[1])||i[0].elementClass!==a.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [[number|function,number|function],curve]");l=i[1],h=i[0]}return(c=o.copyAttributes(n,e.options,"integral")).withLabel=!1,x=e.create("curve",[[0],[0]],c),u=l[1],o.isFunction(d=l[0])?(f=function(){return h.Y(p())},d=(p=d)()):(p=d,f=h.Y(d)),o.isFunction(u)?(g=function(){return h.Y(m())},u=(m=u)()):(m=u,g=h.Y(u)),c=o.copyAttributes(n,e.options,"integral","curveLeft"),b=e.create("glider",[p,f,h],c),o.isFunction(p)&&b.hideElement(),c=o.copyAttributes(n,e.options,"integral","baseLeft"),y=e.create("point",[function(){return"y"===o.evaluate(x.visProp.axis)?0:b.X()},function(){return"y"===o.evaluate(x.visProp.axis)?b.Y():0}],c),c=o.copyAttributes(n,e.options,"integral","curveRight"),v=e.create("glider",[m,g,h],c),o.isFunction(m)&&v.hideElement(),c=o.copyAttributes(n,e.options,"integral","baseRight"),C=e.create("point",[function(){return"y"===o.evaluate(x.visProp.axis)?0:v.X()},function(){return"y"===o.evaluate(x.visProp.axis)?v.Y():0}],c),!1!==(c=o.copyAttributes(n,e.options,"integral")).withlabel&&"y"!==c.axis&&(c=o.copyAttributes(n,e.options,"integral","label"),c=o.copyAttributes(c,e.options,"label"),(_=e.create("text",[function(){var t=new r(a.COORDS_BY_SCREEN,[o.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),e=this.board.getBoundingBox(),i=.1*(e[2]-e[0]),s=v.X();return s<e[0]?s=e[0]+i:s>e[2]&&(s=e[2]-i),s+t.usrCoords[1]},function(){var t=new r(a.COORDS_BY_SCREEN,[0,o.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),e=this.board.getBoundingBox(),i=.1*(e[1]-e[3]),s=v.Y();return s>e[1]?s=e[1]-i:s<e[3]&&(s=e[3]+i),s+t.usrCoords[2]},function(){var t=s.NewtonCotes([y.X(),C.X()],h.Y);return"&int; = "+o.toFixed(t,4)}],c)).dump=!1,b.addChild(_),v.addChild(_)),b.dump=!1,y.dump=!1,v.dump=!1,C.dump=!1,x.elType="integral",x.setParents([h.id,l]),x.subs={curveLeft:b,baseLeft:y,curveRight:v,baseRight:C},x.inherits.push(b,y,v,C),c.withLabel&&(x.subs.label=_,x.inherits.push(_)),x.Value=function(){return s.I([y.X(),C.X()],h.Y)},x.updateDataArray=function(){var t,e,i,s,n,r,a,l,c;if("y"===o.evaluate(this.visProp.axis)){for(b.Y()<v.Y()?(r=b.X(),l=b.Y(),a=v.X(),c=v.Y()):(r=v.X(),l=v.Y(),a=b.X(),c=b.Y()),s=Math.min(r,a),n=Math.max(r,a),t=[0,r],e=[l,l],i=0;i<h.numberPoints;i++)l<=h.points[i].usrCoords[2]&&s<=h.points[i].usrCoords[1]&&h.points[i].usrCoords[2]<=c&&h.points[i].usrCoords[1]<=n&&(t.push(h.points[i].usrCoords[1]),e.push(h.points[i].usrCoords[2]));t.push(a),e.push(c),t.push(0),e.push(c),t.push(0),e.push(l)}else{for(y.X()<C.X()?(s=y.X(),n=C.X()):(s=C.X(),n=y.X()),t=[s,s],e=[0,h.Y(s)],i=0;i<h.numberPoints;i++)s<=h.points[i].usrCoords[1]&&h.points[i].usrCoords[1]<=n&&(t.push(h.points[i].usrCoords[1]),e.push(h.points[i].usrCoords[2]));t.push(n),e.push(h.Y(n)),t.push(n),e.push(0),t.push(s),e.push(0)}this.dataX=t,this.dataY=e},b.addChild(x),v.addChild(x),y.addChild(x),C.addChild(x),x.baseLeft=y,x.baseRight=C,x.curveLeft=b,x.curveRight=v,x.methodMap=t.deepCopy(x.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),x.label=_,x},t.createGrid=function(t,e,i){var s,n;return n=o.copyAttributes(i,t.options,"grid"),(s=t.create("curve",[[null],[null]],n)).elType="grid",s.type=a.OBJECT_TYPE_GRID,s.updateDataArray=function(){var e,i,n,l,h,c=o.evaluate(this.visProp.gridx),d=o.evaluate(this.visProp.gridy);for(l=o.isArray(this.visProp.topleft)?new r(o.evaluate(this.visProp.tltype)||a.COORDS_BY_USER,this.visProp.topleft,t):new r(a.COORDS_BY_SCREEN,[0,0],t),h=o.isArray(this.visProp.bottomright)?new r(o.evaluate(this.visProp.brtype)||a.COORDS_BY_USER,this.visProp.bottomright,t):new r(a.COORDS_BY_SCREEN,[t.canvasWidth,t.canvasHeight],t),t.options.grid.hasGrid=!0,s.dataX=[],s.dataY=[],e=Math.floor(l.usrCoords[2]/d)*d,i=Math.ceil(h.usrCoords[2]/d)*d,l.usrCoords[2]<h.usrCoords[2]&&(e=Math.ceil(h.usrCoords[2]/d)*d,i=Math.floor(l.usrCoords[2]/d)*d),n=e;n>i-d;n-=d)s.dataX.push(l.usrCoords[1],h.usrCoords[1],NaN),s.dataY.push(n,n,NaN);for(e=Math.ceil(l.usrCoords[1]/c)*c,i=Math.floor(h.usrCoords[1]/c)*c,l.usrCoords[1]>h.usrCoords[1]&&(e=Math.floor(h.usrCoords[1]/c)*c,i=Math.ceil(l.usrCoords[1]/c)*c),n=e;n<i+c;n+=c)s.dataX.push(n,n,NaN),s.dataY.push(l.usrCoords[2],h.usrCoords[2],NaN)},s.hasPoint=function(){return!1},t.grids.push(s),s},t.createInequality=function(t,s,n){var r,l,h;if(h=o.copyAttributes(n,t.options,"inequality"),s[0].elementClass===a.OBJECT_CLASS_LINE)(l=t.create("curve",[[],[]],h)).hasPoint=function(){return!1},l.updateDataArray=function(){var n,r,o,l=t.getBoundingBox(),c=h.inverse?-1:1,d=1.5*Math.max(l[2]-l[0],l[1]-l[3]),u={coords:{usrCoords:[1,(l[0]+l[2])/2,h.inverse?l[1]:l[3]]}},p=s[0].stdform.slice(1),f=p;o=1.5*Math.max(i.perpendicular(s[0],u,t)[0].distance(a.COORDS_BY_USER,u.coords),d),o*=c,u={coords:{usrCoords:[1,(l[0]+l[2])/2,(l[1]+l[3])/2]}},u=Math.abs(e.innerProduct(u.coords.usrCoords,s[0].stdform,3))>=e.eps?i.perpendicular(s[0],u,t)[0].usrCoords:u.coords.usrCoords,this.dataX=[(n=[1,u[1]+p[1]*d,u[2]-p[0]*d])[1],n[1]+p[0]*o,(r=[1,u[1]-f[1]*d,u[2]+f[0]*d])[1]+f[0]*o,r[1],n[1]],this.dataY=[n[2],n[2]+p[1]*o,r[2]+f[1]*o,r[2],n[2]]};else if(s[0].elementClass===a.OBJECT_CLASS_CURVE&&"functiongraph"===s[0].visProp.curvetype)(l=t.create("curve",[[],[]],h)).hasPoint=function(){return!1},l.updateDataArray=function(){var t,e,i=this.board.getBoundingBox(),n=1.5*(h.inverse?i[1]:i[3]);if(this.dataX=[],this.dataY=[],!((e=s[0].points.length)<=0)){for(this.dataX.push(s[0].points[0].usrCoords[1]),this.dataY.push(n),t=0;t<e;t++)this.dataX.push(s[0].points[t].usrCoords[1]),this.dataY.push(s[0].points[t].usrCoords[2]);this.dataX.push(s[0].points[e-1].usrCoords[1]),this.dataY.push(n)}};else if(r=o.createFunction(s[0]),!o.exists(r))throw new Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]");return l.addParents(s[0]),l},t.registerElement("arrowparallel",t.createArrowParallel),t.registerElement("bisector",t.createBisector),t.registerElement("bisectorlines",t.createAngularBisectorsOfTwoLines),t.registerElement("msector",t.createMsector),t.registerElement("circumcircle",t.createCircumcircle),t.registerElement("circumcirclemidpoint",t.createCircumcenter),t.registerElement("circumcenter",t.createCircumcenter),t.registerElement("incenter",t.createIncenter),t.registerElement("incircle",t.createIncircle),t.registerElement("integral",t.createIntegral),t.registerElement("midpoint",t.createMidpoint),t.registerElement("mirrorelement",t.createMirrorElement),t.registerElement("mirrorpoint",t.createMirrorPoint),t.registerElement("normal",t.createNormal),t.registerElement("orthogonalprojection",t.createOrthogonalProjection),t.registerElement("parallel",t.createParallel),t.registerElement("parallelpoint",t.createParallelPoint),t.registerElement("perpendicular",t.createPerpendicular),t.registerElement("perpendicularpoint",t.createPerpendicularPoint),t.registerElement("perpendicularsegment",t.createPerpendicularSegment),t.registerElement("reflection",t.createReflection),t.registerElement("grid",t.createGrid),t.registerElement("inequality",t.createInequality),{createArrowParallel:t.createArrowParallel,createBisector:t.createBisector,createAngularBisectorOfTwoLines:t.createAngularBisectorsOfTwoLines,createCircumcircle:t.createCircumcircle,createCircumcenter:t.createCircumcenter,createIncenter:t.createIncenter,createIncircle:t.createIncircle,createIntegral:t.createIntegral,createMidpoint:t.createMidpoint,createMirrorElement:t.createMirrorElement,createMirrorPoint:t.createMirrorPoint,createNormal:t.createNormal,createOrthogonalProjection:t.createOrthogonalProjection,createParallel:t.createParallel,createParallelPoint:t.createParallelPoint,createPerpendicular:t.createPerpendicular,createPerpendicularPoint:t.createPerpendicularPoint,createPerpendicularSegmen:t.createPerpendicularSegment,createReflection:t.createReflection,createGrid:t.createGrid,createInequality:t.createInequality}})),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],(function(t,e,i,s,n,r,o,a,l,h,c,d,u,p,f,m,g,b,y,v,C){"use strict";return t.Board=function(t,i,n,r,o,a,l,c,d,m,g){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,u.exists(g.document)&&!1!==g.document?this.document=g.document:void 0!==document&&u.isObject(document)&&(this.document=document),this.container=t,this.containerObj=f.isBrowser?this.document.getElementById(this.container):null,f.isBrowser&&"no"!==i.type&&null===this.containerObj)throw new Error("\nJSXGraph: HTML container element '"+t+"' not found.");this.renderer=i,this.grids=[],this.options=u.deepCopy(s),this.attr=g,this.dimension=2,this.jc=new h,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,r[0],r[1]],this.zoomX=o,this.zoomY=a,this.unitX=l*this.zoomX,this.unitY=c*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=d,this.canvasHeight=m,this.id=u.exists(n)&&""!==n&&f.isBrowser&&!u.exists(this.document.getElementById(n))?n:this.generateId(),p.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(e.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},t.extend(t.Board.prototype,{generateName:function(t){var i,s,n=this.attr.maxnamelength,r="",o="",a=[],l="";if(t.type===e.OBJECT_TYPE_TICKS)return"";for(i=u.isPoint(t)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:t.type===e.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],u.isPoint(t)||t.elementClass===e.OBJECT_CLASS_LINE||t.type===e.OBJECT_TYPE_ANGLE||(r=t.type===e.OBJECT_TYPE_POLYGON?"P_{":t.elementClass===e.OBJECT_CLASS_CIRCLE?"k_{":t.elementClass===e.OBJECT_CLASS_TEXT?"t_{":"s_{",o="}"),s=0;s<n;s++)a[s]=0;for(;a[n-1]<i.length;){for(a[0]=1;a[0]<i.length;a[0]++){for(l=r,s=n;s>0;s--)l+=i[a[s-1]];if(!u.exists(this.elementsByName[l+o]))return l+o}for(a[0]=i.length,s=1;s<n;s++)a[s-1]===i.length&&(a[s-1]=1,a[s]+=1)}return""},generateId:function(){for(var e=1;u.exists(t.boards["jxgBoard"+e]);)e=Math.round(65535*Math.random());return"jxgBoard"+e},setId:function(t,e){var i,s=this.numObjects,n=t.id;if(this.numObjects+=1,""===n||!u.exists(n))for(n=this.id+e+s;u.exists(this.objects[n]);)i=Math.round(65535*Math.random()),n=this.id+e+s+"-"+i;return t.id=n,this.objects[n]=t,t._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=t,n},finalizeAdding:function(t){!1===u.evaluate(t.visProp.visible)&&this.renderer.display(t,!1)},finalizeLabel:function(t){t.hasLabel&&!u.evaluate(t.label.visProp.islabel)&&!1===u.evaluate(t.label.visProp.visible)&&this.renderer.display(t.label,!1)},getCoordsTopLeftCorner:function(){var t,e,i,s,n=this.document.documentElement||this.document.body.parentNode,r=this.document.body,o=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||(new Date).getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=(new Date).getTime(),o.getBoundingClientRect){for(e=o.getBoundingClientRect(),i=1,s=o;s&&u.exists(s.parentNode);)u.exists(s.style)&&u.exists(s.style.zoom)&&""!==s.style.zoom&&(i*=parseFloat(s.style.zoom)),s=s.parentNode;return(t=[e.left*i,e.top*i])[0]+=f.getProp(o,"border-left-width"),t[1]+=f.getProp(o,"border-top-width"),"vml"!==this.renderer.type&&(t[0]+=f.getProp(o,"padding-left"),t[1]+=f.getProp(o,"padding-top")),this.cPos=t.slice(),this.cPos}return t=f.getOffset(o),!this.containerObj.currentStyle&&this.document.documentElement.ownerDocument.defaultView&&(t[0]+=f.getProp(n,"margin-left"),t[1]+=f.getProp(n,"margin-top"),t[0]+=f.getProp(n,"border-left-width"),t[1]+=f.getProp(n,"border-top-width"),t[0]+=f.getProp(n,"padding-left"),t[1]+=f.getProp(n,"padding-top")),r&&(t[0]+=f.getProp(r,"left"),t[1]+=f.getProp(r,"top")),"object"==typeof google&&google.translate&&(t[0]+=10,t[1]+=25),t[0]+=f.getProp(o,"border-left-width"),t[1]+=f.getProp(o,"border-top-width"),"vml"!==this.renderer.type&&(t[0]+=f.getProp(o,"padding-left"),t[1]+=f.getProp(o,"padding-top")),t[0]+=this.attr.offsetx,t[1]+=this.attr.offsety,this.cPos=t.slice(),this.cPos},getMousePosition:function(t,e){var i,s,n=this.getCoordsTopLeftCorner();return i=f.getPosition(t,e,this.document),u.exists(this.cssTransMat)||this.updateCSSTransforms(),(s=r.matVecMult(this.cssTransMat,s=[1,i[0]-n[0],i[1]-n[1]]))[1]/=s[0],s[2]/=s[0],[s[1],s[2]]},initMoveOrigin:function(t,e){this.drag_dx=t-this.origin.scrCoords[1],this.drag_dy=e-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(t,i,s,n){var r,o,a,h=[],c=[],d=this.objectsList.length,p={visProp:{layer:-1e4}};for(o=0;o<d;o++)a=(r=this.objectsList[o]).hasPoint&&r.hasPoint(t,i),r.visPropCalc.visible&&a&&(r.triggerEventHandlers([n+"down","down"],[s]),this.downObjects.push(r)),(this.geonextCompatibilityMode&&(u.isPoint(r)||r.elementClass===e.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&r.isDraggable&&r.visPropCalc.visible&&!u.evaluate(r.visProp.fixed)&&a&&(r.visProp.layer>p.visProp.layer||r.visProp.layer===p.visProp.layer&&r.lastDragTime.getTime()>=p.lastDragTime.getTime())&&(this.attr.ignorelabels&&u.exists(p.label)&&r===p.label||(h.push(p=r),u.exists(p.coords)?c.push(l.subtract(p.coords.scrCoords.slice(1),[t,i])):c.push([0,0])));return h.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(h.length=1,this._drag_offset=c[0]):(h=h.slice(-1),this._drag_offset=c[c.length-1]),this._drag_offset||(this._drag_offset=[0,0]),"svg"===this.renderer.type&&u.exists(h[0])&&u.evaluate(h[0].visProp.dragtotopoflayer)&&1===h.length&&u.exists(h[0].rendNode)&&h[0].rendNode.parentNode.appendChild(h[0].rendNode),h},moveObject:function(t,s,n,r,o){var a,h,c,d=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t,s),this);n&&n.obj&&((a=n.obj).coords&&(h=a.coords.scrCoords.slice()),this.drag_position=[d.scrCoords[1],d.scrCoords[2]],this.drag_position=l.add(this.drag_position,this._drag_offset),u.exists(a.coords)?a.setPositionDirectly(e.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(n.targets[0].Xprev+n.targets[0].Yprev)||a.setPositionDirectly(e.COORDS_BY_SCREEN,[d.scrCoords[1],d.scrCoords[2]],[n.targets[0].Xprev,n.targets[0].Yprev]),n.targets[0].Xprev=d.scrCoords[1],n.targets[0].Yprev=d.scrCoords[2]),a.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(a),a.prepareUpdate().update(!0).updateRenderer(),a.coords&&(c=a.coords.scrCoords),a.coords&&h[1]===c[1]&&h[2]===c[2]||(a.triggerEventHandlers([o+"drag","drag"],[r]),this.update()),a.highlight(!0),a.lastDragTime=new Date)},twoFingerMove:function(t,s,n,r){var o,a,l;u.exists(n)&&u.exists(n.obj)&&(l=n.obj,o=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t[0],t[1]),this),a=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(s[0],s[1]),this),l.elementClass===e.OBJECT_CLASS_LINE||l.type===e.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(o,a,n,l):l.elementClass===e.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(o,a,n,l),l.triggerEventHandlers(["touchdrag","drag"],[r]),n.targets[0].Xprev=o.scrCoords[1],n.targets[0].Yprev=o.scrCoords[2],n.targets[1].Xprev=a.scrCoords[1],n.targets[1].Yprev=a.scrCoords[2])},twoFingerTouchObject:function(t,s,n,a){var l,h,c,d,p,f,m,g,b,y,v,C,x,_,P,S,w,E,k;if(u.exists(n.targets[0])&&u.exists(n.targets[1])&&!isNaN(n.targets[0].Xprev+n.targets[0].Yprev+n.targets[1].Xprev+n.targets[1].Yprev)){if(l=t.usrCoords,h=s.usrCoords,c=new i(e.COORDS_BY_SCREEN,[n.targets[0].Xprev,n.targets[0].Yprev],this).usrCoords,d=new i(e.COORDS_BY_SCREEN,[n.targets[1].Xprev,n.targets[1].Yprev],this).usrCoords,f=[1,.5*(c[1]+d[1]),.5*(c[2]+d[2])],p=[1,.5*(l[1]+h[1]),.5*(l[2]+h[2])],g=r.crossProduct(c,d),m=r.crossProduct(l,h),y=r.crossProduct(g,m),Math.abs(y[0])<r.eps)return;if(y[1]/=y[0],y[2]/=y[0],v=o.rad(f.slice(1),y.slice(1),p.slice(1)),(C=this.create("transform",[v,y[1],y[2]],{type:"rotate"})).update(),(f=r.matVecMult(C.matrix,f))[1]/=f[0],f[2]/=f[0],(x=this.create("transform",[p[1]-f[1],p[2]-f[2]],{type:"translate"})).update(),C.melt(x),u.evaluate(a.visProp.scalable)&&(b=o.distance(l,h)/o.distance(c,d),_=this.create("transform",[-p[1],-p[2]],{type:"translate"}),P=this.create("transform",[b,b],{type:"scale"}),S=this.create("transform",[p[1],p[2]],{type:"translate"}),C.melt(_).melt(P).melt(S)),a.elementClass===e.OBJECT_CLASS_LINE)w=[],a.point1.draggable()&&w.push(a.point1),a.point2.draggable()&&w.push(a.point2),C.applyOnce(w);else if(a.type===e.OBJECT_TYPE_POLYGON){for(w=[],k=a.vertices.length-1,E=0;E<k;++E)a.vertices[E].draggable()&&w.push(a.vertices[E]);C.applyOnce(w)}this.update(),a.highlight(!0)}},twoFingerTouchCircle:function(t,s,n,r){var a,l,h,c,d,p,f,m,g,b,y;"pointCircle"!==r.method&&"pointLine"!==r.method&&u.exists(n.targets[0])&&u.exists(n.targets[1])&&!isNaN(n.targets[0].Xprev+n.targets[0].Yprev+n.targets[1].Xprev+n.targets[1].Yprev)&&(a=t.usrCoords,l=s.usrCoords,h=new i(e.COORDS_BY_SCREEN,[n.targets[0].Xprev,n.targets[0].Yprev],this).usrCoords,c=new i(e.COORDS_BY_SCREEN,[n.targets[1].Xprev,n.targets[1].Yprev],this).usrCoords,f=this.create("transform",[a[1]-h[1],a[2]-h[2]],{type:"translate"}),p=o.rad(c.slice(1),a.slice(1),l.slice(1)),m=this.create("transform",[-a[1],-a[2]],{type:"translate"}),g=this.create("transform",[p],{type:"rotate"}),f.melt(m).melt(g),u.evaluate(r.visProp.scalable)&&(d=o.distance(a,l)/o.distance(h,c),b=this.create("transform",[d,d],{type:"scale"}),f.melt(b)),y=this.create("transform",[a[1],a[2]],{type:"translate"}),f.melt(y),r.center.draggable()&&f.applyOnce([r.center]),"twoPoints"===r.method?r.point2.draggable()&&f.applyOnce([r.point2]):"pointRadius"===r.method&&u.isNumber(r.updateRadius.origin)&&r.setRadius(r.radius*d),this.update(r.center),r.highlight(!0))},highlightElements:function(t,e,i,s){var n,r,o,a={},l=this.objectsList.length;for(n=0;n<l;n++)o=(r=this.objectsList[n]).id,u.exists(r.hasPoint)&&r.visPropCalc.visible&&r.hasPoint(t,e)&&(this.updateInfobox(r),u.exists(this.highlightedObjects[o])||(a[o]=r,r.highlight(),r.triggerEventHandlers(["mousehit","hit"],[i,r,s])),r.mouseover?r.triggerEventHandlers(["mousemove","move"],[i]):(r.triggerEventHandlers(["mouseover","over"],[i]),r.mouseover=!0));for(n=0;n<l;n++)o=(r=this.objectsList[n]).id,r.mouseover&&(a[o]||(r.triggerEventHandlers(["mouseout","out"],[i]),r.mouseover=!1))},saveStartPos:function(i,s){var n,r,o=[];if(i.type===e.OBJECT_TYPE_TICKS)o.push([1,NaN,NaN]);else if(i.elementClass===e.OBJECT_CLASS_LINE)o.push(i.point1.coords.usrCoords),o.push(i.point2.coords.usrCoords);else if(i.elementClass===e.OBJECT_CLASS_CIRCLE)o.push(i.center.coords.usrCoords),"twoPoints"===i.method&&o.push(i.point2.coords.usrCoords);else if(i.type===e.OBJECT_TYPE_POLYGON)for(r=i.vertices.length-1,n=0;n<r;n++)o.push(i.vertices[n].coords.usrCoords);else if(i.type===e.OBJECT_TYPE_SECTOR)o.push(i.point1.coords.usrCoords),o.push(i.point2.coords.usrCoords),o.push(i.point3.coords.usrCoords);else if(u.isPoint(i)||i.type===e.OBJECT_TYPE_GLIDER)o.push(i.coords.usrCoords);else if(i.elementClass===e.OBJECT_CLASS_CURVE)i.points.length>0&&o.push(i.points[0].usrCoords);else try{o.push(i.coords.usrCoords)}catch(e){t.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+e)}for(r=o.length,n=0;n<r;n++)s.Zstart.push(o[n][0]),s.Xstart.push(o[n][1]),s.Ystart.push(o[n][2])},mouseOriginMoveStart:function(t){var e,i;return(e=this._isRequiredKeyPressed(t,"pan"))&&(i=this.getMousePosition(t),this.initMoveOrigin(i[0],i[1])),e},mouseOriginMove:function(t){var e,i=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return i&&(e=this.getMousePosition(t),this.moveOrigin(e[0],e[1],!0)),i},touchOriginMoveStart:function(e){var i,s;return(i=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&1==e[t.touchProperty].length)&&(s=this.getMousePosition(e,0),this.initMoveOrigin(s[0],s[1])),i},touchOriginMove:function(t){var e,i=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return i&&(e=this.getMousePosition(t,0),this.moveOrigin(e[0],e[1],!0)),i},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){f.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),null!==this.containerObj&&(this.containerObj.oncontextmenu=function(t){return u.exists(t)&&t.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&f.isBrowser&&(window.navigator.msPointerEnabled?(f.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),f.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(f.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),f.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),null!==this.containerObj&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&f.isBrowser&&(f.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),f.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(t){!this.hasTouchHandlers&&f.isBrowser&&(f.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),f.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&f.isBrowser&&(window.navigator.msPointerEnabled?(f.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),f.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(f.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),f.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&f.isBrowser&&(f.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),f.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(f.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&f.isBrowser&&(f.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),f.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(f.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(t){var s,n,r,a,l,h,c,d,u,p=this.attr.zoom.factorx,f=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(t.preventDefault(),s=new i(e.COORDS_BY_SCREEN,this.getMousePosition(t,0),this),r=o.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),void 0===t.scale&&(t.scale=r/this.prevDist),n=t.scale/this.prevScale,this.prevScale=t.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(t.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(s.scrCoords[1],s.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(n-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(a=Math.abs(t.touches[0].clientX-t.touches[1].clientX),l=Math.abs(t.touches[0].clientY-t.touches[1].clientY),h=Math.abs(Math.atan2(l,a)),u=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&h<u?(this.attr.zoom.factorx=n,this.attr.zoom.factory=1,c=0,d=0):this.attr.zoom.pinchvertical&&Math.abs(h-.5*Math.PI)<u?(this.attr.zoom.factorx=1,this.attr.zoom.factory=n,c=0,d=0):(this.attr.zoom.factorx=n,this.attr.zoom.factory=n,c=s.usrCoords[1],d=s.usrCoords[2]),this.zoomIn(c,d),this.attr.zoom.factorx=p,this.attr.zoom.factory=f),!1)},gestureStartListener:function(t){var e;return t.preventDefault(),this.prevScale=1,this.prevDist=o.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),e=this.getMousePosition(t,0),this.initMoveOrigin(e[0],e[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(t,e){var i=this.attr[e];return!!i.enabled&&!(!(i.needshift&&t.shiftKey||!i.needshift&&!t.shiftKey)||!(i.needctrl&&t.ctrlKey||!i.needctrl&&!t.ctrlKey))},_pointerAddBoardTouches:function(t){var e,i;for(e=0,i=!1;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches[e].clientX=t.clientX,this._board_touches[e].clientY=t.clientY,i=!0;break}return i||this._board_touches.push({pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY}),this},_pointerRemoveBoardTouches:function(t){var e;for(e=0;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches.splice(e,1);break}return this},pointerDownListener:function(t,e){var i,s,n,r,o,a,l,h,c=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?f.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&u.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(a=window.getSelection()).removeAllRanges)try{a.removeAllRanges()}catch(t){}if(f.isBrowser&&("touch"===t.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=c),r=this.getMousePosition(t),this._testForSelection(t),this.selectingMode)return this._startSelecting(r),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[t]);if(e?(o=[e],this.mode=this.BOARD_MODE_DRAG):o=this.initMoveObject(r[0],r[1],t,"mouse"),o.length>0){for(h=o[o.length-1],l=!1,i=0;i<this.touches.length;i++)if(this.touches[i].obj===h){s=i,n=this.touches[i].targets.push({num:t.pointerId,X:r[0],Y:r[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,l=!0;break}l||(n=0,s=this.touches.push({obj:h,targets:[{num:t.pointerId,X:r[0],Y:r[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),h.highlight(!0),this.saveStartPos(h,this.touches[s].targets[n]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(t.preventDefault(),t.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,f.isBrowser&&"touch"!==t.pointerType?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(t):(this._pointerAddBoardTouches(t),t.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(t)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||2!=t.touches.length||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(t))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[t]),!1},pointerMoveListener:function(t){var e,i,s;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(t.preventDefault(),t.stopPropagation()),f.isBrowser&&("touch"===t.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)s=this.getMousePosition(t),this._moveSelecting(s),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[t,this.mode]);else if(!this.mouseOriginMove(t))if(this.mode===this.BOARD_MODE_DRAG){for(e=0;e<this.touches.length;e++)for(i=0;i<this.touches[e].targets.length;i++)if(this.touches[e].targets[i].num===t.pointerId){1===this.touches[e].targets.length?(this.touches[e].targets[i].X=t.pageX,this.touches[e].targets[i].Y=t.pageY,s=this.getMousePosition(t),this.moveObject(s[0],s[1],this.touches[e],t,"touch")):2===this.touches[e].targets.length&&this.touches[e].targets[0].num>-1&&this.touches[e].targets[1].num>-1&&(this.touches[e].targets[i].X=t.pageX,this.touches[e].targets[i].Y=t.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[e].targets[0].X,clientY:this.touches[e].targets[0].Y}),this.getMousePosition({clientX:this.touches[e].targets[1].X,clientY:this.touches[e].targets[1].Y}),this.touches[e],t));break}}else"touch"==t.pointerType?(this._pointerAddBoardTouches(t),2==this._board_touches.length&&(t.touches=this._board_touches,this.gestureChangeListener(t))):(s=this.getMousePosition(t),this.highlightElements(s[0],s[1],t,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[t,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(t){var e,i,s;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),this.showInfobox(!1),t)for(e=0;e<this.touches.length;e++)for(i=0;i<this.touches[e].targets.length;i++)if(this.touches[e].targets[i].num===t.pointerId){this.touches[e].targets.splice(i,1),0===this.touches[e].targets.length&&this.touches.splice(e,1);break}if(this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[t]);else for(e=this.downObjects.length-1;e>-1;e--){for(s=!1,i=0;i<this.touches.length;i++)this.touches[i].obj.id===this.downObjects[e].id&&(s=!0);s||(this.downObjects[e].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),this.downObjects[e].snapToGrid(),this.downObjects[e].snapToPoints(),this.downObjects.splice(e,1))}return this._pointerRemoveBoardTouches(t),0===this._board_touches.length&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(i){var n,r,o,a,l,h,c,d,p,m=this.options.precision.touch,g=i[t.touchProperty];for(this.hasTouchEnd||(f.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&u.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,n=0;n<g.length;n++)g[n].jxg_isused=!1;for(n=0;n<this.touches.length;n++)for(a=0;a<this.touches[n].targets.length;a++){this.touches[n].targets[a].num=-1,m=this.options.precision.touch;do{for(l=0;l<g.length;l++)if(Math.abs(Math.pow(g[l].screenX-this.touches[n].targets[a].X,2)+Math.pow(g[l].screenY-this.touches[n].targets[a].Y,2))<m*m){this.touches[n].targets[a].num=l,this.touches[n].targets[a].X=g[l].screenX,this.touches[n].targets[a].Y=g[l].screenY,g[l].jxg_isused=!0;break}m*=2}while(-1===this.touches[n].targets[a].num&&m<this.options.precision.touchMax);-1===this.touches[n].targets[a].num&&(t.debug("i couldn't find a targettouches for target no "+a+" on "+this.touches[n].obj.name+" ("+this.touches[n].obj.id+"). Removed the target."),t.debug("eps = "+m+", touchMax = "+s.precision.touchMax),this.touches[n].targets.splice(n,1))}for(n=0;n<g.length;n++)if(!g[n].jxg_isused){if(r=this.getMousePosition(i,n),this.selectingMode)return this._startSelecting(r),this.triggerEventHandlers(["touchstartselecting","startselecting"],[i]),i.preventDefault(),i.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(0!==(o=this.initMoveObject(r[0],r[1],i,"touch")).length)if(u.isPoint(h=o[o.length-1])||h.elementClass===e.OBJECT_CLASS_TEXT||h.type===e.OBJECT_TYPE_TICKS||h.type===e.OBJECT_TYPE_IMAGE)this.saveStartPos(h,(d=[{num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}])[0]),this.touches.push({obj:h,targets:d}),h.highlight(!0);else if(h.elementClass===e.OBJECT_CLASS_LINE||h.elementClass===e.OBJECT_CLASS_CIRCLE||h.elementClass===e.OBJECT_CLASS_CURVE||h.type===e.OBJECT_TYPE_POLYGON){for(c=!1,a=0;a<this.touches.length;a++)h.id===this.touches[a].obj.id&&(c=!0,1===this.touches[a].targets.length&&(this.saveStartPos(h,p={num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}),this.touches[a].targets.push(p)),g[n].jxg_isused=!0);c||(this.saveStartPos(h,(d=[{num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}])[0]),this.touches.push({obj:h,targets:d}),h.highlight(!0))}g[n].jxg_isused=!0}return this.touches.length>0&&(i.preventDefault(),i.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(i)||2!=g.length||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(i)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[i]),!1},touchMoveListener:function(e){var i,s,n,r=e[t.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(e.preventDefault(),e.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(i=0;i<r.length;i++)if(!r[i].jxg_isused){s=this.getMousePosition(e,i),this._moveSelecting(s),this.triggerEventHandlers(["touchmoves","moveselecting"],[e,this.mode]);break}}else if(!this.touchOriginMove(e))if(this.mode===this.BOARD_MODE_DRAG){for(i=0;i<this.touches.length;i++)if(1===this.touches[i].targets.length){if(r[this.touches[i].targets[0].num]){if((s=this.getMousePosition(e,this.touches[i].targets[0].num))[0]<0||s[0]>this.canvasWidth||s[1]<0||s[1]>this.canvasHeight)return;this.touches[i].targets[0].X=r[this.touches[i].targets[0].num].screenX,this.touches[i].targets[0].Y=r[this.touches[i].targets[0].num].screenY,this.moveObject(s[0],s[1],this.touches[i],e,"touch")}}else if(2===this.touches[i].targets.length&&this.touches[i].targets[0].num>-1&&this.touches[i].targets[1].num>-1&&r[this.touches[i].targets[0].num]&&r[this.touches[i].targets[1].num]){if(s=this.getMousePosition(e,this.touches[i].targets[0].num),n=this.getMousePosition(e,this.touches[i].targets[1].num),s[0]<0||s[0]>this.canvasWidth||s[1]<0||s[1]>this.canvasHeight||n[0]<0||n[0]>this.canvasWidth||n[1]<0||n[1]>this.canvasHeight)return;this.touches[i].targets[0].X=r[this.touches[i].targets[0].num].screenX,this.touches[i].targets[0].Y=r[this.touches[i].targets[0].num].screenY,this.touches[i].targets[1].X=r[this.touches[i].targets[1].num].screenX,this.touches[i].targets[1].Y=r[this.touches[i].targets[1].num].screenY,this.twoFingerMove(s,n,this.touches[i],e)}}else 2==r.length&&this.gestureChangeListener(e);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[e,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(i){var s,n,r,o,a,l=this.options.precision.touch,h=[],c=i&&i[t.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[i]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(i),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[i]);else if(c&&c.length>0){for(s=0;s<this.touches.length;s++)h[s]=this.touches[s];for(this.touches.length=0,s=0;s<c.length;s++)c[s].jxg_isused=!1;for(s=0;s<h.length;s++){for(o=!1,a=0,n=0;n<h[s].targets.length;n++)for(h[s].targets[n].found=!1,r=0;r<c.length;r++)if(Math.abs(Math.pow(c[r].screenX-h[s].targets[n].X,2)+Math.pow(c[r].screenY-h[s].targets[n].Y,2))<l*l){h[s].targets[n].found=!0,h[s].targets[n].num=r,h[s].targets[n].X=c[r].screenX,h[s].targets[n].Y=c[r].screenY,a+=1;break}if(u.isPoint(h[s].obj)?o=h[s].targets[0]&&h[s].targets[0].found:h[s].obj.elementClass===e.OBJECT_CLASS_LINE?o=h[s].targets[0]&&h[s].targets[0].found||h[s].targets[1]&&h[s].targets[1].found:h[s].obj.elementClass===e.OBJECT_CLASS_CIRCLE&&(o=1===a||3===a),o)for(this.touches.push({obj:h[s].obj,targets:[]}),n=0;n<h[s].targets.length;n++)h[s].targets[n].found&&this.touches[this.touches.length-1].targets.push({num:h[s].targets[n].num,X:h[s].targets[n].screenX,Y:h[s].targets[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:h[s].targets[n].Xstart,Ystart:h[s].targets[n].Ystart,Zstart:h[s].targets[n].Zstart});else h[s].obj.noHighlight()}}else this.touches.length=0;for(s=this.downObjects.length-1;s>-1;s--){for(o=!1,n=0;n<this.touches.length;n++)this.touches[n].obj.id===this.downObjects[s].id&&(o=!0);o||(this.downObjects[s].triggerEventHandlers(["touchup","up"],[i]),this.downObjects[s].snapToGrid(),this.downObjects[s].snapToPoints(),this.downObjects.splice(s,1))}return c&&0!==c.length||(this.hasTouchEnd&&(f.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(t){var e,i,s;if(this.document.selection&&u.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return f.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,e=this.getMousePosition(t),this._testForSelection(t),this.selectingMode?(this._startSelecting(e),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[t])):(0===(i=this.initMoveObject(e[0],e[1],t,"mouse")).length?(this.mode=this.BOARD_MODE_NONE,s=!0):(this.mouse={obj:null,targets:[{X:e[0],Y:e[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=i[i.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(s=this.mouseOriginMoveStart(t)),this.triggerEventHandlers(["mousedown","down"],[t]),s)},mouseMoveListener:function(t){var e;e=this.getMousePosition(t),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(e),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[t,this.mode])):this.mouseOriginMove(t)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(e[0],e[1],this.mouse,t,"mouse"):this.highlightElements(e[0],e[1],t,-1),this.triggerEventHandlers(["mousemove","move"],[t,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(t){var e;if(!1===this.selectingMode&&this.triggerEventHandlers(["mouseup","up"],[t]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[t]);else for(e=0;e<this.downObjects.length;e++)this.downObjects[e].triggerEventHandlers(["mouseup","up"],[t]);this.downObjects.length=0,this.hasMouseUp&&(f.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(t){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(t,"zoom"))return!0;var s=(t=t||window.event).detail?-t.detail:t.wheelDelta/40,n=new i(e.COORDS_BY_SCREEN,this.getMousePosition(t),this);return s>0?this.zoomIn(n.usrCoords[1],n.usrCoords[2]):this.zoomOut(n.usrCoords[1],n.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[t]),t.preventDefault(),!1},initInfobox:function(){var t=u.copyAttributes({},this.options,"infobox");return t.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],t),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(t){var e,i,s,n,r;return u.evaluate(t.visProp.showinfobox)?(u.isPoint(t)&&(s=t.coords.usrCoords[1],n=t.coords.usrCoords[2],r=u.evaluate(t.visProp.infoboxdigits),this.infobox.setCoords(s+this.infobox.distanceX/this.unitX,n+this.infobox.distanceY/this.unitY),"string"!=typeof t.infoboxText?("auto"===r?(e=u.autoDigits(s),i=u.autoDigits(n)):u.isNumber(r)?(e=u.toFixed(s,r),i=u.toFixed(n,r)):(e=s,i=n),this.highlightInfobox(e,i,t)):this.highlightCustomInfobox(t.infoboxText,t),this.showInfobox(!0)),this):this},showInfobox:function(t){return this.infobox.hiddenByParent==t&&(this.infobox.hiddenByParent=!t,this.infobox.prepareUpdate().updateVisibility(t).updateRenderer()),this},highlightInfobox:function(t,e,i){return this.highlightCustomInfobox("("+t+", "+e+")",i),this},highlightCustomInfobox:function(t,e){return this.infobox.setText(t),this},dehighlightAll:function(){var t,e=!1;for(t in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(t)&&((this.hasMouseHandlers||this.hasPointerHandlers)&&this.highlightedObjects[t].noHighlight(),e=!0);return this.highlightedObjects={},"canvas"===this.renderer.type&&e&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(t,e){return[t,e]},getUsrCoordsOfMouse:function(t){var s=this.getCoordsTopLeftCorner(),n=f.getPosition(t,null,this.document);return new i(e.COORDS_BY_SCREEN,[n[0]-s[0],n[1]-s[1]],this).usrCoords.slice(1)},getAllUnderMouse:function(t){var e=this.getAllObjectsUnderMouse(t);return e.push(this.getUsrCoordsOfMouse(t)),e},getAllObjectsUnderMouse:function(t){var e,i,s=this.getCoordsTopLeftCorner(),n=f.getPosition(t,null,this.document),r=n[0]-s[0],o=n[1]-s[1],a=[],l=this.objectsList.length;for(e=0;e<l;e++)(i=this.objectsList[e]).visPropCalc.visible&&i.hasPoint&&i.hasPoint(r,o)&&(a[a.length]=i);return a},updateCoords:function(){var t,e,i=this.objectsList.length;for(e=0;e<i;e++)u.exists((t=this.objectsList[e]).coords)&&(u.evaluate(t.visProp.frozen)?t.coords.screen2usr():t.coords.usr2screen());return this},moveOrigin:function(t,e,i){return u.exists(t)&&u.exists(e)&&(this.origin.scrCoords[1]=t,this.origin.scrCoords[2]=e,i&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(i){var s,n,r,o,a,l,h,c=[],p=i.indexOf("<data>"),f=i.indexOf("</data>"),m=function(t,i,s,n){return function(){var r,o;o=(r=t.select(i.id)).coords.usrCoords[n],r.setPositionDirectly(e.COORDS_BY_USER,2===n?[s(),o]:[o,s()]),r.prepareUpdate().update()}},g=function(t,e,i,s){return function(){var n,r;n=t.select(e.id),r=i(),"strokewidth"===s?n.visProp.strokewidth=r:(r=d.rgba2rgbo(r),n.visProp[s+"color"]=r[0],n.visProp[s+"opacity"]=r[1])}};if(!(p<0)){for(;p>=0;){if(n=(s=i.slice(p+6,f)).indexOf("="),r=s.slice(0,n),o=s.slice(n+1),n=r.indexOf("."),a=r.slice(0,n),l=this.elementsByName[u.unescapeHTML(a)],h=r.slice(n+1).replace(/\s+/g,"").toLowerCase(),o=u.createFunction(o,this,"",!0),u.exists(this.elementsByName[a]))switch(h){case"x":c.push(m(this,l,o,2));break;case"y":c.push(m(this,l,o,1));break;case"visible":c.push(function(t,e,i){return function(){var s,n;s=t.select(e.id),n=i(),s.setAttribute({visible:n})}}(this,l,o));break;case"position":c.push(function(t,e,i){return function(){t.select(e.id).position=i()}}(this,l,o));break;case"stroke":c.push(g(this,l,o,"stroke"));break;case"style":c.push(function(t,e,i){return function(){t.select(e.id).setStyle(i())}}(this,l,o));break;case"strokewidth":c.push(g(this,l,o,"strokewidth"));break;case"fill":c.push(g(this,l,o,"fill"));break;case"label":break;default:t.debug("property '"+h+"' in conditions not yet implemented:"+o)}else t.debug("debug conditions: |"+a+"| undefined");p=(i=i.slice(f+7)).indexOf("<data>"),f=i.indexOf("</data>")}this.updateConditions=function(){var t;for(t=0;t<c.length;t++)c[t]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var t=new i(e.COORDS_BY_USER,[0,0],this),s=new i(e.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),n=t.scrCoords[1]-s.scrCoords[1],r=t.scrCoords[2]-s.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(n)>25;)this.options.grid.snapSizeX*=2,n/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(r)>25;)this.options.grid.snapSizeY*=2,r/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(t,e){var i=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,r=(i[2]-i[0])*(1-1/s),o=(i[1]-i[3])*(1-1/n),a=.5,l=.5,h=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&s>1||this.zoomY>this.attr.zoom.max&&n>1||this.zoomX<h&&s<1||this.zoomY<h&&n<1?this:(u.isNumber(t)&&u.isNumber(e)&&(a=(t-i[0])/(i[2]-i[0]),l=(i[1]-e)/(i[1]-i[3])),this.setBoundingBox([i[0]+r*a,i[1]-o*l,i[2]-r*(1-a),i[3]+o*(1-l)],!1),this.zoomX*=s,this.zoomY*=n,this.applyZoom())},zoomOut:function(t,e){var i=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,r=(i[2]-i[0])*(1-s),o=(i[1]-i[3])*(1-n),a=.5,l=.5,h=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<h||this.zoomY<h?this:(u.isNumber(t)&&u.isNumber(e)&&(a=(t-i[0])/(i[2]-i[0]),l=(i[1]-e)/(i[1]-i[3])),this.setBoundingBox([i[0]+r*a,i[1]-o*l,i[2]-r*(1-a),i[3]+o*(1-l)],!1),this.zoomX/=s,this.zoomY/=n,this.applyZoom())},zoom100:function(){var t=this.getBoundingBox(),e=(t[2]-t[0])*(1-this.zoomX)*.5,i=(t[1]-t[3])*(1-this.zoomY)*.5;return this.setBoundingBox([t[0]+e,t[1]-i,t[2]-e,t[3]+i],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var t,e,i,s,n=0,r=0,o=0,a=0,l=this.objectsList.length;for(t=0;t<l;t++)u.isPoint(s=this.objectsList[t])&&s.visPropCalc.visible&&(s.coords.usrCoords[1]<n?n=s.coords.usrCoords[1]:s.coords.usrCoords[1]>r&&(r=s.coords.usrCoords[1]),s.coords.usrCoords[2]>a?a=s.coords.usrCoords[2]:s.coords.usrCoords[2]<o&&(o=s.coords.usrCoords[2]));return e=50/this.unitX,i=50/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([n-e,a+i,r+e,o-i],!0),this.applyZoom()},zoomElements:function(t){var e,i,s,n=[0,0,0,0],r=[1,-1,-1,1];if(!u.isArray(t)||0===t.length)return this;for(e=0;e<t.length;e++)if(s=this.select(t[e]).bounds(),u.isArray(s))if(u.isArray(n))for(i=0;i<4;i++)r[i]*s[i]<r[i]*n[i]&&(n[i]=s[i]);else n=s;if(u.isArray(n)){for(i=0;i<4;i++)n[i]-=r[i];this.zoomX=1,this.zoomY=1,this.setBoundingBox(n,!0)}return this},setZoom:function(t,e){var i=this.attr.zoom.factorx,s=this.attr.zoom.factory;return this.attr.zoom.factorx=t/this.zoomX,this.attr.zoom.factory=e/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=i,this.attr.zoom.factory=s,this},removeObject:function(i){var s,n;if(u.isArray(i)){for(n=0;n<i.length;n++)this.removeObject(i[n]);return this}if(i=this.select(i),!u.exists(i)||u.isString(i))return this;try{for(s in i.childElements)i.childElements.hasOwnProperty(s)&&i.childElements[s].board.removeObject(i.childElements[s]);for(s in i.objects)i.objects.hasOwnProperty(s)&&i.objects[s].board.removeObject(i.objects[s]);for(s in this.objects)this.objects.hasOwnProperty(s)&&u.exists(this.objects[s].childElements)&&(delete this.objects[s].childElements[i.id],delete this.objects[s].descendants[i.id]);if(i._pos>-1)for(this.objectsList.splice(i._pos,1),s=i._pos;s<this.objectsList.length;s++)this.objectsList[s]._pos--;else i.type!==e.OBJECT_TYPE_TURTLE&&t.debug("Board.removeObject: object "+i.id+" not found in list.");delete this.objects[i.id],delete this.elementsByName[i.name],i.visProp&&u.evaluate(i.visProp.trace)&&i.clearTrace(),u.exists(i.remove)&&i.remove()}catch(e){t.debug(i.id+": Could not be removed: "+e)}return this.update(),this},removeAncestors:function(t){var e;for(e in t.ancestors)t.ancestors.hasOwnProperty(e)&&this.removeAncestors(t.ancestors[e]);return this.removeObject(t),this},initGeonextBoard:function(){var t,e,i;return t=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),e=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),i=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[t,e],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[t,i],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(t,e,i,s){var n;return s||(n=this.getBoundingBox()),this.canvasWidth=parseInt(t,10),this.canvasHeight=parseInt(e,10),i||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),s||this.setBoundingBox(n,this.keepaspectratio),this},showDependencies:function(){var t,e,i,s,n;for(t in e="<p>\n",this.objects)if(this.objects.hasOwnProperty(t)){for(i in n=0,this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(i)&&(n+=1);for(i in n>=0&&(e+="<strong>"+this.objects[t].id+":</strong> "),this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(i)&&(e+=this.objects[t].childElements[i].id+"("+this.objects[t].childElements[i].name+"), ");e+="<p>\n"}return e+="</p>\n",(s=window.open()).document.open(),s.document.write(e),s.document.close(),this},showXML:function(){var t=window.open("");return t.document.open(),t.document.write("<pre>"+u.escapeHTML(this.xmlString)+"</pre>"),t.document.close(),this},prepareUpdate:function(){var t,e,i=this.objectsList.length;for(t=0;t<i;t++)(e=this.objectsList[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate;for(t in this.groups)this.groups.hasOwnProperty(t)&&((e=this.groups[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(t){var e,i;for(t=this.select(t),e=0;e<this.objectsList.length;e++)(i=this.objectsList[e]).update(!u.exists(t)||i.id!==t.id).updateVisibility();for(e in this.groups)this.groups.hasOwnProperty(e)&&this.groups[e].update(t);return this},updateRenderer:function(){var t,e=this.objectsList.length;if("canvas"===this.renderer.type)this.updateRendererCanvas();else for(t=0;t<e;t++)this.objectsList[t].updateRenderer();return this},updateRendererCanvas:function(){var t,e,i,s,n,r=this.objectsList.length,o=this.options.layer,a=this.options.layer.numlayers,l=Number.NEGATIVE_INFINITY;for(i=0;i<a;i++){for(n in s=Number.POSITIVE_INFINITY,o)o.hasOwnProperty(n)&&o[n]>l&&o[n]<s&&(s=o[n]);for(l=s,t=0;t<r;t++)(e=this.objectsList[t]).visProp.layer===s&&e.prepareUpdate().updateRenderer()}return this},addHook:function(e,i,s){return t.deprecated("Board.addHook()","Board.on()"),i=u.def(i,"update"),s=u.def(s,this),this.hooks.push([i,e]),this.on(i,e,s),this.hooks.length-1},addEvent:t.shortcut(t.Board.prototype,"on"),removeHook:function(e){return t.deprecated("Board.removeHook()","Board.off()"),this.hooks[e]&&(this.off(this.hooks[e][0],this.hooks[e][1]),this.hooks[e]=null),this},removeEvent:t.shortcut(t.Board.prototype,"off"),updateHooks:function(e){var i=Array.prototype.slice.call(arguments,0);return t.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),i[0]=u.def(i[0],"update"),this.triggerEventHandlers([i[0]],arguments),this},addChild:function(t){return u.exists(t)&&u.exists(t.containerObj)&&(this.dependentBoards.push(t),this.update()),this},removeChild:function(t){var e;for(e=this.dependentBoards.length-1;e>=0;e--)this.dependentBoards[e]===t&&this.dependentBoards.splice(e,1);return this},update:function(t){var e,i,s,n;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,"all"===this.attr.minimizereflow&&this.containerObj&&"vml"!==this.renderer.type&&(n=this.renderer.removeToInsertLater(this.containerObj)),"svg"===this.attr.minimizereflow&&"svg"===this.renderer.type&&(n=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(t).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),n&&n(),i=this.dependentBoards.length,e=0;e<i;e++)u.exists(s=this.dependentBoards[e])&&s!==this&&(s.updateQuality=this.updateQuality,s.prepareUpdate().updateElements().updateConditions(),s.renderer.suspendRedraw(),s.updateRenderer(),s.renderer.unsuspendRedraw(),s.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var t;for(t=0;t<this.grids.length;t++)this.removeObject(this.grids[t]);return this.grids.length=0,this.update(),this},create:function(e,i,s){var n,r;for(e=e.toLowerCase(),u.exists(i)||(i=[]),u.exists(s)||(s={}),r=0;r<i.length;r++)u.isString(i[r])&&("text"!==e||2!==r)&&("input"!==e&&"checkbox"!==e&&"button"!==e||2!==r&&3!==r)&&(i[r]=this.select(i[r]));if(!u.isFunction(t.elements[e]))throw new Error("JSXGraph: create: Unknown element type given: "+e);return n=t.elements[e](this,i,s),u.exists(n)?(n.prepareUpdate&&n.update&&n.updateRenderer&&n.fullUpdate(),n):(t.debug("JSXGraph: create: failure creating "+e),n)},createElement:function(){return t.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var t;for(t=0;t<this.objectsList.length;t++)this.objectsList[t].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(t,e){var i,s,n=f.getDimensions(this.container,this.document);return u.isArray(t)?(this.plainBB=t,this.canvasWidth=parseInt(n.width,10),this.canvasHeight=parseInt(n.height,10),s=this.canvasWidth,i=this.canvasHeight,e?(this.unitX=s/(t[2]-t[0]),this.unitY=i/(t[1]-t[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=s/(t[2]-t[0]),this.unitY=i/(t[1]-t[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*t[0],this.unitY*t[1]),this):this},getBoundingBox:function(){var t=new i(e.COORDS_BY_SCREEN,[0,0],this),s=new i(e.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[t.usrCoords[1],t.usrCoords[2],s.usrCoords[1],s.usrCoords[2]]},addAnimation:function(t){var e=this;return this.animationObjects[t.id]=t,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval((function(){e.animate()}),t.board.attr.animationdelay)),this},stopAllAnimation:function(){var t;for(t in this.animationObjects)this.animationObjects.hasOwnProperty(t)&&u.exists(this.animationObjects[t])&&(this.animationObjects[t]=null,delete this.animationObjects[t]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var t,i,s,n,r,o,a,l,h=0,c=null;for(i in this.animationObjects)if(this.animationObjects.hasOwnProperty(i)&&u.exists(this.animationObjects[i])){if(h+=1,(s=this.animationObjects[i]).animationPath&&(n=u.isFunction(s.animationPath)?s.animationPath((new Date).getTime()-s.animationStart):s.animationPath.pop(),!u.exists(n)||!u.isArray(n)&&isNaN(n)?delete s.animationPath:(s.setPositionDirectly(e.COORDS_BY_USER,n),s.fullUpdate(),c=s)),s.animationData){for(r in a=0,s.animationData)s.animationData.hasOwnProperty(r)&&(o=s.animationData[r].pop(),u.exists(o)?(a+=1,(t={})[r]=o,s.setAttribute(t)):delete s.animationData[o]);0===a&&delete s.animationData}u.exists(s.animationData)||u.exists(s.animationPath)||(this.animationObjects[i]=null,delete this.animationObjects[i],u.exists(s.animationCallback)&&(l=s.animationCallback,s.animationCallback=null,l()))}return 0===h?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(c),this},migratePoint:function(t,e,i){var s,n,r,o,a,l,h=!1;for(n in t=this.select(t),e=this.select(e),u.exists(t.label)&&(l=t.label.id,h=!0,this.removeObject(t.label)),t.childElements)if(t.childElements.hasOwnProperty(n)){for(r in o=!1,s=t.childElements[n])s.hasOwnProperty(r)&&s[r]===t&&(s[r]=e,o=!0);for(o&&delete t.childElements[n],a=0;a<s.parents.length;a++)s.parents[a]===t.id&&(s.parents[a]=e.id);e.addChild(s)}return i&&(h&&(delete e.childElements[l],delete e.descendants[l]),e.label&&this.removeObject(e.label),delete this.elementsByName[e.name],e.name=t.name,h&&e.createLabel()),this.removeObject(t),u.exists(e.name)&&""!==e.name&&(this.elementsByName[e.name]=e),this.fullUpdate(),this},emulateColorblindness:function(e){var i,s;if(u.exists(e)||(e="none"),this.currentCBDef===e)return this;for(i in this.objects)this.objects.hasOwnProperty(i)&&(s=this.objects[i],"none"!==e?("none"===this.currentCBDef&&(s.visPropOriginal={strokecolor:s.visProp.strokecolor,fillcolor:s.visProp.fillcolor,highlightstrokecolor:s.visProp.highlightstrokecolor,highlightfillcolor:s.visProp.highlightfillcolor}),s.setAttribute({strokecolor:d.rgb2cb(u.evaluate(s.visPropOriginal.strokecolor),e),fillcolor:d.rgb2cb(u.evaluate(s.visPropOriginal.fillcolor),e),highlightstrokecolor:d.rgb2cb(u.evaluate(s.visPropOriginal.highlightstrokecolor),e),highlightfillcolor:d.rgb2cb(u.evaluate(s.visPropOriginal.highlightfillcolor),e)})):u.exists(s.visPropOriginal)&&t.extend(s.visProp,s.visPropOriginal));return this.currentCBDef=e,this.update(),this},select:function(t){var e,i,s,n,r=t;if(null===r)return r;if(u.isString(r)&&""!==r)u.exists(this.objects[r])?r=this.objects[r]:u.exists(this.elementsByName[r])?r=this.elementsByName[r]:u.exists(this.groups[r])&&(r=this.groups[r]);else if(u.isFunction(r)||u.isObject(r)&&!u.isFunction(r.setAttribute)){for(i={},n=(e=u.filterElements(this.objectsList,r)).length,s=0;s<n;s++)i[e[s].id]=e[s];r=new C(i)}else u.isObject(r)&&u.exists(r.id)&&!u.exists(this.objects[r.id])&&(r=null);return r},hasPoint:function(t,e){var i=t,s=e,n=this.getBoundingBox();return u.exists(t)&&u.isArray(t.usrCoords)&&(i=t.usrCoords[1],s=t.usrCoords[2]),!!(u.isNumber(i)&&u.isNumber(s)&&n[0]<i&&i<n[2]&&n[1]>s&&s>n[3])},updateCSSTransforms:function(){var t=this.containerObj,e=t,i=t;for(this.cssTransMat=f.getCSSTransformMatrix(e),e=e.offsetParent;e;){for(this.cssTransMat=r.matMatMult(f.getCSSTransformMatrix(e),this.cssTransMat),i=i.parentNode;i!==e;)this.cssTransMat=r.matMatMult(f.getCSSTransformMatrix(e),this.cssTransMat),i=i.parentNode;e=e.offsetParent}return this.cssTransMat=r.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(t){this.isSelecting=!0,this.selectingBox=[[t[0],t[1]],[t[0],t[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(t){this.isSelecting&&(this.selectingBox[1]=[t[0],t[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(t){var e=this.getMousePosition(t);this.isSelecting=!1,this.selectingBox[1]=[e[0],e[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var e=this.selectingBox[0],i=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],e[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],i[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(t.COORDS_BY_SCREEN,[i[0],i[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(t.COORDS_BY_SCREEN,[i[0],e[1]])},_testForSelection:function(t){this._isRequiredKeyPressed(t,"selection")&&(u.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(t){var e;return u.exists(this.selectionPolygon)||!0===(e=u.copyAttributes(t,s,"board","selection")).enabled&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],e)),this},__evt__down:function(t){},__evt__mousedown:function(t){},__evt__pointerdown:function(t){},__evt__touchstart:function(t){},__evt__up:function(t){},__evt__mouseup:function(t){},__evt__pointerup:function(t){},__evt__touchend:function(t){},__evt__move:function(t,e){},__evt__mousemove:function(t,e){},__evt__pointermove:function(t,e){},__evt__touchmove:function(t,e){},__evt__hit:function(t,e,i){},__evt__mousehit:function(t,e,i){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(t,e,i,s,r,o,l){var h=this;return new function(){var c,d=0,u=0,p=0,f=i,m=n.root((function(i){var s=t.X(f),n=t.Y(f),r=e.X(i),o=e.Y(i);return(s-r)*(s-r)+(n-o)*(n-o)}),[0,2*Math.PI]),g=0,b=0,y=h.create("transform",[function(){return d}],{type:"rotate"}),v=h.create("transform",[function(){return d},function(){return t.X(f)},function(){return t.Y(f)}],{type:"rotate"}),C=h.create("transform",[function(){return u},function(){return p}],{type:"translate"}),x=function(t,e,i){var s=n.D(t.X)(e),r=n.D(t.Y)(e),o=n.D(t.X)(i),a=n.D(t.Y)(i),l=n.D(t.X)(.5*(e+i)),h=n.D(t.Y)(.5*(e+i)),c=Math.sqrt(s*s+r*r),d=Math.sqrt(o*o+a*a);return(c+4*Math.sqrt(l*l+h*h)+d)*(i-e)/6},_=function(t){return c-x(e,m,t)},P=Math.PI/18,S=9*P,w=null;return this.rolling=function(){var i,o,w,E,k;c=x(t,f,g=f+r*s),b=n.root(_,m),i=new a(t.X(g),t.Y(g)),o=new a(e.X(b),e.Y(b)),w=new a(n.D(t.X)(g),n.D(t.Y)(g)),E=new a(n.D(e.X)(b),n.D(e.Y)(b)),k=a.C.div(w,E),d=Math.atan2(k.imaginary,k.real),k.div(a.C.abs(k)),k.mult(o),u=i.real-k.real,p=i.imaginary-k.imaginary,d<-P&&d>-S?(d=-P,v.applyOnce(l)):d>P&&d<S?(d=P,v.applyOnce(l)):(y.applyOnce(l),C.applyOnce(l),f=g,m=b),h.update()},this.start=function(){return o>0&&(w=window.setInterval(this.rolling,o)),this},this.stop=function(){return window.clearInterval(w),this},this}}}),t.Board})),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.SVGRenderer=function(t,i){var s;for(this.type="svg",this.isIE=-1!==navigator.appVersion.indexOf("MSIE")||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(i.width,i.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],s=0;s<e.layer.numlayers;s++)this.layer[s]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[s]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},t.SVGRenderer.prototype=new i,t.extend(t.SVGRenderer.prototype,{_createArrowHead:function(e,i){var s,r,o=e.id+"Triangle",a=null,l=n.evaluate(e.visProp.firstarrow),h=n.evaluate(e.visProp.lastarrow);return n.exists(i)&&(o+=i),(s=this.createPrim("marker",o)).setAttributeNS(null,"stroke",n.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",n.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"fill",n.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"fill-opacity",n.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",0),s.setAttributeNS(null,"orient","auto"),s.setAttributeNS(null,"markerUnits","strokeWidth"),r=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),"End"===i?(t.exists(l.type)&&(a=n.evaluate(l.type)),s.setAttributeNS(null,"refY",5),2===a?(s.setAttributeNS(null,"refX",4.9),r.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):3===a?(s.setAttributeNS(null,"refX",3.33),r.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(s.setAttributeNS(null,"refX",9.9),r.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(t.exists(h.type)&&(a=n.evaluate(h.type)),s.setAttributeNS(null,"refY",5),2===a?(s.setAttributeNS(null,"refX",5.1),r.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):3===a?(s.setAttributeNS(null,"refX",.1),r.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(s.setAttributeNS(null,"refX",.1),r.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),s.appendChild(r),s},_setArrowColor:function(t,e,i,s){t&&(n.isString(e)&&this._setAttribute((function(){t.setAttributeNS(null,"stroke",e),t.setAttributeNS(null,"fill",e),t.setAttributeNS(null,"stroke-opacity",i),t.setAttributeNS(null,"fill-opacity",i)}),s.visPropOld.fillcolor),this.isIE&&s.rendNode.parentNode.insertBefore(s.rendNode,s.rendNode))},_setArrowWidth:function(t,e,i,s){var n,r;t&&(0===e?t.setAttributeNS(null,"display","none"):(r=(n=e)*s,t.setAttributeNS(null,"viewBox","0 0 "+10*n+" "+10*n),t.setAttributeNS(null,"markerHeight",r),t.setAttributeNS(null,"markerWidth",r),t.setAttributeNS(null,"display","inherit")),this.isIE&&i.parentNode.insertBefore(i,i))},updateTicks:function(t){var e,i,s,r,o,a="",l=t.ticks.length;for(e=0;e<l;e++)o=(i=t.ticks[e])[1],n.isNumber((r=i[0])[0])&&n.isNumber(r[1])&&(a+="M "+r[0]+" "+o[0]+" L "+r[1]+" "+o[1]+" ");n.exists(s=t.rendNode)||(s=this.createPrim("path",t.id),this.appendChildPrim(s,n.evaluate(t.visProp.layer)),t.rendNode=s),s.setAttributeNS(null,"stroke",n.evaluate(t.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",n.evaluate(t.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",n.evaluate(t.visProp.strokewidth)),this.updatePathPrim(s,a,t.board)},displayCopyright:function(t,e){var i,s=this.createPrim("text","licenseText");s.setAttributeNS(null,"x","20px"),s.setAttributeNS(null,"y",2+e+"px"),s.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+e+"px; fill:#356AA0;  opacity:0.3;"),i=this.container.ownerDocument.createTextNode(t),s.appendChild(i),this.appendChildPrim(s,0)},drawInternalText:function(t){var e=this.createPrim("text",t.id);return e.style.whiteSpace="nowrap",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,n.evaluate(t.visProp.layer)),e},updateInternalText:function(t){var e,i=t.plaintext,s=t.getAnchorX(),r=t.getAnchorY();t.rendNode.getAttributeNS(null,"class")!==t.visProp.cssclass&&(t.rendNode.setAttributeNS(null,"class",n.evaluate(t.visProp.cssclass)),t.needsSizeUpdate=!0),isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])||(t.visPropOld.left!==s+(e=t.coords.scrCoords[1])&&(t.rendNode.setAttributeNS(null,"x",e+"px"),"left"===s?t.rendNode.setAttributeNS(null,"text-anchor","start"):"right"===s?t.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===s&&t.rendNode.setAttributeNS(null,"text-anchor","middle"),t.visPropOld.left=s+e),t.visPropOld.top!==r+(e=t.coords.scrCoords[2])&&(t.rendNode.setAttributeNS(null,"y",e+.5*this.vOffsetText+"px"),"bottom"===r?t.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):"top"===r?t.rendNode.setAttributeNS(null,"dy","1.6ex"):"middle"===r&&t.rendNode.setAttributeNS(null,"dy","0.6ex"),t.visPropOld.top=r+e)),t.htmlStr!==i&&(t.rendNodeText.data=i,t.htmlStr=i),this.transformImage(t,t.transformations)},updateInternalTextStyle:function(t,e,i,s){this.setObjectFillColor(t,e,i)},drawImage:function(t){var e=this.createPrim("image",t.id);e.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(e,n.evaluate(t.visProp.layer)),t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var i,s,n=t.rendNode,r="";e.length>0&&(i=[(s=this.joinTransforms(t,e))[1][1],s[2][1],s[1][2],s[2][2],s[1][0],s[2][0]].join(","),n.setAttributeNS(null,"transform",r+=" matrix("+i+") "))},updateImageURL:function(t){var e=n.evaluate(t.url);t.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",e)},updateImageStyle:function(t,e){var i=n.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass);t.rendNode.setAttributeNS(null,"class",i)},appendChildPrim:function(t,i){return n.exists(i)?i>=e.layer.numlayers&&(i=e.layer.numlayers-1):i=0,this.layer[i].appendChild(t),t},createPrim:function(t,e){var i=this.container.ownerDocument.createElementNS(this.svgNamespace,t);return i.setAttributeNS(null,"id",this.container.id+"_"+e),i.style.position="absolute","path"===t&&(i.setAttributeNS(null,"stroke-linecap","round"),i.setAttributeNS(null,"stroke-linejoin","round")),i},remove:function(t){n.exists(t)&&n.exists(t.parentNode)&&t.parentNode.removeChild(t)},makeArrows:function(t){var e,i=n.evaluate(t.visProp.firstarrow),s=n.evaluate(t.visProp.lastarrow);t.visPropOld.firstarrow!==i||t.visPropOld.lastarrow!==s?(i?n.exists(e=t.rendNodeTriangleStart)?this.defs.appendChild(e):(e=this._createArrowHead(t,"End"),this.defs.appendChild(e),t.rendNodeTriangleStart=e,t.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+t.id+"TriangleEnd)")):n.exists(e=t.rendNodeTriangleStart)&&this.remove(e),s?n.exists(e=t.rendNodeTriangleEnd)?this.defs.appendChild(e):(e=this._createArrowHead(t,"Start"),this.defs.appendChild(e),t.rendNodeTriangleEnd=e,t.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+t.id+"TriangleStart)")):n.exists(e=t.rendNodeTriangleEnd)&&this.remove(e),t.visPropOld.firstarrow=i,t.visPropOld.lastarrow=s):this.isIE&&t.visPropCalc.visible&&(i||s)&&t.rendNode.parentNode.insertBefore(t.rendNode,t.rendNode)},updateEllipsePrim:function(t,e,i,s,n){var r;r=2e5,e=Math.abs(e)<r?e:r*e/Math.abs(e),i=Math.abs(i)<r?i:r*i/Math.abs(i),s=Math.abs(s)<r?s:r*s/Math.abs(s),n=Math.abs(n)<r?n:r*n/Math.abs(n),t.setAttributeNS(null,"cx",e),t.setAttributeNS(null,"cy",i),t.setAttributeNS(null,"rx",Math.abs(s)),t.setAttributeNS(null,"ry",Math.abs(n))},updateLinePrim:function(t,e,i,s,n){var r;r=2e5,isNaN(e+i+s+n)||(e=Math.abs(e)<r?e:r*e/Math.abs(e),i=Math.abs(i)<r?i:r*i/Math.abs(i),s=Math.abs(s)<r?s:r*s/Math.abs(s),n=Math.abs(n)<r?n:r*n/Math.abs(n),t.setAttributeNS(null,"x1",e),t.setAttributeNS(null,"y1",i),t.setAttributeNS(null,"x2",s),t.setAttributeNS(null,"y2",n))},updatePathPrim:function(t,e){""===e&&(e="M 0 0"),t.setAttributeNS(null,"d",e)},updatePathStringPoint:function(t,e,i){var s="",n=t.coords.scrCoords,r=e*Math.sqrt(3)*.5,o=.5*e;return"x"===i?s=" M "+(n[1]-e)+" "+(n[2]-e)+" L "+(n[1]+e)+" "+(n[2]+e)+" M "+(n[1]+e)+" "+(n[2]-e)+" L "+(n[1]-e)+" "+(n[2]+e):"+"===i?s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+e)+" "+n[2]+" M "+n[1]+" "+(n[2]-e)+" L "+n[1]+" "+(n[2]+e):"<>"===i?s=" M "+(n[1]-e)+" "+n[2]+" L "+n[1]+" "+(n[2]+e)+" L "+(n[1]+e)+" "+n[2]+" L "+n[1]+" "+(n[2]-e)+" Z ":"^"===i?s=" M "+n[1]+" "+(n[2]-e)+" L "+(n[1]-r)+" "+(n[2]+o)+" L "+(n[1]+r)+" "+(n[2]+o)+" Z ":"v"===i?s=" M "+n[1]+" "+(n[2]+e)+" L "+(n[1]-r)+" "+(n[2]-o)+" L "+(n[1]+r)+" "+(n[2]-o)+" Z ":">"===i?s=" M "+(n[1]+e)+" "+n[2]+" L "+(n[1]-o)+" "+(n[2]-r)+" L "+(n[1]-o)+" "+(n[2]+r)+" Z ":"<"===i&&(s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+o)+" "+(n[2]-r)+" L "+(n[1]+o)+" "+(n[2]+r)+" Z "),s},updatePathStringPrim:function(t){var e,i,s,n=" M ",r="";if(t.numberPoints<=0)return"";if(s=Math.min(t.points.length,t.numberPoints),1===t.bezierDegree)for(e=0;e<s;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?n=" M ":(i[1]=Math.max(Math.min(i[1],5e3),-5e3),i[2]=Math.max(Math.min(i[2],5e3),-5e3),r+=n+i[1]+" "+i[2],n=" L ");else if(3===t.bezierDegree)for(e=0;e<s;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?n=" M ":(r+=n+i[1]+" "+i[2]," C "===n&&(r+=" "+(i=t.points[e+=1].scrCoords)[1]+" "+i[2],r+=" "+(i=t.points[e+=1].scrCoords)[1]+" "+i[2]),n=" C "),e+=1;return r},updatePathStringBezierPrim:function(t){var e,i,s,r,o,a,h,c=" M ",d="",u=n.evaluate(t.visProp.strokewidth),p="plot"!==n.evaluate(t.visProp.curvetype);if(t.numberPoints<=0)return"";for(p&&t.board.options.curve.RDPsmoothing&&(t.points=l.RamerDouglasPeucker(t.points,.5)),h=Math.min(t.points.length,t.numberPoints),i=1;i<3;i++)for(c=" M ",e=0;e<h;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?c=" M ":(r[1]=Math.max(Math.min(r[1],5e3),-5e3),r[2]=Math.max(Math.min(r[2],5e3),-5e3),d+=" M "===c?c+r[1]+" "+r[2]:[c,o+.333*(r[1]-o)+u*((s=2*i)*Math.random()-i)," ",a+.333*(r[2]-a)+u*(s*Math.random()-i)," ",o+.666*(r[1]-o)+u*(s*Math.random()-i)," ",a+.666*(r[2]-a)+u*(s*Math.random()-i)," ",r[1]," ",r[2]].join(""),c=" C ",o=r[1],a=r[2]);return d},updatePolygonPrim:function(t,e){var i,s,n="",r=e.vertices.length;for(t.setAttributeNS(null,"stroke","none"),i=0;i<r-1;i++){if(!e.vertices[i].isReal)return void t.setAttributeNS(null,"points","");n=n+(s=e.vertices[i].coords.scrCoords)[1]+","+s[2],i<r-2&&(n+=" ")}-1===n.indexOf("NaN")&&t.setAttributeNS(null,"points",n)},updateRectPrim:function(t,e,i,s,n){t.setAttributeNS(null,"x",e),t.setAttributeNS(null,"y",i),t.setAttributeNS(null,"width",s),t.setAttributeNS(null,"height",n)},setPropertyPrim:function(t,e,i){"stroked"!==e&&t.setAttributeNS(null,e,i)},display:function(t,e){var i;t&&t.rendNode&&(t.visPropOld.visible=e,i=t.rendNode,e?(i.setAttributeNS(null,"display","inline"),i.style.visibility="inherit"):(i.setAttributeNS(null,"display","none"),i.style.visibility="hidden"))},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(e,!0)},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(e,!1)},setBuffering:function(t,e){t.rendNode.setAttribute("buffered-rendering",e)},setDashStyle:function(t){var e=n.evaluate(t.visProp.dash),i=t.rendNode;e>0?i.setAttributeNS(null,"stroke-dasharray",this.dashArray[e-1]):i.hasAttributeNS(null,"stroke-dasharray")&&i.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(t){var e,i,s,r,o,a=t.rendNode,l=n.evaluate(t.visProp.gradient);i=(i=n.evaluate(t.visProp.fillopacity))>0?i:0,e=n.evaluate(t.visProp.fillcolor),"linear"===l?((s=this.createPrim("linearGradient",t.id+"_gradient")).setAttributeNS(null,"x1","0%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y1","0%"),s.setAttributeNS(null,"y2","0%"),(r=this.createPrim("stop",t.id+"_gradient1")).setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),(o=this.createPrim("stop",t.id+"_gradient2")).setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),s.appendChild(r),s.appendChild(o),this.defs.appendChild(s),a.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+t.id+"_gradient)"),t.gradNode1=r,t.gradNode2=o):"radial"===l?((s=this.createPrim("radialGradient",t.id+"_gradient")).setAttributeNS(null,"cx","50%"),s.setAttributeNS(null,"cy","50%"),s.setAttributeNS(null,"r","50%"),s.setAttributeNS(null,"fx",100*n.evaluate(t.visProp.gradientpositionx)+"%"),s.setAttributeNS(null,"fy",100*n.evaluate(t.visProp.gradientpositiony)+"%"),(r=this.createPrim("stop",t.id+"_gradient1")).setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),(o=this.createPrim("stop",t.id+"_gradient2")).setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),s.appendChild(r),s.appendChild(o),this.defs.appendChild(s),a.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+t.id+"_gradient)"),t.gradNode1=r,t.gradNode2=o):a.removeAttributeNS(null,"style")},updateGradient:function(t){var e,i,s=t.gradNode1,r=t.gradNode2,o=n.evaluate(t.visProp.gradient);n.exists(s)&&n.exists(r)&&(i=(i=n.evaluate(t.visProp.fillopacity))>0?i:0,e=n.evaluate(t.visProp.fillcolor),"linear"===o?(s.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),r.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity))):"radial"===o&&(s.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),r.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i)))},setObjectTransition:function(t,e){var i,r,o,a=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(void 0===e&&(e=n.evaluate(t.visProp.transitionduration)),e!==t.visPropOld.transitionduration){for(i=t.elementClass===s.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?" color "+e+"ms, opacity "+e+"ms":" fill "+e+"ms, fill-opacity "+e+"ms, stroke "+e+"ms, stroke-opacity "+e+"ms",o=a.length,r=0;r<o;++r)t[a[r]]&&(t[a[r]].style.transition=i);t.visPropOld.transitionduration=e}},_setAttribute:function(t,e){""===e?t():setTimeout(t,1)},setObjectFillColor:function(e,i,s,r){var a,l,h,c,d=n.evaluate(i),u=n.evaluate(s);u=u>0?u:0,e.visPropOld.fillcolor===d&&e.visPropOld.fillopacity===u||(n.exists(d)&&!1!==d&&(9!==d.length?(l=d,c=u):(h=o.rgba2rgbo(d),l=h[0],c=u*h[1]),a=void 0===r?e.rendNode:r,"none"!==l&&this._setAttribute((function(){a.setAttributeNS(null,"fill",l)}),e.visPropOld.fillcolor),e.type===t.OBJECT_TYPE_IMAGE?this._setAttribute((function(){a.setAttributeNS(null,"opacity",c)}),e.visPropOld.fillopacity):("none"===l&&(c=0),this._setAttribute((function(){a.setAttributeNS(null,"fill-opacity",c)}),e.visPropOld.fillopacity)),n.exists(e.visProp.gradient)&&this.updateGradient(e)),e.visPropOld.fillcolor=d,e.visPropOld.fillopacity=u)},setObjectStrokeColor:function(t,e,i){var r,a,l,h,c=n.evaluate(e),d=n.evaluate(i);d=d>0?d:0,t.visPropOld.strokecolor===c&&t.visPropOld.strokeopacity===d||(n.exists(c)&&!1!==c&&(9!==c.length?(r=c,l=d):(a=o.rgba2rgbo(c),r=a[0],l=d*a[1]),h=t.rendNode,t.elementClass===s.OBJECT_CLASS_TEXT?"html"===n.evaluate(t.visProp.display)?this._setAttribute((function(){h.style.color=r,h.style.opacity=l}),t.visPropOld.strokecolor):this._setAttribute((function(){h.setAttributeNS(null,"style","fill:"+r),h.setAttributeNS(null,"style","fill-opacity:"+l)}),t.visPropOld.strokecolor):this._setAttribute((function(){h.setAttributeNS(null,"stroke",r),h.setAttributeNS(null,"stroke-opacity",l)}),t.visPropOld.strokecolor),t.elementClass!==s.OBJECT_CLASS_CURVE&&t.elementClass!==s.OBJECT_CLASS_LINE||(n.evaluate(t.visProp.firstarrow)&&this._setArrowColor(t.rendNodeTriangleStart,r,l,t),n.evaluate(t.visProp.lastarrow)&&this._setArrowColor(t.rendNodeTriangleEnd,r,l,t))),t.visPropOld.strokecolor=c,t.visPropOld.strokeopacity=d)},setObjectStrokeWidth:function(t,e){var i,s=n.evaluate(e);isNaN(s)||t.visPropOld.strokewidth===s||(this.setPropertyPrim(i=t.rendNode,"stroked","true"),n.exists(s)&&this.setPropertyPrim(i,"stroke-width",s+"px"),t.visPropOld.strokewidth=s)},setLineCap:function(t){var e=n.evaluate(t.visProp.linecap);void 0!==e&&""!==e&&t.visPropOld.linecap!==e&&n.exists(t.rendNode)&&(this.setPropertyPrim(t.rendNode,"stroke-linecap",e),t.visPropOld.linecap=e)},setShadow:function(t){var e=n.evaluate(t.visProp.shadow);t.visPropOld.shadow!==e&&(n.exists(t.rendNode)&&(e?t.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):t.rendNode.removeAttributeNS(null,"filter")),t.visPropOld.shadow=e)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(t,e){this.svgRoot.style.width=parseFloat(t)+"px",this.svgRoot.style.height=parseFloat(e)+"px",this.svgRoot.setAttribute("width",parseFloat(t)),this.svgRoot.setAttribute("height",parseFloat(e))},createTouchpoints:function(t){var e,i;for(this.touchpoints=[],e=0;e<t;e++)i=this.createPrim("path","touchpoint1_"+e),this.appendChildPrim(i,19),i.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(i),this.setPropertyPrim(i,"stroked","true"),this.setPropertyPrim(i,"stroke-width","1px"),i.setAttributeNS(null,"stroke","#000000"),i.setAttributeNS(null,"stroke-opacity",1),i.setAttributeNS(null,"display","none"),i=this.createPrim("ellipse","touchpoint2_"+e),this.appendChildPrim(i,19),this.updateEllipsePrim(i,0,0,0,0),this.touchpoints.push(i),this.setPropertyPrim(i,"stroked","true"),this.setPropertyPrim(i,"stroke-width","1px"),i.setAttributeNS(null,"stroke","#000000"),i.setAttributeNS(null,"stroke-opacity",1),i.setAttributeNS(null,"fill","#ffffff"),i.setAttributeNS(null,"fill-opacity",0),i.setAttributeNS(null,"display","none")},showTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","inline"),this.touchpoints[2*t+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","none"),this.touchpoints[2*t+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(t,e){var i,s;this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"d","M "+((i=e[0])-37)+" "+(s=e[1])+" L "+(i+37)+" "+s+" M "+i+" "+(s-37)+" L "+i+" "+(s+37)),this.updateEllipsePrim(this.touchpoints[2*t+1],e[0],e[1],25,25))},dumpToCanvas:function(t,e,i,s){var r,o,l,h,c,d,u=this.svgRoot,p=window.btoa||a.encode;if(this.container.hasChildNodes()&&n.exists(this.foreignObjLayer)){for(;u.nextSibling;)this.foreignObjLayer.appendChild(u.nextSibling);!0===s&&this.container.ownerDocument.createElement("div").appendChild(this.foreignObjLayer)}if(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),c=u.getAttribute("width"),d=u.getAttribute("height"),((r=(new XMLSerializer).serializeToString(u)).match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(r=r.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),r=r.replace(/&nbsp;/g," "),(l=document.getElementById(t)).width=l.width,h=l.getContext("2d"),void 0!==e&&void 0!==i&&(l.style.width=parseFloat(e)+"px",l.style.height=parseFloat(i)+"px",l.setAttribute("width",2*parseFloat(c)),l.setAttribute("height",2*parseFloat(d)),h.scale(2*c/e,2*d/i)),(o=new Image).src="data:image/svg+xml;base64,"+p(unescape(encodeURIComponent(r))),o.onload=function(){setTimeout((function(){h.drawImage(o,0,0,e,i)}),200)},n.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(!0===s&&u.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(t,e,i){var s,r,o,a,l,h,c,d,u,p,f,m=this.container.ownerDocument,g=this.container.parentNode,b=t.attr.screenshot,y=!1;return"no"===this.type?this:(d=b.scale*parseFloat(this.container.style.width),u=b.scale*parseFloat(this.container.style.height),void 0===e||""===e?(y=!0,(l=new Image).style.width=d+"px",l.style.height=u+"px"):(y=!1,l=m.getElementById(e)),y&&((s=m.createElement("div")).style.cssText=b.css,s.style.width=d+"px",s.style.height=u+"px",s.style.zIndex=this.container.style.zIndex+120,r=t.getCoordsTopLeftCorner(),s.style.position="absolute",s.style.left=r[0]+"px",s.style.top=r[1]+"px"),o=m.createElement("canvas"),a=Math.random().toString(36).substr(2,5),o.setAttribute("id",a),o.setAttribute("width",d),o.setAttribute("height",u),o.style.width=d+"px",o.style.height=d+"px",o.style.display="none",g.append(o),y&&(h=m.createElement("span"),c=m.createTextNode("✖"),h.style.cssText=b.cssButton,h.appendChild(c),h.onclick=function(){s.parentNode.removeChild(s)},s.appendChild(l),s.appendChild(h),g.appendChild(s)),p=document.getElementById(this.container.id+"_navigationbar"),n.exists(p)&&(f=p.style.display,p.style.display="none"),this.dumpToCanvas(a,d,u,i),setTimeout((function(){l.src=o.toDataURL("image/png"),g.removeChild(o)}),400),n.exists(p)&&(p.style.display=f),this)}}),t.SVGRenderer})),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],(function(t,e,i,s,n,r,o){"use strict";return t.VMLRenderer=function(e){this.type="vml",this.container=e,this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,s.exists(t.vmlStylesheet)||(e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),t.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),t.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{e.ownerDocument.namespaces.jxgvml||e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(t){return e.ownerDocument.createElement("<jxgvml:"+t+' class="jxgvml">')}}catch(t){this.createNode=function(t){return e.ownerDocument.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},t.VMLRenderer.prototype=new e,t.extend(t.VMLRenderer.prototype,{_setAttr:function(e,i,s,n){try{8===this.container.ownerDocument.documentMode?e[i]=s:e.setAttribute(i,s,n)}catch(e){t.debug("_setAttr: "+i+" "+s+"<br>\n")}},updateTicks:function(t){var e,i,n,r,o,a=this.resolution,l=[];for(i=t.ticks.length,e=0;e<i;e++)o=(n=t.ticks[e])[1],s.isNumber((r=n[0])[0])&&s.isNumber(r[1])&&l.push(" m "+Math.round(a*r[0])+", "+Math.round(a*o[0])+" l "+Math.round(a*r[1])+", "+Math.round(a*o[1])+" ");s.exists(t.rendNode)||(t.rendNode=this.createPrim("path",t.id),this.appendChildPrim(t.rendNode,s.evaluate(t.visProp.layer))),this._setAttr(t.rendNode,"stroked","true"),this._setAttr(t.rendNode,"strokecolor",s.evaluate(t.visProp.strokecolor),1),this._setAttr(t.rendNode,"strokeweight",s.evaluate(t.visProp.strokewidth)),this._setAttr(t.rendNodeStroke,"opacity",100*s.evaluate(t.visProp.strokeopacity)+"%"),this.updatePathPrim(t.rendNode,l,t.board)},displayCopyright:function(t,e){var i,s;(i=this.createNode("textbox")).style.position="absolute",this._setAttr(i,"id",this.container.id+"_licenseText"),i.style.left=20,i.style.top=2,i.style.fontSize=e,i.style.color="#356AA0",i.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(i,"opacity","30%"),i.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",s=this.container.ownerDocument.createTextNode(t),i.appendChild(s),this.appendChildPrim(i,0)},drawInternalText:function(t){var e;return(e=this.createNode("textbox")).style.position="absolute",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,9),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",e},updateInternalText:function(t){var e,i,s,n,o,a,l=t.plaintext,h=this.joinTransforms(t,t.transformations),c=[0,0],d=t.rendNode,u=[],p=t.getAnchorX(),f=t.getAnchorY();if(!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])){for("right"===p?c[0]=1:"middle"===p&&(c[0]=.5),"bottom"===f?c[1]=1:"middle"===f&&(c[1]=.5),u[0]=r.matVecMult(h,[1,t.coords.scrCoords[1]-c[0]*t.size[0],t.coords.scrCoords[2]+(1-c[1])*t.size[1]+this.vOffsetText]),u[0][1]/=u[0][0],u[0][2]/=u[0][0],u[1]=r.matVecMult(h,[1,t.coords.scrCoords[1]+(1-c[0])*t.size[0],t.coords.scrCoords[2]+(1-c[1])*t.size[1]+this.vOffsetText]),u[1][1]/=u[1][0],u[1][2]/=u[1][0],u[2]=r.matVecMult(h,[1,t.coords.scrCoords[1]+(1-c[0])*t.size[0],t.coords.scrCoords[2]-c[1]*t.size[1]+this.vOffsetText]),u[2][1]/=u[2][0],u[2][2]/=u[2][0],u[3]=r.matVecMult(h,[1,t.coords.scrCoords[1]-c[0]*t.size[0],t.coords.scrCoords[2]-c[1]*t.size[1]+this.vOffsetText]),u[3][1]/=u[3][0],u[3][2]/=u[3][0],i=u[0][1],n=u[0][1],s=u[0][2],o=u[0][2],a=1;a<4;a++)i=Math.max(i,u[a][1]),n=Math.min(n,u[a][1]),s=Math.max(s,u[a][2]),o=Math.min(o,u[a][2]);e=1===c[0]?Math.floor(t.board.canvasWidth-i):Math.floor(n),t.visPropOld.left!==p+e&&(1===c[0]?(t.rendNode.style.right=e+"px",t.rendNode.style.left="auto"):(t.rendNode.style.left=e+"px",t.rendNode.style.right="auto"),t.visPropOld.left=p+e),e=1===c[1]?Math.floor(t.board.canvasHeight-s):Math.floor(o),t.visPropOld.top!==f+e&&(1===c[1]?(t.rendNode.style.bottom=e+"px",t.rendNode.style.top="auto"):(t.rendNode.style.top=e+"px",t.rendNode.style.bottom="auto"),t.visPropOld.top=f+e)}t.htmlStr!==l&&(t.rendNodeText.data=l,t.htmlStr=l),d.filters.item(0).M11=h[1][1],d.filters.item(0).M12=h[1][2],d.filters.item(0).M21=h[2][1],d.filters.item(0).M22=h[2][2],d.filters.item(0).enabled=!0},drawImage:function(t){var e;(e=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(e,"id",this.container.id+"_"+t.id),this.container.appendChild(e),this.appendChildPrim(e,s.evaluate(t.visProp.layer)),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var i,s,n,o,a,l,h=t.rendNode,c=[];if(e.length>0){for(i=this.joinTransforms(t,e),c[0]=r.matVecMult(i,t.coords.scrCoords),c[0][1]/=c[0][0],c[0][2]/=c[0][0],c[1]=r.matVecMult(i,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]]),c[1][1]/=c[1][0],c[1][2]/=c[1][0],c[2]=r.matVecMult(i,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]-t.size[1]]),c[2][1]/=c[2][0],c[2][2]/=c[2][0],c[3]=r.matVecMult(i,[1,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1]]),c[3][1]/=c[3][0],c[3][2]/=c[3][0],s=c[0][1],o=c[0][1],n=c[0][2],a=c[0][2],l=1;l<4;l++)s=Math.max(s,c[l][1]),o=Math.min(o,c[l][1]),n=Math.max(n,c[l][2]),a=Math.min(a,c[l][2]);h.style.left=Math.floor(o)+"px",h.style.top=Math.floor(a)+"px",h.filters.item(0).M11=i[1][1],h.filters.item(0).M12=i[1][2],h.filters.item(0).M21=i[2][1],h.filters.item(0).M22=i[2][2],h.filters.item(0).enabled=!0}},updateImageURL:function(t){var e=s.evaluate(t.url);this._setAttr(t.rendNode,"src",e)},appendChildPrim:function(t,e){return s.exists(e)||(e=0),t.style.zIndex=e,this.container.appendChild(t),t},appendNodesToElement:function(t,e){"shape"!==e&&"path"!==e&&"polygon"!==e||(t.rendNodePath=this.getElementById(t.id+"_path")),t.rendNodeFill=this.getElementById(t.id+"_fill"),t.rendNodeStroke=this.getElementById(t.id+"_stroke"),t.rendNodeShadow=this.getElementById(t.id+"_shadow"),t.rendNode=this.getElementById(t.id)},createPrim:function(t,e){var i,s,n=this.createNode("fill"),r=this.createNode("stroke"),o=this.createNode("shadow");return this._setAttr(n,"id",this.container.id+"_"+e+"_fill"),this._setAttr(r,"id",this.container.id+"_"+e+"_stroke"),this._setAttr(o,"id",this.container.id+"_"+e+"_shadow"),"circle"===t||"ellipse"===t?((i=this.createNode("oval")).appendChild(n),i.appendChild(r),i.appendChild(o)):"polygon"===t||"path"===t||"shape"===t||"line"===t?((i=this.createNode("shape")).appendChild(n),i.appendChild(r),i.appendChild(o),s=this.createNode("path"),this._setAttr(s,"id",this.container.id+"_"+e+"_path"),i.appendChild(s)):((i=this.createNode(t)).appendChild(n),i.appendChild(r),i.appendChild(o)),i.style.position="absolute",i.style.left="0px",i.style.top="0px",this._setAttr(i,"id",this.container.id+"_"+e),i},remove:function(t){s.exists(t)&&t.removeNode(!0)},makeArrows:function(t){var e,i=s.evaluate(t.visProp.firstarrow),n=s.evaluate(t.visProp.lastarrow);t.visPropOld.firstarrow===i&&t.visPropOld.lastarrow===n||(i?(this._setAttr(e=t.rendNodeStroke,"startarrow","block"),this._setAttr(e,"startarrowlength","long")):s.exists(e=t.rendNodeStroke)&&this._setAttr(e,"startarrow","none"),n?(this._setAttr(e=t.rendNodeStroke,"id",this.container.id+"_"+t.id+"stroke"),this._setAttr(e,"endarrow","block"),this._setAttr(e,"endarrowlength","long")):s.exists(e=t.rendNodeStroke)&&this._setAttr(e,"endarrow","none"),t.visPropOld.firstarrow=i,t.visPropOld.lastarrow=n)},updateEllipsePrim:function(t,e,i,s,n){t.style.left=Math.floor(e-s)+"px",t.style.top=Math.floor(i-n)+"px",t.style.width=Math.floor(2*Math.abs(s))+"px",t.style.height=Math.floor(2*Math.abs(n))+"px"},updateLinePrim:function(t,e,i,s,n,r){var o,a=this.resolution;isNaN(e+i+s+n)||(o=["m ",Math.floor(a*e),", ",Math.floor(a*i)," l ",Math.floor(a*s),", ",Math.floor(a*n)],this.updatePathPrim(t,o,r))},updatePathPrim:function(t,e,i){var s=i.canvasWidth,n=i.canvasHeight;e.length<=0&&(e=["m 0,0"]),t.style.width=s,t.style.height=n,this._setAttr(t,"coordsize",[Math.floor(this.resolution*s),Math.floor(this.resolution*n)].join(",")),this._setAttr(t,"path",e.join(""))},updatePathStringPoint:function(t,e,i){var s=[],n=Math.round,r=t.coords.scrCoords,o=e*Math.sqrt(3)*.5,a=.5*e,l=this.resolution;return"x"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*(r[2]-e))," l ",n(l*(r[1]+e)),", ",n(l*(r[2]+e))," m ",n(l*(r[1]+e)),", ",n(l*(r[2]-e))," l ",n(l*(r[1]-e)),", ",n(l*(r[2]+e))].join("")):"+"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*(r[1]+e)),", ",n(l*r[2])," m ",n(l*r[1]),", ",n(l*(r[2]-e))," l ",n(l*r[1]),", ",n(l*(r[2]+e))].join("")):"<>"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*r[1]),", ",n(l*(r[2]+e))," l ",n(l*(r[1]+e)),", ",n(l*r[2])," l ",n(l*r[1]),", ",n(l*(r[2]-e))," x e "].join("")):"^"===i?s.push([" m ",n(l*r[1]),", ",n(l*(r[2]-e))," l ",n(l*(r[1]-o)),", ",n(l*(r[2]+a))," l ",n(l*(r[1]+o)),", ",n(l*(r[2]+a))," x e "].join("")):"v"===i?s.push([" m ",n(l*r[1]),", ",n(l*(r[2]+e))," l ",n(l*(r[1]-o)),", ",n(l*(r[2]-a))," l ",n(l*(r[1]+o)),", ",n(l*(r[2]-a))," x e "].join("")):">"===i?s.push([" m ",n(l*(r[1]+e)),", ",n(l*r[2])," l ",n(l*(r[1]-a)),", ",n(l*(r[2]-o))," l ",n(l*(r[1]-a)),", ",n(l*(r[2]+o))," l ",n(l*(r[1]+e)),", ",n(l*r[2])].join("")):"<"===i&&s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*(r[1]+a)),", ",n(l*(r[2]-o))," l ",n(l*(r[1]+a)),", ",n(l*(r[2]+o))," x e "].join("")),s},updatePathStringPrim:function(t){var e,i,s=[],n=this.resolution,r=Math.round,o=" m ",a=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";if(a=Math.min(a,t.points.length),1===t.bezierDegree)for(e=0;e<a;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o=" m ":(i[1]>2e4?i[1]=2e4:i[1]<-2e4&&(i[1]=-2e4),i[2]>2e4?i[2]=2e4:i[2]<-2e4&&(i[2]=-2e4),s.push([o,r(n*i[1]),", ",r(n*i[2])].join("")),o=" l ");else if(3===t.bezierDegree)for(e=0;e<a;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o=" m ":(s.push([o,r(n*i[1]),", ",r(n*i[2])].join(""))," c "===o&&(s.push([" ",r(n*(i=t.points[e+=1].scrCoords)[1]),", ",r(n*i[2])].join("")),s.push([" ",r(n*(i=t.points[e+=1].scrCoords)[1]),", ",r(n*i[2])].join(""))),o=" c "),e+=1;return s.push(" e"),s},updatePathStringBezierPrim:function(t){var e,i,n,r,a,l,h=[],c=s.evaluate(t.visProp.strokewidth),d=this.resolution,u=Math.round,p=" m ",f="plot"!==s.evaluate(t.visProp.curvetype),m=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";for(f&&t.board.options.curve.RDPsmoothing&&(t.points=o.RamerDouglasPeucker(t.points,1)),m=Math.min(m,t.points.length),i=1;i<3;i++)for(p=" m ",e=0;e<m;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?p=" m ":(r[1]>2e4?r[1]=2e4:r[1]<-2e4&&(r[1]=-2e4),r[2]>2e4?r[2]=2e4:r[2]<-2e4&&(r[2]=-2e4),h.push(" m "===p?[p,u(d*r[1])," ",u(d*r[2])].join(""):[p,u(d*(a+.333*(r[1]-a)+c*((n=2*i)*Math.random()-i)))," ",u(d*(l+.333*(r[2]-l)+c*(n*Math.random()-i)))," ",u(d*(a+.666*(r[1]-a)+c*(n*Math.random()-i)))," ",u(d*(l+.666*(r[2]-l)+c*(n*Math.random()-i)))," ",u(d*r[1])," ",u(d*r[2])].join("")),p=" c ",a=r[1],l=r[2]);return h.push(" e"),h},updatePolygonPrim:function(t,e){var i,s,n=e.vertices.length,r=this.resolution,o=[];if(this._setAttr(t,"stroked","false"),s=e.vertices[0].coords.scrCoords,!isNaN(s[1]+s[2])){for(o.push(["m ",Math.floor(r*s[1]),",",Math.floor(r*s[2])," l "].join("")),i=1;i<n-1;i++){if(!e.vertices[i].isReal)return void this.updatePathPrim(t,"",e.board);if(s=e.vertices[i].coords.scrCoords,isNaN(s[1]+s[2]))return;o.push(Math.floor(r*s[1])+","+Math.floor(r*s[2])),i<n-2&&o.push(", ")}o.push(" x e"),this.updatePathPrim(t,o,e.board)}},updateRectPrim:function(t,e,i,s,n){t.style.left=Math.floor(e)+"px",t.style.top=Math.floor(i)+"px",s>=0&&(t.style.width=s+"px"),n>=0&&(t.style.height=n+"px")},setPropertyPrim:function(t,e,i){var n,r="";switch(e){case"stroke":r="strokecolor";break;case"stroke-width":r="strokeweight";break;case"stroke-dasharray":r="dashstyle"}""!==r&&(n=s.evaluate(i),this._setAttr(t,r,n))},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),e&&e.rendNode&&(e.rendNode.style.visibility="inherit")},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),e&&e.rendNode&&(e.rendNode.style.visibility="hidden")},setDashStyle:function(t,e){e.dash>=0&&this._setAttr(t.rendNodeStroke,"dashstyle",this.dashArray[e.dash])},setGradient:function(t){var e=t.rendNodeFill,i=s.evaluate(t.visProp.gradient);"linear"===i?(this._setAttr(e,"type","gradient"),this._setAttr(e,"color2",s.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",s.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"angle",s.evaluate(t.visProp.gradientangle))):"radial"===i?(this._setAttr(e,"type","gradientradial"),this._setAttr(e,"color2",s.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",s.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"focusposition",100*s.evaluate(t.visProp.gradientpositionx)+"%,"+100*s.evaluate(t.visProp.gradientpositiony)+"%"),this._setAttr(e,"focussize","0,0")):this._setAttr(e,"type","solid")},setObjectFillColor:function(t,e,r){var o,a,l,h=s.evaluate(e),c=s.evaluate(r),d=t.rendNode;c=c>0?c:0,t.visPropOld.fillcolor===h&&t.visPropOld.fillopacity===c||(s.exists(h)&&!1!==h&&(9!==h.length?(o=h,l=c):(o=(a=n.rgba2rgbo(h))[0],l=c*a[1]),"none"===o||!1===o?this._setAttr(t.rendNode,"filled","false"):(this._setAttr(t.rendNode,"filled","true"),this._setAttr(t.rendNode,"fillcolor",o),s.exists(l)&&t.rendNodeFill&&this._setAttr(t.rendNodeFill,"opacity",100*l+"%")),t.type===i.OBJECT_TYPE_IMAGE&&d.filters.length>1&&(d.filters.item(1).opacity=Math.round(100*l),d.filters.item(1).enabled=!0)),t.visPropOld.fillcolor=h,t.visPropOld.fillopacity=c)},setObjectStrokeColor:function(t,e,n){var r,o,a,l,h=s.evaluate(e),c=s.evaluate(n),d=t.rendNode;c=c>0?c:0,t.visPropOld.strokecolor===h&&t.visPropOld.strokeopacity===c||(s.exists(h)&&!1!==h&&(9!==h.length?(r=h,a=c):(r=(o=e.rgba2rgbo(h))[0],a=c*o[1]),t.elementClass===i.OBJECT_CLASS_TEXT?(d.filters.length>1&&(d.filters.item(1).opacity=Math.round(100*a),d.filters.item(1).enabled=!0),d.style.color=r):(!1!==r&&(this._setAttr(d,"stroked","true"),this._setAttr(d,"strokecolor",r)),l=t.rendNodeStroke,s.exists(a)&&t.type!==i.OBJECT_TYPE_IMAGE&&this._setAttr(l,"opacity",100*a+"%"))),t.visPropOld.strokecolor=h,t.visPropOld.strokeopacity=c)},setObjectStrokeWidth:function(t,e){var i,n=s.evaluate(e);isNaN(n)||t.visPropOld.strokewidth===n||(this.setPropertyPrim(i=t.rendNode,"stroked","true"),s.exists(n)&&(this.setPropertyPrim(i,"stroke-width",n),0===n&&s.exists(t.rendNodeStroke)&&this._setAttr(i,"stroked","false")),t.visPropOld.strokewidth=n)},setShadow:function(t){var e=t.rendNodeShadow,i=s.evaluate(t.visProp.shadow);e&&t.visPropOld.shadow!==i&&(i?(this._setAttr(e,"On","True"),this._setAttr(e,"Offset","3pt,3pt"),this._setAttr(e,"Opacity","60%"),this._setAttr(e,"Color","#aaaaaa")):this._setAttr(e,"On","False"),t.visPropOld.shadow=i)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),t.VMLRenderer})),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],(function(t,e,i,s,n,r,o,a,l,h,c){"use strict";return t.CanvasRenderer=function(t,e){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=r.genUUID(),this.canvasNamespace=null,s.isBrowser?(this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',e.width,'px" height="',e.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):s.isNode()&&(this.canvasId="object"==typeof module?module.require("canvas"):require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},t.CanvasRenderer.prototype=new e,t.extend(t.CanvasRenderer.prototype,{_drawFilledPolygon:function(t){var e,i=t.length,s=this.context;if(i>0){for(s.beginPath(),s.moveTo(t[0][0],t[0][1]),e=0;e<i;e++)e>0&&s.lineTo(t[e][0],t[e][1]);s.lineTo(t[0][0],t[0][1]),s.fill()}},_fill:function(t){var e=this.context;e.save(),this._setColor(t,"fill")&&e.fill(),e.restore()},_rotatePoint:function(t,e,i){return[e*Math.cos(t)-i*Math.sin(t),e*Math.sin(t)+i*Math.cos(t)]},_rotateShape:function(t,e){var i,s=[],n=t.length;if(n<=0)return t;for(i=0;i<n;i++)s.push(this._rotatePoint(e,t[i][0],t[i][1]));return s},_setColor:function(t,e,i){var s,r,a,l,h,c,d,u=!0,p=!1,f=t.visProp;return e=e||"stroke",i=i||e,n.exists(t.board)&&n.exists(t.board.highlightedObjects)||(p=!0),s=!p&&n.exists(t.board.highlightedObjects[t.id])?"highlight":"","none"!==(a=n.evaluate(f[s+e+"color"]))&&!1!==a?(c=(c=n.evaluate(f[s+e+"opacity"]))>0?c:0,9!==a.length?(h=a,d=c):(h=(l=o.rgba2rgbo(a))[0],d=c*l[1]),this.context.globalAlpha=d,this.context[i+"Style"]=h):u=!1,r=parseFloat(n.evaluate(f.strokewidth)),"stroke"!==e||isNaN(r)||(0===r?this.context.globalAlpha=0:this.context.lineWidth=r),"stroke"===e&&void 0!==f.linecap&&""!==f.linecap&&(this.context.lineCap=f.linecap),u},_stroke:function(t){var e=this.context,i=n.evaluate(t.visProp.dash);e.save(),i>0?e.setLineDash&&e.setLineDash(this.dashArray[i]):this.context.lineDashArray=[],this._setColor(t,"stroke")&&e.stroke(),e.restore()},_translateShape:function(t,e,i){var s,n=[],r=t.length;if(r<=0)return t;for(s=0;s<r;s++)n.push([t[s][0]+e,t[s][1]+i]);return n},drawPoint:function(t){var e=n.evaluate(t.visProp.face),i=n.evaluate(t.visProp.size),s=t.coords.scrCoords,r=i*Math.sqrt(3)*.5,o=.5*i,a=parseFloat(n.evaluate(t.visProp.strokewidth))/2,l=this.context;if(t.visPropCalc.visible)switch(e){case"cross":case"x":l.beginPath(),l.moveTo(s[1]-i,s[2]-i),l.lineTo(s[1]+i,s[2]+i),l.moveTo(s[1]+i,s[2]-i),l.lineTo(s[1]-i,s[2]+i),l.lineCap="round",l.lineJoin="round",l.closePath(),this._stroke(t);break;case"circle":case"o":l.beginPath(),l.arc(s[1],s[2],i+1+a,0,2*Math.PI,!1),l.closePath(),this._fill(t),this._stroke(t);break;case"square":case"[]":if(i<=0)break;l.save(),this._setColor(t,"stroke","fill")&&l.fillRect(s[1]-i-a,s[2]-i-a,2*i+3*a,2*i+3*a),l.restore(),l.save(),this._setColor(t,"fill"),l.fillRect(s[1]-i+a,s[2]-i+a,2*i-a,2*i-a),l.restore();break;case"plus":case"+":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1]+i,s[2]),l.moveTo(s[1],s[2]-i),l.lineTo(s[1],s[2]+i),l.lineCap="round",l.lineJoin="round",l.closePath(),this._stroke(t);break;case"diamond":case"<>":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1],s[2]+i),l.lineTo(s[1]+i,s[2]),l.lineTo(s[1],s[2]-i),l.closePath(),this._fill(t),this._stroke(t);break;case"triangleup":case"a":case"^":l.beginPath(),l.moveTo(s[1],s[2]-i),l.lineTo(s[1]-r,s[2]+o),l.lineTo(s[1]+r,s[2]+o),l.closePath(),this._fill(t),this._stroke(t);break;case"triangledown":case"v":l.beginPath(),l.moveTo(s[1],s[2]+i),l.lineTo(s[1]-r,s[2]-o),l.lineTo(s[1]+r,s[2]-o),l.closePath(),this._fill(t),this._stroke(t);break;case"triangleleft":case"<":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1]+o,s[2]-r),l.lineTo(s[1]+o,s[2]+r),l.closePath(),this.fill(t),this._stroke(t);break;case"triangleright":case">":l.beginPath(),l.moveTo(s[1]+i,s[2]),l.lineTo(s[1]-o,s[2]-r),l.lineTo(s[1]-o,s[2]+r),l.closePath(),this._fill(t),this._stroke(t)}},updatePoint:function(t){this.drawPoint(t)},drawLine:function(t){var e,s=new a(i.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),r=new a(i.COORDS_BY_USER,t.point2.coords.usrCoords,t.board),o=null,l=n.evaluate(t.visProp.firstarrow),c=n.evaluate(t.visProp.lastarrow);t.visPropCalc.visible&&((l||c)&&(o=-4),h.calcStraight(t,s,r,o),e=this.getPositionArrowHead(t,s,r),this.context.beginPath(),this.context.moveTo(e.c1.scrCoords[1]+e.d1x,e.c1.scrCoords[2]+e.d1y),this.context.lineTo(e.c2.scrCoords[1]-e.d2x,e.c2.scrCoords[2]-e.d2y),this._stroke(t),(l&&e.sFirst>0||c&&e.sLast>0)&&this.makeArrows(t,e.c1,e.c2))},updateLine:function(t){this.drawLine(t)},drawTicks:function(){},updateTicks:function(t){var e,i,s,n,r=t.ticks.length,o=this.context;for(o.beginPath(),e=0;e<r;e++)o.moveTo((s=(i=t.ticks[e])[0])[0],(n=i[1])[0]),o.lineTo(s[1],n[1]);for(e=0;e<r;e++)i=t.ticks[e].scrCoords,t.ticks[e].major&&(t.board.needsFullUpdate||t.needsRegularUpdate)&&t.labels[e]&&t.labels[e].visPropCalc.visible&&this.updateText(t.labels[e]);o.lineCap="round",this._stroke(t)},drawCurve:function(t){n.evaluate(t.visProp.handdrawing)?this.updatePathStringBezierPrim(t):this.updatePathStringPrim(t),t.numberPoints>1&&this.makeArrows(t)},updateCurve:function(t){this.drawCurve(t)},drawEllipse:function(t){var e=t.center.coords.scrCoords[1],i=t.center.coords.scrCoords[2],s=t.board.unitX,n=t.board.unitY,r=2*t.Radius(),o=2*t.Radius(),a=r*s,l=o*n,h=e-a/2,c=i-l/2,d=a/2*.5522848,u=l/2*.5522848,p=h+a,f=c+l,m=h+a/2,g=c+l/2,b=this.context;r>0&&o>0&&!isNaN(e+i)&&(b.beginPath(),b.moveTo(h,g),b.bezierCurveTo(h,g-u,m-d,c,m,c),b.bezierCurveTo(m+d,c,p,g-u,p,g),b.bezierCurveTo(p,g+u,m+d,f,m,f),b.bezierCurveTo(m-d,f,h,g+u,h,g),b.closePath(),this._fill(t),this._stroke(t))},updateEllipse:function(t){return this.drawEllipse(t)},displayCopyright:function(t,e){var i=this.context;i.save(),i.font=e+"px Arial",i.fillStyle="#aaa",i.lineWidth=.5,i.fillText(t,10,2+e),i.restore()},drawInternalText:function(t){var e=n.evaluate(t.visProp.fontsize),i=t.getAnchorX(),s=t.getAnchorY(),r=this.context;return r.save(),this._setColor(t,"stroke","fill")&&!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])&&(r.font=(e>0?e:0)+"px Arial",this.transformImage(t,t.transformations),"left"===i?r.textAlign="left":"right"===i?r.textAlign="right":"middle"===i&&(r.textAlign="center"),"bottom"===s?r.textBaseline="bottom":"top"===s?r.textBaseline="top":"middle"===s&&(r.textBaseline="middle"),r.fillText(t.plaintext,t.coords.scrCoords[1],t.coords.scrCoords[2])),r.restore(),null},updateInternalText:function(t){this.drawInternalText(t)},setObjectStrokeColor:function(t,e,s){var r,a,l,h,c=n.evaluate(e),d=n.evaluate(s);d=d>0?d:0,t.visPropOld.strokecolor===c&&t.visPropOld.strokeopacity===d||(n.exists(c)&&!1!==c&&(9!==c.length?(r=c,l=d):(r=(a=o.rgba2rgbo(c))[0],l=d*a[1]),h=t.rendNode,t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)&&(h.style.color=r,h.style.opacity=l)),t.visPropOld.strokecolor=c,t.visPropOld.strokeopacity=d)},drawImage:function(t){t.rendNode=new Image,t._src="",this.updateImage(t)},updateImage:function(t){var e=this.context,i=n.evaluate(t.visProp.fillopacity),s=n.bind((function(){t.imgIsLoaded=!0,t.size[0]<=0||t.size[1]<=0||(e.save(),e.globalAlpha=i,this.transformImage(t,t.transformations),e.drawImage(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),e.restore())}),this);this.updateImageURL(t)?t.rendNode.onload=s:t.imgIsLoaded&&s()},transformImage:function(t,e){var i,s=this.context;e.length>0&&(i=this.joinTransforms(t,e),Math.abs(c.det(i))>=l.eps&&s.transform(i[1][1],i[2][1],i[1][2],i[2][2],i[1][0],i[2][0]))},updateImageURL:function(t){var e;return e=n.evaluate(t.url),t._src!==e&&(t.imgIsLoaded=!1,t.rendNode.src=e,t._src=e,!0)},remove:function(t){n.exists(t)&&n.exists(t.parentNode)&&t.parentNode.removeChild(t)},makeArrows:function(t,e,s){var r,o,a,l,h,c,d,u,p=n.evaluate(t.visProp.strokewidth),f=this.context,m=n.evaluate(t.visProp.firstarrow),g=n.evaluate(t.visProp.lastarrow);if("none"!==n.evaluate(t.visProp.strokecolor)&&(m||g)){if(t.elementClass!==i.OBJECT_CLASS_LINE)return r=t.points[0].scrCoords[1],o=t.points[0].scrCoords[2],a=t.points[t.points.length-1].scrCoords[1],void(l=t.points[t.points.length-1].scrCoords[2]);r=e.scrCoords[1],o=e.scrCoords[2],a=s.scrCoords[1],l=s.scrCoords[2],m&&n.exists(m.type)&&(p*=n.exists(m.size)?n.evaluate(m.size):3,d=2===(u=n.evaluate(m.type))?[[p,.5*-p],[0,0],[p,.5*p],[.5*p,0]]:3===u?[[p/3,.5*-p],[0,.5*-p],[0,.5*p],[p/3,.5*p]]:[[p,.5*-p],[0,0],[p,.5*p]]),g&&n.exists(g.type)&&(p*=n.exists(g.size)?n.evaluate(g.size):3,c=2===(u=n.evaluate(g.type))?[[-p,.5*-p],[0,0],[-p,.5*p],[.5*-p,0]]:3===u?[[-p/3,.5*-p],[0,.5*-p],[0,.5*p],[-p/3,.5*p]]:[[-p,.5*-p],[0,0],[-p,.5*p]]),f.save(),this._setColor(t,"stroke","fill")&&(h=Math.atan2(l-o,a-r),g&&this._drawFilledPolygon(this._translateShape(this._rotateShape(c,h),a,l)),m&&this._drawFilledPolygon(this._translateShape(this._rotateShape(d,h),r,o))),f.restore()}},updatePathStringPrim:function(t){var e,i,s,n,r,o="M",a=this.context;if(!(t.numberPoints<=0)){if(r=Math.min(t.points.length,t.numberPoints),a.beginPath(),1===t.bezierDegree)for(e=0;e<r;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o="M":(i[1]>5e3?i[1]=5e3:i[1]<-5e3&&(i[1]=-5e3),i[2]>5e3?i[2]=5e3:i[2]<-5e3&&(i[2]=-5e3),"M"===o?a.moveTo(i[1],i[2]):a.lineTo(i[1],i[2]),o="L");else if(3===t.bezierDegree)for(e=0;e<r;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o="M":("M"===o?a.moveTo(i[1],i[2]):a.bezierCurveTo(i[1],i[2],(s=t.points[e+=1].scrCoords)[1],s[2],(n=t.points[e+=1].scrCoords)[1],n[2]),o="C"),e+=1;a.lineCap="round",this._fill(t),this._stroke(t)}},updatePathStringBezierPrim:function(t){var e,i,s,r,o,a,l,h="M",d=n.evaluate(t.visProp.strokewidth),u="plot"!==n.evaluate(t.visProp.curvetype),p=this.context;if(!(t.numberPoints<=0)){for(u&&t.board.options.curve.RDPsmoothing&&(t.points=c.RamerDouglasPeucker(t.points,.5)),l=Math.min(t.points.length,t.numberPoints),p.beginPath(),i=1;i<3;i++)for(h="M",e=0;e<l;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?h="M":(r[1]>5e3?r[1]=5e3:r[1]<-5e3&&(r[1]=-5e3),r[2]>5e3?r[2]=5e3:r[2]<-5e3&&(r[2]=-5e3),"M"===h?p.moveTo(r[1],r[2]):p.bezierCurveTo(o+.333*(r[1]-o)+d*((s=2*i)*Math.random()-i),a+.333*(r[2]-a)+d*(s*Math.random()-i),o+.666*(r[1]-o)+d*(s*Math.random()-i),a+.666*(r[2]-a)+d*(s*Math.random()-i),r[1],r[2]),h="C",o=r[1],a=r[2]);p.lineCap="round",this._fill(t),this._stroke(t)}},updatePolygonPrim:function(t,e){var i,s,n,r=e.vertices.length,o=this.context,a=!0;if(!(r<=0)&&e.visPropCalc.visible){for(o.beginPath(),s=0;!e.vertices[s].isReal&&s<r-1;)s++,a=!1;for(o.moveTo((i=e.vertices[s].coords.scrCoords)[1],i[2]),n=s;n<r-1;n++)e.vertices[n].isReal||(a=!1),o.lineTo((i=e.vertices[n].coords.scrCoords)[1],i[2]);o.closePath(),a&&this._fill(e)}},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),n.exists(e.rendNode)&&(e.rendNode.style.visibility="inherit")},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),n.exists(e.rendNode)&&(e.rendNode.style.visibility="hidden")},setGradient:function(t){var e;e=(e=n.evaluate(t.visProp.fillopacity))>0?e:0,n.evaluate(t.visProp.fillcolor)},setShadow:function(t){t.visPropOld.shadow!==t.visProp.shadow&&(t.visPropOld.shadow=t.visProp.shadow)},highlight:function(t){return t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?this.updateTextStyle(t,!0):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},noHighlight:function(t){return t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?this.updateTextStyle(t,!1):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(e){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),e&&e.attr.showcopyright&&this.displayCopyright(t.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(t,e){this.container?(this.canvasRoot.style.width=parseFloat(t)+"px",this.canvasRoot.style.height=parseFloat(e)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(t)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(e)+"px")):(this.canvasRoot.width=2*parseFloat(t),this.canvasRoot.height=2*parseFloat(e)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),t.CanvasRenderer})),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],(function(t,e,i,s,n,r,o,a,l,h){"use strict";return t.JSXGraph={rendererType:(r.board.renderer="no",e.supportsVML()&&(r.board.renderer="vml",document.onmousemove=function(){var t;return document.body&&(t=document.body.scrollLeft,t+=document.body.scrollTop),t}),e.supportsCanvas()&&(r.board.renderer="canvas"),e.supportsSVG()&&(r.board.renderer="svg"),e.isNode()&&e.supportsCanvas()&&(r.board.renderer="canvas"),(e.isNode()||"no"===r.renderer)&&(r.text.display="internal",r.infobox.display="internal"),r.board.renderer),initRenderer:function(t,e,s,n){var r;if(i.exists(s)&&!1!==s||"object"!=typeof document||(s=document),"object"==typeof s&&null!==t)for(r=s.getElementById(t);r.firstChild;)r.removeChild(r.firstChild);else r=t;return void 0!==n&&"auto"!==n||(n=this.rendererType),"svg"===n?new o(r,e):"vml"===n?new a(r):"canvas"===n?new l(r,e):new h},initBoard:function(n,o){var a,l,h,c,d,u,p,f,m,g,b,y,v,C;return(g=i.copyAttributes(o=o||{},r,"board")).zoom=i.copyAttributes(g,r,"board","zoom"),g.pan=i.copyAttributes(g,r,"board","pan"),g.selection=i.copyAttributes(g,r,"board","selection"),g.navbar=i.copyAttributes(g.navbar,r,"navbar"),f=e.getDimensions(n,g.document),g.unitx||g.unity?(a=i.def(g.originx,150),l=i.def(g.originy,150),h=i.def(g.unitx,50),c=i.def(g.unity,50)):(m=g.boundingbox,u=parseInt(f.width,10),p=parseInt(f.height,10),i.exists(m)&&g.keepaspectratio?(h=u/(m[2]-m[0]),c=p/(m[1]-m[3]),Math.abs(h)<Math.abs(c)?c=Math.abs(h)*c/Math.abs(c):h=Math.abs(c)*h/Math.abs(h)):(h=u/(m[2]-m[0]),c=p/(m[1]-m[3])),a=-h*m[0],l=c*m[1]),d=this.initRenderer(n,f,g.document,g.renderer),C=new s(n,d,g.id,[a,l],g.zoomfactor*g.zoomx,g.zoomfactor*g.zoomy,h,c,f.width,f.height,g),t.boards[C.id]=C,C.keepaspectratio=g.keepaspectratio,C.resizeContainer(f.width,f.height,!0,!0),C.suspendUpdate(),C.initInfobox(),g.axis&&(y=i.deepCopy(r.board.defaultAxes.x,b="object"==typeof g.axis?g.axis:{}),v=i.deepCopy(r.board.defaultAxes.y,b),g.defaultaxes.x&&(y=i.deepCopy(y,g.defaultaxes.x)),g.defaultaxes.y&&(v=i.deepCopy(v,g.defaultaxes.y)),C.defaultAxes={},C.defaultAxes.x=C.create("axis",[[0,0],[1,0]],y),C.defaultAxes.y=C.create("axis",[[0,0],[0,1]],v)),g.grid&&C.create("grid",[],"object"==typeof g.grid?g.grid:{}),C._createSelectionPolygon(g),C.renderer.drawZoomBar(C,g.navbar),C.unsuspendUpdate(),C},loadBoardFromFile:function(o,a,l,h,c){var d,u,p,f,m;return(d=i.copyAttributes(h=h||{},r,"board")).zoom=i.copyAttributes(h,r,"board","zoom"),d.pan=i.copyAttributes(h,r,"board","pan"),d.selection=i.copyAttributes(d,r,"board","selection"),d.navbar=i.copyAttributes(d.navbar,r,"navbar"),f=e.getDimensions(o,d.document),u=this.initRenderer(o,f,d.document,d.renderer),(p=new s(o,u,"",[150,150],1,1,50,50,f.width,f.height,d)).initInfobox(),p.resizeContainer(f.width,f.height,!0,!0),n.parseFileContent(a,p,l,!0,c),m=i.copyAttributes(d,r,"board","selection"),p.selectionPolygon=p.create("polygon",[[0,0],[0,0],[0,0],[0,0]],m),p.renderer.drawZoomBar(p,d.navbar),t.boards[p.id]=p,p},loadBoardFromString:function(o,a,l,h,c){var d,u,p,f,m;return(d=i.copyAttributes(h=h||{},r,"board")).zoom=i.copyAttributes(h,r,"board","zoom"),d.pan=i.copyAttributes(h,r,"board","pan"),d.selection=i.copyAttributes(d,r,"board","selection"),d.navbar=i.copyAttributes(d.navbar,r,"navbar"),p=e.getDimensions(o,d.document),u=this.initRenderer(o,p,d.document),(f=new s(o,u,"",[150,150],1,1,50,50,p.width,p.height,d)).initInfobox(),f.resizeContainer(p.width,p.height,!0,!0),n.parseString(a,f,l,!0,c),m=i.copyAttributes(d,r,"board","selection"),f.selectionPolygon=f.create("polygon",[[0,0],[0,0],[0,0],[0,0]],m),f.renderer.drawZoomBar(f,d.navbar),t.boards[f.id]=f,f},freeBoard:function(e){var i;for(i in"string"==typeof e&&(e=t.boards[e]),e.removeEventHandlers(),e.suspendUpdate(),e.objects)e.objects.hasOwnProperty(i)&&e.objects[i].remove();for(;e.containerObj.firstChild;)e.containerObj.removeChild(e.containerObj.firstChild);for(i in e.objects)e.objects.hasOwnProperty(i)&&delete e.objects[i];delete e.renderer,e.jc.creator.clearCache(),delete e.jc,delete t.boards[e.id]},registerElement:function(e,i){t.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),t.registerElement(e,i)}},e.isBrowser&&"object"==typeof window&&"object"==typeof document&&e.addEvent(window,"load",(function(){var e,s,n,r,o,a,l,h,c,d,u,p,f=document.getElementsByTagName("script"),m=function(e,i,s){var n=t.JSXGraph.initBoard(o,{boundingbox:s,keepaspectratio:!0,grid:u,axis:d,showReload:!0});if(i.toLowerCase().indexOf("script")>-1)n.construct(e);else try{n.jc.parse(e)}catch(e){t.debug(e)}return n},g=function(e,i,s,n){return function(){var r;t.JSXGraph.freeBoard(e),(r=m(i,s,n)).reload=g(r,i,s,n)}};for(s=0;s<f.length;s++)if(e=f[s].getAttribute("type",!1),i.exists(e)&&("text/jessiescript"===e.toLowerCase()||"jessiescript"===e.toLowerCase()||"text/jessiecode"===e.toLowerCase()||"jessiecode"===e.toLowerCase())){if(l=f[s].getAttribute("width",!1)||"500px",h=f[s].getAttribute("height",!1)||"500px",c=f[s].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",o=f[s].getAttribute("container",!1),4!==(c=c.split(",")).length)c=[-5,5,5,-5];else for(n=0;n<c.length;n++)c[n]=parseFloat(c[n]);if(d=i.str2Bool(f[s].getAttribute("axis",!1)||"false"),u=i.str2Bool(f[s].getAttribute("grid",!1)||"false"),i.exists(o))r=document.getElementById(o);else{o="jessiescript_autgen_jxg_"+s,(r=document.createElement("div")).setAttribute("id",o),r.setAttribute("style","width:"+l+"; height:"+h+"; float:left"),r.setAttribute("class","jxgbox");try{document.body.insertBefore(r,f[s])}catch(t){"object"==typeof jQuery&&jQuery(r).insertBefore(f[s])}}document.getElementById(o)?(p=(p=f[s].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),f[s].innerHTML=p,(a=m(p,e,c)).reload=g(a,p,e,c)):t.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}}),window),t.JSXGraph})),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],(function(t,e,i,s,n){"use strict";return t.Group=function(t,i,s,r,o){var a,l,h,c;for(this.board=t,this.objects={},a=this.board.numObjects,this.board.numObjects+=1,this.id=""!==i&&n.exists(i)?i:this.board.id+"Group"+a,this.board.groups[this.id]=this,this.type=e.OBJECT_TYPE_POINT,this.elementClass=e.OBJECT_CLASS_POINT,this.name=""!==s&&n.exists(s)?s:"group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=o.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],l=n.isArray(r)?r:Array.prototype.slice.call(arguments,3),h=0;h<l.length;h++)c=this.board.select(l[h]),!n.evaluate(c.visProp.fixed)&&n.exists(c.coords)&&this.addPoint(c);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},t.extend(t.Group.prototype,{ungroup:function(){var t,e,i;for(t in this.objects)this.objects.hasOwnProperty(t)&&n.isArray((e=this.objects[t].point).groups)&&(i=n.indexOf(e.groups,this.id))>=0&&delete e.groups[i];return this.objects={},this},addParents:function(t){var e,i,s;for(i=(s=n.isArray(t)?t:arguments).length,e=0;e<i;++e)n.isId(this.board,s[e])?this.parents.push(s[e]):n.exists(s[e].id)&&this.parents.push(s[e].id);this.parents=n.uniqueArray(this.parents)},setParents:function(t){this.parents=[],this.addParents(t)},getParents:function(){return n.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(t){var e;""!==t&&n.exists(this.objects[t])&&(this.coords[(e=this.objects[t].point).id]={usrCoords:e.coords.usrCoords.slice(0)})},update:function(t){var e,r,o,a,l,h,c,d,u,p=null;if(!this.needsUpdate)return this;if("nothing"===(t=this._update_find_drag_type()).action)return this._updateCoordsCache(t.id),this;if(p=this.objects[t.id].point,"translation"===t.action)d=[p.coords.usrCoords[1]-this.coords[t.id].usrCoords[1],p.coords.usrCoords[2]-this.coords[t.id].usrCoords[2]];else if("rotation"===t.action||"scaling"===t.action){if(n.isPoint(this[r="rotation"===t.action?"rotationCenter":"scaleCenter"]))u=this[r].coords.usrCoords.slice(1);else if("centroid"===this[r])u=this._update_centroid_center();else if(n.isArray(this[r]))u=this[r];else{if(!n.isFunction(this[r]))return this;u=this[r]()}if("rotation"===t.action)c=s.rad(this.coords[t.id].usrCoords.slice(1),u,this.objects[t.id].point),(d=this.board.create("transform",[c,u[0],u[1]],{type:"rotate"})).update();else{if("scaling"!==t.action)return this;if(a=s.distance(this.coords[t.id].usrCoords.slice(1),u),Math.abs(a)<i.eps)return this;a=s.distance(p.coords.usrCoords.slice(1),u)/a,l=this.scaleDirections[t.id].indexOf("x")>=0?a:1,h=this.scaleDirections[t.id].indexOf("y")>=0?a:1,(d=this.board.create("transform",[1,0,0,u[0]*(1-l),l,0,u[1]*(1-h),0,h],{type:"generic"})).update()}}for(e in this._update_apply_transformation(t,d),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(e))for(o in this.objects[e].descendants)this.objects[e].descendants.hasOwnProperty(o)&&(this.objects[e].descendants.needsUpdate=this.objects[e].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(e in this.board.updateElements(t),this.objects)this.objects.hasOwnProperty(e)&&this._updateCoordsCache(e);return this},_update_find_drag_type:function(){var t,s,r,o="nothing",a=[];for(t in this.objects)this.objects.hasOwnProperty(t)&&(s=this.objects[t].point).coords.distance(e.COORDS_BY_USER,this.coords[t])>i.eps&&a.push(s.id);return 0===a.length?{action:o,id:"",changed:a}:(s=this.objects[r=a[0]].point,a.length>1?o="translation":n.isInArray(this.rotationPoints,s)&&n.exists(this.rotationCenter)?o="rotation":n.isInArray(this.scalePoints,s)&&n.exists(this.scaleCenter)?o="scaling":n.isInArray(this.translationPoints,s)&&(o="translation"),{action:o,id:r,changed:a})},_update_centroid_center:function(){var t,e,i;for(i in t=[0,0],e=0,this.coords)this.coords.hasOwnProperty(i)&&(t[0]+=this.coords[i].usrCoords[1],t[1]+=this.coords[i].usrCoords[2],++e);return e>0&&(t[0]/=e,t[1]/=e),t},_update_apply_transformation:function(t,s){var r,o;for(r in this.objects)this.objects.hasOwnProperty(r)&&(n.exists(this.board.objects[r])?(o=this.objects[r].point).id!==t.id?"translation"===t.action?n.isInArray(t.changed,o.id)||o.coords.setCoordinates(e.COORDS_BY_USER,[this.coords[r].usrCoords[1]+s[0],this.coords[r].usrCoords[2]+s[1]]):"rotation"!==t.action&&"scaling"!==t.action||s.applyOnce([o]):"rotation"!==t.action&&"scaling"!==t.action||o.coords.setCoordinates(e.COORDS_BY_USER,i.matVecMult(s.matrix,this.coords[o.id].usrCoords)):delete this.objects[r])},addPoint:function(t){return this.objects[t.id]={point:this.board.select(t)},this._updateCoordsCache(t.id),this.translationPoints.push(t),t.groups.push(this.id),t.groups=n.uniqueArray(t.groups),this},addPoints:function(t){var e;for(e=0;e<t.length;e++)this.addPoint(t[e]);return this},addGroup:function(t){var e;for(e in t.objects)t.objects.hasOwnProperty(e)&&this.addPoint(t.objects[e].point);return this},removePoint:function(t){return delete this.objects[t.id],this},setRotationCenter:function(t){return this.rotationCenter=t,this},setRotationPoints:function(t){return this._setActionPoints("rotation",t)},addRotationPoint:function(t){return this._addActionPoint("rotation",t)},removeRotationPoint:function(t){return this._removeActionPoint("rotation",t)},setTranslationPoints:function(t){return this._setActionPoints("translation",t)},addTranslationPoint:function(t){return this._addActionPoint("translation",t)},removeTranslationPoint:function(t){return this._removeActionPoint("translation",t)},setScaleCenter:function(t){return this.scaleCenter=t,this},setScalePoints:function(t,e){var i,s,r;for(r=(i=n.isArray(t)?t:arguments).length,s=0;s<r;++s)this.scaleDirections[this.board.select(i[s]).id]=e||"xy";return this._setActionPoints("scale",t)},addScalePoint:function(t,e){return this._addActionPoint("scale",t),this.scaleDirections[this.board.select(t).id]=e||"xy",this},removeScalePoint:function(t){return this._removeActionPoint("scale",t)},_setActionPoints:function(t,e){var i,s,r;for(r=(i=n.isArray(e)?e:arguments).length,this[t+"Points"]=[],s=0;s<r;++s)this._addActionPoint(t,i[s]);return this},_addActionPoint:function(t,e){return this[t+"Points"].push(this.board.select(e)),this},_removeActionPoint:function(t,e){var i=this[t+"Points"].indexOf(this.board.select(e));return i>-1&&this[t+"Points"].splice(i,1),this},setProperty:function(){t.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var t;for(t in this.objects)this.objects.hasOwnProperty(t)&&this.objects[t].point.setAttribute.apply(this.objects[t].point,arguments);return this}}),t.createGroup=function(e,i,s){var r=n.copyAttributes(s,e.options,"group"),o=new t.Group(e,r.id,r.name,i,r);return o.elType="group",o.setParents(i),o},t.registerElement("group",t.createGroup),{Group:t.Group,createGroup:t.createGroup}})),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],(function(t,e,i,s,n){"use strict";return t.createLocus=function(t,s,n){var r,o;if(!i.isArray(s)||1!==s.length||!i.isPoint(s[0]))throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return o=s[0],(r=t.create("curve",[[null],[null]],n)).dontCallServer=!1,r.elType="locus",r.setParents([o.id]),r.updateDataArray=function(){var i,s,n;r.board.mode>0||(i=e.generatePolynomials(t,o,!0).join("|"))!==r.spe&&(r.spe=i,(s=function(t,e,i,s){r.dataX=t,r.dataY=e,r.eq=i,r.ctime=s,r.generatePolynomial=function(t){return function(e){var i,s="("+e.symbolic.x+")",n="("+e.symbolic.y+")",r=[];for(i=0;i<t.length;i++)r[i]=t[i].replace(/\*\*/g,"^").replace(/x/g,s).replace(/y/g,n);return r}}(i)})((n=e.geometricLocusByGroebnerBase(t,o,s)).datax,n.datay,n.polynomial,n.exectime))},r},t.registerElement("locus",t.createLocus),{createLocus:t.createLocus}})),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Image=function(i,s,n,r,a){this.constructor(i,n,e.OBJECT_TYPE_IMAGE,e.OBJECT_CLASS_OTHER),this.element=this.board.select(n.anchor),this.coordsConstructor(s),this.W=o.createFunction(a[0],this.board,""),this.H=o.createFunction(a[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*i.unitX),Math.abs(this.usrSize[1]*i.unitY)],this.url=r,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=t.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},t.Image.prototype=new s,o.copyPrototypeMethods(t.Image,a,"coordsConstructor"),t.extend(t.Image.prototype,{hasPoint:function(t,s){var r,o,a,l,h,c,d;return 0===this.transformations.length?(o=this.coords.scrCoords[2]-s,(r=t-this.coords.scrCoords[1])>=-(a=this.board.options.precision.hasPoint)&&r-this.size[0]<=a&&o>=-a&&o-this.size[1]<=a):(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board),0<=(c=(d=n.innerProduct)(h=[(l=l.usrCoords)[0]-this.span[0][0],l[1]-this.span[0][1],l[2]-this.span[0][2]],this.span[1]))&&c<=d(this.span[1],this.span[1])&&0<=(c=d(h,this.span[2]))&&c<=d(this.span[2],this.span[2]))},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var t,e,i=this.transformations.length,s=[];if(0===i)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],t=0;t<i;t++)for(e=0;e<3;e++)s[e]=n.matVecMult(this.transformations[t].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(t){var e;if(o.isArray(t))for(e=0;e<t.length;e++)this.transformations.push(t[e]);else this.transformations.push(t);return this},getParents:function(){var t=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return 0!==this.parents.length&&(t=this.parents),t},setSize:function(t,e){return this.W=o.createFunction(t,this.board,""),this.H=o.createFunction(e,this.board,""),this},W:function(){},H:function(){}}),t.createImage=function(e,i,s){var n,r,l=i[0],h=i[1],c=i[2];if(n=o.copyAttributes(s,e.options,"image"),!(r=a.create(t.Image,e,h,n,l,c)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==o.evaluate(n.rotate)&&r.addRotation(o.evaluate(n.rotate)),r},t.registerElement("image",t.createImage),{Image:t.Image,createImage:t.createImage}})),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Ticks=function(t,i,n){if(this.constructor(t.board,n,s.OBJECT_TYPE_TICKS,s.OBJECT_CLASS_OTHER),this.line=t,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],o.isFunction(i))throw this.ticksFunction=i,new Error("Function arguments are no longer supported.");o.isArray(i)?this.fixedTicks=i:((Math.abs(i)<e.eps||i<0)&&(i=n.defaultdistance),this.ticksFunction=this.makeTicksFunction(i),this.equidistant=!0),this.minTicksDistance=n.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},t.Ticks.prototype=new n,t.extend(t.Ticks.prototype,{makeTicksFunction:function(t){return function(){var e,i,s;return o.evaluate(this.visProp.insertticks)?((s=(i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-i.lower)<=6*(e=Math.pow(10,Math.floor(Math.log(.6*s)/Math.LN10)))&&(e*=.5),e):t}},hasPoint:function(t,i){var n,r,a=this.ticks&&this.ticks.length||0,l=this.board.options.precision.hasPoint+.5*o.evaluate(this.visProp.strokewidth);if(!o.evaluate(this.line.visProp.scalable))return!1;if(0!==this.line.stdform[1]&&0!==this.line.stdform[2]&&this.line.type!==s.OBJECT_TYPE_AXIS)return!1;for(n=0;n<a;n++)if((r=this.ticks[n])[2]&&!(0===this.line.stdform[1]&&Math.abs(r[0][0]-this.line.point1.coords.scrCoords[1])<e.eps||0===this.line.stdform[2]&&Math.abs(r[1][0]-this.line.point1.coords.scrCoords[2])<e.eps)&&(Math.abs(r[0][0]-r[0][1])>=1||Math.abs(r[1][0]-r[1][1])>=1))if(0===this.line.stdform[1]){if(Math.abs(i-.5*(r[1][0]+r[1][1]))<2*l&&r[0][0]-l<t&&t<r[0][1]+l)return!0}else if(0===this.line.stdform[2]&&Math.abs(t-.5*(r[0][0]+r[0][1]))<2*l&&r[1][0]-l<i&&i<r[1][1]+l)return!0;return!1},setPositionDirectly:function(t,i,s){var n,a,l=new r(t,i,this.board),h=new r(t,s,this.board),c=this.board.getBoundingBox();return o.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<e.eps&&Math.abs(l.usrCoords[1]*h.usrCoords[1])>e.eps?(c[0]*=n=h.usrCoords[1]/l.usrCoords[1],c[2]*=n,this.board.setBoundingBox(c,!1)):Math.abs(this.line.stdform[2])<e.eps&&Math.abs(l.usrCoords[2]*h.usrCoords[2])>e.eps&&(c[3]*=a=h.usrCoords[2]/l.usrCoords[2],c[1]*=a,this.board.setBoundingBox(c,!1)),this):this},calculateTicksCoordinates:function(){var t,i;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<e.eps&&Math.abs(this.dy)<e.eps))return t=this.getZeroCoordinates(),i=this.getLowerAndUpperBounds(t),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(t,i):this.generateFixedTicks(t,i),this},setTicksSizeVariables:function(){var t,e=.5*o.evaluate(this.visProp.majorheight),i=.5*o.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,t=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=e/t*this.board.unitX,this.dyMaj*=e/t*this.board.unitY,this.dxMin*=i/t*this.board.unitX,this.dyMin*=i/t*this.board.unitY,this.minStyle=o.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=o.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var t,e,n,a,l,h,c=o.evaluate(this.visProp.anchor);return this.line.type===s.OBJECT_TYPE_AXIS?i.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(n=this.line.point1.coords.usrCoords[0],t=this.line.point1.coords.usrCoords[1],e=this.line.point1.coords.usrCoords[2],h=this.line.point2.coords.usrCoords[0],a=this.line.point2.coords.usrCoords[1],l=this.line.point2.coords.usrCoords[2],"right"===c?this.line.point2.coords:"middle"===c?new r(s.COORDS_BY_USER,[.5*(n+h),.5*(t+a),.5*(e+l)],this.board):o.isNumber(c)?new r(s.COORDS_BY_USER,[n+(h-n)*c,t+(a-t)*c,e+(l-e)*c],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(t,n){var a,l,h,c,d,u=new r(s.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),p=new r(s.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),f=Math.abs(u.usrCoords[0])>=e.eps&&u.scrCoords[1]>=0&&u.scrCoords[1]<=this.board.canvasWidth&&u.scrCoords[2]>=0&&u.scrCoords[2]<=this.board.canvasHeight,m=Math.abs(p.usrCoords[0])>=e.eps&&p.scrCoords[1]>=0&&p.scrCoords[1]<=this.board.canvasWidth&&p.scrCoords[2]>=0&&p.scrCoords[2]<=this.board.canvasHeight,g=o.evaluate(this.line.visProp.straightfirst),b=o.evaluate(this.line.visProp.straightlast),y=o.evaluate(this.visProp.includeboundaries);return o.exists(n)||"tickdistance"===n?i.calcStraight(this.line,u,p,o.evaluate(this.line.visProp.margin)):i.calcLineDelimitingPoints(this.line,u,p),d=this.board.renderer.getPositionArrowHead(this.line,u,p,o.evaluate(this.line.visProp.strokewidth)),u.setCoordinates(s.COORDS_BY_SCREEN,[u.scrCoords[1]-d.d1x,u.scrCoords[2]-d.d1y]),p.setCoordinates(s.COORDS_BY_SCREEN,[p.scrCoords[1]-d.d2x,p.scrCoords[2]-d.d2y]),(h=this.getDistanceFromZero(t,u))<(c=this.getDistanceFromZero(t,p))?(a=h,g||!f||y||(a+=e.eps),l=c,b||!m||y||(l-=e.eps)):c<h?(a=c,b||!m||y||(a+=e.eps),l=h,g||!f||y||(l-=e.eps)):(a=0,l=0),{lower:a,upper:l}},getDistanceFromZero:function(t,n){var r=e.eps,a=t.distance(s.COORDS_BY_USER,n);return this.line.type===s.OBJECT_TYPE_AXIS?(e.relDif(t.usrCoords[1],n.usrCoords[1])>r&&t.usrCoords[1]-n.usrCoords[1]>r||e.relDif(t.usrCoords[2],n.usrCoords[2])>r&&t.usrCoords[2]-n.usrCoords[2]>r)&&(a*=-1):"right"===o.evaluate(this.visProp.anchor)?i.isSameDirection(t,this.line.point1.coords,n)&&(a*=-1):i.isSameDirection(t,this.line.point2.coords,n)||(a*=-1),a},generateEquidistantTicks:function(t,i){var s,n=this.getXandYdeltas(),r=this.equidistant?this.ticksFunction(1):this.ticksDelta,a=o.evaluate(this.visProp.insertticks),l=o.evaluate(this.visProp.minorticks);if(r*=o.evaluate(this.visProp.scale),a&&this.minTicksDistance>e.eps?(r=this.adjustTickDistance(r,t,n),r/=l+1):a||(r/=l+1),this.ticksDelta=r,!(r<e.eps)){for(s=0,o.evaluate(this.visProp.drawzero)||(s=r);s<=i.upper;)s>=i.lower&&this.processTickPosition(t,s,r,n),s+=r;for(s=-r;s>=i.lower;)s<=i.upper&&this.processTickPosition(t,s,r,n),s-=r}},adjustTickDistance:function(t,e,i){var n,a=1,l=o.evaluate(this.visProp.minorticks);for(this.getLowerAndUpperBounds(e,"ticksdistance"),n=e.distance(s.COORDS_BY_SCREEN,new r(s.COORDS_BY_USER,[e.usrCoords[1]+i.x*t,e.usrCoords[2]+i.y*t],this.board));n/(l+1)<this.minTicksDistance;)t*=1===a?2:5,a*=-1,n=e.distance(s.COORDS_BY_SCREEN,new r(s.COORDS_BY_USER,[e.usrCoords[1]+i.x*t,e.usrCoords[2]+i.y*t],this.board));return t},processTickPosition:function(t,e,i,n){var a,l;(a=new r(s.COORDS_BY_USER,[t.usrCoords[1]+e*n.x,t.usrCoords[2]+e*n.y],this.board)).major=Math.round(e/i)%(o.evaluate(this.visProp.minorticks)+1)==0,3===(l=this.tickEndings(a,a.major)).length&&(this.ticks.push(l),a.major&&o.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(a,t),a,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(t,e){var i,n,a,l,h=o.isArray(this.visProp.labels),c=this.getXandYdeltas(),d=o.evaluate(this.visProp.drawlabels);for(a=0;a<this.fixedTicks.length;a++)i=new r(s.COORDS_BY_USER,[t.usrCoords[1]+this.fixedTicks[a]*c.x,t.usrCoords[2]+this.fixedTicks[a]*c.y],this.board),3===(l=this.tickEndings(i,!0)).length&&this.fixedTicks[a]>=e.lower&&this.fixedTicks[a]<=e.upper&&(this.ticks.push(l),d&&(h||o.exists(this.visProp.labels[a]))?(n=h?o.evaluate(this.visProp.labels[a]):this.fixedTicks[a],this.labelsData.push(this.generateLabelData(this.generateLabelText(i,t,n),i,a))):this.labelsData.push(null))},getXandYdeltas:function(){var t,i,n=this.line.point1.Dist(this.line.point2);return this.line.type===s.OBJECT_TYPE_AXIS?((t=this.line.point1.coords.usrCoords)[1]>(i=this.line.point2.coords.usrCoords)[1]||Math.abs(t[1]-i[1])<e.eps&&t[2]>i[2])&&(t=this.line.point2.coords.usrCoords,i=this.line.point1.coords.usrCoords):(t=this.line.point1.coords.usrCoords,i=this.line.point2.coords.usrCoords),{x:(i[1]-t[1])/n,y:(i[2]-t[2])/n}},_isInsideCanvas:function(t,e,i){var s=this.board.canvasWidth,n=this.board.canvasHeight;return void 0===i&&(i=0),t[0]>=i&&t[0]<=s-i&&e[0]>=i&&e[0]<=n-i||t[1]>=i&&t[1]<=s-i&&e[1]>=i&&e[1]<=n-i},tickEndings:function(t,e){var s,n,r,a,l,h=[-2e6,-2e6],c=[-2e6,-2e6];return s=t.scrCoords,e?(r=this.dxMaj,a=this.dyMaj,l=this.majStyle):(r=this.dxMin,a=this.dyMin,l=this.minStyle),"infinite"===l?(n=i.meetLineBoard([-a*s[1]-r*s[2],a,r],this.board),h[0]=n[0].scrCoords[1],h[1]=n[1].scrCoords[1],c[0]=n[0].scrCoords[2],c[1]=n[1].scrCoords[2]):(h[0]=s[1]+r*o.evaluate(this.visProp.tickendings[0]),c[0]=s[2]-a*o.evaluate(this.visProp.tickendings[0]),h[1]=s[1]-r*o.evaluate(this.visProp.tickendings[1]),c[1]=s[2]+a*o.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(h,c)?[h,c,e]:[]},formatLabelText:function(t){var e=t.toString(),i=o.evaluate(this.visProp.scalesymbol);return o.isNumber(t)&&((e.length>o.evaluate(this.visProp.maxlabellength)||-1!==e.indexOf("e"))&&(e=t.toPrecision(o.evaluate(this.visProp.precision)).toString()),e.indexOf(".")>-1&&-1===e.indexOf("e")&&(e=(e=e.replace(/0+$/,"")).replace(/\.$/,""))),i.length>0&&("1"===e?e=i:"-1"===e?e="-"+i:"0"!==e&&(e+=i)),o.evaluate(this.visProp.useunicodeminus)&&(e=e.replace(/-/g,"−")),e},generateLabelText:function(t,i,s){var n,r=this.getDistanceFromZero(i,t);return Math.abs(r)<e.eps?n="0":(o.exists(s)||(s=r/o.evaluate(this.visProp.scale)),n=this.formatLabelText(s)),n},generateLabelData:function(t,e,i){var s,n,r,a;return r=void 0===(a=o.evaluate(this.visProp.label.fontsize))?12:a,this._isInsideCanvas(s=[e.scrCoords[1],e.scrCoords[1]],n=[e.scrCoords[2],e.scrCoords[2]],r*=1.5)?(s=o.evaluate(this.visProp.label.offset[0]),n=o.evaluate(this.visProp.label.offset[1]),{x:e.usrCoords[1]+s/this.board.unitX,y:e.usrCoords[2]+n/this.board.unitY,t:t,i:i}):null},update:function(){return this.needsUpdate&&0!==this.board.canvasWidth&&0!==this.board.canvasHeight&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var t,e,i,s,n,r,l,h;for(i=this.labelsData.length,s=this.labels.length,t=0,e=0;t<i;t++)null!==this.labelsData[t]&&(l=this.labelsData[t],e<s?((r=this.labels[e]).setText(l.t),r.setCoords(l.x,l.y),e++):(this.labelCounter+=1,(n=o.deepCopy(n={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},this.visProp.label)).id=this.id+l.i+"Label"+this.labelCounter,(r=a.createText(this.board,[l.x,l.y,l.t],n)).isDraggable=!1,r.dump=!1,this.labels.push(r)),"inherit"===(h=o.evaluate(this.visProp.label.visible))&&(h=this.visPropCalc.visible),r.prepareUpdate().updateVisibility(h).updateRenderer(),r.distanceX=o.evaluate(this.visProp.label.offset[0]),r.distanceY=o.evaluate(this.visProp.label.offset[1]));for(e=i=e;e<s;e++)this.board.renderer.display(this.labels[e],!1),this.labels[e].visProp.visible=!1;return this},hideElement:function(){var e;for(t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),e=0;e<this.labels.length;e++)o.exists(this.labels[e])&&this.labels[e].hideElement();return this},showElement:function(){var e;for(t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),e=0;e<this.labels.length;e++)o.exists(this.labels[e])&&this.labels[e].showElement();return this}}),t.createTicks=function(e,i,n){var r,a,l=o.copyAttributes(n,e.options,"ticks");if(a=i.length<2?l.ticksdistance:i[1],i[0].elementClass!==s.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof i[0]+"'.");return r=new t.Ticks(i[0],a,l),o.isFunction(l.generatelabelvalue)&&(r.generateLabelText=l.generatelabelvalue),o.isFunction(l.generatelabeltext)&&(r.generateLabelText=l.generatelabeltext),r.setParents(i[0]),r.isDraggable=!0,r.fullUpdate(i[0].visPropCalc.visible),r},t.createHatchmark=function(t,e,i){var n,r,a,l,h,c=[],d=o.copyAttributes(i,t.options,"hatch");if(e[0].elementClass!==s.OBJECT_CLASS_LINE||"number"!=typeof e[1])throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof e[0]+"' and '"+typeof e[1]+" and ''"+typeof e[2]+"'.");for(a=-((n=e[1])-1)*(l=d.ticksdistance)*.5,r=0;r<n;r++)c[r]=a+r*l;return(h=t.create("ticks",[e[0],c],d)).elType="hatch",h},t.registerElement("ticks",t.createTicks),t.registerElement("hash",t.createHatchmark),t.registerElement("hatch",t.createHatchmark),{Ticks:t.Ticks,createTicks:t.createTicks,createHashmark:t.createHatchmark,createHatchmark:t.createHatchmark}})),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],(function(t,e,i,s,n,r,o,a,l,h){"use strict";return t.createSlider=function(t,r,o){var a,l,h,c,d,u,p,f,m,g,b,y,v,C,x,_,P,S,w,E;return P=(w=s.copyAttributes(o,t.options,"slider")).withticks,_=w.withlabel,S=w.snapwidth,E=w.precision,w=s.copyAttributes(o,t.options,"slider","point1"),p=t.create("point",r[0],w),w=s.copyAttributes(o,t.options,"slider","point2"),f=t.create("point",r[1],w),w=s.copyAttributes(o,t.options,"slider","baseline"),(m=t.create("segment",[p,f],w)).updateStdform(),a=p.coords.usrCoords.slice(1),l=f.coords.usrCoords.slice(1),u=(d=r[2][2])-(h=r[2][0]),b=a[0]+(l[0]-a[0])*((c=r[2][1])-h)/(d-h),y=a[1]+(l[1]-a[1])*(c-h)/(d-h),(w=s.copyAttributes(o,t.options,"slider")).withLabel=!1,(v=t.create("glider",[b,y,m],w)).setAttribute({snapwidth:S}),w=s.copyAttributes(o,t.options,"slider","highline"),C=t.create("segment",[p,v],w),v.Value=function(){var t=this._smax-this._smin,e=s.evaluate(this.visProp.snapwidth);return-1===e?this.position*t+this._smin:Math.round((this.position*t+this._smin)/e)*e},v.methodMap=s.deepCopy(v.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),v._smax=d,v._smin=h,v.setMax=function(t){return this._smax=t,this},v.setValue=function(t){var i=this._smax-this._smin;return this.position=Math.abs(i)>e.eps?(t-this._smin)/i:0,this.position=Math.max(0,Math.min(1,this.position)),this},v.setMin=function(t){return this._smin=t,this},_&&(w=s.copyAttributes(o,t.options,"slider","label"),x=t.create("text",[function(){return.05*(f.X()-p.X())+f.X()},function(){return.05*(f.Y()-p.Y())+f.Y()},function(){var t,e=s.evaluate(v.visProp.suffixlabel),i=s.evaluate(v.visProp.unitlabel),n=s.evaluate(v.visProp.postlabel);return t=null!==e?e:v.name&&""!==v.name?v.name+" = ":"",t+=s.toFixed(v.Value(),E),null!==i&&(t+=i),null!==n&&(t+=n),t}],w),v.label=x,v.visProp.withlabel=!0,v.hasLabel=!0),v.point1=p,v.point2=f,v.baseline=m,v.highline=C,P&&(w=s.copyAttributes(o,t.options,"slider","ticks"),s.exists(w.generatelabeltext)||(w.generateLabelText=function(t,i,s){var n=v.point1.Dist(v.point2),r=v._smin,o=v._smax,a=this.getDistanceFromZero(i,t)*(o-r)/n+r;return n<e.eps||Math.abs(a)<e.eps?"0":this.formatLabelText(a)}),g=t.create("ticks",[v.baseline,v.point1.Dist(p)/2,function(t){var s=v.point1.Dist(v.point2),n=v.point1.coords.distance(i.COORDS_BY_USER,t);return s<e.eps?0:n/s*u+h}],w),v.ticks=g),v.remove=function(){_&&t.removeObject(x),t.removeObject(C),t.removeObject(m),t.removeObject(f),t.removeObject(p),n.Point.prototype.remove.call(v)},p.dump=!1,f.dump=!1,m.dump=!1,C.dump=!1,v.elType="slider",v.parents=r,v.subs={point1:p,point2:f,baseLine:m,highLine:C},v.inherits.push(p,f,m,C),P&&(g.dump=!1,v.subs.ticks=g,v.inherits.push(g)),v},t.registerElement("slider",t.createSlider),{createSlider:t.createSlider}})),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],(function(t,e,i,s,n,r){"use strict";return t.createTapemeasure=function(s,n,r){var o,a,l,h,c,d,u,p,f,m,g;return o=n[0],a=n[1],l=e.copyAttributes(r,s.options,"tapemeasure","point1"),p=s.create("point",o,l),l=e.copyAttributes(r,s.options,"tapemeasure","point2"),f=s.create("point",a,l),p.setAttribute({ignoredSnapToPoints:[f]}),f.setAttribute({ignoredSnapToPoints:[p]}),l=e.copyAttributes(r,s.options,"tapemeasure"),h=l.withticks,d=l.precision,(c=l.withlabel)&&(l.withlabel=!0),u=s.create("segment",[p,f],l),c&&(m=r.name&&""!==r.name?r.name+" = ":"",u.label.setText((function(){return m+e.toFixed(p.Dist(f),d)}))),h&&(l=e.copyAttributes(r,s.options,"tapemeasure","ticks"),g=s.create("ticks",[u,.1],l),u.inherits.push(g)),u.remove=function(){h&&u.removeTicks(g),s.removeObject(f),s.removeObject(p),i.prototype.remove.call(this)},u.Value=function(){return p.Dist(f)},p.dump=!1,f.dump=!1,u.elType="tapemeasure",u.getParents=function(){return[[p.X(),p.Y()],[f.X(),f.Y()]]},u.subs={point1:p,point2:f},h&&(g.dump=!1),u.methodMap=t.deepCopy(u.methodMap,{Value:"Value"}),u.prepareUpdate().update(),s.isSuspendedUpdate||(u.updateVisibility().updateRenderer(),u.point1.updateVisibility().updateRenderer(),u.point2.updateVisibility().updateRenderer()),u},t.registerElement("tapemeasure",t.createTapemeasure),{createTapemeasure:t.createTapemeasure}})),define("parser/datasource",["jxg","utils/type"],(function(t,e){"use strict";return t.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},t.extend(t.DataSource.prototype,{loadFromArray:function(t,i,s){var n,r,o;if(e.isArray(i)&&(this.columnHeaders=i,i=!1),e.isArray(s)&&(this.rowHeaders=s,s=!1),this.data=[],i&&(this.columnHeaders=[]),s&&(this.rowHeaders=[]),e.exists(t)){for(this.data=[],n=0;n<t.length;n++)for(this.data[n]=[],r=0;r<t[n].length;r++)o=t[n][r],this.data[n][r]=parseFloat(o).toString()===o?parseFloat(o):"-"!==o?o:NaN;if(i&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),s)for(this.rowHeaders=[],n=0;n<this.data.length;n++)this.rowHeaders.push(this.data[n][0]),this.data[n]=this.data[n].slice(1)}return this},loadFromTable:function(t,i,s){var n,r,o,a,l;if(e.isArray(i)&&(this.columnHeaders=i,i=!1),e.isArray(s)&&(this.rowHeaders=s,s=!1),this.data=[],i&&(this.columnHeaders=[]),s&&(this.rowHeaders=[]),t=document.getElementById(t),e.exists(t)){for(n=t.getElementsByTagName("tr"),this.data=[],r=0;r<n.length;r++)for(a=n[r].getElementsByTagName("td"),this.data[r]=[],o=0;o<a.length;o++)l=a[o].innerHTML,this.data[r][o]=parseFloat(l).toString()===l?parseFloat(l):"-"!==l?l:NaN;if(i&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),s)for(this.rowHeaders=[],r=0;r<this.data.length;r++)this.rowHeaders.push(this.data[r][0]),this.data[r]=this.data[r].slice(1)}return this},addColumn:function(t,e,i){throw new Error("not implemented")},addRow:function(t,e,i){throw new Error("not implemented")},getColumn:function(t){var i,s=[];if(e.isString(t))for(i=0;i<this.columnHeaders.length;i++)if(t===this.columnHeaders[i]){t=i;break}for(i=0;i<this.data.length;i++)this.data[i].length>t&&(s[i]=parseFloat(this.data[i][t]));return s},getRow:function(t){var i,s;if(e.isString(t))for(s=0;s<this.rowHeaders.length;s++)if(t===this.rowHeaders[s]){t=s;break}for(i=[],s=0;s<this.data[t].length;s++)i[s]=this.data[t][s];return i}}),t.DataSource})),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],(function(t,e,i,s,n,r,o,a,l,h,c,d,u,p,f,m,g,b){"use strict";return t.Chart=function(t,e,i){var s,n,r,o,a,h;if(this.constructor(t,i),!l.isArray(e)||0===e.length)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],l.isNumber(e[0]))for(n=e,s=[],r=0;r<n.length;r++)s[r]=r+1;else if(1===e.length&&l.isArray(e[0]))for(s=[],h=l.evaluate(n=e[0]).length,r=0;r<h;r++)s[r]=r+1;else 2===e.length&&(h=Math.min(e[0].length,e[1].length),s=e[0].slice(0,h),n=e[1].slice(0,h));if(l.isArray(n)&&0===n.length)throw new Error("JSXGraph: Can't create charts without data.");for(a=i.chartstyle.replace(/ /g,"").split(","),r=0;r<a.length;r++){switch(a[r]){case"bar":o=this.drawBar(t,s,n,i);break;case"line":o=this.drawLine(t,s,n,i);break;case"fit":o=this.drawFit(t,s,n,i);break;case"spline":o=this.drawSpline(t,s,n,i);break;case"pie":o=this.drawPie(t,n,i);break;case"point":o=this.drawPoints(t,s,n,i);break;case"radar":o=this.drawRadar(t,e,i)}this.elements.push(o)}return this.id=this.board.setId(this,"Chart"),this.elements},t.Chart.prototype=new r,t.extend(t.Chart.prototype,{drawLine:function(t,e,i,s){return s.fillcolor="none",s.highlightfillcolor="none",t.create("curve",[e,i],s)},drawSpline:function(t,e,i,s){return s.fillColor="none",s.highlightfillcolor="none",t.create("spline",[e,i],s)},drawFit:function(t,i,s,n){var r=n.degree;return r=Math.max(parseInt(r,10),1)||1,n.fillcolor="none",n.highlightfillcolor="none",t.create("functiongraph",[e.regressionPolynomial(r,i,s)],n)},drawBar:function(t,e,i,s){var n,r,o,a,h,c,d,u,p,f,m=[],g=[],b=function(t,i){return function(){return e[t]()-i*o}},y={fixed:!0,withLabel:!1,visible:!1,name:""};if((p=l.copyAttributes(s,t.options,"chart"))&&p.width)o=p.width;else{if(e.length<=1)o=1;else for(o=e[1]-e[0],n=1;n<e.length-1;n++)o=e[n+1]-e[n]<o?e[n+1]-e[n]:o;o*=.8}for(f=l.copyAttributes(s,t.options,"chart","label"),n=0;n<e.length;n++)l.isFunction(e[n])?(a=b(n,-.5),h=b(n,0),c=b(n,.5)):(a=e[n]-.5*o,h=e[n],c=e[n]+.5*o),l.isFunction(i[n])&&i[n](),d=i[n],"horizontal"===p.dir?(g[0]=t.create("point",[0,a],y),g[1]=t.create("point",[d,a],y),g[2]=t.create("point",[d,c],y),g[3]=t.create("point",[0,c],y),l.exists(p.labels)&&l.exists(p.labels[n])&&(f.anchorY="middle",(r=t.create("text",[d,h,p.labels[n]],f)).visProp.anchorx=function(t){return function(){return t.X()>=0?"left":"right"}}(r))):(g[0]=t.create("point",[a,0],y),g[1]=t.create("point",[a,d],y),g[2]=t.create("point",[c,d],y),g[3]=t.create("point",[c,0],y),l.exists(p.labels)&&l.exists(p.labels[n])&&(f.anchorX="middle",(r=t.create("text",[h,d,p.labels[n]],f)).visProp.anchory=function(t){return function(){return t.Y()>=0?"bottom":"top"}}(r))),l.isArray(p.colors)&&(p.fillcolor=(u=p.colors)[n%u.length]),m[n]=t.create("polygon",g,p),l.exists(p.labels)&&l.exists(p.labels[n])&&(m[n].text=r);return m},drawPoints:function(t,e,i,s){var n,r=[],o=s.infoboxarray;for(s.fixed=!0,s.name="",n=0;n<e.length;n++)s.infoboxtext=!!o&&o[n%o.length],r[n]=t.create("point",[e[n],i[n]],s);return r},drawPie:function(t,e,r){var o,a,h=[],c=[],d=(i.sum(e),r.colors),u=r.highlightcolors,p=r.labels,f=r.radius||4,m=f,g=r.center||[0,0],b=g[0],y=g[1],v=function(t,i,s){return function(){var n,r,o,a=0;for(r=0;r<=t;r++)a+=parseFloat(l.evaluate(e[r]));for(n=a,r=t+1;r<e.length;r++)n+=parseFloat(l.evaluate(e[r]));return o=0!==n?2*Math.PI*a/n:0,m()*Math[i](o)+s}},C=function(t,e){var i=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],r=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];l.exists(this.label)&&(this.label.rendNode.style.fontSize=e*l.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new n(s.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+i*t,this.point1.coords.usrCoords[2]+r*t],this.board),this.fullUpdate()},x=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),C.call(this,1.1,2))},_=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),C.call(this,.9090909,1))},P={fixed:!0,withLabel:!1,visible:!1,name:""};if(!l.isArray(p))for(p=[],o=0;o<e.length;o++)p[o]="";for(l.isFunction(f)||(m=function(){return f}),r.highlightonsector=r.highlightonsector||!1,r.straightfirst=!1,r.straightlast=!1,a=t.create("point",[b,y],P),h[0]=t.create("point",[function(){return m()+b},function(){return y}],P),o=0;o<e.length;o++)h[o+1]=t.create("point",[v(o,"cos",b),v(o,"sin",y)],P),r.name=p[o],r.withlabel=""!==r.name,r.fillcolor=d&&d[o%d.length],r.labelcolor=d&&d[o%d.length],r.highlightfillcolor=u&&u[o%u.length],c[o]=t.create("sector",[a,h[o],h[o+1]],r),r.highlightonsector&&(c[o].hasPoint=c[o].hasPointSector),r.highlightbysize&&(c[o].highlight=x,c[o].noHighlight=_);return{sectors:c,points:h,midpoint:a}},drawRadar:function(e,i,r){var o,a,h,c,d,u,p,f,m,g,b,y,v,C,x,_,P,S,w,E,k,A,T,M,O,N,L,D,j,I,R,B,F,Y,z,X,U,G,H,q=i.length,J=function(){var t,e,i,r,o=l.evaluate(this.visProp.label.offset).slice(0);return t=this.point1.X(),e=this.point2.X(),i=this.point1.Y(),r=this.point2.Y(),e<t&&(o[0]=-o[0]),r<i&&(o[1]=-o[1]),this.setLabelRelativeCoords(o),new n(s.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},V=function(t,i){var s,n,r;return s=e.create("transform",[-(x[i]-v[i]),0],{type:"translate"}),n=e.create("transform",[w/(_[i]+C[i]-(x[i]-v[i])),1],{type:"scale"}),s.melt(n),r=e.create("transform",[t],{type:"rotate"}),s.melt(r),s};if(q<=0)t.debug("No data");else if(l.exists(h=r.paramarray))if((c=h.length)<=1)t.debug("Need more than 1 param");else{for(o=0;o<q;o++)if(c!==i[o].length)return void t.debug("Use data length equal to number of params ("+i[o].length+" != "+c+")");for(d=[],u=[],a=0;a<c;a++)d[a]=i[0][a],u[a]=d[a];for(o=1;o<q;o++)for(a=0;a<c;a++)i[o][a]>d[a]&&(d[a]=i[o][a]),i[o][a]<u[a]&&(u[a]=i[o][a]);for(p=[],f=[],o=0;o<q;o++)p[o]="",f[o]=[];for(m=[],g=[],b=r.startshiftratio||0,y=r.endshiftratio||0,o=0;o<c;o++)m[o]=(d[o]-u[o])*b,g[o]=(d[o]-u[o])*y;if(v=r.startshiftarray||m,C=r.endshiftarray||g,x=r.startarray||u,l.exists(r.start))for(o=0;o<c;o++)x[o]=r.start;if(_=r.endarray||d,l.exists(r.end))for(o=0;o<c;o++)_[o]=r.end;if(v.length===c)if(C.length===c)if(x.length===c){if(_.length===c){for(P=r.labelarray||p,S=r.colors,w=r.radius||10,H=r.strokewidth||1,l.exists(r.highlightonsector)||(r.highlightonsector=!1),E={name:r.name,id:r.id,strokewidth:H,polystrokewidth:r.polystrokewidth||H,strokecolor:r.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:r.fillColor||"#FFFF88",fillopacity:r.fillOpacity||.4,highlightfillcolor:r.highlightFillColor||"#FF7400",highlightstrokecolor:r.highlightStrokeColor||"black",gradient:r.gradient||"none"},M=e.create("point",[A=(k=r.center||[0,0])[0],T=k[1]],{name:"",fixed:!0,withlabel:!1,visible:!1}),Math,Math,N=O=r.startangle||0,L=[],D=[],o=0;o<c;o++)for(N+=2*Math.PI/c,I=w*Math.cos(N)+A,R=w*Math.sin(N)+T,L[o]=e.create("point",[I,R],{name:"",fixed:!0,withlabel:!1,visible:!1}),D[o]=e.create("line",[M,L[o]],{name:h[o],strokeColor:E.strokecolor,strokeWidth:E.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:E.highlightstrokecolor}),D[o].getLabelAnchor=J,j=V(N,o),a=0;a<i.length;a++)f[a][o]=e.create("point",[i[a][o],0],{name:"",fixed:!0,withlabel:!1,visible:!1}),f[a][o].addTransform(f[a][o],j);for(B=[],o=0;o<q;o++)for(E.labelcolor=S&&S[o%S.length],E.strokecolor=S&&S[o%S.length],E.fillcolor=S&&S[o%S.length],B[o]=e.create("polygon",f[o],{withLines:!0,withLabel:!1,fillColor:E.fillcolor,fillOpacity:E.fillopacity,highlightFillColor:E.highlightfillcolor}),a=0;a<c;a++)B[o].borders[a].setAttribute("strokecolor:"+S[o%S.length]),B[o].borders[a].setAttribute("strokewidth:"+E.polystrokewidth);switch(r.legendposition||"none"){case"right":this.legend=e.create("legend",[A+w+(r.legendleftoffset||2),T+w-(r.legendtopoffset||1)],{labels:P,colors:S});break;case"none":break;default:t.debug("Unknown legend position")}if(F=[],r.showcircles){for(Y=[],o=0;o<6;o++)Y[o]=20*o;if(Y[0]="0",(X=(z=r.circlelabelarray||Y).length)<2)return void t.debug("Too less circles");for(U=[],j=V(O+Math.PI/c,0),E.fillcolor="none",E.highlightfillcolor="none",E.strokecolor=r.strokecolor||"black",E.strokewidth=r.circlestrokewidth||.5,E.layer=0,G=(_[0]-x[0])/(X-1),o=0;o<X;o++)U[o]=e.create("point",[x[0]+o*G,0],{name:z[o],size:0,fixed:!0,withLabel:!0,visible:!0}),U[o].addTransform(U[o],j),F[o]=e.create("circle",[M,U[o]],E)}return this.rendNode=B[0].rendNode,{circles:F,lines:D,points:f,midpoint:M,polygons:B}}t.debug("Ends length is not equal to number of parameters")}else t.debug("Starts length is not equal to number of parameters");else t.debug("End shifts length is not equal to number of parameters");else t.debug("Start shifts length is not equal to number of parameters")}else t.debug("Need paramArray attribute")},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),t.createChart=function(e,i,s){var n,r,c,d,u,p,f,m,g,b,y,v,C,x,_,P,S=[],w=h.isBrowser?e.document.getElementById(i[0]):null;if(1===i.length&&l.isString(i[0])){if(l.exists(w)){if(g=l.copyAttributes(s,e.options,"chart"),n=(w=(new o).loadFromTable(i[0],g.withheaders,g.withheaders)).data,u=w.columnHeaders,r=w.rowHeaders,b=g.width,y=g.name,v=g.strokecolor,C=g.fillcolor,x=g.highlightstrokecolor,_=g.highlightfillcolor,e.suspendUpdate(),P=n.length,m=[],g.rows&&l.isArray(g.rows)){for(c=0;c<P;c++)for(d=0;d<g.rows.length;d++)if(g.rows[d]===c||g.withheaders&&g.rows[d]===r[c]){m.push(n[c]);break}}else m=n;for(P=m.length,c=0;c<P;c++){if(f=[],g.chartstyle&&-1!==g.chartstyle.indexOf("bar")){for(f.push(1-(p=b||.8)/2+(c+.5)*p/P),d=1;d<m[c].length;d++)f.push(f[d-1]+1);g.width=p/P}y&&y.length===P?g.name=y[c]:g.withheaders&&(g.name=u[c]),g.strokecolor=v&&v.length===P?v[c]:a.hsv2rgb((c+1)/P*360,.9,.6),g.fillcolor=C&&C.length===P?C[c]:a.hsv2rgb((c+1)/P*360,.9,1),g.highlightstrokecolor=x&&x.length===P?x[c]:a.hsv2rgb((c+1)/P*360,.9,1),g.highlightfillcolor=_&&_.length===P?_[c]:a.hsv2rgb((c+1)/P*360,.9,.6),g.chartstyle&&-1!==g.chartstyle.indexOf("bar")?S.push(new t.Chart(e,[f,m[c]],g)):S.push(new t.Chart(e,[m[c]],g))}e.unsuspendUpdate()}return S}return g=l.copyAttributes(s,e.options,"chart"),new t.Chart(e,i,g)},t.registerElement("chart",t.createChart),t.Legend=function(t,e,i){var r;if(this.constructor(),r=l.copyAttributes(i,t.options,"legend"),this.board=t,this.coords=new n(s.COORDS_BY_USER,e,this.board),this.myAtts={},this.label_array=r.labelarray||r.labels,this.color_array=r.colorarray||r.colors,this.lines=[],this.myAtts.strokewidth=r.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=r.legendstyle||r.style,"vertical"!==this.style)throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(t,r)},t.Legend.prototype=new r,t.Legend.prototype.drawVerticalLegend=function(t,e){var i,r=e.linelength||1,o=(e.rowheight||20)/this.board.unitY,a=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new n(s.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(i=0;i<this.label_array.length;i++)this.myAtts.strokecolor=this.color_array[i],this.myAtts.highlightstrokecolor=this.color_array[i],this.myAtts.name=this.label_array[i],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[i],strokeWidth:this.myAtts.strokewidth},this.lines[i]=t.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-i*o],[this.coords.usrCoords[1]+r,this.coords.usrCoords[2]-i*o]],this.myAtts),this.lines[i].getLabelAnchor=a},t.createLegend=function(e,i,s){var n=[0,0];return l.exists(i)&&2===i.length&&(n=i),new t.Legend(e,n,s)},t.registerElement("legend",t.createLegend),{Chart:t.Chart,Legend:t.Legend,createChart:t.createChart,createLegend:t.createLegend}})),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Turtle=function(t,i,n){var r,o,a;return this.constructor(t,n,e.OBJECT_TYPE_TURTLE,e.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=t,this.visProp.curveType="plot",this._attributes=s.copyAttributes(this.visProp,t.options,"turtle"),delete this._attributes.id,r=0,o=0,a=90,0!==i.length&&(3===i.length?(r=i[0],o=i[1],a=i[2]):2===i.length?s.isArray(i[0])?(r=i[0][0],o=i[0][1],a=i[1]):(r=i[0],o=i[1]):(r=i[0][0],o=i[0][1])),this.init(r,o,a),this.methodMap=s.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},t.Turtle.prototype=new i,t.extend(t.Turtle.prototype,{init:function(t,e,i){var s={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[t,e],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,s),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],s),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-i),this.board.update()},forward:function(t){if(0===t)return this;var e,i=t*Math.cos(this.dir*Math.PI/180),s=t*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((e=this.board.create("transform",[i,s],{type:"translate"})).applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=i,this.pos[1]+=s,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(t){return this.forward(-t)},right:function(t){return this.dir-=t,this.dir%=360,this.turtleIsHidden||this.board.create("transform",[-t*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(t){return this.right(-t)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var t,i;for(t=0;t<this.objects.length;t++)(i=this.objects[t]).type===e.OBJECT_TYPE_CURVE&&(this.board.removeObject(i),this.objects.splice(t,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var t,e=this.objects.length;for(t=0;t<e;t++)this.board.removeObject(this.objects[t]);return this.init(0,0,90),this},setPos:function(t,i){return this.pos=s.isArray(t)?t:[t,i],this.turtleIsHidden||(this.turtle.setPositionDirectly(e.COORDS_BY_USER,[t,i]),this.turtle2.setPositionDirectly(e.COORDS_BY_USER,[t,i+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",t)),this.objects.push(this.curve),this},setPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",t)),this.objects.push(this.curve),this},setHighlightPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",t)),this.objects.push(this.curve),this},setAttribute:function(t){var i,n,r,o=this.objects.length;for(i=0;i<o;i++)(n=this.objects[i]).type===e.OBJECT_TYPE_CURVE&&n.setAttribute(t);return r=this.visProp.id,this.visProp=s.deepCopy(this.curve.visProp),this.visProp.id=r,this._attributes=s.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(t,e){return this._attributes[t.toLowerCase()]=e,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var t=this.stack.pop();return this.pos[0]=t[0],this.pos[1]=t[1],this.dir=t[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(t){var e;return s.isArray(t)?(e=Math.atan2(t[1]-this.pos[1],t[0]-this.pos[0]),this.right(this.dir-180*e/Math.PI)):s.isNumber(t)&&this.right(this.dir-t),this},moveTo:function(t){var e;return s.isArray(t)&&(this.turtleIsHidden||((e=this.board.create("transform",[t[0]-this.pos[0],t[1]-this.pos[1]],{type:"translate"})).applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=t[0],this.pos[1]=t[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(t){return this.forward(t)},bk:function(t){return this.back(t)},lt:function(t){return this.left(t)},rt:function(t){return this.right(t)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(t,i){var s,n,r,o=this.objects.length;for(s=0,n=0;s<o;s++)if((r=this.objects[s]).elementClass===e.OBJECT_CLASS_CURVE){if(n<=t&&t<n+r.numberPoints)return r[i](t-n);n+=r.numberPoints}return this[i]()},X:function(t){return s.exists(t)?this.evalAt(t,"X"):this.pos[0]},Y:function(t){return s.exists(t)?this.evalAt(t,"Y"):this.pos[1]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){var t,i=this.objects.length,s=0;for(t=0;t<i;t++)this.objects[t].elementClass===e.OBJECT_CLASS_CURVE&&(s+=this.objects[t].numberPoints);return s},hasPoint:function(t,i){var s,n;for(s=0;s<this.objects.length;s++)if((n=this.objects[s]).type===e.OBJECT_TYPE_CURVE&&n.hasPoint(t,i))return!0;return!1}}),t.createTurtle=function(e,i,n){var r;return i=i||[],r=s.copyAttributes(n,e.options,"turtle"),new t.Turtle(e,i,r)},t.registerElement("turtle",t.createTurtle),{Turtle:t.Turtle,createTurtle:t.createTurtle}})),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],(function(t,e,i,s,n,r,o,a){"use strict";return t.CA=function(t,e,i){this.node=t,this.createNode=e,this.parser=i},t.extend(t.CA.prototype,{findMapNode:function(t,e){var i,s,n;if("op_assign"===e.value&&e.children[0].value===t)return e.children[1];if(e.children)for(s=e.children.length,i=0;i<s;++i)if(null!==(n=this.findMapNode(t,e.children[i])))return n;return null},setMath:function(t){var e,i;if(("node_op"!=t.type||"op_add"!=t.value&&"op_sub"!=t.value&&"op_mul"!=t.value&&"op_div"!=t.value&&"op_neg"!=t.value&&"op_execfun"!=t.value&&"op_exp"!=t.value)&&"node_var"!=t.type&&"node_const"!=t.type||(t.isMath=!0),t.children)for(i=t.children.length,e=0;e<i;++e)this.setMath(t.children[e])},deriveElementary:function(t,e){var i,s=t.children[0].value,n=t.children[1];switch(s){case"abs":i=this.createNode("node_op","op_div",n[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))]));break;case"sqrt":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(t.type,t.value,o.deepCopy(t.children[0]),o.deepCopy(t.children[1]))));break;case"sin":i=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),o.deepCopy(n));break;case"cos":i=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),o.deepCopy(n)));break;case"tan":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),o.deepCopy(n)),this.createNode("node_const",2)));break;case"exp":i=this.createNode(t.type,t.value,o.deepCopy(t.children[0]),o.deepCopy(t.children[1]));break;case"pow":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",o.deepCopy(t.children[0]),o.deepCopy(t.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[1][0],e),this.createNode("node_op","op_div",o.deepCopy(t.children[1][1]),o.deepCopy(t.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1][1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[o.deepCopy(t.children[1][0])]))));break;case"log":case"ln":i=this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0]));break;case"log2":case"lb":case"ld":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0])),this.createNode("node_const",.43429448190325176));break;case"asin":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])))]));break;case"acos":i=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])))])));break;case"atan":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))));break;case"sinh":i=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[o.deepCopy(n[0])]);break;case"cosh":i=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[o.deepCopy(n[0])]);break;case"tanh":i=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[o.deepCopy(n[0])]),this.createNode("node_const",2)));break;case"asinh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"acosh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"atanh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))));break;default:i=this.createNode("node_const",0),this._error('Derivative of "'+s+'" not yet implemented')}return i},derivative:function(t,e){var i;switch(t.type){case"node_op":switch(t.value){case"op_execfun":i="pow"==t.children[0].value?this.deriveElementary(t,e):this.createNode("node_op","op_mul",this.deriveElementary(t,e),this.derivative(t.children[1][0],e));break;case"op_div":i=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),o.deepCopy(t.children[1])),this.createNode("node_op","op_mul",o.deepCopy(t.children[0]),this.derivative(t.children[1],e))),this.createNode("node_op","op_mul",o.deepCopy(t.children[1]),o.deepCopy(t.children[1])));break;case"op_mul":i=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",o.deepCopy(t.children[0]),this.derivative(t.children[1],e)),this.createNode("node_op","op_mul",this.derivative(t.children[0],e),o.deepCopy(t.children[1])));break;case"op_neg":i=this.createNode("node_op","op_neg",this.derivative(t.children[0],e));break;case"op_add":case"op_sub":i=this.createNode("node_op",t.value,this.derivative(t.children[0],e),this.derivative(t.children[1],e));break;case"op_exp":i=this.createNode("node_op","op_mul",o.deepCopy(t),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),this.createNode("node_op","op_div",o.deepCopy(t.children[1]),o.deepCopy(t.children[0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[o.deepCopy(t.children[0])]))))}break;case"node_var":i=this.createNode("node_const",t.value===e?1:0);break;case"node_const":i=this.createNode("node_const",0)}return i},expandDerivatives:function(t,e,i){var s,n,r,a,l,h,c,d,u,p;if(!t)return 0;for(this.line=t.line,this.col=t.col,s=t.children.length,n=0;n<s;++n)if(t.children[n]&&t.children[n].type)t.children[n]=this.expandDerivatives(t.children[n],t,i);else if(o.isArray(t.children[n]))for(r=0;r<t.children[n].length;++r)t.children[n][r]&&t.children[n][r].type&&(t.children[n][r]=this.expandDerivatives(t.children[n][r],t,i));switch(t.type){case"node_op":switch(t.value){case"op_execfun":if(t.children[0]&&"D"===t.children[0].value){if("node_var"==t.children[1][0].type?(u=(a=this.findMapNode(t.children[1][0].value,i)).children[0],d=t.children[1].length>=2?t.children[1][1].value:a.children[0][0],l=a.children[1]):(l=t.children[1][0],u=["x"],d=t.children[1].length>=2?t.children[1][1].value:"x"),c=l,(p=t.children[1].length>=3?t.children[1][2].value:1)>=1)for(;p>=1;)c=this.derivative(c,d),c=this.removeTrivialNodes(c),p--;h="node_op"==e.type&&"op_assign"==e.value?this.createNode("node_op","op_map",u,c):c,this.setMath(h),t.type=h.type,t.value=h.value,t.children[0]=h.children[0],t.children[1]=h.children[1]}}}return t},removeTrivialNodes:function(t){var e,i,s,n,r;if(o.isArray(t))for(i=t.length,e=0;e<i;++e)t[e]=this.removeTrivialNodes(t[e]);if("node_op"!=t.type||!t.children)return t;for(i=t.children.length,e=0;e<i;++e){this.mayNotBeSimplified=!1;do{t.children[e]=this.removeTrivialNodes(t.children[e])}while(this.mayNotBeSimplified)}switch(t.value){case"op_map":if(s=t.children[0],"node_var"==(n=t.children[1]).type)for(e=0;e<s.length;++e)if(s[e]==n.value){n.isMath=!0;break}break;case"op_add":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&0===s.value)return n;if("node_const"==n.type&&0===n.value)return s;if("node_const"==s.type&&"node_const"==n.type)return s.value+=n.value,s;break;case"op_mul":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&1==s.value)return n;if("node_const"==n.type&&1==n.value)return s;if("node_const"==s.type&&0===s.value)return s;if("node_const"==n.type&&0===n.value)return n;if("node_const"==n.type&&0===n.value)return n;if("node_op"==s.type&&"op_neg"==s.value&&"node_op"==n.type&&"op_neg"==n.value)return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if("op_neg"==s.value&&"op_neg"!=n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s.children[0],n)],this.mayNotBeSimplified=!0,t;if("op_neg"!=s.value&&"op_neg"==n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s,n.children[0])],this.mayNotBeSimplified=!0,t;if("op_div"==s.value&&"node_const"==s.children[0].type&&1==s.children[0].value)return t.type="node_op",t.value="op_div",t.children=[n,s.children[1]],this.mayNotBeSimplified=!0,t;if("op_div"==n.value&&"node_const"==n.children[0].type&&1==n.children[0].value)return t.type="node_op",t.value="op_div",t.children=[s,n.children[1]],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_const"==n.type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_op"==n.type&&"op_neg"==n.value&&"node_const"==n.children[0].type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_execfun"!=s.value&&("node_var"==n.type||"node_op"==n.type&&"op_execfun"==n.value))return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_op"!=s.type&&"node_op"==n.type&&"op_neg"==n.value&&"node_var"==n.children[0].type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return r=n.children[0],n.children[0]=s,t.children=[r,n],this.mayNotBeSimplified=!0,t;if("node_const"!=n.type&&"node_op"==s.type&&"op_mul"==s.value&&"node_const"==s.children[0].type)return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],this.mayNotBeSimplified=!0,t;if("node_const"==s.type&&"node_const"==n.type)return s.value*=n.value,s;if("node_const"==s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return n.children[0].value*=s.value,n;if(s.hash=this.parser.compile(s),n.hash=this.parser.compile(n),s.hash===n.hash)return t.value="op_exp",t.children[1]=this.createNode("node_const",2),t;if("node_const"==s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return n.children[0].value*=s.value,n;if("node_op"==n.type&&"op_exp"==n.value&&(s.hash||(s.hash=this.parser.compile(s)),n.children[0].hash||(n.children[0].hash=this.parser.compile(n.children[0])),s.hash===n.children[0].hash))return n.children[1]=this.createNode("node_op","op_add",n.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,n;if("node_op"==s.type&&"op_exp"==s.value&&"node_op"==n.type&&"op_exp"==n.value&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_add",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_sub":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&0===s.value)return t.value="op_neg",t.children[0]=n,t;if("node_const"==n.type&&0===n.value)return s;if("node_const"==s.type&&"node_const"==n.type&&s.value==n.value)return this.createNode("node_const",0);if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return this.createNode("node_const",0);if("node_const"==s.type&&"node_const"==n.type)return s.value-=n.value,s;if("node_op"==s.type&&"op_mul"==s.value&&"node_op"==n.type&&"op_mul"==n.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_mul"==n.value&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_neg":if("node_const"==(s=t.children[0]).type&&0===s.value)return s;if("node_op"==s.type&&"op_neg"==s.value)return s.children[0];break;case"op_div":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&"node_const"==n.type&&s.value==n.value&&0!==s.value)return s.value=1,s;if("node_const"==s.type&&0===s.value&&"node_const"==n.type&&0!==n.value)return s.value=0,s;if("node_const"==s.type&&0===s.value&&("node_op"==n.type||"node_var"==n.type))return t.type="node_const",t.value=0,t;if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return this.createNode("node_const",1);if("node_const"==s.type&&0!==s.value&&"node_const"==n.type&&0===n.value)return s.value=s.value>0?1/0:-1/0,s;if("node_op"==s.type&&"op_neg"==s.value&&"node_op"==n.type&&"op_neg"==n.value)return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if("op_neg"==s.value&&"op_neg"!=n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s.children[0],n)],this.mayNotBeSimplified=!0,t;if("op_neg"!=s.value&&"op_neg"==n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s,n.children[0])],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_exp"==s.value&&(n.hash||(n.hash=this.parser.compile(n)),s.children[0].hash||(s.children[0].hash=this.parser.compile(s.children[0])),n.hash===s.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,s;if("node_const"!=n.type&&"node_op"==s.type&&"op_mul"==s.value&&"node_const"==s.children[0].type)return t.value="op_mul",t.children=[s.children[0],this.createNode("node_op","op_div",s.children[1],n)],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_exp"==s.value&&"node_op"==n.type&&"op_exp"==n.value&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_exp":if(s=t.children[0],"node_const"==(n=t.children[1]).type&&0===n.value)return n.value=1,n;if("node_const"==n.type&&1==n.value)return s;if("node_const"==s.type&&1==s.value)return s;if("node_const"==s.type&&0===s.value&&"node_const"==n.type&&0!==n.value)return s;if("node_op"==s.type&&"op_exp"==s.value)return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],t}switch(t.value){case"op_add":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&"node_const"==n.type&&s.value==n.value)return s.value+=n.value,s;if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return t.children[0]=this.createNode("node_const",2),t.value="op_mul",t;if("node_op"==s.type&&"op_neg"==s.value)return t.value="op_sub",t.children[0]=n,t.children[1]=s.children[0],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_neg"==n.value)return t.value="op_sub",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&"node_op"==n.type&&"op_mul"==n.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_mul"==n.value&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_sub":if(s=t.children[0],"node_op"==(n=t.children[1]).type&&"op_neg"==n.value)return t.value="op_add",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;break;case"op_execfun":return this.simplifyElementary(t)}return t},simplifyElementary:function(t){var e=t.children[1];if(0==e.length)return t;switch(t.children[0].value){case"sin":case"tan":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=0,t;if("node_var"==e[0].type&&"PI"==e[0].value)return t.type="node_const",t.value=0,t;if("node_op"==e[0].type&&"op_mul"==e[0].value&&"node_const"==e[0].children[0].type&&e[0].children[0].value%1==0&&"node_var"==e[0].children[1].type&&"PI"==e[0].children[1].value)return t.type="node_const",t.value=0,t;break;case"cos":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=1,t;if("node_var"==e[0].type&&"PI"==e[0].value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_const",1)],t;break;case"exp":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=1,t;break;case"pow":if("node_const"==e[1].type&&0===e[1].value)return t.type="node_const",t.value=1,t}return t}}),t.CA})),define("utils/dump",["jxg","utils/type"],(function(t,e){"use strict";return t.Dump={addMarkers:function(t,i,s){var n,r,o;for(n in e.isArray(i)||(i=[i]),e.isArray(s)||(s=[s]),r=Math.min(i.length,s.length),i.length=r,s.length=r,t.objects)if(t.objects.hasOwnProperty(n))for(o=0;o<r;o++)t.objects[n][i[o]]=s[o]},deleteMarkers:function(t,i){var s,n,r;for(s in e.isArray(i)||(i=[i]),i.length=n=i.length,t.objects)if(t.objects.hasOwnProperty(s))for(r=0;r<n;r++)delete t.objects[s][i[r]]},str:function(t){return"string"==typeof t&&"function"!==t.substr(0,7)&&(t='"'+t+'"'),t},minimizeObject:function(i,s){var n,r,o,a={},l=e.deepCopy(i),h=[];for(o=1;o<arguments.length;o++)h.push(arguments[o]);for(a=e.deepCopy(a,t.Options.elements,!0),o=h.length;o>0;o--)a=e.deepCopy(a,h[o-1],!0);for(n in a)a.hasOwnProperty(n)&&(r=n.toLowerCase(),"object"!=typeof a[n]&&a[n]===l[r]&&(console.log("delete",n),delete l[r]));return l},prepareAttributes:function(e,i){var s,n;for(n in s=this.minimizeObject(i.getAttributes(),t.Options[i.elType]),i.subs)i.subs.hasOwnProperty(n)&&(s[n]=this.minimizeObject(i.subs[n].getAttributes(),t.Options[i.elType][n],t.Options[i.subs[n].elType]),s[n].id=i.subs[n].id,s[n].name=i.subs[n].name);return s.id=i.id,s.name=i.name,s},setBoundingBox:function(t,e,i){return t.push({obj:i,method:"setBoundingBox",params:[e.getBoundingBox(),!0]}),t},dump:function(t){var i,s,n,r,o=[],a=[],l=t.objectsList.length;for(this.addMarkers(t,"dumped",!1),i=0;i<l;i++)if(n={},!(s=t.objectsList[i]).dumped&&s.dump){for(n.type=s.getType(),n.parents=s.getParents().slice(),"point"===n.type&&1===n.parents[0]&&(n.parents=n.parents.slice(1)),r=0;r<n.parents.length;r++)e.isString(n.parents[r])&&"'"!==n.parents[r][0]&&'"'!==n.parents[r][0]?n.parents[r]='"'+n.parents[r]+'"':e.isArray(n.parents[r])&&(n.parents[r]="["+n.parents[r].toString()+"]");n.attributes=this.prepareAttributes(t,s),"glider"===n.type&&s.onPolygon&&o.push({obj:s.id,prop:"onPolygon",val:!0}),a.push(n)}return this.deleteMarkers(t,"dumped"),{elements:a,props:o,methods:[]}},arrayToParamStr:function(t,e){var i,s=[];for(i=0;i<t.length;i++)s.push(e.call(this,t[i]));return s.join(", ")},toJCAN:function(t){var i,s,n;switch(typeof t){case"object":if(t){if(s=[],e.isArray(t)){for(i=0;i<t.length;i++)s.push(this.toJCAN(t[i]));return"["+s.join(",")+"]"}for(n in t)t.hasOwnProperty(n)&&s.push(n+": "+this.toJCAN(t[n]));return"<<"+s.join(", ")+">> "}return"null";case"string":return"'"+t.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return t.toString();case"null":return"null"}},toJessie:function(t){var e,i,s=this.dump(t),n=[];for(s.methods=this.setBoundingBox(s.methods,t,"$board"),i=s.elements,e=0;e<i.length;e++)i[e].attributes.name.length>0&&n.push("// "+i[e].attributes.name),n.push("s"+e+" = "+i[e].type+"("+i[e].parents.join(", ")+") "+this.toJCAN(i[e].attributes).replace(/\n/,"\\n")+";"),n.push("");for(e=0;e<s.methods.length;e++)n.push(s.methods[e].obj+"."+s.methods[e].method+"("+this.arrayToParamStr(s.methods[e].params,this.toJCAN)+");"),n.push("");for(e=0;e<s.props.length;e++)n.push(s.props[e].obj+"."+s.props[e].prop+" = "+this.toJCAN(s.props[e].val)+";"),n.push("");return n.join("\n")},toJavaScript:function(t){var i,s,n=this.dump(t),r=[];for(n.methods=this.setBoundingBox(n.methods,t,"board"),s=n.elements,i=0;i<s.length;i++)r.push('board.create("'+s[i].type+'", ['+s[i].parents.join(", ")+"], "+e.toJSON(s[i].attributes)+");");for(i=0;i<n.methods.length;i++)r.push(n.methods[i].obj+"."+n.methods[i].method+"("+this.arrayToParamStr(n.methods[i].params,e.toJSON)+");"),r.push("");for(i=0;i<n.props.length;i++)r.push(n.props[i].obj+"."+n.props[i].prop+" = "+e.toJSON(n.props[i].val)+";"),r.push("");return r.join("\n")}},t.Dump})),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],(function(t,e,i,s,n,r,o){"use strict";return t.createComb=function(t,e,s){var n,r,a,l,h,c,d,u,p;if(2!==e.length)throw h=e.map((function(t){return"'"+typeof t+"'"})),new Error("JSXGraph: Can't create comb with parent types "+h.join(", ")+".\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");if(i.isArray(e[0])&&e[0].length>1)l=i.copyAttributes(s,t.options,"comb","point1"),n=t.create("point",e[0],l);else if(i.isString(e[0])||i.isPoint(e[0]))n=t.select(e[0]);else if(i.isFunction(e[0])&&i.isPoint(e[0]()))n=e[0]();else{if(!(i.isFunction(e[0])&&e[0]().length&&e[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");l=i.copyAttributes(s,t.options,"comb","point1"),n=o.createPoint(t,e[0](),l)}if(i.isArray(e[1])&&e[1].length>1)l=i.copyAttributes(s,t.options,"comb","point2"),r=t.create("point",e[1],l);else if(i.isString(e[1])||i.isPoint(e[1]))r=t.select(e[1]);else if(i.isFunction(e[1])&&i.isPoint(e[1]()))r=e[1]();else{if(!(i.isFunction(e[1])&&e[1]().length&&e[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");l=i.copyAttributes(s,t.options,"comb","point2"),r=o.createPoint(t,e[1](),l)}return l=i.copyAttributes(s,t.options,"comb","curve"),a=t.create("curve",[[0],[0]],l),l=i.copyAttributes(s,t.options,"comb"),c=l.frequency,d=-l.angle,u=l.width,l.reverse&&(p=n,n=r,r=p,d=-d),a.updateDataArray=function(){var t,e,i,s=0,o=n.Dist(r),a=Math.cos(d),l=Math.sin(d),h=(r.X()-n.X())/o,p=(r.Y()-n.Y())/o;for(a*=u/Math.abs(l),l*=u/Math.abs(l),this.dataX=[],this.dataY=[];s<o;)t=n.X()+h*s,e=n.Y()+p*s,l*=i=Math.min(a,o-s)/Math.abs(a),a*=i,this.dataX.push(t),this.dataY.push(e),this.dataX.push(t+h*a+p*l),this.dataY.push(e-h*l+p*a),this.dataX.push(NaN),this.dataY.push(NaN),s+=c},a},t.registerElement("comb",t.createComb),{createComb:t.createComb}})),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],(function(t,e,i,s,n,r,o,a){"use strict";var l={removeSlopeTriangle:function(){r.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return t.createSlopeTriangle=function(e,n,r){var o,a,h,c,d,u,p,f,m,g=!1;if(1===n.length&&n[0].type===s.OBJECT_TYPE_TANGENT)h=(a=n[0]).glider;else if(1===n.length&&n[0].type===s.OBJECT_TYPE_GLIDER)h=n[0],m=i.copyAttributes(r,e.options,"slopetriangle","tangent"),a=e.create("tangent",[h],m),g=!0;else{if(2!==n.length||n[0].elementClass!==s.OBJECT_CLASS_LINE||!i.isPoint(n[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof n[0]+"'.");a=n[0],h=n[1]}return m=i.copyAttributes(r,e.options,"slopetriangle","basepoint"),p=e.create("point",[function(){return[h.X()+1,h.Y()]}],m),m=i.copyAttributes(r,e.options,"slopetriangle","baseline"),u=e.create("line",[h,p],m),m=i.copyAttributes(r,e.options,"slopetriangle","glider"),c=e.create("glider",[h.X()+1,h.Y(),u],m),m=i.copyAttributes(r,e.options,"slopetriangle","toppoint"),d=e.create("point",[function(){return[c.X(),c.Y()+(c.X()-h.X())*a.getSlope()]}],m),(m=i.copyAttributes(r,e.options,"slopetriangle")).borders=i.copyAttributes(m.borders,e.options,"slopetriangle","borders"),(o=e.create("polygon",[h,c,d],m)).Value=l.Value,o.tangent=a,o._isPrivateTangent=g,o.borders[2].setArrow(!1,!1),m=i.copyAttributes(r,e.options,"slopetriangle","label"),(f=e.create("text",[function(){return c.X()+.1},function(){return.5*(c.Y()+d.Y())},function(){return""}],m))._setText((function(){return i.toFixed(o.Value(),i.evaluate(f.visProp.digits))})),f.fullUpdate(),o.glider=c,o.basepoint=p,o.baseline=u,o.toppoint=d,o.label=f,o.subs={glider:c,basePoint:p,baseLine:u,topPoint:d,label:f},o.inherits.push(c,p,u,d,f),o.methodMap=t.deepCopy(o.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),o.remove=l.removeSlopeTriangle,o},t.registerElement("slopetriangle",t.createSlopeTriangle),{createSlopeTriangle:t.createSlopeTriangle}})),define("element/checkbox",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};return t.createCheckbox=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"checkbox");return(a=n.create("text",[r[0],r[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],l)).type=i.OBJECT_TYPE_CHECKBOX,a.rendNodeCheckbox=a.rendNode.childNodes[0].childNodes[0],a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[1],a.rendNodeTag=a.rendNodeCheckbox,a.rendNodeTag.disabled=!!l.disabled,a.rendNodeLabel.innerHTML=r[2],a.rendNodeCheckbox.id=a.rendNode.id+"_checkbox",a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeLabel.setAttribute("for",a.rendNodeCheckbox.id),a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),a.rendNodeCheckbox.checked=l.checked,a._value=l.checked,a.Value=function(){return this._value},a.update=function(){return this.needsUpdate&&(t.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},e.addEvent(a.rendNodeCheckbox,"change",s,a),a},t.registerElement("checkbox",t.createCheckbox),{createCheckbox:t.createCheckbox}})),define("element/input",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(t){this._value=this.rendNodeInput.value,this.board.update()};return t.createInput=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"input");return(a=n.create("text",[r[0],r[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+l.maxlength+'" style="width:100%"/></span>'],l)).type=i.OBJECT_TYPE_INPUT,a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[0],a.rendNodeInput=a.rendNode.childNodes[0].childNodes[1],a.rendNodeLabel.innerHTML=r[3],a.rendNodeInput.value=r[2],a.rendNodeTag=a.rendNodeInput,a.rendNodeTag.disabled=!!l.disabled,a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeInput.id=a.rendNode.id+"_input",a._value=r[2],a.update=function(){return this.needsUpdate&&(t.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},a.Value=function(){return this._value},e.addEvent(a.rendNodeInput,"input",s,a),e.addEvent(a.rendNodeInput,"mousedown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeInput,"touchstart",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeInput,"pointerdown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),a},t.registerElement("input",t.createInput),{createInput:t.createInput}})),define("element/button",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(){this._handler&&this._handler(),this.board.update()};return t.createButton=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"button");return(a=n.create("text",[r[0],r[1],'<button type="button" style="width:100%;"></button>'],l)).type=i.OBJECT_TYPE_BUTTON,a.rendNodeButton=a.rendNode.childNodes[0],a.rendNodeButton.id=a.rendNode.id+"_button",a.rendNodeButton.innerHTML=r[2],a.rendNodeTag=a.rendNodeButton,a.rendNodeTag.disabled=!!l.disabled,a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),r[3]&&(i.isString(r[3])?(a._jc=new t.JessieCode,a._jc.use(n),a._handler=function(){a._jc.parse(r[3])}):a._handler=r[3]),e.addEvent(a.rendNodeButton,"click",s,a),e.addEvent(a.rendNodeButton,"mousedown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeButton,"touchstart",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeButton,"pointerdown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),a},t.registerElement("button",t.createButton),{createButton:t.createButton}})),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],(function(t,e){"use strict";return e.isBrowser?window.JXG=t:e.isNode()&&"object"==typeof module?module.exports=t:e.isWebWorker()&&(self.JXG=t),t})),require("../build/core.deps.js")})),global=this,factory=function(){const t=0,e=1,i=2,s=3,n=4,r=5,o=6,a=7,l=8,h=9,c=10,d=11,u=12;function p(t,e){const i=t.charCodeAt(e=e||0);if(55296<=i&&i<=56319&&e<t.length-1){const s=i,n=t.charCodeAt(e+1);return 56320<=n&&n<=57343?1024*(s-55296)+(n-56320)+65536:s}if(56320<=i&&i<=57343&&e>=1){const s=t.charCodeAt(e-1),n=i;return 55296<=s&&s<=56319?1024*(s-55296)+(n-56320)+65536:n}return i}function f(f,g){if((g=g||0)<0)return 0;if(g>=f.length-1)return f.length;let b=m(p(f,g));for(let C=g+1;C<f.length;C++){if(55296<=f.charCodeAt(C-1)&&f.charCodeAt(C-1)<=56319&&56320<=f.charCodeAt(C)&&f.charCodeAt(C)<=57343)continue;const g=m(p(f,C));if(v=g,!((y=b)===d&&v===u||y===s&&v===d||y===d&&v===s||y===t&&v===e||y!==i&&y!==t&&y!==e&&v!==i&&v!==t&&v!==e&&(y===o&&(v===o||v===a||v===h||v===c)||!(y!==h&&y!==a||v!==a&&v!==l)||(y===c||y===l)&&v===l||y===n&&v===n||v===s||v===r)))return C;b=g}var y,v;return f.length}function m(p){return 13===p?t:10===p?e:0<=p&&p<=9||11<=p&&p<=12||14<=p&&p<=31||127<=p&&p<=159||173===p||1536<=p&&p<=1541||1564===p||1757===p||1807===p||6158===p||8203===p||8206<=p&&p<=8207||8232===p||8233===p||8234<=p&&p<=8238||8288<=p&&p<=8292||8293===p||8294<=p&&p<=8303||55296<=p&&p<=57343||65279===p||65520<=p&&p<=65528||65529<=p&&p<=65531||69821===p||113824<=p&&p<=113827||119155<=p&&p<=119162||917504===p||917505===p||917506<=p&&p<=917535||917536<=p&&p<=917631||917632<=p&&p<=917759||918e3<=p&&p<=921599?i:768<=p&&p<=879||1155<=p&&p<=1159||1160<=p&&p<=1161||1425<=p&&p<=1469||1471===p||1473<=p&&p<=1474||1476<=p&&p<=1477||1479===p||1552<=p&&p<=1562||1611<=p&&p<=1631||1648===p||1750<=p&&p<=1756||1759<=p&&p<=1764||1767<=p&&p<=1768||1770<=p&&p<=1773||1809===p||1840<=p&&p<=1866||1958<=p&&p<=1968||2027<=p&&p<=2035||2070<=p&&p<=2073||2075<=p&&p<=2083||2085<=p&&p<=2087||2089<=p&&p<=2093||2137<=p&&p<=2139||2275<=p&&p<=2306||2362===p||2364===p||2369<=p&&p<=2376||2381===p||2385<=p&&p<=2391||2402<=p&&p<=2403||2433===p||2492===p||2494===p||2497<=p&&p<=2500||2509===p||2519===p||2530<=p&&p<=2531||2561<=p&&p<=2562||2620===p||2625<=p&&p<=2626||2631<=p&&p<=2632||2635<=p&&p<=2637||2641===p||2672<=p&&p<=2673||2677===p||2689<=p&&p<=2690||2748===p||2753<=p&&p<=2757||2759<=p&&p<=2760||2765===p||2786<=p&&p<=2787||2817===p||2876===p||2878===p||2879===p||2881<=p&&p<=2884||2893===p||2902===p||2903===p||2914<=p&&p<=2915||2946===p||3006===p||3008===p||3021===p||3031===p||3072===p||3134<=p&&p<=3136||3142<=p&&p<=3144||3146<=p&&p<=3149||3157<=p&&p<=3158||3170<=p&&p<=3171||3201===p||3260===p||3263===p||3266===p||3270===p||3276<=p&&p<=3277||3285<=p&&p<=3286||3298<=p&&p<=3299||3329===p||3390===p||3393<=p&&p<=3396||3405===p||3415===p||3426<=p&&p<=3427||3530===p||3535===p||3538<=p&&p<=3540||3542===p||3551===p||3633===p||3636<=p&&p<=3642||3655<=p&&p<=3662||3761===p||3764<=p&&p<=3769||3771<=p&&p<=3772||3784<=p&&p<=3789||3864<=p&&p<=3865||3893===p||3895===p||3897===p||3953<=p&&p<=3966||3968<=p&&p<=3972||3974<=p&&p<=3975||3981<=p&&p<=3991||3993<=p&&p<=4028||4038===p||4141<=p&&p<=4144||4146<=p&&p<=4151||4153<=p&&p<=4154||4157<=p&&p<=4158||4184<=p&&p<=4185||4190<=p&&p<=4192||4209<=p&&p<=4212||4226===p||4229<=p&&p<=4230||4237===p||4253===p||4957<=p&&p<=4959||5906<=p&&p<=5908||5938<=p&&p<=5940||5970<=p&&p<=5971||6002<=p&&p<=6003||6068<=p&&p<=6069||6071<=p&&p<=6077||6086===p||6089<=p&&p<=6099||6109===p||6155<=p&&p<=6157||6313===p||6432<=p&&p<=6434||6439<=p&&p<=6440||6450===p||6457<=p&&p<=6459||6679<=p&&p<=6680||6683===p||6742===p||6744<=p&&p<=6750||6752===p||6754===p||6757<=p&&p<=6764||6771<=p&&p<=6780||6783===p||6832<=p&&p<=6845||6846===p||6912<=p&&p<=6915||6964===p||6966<=p&&p<=6970||6972===p||6978===p||7019<=p&&p<=7027||7040<=p&&p<=7041||7074<=p&&p<=7077||7080<=p&&p<=7081||7083<=p&&p<=7085||7142===p||7144<=p&&p<=7145||7149===p||7151<=p&&p<=7153||7212<=p&&p<=7219||7222<=p&&p<=7223||7376<=p&&p<=7378||7380<=p&&p<=7392||7394<=p&&p<=7400||7405===p||7412===p||7416<=p&&p<=7417||7616<=p&&p<=7669||7676<=p&&p<=7679||8204<=p&&p<=8205||8400<=p&&p<=8412||8413<=p&&p<=8416||8417===p||8418<=p&&p<=8420||8421<=p&&p<=8432||11503<=p&&p<=11505||11647===p||11744<=p&&p<=11775||12330<=p&&p<=12333||12334<=p&&p<=12335||12441<=p&&p<=12442||42607===p||42608<=p&&p<=42610||42612<=p&&p<=42621||42654<=p&&p<=42655||42736<=p&&p<=42737||43010===p||43014===p||43019===p||43045<=p&&p<=43046||43204===p||43232<=p&&p<=43249||43302<=p&&p<=43309||43335<=p&&p<=43345||43392<=p&&p<=43394||43443===p||43446<=p&&p<=43449||43452===p||43493===p||43561<=p&&p<=43566||43569<=p&&p<=43570||43573<=p&&p<=43574||43587===p||43596===p||43644===p||43696===p||43698<=p&&p<=43700||43703<=p&&p<=43704||43710<=p&&p<=43711||43713===p||43756<=p&&p<=43757||43766===p||44005===p||44008===p||44013===p||64286===p||65024<=p&&p<=65039||65056<=p&&p<=65071||65438<=p&&p<=65439||66045===p||66272===p||66422<=p&&p<=66426||68097<=p&&p<=68099||68101<=p&&p<=68102||68108<=p&&p<=68111||68152<=p&&p<=68154||68159===p||68325<=p&&p<=68326||69633===p||69688<=p&&p<=69702||69759<=p&&p<=69761||69811<=p&&p<=69814||69817<=p&&p<=69818||69888<=p&&p<=69890||69927<=p&&p<=69931||69933<=p&&p<=69940||70003===p||70016<=p&&p<=70017||70070<=p&&p<=70078||70090<=p&&p<=70092||70191<=p&&p<=70193||70196===p||70198<=p&&p<=70199||70367===p||70371<=p&&p<=70378||70400<=p&&p<=70401||70460===p||70462===p||70464===p||70487===p||70502<=p&&p<=70508||70512<=p&&p<=70516||70832===p||70835<=p&&p<=70840||70842===p||70845===p||70847<=p&&p<=70848||70850<=p&&p<=70851||71087===p||71090<=p&&p<=71093||71100<=p&&p<=71101||71103<=p&&p<=71104||71132<=p&&p<=71133||71219<=p&&p<=71226||71229===p||71231<=p&&p<=71232||71339===p||71341===p||71344<=p&&p<=71349||71351===p||71453<=p&&p<=71455||71458<=p&&p<=71461||71463<=p&&p<=71467||92912<=p&&p<=92916||92976<=p&&p<=92982||94095<=p&&p<=94098||113821<=p&&p<=113822||119141===p||119143<=p&&p<=119145||119150<=p&&p<=119154||119163<=p&&p<=119170||119173<=p&&p<=119179||119210<=p&&p<=119213||119362<=p&&p<=119364||121344<=p&&p<=121398||121403<=p&&p<=121452||121461===p||121476===p||121499<=p&&p<=121503||121505<=p&&p<=121519||125136<=p&&p<=125142||917760<=p&&p<=917999?s:127462<=p&&p<=127487?n:127995<=p&&p<=127999?u:2307===p||2363===p||2366<=p&&p<=2368||2377<=p&&p<=2380||2382<=p&&p<=2383||2434<=p&&p<=2435||2495<=p&&p<=2496||2503<=p&&p<=2504||2507<=p&&p<=2508||2563===p||2622<=p&&p<=2624||2691===p||2750<=p&&p<=2752||2761===p||2763<=p&&p<=2764||2818<=p&&p<=2819||2880===p||2887<=p&&p<=2888||2891<=p&&p<=2892||3007===p||3009<=p&&p<=3010||3014<=p&&p<=3016||3018<=p&&p<=3020||3073<=p&&p<=3075||3137<=p&&p<=3140||3202<=p&&p<=3203||3262===p||3264<=p&&p<=3265||3267<=p&&p<=3268||3271<=p&&p<=3272||3274<=p&&p<=3275||3330<=p&&p<=3331||3391<=p&&p<=3392||3398<=p&&p<=3400||3402<=p&&p<=3404||3458<=p&&p<=3459||3536<=p&&p<=3537||3544<=p&&p<=3550||3570<=p&&p<=3571||3635===p||3763===p||3902<=p&&p<=3903||3967===p||4145===p||4155<=p&&p<=4156||4182<=p&&p<=4183||4228===p||6070===p||6078<=p&&p<=6085||6087<=p&&p<=6088||6435<=p&&p<=6438||6441<=p&&p<=6443||6448<=p&&p<=6449||6451<=p&&p<=6456||6681<=p&&p<=6682||6741===p||6743===p||6765<=p&&p<=6770||6916===p||6965===p||6971===p||6973<=p&&p<=6977||6979<=p&&p<=6980||7042===p||7073===p||7078<=p&&p<=7079||7082===p||7143===p||7146<=p&&p<=7148||7150===p||7154<=p&&p<=7155||7204<=p&&p<=7211||7220<=p&&p<=7221||7393===p||7410<=p&&p<=7411||43043<=p&&p<=43044||43047===p||43136<=p&&p<=43137||43188<=p&&p<=43203||43346<=p&&p<=43347||43395===p||43444<=p&&p<=43445||43450<=p&&p<=43451||43453<=p&&p<=43456||43567<=p&&p<=43568||43571<=p&&p<=43572||43597===p||43755===p||43758<=p&&p<=43759||43765===p||44003<=p&&p<=44004||44006<=p&&p<=44007||44009<=p&&p<=44010||44012===p||69632===p||69634===p||69762===p||69808<=p&&p<=69810||69815<=p&&p<=69816||69932===p||70018===p||70067<=p&&p<=70069||70079<=p&&p<=70080||70188<=p&&p<=70190||70194<=p&&p<=70195||70197===p||70368<=p&&p<=70370||70402<=p&&p<=70403||70463===p||70465<=p&&p<=70468||70471<=p&&p<=70472||70475<=p&&p<=70477||70498<=p&&p<=70499||70833<=p&&p<=70834||70841===p||70843<=p&&p<=70844||70846===p||70849===p||71088<=p&&p<=71089||71096<=p&&p<=71099||71102===p||71216<=p&&p<=71218||71227<=p&&p<=71228||71230===p||71340===p||71342<=p&&p<=71343||71350===p||71456<=p&&p<=71457||71462===p||94033<=p&&p<=94078||119142===p||119149===p?r:4352<=p&&p<=4447||43360<=p&&p<=43388?o:4448<=p&&p<=4519||55216<=p&&p<=55238?a:4520<=p&&p<=4607||55243<=p&&p<=55291?l:44032===p||44060===p||44088===p||44116===p||44144===p||44172===p||44200===p||44228===p||44256===p||44284===p||44312===p||44340===p||44368===p||44396===p||44424===p||44452===p||44480===p||44508===p||44536===p||44564===p||44592===p||44620===p||44648===p||44676===p||44704===p||44732===p||44760===p||44788===p||44816===p||44844===p||44872===p||44900===p||44928===p||44956===p||44984===p||45012===p||45040===p||45068===p||45096===p||45124===p||45152===p||45180===p||45208===p||45236===p||45264===p||45292===p||45320===p||45348===p||45376===p||45404===p||45432===p||45460===p||45488===p||45516===p||45544===p||45572===p||45600===p||45628===p||45656===p||45684===p||45712===p||45740===p||45768===p||45796===p||45824===p||45852===p||45880===p||45908===p||45936===p||45964===p||45992===p||46020===p||46048===p||46076===p||46104===p||46132===p||46160===p||46188===p||46216===p||46244===p||46272===p||46300===p||46328===p||46356===p||46384===p||46412===p||46440===p||46468===p||46496===p||46524===p||46552===p||46580===p||46608===p||46636===p||46664===p||46692===p||46720===p||46748===p||46776===p||46804===p||46832===p||46860===p||46888===p||46916===p||46944===p||46972===p||47e3===p||47028===p||47056===p||47084===p||47112===p||47140===p||47168===p||47196===p||47224===p||47252===p||47280===p||47308===p||47336===p||47364===p||47392===p||47420===p||47448===p||47476===p||47504===p||47532===p||47560===p||47588===p||47616===p||47644===p||47672===p||47700===p||47728===p||47756===p||47784===p||47812===p||47840===p||47868===p||47896===p||47924===p||47952===p||47980===p||48008===p||48036===p||48064===p||48092===p||48120===p||48148===p||48176===p||48204===p||48232===p||48260===p||48288===p||48316===p||48344===p||48372===p||48400===p||48428===p||48456===p||48484===p||48512===p||48540===p||48568===p||48596===p||48624===p||48652===p||48680===p||48708===p||48736===p||48764===p||48792===p||48820===p||48848===p||48876===p||48904===p||48932===p||48960===p||48988===p||49016===p||49044===p||49072===p||49100===p||49128===p||49156===p||49184===p||49212===p||49240===p||49268===p||49296===p||49324===p||49352===p||49380===p||49408===p||49436===p||49464===p||49492===p||49520===p||49548===p||49576===p||49604===p||49632===p||49660===p||49688===p||49716===p||49744===p||49772===p||49800===p||49828===p||49856===p||49884===p||49912===p||49940===p||49968===p||49996===p||50024===p||50052===p||50080===p||50108===p||50136===p||50164===p||50192===p||50220===p||50248===p||50276===p||50304===p||50332===p||50360===p||50388===p||50416===p||50444===p||50472===p||50500===p||50528===p||50556===p||50584===p||50612===p||50640===p||50668===p||50696===p||50724===p||50752===p||50780===p||50808===p||50836===p||50864===p||50892===p||50920===p||50948===p||50976===p||51004===p||51032===p||51060===p||51088===p||51116===p||51144===p||51172===p||51200===p||51228===p||51256===p||51284===p||51312===p||51340===p||51368===p||51396===p||51424===p||51452===p||51480===p||51508===p||51536===p||51564===p||51592===p||51620===p||51648===p||51676===p||51704===p||51732===p||51760===p||51788===p||51816===p||51844===p||51872===p||51900===p||51928===p||51956===p||51984===p||52012===p||52040===p||52068===p||52096===p||52124===p||52152===p||52180===p||52208===p||52236===p||52264===p||52292===p||52320===p||52348===p||52376===p||52404===p||52432===p||52460===p||52488===p||52516===p||52544===p||52572===p||52600===p||52628===p||52656===p||52684===p||52712===p||52740===p||52768===p||52796===p||52824===p||52852===p||52880===p||52908===p||52936===p||52964===p||52992===p||53020===p||53048===p||53076===p||53104===p||53132===p||53160===p||53188===p||53216===p||53244===p||53272===p||53300===p||53328===p||53356===p||53384===p||53412===p||53440===p||53468===p||53496===p||53524===p||53552===p||53580===p||53608===p||53636===p||53664===p||53692===p||53720===p||53748===p||53776===p||53804===p||53832===p||53860===p||53888===p||53916===p||53944===p||53972===p||54e3===p||54028===p||54056===p||54084===p||54112===p||54140===p||54168===p||54196===p||54224===p||54252===p||54280===p||54308===p||54336===p||54364===p||54392===p||54420===p||54448===p||54476===p||54504===p||54532===p||54560===p||54588===p||54616===p||54644===p||54672===p||54700===p||54728===p||54756===p||54784===p||54812===p||54840===p||54868===p||54896===p||54924===p||54952===p||54980===p||55008===p||55036===p||55064===p||55092===p||55120===p||55148===p||55176===p?h:44033<=p&&p<=44059||44061<=p&&p<=44087||44089<=p&&p<=44115||44117<=p&&p<=44143||44145<=p&&p<=44171||44173<=p&&p<=44199||44201<=p&&p<=44227||44229<=p&&p<=44255||44257<=p&&p<=44283||44285<=p&&p<=44311||44313<=p&&p<=44339||44341<=p&&p<=44367||44369<=p&&p<=44395||44397<=p&&p<=44423||44425<=p&&p<=44451||44453<=p&&p<=44479||44481<=p&&p<=44507||44509<=p&&p<=44535||44537<=p&&p<=44563||44565<=p&&p<=44591||44593<=p&&p<=44619||44621<=p&&p<=44647||44649<=p&&p<=44675||44677<=p&&p<=44703||44705<=p&&p<=44731||44733<=p&&p<=44759||44761<=p&&p<=44787||44789<=p&&p<=44815||44817<=p&&p<=44843||44845<=p&&p<=44871||44873<=p&&p<=44899||44901<=p&&p<=44927||44929<=p&&p<=44955||44957<=p&&p<=44983||44985<=p&&p<=45011||45013<=p&&p<=45039||45041<=p&&p<=45067||45069<=p&&p<=45095||45097<=p&&p<=45123||45125<=p&&p<=45151||45153<=p&&p<=45179||45181<=p&&p<=45207||45209<=p&&p<=45235||45237<=p&&p<=45263||45265<=p&&p<=45291||45293<=p&&p<=45319||45321<=p&&p<=45347||45349<=p&&p<=45375||45377<=p&&p<=45403||45405<=p&&p<=45431||45433<=p&&p<=45459||45461<=p&&p<=45487||45489<=p&&p<=45515||45517<=p&&p<=45543||45545<=p&&p<=45571||45573<=p&&p<=45599||45601<=p&&p<=45627||45629<=p&&p<=45655||45657<=p&&p<=45683||45685<=p&&p<=45711||45713<=p&&p<=45739||45741<=p&&p<=45767||45769<=p&&p<=45795||45797<=p&&p<=45823||45825<=p&&p<=45851||45853<=p&&p<=45879||45881<=p&&p<=45907||45909<=p&&p<=45935||45937<=p&&p<=45963||45965<=p&&p<=45991||45993<=p&&p<=46019||46021<=p&&p<=46047||46049<=p&&p<=46075||46077<=p&&p<=46103||46105<=p&&p<=46131||46133<=p&&p<=46159||46161<=p&&p<=46187||46189<=p&&p<=46215||46217<=p&&p<=46243||46245<=p&&p<=46271||46273<=p&&p<=46299||46301<=p&&p<=46327||46329<=p&&p<=46355||46357<=p&&p<=46383||46385<=p&&p<=46411||46413<=p&&p<=46439||46441<=p&&p<=46467||46469<=p&&p<=46495||46497<=p&&p<=46523||46525<=p&&p<=46551||46553<=p&&p<=46579||46581<=p&&p<=46607||46609<=p&&p<=46635||46637<=p&&p<=46663||46665<=p&&p<=46691||46693<=p&&p<=46719||46721<=p&&p<=46747||46749<=p&&p<=46775||46777<=p&&p<=46803||46805<=p&&p<=46831||46833<=p&&p<=46859||46861<=p&&p<=46887||46889<=p&&p<=46915||46917<=p&&p<=46943||46945<=p&&p<=46971||46973<=p&&p<=46999||47001<=p&&p<=47027||47029<=p&&p<=47055||47057<=p&&p<=47083||47085<=p&&p<=47111||47113<=p&&p<=47139||47141<=p&&p<=47167||47169<=p&&p<=47195||47197<=p&&p<=47223||47225<=p&&p<=47251||47253<=p&&p<=47279||47281<=p&&p<=47307||47309<=p&&p<=47335||47337<=p&&p<=47363||47365<=p&&p<=47391||47393<=p&&p<=47419||47421<=p&&p<=47447||47449<=p&&p<=47475||47477<=p&&p<=47503||47505<=p&&p<=47531||47533<=p&&p<=47559||47561<=p&&p<=47587||47589<=p&&p<=47615||47617<=p&&p<=47643||47645<=p&&p<=47671||47673<=p&&p<=47699||47701<=p&&p<=47727||47729<=p&&p<=47755||47757<=p&&p<=47783||47785<=p&&p<=47811||47813<=p&&p<=47839||47841<=p&&p<=47867||47869<=p&&p<=47895||47897<=p&&p<=47923||47925<=p&&p<=47951||47953<=p&&p<=47979||47981<=p&&p<=48007||48009<=p&&p<=48035||48037<=p&&p<=48063||48065<=p&&p<=48091||48093<=p&&p<=48119||48121<=p&&p<=48147||48149<=p&&p<=48175||48177<=p&&p<=48203||48205<=p&&p<=48231||48233<=p&&p<=48259||48261<=p&&p<=48287||48289<=p&&p<=48315||48317<=p&&p<=48343||48345<=p&&p<=48371||48373<=p&&p<=48399||48401<=p&&p<=48427||48429<=p&&p<=48455||48457<=p&&p<=48483||48485<=p&&p<=48511||48513<=p&&p<=48539||48541<=p&&p<=48567||48569<=p&&p<=48595||48597<=p&&p<=48623||48625<=p&&p<=48651||48653<=p&&p<=48679||48681<=p&&p<=48707||48709<=p&&p<=48735||48737<=p&&p<=48763||48765<=p&&p<=48791||48793<=p&&p<=48819||48821<=p&&p<=48847||48849<=p&&p<=48875||48877<=p&&p<=48903||48905<=p&&p<=48931||48933<=p&&p<=48959||48961<=p&&p<=48987||48989<=p&&p<=49015||49017<=p&&p<=49043||49045<=p&&p<=49071||49073<=p&&p<=49099||49101<=p&&p<=49127||49129<=p&&p<=49155||49157<=p&&p<=49183||49185<=p&&p<=49211||49213<=p&&p<=49239||49241<=p&&p<=49267||49269<=p&&p<=49295||49297<=p&&p<=49323||49325<=p&&p<=49351||49353<=p&&p<=49379||49381<=p&&p<=49407||49409<=p&&p<=49435||49437<=p&&p<=49463||49465<=p&&p<=49491||49493<=p&&p<=49519||49521<=p&&p<=49547||49549<=p&&p<=49575||49577<=p&&p<=49603||49605<=p&&p<=49631||49633<=p&&p<=49659||49661<=p&&p<=49687||49689<=p&&p<=49715||49717<=p&&p<=49743||49745<=p&&p<=49771||49773<=p&&p<=49799||49801<=p&&p<=49827||49829<=p&&p<=49855||49857<=p&&p<=49883||49885<=p&&p<=49911||49913<=p&&p<=49939||49941<=p&&p<=49967||49969<=p&&p<=49995||49997<=p&&p<=50023||50025<=p&&p<=50051||50053<=p&&p<=50079||50081<=p&&p<=50107||50109<=p&&p<=50135||50137<=p&&p<=50163||50165<=p&&p<=50191||50193<=p&&p<=50219||50221<=p&&p<=50247||50249<=p&&p<=50275||50277<=p&&p<=50303||50305<=p&&p<=50331||50333<=p&&p<=50359||50361<=p&&p<=50387||50389<=p&&p<=50415||50417<=p&&p<=50443||50445<=p&&p<=50471||50473<=p&&p<=50499||50501<=p&&p<=50527||50529<=p&&p<=50555||50557<=p&&p<=50583||50585<=p&&p<=50611||50613<=p&&p<=50639||50641<=p&&p<=50667||50669<=p&&p<=50695||50697<=p&&p<=50723||50725<=p&&p<=50751||50753<=p&&p<=50779||50781<=p&&p<=50807||50809<=p&&p<=50835||50837<=p&&p<=50863||50865<=p&&p<=50891||50893<=p&&p<=50919||50921<=p&&p<=50947||50949<=p&&p<=50975||50977<=p&&p<=51003||51005<=p&&p<=51031||51033<=p&&p<=51059||51061<=p&&p<=51087||51089<=p&&p<=51115||51117<=p&&p<=51143||51145<=p&&p<=51171||51173<=p&&p<=51199||51201<=p&&p<=51227||51229<=p&&p<=51255||51257<=p&&p<=51283||51285<=p&&p<=51311||51313<=p&&p<=51339||51341<=p&&p<=51367||51369<=p&&p<=51395||51397<=p&&p<=51423||51425<=p&&p<=51451||51453<=p&&p<=51479||51481<=p&&p<=51507||51509<=p&&p<=51535||51537<=p&&p<=51563||51565<=p&&p<=51591||51593<=p&&p<=51619||51621<=p&&p<=51647||51649<=p&&p<=51675||51677<=p&&p<=51703||51705<=p&&p<=51731||51733<=p&&p<=51759||51761<=p&&p<=51787||51789<=p&&p<=51815||51817<=p&&p<=51843||51845<=p&&p<=51871||51873<=p&&p<=51899||51901<=p&&p<=51927||51929<=p&&p<=51955||51957<=p&&p<=51983||51985<=p&&p<=52011||52013<=p&&p<=52039||52041<=p&&p<=52067||52069<=p&&p<=52095||52097<=p&&p<=52123||52125<=p&&p<=52151||52153<=p&&p<=52179||52181<=p&&p<=52207||52209<=p&&p<=52235||52237<=p&&p<=52263||52265<=p&&p<=52291||52293<=p&&p<=52319||52321<=p&&p<=52347||52349<=p&&p<=52375||52377<=p&&p<=52403||52405<=p&&p<=52431||52433<=p&&p<=52459||52461<=p&&p<=52487||52489<=p&&p<=52515||52517<=p&&p<=52543||52545<=p&&p<=52571||52573<=p&&p<=52599||52601<=p&&p<=52627||52629<=p&&p<=52655||52657<=p&&p<=52683||52685<=p&&p<=52711||52713<=p&&p<=52739||52741<=p&&p<=52767||52769<=p&&p<=52795||52797<=p&&p<=52823||52825<=p&&p<=52851||52853<=p&&p<=52879||52881<=p&&p<=52907||52909<=p&&p<=52935||52937<=p&&p<=52963||52965<=p&&p<=52991||52993<=p&&p<=53019||53021<=p&&p<=53047||53049<=p&&p<=53075||53077<=p&&p<=53103||53105<=p&&p<=53131||53133<=p&&p<=53159||53161<=p&&p<=53187||53189<=p&&p<=53215||53217<=p&&p<=53243||53245<=p&&p<=53271||53273<=p&&p<=53299||53301<=p&&p<=53327||53329<=p&&p<=53355||53357<=p&&p<=53383||53385<=p&&p<=53411||53413<=p&&p<=53439||53441<=p&&p<=53467||53469<=p&&p<=53495||53497<=p&&p<=53523||53525<=p&&p<=53551||53553<=p&&p<=53579||53581<=p&&p<=53607||53609<=p&&p<=53635||53637<=p&&p<=53663||53665<=p&&p<=53691||53693<=p&&p<=53719||53721<=p&&p<=53747||53749<=p&&p<=53775||53777<=p&&p<=53803||53805<=p&&p<=53831||53833<=p&&p<=53859||53861<=p&&p<=53887||53889<=p&&p<=53915||53917<=p&&p<=53943||53945<=p&&p<=53971||53973<=p&&p<=53999||54001<=p&&p<=54027||54029<=p&&p<=54055||54057<=p&&p<=54083||54085<=p&&p<=54111||54113<=p&&p<=54139||54141<=p&&p<=54167||54169<=p&&p<=54195||54197<=p&&p<=54223||54225<=p&&p<=54251||54253<=p&&p<=54279||54281<=p&&p<=54307||54309<=p&&p<=54335||54337<=p&&p<=54363||54365<=p&&p<=54391||54393<=p&&p<=54419||54421<=p&&p<=54447||54449<=p&&p<=54475||54477<=p&&p<=54503||54505<=p&&p<=54531||54533<=p&&p<=54559||54561<=p&&p<=54587||54589<=p&&p<=54615||54617<=p&&p<=54643||54645<=p&&p<=54671||54673<=p&&p<=54699||54701<=p&&p<=54727||54729<=p&&p<=54755||54757<=p&&p<=54783||54785<=p&&p<=54811||54813<=p&&p<=54839||54841<=p&&p<=54867||54869<=p&&p<=54895||54897<=p&&p<=54923||54925<=p&&p<=54951||54953<=p&&p<=54979||54981<=p&&p<=55007||55009<=p&&p<=55035||55037<=p&&p<=55063||55065<=p&&p<=55091||55093<=p&&p<=55119||55121<=p&&p<=55147||55149<=p&&p<=55175||55177<=p&&p<=55203?c:d}var g={splitGraphemes:function(t){if(/^[\x20-\xFF]*$/.test(t))return t;const e=[];let i,s=0;for(;(i=f(t,s))<t.length;)e.push(t.slice(s,i)),s=i;return s<t.length&&e.push(t.slice(s)),e},countGraphemes:function(t){let e,i=0,s=0;for(;(e=f(t,s))<t.length;)s=e,i++;return s<t.length&&i++,i},nextBreak:f};class b{constructor(t,e){this.type=t,this.value=e}}class y{constructor(t){this.s=g.splitGraphemes(t),this.pos=0}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:null}peek(){return this.s[this.pos]}scan(t){let e;return(e=t.exec("string"==typeof this.s?this.s.slice(this.pos):this.s.slice(this.pos).join("")))?(this.pos+=e[0].length,e[0]):null}isWhiteSpace(){return/[ \f\n\r\t\v\xA0\u2028\u2029]/.test(this.s[this.pos])}makeToken(){if(this.end())return null;if(this.isWhiteSpace())return this.get(),new b("space");let t=null;if("\\"===this.peek()){if(this.get(),!this.end()){let e=this.scan(/^[a-zA-Z*]+/);"bgroup"===e?t=new b("{"):"egroup"===e?t=new b("}"):(e||(e=this.get()),t=new b("command",e))}}else if("{"===this.peek()||"}"===this.peek())t=new b(this.get());else if("#"===this.peek()){if(this.get(),!this.end()){let e=!1,i=this.peek();/[0-9?]/.test(i)&&(e=!0,this.pos+1<this.s.length)&&(e=/[^0-9A-Za-z]/.test(this.s[this.pos+1])),e?(t=new b("#"),i=this.get(),t.value=i>="0"&&i<="9"?parseInt(i):"?"):t=new b("literal","#")}}else"~"===this.peek()?(this.get(),t=new b("command","space")):"$"===this.peek()?(this.get(),"$"===this.peek()?(this.get(),t=new b("$$")):t=new b("$")):t=new b("literal",this.get());return t}}var v={tokenize:function(t){const e=[],i=t.toString().split(/\r?\n/);let s="",n="";for(const o of i){s+=n,n=" ";const t=o.match(/((?:\\%)|[^%])*/);t&&(s+=t[0])}const r=new y(s);for(;!r.end();){const t=r.makeToken();t&&e.push(t)}return e}},C={"AMS-Regular":{65:[0,.68889,0,0],66:[0,.68889,0,0],67:[0,.68889,0,0],68:[0,.68889,0,0],69:[0,.68889,0,0],70:[0,.68889,0,0],71:[0,.68889,0,0],72:[0,.68889,0,0],73:[0,.68889,0,0],74:[.16667,.68889,0,0],75:[0,.68889,0,0],76:[0,.68889,0,0],77:[0,.68889,0,0],78:[0,.68889,0,0],79:[.16667,.68889,0,0],80:[0,.68889,0,0],81:[.16667,.68889,0,0],82:[0,.68889,0,0],83:[0,.68889,0,0],84:[0,.68889,0,0],85:[0,.68889,0,0],86:[0,.68889,0,0],87:[0,.68889,0,0],88:[0,.68889,0,0],89:[0,.68889,0,0],90:[0,.68889,0,0],107:[0,.68889,0,0],165:[0,.675,.025,0],174:[.15559,.69224,0,0],240:[0,.68889,0,0],295:[0,.68889,0,0],710:[0,.825,0,0],732:[0,.9,0,0],770:[0,.825,0,0],771:[0,.9,0,0],989:[.08167,.58167,0,0],1008:[0,.43056,.04028,0],8245:[0,.54986,0,0],8463:[0,.68889,0,0],8487:[0,.68889,0,0],8498:[0,.68889,0,0],8502:[0,.68889,0,0],8503:[0,.68889,0,0],8504:[0,.68889,0,0],8513:[0,.68889,0,0],8592:[-.03598,.46402,0,0],8594:[-.03598,.46402,0,0],8602:[-.13313,.36687,0,0],8603:[-.13313,.36687,0,0],8606:[.01354,.52239,0,0],8608:[.01354,.52239,0,0],8610:[.01354,.52239,0,0],8611:[.01354,.52239,0,0],8619:[0,.54986,0,0],8620:[0,.54986,0,0],8621:[-.13313,.37788,0,0],8622:[-.13313,.36687,0,0],8624:[0,.69224,0,0],8625:[0,.69224,0,0],8630:[0,.43056,0,0],8631:[0,.43056,0,0],8634:[.08198,.58198,0,0],8635:[.08198,.58198,0,0],8638:[.19444,.69224,0,0],8639:[.19444,.69224,0,0],8642:[.19444,.69224,0,0],8643:[.19444,.69224,0,0],8644:[.1808,.675,0,0],8646:[.1808,.675,0,0],8647:[.1808,.675,0,0],8648:[.19444,.69224,0,0],8649:[.1808,.675,0,0],8650:[.19444,.69224,0,0],8651:[.01354,.52239,0,0],8652:[.01354,.52239,0,0],8653:[-.13313,.36687,0,0],8654:[-.13313,.36687,0,0],8655:[-.13313,.36687,0,0],8666:[.13667,.63667,0,0],8667:[.13667,.63667,0,0],8669:[-.13313,.37788,0,0],8672:[-.064,.437,0,0],8674:[-.064,.437,0,0],8705:[0,.825,0,0],8708:[0,.68889,0,0],8709:[.08167,.58167,0,0],8717:[0,.43056,0,0],8722:[-.03598,.46402,0,0],8724:[.08198,.69224,0,0],8726:[.08167,.58167,0,0],8733:[0,.69224,0,0],8736:[0,.69224,0,0],8737:[0,.69224,0,0],8738:[.03517,.52239,0,0],8739:[.08167,.58167,0,0],8740:[.25142,.74111,0,0],8741:[.08167,.58167,0,0],8742:[.25142,.74111,0,0],8756:[0,.69224,0,0],8757:[0,.69224,0,0],8764:[-.13313,.36687,0,0],8765:[-.13313,.37788,0,0],8769:[-.13313,.36687,0,0],8770:[-.03625,.46375,0,0],8774:[.30274,.79383,0,0],8776:[-.01688,.48312,0,0],8778:[.08167,.58167,0,0],8782:[.06062,.54986,0,0],8783:[.06062,.54986,0,0],8785:[.08198,.58198,0,0],8786:[.08198,.58198,0,0],8787:[.08198,.58198,0,0],8790:[0,.69224,0,0],8791:[.22958,.72958,0,0],8796:[.08198,.91667,0,0],8806:[.25583,.75583,0,0],8807:[.25583,.75583,0,0],8808:[.25142,.75726,0,0],8809:[.25142,.75726,0,0],8812:[.25583,.75583,0,0],8814:[.20576,.70576,0,0],8815:[.20576,.70576,0,0],8816:[.30274,.79383,0,0],8817:[.30274,.79383,0,0],8818:[.22958,.72958,0,0],8819:[.22958,.72958,0,0],8822:[.1808,.675,0,0],8823:[.1808,.675,0,0],8828:[.13667,.63667,0,0],8829:[.13667,.63667,0,0],8830:[.22958,.72958,0,0],8831:[.22958,.72958,0,0],8832:[.20576,.70576,0,0],8833:[.20576,.70576,0,0],8840:[.30274,.79383,0,0],8841:[.30274,.79383,0,0],8842:[.13597,.63597,0,0],8843:[.13597,.63597,0,0],8847:[.03517,.54986,0,0],8848:[.03517,.54986,0,0],8858:[.08198,.58198,0,0],8859:[.08198,.58198,0,0],8861:[.08198,.58198,0,0],8862:[0,.675,0,0],8863:[0,.675,0,0],8864:[0,.675,0,0],8865:[0,.675,0,0],8872:[0,.69224,0,0],8873:[0,.69224,0,0],8874:[0,.69224,0,0],8876:[0,.68889,0,0],8877:[0,.68889,0,0],8878:[0,.68889,0,0],8879:[0,.68889,0,0],8882:[.03517,.54986,0,0],8883:[.03517,.54986,0,0],8884:[.13667,.63667,0,0],8885:[.13667,.63667,0,0],8888:[0,.54986,0,0],8890:[.19444,.43056,0,0],8891:[.19444,.69224,0,0],8892:[.19444,.69224,0,0],8901:[0,.54986,0,0],8903:[.08167,.58167,0,0],8905:[.08167,.58167,0,0],8906:[.08167,.58167,0,0],8907:[0,.69224,0,0],8908:[0,.69224,0,0],8909:[-.03598,.46402,0,0],8910:[0,.54986,0,0],8911:[0,.54986,0,0],8912:[.03517,.54986,0,0],8913:[.03517,.54986,0,0],8914:[0,.54986,0,0],8915:[0,.54986,0,0],8916:[0,.69224,0,0],8918:[.0391,.5391,0,0],8919:[.0391,.5391,0,0],8920:[.03517,.54986,0,0],8921:[.03517,.54986,0,0],8922:[.38569,.88569,0,0],8923:[.38569,.88569,0,0],8926:[.13667,.63667,0,0],8927:[.13667,.63667,0,0],8928:[.30274,.79383,0,0],8929:[.30274,.79383,0,0],8934:[.23222,.74111,0,0],8935:[.23222,.74111,0,0],8936:[.23222,.74111,0,0],8937:[.23222,.74111,0,0],8938:[.20576,.70576,0,0],8939:[.20576,.70576,0,0],8940:[.30274,.79383,0,0],8941:[.30274,.79383,0,0],8994:[.19444,.69224,0,0],8995:[.19444,.69224,0,0],9416:[.15559,.69224,0,0],9484:[0,.69224,0,0],9488:[0,.69224,0,0],9492:[0,.37788,0,0],9496:[0,.37788,0,0],9585:[.19444,.68889,0,0],9586:[.19444,.74111,0,0],9632:[0,.675,0,0],9633:[0,.675,0,0],9650:[0,.54986,0,0],9651:[0,.54986,0,0],9654:[.03517,.54986,0,0],9660:[0,.54986,0,0],9661:[0,.54986,0,0],9664:[.03517,.54986,0,0],9674:[.11111,.69224,0,0],9733:[.19444,.69224,0,0],10003:[0,.69224,0,0],10016:[0,.69224,0,0],10731:[.11111,.69224,0,0],10846:[.19444,.75583,0,0],10877:[.13667,.63667,0,0],10878:[.13667,.63667,0,0],10885:[.25583,.75583,0,0],10886:[.25583,.75583,0,0],10887:[.13597,.63597,0,0],10888:[.13597,.63597,0,0],10889:[.26167,.75726,0,0],10890:[.26167,.75726,0,0],10891:[.48256,.98256,0,0],10892:[.48256,.98256,0,0],10901:[.13667,.63667,0,0],10902:[.13667,.63667,0,0],10933:[.25142,.75726,0,0],10934:[.25142,.75726,0,0],10935:[.26167,.75726,0,0],10936:[.26167,.75726,0,0],10937:[.26167,.75726,0,0],10938:[.26167,.75726,0,0],10949:[.25583,.75583,0,0],10950:[.25583,.75583,0,0],10955:[.28481,.79383,0,0],10956:[.28481,.79383,0,0],57350:[.08167,.58167,0,0],57351:[.08167,.58167,0,0],57352:[.08167,.58167,0,0],57353:[0,.43056,.04028,0],57356:[.25142,.75726,0,0],57357:[.25142,.75726,0,0],57358:[.41951,.91951,0,0],57359:[.30274,.79383,0,0],57360:[.30274,.79383,0,0],57361:[.41951,.91951,0,0],57366:[.25142,.75726,0,0],57367:[.25142,.75726,0,0],57368:[.25142,.75726,0,0],57369:[.25142,.75726,0,0],57370:[.13597,.63597,0,0],57371:[.13597,.63597,0,0]},"Caligraphic-Regular":{48:[0,.43056,0,0],49:[0,.43056,0,0],50:[0,.43056,0,0],51:[.19444,.43056,0,0],52:[.19444,.43056,0,0],53:[.19444,.43056,0,0],54:[0,.64444,0,0],55:[.19444,.43056,0,0],56:[0,.64444,0,0],57:[.19444,.43056,0,0],65:[0,.68333,0,.19445],66:[0,.68333,.03041,.13889],67:[0,.68333,.05834,.13889],68:[0,.68333,.02778,.08334],69:[0,.68333,.08944,.11111],70:[0,.68333,.09931,.11111],71:[.09722,.68333,.0593,.11111],72:[0,.68333,.00965,.11111],73:[0,.68333,.07382,0],74:[.09722,.68333,.18472,.16667],75:[0,.68333,.01445,.05556],76:[0,.68333,0,.13889],77:[0,.68333,0,.13889],78:[0,.68333,.14736,.08334],79:[0,.68333,.02778,.11111],80:[0,.68333,.08222,.08334],81:[.09722,.68333,0,.11111],82:[0,.68333,0,.08334],83:[0,.68333,.075,.13889],84:[0,.68333,.25417,0],85:[0,.68333,.09931,.08334],86:[0,.68333,.08222,0],87:[0,.68333,.08222,.08334],88:[0,.68333,.14643,.13889],89:[.09722,.68333,.08222,.08334],90:[0,.68333,.07944,.13889]},"Fraktur-Regular":{33:[0,.69141,0,0],34:[0,.69141,0,0],38:[0,.69141,0,0],39:[0,.69141,0,0],40:[.24982,.74947,0,0],41:[.24982,.74947,0,0],42:[0,.62119,0,0],43:[.08319,.58283,0,0],44:[0,.10803,0,0],45:[.08319,.58283,0,0],46:[0,.10803,0,0],47:[.24982,.74947,0,0],48:[0,.47534,0,0],49:[0,.47534,0,0],50:[0,.47534,0,0],51:[.18906,.47534,0,0],52:[.18906,.47534,0,0],53:[.18906,.47534,0,0],54:[0,.69141,0,0],55:[.18906,.47534,0,0],56:[0,.69141,0,0],57:[.18906,.47534,0,0],58:[0,.47534,0,0],59:[.12604,.47534,0,0],61:[-.13099,.36866,0,0],63:[0,.69141,0,0],65:[0,.69141,0,0],66:[0,.69141,0,0],67:[0,.69141,0,0],68:[0,.69141,0,0],69:[0,.69141,0,0],70:[.12604,.69141,0,0],71:[0,.69141,0,0],72:[.06302,.69141,0,0],73:[0,.69141,0,0],74:[.12604,.69141,0,0],75:[0,.69141,0,0],76:[0,.69141,0,0],77:[0,.69141,0,0],78:[0,.69141,0,0],79:[0,.69141,0,0],80:[.18906,.69141,0,0],81:[.03781,.69141,0,0],82:[0,.69141,0,0],83:[0,.69141,0,0],84:[0,.69141,0,0],85:[0,.69141,0,0],86:[0,.69141,0,0],87:[0,.69141,0,0],88:[0,.69141,0,0],89:[.18906,.69141,0,0],90:[.12604,.69141,0,0],91:[.24982,.74947,0,0],93:[.24982,.74947,0,0],94:[0,.69141,0,0],97:[0,.47534,0,0],98:[0,.69141,0,0],99:[0,.47534,0,0],100:[0,.62119,0,0],101:[0,.47534,0,0],102:[.18906,.69141,0,0],103:[.18906,.47534,0,0],104:[.18906,.69141,0,0],105:[0,.69141,0,0],106:[0,.69141,0,0],107:[0,.69141,0,0],108:[0,.69141,0,0],109:[0,.47534,0,0],110:[0,.47534,0,0],111:[0,.47534,0,0],112:[.18906,.52396,0,0],113:[.18906,.47534,0,0],114:[0,.47534,0,0],115:[0,.47534,0,0],116:[0,.62119,0,0],117:[0,.47534,0,0],118:[0,.52396,0,0],119:[0,.52396,0,0],120:[.18906,.47534,0,0],121:[.18906,.47534,0,0],122:[.18906,.47534,0,0],8216:[0,.69141,0,0],8217:[0,.69141,0,0],58112:[0,.62119,0,0],58113:[0,.62119,0,0],58114:[.18906,.69141,0,0],58115:[.18906,.69141,0,0],58116:[.18906,.47534,0,0],58117:[0,.69141,0,0],58118:[0,.62119,0,0],58119:[0,.47534,0,0]},"Main-Bold":{33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.13333,.63333,0,0],44:[.19444,.15556,0,0],45:[0,.44444,0,0],46:[0,.15556,0,0],47:[.25,.75,0,0],48:[0,.64444,0,0],49:[0,.64444,0,0],50:[0,.64444,0,0],51:[0,.64444,0,0],52:[0,.64444,0,0],53:[0,.64444,0,0],54:[0,.64444,0,0],55:[0,.64444,0,0],56:[0,.64444,0,0],57:[0,.64444,0,0],58:[0,.44444,0,0],59:[.19444,.44444,0,0],60:[.08556,.58556,0,0],61:[-.10889,.39111,0,0],62:[.08556,.58556,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.68611,0,0],66:[0,.68611,0,0],67:[0,.68611,0,0],68:[0,.68611,0,0],69:[0,.68611,0,0],70:[0,.68611,0,0],71:[0,.68611,0,0],72:[0,.68611,0,0],73:[0,.68611,0,0],74:[0,.68611,0,0],75:[0,.68611,0,0],76:[0,.68611,0,0],77:[0,.68611,0,0],78:[0,.68611,0,0],79:[0,.68611,0,0],80:[0,.68611,0,0],81:[.19444,.68611,0,0],82:[0,.68611,0,0],83:[0,.68611,0,0],84:[0,.68611,0,0],85:[0,.68611,0,0],86:[0,.68611,.01597,0],87:[0,.68611,.01597,0],88:[0,.68611,0,0],89:[0,.68611,.02875,0],90:[0,.68611,0,0],91:[.25,.75,0,0],92:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.31,.13444,.03194,0],96:[0,.69444,0,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[0,.69444,.10903,0],103:[.19444,.44444,.01597,0],104:[0,.69444,0,0],105:[0,.69444,0,0],106:[.19444,.69444,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,0,0],114:[0,.44444,0,0],115:[0,.44444,0,0],116:[0,.63492,0,0],117:[0,.44444,0,0],118:[0,.44444,.01597,0],119:[0,.44444,.01597,0],120:[0,.44444,0,0],121:[.19444,.44444,.01597,0],122:[0,.44444,0,0],123:[.25,.75,0,0],124:[.25,.75,0,0],125:[.25,.75,0,0],126:[.35,.34444,0,0],168:[0,.69444,0,0],172:[0,.44444,0,0],175:[0,.59611,0,0],176:[0,.69444,0,0],177:[.13333,.63333,0,0],180:[0,.69444,0,0],215:[.13333,.63333,0,0],247:[.13333,.63333,0,0],305:[0,.44444,0,0],567:[.19444,.44444,0,0],710:[0,.69444,0,0],711:[0,.63194,0,0],713:[0,.59611,0,0],714:[0,.69444,0,0],715:[0,.69444,0,0],728:[0,.69444,0,0],729:[0,.69444,0,0],730:[0,.69444,0,0],732:[0,.69444,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.69444,0,0],772:[0,.59611,0,0],774:[0,.69444,0,0],775:[0,.69444,0,0],776:[0,.69444,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.63194,0,0],824:[.19444,.69444,0,0],915:[0,.68611,0,0],916:[0,.68611,0,0],920:[0,.68611,0,0],923:[0,.68611,0,0],926:[0,.68611,0,0],928:[0,.68611,0,0],931:[0,.68611,0,0],933:[0,.68611,0,0],934:[0,.68611,0,0],936:[0,.68611,0,0],937:[0,.68611,0,0],8211:[0,.44444,.03194,0],8212:[0,.44444,.03194,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0],8224:[.19444,.69444,0,0],8225:[.19444,.69444,0,0],8242:[0,.55556,0,0],8407:[0,.72444,.15486,0],8463:[0,.69444,0,0],8465:[0,.69444,0,0],8467:[0,.69444,0,0],8472:[.19444,.44444,0,0],8476:[0,.69444,0,0],8501:[0,.69444,0,0],8592:[-.10889,.39111,0,0],8593:[.19444,.69444,0,0],8594:[-.10889,.39111,0,0],8595:[.19444,.69444,0,0],8596:[-.10889,.39111,0,0],8597:[.25,.75,0,0],8598:[.19444,.69444,0,0],8599:[.19444,.69444,0,0],8600:[.19444,.69444,0,0],8601:[.19444,.69444,0,0],8636:[-.10889,.39111,0,0],8637:[-.10889,.39111,0,0],8640:[-.10889,.39111,0,0],8641:[-.10889,.39111,0,0],8656:[-.10889,.39111,0,0],8657:[.19444,.69444,0,0],8658:[-.10889,.39111,0,0],8659:[.19444,.69444,0,0],8660:[-.10889,.39111,0,0],8661:[.25,.75,0,0],8704:[0,.69444,0,0],8706:[0,.69444,.06389,0],8707:[0,.69444,0,0],8709:[.05556,.75,0,0],8711:[0,.68611,0,0],8712:[.08556,.58556,0,0],8715:[.08556,.58556,0,0],8722:[.13333,.63333,0,0],8723:[.13333,.63333,0,0],8725:[.25,.75,0,0],8726:[.25,.75,0,0],8727:[-.02778,.47222,0,0],8728:[-.02639,.47361,0,0],8729:[-.02639,.47361,0,0],8730:[.18,.82,0,0],8733:[0,.44444,0,0],8734:[0,.44444,0,0],8736:[0,.69224,0,0],8739:[.25,.75,0,0],8741:[.25,.75,0,0],8743:[0,.55556,0,0],8744:[0,.55556,0,0],8745:[0,.55556,0,0],8746:[0,.55556,0,0],8747:[.19444,.69444,.12778,0],8764:[-.10889,.39111,0,0],8768:[.19444,.69444,0,0],8771:[.00222,.50222,0,0],8776:[.02444,.52444,0,0],8781:[.00222,.50222,0,0],8801:[.00222,.50222,0,0],8804:[.19667,.69667,0,0],8805:[.19667,.69667,0,0],8810:[.08556,.58556,0,0],8811:[.08556,.58556,0,0],8826:[.08556,.58556,0,0],8827:[.08556,.58556,0,0],8834:[.08556,.58556,0,0],8835:[.08556,.58556,0,0],8838:[.19667,.69667,0,0],8839:[.19667,.69667,0,0],8846:[0,.55556,0,0],8849:[.19667,.69667,0,0],8850:[.19667,.69667,0,0],8851:[0,.55556,0,0],8852:[0,.55556,0,0],8853:[.13333,.63333,0,0],8854:[.13333,.63333,0,0],8855:[.13333,.63333,0,0],8856:[.13333,.63333,0,0],8857:[.13333,.63333,0,0],8866:[0,.69444,0,0],8867:[0,.69444,0,0],8868:[0,.69444,0,0],8869:[0,.69444,0,0],8900:[-.02639,.47361,0,0],8901:[-.02639,.47361,0,0],8902:[-.02778,.47222,0,0],8968:[.25,.75,0,0],8969:[.25,.75,0,0],8970:[.25,.75,0,0],8971:[.25,.75,0,0],8994:[-.13889,.36111,0,0],8995:[-.13889,.36111,0,0],9651:[.19444,.69444,0,0],9657:[-.02778,.47222,0,0],9661:[.19444,.69444,0,0],9667:[-.02778,.47222,0,0],9711:[.19444,.69444,0,0],9824:[.12963,.69444,0,0],9825:[.12963,.69444,0,0],9826:[.12963,.69444,0,0],9827:[.12963,.69444,0,0],9837:[0,.75,0,0],9838:[.19444,.69444,0,0],9839:[.19444,.69444,0,0],10216:[.25,.75,0,0],10217:[.25,.75,0,0],10815:[0,.68611,0,0],10927:[.19667,.69667,0,0],10928:[.19667,.69667,0,0]},"Main-Italic":{33:[0,.69444,.12417,0],34:[0,.69444,.06961,0],35:[.19444,.69444,.06616,0],37:[.05556,.75,.13639,0],38:[0,.69444,.09694,0],39:[0,.69444,.12417,0],40:[.25,.75,.16194,0],41:[.25,.75,.03694,0],42:[0,.75,.14917,0],43:[.05667,.56167,.03694,0],44:[.19444,.10556,0,0],45:[0,.43056,.02826,0],46:[0,.10556,0,0],47:[.25,.75,.16194,0],48:[0,.64444,.13556,0],49:[0,.64444,.13556,0],50:[0,.64444,.13556,0],51:[0,.64444,.13556,0],52:[.19444,.64444,.13556,0],53:[0,.64444,.13556,0],54:[0,.64444,.13556,0],55:[.19444,.64444,.13556,0],56:[0,.64444,.13556,0],57:[0,.64444,.13556,0],58:[0,.43056,.0582,0],59:[.19444,.43056,.0582,0],61:[-.13313,.36687,.06616,0],63:[0,.69444,.1225,0],64:[0,.69444,.09597,0],65:[0,.68333,0,0],66:[0,.68333,.10257,0],67:[0,.68333,.14528,0],68:[0,.68333,.09403,0],69:[0,.68333,.12028,0],70:[0,.68333,.13305,0],71:[0,.68333,.08722,0],72:[0,.68333,.16389,0],73:[0,.68333,.15806,0],74:[0,.68333,.14028,0],75:[0,.68333,.14528,0],76:[0,.68333,0,0],77:[0,.68333,.16389,0],78:[0,.68333,.16389,0],79:[0,.68333,.09403,0],80:[0,.68333,.10257,0],81:[.19444,.68333,.09403,0],82:[0,.68333,.03868,0],83:[0,.68333,.11972,0],84:[0,.68333,.13305,0],85:[0,.68333,.16389,0],86:[0,.68333,.18361,0],87:[0,.68333,.18361,0],88:[0,.68333,.15806,0],89:[0,.68333,.19383,0],90:[0,.68333,.14528,0],91:[.25,.75,.1875,0],93:[.25,.75,.10528,0],94:[0,.69444,.06646,0],95:[.31,.12056,.09208,0],97:[0,.43056,.07671,0],98:[0,.69444,.06312,0],99:[0,.43056,.05653,0],100:[0,.69444,.10333,0],101:[0,.43056,.07514,0],102:[.19444,.69444,.21194,0],103:[.19444,.43056,.08847,0],104:[0,.69444,.07671,0],105:[0,.65536,.1019,0],106:[.19444,.65536,.14467,0],107:[0,.69444,.10764,0],108:[0,.69444,.10333,0],109:[0,.43056,.07671,0],110:[0,.43056,.07671,0],111:[0,.43056,.06312,0],112:[.19444,.43056,.06312,0],113:[.19444,.43056,.08847,0],114:[0,.43056,.10764,0],115:[0,.43056,.08208,0],116:[0,.61508,.09486,0],117:[0,.43056,.07671,0],118:[0,.43056,.10764,0],119:[0,.43056,.10764,0],120:[0,.43056,.12042,0],121:[.19444,.43056,.08847,0],122:[0,.43056,.12292,0],126:[.35,.31786,.11585,0],163:[0,.69444,0,0],305:[0,.43056,0,.02778],567:[.19444,.43056,0,.08334],768:[0,.69444,0,0],769:[0,.69444,.09694,0],770:[0,.69444,.06646,0],771:[0,.66786,.11585,0],772:[0,.56167,.10333,0],774:[0,.69444,.10806,0],775:[0,.66786,.11752,0],776:[0,.66786,.10474,0],778:[0,.69444,0,0],779:[0,.69444,.1225,0],780:[0,.62847,.08295,0],915:[0,.68333,.13305,0],916:[0,.68333,0,0],920:[0,.68333,.09403,0],923:[0,.68333,0,0],926:[0,.68333,.15294,0],928:[0,.68333,.16389,0],931:[0,.68333,.12028,0],933:[0,.68333,.11111,0],934:[0,.68333,.05986,0],936:[0,.68333,.11111,0],937:[0,.68333,.10257,0],8211:[0,.43056,.09208,0],8212:[0,.43056,.09208,0],8216:[0,.69444,.12417,0],8217:[0,.69444,.12417,0],8220:[0,.69444,.1685,0],8221:[0,.69444,.06961,0],8463:[0,.68889,0,0]},"Main-Regular":{32:[0,0,0,0],33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.08333,.58333,0,0],44:[.19444,.10556,0,0],45:[0,.43056,0,0],46:[0,.10556,0,0],47:[.25,.75,0,0],48:[0,.64444,0,0],49:[0,.64444,0,0],50:[0,.64444,0,0],51:[0,.64444,0,0],52:[0,.64444,0,0],53:[0,.64444,0,0],54:[0,.64444,0,0],55:[0,.64444,0,0],56:[0,.64444,0,0],57:[0,.64444,0,0],58:[0,.43056,0,0],59:[.19444,.43056,0,0],60:[.0391,.5391,0,0],61:[-.13313,.36687,0,0],62:[.0391,.5391,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.68333,0,0],66:[0,.68333,0,0],67:[0,.68333,0,0],68:[0,.68333,0,0],69:[0,.68333,0,0],70:[0,.68333,0,0],71:[0,.68333,0,0],72:[0,.68333,0,0],73:[0,.68333,0,0],74:[0,.68333,0,0],75:[0,.68333,0,0],76:[0,.68333,0,0],77:[0,.68333,0,0],78:[0,.68333,0,0],79:[0,.68333,0,0],80:[0,.68333,0,0],81:[.19444,.68333,0,0],82:[0,.68333,0,0],83:[0,.68333,0,0],84:[0,.68333,0,0],85:[0,.68333,0,0],86:[0,.68333,.01389,0],87:[0,.68333,.01389,0],88:[0,.68333,0,0],89:[0,.68333,.025,0],90:[0,.68333,0,0],91:[.25,.75,0,0],92:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.31,.12056,.02778,0],96:[0,.69444,0,0],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,0],100:[0,.69444,0,0],101:[0,.43056,0,0],102:[0,.69444,.07778,0],103:[.19444,.43056,.01389,0],104:[0,.69444,0,0],105:[0,.66786,0,0],106:[.19444,.66786,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,0],112:[.19444,.43056,0,0],113:[.19444,.43056,0,0],114:[0,.43056,0,0],115:[0,.43056,0,0],116:[0,.61508,0,0],117:[0,.43056,0,0],118:[0,.43056,.01389,0],119:[0,.43056,.01389,0],120:[0,.43056,0,0],121:[.19444,.43056,.01389,0],122:[0,.43056,0,0],123:[.25,.75,0,0],124:[.25,.75,0,0],125:[.25,.75,0,0],126:[.35,.31786,0,0],160:[0,0,0,0],168:[0,.66786,0,0],172:[0,.43056,0,0],175:[0,.56778,0,0],176:[0,.69444,0,0],177:[.08333,.58333,0,0],180:[0,.69444,0,0],215:[.08333,.58333,0,0],247:[.08333,.58333,0,0],305:[0,.43056,0,0],567:[.19444,.43056,0,0],710:[0,.69444,0,0],711:[0,.62847,0,0],713:[0,.56778,0,0],714:[0,.69444,0,0],715:[0,.69444,0,0],728:[0,.69444,0,0],729:[0,.66786,0,0],730:[0,.69444,0,0],732:[0,.66786,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.66786,0,0],772:[0,.56778,0,0],774:[0,.69444,0,0],775:[0,.66786,0,0],776:[0,.66786,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.62847,0,0],824:[.19444,.69444,0,0],915:[0,.68333,0,0],916:[0,.68333,0,0],920:[0,.68333,0,0],923:[0,.68333,0,0],926:[0,.68333,0,0],928:[0,.68333,0,0],931:[0,.68333,0,0],933:[0,.68333,0,0],934:[0,.68333,0,0],936:[0,.68333,0,0],937:[0,.68333,0,0],8211:[0,.43056,.02778,0],8212:[0,.43056,.02778,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0],8224:[.19444,.69444,0,0],8225:[.19444,.69444,0,0],8230:[0,.12,0,0],8242:[0,.55556,0,0],8407:[0,.71444,.15382,0],8463:[0,.68889,0,0],8465:[0,.69444,0,0],8467:[0,.69444,0,.11111],8472:[.19444,.43056,0,.11111],8476:[0,.69444,0,0],8501:[0,.69444,0,0],8592:[-.13313,.36687,0,0],8593:[.19444,.69444,0,0],8594:[-.13313,.36687,0,0],8595:[.19444,.69444,0,0],8596:[-.13313,.36687,0,0],8597:[.25,.75,0,0],8598:[.19444,.69444,0,0],8599:[.19444,.69444,0,0],8600:[.19444,.69444,0,0],8601:[.19444,.69444,0,0],8614:[.011,.511,0,0],8617:[.011,.511,0,0],8618:[.011,.511,0,0],8636:[-.13313,.36687,0,0],8637:[-.13313,.36687,0,0],8640:[-.13313,.36687,0,0],8641:[-.13313,.36687,0,0],8652:[.011,.671,0,0],8656:[-.13313,.36687,0,0],8657:[.19444,.69444,0,0],8658:[-.13313,.36687,0,0],8659:[.19444,.69444,0,0],8660:[-.13313,.36687,0,0],8661:[.25,.75,0,0],8704:[0,.69444,0,0],8706:[0,.69444,.05556,.08334],8707:[0,.69444,0,0],8709:[.05556,.75,0,0],8711:[0,.68333,0,0],8712:[.0391,.5391,0,0],8715:[.0391,.5391,0,0],8722:[.08333,.58333,0,0],8723:[.08333,.58333,0,0],8725:[.25,.75,0,0],8726:[.25,.75,0,0],8727:[-.03472,.46528,0,0],8728:[-.05555,.44445,0,0],8729:[-.05555,.44445,0,0],8730:[.2,.8,0,0],8733:[0,.43056,0,0],8734:[0,.43056,0,0],8736:[0,.69224,0,0],8739:[.25,.75,0,0],8741:[.25,.75,0,0],8743:[0,.55556,0,0],8744:[0,.55556,0,0],8745:[0,.55556,0,0],8746:[0,.55556,0,0],8747:[.19444,.69444,.11111,0],8764:[-.13313,.36687,0,0],8768:[.19444,.69444,0,0],8771:[-.03625,.46375,0,0],8773:[-.022,.589,0,0],8776:[-.01688,.48312,0,0],8781:[-.03625,.46375,0,0],8784:[-.133,.67,0,0],8800:[.215,.716,0,0],8801:[-.03625,.46375,0,0],8804:[.13597,.63597,0,0],8805:[.13597,.63597,0,0],8810:[.0391,.5391,0,0],8811:[.0391,.5391,0,0],8826:[.0391,.5391,0,0],8827:[.0391,.5391,0,0],8834:[.0391,.5391,0,0],8835:[.0391,.5391,0,0],8838:[.13597,.63597,0,0],8839:[.13597,.63597,0,0],8846:[0,.55556,0,0],8849:[.13597,.63597,0,0],8850:[.13597,.63597,0,0],8851:[0,.55556,0,0],8852:[0,.55556,0,0],8853:[.08333,.58333,0,0],8854:[.08333,.58333,0,0],8855:[.08333,.58333,0,0],8856:[.08333,.58333,0,0],8857:[.08333,.58333,0,0],8866:[0,.69444,0,0],8867:[0,.69444,0,0],8868:[0,.69444,0,0],8869:[0,.69444,0,0],8872:[.249,.75,0,0],8900:[-.05555,.44445,0,0],8901:[-.05555,.44445,0,0],8902:[-.03472,.46528,0,0],8904:[.005,.505,0,0],8942:[.03,.9,0,0],8943:[-.19,.31,0,0],8945:[-.1,.82,0,0],8968:[.25,.75,0,0],8969:[.25,.75,0,0],8970:[.25,.75,0,0],8971:[.25,.75,0,0],8994:[-.14236,.35764,0,0],8995:[-.14236,.35764,0,0],9136:[.244,.744,0,0],9137:[.244,.744,0,0],9651:[.19444,.69444,0,0],9657:[-.03472,.46528,0,0],9661:[.19444,.69444,0,0],9667:[-.03472,.46528,0,0],9711:[.19444,.69444,0,0],9824:[.12963,.69444,0,0],9825:[.12963,.69444,0,0],9826:[.12963,.69444,0,0],9827:[.12963,.69444,0,0],9837:[0,.75,0,0],9838:[.19444,.69444,0,0],9839:[.19444,.69444,0,0],10216:[.25,.75,0,0],10217:[.25,.75,0,0],10222:[.244,.744,0,0],10223:[.244,.744,0,0],10229:[.011,.511,0,0],10230:[.011,.511,0,0],10231:[.011,.511,0,0],10232:[.024,.525,0,0],10233:[.024,.525,0,0],10234:[.024,.525,0,0],10236:[.011,.511,0,0],10815:[0,.68333,0,0],10927:[.13597,.63597,0,0],10928:[.13597,.63597,0,0]},"Math-BoldItalic":{47:[.19444,.69444,0,0],65:[0,.68611,0,0],66:[0,.68611,.04835,0],67:[0,.68611,.06979,0],68:[0,.68611,.03194,0],69:[0,.68611,.05451,0],70:[0,.68611,.15972,0],71:[0,.68611,0,0],72:[0,.68611,.08229,0],73:[0,.68611,.07778,0],74:[0,.68611,.10069,0],75:[0,.68611,.06979,0],76:[0,.68611,0,0],77:[0,.68611,.11424,0],78:[0,.68611,.11424,0],79:[0,.68611,.03194,0],80:[0,.68611,.15972,0],81:[.19444,.68611,0,0],82:[0,.68611,.00421,0],83:[0,.68611,.05382,0],84:[0,.68611,.15972,0],85:[0,.68611,.11424,0],86:[0,.68611,.25555,0],87:[0,.68611,.15972,0],88:[0,.68611,.07778,0],89:[0,.68611,.25555,0],90:[0,.68611,.06979,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[.19444,.69444,.11042,0],103:[.19444,.44444,.03704,0],104:[0,.69444,0,0],105:[0,.69326,0,0],106:[.19444,.69326,.0622,0],107:[0,.69444,.01852,0],108:[0,.69444,.0088,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,.03704,0],114:[0,.44444,.03194,0],115:[0,.44444,0,0],116:[0,.63492,0,0],117:[0,.44444,0,0],118:[0,.44444,.03704,0],119:[0,.44444,.02778,0],120:[0,.44444,0,0],121:[.19444,.44444,.03704,0],122:[0,.44444,.04213,0],915:[0,.68611,.15972,0],916:[0,.68611,0,0],920:[0,.68611,.03194,0],923:[0,.68611,0,0],926:[0,.68611,.07458,0],928:[0,.68611,.08229,0],931:[0,.68611,.05451,0],933:[0,.68611,.15972,0],934:[0,.68611,0,0],936:[0,.68611,.11653,0],937:[0,.68611,.04835,0],945:[0,.44444,0,0],946:[.19444,.69444,.03403,0],947:[.19444,.44444,.06389,0],948:[0,.69444,.03819,0],949:[0,.44444,0,0],950:[.19444,.69444,.06215,0],951:[.19444,.44444,.03704,0],952:[0,.69444,.03194,0],953:[0,.44444,0,0],954:[0,.44444,0,0],955:[0,.69444,0,0],956:[.19444,.44444,0,0],957:[0,.44444,.06898,0],958:[.19444,.69444,.03021,0],959:[0,.44444,0,0],960:[0,.44444,.03704,0],961:[.19444,.44444,0,0],962:[.09722,.44444,.07917,0],963:[0,.44444,.03704,0],964:[0,.44444,.13472,0],965:[0,.44444,.03704,0],966:[.19444,.44444,0,0],967:[.19444,.44444,0,0],968:[.19444,.69444,.03704,0],969:[0,.44444,.03704,0],977:[0,.69444,0,0],981:[.19444,.69444,0,0],982:[0,.44444,.03194,0],1009:[.19444,.44444,0,0],1013:[0,.44444,0,0]},"Math-Italic":{47:[.19444,.69444,0,0],65:[0,.68333,0,.13889],66:[0,.68333,.05017,.08334],67:[0,.68333,.07153,.08334],68:[0,.68333,.02778,.05556],69:[0,.68333,.05764,.08334],70:[0,.68333,.13889,.08334],71:[0,.68333,0,.08334],72:[0,.68333,.08125,.05556],73:[0,.68333,.07847,.11111],74:[0,.68333,.09618,.16667],75:[0,.68333,.07153,.05556],76:[0,.68333,0,.02778],77:[0,.68333,.10903,.08334],78:[0,.68333,.10903,.08334],79:[0,.68333,.02778,.08334],80:[0,.68333,.13889,.08334],81:[.19444,.68333,0,.08334],82:[0,.68333,.00773,.08334],83:[0,.68333,.05764,.08334],84:[0,.68333,.13889,.08334],85:[0,.68333,.10903,.02778],86:[0,.68333,.22222,0],87:[0,.68333,.13889,0],88:[0,.68333,.07847,.08334],89:[0,.68333,.22222,0],90:[0,.68333,.07153,.08334],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,.05556],100:[0,.69444,0,.16667],101:[0,.43056,0,.05556],102:[.19444,.69444,.10764,.16667],103:[.19444,.43056,.03588,.02778],104:[0,.69444,0,0],105:[0,.65952,0,0],106:[.19444,.65952,.05724,0],107:[0,.69444,.03148,0],108:[0,.69444,.01968,.08334],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,.05556],112:[.19444,.43056,0,.08334],113:[.19444,.43056,.03588,.08334],114:[0,.43056,.02778,.05556],115:[0,.43056,0,.05556],116:[0,.61508,0,.08334],117:[0,.43056,0,.02778],118:[0,.43056,.03588,.02778],119:[0,.43056,.02691,.08334],120:[0,.43056,0,.02778],121:[.19444,.43056,.03588,.05556],122:[0,.43056,.04398,.05556],915:[0,.68333,.13889,.08334],916:[0,.68333,0,.16667],920:[0,.68333,.02778,.08334],923:[0,.68333,0,.16667],926:[0,.68333,.07569,.08334],928:[0,.68333,.08125,.05556],931:[0,.68333,.05764,.08334],933:[0,.68333,.13889,.05556],934:[0,.68333,0,.08334],936:[0,.68333,.11,.05556],937:[0,.68333,.05017,.08334],945:[0,.43056,.0037,.02778],946:[.19444,.69444,.05278,.08334],947:[.19444,.43056,.05556,0],948:[0,.69444,.03785,.05556],949:[0,.43056,0,.08334],950:[.19444,.69444,.07378,.08334],951:[.19444,.43056,.03588,.05556],952:[0,.69444,.02778,.08334],953:[0,.43056,0,.05556],954:[0,.43056,0,0],955:[0,.69444,0,0],956:[.19444,.43056,0,.02778],957:[0,.43056,.06366,.02778],958:[.19444,.69444,.04601,.11111],959:[0,.43056,0,.05556],960:[0,.43056,.03588,0],961:[.19444,.43056,0,.08334],962:[.09722,.43056,.07986,.08334],963:[0,.43056,.03588,0],964:[0,.43056,.1132,.02778],965:[0,.43056,.03588,.02778],966:[.19444,.43056,0,.08334],967:[.19444,.43056,0,.05556],968:[.19444,.69444,.03588,.11111],969:[0,.43056,.03588,0],977:[0,.69444,0,.08334],981:[.19444,.69444,0,.08334],982:[0,.43056,.02778,0],1009:[.19444,.43056,0,.08334],1013:[0,.43056,0,.05556]},"Math-Regular":{65:[0,.68333,0,.13889],66:[0,.68333,.05017,.08334],67:[0,.68333,.07153,.08334],68:[0,.68333,.02778,.05556],69:[0,.68333,.05764,.08334],70:[0,.68333,.13889,.08334],71:[0,.68333,0,.08334],72:[0,.68333,.08125,.05556],73:[0,.68333,.07847,.11111],74:[0,.68333,.09618,.16667],75:[0,.68333,.07153,.05556],76:[0,.68333,0,.02778],77:[0,.68333,.10903,.08334],78:[0,.68333,.10903,.08334],79:[0,.68333,.02778,.08334],80:[0,.68333,.13889,.08334],81:[.19444,.68333,0,.08334],82:[0,.68333,.00773,.08334],83:[0,.68333,.05764,.08334],84:[0,.68333,.13889,.08334],85:[0,.68333,.10903,.02778],86:[0,.68333,.22222,0],87:[0,.68333,.13889,0],88:[0,.68333,.07847,.08334],89:[0,.68333,.22222,0],90:[0,.68333,.07153,.08334],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,.05556],100:[0,.69444,0,.16667],101:[0,.43056,0,.05556],102:[.19444,.69444,.10764,.16667],103:[.19444,.43056,.03588,.02778],104:[0,.69444,0,0],105:[0,.65952,0,0],106:[.19444,.65952,.05724,0],107:[0,.69444,.03148,0],108:[0,.69444,.01968,.08334],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,.05556],112:[.19444,.43056,0,.08334],113:[.19444,.43056,.03588,.08334],114:[0,.43056,.02778,.05556],115:[0,.43056,0,.05556],116:[0,.61508,0,.08334],117:[0,.43056,0,.02778],118:[0,.43056,.03588,.02778],119:[0,.43056,.02691,.08334],120:[0,.43056,0,.02778],121:[.19444,.43056,.03588,.05556],122:[0,.43056,.04398,.05556],915:[0,.68333,.13889,.08334],916:[0,.68333,0,.16667],920:[0,.68333,.02778,.08334],923:[0,.68333,0,.16667],926:[0,.68333,.07569,.08334],928:[0,.68333,.08125,.05556],931:[0,.68333,.05764,.08334],933:[0,.68333,.13889,.05556],934:[0,.68333,0,.08334],936:[0,.68333,.11,.05556],937:[0,.68333,.05017,.08334],945:[0,.43056,.0037,.02778],946:[.19444,.69444,.05278,.08334],947:[.19444,.43056,.05556,0],948:[0,.69444,.03785,.05556],949:[0,.43056,0,.08334],950:[.19444,.69444,.07378,.08334],951:[.19444,.43056,.03588,.05556],952:[0,.69444,.02778,.08334],953:[0,.43056,0,.05556],954:[0,.43056,0,0],955:[0,.69444,0,0],956:[.19444,.43056,0,.02778],957:[0,.43056,.06366,.02778],958:[.19444,.69444,.04601,.11111],959:[0,.43056,0,.05556],960:[0,.43056,.03588,0],961:[.19444,.43056,0,.08334],962:[.09722,.43056,.07986,.08334],963:[0,.43056,.03588,0],964:[0,.43056,.1132,.02778],965:[0,.43056,.03588,.02778],966:[.19444,.43056,0,.08334],967:[.19444,.43056,0,.05556],968:[.19444,.69444,.03588,.11111],969:[0,.43056,.03588,0],977:[0,.69444,0,.08334],981:[.19444,.69444,0,.08334],982:[0,.43056,.02778,0],1009:[.19444,.43056,0,.08334],1013:[0,.43056,0,.05556]},"SansSerif-Regular":{33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.08333,.58333,0,0],44:[.125,.08333,0,0],45:[0,.44444,0,0],46:[0,.08333,0,0],47:[.25,.75,0,0],48:[0,.65556,0,0],49:[0,.65556,0,0],50:[0,.65556,0,0],51:[0,.65556,0,0],52:[0,.65556,0,0],53:[0,.65556,0,0],54:[0,.65556,0,0],55:[0,.65556,0,0],56:[0,.65556,0,0],57:[0,.65556,0,0],58:[0,.44444,0,0],59:[.125,.44444,0,0],61:[-.13,.37,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.69444,0,0],66:[0,.69444,0,0],67:[0,.69444,0,0],68:[0,.69444,0,0],69:[0,.69444,0,0],70:[0,.69444,0,0],71:[0,.69444,0,0],72:[0,.69444,0,0],73:[0,.69444,0,0],74:[0,.69444,0,0],75:[0,.69444,0,0],76:[0,.69444,0,0],77:[0,.69444,0,0],78:[0,.69444,0,0],79:[0,.69444,0,0],80:[0,.69444,0,0],81:[.125,.69444,0,0],82:[0,.69444,0,0],83:[0,.69444,0,0],84:[0,.69444,0,0],85:[0,.69444,0,0],86:[0,.69444,.01389,0],87:[0,.69444,.01389,0],88:[0,.69444,0,0],89:[0,.69444,.025,0],90:[0,.69444,0,0],91:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.35,.09444,.02778,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[0,.69444,.06944,0],103:[.19444,.44444,.01389,0],104:[0,.69444,0,0],105:[0,.67937,0,0],106:[.19444,.67937,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,0,0],114:[0,.44444,.01389,0],115:[0,.44444,0,0],116:[0,.57143,0,0],117:[0,.44444,0,0],118:[0,.44444,.01389,0],119:[0,.44444,.01389,0],120:[0,.44444,0,0],121:[.19444,.44444,.01389,0],122:[0,.44444,0,0],126:[.35,.32659,0,0],305:[0,.44444,0,0],567:[.19444,.44444,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.67659,0,0],772:[0,.60889,0,0],774:[0,.69444,0,0],775:[0,.67937,0,0],776:[0,.67937,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.63194,0,0],915:[0,.69444,0,0],916:[0,.69444,0,0],920:[0,.69444,0,0],923:[0,.69444,0,0],926:[0,.69444,0,0],928:[0,.69444,0,0],931:[0,.69444,0,0],933:[0,.69444,0,0],934:[0,.69444,0,0],936:[0,.69444,0,0],937:[0,.69444,0,0],8211:[0,.44444,.02778,0],8212:[0,.44444,.02778,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0]},"Script-Regular":{65:[0,.7,.22925,0],66:[0,.7,.04087,0],67:[0,.7,.1689,0],68:[0,.7,.09371,0],69:[0,.7,.18583,0],70:[0,.7,.13634,0],71:[0,.7,.17322,0],72:[0,.7,.29694,0],73:[0,.7,.19189,0],74:[.27778,.7,.19189,0],75:[0,.7,.31259,0],76:[0,.7,.19189,0],77:[0,.7,.15981,0],78:[0,.7,.3525,0],79:[0,.7,.08078,0],80:[0,.7,.08078,0],81:[0,.7,.03305,0],82:[0,.7,.06259,0],83:[0,.7,.19189,0],84:[0,.7,.29087,0],85:[0,.7,.25815,0],86:[0,.7,.27523,0],87:[0,.7,.27523,0],88:[0,.7,.26006,0],89:[0,.7,.2939,0],90:[0,.7,.24037,0]},"Size1-Regular":{40:[.35001,.85,0,0],41:[.35001,.85,0,0],47:[.35001,.85,0,0],91:[.35001,.85,0,0],92:[.35001,.85,0,0],93:[.35001,.85,0,0],123:[.35001,.85,0,0],125:[.35001,.85,0,0],710:[0,.72222,0,0],732:[0,.72222,0,0],770:[0,.72222,0,0],771:[0,.72222,0,0],8214:[-99e-5,.601,0,0],8593:[1e-5,.6,0,0],8595:[1e-5,.6,0,0],8657:[1e-5,.6,0,0],8659:[1e-5,.6,0,0],8719:[.25001,.75,0,0],8720:[.25001,.75,0,0],8721:[.25001,.75,0,0],8730:[.35001,.85,0,0],8739:[-.00599,.606,0,0],8741:[-.00599,.606,0,0],8747:[.30612,.805,.19445,0],8748:[.306,.805,.19445,0],8749:[.306,.805,.19445,0],8750:[.30612,.805,.19445,0],8896:[.25001,.75,0,0],8897:[.25001,.75,0,0],8898:[.25001,.75,0,0],8899:[.25001,.75,0,0],8968:[.35001,.85,0,0],8969:[.35001,.85,0,0],8970:[.35001,.85,0,0],8971:[.35001,.85,0,0],9168:[-99e-5,.601,0,0],10216:[.35001,.85,0,0],10217:[.35001,.85,0,0],10752:[.25001,.75,0,0],10753:[.25001,.75,0,0],10754:[.25001,.75,0,0],10756:[.25001,.75,0,0],10758:[.25001,.75,0,0]},"Size2-Regular":{40:[.65002,1.15,0,0],41:[.65002,1.15,0,0],47:[.65002,1.15,0,0],91:[.65002,1.15,0,0],92:[.65002,1.15,0,0],93:[.65002,1.15,0,0],123:[.65002,1.15,0,0],125:[.65002,1.15,0,0],710:[0,.75,0,0],732:[0,.75,0,0],770:[0,.75,0,0],771:[0,.75,0,0],8719:[.55001,1.05,0,0],8720:[.55001,1.05,0,0],8721:[.55001,1.05,0,0],8730:[.65002,1.15,0,0],8747:[.86225,1.36,.44445,0],8748:[.862,1.36,.44445,0],8749:[.862,1.36,.44445,0],8750:[.86225,1.36,.44445,0],8896:[.55001,1.05,0,0],8897:[.55001,1.05,0,0],8898:[.55001,1.05,0,0],8899:[.55001,1.05,0,0],8968:[.65002,1.15,0,0],8969:[.65002,1.15,0,0],8970:[.65002,1.15,0,0],8971:[.65002,1.15,0,0],10216:[.65002,1.15,0,0],10217:[.65002,1.15,0,0],10752:[.55001,1.05,0,0],10753:[.55001,1.05,0,0],10754:[.55001,1.05,0,0],10756:[.55001,1.05,0,0],10758:[.55001,1.05,0,0]},"Size3-Regular":{40:[.95003,1.45,0,0],41:[.95003,1.45,0,0],47:[.95003,1.45,0,0],91:[.95003,1.45,0,0],92:[.95003,1.45,0,0],93:[.95003,1.45,0,0],123:[.95003,1.45,0,0],125:[.95003,1.45,0,0],710:[0,.75,0,0],732:[0,.75,0,0],770:[0,.75,0,0],771:[0,.75,0,0],8730:[.95003,1.45,0,0],8968:[.95003,1.45,0,0],8969:[.95003,1.45,0,0],8970:[.95003,1.45,0,0],8971:[.95003,1.45,0,0],10216:[.95003,1.45,0,0],10217:[.95003,1.45,0,0]},"Size4-Regular":{40:[1.25003,1.75,0,0],41:[1.25003,1.75,0,0],47:[1.25003,1.75,0,0],91:[1.25003,1.75,0,0],92:[1.25003,1.75,0,0],93:[1.25003,1.75,0,0],123:[1.25003,1.75,0,0],125:[1.25003,1.75,0,0],710:[0,.825,0,0],732:[0,.825,0,0],770:[0,.825,0,0],771:[0,.825,0,0],8730:[1.25003,1.75,0,0],8968:[1.25003,1.75,0,0],8969:[1.25003,1.75,0,0],8970:[1.25003,1.75,0,0],8971:[1.25003,1.75,0,0],9115:[.64502,1.155,0,0],9116:[1e-5,.6,0,0],9117:[.64502,1.155,0,0],9118:[.64502,1.155,0,0],9119:[1e-5,.6,0,0],9120:[.64502,1.155,0,0],9121:[.64502,1.155,0,0],9122:[-99e-5,.601,0,0],9123:[.64502,1.155,0,0],9124:[.64502,1.155,0,0],9125:[-99e-5,.601,0,0],9126:[.64502,1.155,0,0],9127:[1e-5,.9,0,0],9128:[.65002,1.15,0,0],9129:[.90001,0,0,0],9130:[0,.3,0,0],9131:[1e-5,.9,0,0],9132:[.65002,1.15,0,0],9133:[.90001,0,0,0],9143:[.88502,.915,0,0],10216:[1.25003,1.75,0,0],10217:[1.25003,1.75,0,0],57344:[-.00499,.605,0,0],57345:[-.00499,.605,0,0],57680:[0,.12,0,0],57681:[0,.12,0,0],57682:[0,.12,0,0],57683:[0,.12,0,0]},"Typewriter-Regular":{33:[0,.61111,0,0],34:[0,.61111,0,0],35:[0,.61111,0,0],36:[.08333,.69444,0,0],37:[.08333,.69444,0,0],38:[0,.61111,0,0],39:[0,.61111,0,0],40:[.08333,.69444,0,0],41:[.08333,.69444,0,0],42:[0,.52083,0,0],43:[-.08056,.53055,0,0],44:[.13889,.125,0,0],45:[-.08056,.53055,0,0],46:[0,.125,0,0],47:[.08333,.69444,0,0],48:[0,.61111,0,0],49:[0,.61111,0,0],50:[0,.61111,0,0],51:[0,.61111,0,0],52:[0,.61111,0,0],53:[0,.61111,0,0],54:[0,.61111,0,0],55:[0,.61111,0,0],56:[0,.61111,0,0],57:[0,.61111,0,0],58:[0,.43056,0,0],59:[.13889,.43056,0,0],60:[-.05556,.55556,0,0],61:[-.19549,.41562,0,0],62:[-.05556,.55556,0,0],63:[0,.61111,0,0],64:[0,.61111,0,0],65:[0,.61111,0,0],66:[0,.61111,0,0],67:[0,.61111,0,0],68:[0,.61111,0,0],69:[0,.61111,0,0],70:[0,.61111,0,0],71:[0,.61111,0,0],72:[0,.61111,0,0],73:[0,.61111,0,0],74:[0,.61111,0,0],75:[0,.61111,0,0],76:[0,.61111,0,0],77:[0,.61111,0,0],78:[0,.61111,0,0],79:[0,.61111,0,0],80:[0,.61111,0,0],81:[.13889,.61111,0,0],82:[0,.61111,0,0],83:[0,.61111,0,0],84:[0,.61111,0,0],85:[0,.61111,0,0],86:[0,.61111,0,0],87:[0,.61111,0,0],88:[0,.61111,0,0],89:[0,.61111,0,0],90:[0,.61111,0,0],91:[.08333,.69444,0,0],92:[.08333,.69444,0,0],93:[.08333,.69444,0,0],94:[0,.61111,0,0],95:[.09514,0,0,0],96:[0,.61111,0,0],97:[0,.43056,0,0],98:[0,.61111,0,0],99:[0,.43056,0,0],100:[0,.61111,0,0],101:[0,.43056,0,0],102:[0,.61111,0,0],103:[.22222,.43056,0,0],104:[0,.61111,0,0],105:[0,.61111,0,0],106:[.22222,.61111,0,0],107:[0,.61111,0,0],108:[0,.61111,0,0],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,0],112:[.22222,.43056,0,0],113:[.22222,.43056,0,0],114:[0,.43056,0,0],115:[0,.43056,0,0],116:[0,.55358,0,0],117:[0,.43056,0,0],118:[0,.43056,0,0],119:[0,.43056,0,0],120:[0,.43056,0,0],121:[.22222,.43056,0,0],122:[0,.43056,0,0],123:[.08333,.69444,0,0],124:[.08333,.69444,0,0],125:[.08333,.69444,0,0],126:[0,.61111,0,0],127:[0,.61111,0,0],305:[0,.43056,0,0],567:[.22222,.43056,0,0],768:[0,.61111,0,0],769:[0,.61111,0,0],770:[0,.61111,0,0],771:[0,.61111,0,0],772:[0,.56555,0,0],774:[0,.61111,0,0],776:[0,.61111,0,0],778:[0,.61111,0,0],780:[0,.56597,0,0],915:[0,.61111,0,0],916:[0,.61111,0,0],920:[0,.61111,0,0],923:[0,.61111,0,0],926:[0,.61111,0,0],928:[0,.61111,0,0],931:[0,.61111,0,0],933:[0,.61111,0,0],934:[0,.61111,0,0],936:[0,.61111,0,0],937:[0,.61111,0,0],2018:[0,.61111,0,0],2019:[0,.61111,0,0],8242:[0,.61111,0,0]}};const x=/[\u3040-\u309F]|[\u30A0-\u30FF]|[\u4E00-\u9FAF]|[\uAC00-\uD7AF]/,_={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25]},P={defaultRuleThickness:.04,bigOpSpacing1:.111,bigOpSpacing2:.166,bigOpSpacing3:.2,bigOpSpacing4:.6,bigOpSpacing5:.1,ptPerEm:10,pxPerEm:40/3,doubleRuleSep:.2,arraycolsep:.5,baselineskip:1.2,arrayrulewidth:.04,fboxsep:.3,fboxrule:.04},S={" ":" ","​":" ","Å":"A","Ç":"C","Ð":"D","Þ":"o","å":"a","ç":"c","ð":"d","þ":"o","А":"A","Б":"B","В":"B","Г":"F","Д":"A","Е":"E","Ж":"K","З":"3","И":"N","Й":"N","К":"K","Л":"N","М":"M","Н":"H","О":"O","П":"N","Р":"P","С":"C","Т":"T","У":"y","Ф":"O","Х":"X","Ц":"U","Ч":"h","Ш":"W","Щ":"W","Ъ":"B","Ы":"X","Ь":"B","Э":"3","Ю":"X","Я":"R","а":"a","б":"b","в":"a","г":"r","д":"y","е":"e","ж":"m","з":"e","и":"n","й":"n","к":"n","л":"n","м":"m","н":"n","о":"o","п":"n","р":"p","с":"c","т":"o","у":"y","ф":"b","х":"x","ц":"n","ч":"n","ш":"w","щ":"w","ъ":"a","ы":"m","ь":"a","э":"e","ю":"m","я":"r"};function w(t,e,i){if("string"==typeof t){const i=t.match(/([-+]?[0-9.]*)\s*([a-zA-Z]+)/);i?(t=parseFloat(i[1]),e=i[2].toLowerCase()):t=parseFloat(t)}const s={pt:1,mm:7227/2540,cm:7227/254,ex:35271/8192,px:.75,em:P.ptPerEm,bp:1.00375,dd:1238/1157,pc:12,in:72.27,mu:10/18}[e]||1;if(isFinite(i)){const e=Math.pow(10,i);return Math.round(t/P.ptPerEm*s*e)/e}return t/P.ptPerEm*s}var E={toEm:w,toPx:function(t,e){return w(t,e)*(4/3)*P.ptPerEm},METRICS:P,SIGMAS:_,getCharacterMetrics:function(t,e){const i={cal:"Caligraphic-Regular",ams:"AMS-Regular",frak:"Fraktur-Regular",bb:"AMS-Regular",scr:"Script-Regular",cmr:"Main-Regular",cmtt:"Typewriter-Regular",cmss:"SansSerif-Regular"}[e]||e;let s=t.charCodeAt(0);t[0]in S?s=S[t[0]].charCodeAt(0):x.test(t[0])&&(s=77);const n=C[i][s];return n?n?{depth:n[0],height:n[1],italic:n[2],skew:n[3]}:null:{defaultMetrics:!0,depth:.2,height:.7,italic:0,skew:0}}};const k=[{},{},{}];let A;for(const Zs in _)if(Object.prototype.hasOwnProperty.call(_,Zs))for(A=0;A<3;A++)k[A][Zs]=_[Zs][A];for(A=0;A<3;A++)k[A].emPerEx=_.xHeight[A]/_.quad[A];class T{constructor(t,e,i,s){this.id=t,this.size=e,this.cramped=s,this.sizeMultiplier=i,this.metrics=k[e>0?e-1:0]}sup(){return M[L[this.id]]}sub(){return M[D[this.id]]}fracNum(){return M[j[this.id]]}fracDen(){return M[I[this.id]]}cramp(){return M[R[this.id]]}cls(){return O[this.size]}adjustTo(t){let e=N[this.size][t.size];return e.length>0&&(e=" "+e),e}isTight(){return this.size>=2}}const M=[new T(0,0,1,!1),new T(1,0,1,!0),new T(2,1,1,!1),new T(3,1,1,!0),new T(4,2,.7,!1),new T(5,2,.7,!0),new T(6,3,.5,!1),new T(7,3,.5,!0)],O=["displaystyle textstyle","textstyle","scriptstyle","scriptscriptstyle"],N=[["","","reset-textstyle scriptstyle","reset-textstyle scriptscriptstyle"],["reset-textstyle displaystyle textstyle","","reset-textstyle scriptstyle","reset-textstyle scriptscriptstyle"],["reset-scriptstyle textstyle displaystyle","reset-scriptstyle textstyle","","reset-scriptstyle scriptscriptstyle"],["reset-scriptscriptstyle textstyle displaystyle","reset-scriptscriptstyle textstyle","reset-scriptscriptstyle scriptstyle",""]],L=[4,5,4,5,6,7,6,7],D=[5,5,5,5,7,7,7,7],j=[2,3,4,5,6,7,6,7],I=[3,3,5,5,7,7,7,7],R=[1,1,3,3,5,5,7,7];var B={DISPLAY:M[0],TEXT:M[2],SCRIPT:M[4],SCRIPTSCRIPT:M[6],toMathstyle:function(t){return t?"object"==typeof t?t:{displaystyle:M[0],textstyle:M[2],scriptstyle:M[4],scriptscriptstyle:M[6]}[t]:t}};class F{constructor(t){this.macros=t.macros||{},this.generateID=!!t.generateID&&t.generateID,this.mathstyle=B.toMathstyle(t.mathstyle||"displaystyle"),this.size=t.size||"size5",this.parentMathstyle=t.parentMathstyle||this.mathstyle,this.parentSize=t.parentSize||this.size,this.opacity=t.opacity}clone(t){const e=new F(this);return e.parentMathstyle=this.mathstyle,e.parentSize=this.size,e.macros=this.macros,t&&("auto"!==t.mathstyle&&t.mathstyle||delete t.mathstyle,Object.assign(e,t),"string"==typeof t.mathstyle&&(e.mathstyle=B.toMathstyle(t.mathstyle))),e}setMathstyle(t){t&&"auto"!==t&&(this.mathstyle=B.toMathstyle(t))}cramp(){return this.clone({mathstyle:this.mathstyle.cramp()})}sup(){return this.clone({mathstyle:this.mathstyle.sup()})}sub(){return this.clone({mathstyle:this.mathstyle.sup()})}}var Y={Context:F};function z(t){let e="";if("number"==typeof t)e+=Math.floor(100*t)/100;else if("string"==typeof t)e+=t;else if(Array.isArray(t))for(const i of t)e+=z(i);else t&&(e+=t.toString());return e}class X{constructor(t,e){this.classes=e||"",Array.isArray(t)?this.children=[].concat.apply([],t):"string"==typeof t?this.body=t:t&&"object"==typeof t&&(this.children=[t]),this.style=null,this.updateDimensions()}updateDimensions(){let t=0,e=0,i=1;this.children&&this.children.forEach(s=>{s.height>t&&(t=s.height),s.depth>e&&(e=s.depth),s.maxFontSize>i&&(i=s.maxFontSize)}),this.height=t,this.depth=e,this.maxFontSize=i}selected(t){t&&!/ML__selected/.test(this.classes)&&(this.classes.length>0&&(this.classes+=" "),this.classes+="ML__selected"),!t&&/ML__selected/.test(this.classes)&&(this.classes=this.classes.replace("ML__selected","")),this.children&&this.children.forEach(e=>e.selected(t))}applyStyle(t){if(!t)return;if(t.color&&this.setStyle("color","none"!==t.color?t.color:""),t.backgroundColor&&this.setStyle("background-color","none"!==t.backgroundColor?t.backgroundColor:""),t.cssClass&&(this.classes+=" "+t.cssClass),!this.body)return;let e=t.fontFamily;"math"===e&&"n"===t.fontShape&&(e="cmr");let i="Main-Regular";if(e&&(i=function(t,e){if("string"!=typeof t||t.length>1||"​"===t)return Q[e];if("bb"===e||"scr"===e){if(!/^[A-Z ]$/.test(t))return null}else if("cal"===e){if(!/^[0-9A-Z ]$/.test(t))return null}else if("frak"===e){if(!/^[0-9A-Za-z ]$|^[!"#$%&'()*+,\-.\/:;=?[]^’‘]$/.test(t))return null}else if(("cmtt"===e||"cmss"===e)&&!/^[0-9A-Za-z ]$|^[!"&'()*+,\-.\/:;=?@[]^_~\u0131\u0237\u0393\u0394\u0398\u039b\u039e\u03A0\u03A3\u03A5\u03A8\u03a9’‘]$/.test(t))return null;return Q[e]}(this.body,e)),t.fontShape&&(this.classes+=" "+({it:"ML__it",sl:"ML__shape_sl",sc:"ML__shape_sc",ol:"ML__shape_ol"}[t.fontShape]||"")),t.fontSeries){const e=t.fontSeries.match(/(.?[lbm])?(.?[cx])?/);e&&(this.classes+=" "+({ul:"ML__series_ul",el:"ML__series_el",l:"ML__series_l",sl:"ML__series_sl",m:"",sb:"ML__series_sb",b:"ML__bold",eb:"ML__series_eb",ub:"ML__series_ub"}[e[1]||""]||""),this.classes+=" "+({uc:"ML__series_uc",ec:"ML__series_ec",c:"ML__series_c",sc:"ML__series_sc",n:"",sx:"ML__series_sx",x:"ML__series_x",ex:"ML__series_ex",ux:"ML__series_ux"}[e[2]||""]||""))}if(tt[e]?this.classes+=" "+tt[e]:e&&this.setStyle("font-family",e),this.body&&this.body.length>0&&i){this.height=0,this.depth=0,this.maxFontSize={size1:.5,size2:.7,size3:.8,size4:.9,size5:1,size6:1.2,size7:1.44,size8:1.73,size9:2.07,size10:2.49}[t.fontSize]||1,this.skew=0,this.italic=0;for(let t=0;t<this.body.length;t++){const e=E.getCharacterMetrics(this.body.charAt(t),i);e&&(this.height=Math.max(this.height,e.height),this.depth=Math.max(this.depth,e.depth),this.skew=e.skew,this.italic=e.italic)}}}setStyle(t,...e){const i=z(e);i.length>0&&(this.style||(this.style={}),this.style[t]=i)}setTop(t){t&&0!==t&&(this.style||(this.style={}),this.style.top=z(t)+"em",this.height-=t,this.depth+=t)}setLeft(t){t&&0!==t&&(this.style||(this.style={}),this.style["margin-left"]=z(t)+"em")}setRight(t){t&&0!==t&&(this.style||(this.style={}),this.style["margin-right"]=z(t)+"em")}setWidth(t){t&&0!==t&&(this.style||(this.style={}),this.style.width=z(t)+"em")}addMarginRight(t){if(t&&0!==t){if(!this.style&&!/qquad|quad|enspace|thickspace|mediumspace|thinspace|negativethinspace/.test(this.classes)){const e={2:"qquad",1:"quad",".5":"enspace",.277778:"thickspace",.222222:"mediumspace",.166667:"thinspace","-0.166667":"negativethinspace"}[t.toString()];if(e)return void(this.classes+=" rspace "+e)}this.style||(this.style={});const e=parseFloat(this.style["margin-right"]||"0");this.style["margin-right"]=z(e+t)+"em"}}toMarkup(t,e){t=t||0,e=e||1;let i="",s=this.body||"";if(this.children){let t="none";for(const i of this.children){let n=0;if(t){let s=i.type;s&&("textord"===s&&(s="mord"),"first"===s&&(s="none"),n=i.isTight?q[t+"+"+s]||0:U[t+"+"+s]||0,n=Math.floor(e*n))}s+=i.toMarkup(n,e),t=J(i)}}if("​"!==s&&s||this.classes&&"ML__selected"!==this.classes){if(i="<span",this.cssId&&(i+=' id="'+this.cssId+'" '),this.svgOverlay&&(this.setStyle("position","relative"),this.setStyle("height",this.height+this.depth,"em"),this.setStyle("vertical-align",-this.depth,"em")),this.attributes)for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(i+=" "+t+'="'+this.attributes[t]+'"');const e=this.classes.split(" ");this.type&&(/command|placeholder|error/.test(this.type)&&e.push({command:"ML__command",placeholder:"ML__placeholder",error:"ML__error"}[this.type]),this.caret&&"command"===this.type&&e.push("ML__command-caret"));let n="";if((n=e.length>1?e.filter((function(t,e,i){return t.length>0&&i.indexOf(t)===e})).join(" "):e[0]).length>0&&(i+=' class="'+n+'"'),t&&(this.style&&this.style["margin-left"]?this.style["margin-left"]=z(parseFloat(this.style["margin-left"])+t/18)+"em":t<0&&H[-t]?s=H[-t]+s:G[t]?s=G[t]+s:(this.style||(this.style={}),this.style["margin-left"]=z(t/18)+"em")),this.style){let t="";const e=/ML__selected/.test(this.classes);for(const i in this.style)Object.prototype.hasOwnProperty.call(this.style,i)&&("background-color"===i&&e||(t+=i+":"+this.style[i]+";"));t.length>0&&(i+=' style="'+t+'"')}i+=">",this.svgOverlay?(i+='<span style="',i+="display: inline-block;",i+="height:"+(this.height+this.depth)+"em;",i+="vertical-align:"+this.depth+"em;",i+='">',i+=s,i+="</span>",i+="<svg ",i+='style="position:absolute;',i+="overflow:overlay;",i+="height:"+(this.height+this.depth)+"em;",i+="transform:translateY(-"+Math.round(E.toPx(this.depth,"em")+E.toPx(this.style.padding))+"px);",this.style&&this.style.padding?(i+="top:"+this.style.padding+";",i+="left:"+this.style.padding+";",i+="width:calc(100% - 2 * "+this.style.padding+" );"):(i+="top:0;",i+="left:0;",i+="width:100%;"),i+="z-index:2;",i+='"',this.svgStyle&&(i+=' style="'+this.svgStyle+'"'),i+=">",i+=this.svgOverlay,i+="</svg>"):i+=s,i+="</span>"}else i="";return this.caret&&"command"!==this.type&&(i+="text"===this.caret?'<span class="ML__text-caret"></span>':'<span class="ML__caret"></span>'),i}tryCoalesceWith(t){if(this.tag!==t.tag)return!1;if(this.type!==t.type)return!1;if("error"===this.type||"placeholder"===this.type||"command"===this.type)return!1;if(this.children&&this.children.length>0||t.children&&t.children.length>0)return!1;if((this.style?this.style.length:0)!==(t.style?t.style.length:0))return!1;const e=this.classes.trim().replace(/\s+/g," ").split(" "),i=t.classes.trim().replace(/\s+/g," ").split(" ");if(e.length!==i.length)return!1;e.sort(),i.sort();for(let s=0;s<e.length;s++){if("vertical-separator"===e[s])return!1;if(e[s]!==i[s])return!1}if(this.style&&t.style)for(const s in this.style)if(Object.prototype.hasOwnProperty.call(this.style,s)&&Object.prototype.hasOwnProperty.call(t.style,s)&&this.style[s]!==t.style[s])return!1;return this.body+=t.body,this.height=Math.max(this.height,t.height),this.depth=Math.max(this.depth,t.depth),this.maxFontSize=Math.max(this.maxFontSize,t.maxFontSize),this.italic=t.italic,!0}}const U={"mord+mop":3,"mord+mbin":4,"mord+mrel":5,"mord+minner":3,"mop+mord":3,"mop+mop":3,"mop+mbin":5,"mop+minner":3,"mbin+mord":4,"mbin+mop":4,"mbin+mopen":4,"mbin+minner":4,"mrel+mord":5,"mrel+mop":5,"mrel+mopen":5,"mrel+minner":5,"mclose+mop":3,"mclose+mbin":4,"mclose+mrel":5,"mclose+minner":3,"mpunct+mord":3,"mpunct+mop":3,"mpunct+mbin":4,"mpunct+mrel":5,"mpunct+mopen":3,"mpunct+mpunct":3,"mpunct+minner":3},G=["​"," ","  "," "," ","  "," ","",""," "],H=[""," ⁣",""," ⁣"," ⁣"," ⁣"],q={"mord+mop":3,"mop+mord":3,"mop+mop":3,"mclose+mop":3,"minner+mop":3};function J(t){const e=t.type;return"first"===e?"none":"textord"===e?"mord":e}function V(t){return t?Array.isArray(t)?t.reduce((t,e)=>Math.max(t,e.height),0):t.height:0}function $(t){return t?Array.isArray(t)?t.reduce((t,e)=>Math.max(t,e.depth),0):t.depth:0}function W(t,e){if(Array.isArray(t)){const i=[];for(const e of t)e&&i.push(e);if(1===i.length)return W(i[0],e)}return new X(t,e)}function K(t,e,i){const s=W(e,i);return s.type=t,s}function Z(t,e){if(!e||0===e.length){if(t instanceof X)return t;if(Array.isArray(t)&&1===t.length)return t[0]}const i=new X(t,e);let s=1;return s=t instanceof X?t.maxFontSize:t.reduce((t,e)=>Math.max(t,e.maxFontSize),0),i.height*=s,i.depth*=s,i}const Q={ams:"AMS-Regular",bb:"AMS-Regular",cal:"Caligraphic-Regular",frak:"Fraktur-Regular",scr:"Script-Regular",cmr:"Main-Regular",cmss:"SansSerif-Regular",cmtt:"Typewriter-Regular",math:"Math-Regular",mainit:"Main-Italic"},tt={ams:"ML__ams",bb:"ML__bb",cal:"ML__cal",frak:"ML__frak",scr:"ML__script",cmr:"ML__mathrm",cmss:"ML__sans",cmtt:"ML__tt",math:"ML__mathit",mainit:"ML__mainit"};var et={coalesce:function t(e){if(!e||0===e.length)return[];e[0].children=t(e[0].children);const i=[e[0]];for(let s=1;s<e.length;s++)i[i.length-1].tryCoalesceWith(e[s])||(e[s].children=t(e[s].children),i.push(e[s]));return i},makeSpan:W,makeOp:function(t,e){return K("mop",t,e)},makeOrd:function(t,e){return K("mord",t,e)},makeRel:function(t,e){return K("mrel",t,e)},makeClose:function(t,e){return K("mclose",t,e)},makeOpen:function(t,e){return K("mopen",t,e)},makeInner:function(t,e){return K("minner",t,e)},makePunct:function(t,e){return K("mpunct",t,e)},makeSpanOfType:K,makeSymbol:function(t,e,i){const s=new X(e,i),n=E.getCharacterMetrics(e,t);return s.height=n.height,s.depth=n.depth,s.skew=n.skew,s.italic=n.italic,s.setRight(s.italic),s},makeVlist:function(t,e,i,s){let n=0,r=0;i=i||"shift",s=s||0;for(let c=0;c<e.length;c++)Array.isArray(e[c])&&(e[c]=1===e[c].length?e[c][0]:W(e[c]));if("shift"===i)n=-e[0].depth-s;else if("bottom"===i)n=-s;else if("top"===i){let t=s;for(const i of e)t-=i instanceof X?i.height+i.depth:i;n=t}else if("individualShift"===i){const t=e;e=[t[0]],r=n=-t[1]-t[0].depth;for(let i=2;i<t.length;i+=2){const s=-t[i+1]-r-t[i].depth;r+=s,e.push(s-(t[i-2].height+t[i-2].depth)),e.push(t[i])}}let o=1;for(const c of e)c instanceof X&&(o=Math.max(o,c.maxFontSize));const a=function(t,e){const i=o?o/t.mathstyle.sizeMultiplier:0,s=new X("​");return 1!==i&&(s.setStyle("font-size",i,i>0?"em":""),s.attributes={"aria-hidden":!0}),"size5"!==t.size?new X(s,"fontsize-ensurer reset-"+t.size+" size5"):0!==i?s:null}(t),l=[];r=n;for(const c of e)if("number"==typeof c)r+=c;else{const t=W([a,c]);t.setTop(-c.depth-r),l.push(t),r+=c.height+c.depth}const h=W(l,"vlist");return h.depth=Math.max(n,$(h)||0),h.height=Math.max(-r,V(h)||0),h},makeHlist:Z,makeStyleWrap:function(t,e,i,s,n){n=n||"";const r=Z(e,(n+=" style-wrap ")+i.adjustTo(s));r.type=t;const o=s.sizeMultiplier/i.sizeMultiplier;return r.height*=o,r.depth*=o,r.maxFontSize=s.sizeMultiplier,r},makeSVG:function(t,e,i){return t.svgOverlay=e,t.svgStyle=i,t},height:V,depth:$,skew:function(t){if(!t)return 0;if(Array.isArray(t)){let e=0;for(const i of t)e+=i.skew||0;return e}return t.skew},italic:function(t){return t?Array.isArray(t)?t[t.length-1].italic:t.italic:0}};let it="";const st={},nt={},rt={},ot="CRYPTIC",at="COMMON",lt="SUPERCOMMON",ht={CRYPTIC:0,ARCANE:200,VERY_RARE:600,RARE:1200,UNCOMMON:2e3,COMMON:3e3,SUPERCOMMON:4e3};function ct(t,...e){const i="string"==typeof t?ht[t]:t;for(const s of e)st[s]&&(st[s].frequency=i),nt[s]&&(nt[s]=Object.assign({},nt[s]),nt[s].frequency=i)}function dt(t,e,i,s,n){e&&/^(ams|cmr|bb|cal|frak|scr)$/.test(e),"string"==typeof n&&(n=ht[n]),st[t]={type:i===Ct?xt:i,baseFontFamily:e,value:s,category:it,frequency:n}}function ut(t,e){for(let i=t;i<=e;i++){const t=String.fromCodePoint(i);dt(t,"","mord",t)}}const pt={8739:"|",183:"\\cdot",188:"\\frac{1}{4}",189:"\\frac{1}{2}",190:"\\frac{3}{4}",8304:"^{0}",8305:"^{i}",185:"^{1}",178:"^{2}",179:"^{3}",8308:"^{4}",8309:"^{5}",8310:"^{6}",8311:"^{7}",8312:"^{8}",8313:"^{9}",8314:"^{+}",8315:"^{-}",8316:"^{=}",8319:"^{n}",8320:"_{0}",8321:"_{1}",8322:"_{2}",8323:"_{3}",8324:"_{4}",8325:"_{5}",8326:"_{6}",8327:"_{7}",8328:"_{8}",8329:"_{9}",8330:"_{+}",8331:"_{-}",8332:"_{=}",8336:"_{a}",8337:"_{e}",8338:"_{o}",8339:"_{x}",8242:"\\prime",8243:"\\doubleprime",8736:"\\angle",8450:"\\C",8469:"\\N",8473:"\\P",8474:"\\Q",8477:"\\R",8484:"\\Z"};function ft(t,e){const i=String.fromCodePoint(e);if("math"===t&&pt[i])return pt[i];if(e>32&&e<127)return i;let s="";if("math"===t){for(const n in st)if(Object.prototype.hasOwnProperty.call(st,n)&&st[n].value===i){s=n;break}}else for(const n in Dt)if(Object.prototype.hasOwnProperty.call(Dt,n)&&Dt[n]===i){s=n;break}return s||i}const mt={119893:8462,119965:8492,119968:8496,119969:8497,119971:8459,119972:8464,119975:8466,119976:8499,119981:8475,119994:8495,119996:8458,120004:8500,120070:8493,120075:8460,120076:8465,120085:8476,120093:8488,120122:8450,120127:8461,120133:8469,120135:8473,120136:8474,120137:8477,120145:8484},gt=[{start:119808,len:26,offset:65,style:"bold"},{start:119834,len:26,offset:97,style:"bold"},{start:119860,len:26,offset:65,style:"italic"},{start:119886,len:26,offset:97,style:"italic"},{start:119912,len:26,offset:65,style:"bolditalic"},{start:119938,len:26,offset:97,style:"bolditalic"},{start:119964,len:26,offset:65,variant:"script"},{start:119990,len:26,offset:97,variant:"script"},{start:120016,len:26,offset:65,variant:"script",style:"bold"},{start:120042,len:26,offset:97,variant:"script",style:"bold"},{start:120068,len:26,offset:65,variant:"fraktur"},{start:120094,len:26,offset:97,variant:"fraktur"},{start:120172,len:26,offset:65,variant:"fraktur",style:"bold"},{start:120198,len:26,offset:97,variant:"fraktur",style:"bold"},{start:120120,len:26,offset:65,variant:"double-struck"},{start:120146,len:26,offset:97,variant:"double-struck"},{start:120224,len:26,offset:65,variant:"sans-serif"},{start:120250,len:26,offset:97,variant:"sans-serif"},{start:120276,len:26,offset:65,variant:"sans-serif",style:"bold"},{start:120302,len:26,offset:97,variant:"sans-serif",style:"bold"},{start:120328,len:26,offset:65,variant:"sans-serif",style:"italic"},{start:120354,len:26,offset:97,variant:"sans-serif",style:"italic"},{start:120380,len:26,offset:65,variant:"sans-serif",style:"bolditalic"},{start:120406,len:26,offset:97,variant:"sans-serif",style:"bolditalic"},{start:120432,len:26,offset:65,variant:"monospace"},{start:120458,len:26,offset:97,variant:"monospace"},{start:120488,len:25,offset:913,style:"bold"},{start:120514,len:25,offset:945,style:"bold"},{start:120546,len:25,offset:913,style:"italic"},{start:120572,len:25,offset:945,style:"italic"},{start:120604,len:25,offset:913,style:"bolditalic"},{start:120630,len:25,offset:945,style:"bolditalic"},{start:120662,len:25,offset:913,variant:"sans-serif",style:"bold"},{start:120688,len:25,offset:945,variant:"sans-serif",style:"bold"},{start:120720,len:25,offset:913,variant:"sans-serif",style:"bolditalic"},{start:120746,len:25,offset:945,variant:"sans-serif",style:"bolditalic"},{start:120782,len:10,offset:48,variant:"",style:"bold"},{start:120792,len:10,offset:48,variant:"double-struck"},{start:120803,len:10,offset:48,variant:"sans-serif"},{start:120812,len:10,offset:48,variant:"sans-serif",style:"bold"},{start:120822,len:10,offset:48,variant:"monospace"}];function bt(t){let e=t;if("string"==typeof t&&(e=t.codePointAt(0)),(e<119808||e>120831)&&(e<8448||e>8527))return{char:t};for(const i in mt)if(Object.prototype.hasOwnProperty.call(mt,i)&&mt[i]===e){e=i;break}for(let i=0;i<gt.length;i++)if(e>=gt[i].start&&e<gt[i].start+gt[i].len)return{char:String.fromCodePoint(e-gt[i].start+gt[i].offset),variant:gt[i].variant,style:gt[i].style};return{char:t}}function yt(t,e){if("text"===t)return String.fromCodePoint(e);let i;if(pt[e])return pt[e];const s=bt(e);return s.style||s.variant?(i=s.char,s.variant&&(i="\\"+s.variant+"{"+i+"}"),"bold"===s.style?i="\\mathbf{"+i+"}":"italic"===s.style?i="\\mathit{"+i+"}":"bolditalic"===s.style&&(i="\\mathbf{\\mathit{"+i+"}}"),"\\mathord{"+i+"}"):ft(t,e)}const vt="ams",Ct="mord",xt="mord",_t="mbin",Pt="mrel",St="mopen",wt="mclose",Et="spacing";function kt(t,e){let i=t.match(/=(.+)/),s="{}",n="auto",r=null;return i&&(s=i[1]),(i=t.match(/:([^=]+)/))&&(n=i[1].trim()),(i=t.match(/^([^:=]+)/))&&(r=i[1].trim()),{optional:e,type:n,defaultValue:s,placeholder:r}}function At(t){if(!t||0===t.length)return[];let e=[],i=t.split("]");if("["===i[0].charAt(0)){e.push(kt(i[0].slice(1),!0));for(let t=1;t<=i.length;t++)e=e.concat(At(i[t]))}else if("{"===(i=t.split("}"))[0].charAt(0)){e.push(kt(i[0].slice(1),!1));for(let t=1;t<=i.length;t++)e=e.concat(At(i[t]))}return e}function Tt(t){return t.map(t=>t.body).join("")}function Mt(t,e,i,s){"string"==typeof t&&(t=[t]),i||(i={});const n=At(e),r={category:it,params:n,parser:s,mathstyle:"displaystyle",tabular:i.tabular||!0,colFormat:i.colFormat||[]};for(const o of t)rt[o]=r}function Ot(t,e,i,s){"string"==typeof t&&(t=[t]),i||(i={});const n={category:it,baseFontFamily:i.fontFamily,params:At(e),allowedInText:!!i.allowedInText,infix:!!i.infix,parse:s};for(const r of t)nt[r]=n}it="Environments",Mt("math","",{frequency:0},(function(){return{mathstyle:"textstyle"}})),Mt("displaymath","",{frequency:8},(function(){return{mathstyle:"displaystyle"}})),Mt("array","{columns:colspec}",{frequency:at},(function(t,e){return{colFormat:e[0],mathstyle:"textstyle"}})),Mt("eqnarray","",{},(function(){return{}})),Mt("equation","",{},(function(){return{colFormat:[{align:"c"}]}})),Mt("subequations","",{},(function(){return{colFormat:[{align:"c"}]}})),Mt("multline","",{},(function(){return{firstRowFormat:[{align:"l"}],colFormat:[{align:"c"}],lastRowFormat:[{align:"r"}]}})),Mt(["align","aligned"],"",{},(function(t,e,i){let s=0;for(const o of i)s=Math.max(s,o.length);const n=[{gap:0},{align:"r"},{gap:0},{align:"l"}];let r=2;for(;r<s;)n.push({gap:1}),n.push({align:"r"}),n.push({gap:0}),n.push({align:"l"}),r+=2;return n.push({gap:0}),{colFormat:n,jot:.3}})),Mt("split","",{},(function(){return{}})),Mt(["gather","gathered"],"",{},(function(){return{colFormat:[{gap:.25},{align:"c"},{gap:0}],jot:.3}})),Mt(["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","smallmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*","smallmatrix*"],"[columns:colspec]",{},(function(t,e){const i={mathstyle:"textstyle"};switch(t){case"pmatrix":case"pmatrix*":i.lFence="(",i.rFence=")";break;case"bmatrix":case"bmatrix*":i.lFence="[",i.rFence="]";break;case"Bmatrix":case"Bmatrix*":i.lFence="\\lbrace",i.rFence="\\rbrace";break;case"vmatrix":case"vmatrix*":i.lFence="\\vert",i.rFence="\\vert";break;case"Vmatrix":case"Vmatrix*":i.lFence="\\Vert",i.rFence="\\Vert";break;case"smallmatrix":case"smallmatrix*":i.mathstyle="scriptstyle";break;case"matrix":case"matrix*":i.lFence=".",i.rFence="."}return i.colFormat=e[0]||[{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"}],i})),Mt("cases","",{},(function(){return{arraystretch:1.2,lFence:"\\lbrace",rFence:".",colFormat:[{align:"l"},{gap:1},{align:"l"}]}})),Mt("theorem","",{},(function(){return{}})),Mt("center","",{},(function(){return{colFormat:[{align:"c"}]}})),it="",function(t){for(let e=0;e<"0123456789/@.".length;e++){const t="0123456789/@.".charAt(e);dt(t,"",xt,t)}}(),ut(65,90),ut(97,122),it="Trigonometry",Ot(["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),ct(lt,"\\cos","\\sin","\\tan"),ct("UNCOMMON","\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arcsec","\\arccsc"),ct("UNCOMMON","\\arsinh","\\arccosh","\\arctanh","\\arcsech","\\arccsch"),ct("UNCOMMON","\\arg","\\ch","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\lg","\\lb","\\sec","\\sinh","\\sh","\\tanh","\\tg","\\th"),it="Functions",Ot(["\\deg","\\dim","\\exp","\\hom","\\ker","\\lb","\\lg","\\ln","\\log"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),ct(lt,"\\ln","\\log","\\exp"),ct(292,"\\hom"),ct(at,"\\dim"),ct(at,"\\ker","\\deg"),Ot(["\\lim","\\mod"],"",null,(function(t){return{type:"mop",limits:"limits",symbol:!1,body:t.slice(1),baseFontFamily:"cmr"}})),Ot(["\\det","\\max","\\min"],"",null,(function(t){return{type:"mop",limits:"limits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),ct(lt,"\\lim"),ct(at,"\\det"),ct(at,"\\mod"),ct(at,"\\min"),ct(at,"\\max"),it="Decoration",Ot("\\rule","[raise:dimen]{width:dimen}{thickness:dimen}",null,(function(t,e){return{type:"rule",shift:e[0],width:e[1],height:e[2]}})),Ot("\\color","{:color}",{allowedInText:!0},(t,e)=>({color:e[0]})),Ot("\\textcolor","{:color}{content:auto*}",{allowedInText:!0},(t,e)=>({color:e[0]})),ct(3,"\\textcolor"),Ot("\\overline","{:auto}",null,(function(t,e){return{type:"line",position:"overline",skipBoundary:!0,body:e[0]}})),ct(at,"\\overline"),Ot("\\underline","{:auto}",null,(function(t,e){return{type:"line",position:"underline",skipBoundary:!0,body:e[0]}})),ct(at,"\\underline"),Ot("\\overset","{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",overscript:e[0],skipBoundary:!0,body:e[1]}})),ct(at,"\\overset"),Ot("\\underset","{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",underscript:e[0],skipBoundary:!0,body:e[1]}})),ct(at,"\\underset"),Ot(["\\stackrel","\\stackbin"],"{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",overscript:e[0],skipBoundary:!0,body:e[1],mathtype:"\\stackrel"===t?"mrel":"mbin"}})),ct(at,"\\stackrel"),ct(0,"\\stackbin"),Ot("\\rlap","{:auto}",null,(function(t,e){return{type:"overlap",align:"right",skipBoundary:!0,body:e[0]}})),ct(270,"\\rlap"),Ot("\\llap","{:auto}",null,(function(t,e){return{type:"overlap",align:"left",skipBoundary:!0,body:e[0]}})),ct(18,"\\llap"),Ot("\\mathrlap","{:auto}",null,(function(t,e){return{type:"overlap",mode:"math",align:"right",skipBoundary:!0,body:e[0]}})),ct(ot,"\\mathrlap"),Ot("\\mathllap","{:auto}",null,(function(t,e){return{type:"overlap",mode:"math",align:"left",skipBoundary:!0,body:e[0]}})),ct(ot,"\\mathllap"),Ot("\\boxed","{content:math}",null,(function(t,e){return{type:"box",framecolor:"black",skipBoundary:!0,body:e[0]}})),ct(1236,"\\boxed"),Ot("\\colorbox","{background-color:color}{content:auto}",{allowedInText:!0},(function(t,e){return{type:"box",backgroundcolor:e[0],skipBoundary:!0,body:e[1]}})),ct(ot,"\\colorbox"),Ot("\\fcolorbox","{frame-color:color}{background-color:color}{content:auto}",{allowedInText:!0},(function(t,e){return{type:"box",framecolor:e[0],backgroundcolor:e[1],skipBoundary:!0,body:e[2]}})),ct(ot,"\\fcolorbox"),Ot("\\bbox","[:bbox]{body:auto}",{allowedInText:!0},(function(t,e){return e[0]?{type:"box",padding:e[0].padding,border:e[0].border,backgroundcolor:e[0].backgroundcolor,skipBoundary:!0,body:e[1]}:{type:"box",skipBoundary:!0,body:e[1]}})),ct(ot,"\\bbox"),Ot("\\enclose","{notation:string}[style:string]{body:auto}",null,(function(t,e){let i=e[0]||[];const s={type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",backgroundcolor:"transparent",padding:"auto",shadow:"auto",captureSelection:!0,body:e[2]};if(e[1]){const t=e[1].split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(const e of t){const t=e.match(/\s*(\S+)\s+(\S+)\s+(.*)/);if(t)s.strokeWidth=E.toPx(t[1],"px"),isFinite(s.strokeWidth)||(s.strokeWidth=1),s.strokeStyle=t[2],s.strokeColor=t[3];else{const t=e.match(/\s*([a-z]*)\s*=\s*"(.*)"/);t&&("mathbackground"===t[1]?s.backgroundcolor=t[2]:"mathcolor"===t[1]?s.strokeColor=t[2]:"padding"===t[1]?s.padding=E.toPx(t[2],"px"):"shadow"===t[1]&&(s.shadow=t[2]))}}"dashed"===s.strokeStyle?s.svgStrokeStyle="5,5":"dotted"===s.strokeStyle&&(s.svgStrokeStyle="1,5")}s.borderStyle=s.strokeWidth+"px "+s.strokeStyle+" "+s.strokeColor,i=i.toString().split(/[, ]/).filter(t=>t.length>0).map(t=>t.toLowerCase()),s.notation={};for(const n of i)s.notation[n]=!0;return s.notation.updiagonalarrow&&(s.notation.updiagonalstrike=!1),s.notation.box&&(s.notation.left=!1,s.notation.right=!1,s.notation.bottom=!1,s.notation.top=!1),s})),ct(ot,"\\enclose"),Ot("\\cancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{updiagonalstrike:!0},body:e[0]}})),Ot("\\bcancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{downdiagonalstrike:!0},body:e[0]}})),Ot("\\xcancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{updiagonalstrike:!0,downdiagonalstrike:!0},body:e[0]}})),ct(ot,"\\cancel","\\bcancel","\\xcancel"),it="Styling",Ot(["\\tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],"",{allowedInText:!0},(function(t,e){return{fontSize:{tiny:"size1",scriptsize:"size2",footnotesize:"size3",small:"size4",normalsize:"size5",large:"size6",Large:"size7",LARGE:"size8",huge:"size9",Huge:"size10"}[t.slice(1)]}})),Ot("\\fontseries","{:text}",{allowedInText:!0},(t,e)=>({fontSeries:Tt(e[0])})),Ot("\\bf","",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),Ot("\\bm","{:math*}",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),Ot("\\bold","",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"b"})),Ot(["\\mathbf","\\boldsymbol"],"{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"b",fontShape:"n"})),Ot("\\bfseries","",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),Ot("\\textbf","{:text*}",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),Ot("\\mathmd","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"m",fontShape:"n"})),Ot("\\mdseries","",{allowedInText:!0},(t,e)=>({fontSeries:"m"})),Ot("\\textmd","{:math*}",{allowedInText:!0},(t,e)=>({fontSeries:"m"})),Ot("\\fontshape","{:text}",{allowedInText:!0},(t,e)=>({fontShape:Tt(e[0])})),Ot("\\it","",{allowedInText:!0},(t,e)=>({fontShape:"it"})),Ot("\\mathit","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"m",fontShape:"it"})),Ot("\\upshape","",{allowedInText:!0},(t,e)=>({fontShape:"n"})),Ot("\\textup","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"n"})),Ot("\\textit","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"it"})),Ot("\\slshape","",{allowedInText:!0},(t,e)=>({fontShape:"sl"})),Ot("\\textsl","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"sl"})),Ot("\\scshape","",{allowedInText:!0},(t,e)=>({mode:"text",fontShape:"sc"})),Ot("\\textsc","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"sc"})),Ot("\\fontfamily","{:text}",{allowedInText:!0},(t,e)=>({fontFamily:Tt(e[0])})),Ot("\\mathrm","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontFamily:"cmr",fontSeries:"m",fontShape:"n"})),Ot("\\rmfamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmr"})),Ot("\\textrm","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmr"})),Ot("\\mathsf","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cmss",fontSeries:"m",fontShape:"n"})),Ot("\\sffamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmss"})),Ot("\\textsf","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmss"})),Ot("\\mathtt","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cmtt",fontSeries:"m",fontShape:"n"})),Ot("\\ttfamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmtt"})),Ot("\\texttt","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmtt"})),Ot(["\\Bbb","\\mathbb"],"{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"bb"})),Ot(["\\frak","\\mathfrak"],"{:math*}",{allowedInText:!0},(t,e)=>({baseFontFamily:"frak"})),Ot("\\mathcal","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cal",fontSeries:"m",fontShape:"n"})),Ot("\\mathscr","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"scr",fontSeries:"m",fontShape:"n"})),ct(lt,"\\mathbb"),ct(1081,"\\Bbb"),ct(0,"\\mathcal"),ct(at,"\\mathfrak"),ct(271,"\\frak"),ct(at,"\\mathscr"),ct("UNCOMMON","\\mathsf"),ct(at,"\\mathtt"),ct(at,"\\boldsymbol"),Ot("\\textnormal","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmr",fontShape:"n",fontSeries:"n"})),Ot("\\mbox","{:text*}",null,(t,e)=>({fontFamily:"cmr"})),Ot("\\text","{:text*}",{allowedInText:!0},(t,e)=>({})),Ot("\\class","{name:text}{content:auto*}",{allowedInText:!0},(t,e)=>({cssClass:Tt(e[0])})),Ot("\\cssId","{id:text}{content:auto}",{allowedInText:!0},(t,e)=>({cssId:Tt(e[0]),body:e[1],type:"group"})),Ot("\\em","",{allowedInText:!0},(t,e)=>({cssClass:"ML__emph",type:"group"})),Ot("\\emph","{:auto}",{allowedInText:!0},(t,e)=>({cssClass:"ML__emph",body:e[0],type:"group",skipBoundary:!0})),ct(at,"\\textrm"),ct(at,"\\textit"),ct(at,"\\textsf"),ct(at,"\\texttt"),ct(433,"\\textnormal"),ct(at,"\\textbf"),ct(421,"\\textup"),ct(819,"\\emph"),ct(49,"\\em"),it="Operators",Ot("\\sqrt","[index:auto]{radicand:auto}",null,(function(t,e){return{type:"surd",body:e[1],index:e[0]}})),ct(lt,"\\sqrt"),it="Fractions",Ot(["\\frac","\\dfrac","\\tfrac","\\cfrac","\\binom","\\dbinom","\\tbinom"],"{numerator}{denominator}",null,(function(t,e){const i={type:"genfrac",numer:e[0],denom:e[1],mathstyle:"auto"};switch(t){case"\\dfrac":case"\\frac":case"\\tfrac":case"\\cfrac":i.hasBarLine=!0;break;case"\\\\atopfrac":i.hasBarLine=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":i.hasBarLine=!1,i.leftDelim="(",i.rightDelim=")"}switch(t){case"\\dfrac":case"\\dbinom":i.mathstyle="displaystyle";break;case"\\tfrac":case"\\tbinom":i.mathstyle="textstyle"}return"\\cfrac"===t&&(i.continuousFraction=!0),i})),Ot(["\\over","\\atop","\\choose"],"",{infix:!0},(function(t,e){const i=e[0],s=e[1];let n=!1,r=null,o=null;switch(t){case"\\atop":break;case"\\over":n=!0;break;case"\\choose":n=!1,r="(",o=")";break;default:throw new Error("Unrecognized genfrac command")}return{type:"genfrac",numer:i,denom:s,hasBarLine:n,leftDelim:r,rightDelim:o,mathstyle:"auto"}})),ct(21,"\\over"),ct(12,"\\atop"),ct(1968,"\\choose"),Ot(["\\overwithdelims","\\atopwithdelims"],"{left-delim:delim}{right-delim:delim}",{infix:!0},(function(t,e){return{type:"genfrac",numer:e[0],denom:e[1],hasBarLine:!1,leftDelim:e[2],rightDelim:e[3],mathstyle:"auto"}})),ct(15,"\\overwithdelims"),ct(at,"\\atopwithdelims"),it="Fractions",Ot("\\pdiff","{numerator}{denominator}",null,(function(t,e){return{type:"genfrac",numer:e[0],denom:e[1],numerPrefix:"∂",denomPrefix:"∂",hasBarLine:!0,leftDelim:null,rightDelim:null,mathstyle:"auto"}})),it="Quantifiers",dt("\\forall","",xt,"∀",lt),dt("\\exists","",xt,"∃",lt),dt("\\nexists",vt,xt,"∄",lt),dt("\\mid","",Pt,"∣",at),dt("\\top","",xt,"⊤","RARE"),dt("\\bot","",xt,"⊥","RARE"),it="Variable Sized Symbols",Ot(["\\sum","\\prod","\\bigcup","\\bigcap","\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","\\intop"],"",null,(function(t){return{type:"mop",limits:"auto",symbol:!0,baseFontFamily:"cmr",body:{coprod:"∐",bigvee:"⋁",bigwedge:"⋀",biguplus:"⨄",bigcap:"⋂",bigcup:"⋃",intop:"∫",prod:"∏",sum:"∑",bigotimes:"⨂",bigoplus:"⨁",bigodot:"⨀",bigsqcup:"⨆",smallint:"∫"}[t.slice(1)]}})),Ot(["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\ointctrclockwise","\\intctrclockwise"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!0,body:{int:"∫",iint:"∬",iiint:"∭",oint:"∮",oiint:"∯",oiiint:"∰",intclockwise:"∱",varointclockwise:"∲",ointctrclockwise:"∳",intctrclockwise:"⨑"}[t.slice(1)]}})),ct(lt,"\\sum","\\prod","\\bigcap","\\bigcup","\\int"),ct(at,"\\bigoplus","\\smallint","\\iint","\\oint"),ct("RARE","\\bigwedge","\\bigvee"),ct(756,"\\coprod"),ct(723,"\\bigsqcup"),ct(1241,"\\bigotimes"),ct(150,"\\bigodot"),ct(174,"\\biguplus"),ct(878,"\\iiint"),ct(97,"\\intop"),it="Various",dt("\\sharp","",xt,"♯",at),dt("\\flat","",xt,"♭",590),dt("\\natural","",xt,"♮",278),dt("\\#","",xt,"#","RARE"),dt("\\&","",xt,"&","RARE"),dt("\\clubsuit","",xt,"♣",172),dt("\\heartsuit","",xt,"♡","ARCANE"),dt("\\spadesuit","",xt,"♠","ARCANE"),dt("\\diamondsuit","",xt,"♢",ot),dt("\\differencedelta","",Pt,"∆",at),it="Letters and Letter Like Forms",Ot("\\unicode","{charcode:number}",null,(function(t,e){let i=parseInt(e[0]);return isFinite(i)||(i=10067),{type:"mord",body:String.fromCodePoint(i)}})),dt("\\backslash","",xt,"\\"),dt("?","",xt,"?"),dt("!","",xt,"!"),dt("\\nabla","",xt,"∇",lt),dt("\\partial","",xt,"∂",lt),dt("\\ell","",xt,"ℓ",at),dt("\\imaginaryI","",xt,"i"),dt("\\imaginaryJ","",xt,"j"),Ot(["\\Re","\\Im"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:{"\\Re":"ℜ","\\Im":"ℑ"}[t],baseFontFamily:"frak"}})),dt("\\hbar","",xt,"ℏ",at),dt("\\hslash",vt,xt,"ℏ",at),dt("\\differentialD","cmr",xt,"d"),dt("\\rd","cmr",xt,"d"),dt("\\capitalDifferentialD","cmr",xt,"D"),dt("\\rD","cmr",xt,"D"),dt("\\exponentialE","cmr",xt,"e"),dt("\\Finv",vt,xt,"Ⅎ",3),dt("\\Game",vt,xt,"⅁",1),dt("\\wp","",xt,"℘",1306),dt("\\eth",vt,xt,"ð",77),dt("\\mho",vt,xt,"℧",138),dt("\\Bbbk",vt,xt,"k"),dt("\\doubleStruckCapitalN","bb",xt,"N"),dt("\\N","bb",xt,"N"),dt("\\doubleStruckCapitalR","bb",xt,"R"),dt("\\R","bb",xt,"R"),dt("\\doubleStruckCapitalQ","bb",xt,"Q"),dt("\\Q","bb",xt,"Q"),dt("\\doubleStruckCapitalC","bb",xt,"C"),dt("\\C","bb",xt,"C"),dt("\\doubleStruckCapitalZ","bb",xt,"Z"),dt("\\Z","bb",xt,"Z"),dt("\\doubleStruckCapitalP","bb",xt,"P"),dt("\\P","bb",xt,"P"),dt("\\scriptCapitalE","scr",xt,"E"),dt("\\scriptCapitalH","scr",xt,"H"),dt("\\scriptCapitalL","scr",xt,"L"),dt("\\gothicCapitalC","frak",xt,"C"),dt("\\gothicCapitalH","frak",xt,"H"),dt("\\gothicCapitalI","frak",xt,"I"),dt("\\gothicCapitalR","frak",xt,"R"),dt("\\pounds","",xt,"£",509),dt("\\yen",vt,xt,"¥",57),dt("\\euro","",xt,"€",4),it="Crosses",dt("\\textdagger","",_t,"†"),dt("\\dagger","",_t,"†",at),dt("\\dag","",_t,"†",at),dt("\\ddag","",_t,"‡",500),dt("\\textdaggerdbl","",_t,"‡"),dt("\\ddagger","",_t,"‡",353),dt("\\maltese",vt,xt,"✠",24),it="Arrows",dt("\\longrightarrow","",Pt,"⟶",lt),dt("\\rightarrow","",Pt,"→",lt),dt("\\Longrightarrow","",Pt,"⟹",lt),dt("\\Rightarrow","",Pt,"⇒",lt),dt("\\longmapsto","",Pt,"⟼",at),dt("\\mapsto","",Pt,"↦",at),dt("\\Longleftrightarrow","",Pt,"⟺",at),dt("\\rightleftarrows",vt,Pt,"⇄",at),dt("\\leftarrow","",Pt,"←",at),dt("\\curvearrowleft",vt,Pt,"↶",at),dt("\\uparrow","",Pt,"↑",at),dt("\\downarrow","",Pt,"↓",at),dt("\\hookrightarrow","",Pt,"↪",at),dt("\\rightharpoonup","",Pt,"⇀",at),dt("\\rightleftharpoons","",Pt,"⇌",at),dt("\\Leftarrow","",Pt,"⇐",1695),dt("\\longleftrightarrow","",Pt,"⟷",1599),dt("\\longleftarrow","",Pt,"⟵",878),dt("\\Longleftarrow","",Pt,"⟸",296),dt("\\searrow","",Pt,"↘",1609),dt("\\nearrow","",Pt,"↗",1301),dt("\\swarrow","",Pt,"↙",167),dt("\\nwarrow","",Pt,"↖",108),dt("\\Uparrow","",Pt,"⇑",257),dt("\\Downarrow","",Pt,"⇓",556),dt("\\updownarrow","",Pt,"↕",192),dt("\\Updownarrow","",Pt,"⇕",161),dt("\\hookleftarrow","",Pt,"↩",115),dt("\\leftharpoonup","",Pt,"↼",93),dt("\\leftharpoondown","",Pt,"↽",42),dt("\\rightharpoondown","",Pt,"⇁",80),dt("\\leftrightarrows",vt,Pt,"⇆",765),dt("\\dashrightarrow",vt,Pt,"⇢",311),dt("\\dashleftarrow",vt,Pt,"⇠",5),dt("\\leftleftarrows",vt,Pt,"⇇",8),dt("\\Lleftarrow",vt,Pt,"⇚",7),dt("\\twoheadleftarrow",vt,Pt,"↞",32),dt("\\leftarrowtail",vt,Pt,"↢",25),dt("\\looparrowleft",vt,Pt,"↫",6),dt("\\leftrightharpoons",vt,Pt,"⇋",205),dt("\\circlearrowleft",vt,Pt,"↺",105),dt("\\Lsh",vt,Pt,"↰",11),dt("\\upuparrows",vt,Pt,"⇈",15),dt("\\downharpoonleft",vt,Pt,"⇃",21),dt("\\multimap",vt,Pt,"⊸",108),dt("\\leftrightsquigarrow",vt,Pt,"↭",31),dt("\\twoheadrightarrow",vt,Pt,"↠",835),dt("\\rightarrowtail",vt,Pt,"↣",195),dt("\\looparrowright",vt,Pt,"↬",37),dt("\\curvearrowright",vt,Pt,"↷",209),dt("\\circlearrowright",vt,Pt,"↻",63),dt("\\Rsh",vt,Pt,"↱",18),dt("\\downdownarrows",vt,Pt,"⇊",6),dt("\\upharpoonright",vt,Pt,"↾",579),dt("\\downharpoonright",vt,Pt,"⇂",39),dt("\\rightsquigarrow",vt,Pt,"⇝",674),dt("\\leadsto",vt,Pt,"⇝",709),dt("\\Rrightarrow",vt,Pt,"⇛",62),dt("\\restriction",vt,Pt,"↾",29),dt("\\upharpoonleft",vt,Pt,"↿",ot),dt("\\rightrightarrows",vt,Pt,"⇉",ot),it="Negated Arrows",dt("\\nrightarrow",vt,Pt,"↛",324),dt("\\nRightarrow",vt,Pt,"⇏",107),dt("\\nleftrightarrow",vt,Pt,"↮",36),dt("\\nLeftrightarrow",vt,Pt,"⇎",20),dt("\\nleftarrow",vt,Pt,"↚",7),dt("\\nLeftarrow",vt,Pt,"⇍",5),it="Negated Relations",dt("\\nless",vt,Pt,"≮",146),dt("\\nleqslant",vt,Pt,"",58),dt("\\lneq",vt,Pt,"⪇",54),dt("\\lneqq",vt,Pt,"≨",36),dt("\\nleqq",vt,Pt,"",18),dt("\\unlhd",vt,_t,"⊴",253),dt("\\unrhd",vt,_t,"⊵",66),dt("\\lvertneqq",vt,Pt,"",6),dt("\\lnsim",vt,Pt,"⋦",4),dt("\\lnapprox",vt,Pt,"⪉",ot),dt("\\nprec",vt,Pt,"⊀",71),dt("\\npreceq",vt,Pt,"⋠",57),dt("\\precnsim",vt,Pt,"⋨",4),dt("\\precnapprox",vt,Pt,"⪹",2),dt("\\nsim",vt,Pt,"≁",40),dt("\\nshortmid",vt,Pt,"",1),dt("\\nmid",vt,Pt,"∤",417),dt("\\nvdash",vt,Pt,"⊬",266),dt("\\nvDash",vt,Pt,"⊭",405),dt("\\ngtr",vt,Pt,"≯",90),dt("\\ngeqslant",vt,Pt,"",23),dt("\\ngeqq",vt,Pt,"",12),dt("\\gneq",vt,Pt,"⪈",29),dt("\\gneqq",vt,Pt,"≩",35),dt("\\gvertneqq",vt,Pt,"",6),dt("\\gnsim",vt,Pt,"⋧",3),dt("\\gnapprox",vt,Pt,"⪊",ot),dt("\\nsucc",vt,Pt,"⊁",44),dt("\\nsucceq",vt,Pt,"⋡",ot),dt("\\succnsim",vt,Pt,"⋩",4),dt("\\succnapprox",vt,Pt,"⪺",ot),dt("\\ncong",vt,Pt,"≆",128),dt("\\nshortparallel",vt,Pt,"",6),dt("\\nparallel",vt,Pt,"∦",54),dt("\\nVDash",vt,Pt,"⊯",5),dt("\\nsupseteqq",vt,Pt,"",1),dt("\\supsetneq",vt,Pt,"⊋",286),dt("\\varsupsetneq",vt,Pt,"",2),dt("\\supsetneqq",vt,Pt,"⫌",49),dt("\\varsupsetneqq",vt,Pt,"",3),dt("\\nVdash",vt,Pt,"⊮",179),dt("\\precneqq",vt,Pt,"⪵",11),dt("\\succneqq",vt,Pt,"⪶",3),dt("\\nsubseteqq",vt,Pt,"",16),it="Various",dt("\\checkmark",vt,xt,"✓",1025),dt("\\diagup",vt,xt,"╱",440),dt("\\diagdown",vt,xt,"╲",175),dt("\\measuredangle",vt,xt,"∡",271),dt("\\sphericalangle",vt,xt,"∢",156),dt("\\backprime",vt,xt,"‵",104),dt("\\backdoubleprime",vt,xt,"‶",ot),it="Shapes",dt("\\ast","",_t,"∗",lt),dt("\\star","",_t,"⋆",at),dt("\\diamond","",_t,"⋄",1356),dt("\\Diamond",vt,xt,"◊",695),dt("\\lozenge",vt,xt,"◊",422),dt("\\blacklozenge",vt,xt,"⧫",344),dt("\\bigstar",vt,xt,"★",168),it="Hebrew",dt("\\aleph","",xt,"ℵ",1381),dt("\\beth",vt,xt,"ℶ",54),dt("\\daleth",vt,xt,"ℸ",43),dt("\\gimel",vt,xt,"ℷ",36),it="Fences",dt("\\lbrace","",St,"{",lt),dt("\\rbrace","",wt,"}",lt),dt("\\langle","",St,"⟨",at),dt("\\rangle","",wt,"⟩",at),dt("\\lfloor","",St,"⌊",at),dt("\\rfloor","",wt,"⌋",at),dt("\\lceil","",St,"⌈",at),dt("\\rceil","",wt,"⌉",at),dt("\\vert","",xt,"∣",lt),dt("\\mvert","",Pt,"∣"),dt("\\lvert","",St,"∣",496),dt("\\rvert","",wt,"∣",496),dt("\\|","",xt,"∥"),dt("\\Vert","",xt,"∥",lt),dt("\\mVert","",xt,"∥"),dt("\\lVert","",St,"∥",287),dt("\\rVert","",wt,"∥",ot),dt("\\lbrack","",St,"[",574),dt("\\rbrack","",wt,"]",213),dt("\\{","",St,"{"),dt("\\}","",wt,"}"),dt("(","",St,"("),dt(")","",wt,")"),dt("[","",St,"["),dt("]","",wt,"]"),dt("\\ulcorner",vt,St,"┌",296),dt("\\urcorner",vt,wt,"┐",310),dt("\\llcorner",vt,St,"└",137),dt("\\lrcorner",vt,wt,"┘",199),dt("\\lgroup","",St,"⟮",24),dt("\\rgroup","",wt,"⟯",24),dt("\\lmoustache","",St,"⎰",ot),dt("\\rmoustache","",wt,"⎱",ot),Ot(["\\middle"],"{:delim}",null,(function(t,e){return{type:"delim",delim:e[0]}})),it="Sizing";const Nt={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}};function Lt(t){let e="",i=!0;for(const s of t)"string"==typeof s.body?e+=s.body:i=!1;return i?e:""}Ot(["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],"{:delim}",null,(function(t,e){return{type:"sizeddelim",size:Nt[t].size,cls:Nt[t].mclass,delim:e[0]}})),it="Relations",dt("=","",Pt,"=",lt),dt("\\ne","",Pt,"≠",lt),dt("\\neq","",Pt,"≠",at),dt("<","",Pt,"<",lt),dt("\\lt","",Pt,"<",at),dt(">","",Pt,">",lt),dt("\\gt","",Pt,">",at),dt("\\le","",Pt,"≤",at),dt("\\ge","",Pt,"≥",at),dt("\\leqslant",vt,Pt,"⩽",lt),dt("\\geqslant",vt,Pt,"⩾",lt),dt("\\leq","",Pt,"≤",at),dt("\\geq","",Pt,"≥",at),dt("\\ll","",Pt,"≪"),dt("\\gg","",Pt,"≫",at),dt("\\coloneq","",Pt,"≔",5),dt("\\measeq","",Pt,"≝"),dt("\\eqdef","",Pt,"≞"),dt("\\questeq","",Pt,"≟"),dt(":","",Pt,":"),dt("\\cong","",Pt,"≅",at),dt("\\equiv","",Pt,"≡",at),dt("\\prec","",Pt,"≺",at),dt("\\preceq","",Pt,"⪯",at),dt("\\succ","",Pt,"≻",at),dt("\\succeq","",Pt,"⪰",1916),dt("\\perp","",Pt,"⊥",at),dt("\\parallel","",Pt,"∥",at),dt("\\propto","",Pt,"∝",at),dt("\\Colon","",Pt,"∷"),dt("\\smile","",Pt,"⌣",at),dt("\\frown","",Pt,"⌢",at),dt("\\sim","",Pt,"∼",at),dt("\\gtrsim",vt,Pt,"≳",at),dt("\\approx","",Pt,"≈",lt),dt("\\approxeq",vt,Pt,"≊",147),dt("\\thickapprox",vt,Pt,"≈",377),dt("\\lessapprox",vt,Pt,"⪅",146),dt("\\gtrapprox",vt,Pt,"⪆",95),dt("\\precapprox",vt,Pt,"⪷",50),dt("\\succapprox",vt,Pt,"⪸",ot),dt("\\thicksim",vt,Pt,"∼",779),dt("\\succsim",vt,Pt,"≿",251),dt("\\precsim",vt,Pt,"≾",104),dt("\\backsim",vt,Pt,"∽",251),dt("\\eqsim",vt,Pt,"≂",62),dt("\\backsimeq",vt,Pt,"⋍",91),dt("\\simeq","",Pt,"≃",ot),dt("\\lesssim",vt,Pt,"≲",ot),dt("\\nleq",vt,Pt,"≰",369),dt("\\ngeq",vt,Pt,"≱",164),dt("\\smallsmile",vt,Pt,"⌣",31),dt("\\smallfrown",vt,Pt,"⌢",71),dt("\\bowtie","",Pt,"⋈",558),dt("\\asymp","",Pt,"≍",755),dt("\\sqsubseteq","",Pt,"⊑",1255),dt("\\sqsupseteq","",Pt,"⊒",183),dt("\\leqq",vt,Pt,"≦",1356),dt("\\eqslantless",vt,Pt,"⪕",15),dt("\\lll",vt,Pt,"⋘",157),dt("\\lessgtr",vt,Pt,"≶",281),dt("\\lesseqgtr",vt,Pt,"⋚",134),dt("\\lesseqqgtr",vt,Pt,"⪋",ot),dt("\\risingdotseq",vt,Pt,"≓",8),dt("\\fallingdotseq",vt,Pt,"≒",99),dt("\\subseteqq",vt,Pt,"⫅",82),dt("\\Subset",vt,Pt,"⋐"),dt("\\sqsubset",vt,Pt,"⊏",309),dt("\\preccurlyeq",vt,Pt,"≼",549),dt("\\curlyeqprec",vt,Pt,"⋞",14),dt("\\vDash",vt,Pt,"⊨",646),dt("\\Vvdash",vt,Pt,"⊪",20),dt("\\bumpeq",vt,Pt,"≏",13),dt("\\Bumpeq",vt,Pt,"≎",12),dt("\\geqq",vt,Pt,"≧",972),dt("\\eqslantgtr",vt,Pt,"⪖",13),dt("\\ggg",vt,Pt,"⋙",127),dt("\\gtrless",vt,Pt,"≷",417),dt("\\gtreqless",vt,Pt,"⋛",190),dt("\\gtreqqless",vt,Pt,"⪌",91),dt("\\supseteqq",vt,Pt,"⫆",6),dt("\\Supset",vt,Pt,"⋑",34),dt("\\sqsupset",vt,Pt,"⊐",71),dt("\\succcurlyeq",vt,Pt,"≽",442),dt("\\curlyeqsucc",vt,Pt,"⋟",10),dt("\\Vdash",vt,Pt,"⊩",276),dt("\\shortmid",vt,Pt,"∣",67),dt("\\shortparallel",vt,Pt,"∥",17),dt("\\between",vt,Pt,"≬",110),dt("\\pitchfork",vt,Pt,"⋔",66),dt("\\varpropto",vt,Pt,"∝",203),dt("\\backepsilon",vt,Pt,"∍",176),dt("\\llless",vt,Pt,"⋘",ot),dt("\\gggtr",vt,Pt,"⋙",ot),dt("\\lhd",vt,_t,"⊲",447),dt("\\rhd",vt,_t,"⊳",338),dt("\\Join","",Pt,"⋈",35),dt("\\doteq","",Pt,"≐",1450),dt("\\doteqdot",vt,Pt,"≑",60),dt("\\Doteq",vt,Pt,"≑",ot),dt("\\eqcirc",vt,Pt,"≖",6),dt("\\circeq",vt,Pt,"≗",31),dt("\\lessdot",vt,_t,"⋖",88),dt("\\gtrdot",vt,_t,"⋗",45),dt("\\~","",Pt,"~"),it="Logic",dt("\\leftrightarrow","",Pt,"↔",lt),dt("\\Leftrightarrow","",Pt,"⇔",lt),dt("\\to","",Pt,"→",lt),dt("\\models","",Pt,"⊨",at),dt("\\vdash","",Pt,"⊢",at),dt("\\therefore",vt,Pt,"∴",1129),dt("\\because",vt,Pt,"∵",388),dt("\\implies","",Pt,"⟹",1858),dt("\\gets","",Pt,"←",150),dt("\\dashv","",Pt,"⊣",299),dt("\\impliedby","",Pt,"⟸",ot),dt("\\biconditional","",Pt,"⟷",ot),dt("\\roundimplies","",Pt,"⥰",ot),it="Operators",dt("+","",_t,"+",lt),dt("-","",_t,"−",lt),dt("−","",_t,"−",lt),dt("\\pm","",_t,"±",at),dt("\\mp","",_t,"∓",at),dt("*","",_t,"∗",at),dt("\\times","",_t,"×",at),dt("\\div","",_t,"÷",at),dt("\\surd","",xt,"√",at),dt("\\divides","",_t,"∣",ot),dt("\\ltimes",vt,_t,"⋉",576),dt("\\rtimes",vt,_t,"⋊",946),dt("\\leftthreetimes",vt,_t,"⋋",34),dt("\\rightthreetimes",vt,_t,"⋌",14),dt("\\intercal",vt,_t,"⊺",478),dt("\\dotplus",vt,_t,"∔",81),dt("\\centerdot",vt,_t,"⋅",271),dt("\\doublebarwedge",vt,_t,"⩞",5),dt("\\divideontimes",vt,_t,"⋇",51),dt("\\cdot","",_t,"⋅",ot),it="Others",dt("\\infty","",xt,"∞",lt),dt("\\prime","",Ct,"′",lt),dt("\\doubleprime","",xt,"″"),dt("\\angle","",xt,"∠",at),dt("`","",xt,"‘"),dt("\\$","",xt,"$"),dt("\\%","",xt,"%"),dt("\\_","",xt,"_"),it="Greek",dt("\\alpha","",Ct,"α",at),dt("\\beta","",Ct,"β",at),dt("\\gamma","",Ct,"γ",at),dt("\\delta","",Ct,"δ",at),dt("\\epsilon","",Ct,"ϵ",at),dt("\\varepsilon","",Ct,"ε"),dt("\\zeta","",Ct,"ζ",at),dt("\\eta","",Ct,"η",at),dt("\\theta","",Ct,"θ",at),dt("\\vartheta","",Ct,"ϑ",at),dt("\\iota","",Ct,"ι",at),dt("\\kappa","",Ct,"κ",at),dt("\\varkappa",vt,Ct,"ϰ",at),dt("\\lambda","",Ct,"λ",at),dt("\\mu","",Ct,"μ",at),dt("\\nu","",Ct,"ν",at),dt("\\xi","",Ct,"ξ",at),dt("\\omicron","",Ct,"o"),dt("\\pi","",Ct,"π",at),dt("\\varpi","",Ct,"ϖ",at),dt("\\rho","",Ct,"ρ",at),dt("\\varrho","",Ct,"ϱ",at),dt("\\sigma","",Ct,"σ",at),dt("\\varsigma","",Ct,"ς",at),dt("\\tau","",Ct,"τ",at),dt("\\phi","",Ct,"ϕ",at),dt("\\varphi","",Ct,"φ",at),dt("\\upsilon","",Ct,"υ",at),dt("\\chi","",Ct,"χ",at),dt("\\psi","",Ct,"ψ",at),dt("\\omega","",Ct,"ω",at),dt("\\Gamma","",Ct,"Γ",at),dt("\\Delta","",Ct,"Δ",at),dt("\\Theta","",Ct,"Θ",at),dt("\\Lambda","",Ct,"Λ",at),dt("\\Xi","",Ct,"Ξ",at),dt("\\Pi","",Ct,"Π",at),dt("\\Sigma","",Ct,"Σ",at),dt("\\Upsilon","",Ct,"Υ",at),dt("\\Phi","",Ct,"Φ",at),dt("\\Psi","",Ct,"Ψ",at),dt("\\Omega","",Ct,"Ω",at),dt("\\digamma",vt,Ct,"ϝ",248),it="Others",dt("\\emptyset","",xt,"∅",lt),dt("\\varnothing",vt,xt,"∅",lt),it="Set Operators",dt("\\cap","",_t,"∩",lt),dt("\\cup","",_t,"∪",lt),dt("\\setminus","",_t,"∖",at),dt("\\smallsetminus",vt,_t,"∖",254),dt("\\complement",vt,xt,"∁",200),it="Set Relations",dt("\\in","",Pt,"∈",lt),dt("\\notin","",Pt,"∉",lt),dt("\\not","",Pt,"̸",at),dt("\\ni","",Pt,"∋",at),dt("\\owns","",Pt,"∋",18),dt("\\subset","",Pt,"⊂",lt),dt("\\supset","",Pt,"⊃",lt),dt("\\subseteq","",Pt,"⊆",lt),dt("\\supseteq","",Pt,"⊇",lt),dt("\\subsetneq",vt,Pt,"⊊",1945),dt("\\varsubsetneq",vt,Pt,"",198),dt("\\subsetneqq",vt,Pt,"⫋",314),dt("\\varsubsetneqq",vt,Pt,"",55),dt("\\nsubset",vt,Pt,"⊄",ot),dt("\\nsupset",vt,Pt,"⊅",ot),dt("\\nsubseteq",vt,Pt,"⊈",950),dt("\\nsupseteq",vt,Pt,"⊉",49),it="Spacing",dt("\\ ","",Et," "),dt("~","",Et," "),dt("\\space","",Et," "),dt("\\!","",Et,null),dt("\\,","",Et,null),dt("\\:","",Et,null),dt("\\;","",Et,null),dt("\\enskip","",Et,null),dt("\\enspace","",Et,null,672),dt("\\quad","",Et,null,at),dt("\\qquad","",Et,null,at),Ot(["\\hspace","\\hspace*"],"{width:skip}",{allowedInText:!0},(function(t,e){return{type:"spacing",width:e[0]||0}})),Ot(["\\mathop","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathord","\\mathinner"],"{:auto}",null,(function(t,e){const i={type:{"\\mathop":"mop","\\mathbin":"mbin","\\mathrel":"mrel","\\mathopen":"mopen","\\mathclose":"mclose","\\mathpunct":"mpunct","\\mathord":"mord","\\mathinner":"minner"}[t],body:Lt(e[0])||e[0],captureSelection:!0,baseFontFamily:"\\mathop"===t?"math":""};return"\\mathop"===t&&(i.limits="nolimits",i.isFunction=!0),i})),Ot(["\\operatorname","\\operatorname*"],"{operator:string}",null,(function(t,e){const i={type:"mop",skipBoundary:!0,body:e[0],isFunction:!0,baseFontFamily:"cmr"};return"\\operatorname"===t?i.limits="nolimits":"\\operatorname*"===t&&(i.limits="limits"),i})),it="Punctuation",dt("\\colon","","mpunct",":",at),dt("\\cdotp","","mpunct","⋅",at),dt("\\ldots","","minner","…",at),dt("\\cdots","","minner","⋯",at),dt("\\ddots","","minner","⋱",at),dt("\\mathellipsis","","minner","…",91),dt("\\vdots","",xt,"⋮",at),dt("\\ldotp","","mpunct",".",18),dt(",","","mpunct",","),dt(";","","mpunct",";"),it="Logical Operators",dt("\\wedge","",_t,"∧",lt),dt("\\vee","",_t,"∨",lt),dt("\\lnot","",xt,"¬",at),dt("\\neg","",xt,"¬",lt),dt("\\land","",_t,"∧",659),dt("\\lor","",_t,"∨",364),dt("\\barwedge",vt,_t,"⊼",21),dt("\\veebar",vt,_t,"⊻",43),dt("\\nor",vt,_t,"⊻",7),dt("\\curlywedge",vt,_t,"⋏",58),dt("\\curlyvee",vt,_t,"⋎",57),it="Boxes",dt("\\square",vt,xt,"□",at),dt("\\Box",vt,xt,"□",at),dt("\\blacksquare",vt,xt,"■",1679),dt("\\boxminus",vt,_t,"⊟",79),dt("\\boxplus",vt,_t,"⊞",276),dt("\\boxtimes",vt,_t,"⊠",457),dt("\\boxdot",vt,_t,"⊡",120),it="Circles",dt("\\circ","",_t,"∘",lt),dt("\\bigcirc","",_t,"◯",903),dt("\\bullet","",_t,"∙",at),dt("\\circleddash",vt,_t,"⊝",at),dt("\\circledast",vt,_t,"⊛",339),dt("\\oplus","",_t,"⊕",at),dt("\\ominus","",_t,"⊖",1568),dt("\\otimes","",_t,"⊗",at),dt("\\odot","",_t,"⊙",at),dt("\\circledcirc",vt,_t,"⊚",93),dt("\\oslash","",_t,"⊘",497),dt("\\circledS",vt,xt,"Ⓢ",31),dt("\\circledR",vt,xt,"®",1329),it="Triangles",dt("\\triangle","",xt,"△",at),dt("\\triangleq",vt,Pt,"≜",at),dt("\\bigtriangleup","",_t,"△",1773),dt("\\vartriangle",vt,Pt,"△",762),dt("\\triangledown",vt,xt,"▽",520),dt("\\bigtriangledown","",_t,"▽",661),dt("\\triangleleft","",_t,"◃",534),dt("\\vartriangleleft",vt,Pt,"⊲",281),dt("\\trianglelefteq",vt,Pt,"⊴",176),dt("\\ntriangleleft",vt,Pt,"⋪",13),dt("\\ntrianglelefteq",vt,Pt,"⋬",22),dt("\\triangleright","",_t,"▹",516),dt("\\vartriangleright",vt,Pt,"⊳",209),dt("\\trianglerighteq",vt,Pt,"⊵",45),dt("\\ntriangleright",vt,Pt,"⋫",15),dt("\\ntrianglerighteq",vt,Pt,"⋭",6),dt("\\blacktriangle",vt,xt,"▲",360),dt("\\blacktriangledown",vt,xt,"▼",159),dt("\\blacktriangleleft",vt,Pt,"◀",101),dt("\\blacktriangleright",vt,Pt,"▶",271),it="Others",dt("\\/","",Ct,"/"),dt("|","","textord","∣"),it="Big Operators",dt("\\sqcup","",_t,"⊔",1717),dt("\\sqcap","",_t,"⊓",735),dt("\\uplus","",_t,"⊎",597),dt("\\wr","",_t,"≀",286),dt("\\Cap",vt,_t,"⋒",2),dt("\\Cup",vt,_t,"⋓",2),dt("\\doublecap",vt,_t,"⋒",1),dt("\\doublecup",vt,_t,"⋓",1),dt("\\amalg","",_t,"⨿",ot),dt("\\And","",_t,"&"),it="Accents",Ot(["\\acute","\\grave","\\dot","\\ddot","\\mathring","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec"],"{body:auto}",null,(function(t,e){return{type:"accent",accent:{"\\acute":"ˊ","\\grave":"ˋ","\\dot":"˙","\\ddot":"¨","\\mathring":"˚","\\tilde":"~","\\bar":"ˉ","\\breve":"˘","\\check":"ˇ","\\hat":"^","\\vec":"⃗"}[t],limits:"accent",skipBoundary:!0,body:e[0]}})),ct(at,"\\bar","\\ddot","\\acute","\\tilde","\\check"),ct(1548,"\\breve"),ct(735,"\\grave"),ct(lt,"\\vec"),it="Letters and Letter Like Forms",dt("\\imath","",xt,"ı"),dt("\\jmath","",xt,"ȷ"),it="Others",dt("\\degree","",xt,"°",46),it="Others",dt("'","",xt,"′"),dt('"',"",xt,"”"),it="Others",Ot("\\^","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"â",e:"ê",i:"î",o:"ô",u:"û",A:"Â",E:"Ê",I:"Î",O:"Ô",U:"Û"}[e[0]]||"^",baseFontFamily:"cmr"}})),Ot("\\`","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"à",e:"è",i:"ì",o:"ò",u:"ù",A:"À",E:"È",I:"Ì",O:"Ò",U:"Ù"}[e[0]]||"`",baseFontFamily:"cmr"}})),Ot("\\'","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"á",e:"é",i:"í",o:"ó",u:"ú",A:"Á",E:"É",I:"Í",O:"Ó",U:"Ú"}[e[0]]||"^",baseFontFamily:"cmr"}})),Ot("\\~","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{n:"ñ",N:"Ñ",a:"ã",o:"õ",A:"Ã",O:"Õ"}[e[0]]||"´",baseFontFamily:"cmr"}})),Ot("\\c","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{c:"ç",C:"Ç"}[e[0]]||"",baseFontFamily:"cmr"}}));const Dt={"\\#":"#","\\&":"&","\\$":"$","\\%":"%","\\_":"_","\\euro":"€","\\maltese":"✠","\\{":"{","\\}":"}","\\nobreakspace":" ","\\ldots":"…","\\textellipsis":"…","\\backslash":"\\","`":"‘","'":"’","``":"“","''":"”","\\degree":"°","\\textasciicircum":"^","\\textasciitilde":"~","\\textasteriskcentered":"*","\\textbackslash":"\\","\\textbraceleft":"{","\\textbraceright":"}","\\textbullet":"•","\\textdollar":"$","\\textsterling":"£","–":"–","—":"—","‘":"‘","’":"’","“":"“","”":"”",'"':"”","\\ss":"ß","\\ae":"æ","\\oe":"œ","\\AE":"Æ","\\OE":"Œ","\\O":"Ø","\\i":"ı","\\j":"ȷ","\\aa":"å","\\AA":"Å"},jt="undefined"!=typeof navigator&&/firefox|edge/i.test(navigator.userAgent)?/[a-zA-ZаАбБвВгГдДеЕёЁжЖзЗиИйЙкКлЛмМнНоОпПрРсСтТуУфФхХцЦчЧшШщЩъЪыЫьЬэЭюЮяĄąĆćĘęŁłŃńÓóŚśŹźŻżàâäôéèëêïîçùûüÿæœÀÂÄÔÉÈËÊÏÎŸÇÙÛÜÆŒäöüßÄÖÜẞàèéìíîòóùúÀÈÉÌÍÎÒÓÙÚáéíñóúüÁÉÍÑÓÚÜ]/:new RegExp("\\p{Letter}","u"),It="undefined"!=typeof navigator&&/firefox|edge/i.test(navigator.userAgent)?/[0-9a-zA-ZаАбБвВгГдДеЕёЁжЖзЗиИйЙкКлЛмМнНоОпПрРсСтТуУфФхХцЦчЧшШщЩъЪыЫьЬэЭюЮяĄąĆćĘęŁłŃńÓóŚśŹźŻżàâäôéèëêïîçùûüÿæœÀÂÄÔÉÈËÊÏÎŸÇÙÛÜÆŒäöüßÄÖÜẞàèéìíîòóùúÀÈÉÌÍÎÒÓÙÚáéíñóúüÁÉÍÑÓÚÜ]/:new RegExp("[0-9\\p{Letter}]","u");var Rt={matchCodepoint:ft,commandAllowed:function(t,e){return!(!nt[e]||"text"===t&&!nt[e].allowedInText)||!!{text:Dt,math:st}[t][e]},unicodeToMathVariant:bt,mathVariantToUnicode:function(t,e,i){if(!/[A-Za-z0-9]/.test(t))return t;if(!e&&!i)return t;const s=t.codePointAt(0);for(let n=0;n<gt.length;n++)if((!e||gt[n].variant===e)&&(!i||gt[n].style===i)&&s>=gt[n].offset&&s<gt[n].offset+gt[n].len){const t=gt[n].start+s-gt[n].offset;return String.fromCodePoint(mt[t]||t)}return t},unicodeStringToLatex:function(t,e){let i="";for(const s of e)i+=yt(t,s.codePointAt(0));return i},getInfo:function(t,e,i){if(0===t.length)return null;let s=null;if("\\"===t.charAt(0)){if(s=nt[t])return"math"===e||s.allowedInText?s:null;if(s||("math"===e?s=st[t]:Dt[t]&&(s={value:Dt[t]})),!s){const e=t.slice(1);if(i&&i[e]){let t=i[e];"object"==typeof t&&(t=t.def);let n=0;for(/(^|[^\\])#1/.test(t)&&(n=1),/(^|[^\\])#2/.test(t)&&(n=2),/(^|[^\\])#3/.test(t)&&(n=3),/(^|[^\\])#4/.test(t)&&(n=4),/(^|[^\\])#5/.test(t)&&(n=5),/(^|[^\\])#6/.test(t)&&(n=6),/(^|[^\\])#7/.test(t)&&(n=7),/(^|[^\\])#8/.test(t)&&(n=8),/(^|[^\\])#9/.test(t)&&(n=9),s={type:"group",allowedInText:!1,params:[],infix:!1};n>=1;)s.params.push({optional:!1,type:"math",defaultValue:null,placeholder:null}),n-=1}}}else"math"===e?s=st[t]:Dt[t]&&(s={value:Dt[t]});return!s||"mord"!==s.type||"f"!==s.value&&"g"!==s.value&&"h"!==s.value||(s.isFunction=!0),s},getValue:function(t,e){return"math"===t?st[e]&&st[e].value?st[e].value:e:Dt[e]?Dt[e]:e},getEnvironmentInfo:function(t){let e=rt[t];return e||(e={params:"",parser:null,mathstyle:"displaystyle",tabular:!0,colFormat:[],lFence:".",rFence:"."}),e},suggest:function(t){if(t.length<=1)return[];const e=[];for(const i in nt)Object.prototype.hasOwnProperty.call(nt,i)&&i.startsWith(t)&&!nt[i].infix&&e.push({match:i,frequency:nt[i].frequency});for(const i in st)Object.prototype.hasOwnProperty.call(st,i)&&i.startsWith(t)&&e.push({match:i,frequency:st[i].frequency});return e.sort((t,e)=>t.frequency===e.frequency?t.match.length-e.match.length:(e.frequency||0)-(t.frequency||0)),e},FREQUENCY_VALUE:ht,TEXT_SYMBOLS:Dt,MATH_SYMBOLS:st,ENVIRONMENTS:rt,RIGHT_DELIM:{"(":")","{":"}","[":"]","|":"|","\\lbrace":"\\rbrace","\\{":"\\}","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},FUNCTIONS:nt,MACROS:{iff:"\\;⟺\\;",nicefrac:"^{#1}\\!\\!/\\!_{#2}",bra:"\\mathinner{\\langle{#1}|}",ket:"\\mathinner{|{#1}\\rangle}",braket:"\\mathinner{\\langle{#1}\\rangle}",set:"\\mathinner{\\lbrace #1 \\rbrace}",Bra:"\\left\\langle #1\\right|",Ket:"\\left|#1\\right\\rangle",Braket:"\\left\\langle{#1}\\right\\rangle",Set:"\\left\\lbrace #1 \\right\\rbrace"},COMMAND_MODE_CHARACTERS:/[a-zA-Z0-9!@*()-=+{}[\]\\';:?\/.,~<>`|'$%#&^_" ]/,LETTER:jt,LETTER_AND_DIGITS:It};const Bt=et.makeSymbol,Ft=et.makeSpan,Yt=et.makeVlist;function zt(t,e,i,s,n,r){const o=Bt("Size"+i+"-Regular",Rt.getValue("math",e)),a=et.makeStyleWrap(t,Ft(o,"delimsizing size"+i),n.mathstyle,B.TEXT,r);return s&&a.setTop((1-n.mathstyle.sizeMultiplier)*n.mathstyle.metrics.axisHeight),a.setStyle("color",n.color),"number"==typeof n.opacity&&a.setStyle("opacity",n.opacity),a}function Xt(t,e){let i="";return"Size1-Regular"===e?i=" delim-size1":"Size4-Regular"===e&&(i=" delim-size4"),Ft(Bt(e,Rt.getValue("math",t)),"delimsizinginner"+i)}function Ut(t,e,i,s,n,r){let o,a,l,h;o=l=h=Rt.getValue("math",e),a=null;let c="Size1-Regular";"\\vert"===e||"\\lvert"===e||"\\rvert"===e||"\\mvert"===e||"\\mid"===e?l=o=h="∣":"\\Vert"===e||"\\lVert"===e||"\\rVert"===e||"\\mVert"===e||"\\|"===e?l=o=h="∥":"\\uparrow"===e?l=h="⏐":"\\Uparrow"===e?l=h="‖":"\\downarrow"===e?o=l="⏐":"\\Downarrow"===e?o=l="‖":"\\updownarrow"===e?(o="↑",l="⏐",h="↓"):"\\Updownarrow"===e?(o="⇑",l="‖",h="⇓"):"["===e||"\\lbrack"===e?(o="⎡",l="⎢",h="⎣",c="Size4-Regular"):"]"===e||"\\rbrack"===e?(o="⎤",l="⎥",h="⎦",c="Size4-Regular"):"\\lfloor"===e?(l=o="⎢",h="⎣",c="Size4-Regular"):"\\lceil"===e?(o="⎡",l=h="⎢",c="Size4-Regular"):"\\rfloor"===e?(l=o="⎥",h="⎦",c="Size4-Regular"):"\\rceil"===e?(o="⎤",l=h="⎥",c="Size4-Regular"):"("===e?(o="⎛",l="⎜",h="⎝",c="Size4-Regular"):")"===e?(o="⎞",l="⎟",h="⎠",c="Size4-Regular"):"\\{"===e||"\\lbrace"===e?(o="⎧",a="⎨",h="⎩",l="⎪",c="Size4-Regular"):"\\}"===e||"\\rbrace"===e?(o="⎫",a="⎬",h="⎭",l="⎪",c="Size4-Regular"):"\\lgroup"===e?(o="⎧",h="⎩",l="⎪",c="Size4-Regular"):"\\rgroup"===e?(o="⎫",h="⎭",l="⎪",c="Size4-Regular"):"\\lmoustache"===e?(o="⎧",h="⎭",l="⎪",c="Size4-Regular"):"\\rmoustache"===e?(o="⎫",h="⎩",l="⎪",c="Size4-Regular"):"\\surd"===e?(o="",h="⎷",l="",c="Size4-Regular"):"\\ulcorner"===e?(o="┌",l=h=" "):"\\urcorner"===e?(o="┐",l=h=" "):"\\llcorner"===e?(h="└",l=o=" "):"\\lrcorner"===e&&(o="┘",l=o=" ");const d=E.getCharacterMetrics(Rt.getValue("math",o),c),u=d.height+d.depth,p=E.getCharacterMetrics(Rt.getValue("math",l),c),f=p.height+p.depth,m=E.getCharacterMetrics(Rt.getValue("math",h),c),g=m.height+m.depth;let b=0,y=1;if(null!==a){const t=E.getCharacterMetrics(Rt.getValue("math",a),c);b=t.height+t.depth,y=2}const v=u+g+b,C=Math.ceil((i-v)/(y*f));let x=n.mathstyle.metrics.axisHeight;s&&(x*=n.mathstyle.sizeMultiplier);const _=(v+C*y*f)/2-x,P=[];if(P.push(Xt(h,c)),null===a)for(let w=0;w<C;w++)P.push(Xt(l,c));else{for(let t=0;t<C;t++)P.push(Xt(l,c));P.push(Xt(a,c));for(let t=0;t<C;t++)P.push(Xt(l,c))}P.push(Xt(o,c));const S=Yt(n,P,"bottom",_);return S.setStyle("color",n.color),"number"==typeof n.opacity&&S.setStyle("opacity",n.opacity),et.makeStyleWrap(t,Ft(S,"delimsizing mult"),n.mathstyle,B.TEXT,r)}const Gt=["(",")","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","\\lceil","\\rceil","\\surd"],Ht=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\mvert","\\mid","\\lgroup","\\rgroup","\\lmoustache","\\rmoustache"],qt=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Jt=[0,1.2,1.8,2.4,3],Vt=[{type:"small",mathstyle:B.SCRIPTSCRIPT},{type:"small",mathstyle:B.SCRIPT},{type:"small",mathstyle:B.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],$t=[{type:"small",mathstyle:B.SCRIPTSCRIPT},{type:"small",mathstyle:B.SCRIPT},{type:"small",mathstyle:B.TEXT},{type:"stack"}],Wt=[{type:"small",mathstyle:B.SCRIPTSCRIPT},{type:"small",mathstyle:B.SCRIPT},{type:"small",mathstyle:B.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}];function Kt(t,e,i,s,n,r){if(!e||0===e.length||"."===e)return Zt(t,n,t);let o;"<"===e||"\\lt"===e?e="\\langle":">"!==e&&"\\gt"!==e||(e="\\rangle"),o=qt.includes(e)?Vt:Gt.includes(e)?Wt:$t;const a=function(t,e,i,s){for(let r=Math.min(2,3-s.mathstyle.size);r<i.length&&"stack"!==i[r].type;r++){const s=E.getCharacterMetrics(t,"small"===(n=i[r]).type?"Main-Regular":"large"===n.type?"Size"+n.size+"-Regular":"Size4-Regular");if(s.defaultMetrics)return{type:"small",mathstyle:B.SCRIPT};let o=s.height+s.depth;if("small"===i[r].type&&(o*=i[r].mathstyle.sizeMultiplier),o>e)return i[r]}var n;return i[i.length-1]}(Rt.getValue("math",e),i,o,n);return"small"===a.type?function(t,e,i,s,n,r){const o=Bt("AMS-Regular",Rt.getValue("math",e)),a=et.makeStyleWrap(t,o,n.mathstyle,i,r);return s&&a.setTop((1-n.mathstyle.sizeMultiplier/i.sizeMultiplier)*n.mathstyle.metrics.axisHeight),a.setStyle("color",n.color),"number"==typeof n.opacity&&a.setStyle("opacity",n.opacity),a}(t,e,a.mathstyle,s,n,r):"large"===a.type?zt(t,e,a.size,s,n,r):Ut(t,e,i,s,n,r)}function Zt(t,e,i){return et.makeSpanOfType(t,"","sizing"+e.mathstyle.adjustTo(B.TEXT)+" nulldelimiter "+(i||""))}var Qt={makeSizedDelim:function(t,e,i,s,n){return"."===e?Zt(t,s,n):("<"===e||"\\lt"===e?e="\\langle":">"!==e&&"\\gt"!==e||(e="\\rangle"),Gt.includes(e)||qt.includes(e)?zt(t,e,i,!1,s,n):Ht.includes(e)?Ut(t,e,Jt[i],!1,s,n):null)},makeCustomSizedDelim:Kt,makeLeftRightDelim:function(t,e,i,s,n,r){if("."===e)return Zt(t,n,r);const o=n.mathstyle.metrics.axisHeight*n.mathstyle.sizeMultiplier,a=5/E.METRICS.ptPerEm;let l=s+o,h=i-o,c=901*(h=Math.max(l,h))/500;return l=2*h-a,Kt(t,e,c=Math.max(c,l),!0,n,r)}};const te=et.makeSpan,ee=et.makeOrd,ie=et.makeInner,se=et.makeHlist,ne=et.makeVlist,re=/\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5/,oe=/^([A-Za-z]|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5)$/,ae={size1:.5,size2:.7,size3:.8,size4:.9,size5:1,size6:1.2,size7:1.44,size8:1.73,size9:2.07,size10:2.49};class le{constructor(t,e,i,s){this.mode=t,this.type=e,this.body=i,this.applyStyle(s)}getStyle(){return{color:this.phantom?"transparent":this.color,backgroundColor:this.phantom?"transparent":this.backgroundColor,fontFamily:this.baseFontFamily||this.fontFamily||this.autoFontFamily,fontShape:this.fontShape,fontSeries:this.fontSeries,fontSize:this.fontSize,cssId:this.cssId,cssClass:this.cssClass}}applyStyle(t){if(Object.assign(this,t),"none"===this.fontFamily&&(this.fontFamily=""),"auto"===this.fontShape&&(this.fontShape=""),"auto"===this.fontSeries&&(this.fontSeries=""),"none"===this.color&&(this.color=""),"none"===this.backgroundColor&&(this.backgroundColor=""),"auto"===this.fontSize&&(this.fontSize=""),this.fontSize&&(this.maxFontSize=ae[this.fontSize]),"math"===this.mode){const t="string"==typeof this.body?this.body:"";this.autoFontFamily="cmr",oe.test(t)?this.autoFontFamily="math":/\\imath|\\jmath|\\pounds/.test(t)?this.autoFontFamily="mainit":re.test(t)||"math"!==this.baseFontFamily||(this.autoFontFamily="cmr")}else"text"===this.mode&&("root"!==this.type&&(this.type=""),delete this.baseFontFamily,delete this.autoFontFamily)}getInitialBaseElement(){let t=this;return Array.isArray(this.body)&&this.body.length>0&&("first"!==this.body[0].type?t=this.body[0].getInitialBaseElement():this.body[1]&&(t=this.body[1].getInitialBaseElement())),t}getFinalBaseElement(){return Array.isArray(this.body)&&this.body.length>0?this.body[this.body.length-1].getFinalBaseElement():this}isCharacterBox(){const t=this.getInitialBaseElement();return/minner|mbin|mrel|mpunct|mopen|mclose|textord/.test(t.type)}forEach(t){if(t(this),Array.isArray(this.body))for(const e of this.body)e&&e.forEach(t);else this.body&&"object"==typeof this.body&&t(this.body);if(this.superscript)for(const e of this.superscript)e&&e.forEach(t);if(this.subscript)for(const e of this.subscript)e&&e.forEach(t);if(this.overscript)for(const e of this.overscript)e&&e.forEach(t);if(this.underscript)for(const e of this.underscript)e&&e.forEach(t);if(this.numer)for(const e of this.numer)e&&e.forEach(t);if(this.denom)for(const e of this.denom)e&&e.forEach(t);if(this.index)for(const e of this.index)e&&e.forEach(t);if(this.array)for(const e of this.array)for(const i of e)for(const e of i)e.forEach(t)}filter(t){let e=[];t(this)&&e.push(this);for(const i of["body","superscript","subscript","overscript","underscript","numer","denom","index"])if(Array.isArray(this[i]))for(const s of this[i])s&&(e=e.concat(s.filter(t)));if(Array.isArray(this.array))for(const i of this.array)for(const s of i)s&&(e=e.concat(s.filter(t)));return e}decomposeGroup(t){const e=t.clone({mathstyle:this.mathstyle}),i=ee(ue(e,this.body));return this.cssId&&(i.cssId=this.cssId),i.applyStyle({backgroundColor:this.backgroundColor,cssClass:this.cssClass}),i}decomposeArray(t){let e=this.colFormat;e&&0===e.length&&(e=[{align:"l"}]),e||(e=[{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"}]);const i=[];let s=0;for(const _ of e)_.align&&s++;for(const _ of this.array){let t=0;for(;t<_.length;){const e=[],n=Math.min(_.length,t+s);for(;t<n;)e.push(_[t++]);i.push(e)}}1===i[i.length-1].length&&0===i[i.length-1][0].length&&i.pop();const n=B.toMathstyle(this.mathstyle)||t.mathstyle,r=(this.arraystretch||1)*P.baselineskip,o=.7*r,a=.3*r;let l=0,h=0;const c=[],d=i.length;for(let _=0;_<d;++_){const e=i[_];h=Math.max(h,e.length);let s=o,n=a;const r=[];for(let i=0;i<e.length;++i){const o=ue(t.clone({mathstyle:this.mathstyle}),e[i])||[],a=[ee(null)].concat(o);n=Math.max(n,et.depth(a)),s=Math.max(s,et.height(a)),r.push(a)}let u=_===d-1?0:this.jot||0;this.rowGaps&&this.rowGaps[_]&&(u=this.rowGaps[_])>0&&(n<(u+=a)&&(n=u),u=0),r.height=s,r.depth=n,r.pos=l+=s,l+=n+u,c.push(r)}const u=l/2+n.metrics.axisHeight,p=[];for(let _=0;_<h;_++){const e=[];for(const t of c){const i=t[_];i&&(i.depth=t.depth,i.height=t.height,e.push(i),e.push(t.pos-u))}e.length>0&&p.push(ne(t,e,"individualShift"))}const f=[];let m=!1,g=!1,b=0,y=!this.lFence;for(const _ of e){if(_.align&&b>=p.length)break;if(_.align&&b<p.length)m?f.push(he(2*P.arraycolsep)):(g||y)&&f.push(he(P.arraycolsep)),f.push(te(p[b],"col-align-"+_.align)),b++,m=!0,g=!1,y=!1;else if(void 0!==_.gap)f.push("number"==typeof _.gap?he(_.gap):ce(t,c,u,_.gap)),m=!1,g=!1,y=!1;else if(_.rule){const e=te(null,"vertical-separator");e.setStyle("height",l,"em"),e.setStyle("margin-top",3*t.mathstyle.metrics.axisHeight-u,"em"),e.setStyle("vertical-align","top");let i=0;g?i=P.doubleRuleSep-P.arrayrulewidth:m&&(i=P.arraycolsep-P.arrayrulewidth),e.setLeft(i,"em"),f.push(e),m=!1,g=!0,y=!1}}if(m&&!this.rFence&&f.push(he(P.arraycolsep)),!(this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence))return ee(f,"mtable");const v=te(f,"mtable"),C=et.height(v),x=et.depth(v);return ee([this.bind(t,Qt.makeLeftRightDelim("mopen",this.lFence,C,x,t)),v,this.bind(t,Qt.makeLeftRightDelim("mclose",this.rFence,C,x,t))])}decomposeGenfrac(t){const e="auto"===this.mathstyle?t.mathstyle:B.toMathstyle(this.mathstyle),i=t.clone({mathstyle:e});let s=[];this.numerPrefix&&s.push(ee(this.numerPrefix));const n=this.continuousFraction?e:e.fracNum();s=s.concat(ue(i.clone({mathstyle:n}),this.numer));const r=se(s,t.mathstyle.adjustTo(n));let o=[];this.denomPrefix&&o.push(ee(this.denomPrefix));const a=this.continuousFraction?e:e.fracDen();o=o.concat(ue(i.clone({mathstyle:a}),this.denom));const l=se(o,t.mathstyle.adjustTo(a)),h=this.hasBarLine?P.defaultRuleThickness/e.sizeMultiplier:0;let c,d,u;e.size===B.DISPLAY.size?(c=e.metrics.num1,d=h>0?3*h:7*P.defaultRuleThickness,u=e.metrics.denom1):(h>0?(c=e.metrics.num2,d=h):(c=e.metrics.num3,d=3*P.defaultRuleThickness),u=e.metrics.denom2);const p=r?r.depth:0,f=l?l.height:0;let m;if(0===h){const t=c-p-(f-u);t<d&&(c+=.5*(d-t),u+=.5*(d-t)),m=ne(i,[r,-c,l,u],"individualShift")}else{const t=e.metrics.axisHeight;c-p-(t+.5*h)<d&&(c+=d-(c-p-(t+.5*h))),t-.5*h-(f-u)<d&&(u+=d-(t-.5*h-(f-u)));const s=te(null," frac-line");s.applyStyle(this.getStyle()),s.height=h;const n=[];r&&(n.push(r),n.push(-c)),n.push(s),n.push(h/2-t),l&&(n.push(l),n.push(u)),m=ne(i,n,"individualShift")}m.classes+=" mfrac",m.height*=e.sizeMultiplier/t.mathstyle.sizeMultiplier,m.depth*=e.sizeMultiplier/t.mathstyle.sizeMultiplier;const g=e.size===B.DISPLAY.size?e.metrics.delim1:e.metrics.delim2,b=Qt.makeCustomSizedDelim("mopen",this.leftDelim,g,!0,t.clone({mathstyle:e})),y=Qt.makeCustomSizedDelim("mclose",this.rightDelim,g,!0,t.clone({mathstyle:e}));b.applyStyle(this.getStyle()),y.applyStyle(this.getStyle());const v=ee([b,m,y],t.parentSize!==t.size?"sizing reset-"+t.parentSize+" "+t.size:"");return this.bind(t,v)}decomposeLeftright(t){if(!this.body)return this.leftDelim?new le("math","mopen",this.leftDelim).decompose(t):this.rightDelim?new le("math","mclose",this.rightDelim).decompose(t):null;const e=t.clone(),i=ue(e,this.body),s=e.mathstyle;let n=0,r=0,o=[];if(n=et.height(i)*s.sizeMultiplier,r=et.depth(i)*s.sizeMultiplier,this.leftDelim&&(o.push(Qt.makeLeftRightDelim("mopen",this.leftDelim,n,r,e)),o[o.length-1].applyStyle(this.getStyle())),i){for(let t=0;t<i.length;t++)if(i[t].delim){const s=i[t].caret,o=/ML__selected/.test(i[t].classes);i[t]=Qt.makeLeftRightDelim("minner",i[t].delim,n,r,e),i[t].caret=s,i[t].selected(o)}o=o.concat(i)}if(this.rightDelim){let t,i=this.rightDelim;"?"===i&&(i=(i={"(":")","\\{":"\\}","\\[":"\\]","\\lbrace":"\\rbrace","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"}[this.leftDelim])||this.leftDelim,t="ML__smart-fence__close"),o.push(Qt.makeLeftRightDelim("mclose",i,n,r,e,t)),o[o.length-1].applyStyle(this.getStyle())}return this.inner?ie(o,s.cls()):o}decomposeSurd(t){const e=t.mathstyle,i=ue(t.cramp(),this.body),s=P.defaultRuleThickness/e.sizeMultiplier;let n=s;e.id<B.TEXT.id&&(n=e.metrics.xHeight);let r=s+n/4;const o=Math.max(2*n,(et.height(i)+et.depth(i))*e.sizeMultiplier)+(r+s),a=te(Qt.makeCustomSizedDelim("","\\surd",o,!1,t),"sqrt-sign");a.applyStyle(this.getStyle());const l=a.height+a.depth-s;l>et.height(i)+et.depth(i)+r&&(r=(r+l-(et.height(i)+et.depth(i)))/2),a.setTop(a.height-et.height(i)-(r+s));const h=te(null,t.mathstyle.adjustTo(B.TEXT)+" sqrt-line");h.applyStyle(this.getStyle()),h.height=s;const c=ne(t,[i,r,h,s]);if(!this.index)return this.bind(t,ee([a,c],"sqrt"));const d=t.clone({mathstyle:B.SCRIPTSCRIPT}),u=te(ue(d,this.index),e.adjustTo(B.SCRIPTSCRIPT)),p=Math.max(a.height,c.height),f=Math.max(a.depth,c.depth),m=ne(t,[u],"shift",-.6*(p-f));return this.bind(t,ee([te(m,"root"),a,c],"sqrt"))}decomposeAccent(t){const e=t.mathstyle;let i=ue(t.cramp(),this.body);(this.superscript||this.subscript)&&(i=this.attachSupsub(t,ee(i),"mord"));let s=0;Array.isArray(this.body)&&1===this.body.length&&this.body[0].isCharacterBox()&&(s=et.skew(i));const n=Math.min(et.height(i),e.metrics.xHeight),r=et.makeSymbol("Main-Regular",this.accent,"math");r.italic=0;const o="⃗"===this.accent?" accent-vec":"";let a=te(te(r),"accent-body"+o);return(a=ne(t,[i,-n,a])).children[1].setLeft(2*s),ee(a,"accent")}decomposeLine(t){const e=t.mathstyle,i=ue(t.cramp(),this.body),s=P.defaultRuleThickness/e.sizeMultiplier,n=te(null,t.mathstyle.adjustTo(B.TEXT)+" "+this.position+"-line");let r;if(n.height=s,n.maxFontSize=1,"overline"===this.position)r=ne(t,[i,3*s,n,s]);else{const e=te(i);r=ne(t,[s,n,3*s,e],"top",et.height(e))}return ee(r,this.position)}decomposeOverunder(t){const e=ue(t,this.body),i=t.clone({mathstyle:"scriptstyle"}),s=this.overscript?te(ue(i,this.overscript),t.mathstyle.adjustTo(i.mathstyle)):null,n=this.underscript?te(ue(i,this.underscript),t.mathstyle.adjustTo(i.mathstyle)):null;return de(t,e,0,0,s,n,this.mathtype||"mrel")}decomposeOverlap(t){const e=te(ue(t,this.body),"inner");return ee([e,te(null,"fix")],"left"===this.align?"llap":"rlap")}decomposeRule(t){const e=t.mathstyle,i=ee("","rule");let s=this.shift&&!isNaN(this.shift)?this.shift:0;s/=e.sizeMultiplier;const n=this.width/e.sizeMultiplier,r=this.height/e.sizeMultiplier;return i.setStyle("border-right-width",n,"em"),i.setStyle("border-top-width",r,"em"),i.setStyle("margin-top",-(r-s),"em"),i.setStyle("border-color",t.color),i.width=n,i.height=r+s,i.depth=-s,i}decomposeOp(t){const e=t.mathstyle;let i,s=!1;e.size===B.DISPLAY.size&&"string"==typeof this.body&&"\\smallint"!==this.body&&(s=!0);let n=0,r=0;if(this.symbol?((i=et.makeSymbol(s?"Size2-Regular":"Size1-Regular",this.body,"op-symbol "+(s?"large-op":"small-op"))).type="mop",n=(i.height-i.depth)/2-e.metrics.axisHeight*e.sizeMultiplier,r=i.italic,this.bind(t,i)):Array.isArray(this.body)?(i=et.makeOp(ue(t,this.body)),this.bind(t,i)):i=this.makeSpan(t,this.body),this.superscript||this.subscript){const s=this.limits||"auto";return this.alwaysHandleSupSub||"limits"===s||"auto"===s&&e.size===B.DISPLAY.size?this.attachLimits(t,i,n,r):this.attachSupsub(t,i,"mop")}return this.symbol&&i.setTop(n),i}decomposeBox(t){const e=ee(ue(t,this.body)),i=te();i.setStyle("position","absolute");const s="number"==typeof this.padding?this.padding:P.fboxsep;i.setStyle("height",e.height+e.depth+2*s,"em"),i.setStyle("width",0!==s?"calc(100% + "+2*s+"em)":"100%"),i.setStyle("top",-s,"em"),i.setStyle("left",-s,"em"),i.setStyle("z-index","-1"),this.backgroundcolor&&i.setStyle("background-color",this.backgroundcolor),this.framecolor&&i.setStyle("border",P.fboxrule+"em solid "+this.framecolor),this.border&&i.setStyle("border",this.border),e.setStyle("display","inline-block"),e.setStyle("height",e.height+e.depth,"em"),e.setStyle("vertical-align",-e.depth+s,"em");const n=te([i,e]);return n.setStyle("position","relative"),n.setStyle("vertical-align",-s+e.depth,"em"),n.height=e.height+s,n.depth=e.depth+s,n.setLeft(s),n.setRight(s),n}decomposeEnclose(t){const e=ee(ue(t,this.body)),i="auto"===this.padding?.2:this.padding;e.setStyle("padding",i,"em"),e.setStyle("display","inline-block"),e.setStyle("height",e.height+e.depth,"em"),e.setStyle("left",-i,"em"),this.backgroundcolor&&"transparent"!==this.backgroundcolor&&e.setStyle("background-color",this.backgroundcolor);let s="";if(this.notation.box&&e.setStyle("border",this.borderStyle),this.notation.actuarial&&(e.setStyle("border-top",this.borderStyle),e.setStyle("border-right",this.borderStyle)),this.notation.madruwb&&(e.setStyle("border-bottom",this.borderStyle),e.setStyle("border-right",this.borderStyle)),this.notation.roundedbox&&(e.setStyle("border-radius",(et.height(e)+et.depth(e))/2,"em"),e.setStyle("border",this.borderStyle)),this.notation.circle&&(e.setStyle("border-radius","50%"),e.setStyle("border",this.borderStyle)),this.notation.top&&e.setStyle("border-top",this.borderStyle),this.notation.left&&e.setStyle("border-left",this.borderStyle),this.notation.right&&e.setStyle("border-right",this.borderStyle),this.notation.bottom&&e.setStyle("border-bottom",this.borderStyle),this.notation.horizontalstrike&&(s+='<line x1="3%"  y1="50%" x2="97%" y2="50%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.verticalstrike&&(s+='<line x1="50%"  y1="3%" x2="50%" y2="97%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.updiagonalstrike&&(s+='<line x1="3%"  y1="97%" x2="97%" y2="3%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.downdiagonalstrike&&(s+='<line x1="3%"  y1="3%" x2="97%" y2="97%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),s){let t;return"none"!==this.shadow&&(t="auto"===this.shadow?"filter: drop-shadow(0 0 .5px rgba(255, 255, 255, .7)) drop-shadow(1px 1px 2px #333)":"filter: drop-shadow("+this.shadow+")"),et.makeSVG(e,s,t)}return e}decompose(t,e){let i=null;if(!this.type||/mord|minner|mbin|mrel|mpunct|mopen|mclose|textord/.test(this.type)?(i=this.makeSpan(t,"string"==typeof this.body?this.body:ue(t,this.body))).type=this.type:"group"===this.type||"root"===this.type?i=this.decomposeGroup(t):"array"===this.type?i=this.decomposeArray(t):"genfrac"===this.type?i=this.decomposeGenfrac(t):"surd"===this.type?i=this.decomposeSurd(t):"accent"===this.type?i=this.decomposeAccent(t):"leftright"===this.type?i=this.decomposeLeftright(t):"delim"===this.type?(i=te(null,"")).delim=this.delim:"sizeddelim"===this.type?i=this.bind(t,Qt.makeSizedDelim(this.cls,this.delim,this.size,t)):"line"===this.type?i=this.decomposeLine(t):"overunder"===this.type?i=this.decomposeOverunder(t):"overlap"===this.type?i=this.decomposeOverlap(t):"rule"===this.type?i=this.decomposeRule(t):"styling"===this.type||("msubsup"===this.type?(i=ee("​"),e&&(i.height=e[0].height,i.depth=e[0].depth)):"mop"===this.type?i=this.decomposeOp(t):"space"===this.type?i=this.makeSpan(t," "):"spacing"===this.type?"​"===this.body?i=this.makeSpan(t,"​"):" "===this.body?i=this.makeSpan(t,"math"===this.mode?" ":" "):this.width?(i=te("​","mspace "),this.width>0?i.setWidth(this.width):i.setStyle("margin-left",this.width,"em")):i=te("​","mspace "+({qquad:"qquad",quad:"quad",enspace:"enspace",";":"thickspace",":":"mediumspace",",":"thinspace","!":"negativethinspace"}[this.body]||"quad")):"mathstyle"===this.type?t.setMathstyle(this.mathstyle):"box"===this.type?i=this.decomposeBox(t):"enclose"===this.type?i=this.decomposeEnclose(t):"command"===this.type||"error"===this.type?((i=this.makeSpan(t,this.body)).classes="",this.error&&(i.classes+=" ML__error"),this.suggestion&&(i.classes+=" ML__suggestion")):"placeholder"===this.type?i=this.makeSpan(t,"⬚"):"first"===this.type&&(i=this.makeSpan(t,"​"))),!i)return i;if(this.caret&&"styling"!==this.type&&"msubsup"!==this.type&&"command"!==this.type&&"placeholder"!==this.type&&"first"!==this.type&&(Array.isArray(i)?i[i.length-1].caret=this.caret:i.caret=this.caret),!this.limits&&(this.superscript||this.subscript))if(Array.isArray(i)){const e=i[i.length-1];i[i.length-1]=this.attachSupsub(t,e,e.type)}else i=[this.attachSupsub(t,i,i.type)];return Array.isArray(i)?i:[i]}attachSupsub(t,e,i){if(!this.superscript&&!this.subscript)return e;const s=t.mathstyle;let n=null,r=null;if(this.superscript){const e=ue(t.sup(),this.superscript);n=te(e,s.adjustTo(s.sup()))}if(this.subscript){const e=ue(t.sub(),this.subscript);r=te(e,s.adjustTo(s.sub()))}let o,a=0,l=0;this.isCharacterBox()||(a=et.height(e)-s.metrics.supDrop,l=et.depth(e)+s.metrics.subDrop),o=s===B.DISPLAY?s.metrics.sup1:s.cramped?s.metrics.sup3:s.metrics.sup2;const h=.5/P.ptPerEm/(B.TEXT.sizeMultiplier*s.sizeMultiplier);let c=null;if(r&&n){a=Math.max(a,o,n.depth+.25*s.metrics.xHeight),l=Math.max(l,s.metrics.sub2);const i=P.defaultRuleThickness;if(a-et.depth(n)-(et.height(r)-l)<4*i){l=4*i-(a-n.depth)+et.height(r);const t=.8*s.metrics.xHeight-(a-et.depth(n));t>0&&(a+=t,l-=t)}c=ne(t,[r,l,n,-a],"individualShift"),this.symbol&&c.children[0].setLeft(-et.italic(e))}else r&&!n?(l=Math.max(l,s.metrics.sub1,et.height(r)-.8*s.metrics.xHeight),(c=ne(t,[r],"shift",l)).children[0].setRight(h),this.isCharacterBox()&&c.children[0].setLeft(-et.italic(e))):!r&&n&&(a=Math.max(a,o,n.depth+.25*s.metrics.xHeight),(c=ne(t,[n],"shift",-a)).children[0].setRight(h));const d=te(c,"msubsup");return this.caret&&(d.caret=this.caret),et.makeSpanOfType(i,[e,d])}attachLimits(t,e,i,s){const n=this.superscript?te(ue(t.sup(),this.superscript),t.mathstyle.adjustTo(t.mathstyle.sup())):null,r=this.subscript?te(ue(t.sub(),this.subscript),t.mathstyle.adjustTo(t.mathstyle.sub())):null;return de(t,e,i,s,n,r,"mop")}bind(t,e){return"first"!==this.type&&"​"!==this.body&&(this.id=function(t){let e;return"boolean"==typeof t.generateID&&t.generateID?e=Date.now().toString(36).slice(-2)+Math.floor(1e5*Math.random()).toString(36):"boolean"!=typeof t.generateID&&(t.generateID.overrideID?e=t.generateID.overrideID:(e=t.generateID.seed.toString(36),t.generateID.seed+=1)),e}(t),this.id&&(e.attributes||(e.attributes={}),e.attributes["data-atom-id"]=this.id)),e}makeSpan(t,e){const i=et.makeSpanOfType("textord"===this.type?"mord":this.type,e),s=this.getStyle();i.applyStyle(s);const n=s&&s.fontSize?s.fontSize:"size5";return n!==t.parentSize?(i.classes+=" sizing reset-"+t.parentSize,i.classes+=" "+n):t.parentSize!==t.size&&(i.classes+=" sizing reset-"+t.parentSize,i.classes+=" "+t.size),i.maxFontSize=Math.max(i.maxFontSize,t.sizeMultiplier||1),"text"===this.mode&&(i.classes+=" ML__text"),t.mathstyle.isTight()&&(i.isTight=!0),"math"!==this.mode&&(i.italic=0),i.setRight(i.italic),"number"==typeof t.opacity&&i.setStyle("opacity",t.opacity),this.bind(t,i),this.caret&&(this.superscript||this.subscript||(i.caret=this.caret,t.mathstyle.isTight()&&(i.isTight=!0))),i}}function he(t){const e=te("​","arraycolsep");return e.setWidth(t,"em"),e}function ce(t,e,i,s){const n=[];for(const r of e){const e=te(ue(t,s));e.depth=r.depth,e.height=r.height,n.push(e),n.push(r.pos-i)}return ne(t,n,"individualShift")}function de(t,e,i,s,n,r,o){if(!n&&!r)return e;e=te(e);let a=0,l=0;n&&(a=Math.max(P.bigOpSpacing1,P.bigOpSpacing3-n.depth)),r&&(l=Math.max(P.bigOpSpacing2,P.bigOpSpacing4-r.height));let h=null;if(r&&n){const o=P.bigOpSpacing5+et.height(r)+et.depth(r)+l+et.depth(e)+i;(h=ne(t,[P.bigOpSpacing5,r,l,e,a,n,P.bigOpSpacing5],"bottom",o)).children[0].setLeft(-s),h.children[2].setLeft(s)}else if(r&&!n){const n=et.height(e)-i;(h=ne(t,[P.bigOpSpacing5,r,l,e],"top",n)).children[0].setLeft(-s)}else if(!r&&n){const r=et.depth(e)+i;(h=ne(t,[e,a,n,P.bigOpSpacing5],"bottom",r)).children[1].setLeft(s)}return et.makeSpanOfType(o,h,"op-limits")}function ue(t,e){t instanceof Y.Context||(t=new Y.Context(t));const i=!t.generateID||!t.generateID.groupNumbers;let s=[];if(Array.isArray(e)){if(0===e.length)return s;if(1===e.length)(s=e[0].decompose(t))&&i&&e[0].isSelected&&s.forEach(t=>t.selected(!0));else{let n="none",r=e[1].type,o=[],a=null,l=null;for(let h=0;h<e.length;h++){"mbin"===e[h].type&&(/first|none|mrel|mpunct|mopen|mbin|mop/.test(n)||/none|mrel|mpunct|mclose/.test(r))&&(e[h].type="mord"),"​"===e[h].body&&(e[h].superscript||e[h].subscript)||(l=null),t.generateID.groupNumbers&&a&&"mord"===e[h].type&&/[0-9,.]/.test(e[h].latex)&&(t.generateID.overrideID=a);const c=e[h].decompose(t,l);if(t.generateID&&(t.generateID.overrideID=null),c){const n=[].concat.apply([],c);l=n,t.generateID&&t.generateID.groupNumbers&&("mord"===e[h].type&&/[0-9,.]/.test(e[h].latex)&&(a||(a=e[h].id)),("mord"!==e[h].type||/[0-9,.]/.test(e[h].latex)||e[h].superscript||e[h].subscript)&&a&&(a=null)),i&&e[h].isSelected?(o=o.concat(n)).forEach(t=>t.selected(!0)):(o.length>0&&(s=[...s,...o],o=[]),s=s.concat(n))}n=e[h].getFinalBaseElement().type,r=e[h+1]?e[h+1].getInitialBaseElement().type:"none"}o.length>0&&(s=[...s,...o],o=[])}}else e&&(s=e.decompose(t))&&i&&e.isSelected&&s.forEach(t=>t.selected(!0));if(!s||0===s.length)return null;if(t.mathstyle!==t.parentMathstyle){const e=t.mathstyle.sizeMultiplier/t.parentMathstyle.sizeMultiplier;for(const t of s)t.height*=e,t.depth*=e}if(t.size!==t.parentSize){const e=ae[t.size]/ae[t.parentSize];for(const t of s)t.height*=e,t.depth*=e}return s}var pe={MathAtom:le,decompose:ue,makeRoot:function(t,e){const i=new le(t=t||"math","root",e||[]);return 0!==i.body.length&&"first"===i.body[0].type||i.body.unshift(new le("","first")),i},GREEK_REGEX:re};const fe={m0:"#3f3d99",m1:"#993d71",m2:"#998b3d",m3:"#3d9956",m4:"#3d5a99",m5:"#993d90",m6:"#996d3d",m7:"#43993d",m8:"#3d7999",m9:"#843d99"},me={apricot:"#FBB982",aquamarine:"#00B5BE",bittersweet:"#C04F17",black:"#221E1F",blue:"#2D2F92",bluegreen:"#00B3B8",blueviolet:"#473992",brickred:"#B6321C",brown:"#792500",burntorange:"#F7921D",cadetblue:"#74729A",carnationpink:"#F282B4",cerulean:"#00A2E3",cornflowerblue:"#41B0E4",cyan:"#00AEEF",dandelion:"#FDBC42",darkorchid:"#A4538A",emerald:"#00A99D",forestgreen:"#009B55",fuchsia:"#8C368C",goldenrod:"#FFDF42",gray:"#949698",green:"#00A64F",greenyellow:"#DFE674",junglegreen:"#00A99A",lavender:"#F49EC4",limegreen:"#8DC73E",magenta:"#EC008C",mahogany:"#A9341F",maroon:"#AF3235",melon:"#F89E7B",midnightblue:"#006795",mulberry:"#A93C93",navyblue:"#006EB8",olivegreen:"#3C8031",orange:"#F58137",orangered:"#ED135A",orchid:"#AF72B0",peach:"#F7965A",periwinkle:"#7977B8",pinegreen:"#008B72",plum:"#92268F",processblue:"#00B0F0",purple:"#99479B",rawsienna:"#974006",red:"#ED1B23",redorange:"#F26035",redviolet:"#A1246B",rhodamine:"#EF559F",royalblue:"#0071BC",royalpurple:"#613F99",rubinered:"#ED017D",salmon:"#F69289",seagreen:"#3FBC9D",sepia:"#671800",skyblue:"#46C5DD",springgreen:"#C6DC67",tan:"#DA9D76",tealblue:"#00AEB3",thistle:"#D883B7",turquoise:"#00B4CE",violet:"#58429B",violetred:"#EF58A0",white:"#FFFFFF",wildstrawberry:"#EE2967",yellow:"#FFF200",yellowgreen:"#98CC70",yelloworange:"#FAA21A"};var ge={stringToColor:function(t){const e=t.toLowerCase().split("!");let i,s,n,r=255,o=255,a=255,l=-1;const h=e.length>0&&"-"===e[0].charAt(0);h&&(e[0]=e[0].slice(1));for(let c=0;c<e.length;c++){i=r,s=o,n=a;let t=e[c].match(/([a-z0-9]*)/);t&&(t=t[1]);let h=me[t]||fe[t];h||(h=e[c]);let d=h.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(d&&d[1]&&d[2]&&d[3])r=Math.max(0,Math.min(255,parseInt(d[1],16))),o=Math.max(0,Math.min(255,parseInt(d[2],16))),a=Math.max(0,Math.min(255,parseInt(d[3],16)));else if((d=h.match(/^#([0-9a-f]{3})$/i))&&d[1]){const t=parseInt(d[1][0],16),e=parseInt(d[1][1],16),i=parseInt(d[1][2],16);r=Math.max(0,Math.min(255,16*t+t)),o=Math.max(0,Math.min(255,16*e+e)),a=Math.max(0,Math.min(255,16*i+i))}else{if(!((d=h.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i))&&d[1]&&d[2]&&d[3]))return null;r=Math.max(0,Math.min(255,parseInt(d[1]))),o=Math.max(0,Math.min(255,parseInt(d[2]))),a=Math.max(0,Math.min(255,parseInt(d[3])))}l>=0&&(r=(1-l)*r+l*i,o=(1-l)*o+l*s,a=(1-l)*a+l*n,l=-1),c+1<e.length&&(l=Math.max(0,Math.min(100,parseInt(e[++c])))/100)}return l>=0&&(r=l*r+(1-l)*i,o=l*o+(1-l)*s,a=l*a+(1-l)*n),h&&(r=255-r,o=255-o,a=255-a),"#"+("00"+Math.round(r).toString(16)).slice(-2)+("00"+Math.round(o).toString(16)).slice(-2)+("00"+Math.round(a).toString(16)).slice(-2)},colorToString:function(t){let e=t.toUpperCase();for(const i in me)if(me[i]===e){e=i;break}for(const i in fe)if(fe[i]===e){e=i;break}return e},AREA_COLORS:["#d35d60","#7293cb","#e1974d","#84bb5d","#9066a7","#aD6a58","#f5a4ce","#fff590","#212121","#818787","#d4d5d2","#ffffff"],LINE_COLORS:["#cc2428","#3769b1","#da7e30","#409852","#6b4c9a","#922426","#e7298a","#ffe907","#000000","#525055","#adafaa","#ffffff"]};const be=pe.MathAtom;class ye{constructor(t,e,i){this.tokens=t,this.index=0,this.args=e,this.macros=i,this.mathList=[],this.style={},this.parseMode="math",this.tabularMode=!1,this.endCount=0}swapMathList(t){const e=this.mathList;return this.mathList=t||[],e}swapParseMode(t){const e=this.parseMode;return this.parseMode=t,e}end(){return this.endCount++,this.index>=this.tokens.length||this.endCount>1e3}get(){return this.endCount=0,this.index<this.tokens.length?this.tokens[this.index++]:null}peek(t){const e=this.index+(t||0);return e<this.tokens.length?this.tokens[e]:null}lastMathAtom(){const t=0===this.mathList.length?"none":this.mathList[this.mathList.length-1].type;if("mop"!==t&&"msubsup"!==t){const t=new be(this.parseMode,"msubsup","​");t.attributes={"aria-hidden":!0},this.mathList.push(t)}return this.mathList[this.mathList.length-1]}hasToken(t){const e=this.index;return e<this.tokens.length&&this.tokens[e].type===t}hasLiteral(t){const e=this.index;return e<this.tokens.length&&"literal"===this.tokens[e].type&&(!t||this.tokens[e].value===t)}hasLiteralPattern(t){return this.hasToken("literal")&&t.test(this.tokens[this.index].value)}hasCommand(t){const e=this.index;return e<this.tokens.length&&"command"===this.tokens[e].type&&this.tokens[e].value===t}hasInfixCommand(){const t=this.index;if(t<this.tokens.length&&"command"===this.tokens[t].type){const e=Rt.getInfo("\\"+this.tokens[t].value,this.parseMode,this.macros);return e&&e.infix}return!1}hasColumnSeparator(){const t=this.index;return!!(this.tabularMode&&t<this.tokens.length)&&"literal"===this.tokens[t].type&&"&"===this.tokens[t].value}hasRowSeparator(){const t=this.index;return!!(this.tabularMode&&t<this.tokens.length)&&"command"===this.tokens[t].type&&("\\"===this.tokens[t].value||"cr"===this.tokens[t].value)}parseColumnSeparator(){return!!this.hasColumnSeparator()&&(this.index++,!0)}placeholder(){if(this.args&&"string"==typeof this.args["?"])return ve(v.tokenize(this.args["?"]),this.parseMode,null,this.macros);const t=new be(this.parseMode,"placeholder","?",this.style);return t.captureSelection=!0,[t]}hasImplicitCommand(t){if(this.index<this.tokens.length){const e=this.tokens[this.index];if("command"===e.type)return t.includes(e.value)}return!1}parseRowSeparator(){return!!this.hasRowSeparator()&&(this.index++,!0)}parseToken(t){return!!this.hasToken(t)&&(this.index++,!0)}skipWhitespace(){let t=!1;for(;this.hasToken("space");)this.index++,t=!0;return t}skipUntilToken(t){for(;!this.end()&&!this.parseToken(t);)this.get()}parseCommand(t){return!!this.hasCommand(t)&&(this.index++,!0)}parseLiteral(t){return!!this.hasLiteral(t)&&(this.index++,!0)}parseFiller(){let t=!1,e=!1;do{const i=this.skipWhitespace(),s=this.parseCommand("relax");t=t||i||s,e=!i&&!s}while(!e);return t}parseKeyword(t){const e=this.index;let i=this.end(),s="";for(;!i;){const e=this.get();"literal"===e.type&&(s+=e.value),i=this.end()||"literal"!==e.type||s.length>=t.length}const n=t.toUpperCase()===s.toUpperCase();return n||(this.index=e),n}scanString(){let t="",e=this.end();for(;!e;){if(this.hasLiteral("]"))e=!0;else if(this.hasToken("literal"))t+=this.get().value;else if(this.skipWhitespace())t+=" ";else if(this.hasToken("command")){const e=this.get();t+="space"===e.value?" ":e.value}else e=!0;e=e||this.end()}return t}scanColor(){return ge.stringToColor(this.scanString())}scanNumber(t){const e=this.parseLiteral("-");e||this.parseLiteral("+"),this.skipWhitespace(),t=!!t;let i=10,s=/[0-9]/;this.parseLiteral("'")?(i=8,s=/[0-7]/,t=!0):(this.parseLiteral('"')||this.parseLiteral("x"))&&(i=16,s=/[0-9A-F]/,t=!0);let n="";for(;this.hasLiteralPattern(s);)n+=this.get().value;if(!t&&(this.parseLiteral(".")||this.parseLiteral(",")))for(n+=".";this.hasLiteralPattern(s);)n+=this.get().value;const r=t?parseInt(n,i):parseFloat(n);return e?-r:r}scanDimen(){const t=this.scanNumber(!1);return this.skipWhitespace(),this.parseKeyword("pt")?E.toEm(t,"pt"):this.parseKeyword("mm")?E.toEm(t,"mm"):this.parseKeyword("cm")?E.toEm(t,"cm"):this.parseKeyword("ex")?E.toEm(t,"ex"):this.parseKeyword("px")?E.toEm(t,"px"):this.parseKeyword("em")?E.toEm(t,"em"):this.parseKeyword("bp")?E.toEm(t,"bp"):this.parseKeyword("dd")?E.toEm(t,"dd"):this.parseKeyword("pc")?E.toEm(t,"pc"):this.parseKeyword("in")?E.toEm(t,"in"):this.parseKeyword("mu")?E.toEm(t,"mu"):E.toEm(t,"pt")}scanSkip(){const t=this.scanDimen();return this.skipWhitespace(),this.parseKeyword("plus")&&this.scanDimen(),this.skipWhitespace(),this.parseKeyword("minus")&&this.scanDimen(),t}scanColspec(){this.skipWhitespace();const t=[];for(;!this.end()&&!this.hasToken("}")&&!this.hasLiteral("]");)if(this.hasLiteral()){const e=this.get().value;if("lcr".includes(e))t.push({align:e});else if("|"===e)t.push({rule:!0});else if("@"===e){if(this.parseToken("{")){const e=this.swapParseMode("math");t.push({gap:this.scanImplicitGroup(t=>"}"===t.type)}),this.swapParseMode(e)}this.parseToken("}")}}return t}scanModeSet(){let t;if(this.parseCommand("(")&&(t=")"),!t&&this.parseCommand("[")&&(t="]"),!t)return null;const e=this.swapParseMode("math"),i=new be("math","group");return i.mathstyle=")"===t?"textstyle":"displaystyle",i.body=this.scanImplicitGroup(e=>"command"===e.type&&e.value===t),this.parseCommand(t),this.swapParseMode(e),i.body&&0!==i.body.length?i:null}scanModeShift(){if(!this.hasToken("$")&&!this.hasToken("$$"))return null;const t=this.get().type,e=new be("math","group");e.mathstyle="$"===t?"textstyle":"displaystyle",e.latexOpen="textstyle"===e.mathstyle?"$":"$$",e.latexClose=e.latexOpen;const i=this.swapParseMode("math");return e.body=this.scanImplicitGroup(e=>e.type===t),this.parseToken(t),this.swapParseMode(i),e.body&&0!==e.body.length?e:null}scanEnvironment(){if(!this.parseCommand("begin"))return null;const t=this.scanArg("string"),e=Rt.getEnvironmentInfo(t),i=[];if(e&&e.params)for(const u of e.params)if(u.optional){const t=this.scanOptionalArg(u.type);i.push(t)}else i.push(this.scanArg(u.type));const s=this.parseMode,n=this.tabularMode,r=this.swapMathList([]);this.tabularMode=e.tabular;const o=[],a=[];let l=[],h=!1;do{if(!(h=this.end())&&this.parseCommand("end")&&(h=this.scanArg("string")===t),!h)if(this.parseColumnSeparator())l.push(this.swapMathList([]));else if(this.parseRowSeparator()){l.push(this.swapMathList([]));let t=0;this.skipWhitespace(),this.parseLiteral("[")&&(t=this.scanDimen(),this.skipWhitespace(),this.parseLiteral("]")),a.push(t||0),o.push(l),l=[]}else this.mathList=this.mathList.concat(this.scanImplicitGroup())}while(!h);l.push(this.swapMathList([])),l.length>0&&o.push(l);const c=this.swapMathList(r);if(this.parseMode=s,this.tabularMode=n,!e.tabular&&0===c.length)return null;if(e.tabular&&0===o.length)return null;const d=new be(this.parseMode,"array",c,e.parser?e.parser(t,i,o):{});return d.array=o,d.rowGaps=a,d.env={...e},d.env.name=t,d}scanImplicitGroup(t){const e=this.style;t||(t=t=>"}"===t.type||"literal"===t.type&&"&"===t.value||"command"===t.type&&/^(end|cr|\\)$/.test(t.value));let i=null,s=null;const n=this.swapMathList([]);for(;!this.end()&&!t(this.peek());)if(this.hasImplicitCommand(["displaystyle","textstyle","scriptstyle","scriptscriptstyle"])){this.parseMode="math";const t=new be("math","mathstyle");t.mathstyle=this.get().value,this.mathList.push(t)}else this.hasInfixCommand()&&!i?(i=this.get(),s=this.swapMathList([])):this.parseAtom();let r;if(i){const t=this.swapMathList(n),e=Rt.getInfo("\\"+i.value,"math",this.macros);r=e?[new be(this.parseMode,e.type,e.value||i.value,e.parse?e.parse("\\"+i.value,[s,t]):null)]:[new be(this.parseMode,"mop",i.value)]}else r=this.swapMathList(n);return this.style=e,r}scanGroup(){if(!this.parseToken("{"))return null;const t=new be(this.parseMode,"group");return t.body=this.scanImplicitGroup(t=>"}"===t.type),this.parseToken("}"),t.latexOpen="{",t.latexClose="}",t}scanSmartFence(){if(this.skipWhitespace(),!this.parseLiteral("("))return null;const t=new be(this.parseMode,"leftright");t.leftDelim="(",t.inner=!1;const e=this.swapMathList([]);let i=1;for(;!this.end()&&0!==i;)this.hasLiteral("(")&&(i+=1),this.hasLiteral(")")&&(i-=1),0!==i&&this.parseAtom();return 0===i&&this.parseLiteral(")"),t.rightDelim=0===i?")":"?",t.body=this.swapMathList(e),t}scanDelim(){this.skipWhitespace();const t=this.get();if(!t)return null;let e=".";"command"===t.type?e="\\"+t.value:"literal"===t.type&&(e=t.value);const i=Rt.getInfo(e,"math",this.macros);return i?"mopen"===i.type||"mclose"===i.type?e:/^(\?|\||<|>|\\vert|\\Vert|\\\||\\surd|\\uparrow|\\downarrow|\\Uparrow|\\Downarrow|\\updownarrow|\\Updownarrow|\\mid|\\mvert|\\mVert)$/.test(e)?e:null:null}scanLeftRight(){if(this.parseCommand("right")||this.parseCommand("mright")){const t=new be(this.parseMode,"leftright");return t.rightDelim=this.scanDelim()||".",t}const t=this.style;let e="right";if(!this.parseCommand("left")){if(!this.parseCommand("mleft"))return null;e="mright"}const i=this.scanDelim()||".",s=this.swapMathList([]);for(;!this.end()&&!this.parseCommand(e);)this.parseAtom();this.style=t;const n=this.scanDelim(),r=new be(this.parseMode,"leftright");return r.leftDelim=i,r.rightDelim=n,r.inner="right"===e,r.body=this.swapMathList(s),r}parseSupSub(){if("math"!==this.parseMode)return!1;let t=!1;for(;this.hasLiteral("^")||this.hasLiteral("_")||this.hasLiteral("'");){let e;if(this.hasLiteral("^")?e="superscript":this.hasLiteral("_")&&(e="subscript"),this.parseLiteral("^")||this.parseLiteral("_")){const i=this.scanArg();if(i){const s=this.lastMathAtom();s[e]=s[e]||[],s[e]=s[e].concat(i),t=!0}}else if(this.parseLiteral("'")){const e=this.lastMathAtom();e.superscript=e.superscript||[],e.superscript.push(new be(e.parseMode,"mord","′")),t=!0}}return t}parseLimits(){if(this.parseCommand("limits")){const t=this.lastMathAtom();return t.limits="limits",t.explicitLimits=!0,!0}if(this.parseCommand("nolimits")){const t=this.lastMathAtom();return t.limits="nolimits",t.explicitLimits=!0,!0}return!1}scanOptionalArg(t){if(t=t&&"auto"!==t?t:this.parseMode,this.skipWhitespace(),!this.parseLiteral("["))return null;const e=this.parseMode;this.parseMode=t;const i=this.swapMathList();let s;for(;!this.end()&&!this.parseLiteral("]");)if("string"===t)s=this.scanString();else if("number"===t)s=this.scanNumber();else if("dimen"===t)s=this.scanDimen();else if("skip"===t)s=this.scanSkip();else if("colspec"===t)s=this.scanColspec();else if("color"===t)s=this.scanColor()||"#ffffff";else if("bbox"===t){const t=this.scanString().toLowerCase().trim().split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(const e of t){const t=ge.stringToColor(e);if(t)(s=s||{}).backgroundcolor=t;else{const t=e.match(/^\s*([0-9.]+)\s*([a-z][a-z])/);if(t)(s=s||{}).padding=E.toEm(t[1],t[2]);else{const t=e.match(/^\s*border\s*:\s*(.*)/);t&&((s=s||{}).border=t[1])}}}}else this.mathList=this.mathList.concat(this.scanImplicitGroup(t=>"literal"===t.type&&"]"===t.value));this.parseMode=e;const n=this.swapMathList(i);return s||n}scanArg(t){let e;if(t=t&&"auto"!==t?t:this.parseMode,this.parseFiller(),!this.parseToken("{")){if("delim"===t)return this.scanDelim()||".";if(/^(math|text)$/.test(t)){const e=this.parseMode;this.parseMode=t;const i=this.scanToken();return this.parseMode=e,Array.isArray(i)?i:i?[i]:null}}if(this.hasToken("#")){const t=this.get();return this.skipUntilToken("}"),"?"===t.value?this.placeholder():this.args?void 0===this.args[t.value]&&void 0!==this.args["?"]?this.placeholder():this.args[t.value]||null:null}const i=this.parseMode;this.parseMode=t;const s=this.swapMathList([]);if("string"===t)e=this.scanString(),this.skipUntilToken("}");else if("number"===t)e=this.scanNumber(),this.skipUntilToken("}");else if("dimen"===t)e=this.scanDimen(),this.skipUntilToken("}");else if("skip"===t)e=this.scanSkip(),this.skipUntilToken("}");else if("colspec"===t)e=this.scanColspec(),this.skipUntilToken("}");else if("color"===t)e=this.scanColor()||"#ffffff",this.skipUntilToken("}");else if("delim"===t)e=this.scanDelim()||".",this.skipUntilToken("}");else do{this.mathList=this.mathList.concat(this.scanImplicitGroup())}while(!this.parseToken("}")&&!this.end());this.parseMode=i;const n=this.swapMathList(s);return e||n}scanToken(){const t=this.get();if(!t)return null;let e=null;if("space"===t.type)"text"===this.parseMode&&(e=new be("text",""," ",this.style));else if("placeholder"===t.type)(e=new be(this.parseMode,"placeholder",t.value)).captureSelection=!0;else if("command"===t.type){if("placeholder"===t.value)(e=new be(this.parseMode,"placeholder",this.scanArg("string"),this.style)).captureSelection=!0;else if("char"===t.value){let t=Math.floor(this.scanNumber(!0));(!isFinite(t)||t<0||t>1114111)&&(t=10067),(e=new be(this.parseMode,"math"===this.parseMode?"mord":"",String.fromCodePoint(t))).latex='{\\char"'+("000000"+t.toString(16)).toUpperCase().substr(-6)+"}"}else if("hskip"===t.value||"kern"===t.value){const i=this.scanSkip();isFinite(i)&&((e=new be(this.parseMode,"spacing",null,this.style)).width=i),e.latex="\\"+t.value}else if(!(e=this.scanMacro(t.value))){const i=Rt.getInfo("\\"+t.value,this.parseMode,this.macros),s=[];let n="",r="";if(i&&i.params)for(const t of i.params)if(t.optional){const e=this.scanOptionalArg(t.type);s.push(e)}else if(t.type.endsWith("*"))r=t.type.slice(0,-1);else{const e=this.scanArg(t.type);if(e&&1===e.length&&"placeholder"===e[0].type&&t.placeholder&&(e[0].value=t.placeholder),e)s.push(e);else if(t.placeholder){const e=new be(this.parseMode,"placeholder",t.placeholder);e.captureSelection=!0,s.push([e])}else s.push(this.placeholder());"math"!==t.type&&"string"==typeof e&&(n+=e)}if(i&&!i.infix){if(i.parse){const n=i.parse("\\"+t.value,s);if(n.type)e=new be(this.parseMode,i.type,r?this.scanArg(r):null,{...this.style,...n});else{const t=this.parseMode;if(n.mode&&(this.parseMode=n.mode,delete n.mode),r){const t=this.style;this.style={...this.style,...n},e=this.scanArg(r),this.style=t}else this.style={...this.style,...n};this.parseMode=t}}else{const s={...this.style};i.baseFontFamily&&(s.baseFontFamily=i.baseFontFamily),e=new be(this.parseMode,i.type||"mop",i.value||t.value,s),i.skipBoundary&&(e.skipBoundary=!0)}if(e&&!/^(llap|rlap|class|cssId)$/.test(t.value)&&(e.latex="\\"+t.value,n&&(e.latex+="{"+n+"}"),e.isFunction&&this.smartFence)){const t=this.scanSmartFence();t&&(e=[e,t])}}i||((e=new be(this.parseMode,"error","\\"+t.value)).latex="\\"+t.value)}}else if("literal"===t.type){const i=Rt.getInfo(t.value,this.parseMode,this.macros);if(i){const s={...this.style};i.baseFontFamily&&(s.baseFontFamily=i.baseFontFamily),e=new be(this.parseMode,i.type,i.value||t.value,s),i.isFunction&&(e.isFunction=!0)}else e=new be(this.parseMode,"math"===this.parseMode?"mord":"",t.value,this.style);if(e.latex=Rt.matchCodepoint(this.parseMode,t.value.codePointAt(0)),i&&i.isFunction&&this.smartFence){const t=this.scanSmartFence();t&&(e=[e,t])}}else if("#"===t.type)if("?"===t.value)e=this.placeholder();else if(this.args)if(e=this.args[t.value]||null,Array.isArray(e)&&1===e.length)e=e[0];else if(Array.isArray(e)){const t=new be(this.parseMode,"group");t.body=e,e=t}else e=this.placeholder();return e}scanMacro(t){if(!this.macros||!this.macros[t])return null;const e={};let i,s=0;"string"==typeof this.macros[t]?(/(^|[^\\])#1/.test(i=this.macros[t])&&(s=1),/(^|[^\\])#2/.test(i)&&(s=2),/(^|[^\\])#3/.test(i)&&(s=3),/(^|[^\\])#4/.test(i)&&(s=4),/(^|[^\\])#5/.test(i)&&(s=5),/(^|[^\\])#6/.test(i)&&(s=6),/(^|[^\\])#7/.test(i)&&(s=7),/(^|[^\\])#8/.test(i)&&(s=8),/(^|[^\\])#9/.test(i)&&(s=9)):(i=this.macros[t].def,s=this.macros[t].args||0);for(let o=1;o<=s;o++)e[o]=this.scanArg();this.args&&"string"==typeof this.args["?"]&&(e["?"]=this.args["?"]);const n=new be(this.parseMode,"group",ve(v.tokenize(i),this.parseMode,e,this.macros));n.captureSelection=!0,n.latex="\\"+t;let r="";for(let o=1;o<=s;o++){if(r+="{",Array.isArray(e[o]))for(let t=0;t<e[o].length;t++)r+=e[o][t].latex;r+="}"}return n.latex+=r||"",n}parseAtom(){let t=this.scanEnvironment()||this.scanModeShift()||this.scanModeSet()||this.scanGroup()||this.scanLeftRight();return!(t||!this.parseSupSub()&&!this.parseLimits())||(t||(t=this.scanToken()),Array.isArray(t)?this.mathList=this.mathList.concat(t):t&&this.mathList.push(t),null!==t)}}function ve(t,e,i,s,n){let r=[];const o=new ye(t,i,s);for(o.parseMode=e||"math",n&&(o.smartFence=!0);!o.end();)r=r.concat(o.scanImplicitGroup());return r}var Ce={Parser:ye,parseTokens:ve};function xe(t,e){let i="";for(const s of t)i+=s.relation+":"+s.offset+"/";return e&&(i+="#"+e),i}function _e(t){const e={path:[],extent:0},i=t.split("#");i.length>1&&(e.extent=parseInt(i[1]));const s=i[0].split("/");for(const n of s){const t=n.match(/([^:]*):(.*)/);t&&e.path.push({relation:t[1],offset:parseInt(t[2])})}return e}var Pe={pathFromString:_e,pathToString:xe,pathDistance:function(t,e){let i=-1,s=!1;for(;!s;)s=(s=(i+=1)>=t.length||i>=e.length)||!(t[i].relation===e[i].relation&&t[i].offset===e[i].offset);return i===t.length&&i===e.length?0:i+1===t.length&&i+1===e.length&&t[i].relation===e[i].relation?1:2},pathCommonAncestor:function(t,e){const i=[],s=Math.min(t.length-1,e.length-1);let n=0;for(;n<=s&&t[n].relation===e[n].relation&&t[n].offset===e[n].offset;)i.push(t[n]),n+=1;return i},clone:function(t){return _e(xe(t)).path}};const Se={Left:"moveToPreviousChar",Right:"moveToNextChar",Up:"moveUp",Down:"moveDown","Shift-Left":"extendToPreviousChar","Shift-Right":"extendToNextChar","Shift-Up":"extendUp","Shift-Down":"extendDown",Backspace:"deletePreviousChar","Alt-Del":"deletePreviousChar",Del:"deleteNextChar","Alt-Backspace":"deleteNextChar","Alt-Left":"moveToPreviousWord","Alt-Right":"moveToNextWord","Alt-Shift-Left":"extendToPreviousWord","Alt-Shift-Right":"extendToNextWord","Ctrl-Left":"moveToGroupStart","Ctrl-Right":"moveToGroupEnd","Ctrl-Shift-Left":"extendToGroupStart","Ctrl-Shift-Right":"extendToGroupEnd","math:Spacebar":"moveAfterParent","math:Shift-Spacebar":"moveBeforeParent",Home:"moveToMathFieldStart","mac:Meta-Left":"moveToMathFieldStart","Shift-Home":"extendToMathFieldStart","mac:Meta-Shift-Left":"extendToMathFieldStart",End:"moveToMathFieldEnd","mac:Meta-Right":"moveToMathFieldEnd","Shift-End":"extendToMathFieldEnd","mac:Meta-Shift-Right":"extendToMathFieldEnd",PageUp:"moveToGroupStart",PageDown:"moveToGroupEnd","math:Tab":"moveToNextPlaceholder","math:F8":"moveToNextPlaceholder","math:Shift-Tab":"moveToPreviousPlaceholder","math:Shift-F8":"moveToPreviousPlaceholder","text:Tab":"moveToNextPlaceholder","text:F8":"moveToNextPlaceholder","text:Shift-Tab":"moveToPreviousPlaceholder","text:Shift-F8":"moveToPreviousPlaceholder","math:Esc":["switch-mode","command"],"math:Backslash":["switch-mode","command"],"math:IntlBackslash":["switch-mode","command"],"math:Alt-Equal":["apply-style",{mode:"text"}],"text:Alt-Equal":["apply-style",{mode:"math"}],"command:Esc":["complete",{discard:!0}],"command:Tab":["complete",{acceptSuggestion:!0}],"command:Return":"complete","command:Enter":"complete","command:Shift-Esc":["complete",{discard:!0}],"command:Down":"nextSuggestion","ios:command:Tab":"nextSuggestion","command:Up":"previousSuggestion","!mac:Ctrl-KeyA":"selectAll","mac:Meta-KeyA":"selectAll",Cut:"cut",Copy:"copy",Paste:"paste",Clear:"delete","!mac:Ctrl-KeyZ":"undo","mac:Meta-KeyZ":"undo",Undo:"undo","!mac:Ctrl-KeyY":"redo","mac:Meta-Shift-KeyY":"redo","!mac:Ctrl-Shift-KeyZ":"redo","mac:Meta-Shift-KeyZ":"redo",Redo:"redo",EraseEof:"deleteToGroupEnd","mac:Ctrl-KeyB":"moveToPreviousChar","mac:Ctrl-KeyF":"moveToNextChar","mac:Ctrl-KeyP":"moveUp","mac:Ctrl-KeyN":"moveDown","mac:Ctrl-KeyA":"moveToMathFieldStart","mac:Ctrl-KeyE":"moveToMathFieldEnd","mac:Ctrl-Shift-KeyB":"extendToPreviousChar","mac:Ctrl-Shift-KeyF":"extendToNextChar","mac:Ctrl-Shift-KeyP":"extendUp","mac:Ctrl-Shift-KeyN":"extendDown","mac:Ctrl-Shift-KeyA":"extendToMathFieldStart","mac:Ctrl-Shift-KeyE":"extendToMathFieldEnd","mac:Ctrl-Alt-KeyB":"moveToPreviousWord","mac:Ctrl-Alt-KeyF":"moveToNextWord","mac:Ctrl-Shift-Alt-KeyB":"extendToPreviousWord","mac:Ctrl-Shift-Alt-KeyF":"extendToNextWord","mac:Ctrl-KeyH":"deletePreviousChar","mac:Ctrl-KeyD":"deleteNextChar","mac:Ctrl-KeyL":"scrollIntoView","mac:Ctrl-KeyT":"transpose","math:Shift-Quote":["switch-mode","text","","“"],"text:Shift-Quote":["switch-mode","math","”",""],"math:Ctrl-Digit2":["insert","\\sqrt{#0}"],"math:Ctrl-Digit5":"moveToOpposite","math:Ctrl-Digit6":"moveToSuperscript","math:Ctrl-Minus":"moveToSubscript","math:Alt-BracketLeft":["insert","\\left\\lbrack #0 \\right\\rbrack"],"math:Alt-Shift-BracketLeft":["insert","\\left\\lbrace #0 \\right\\rbrace"],"math:Return":"addRowAfter","math:Enter":"addRowAfter","math:Ctrl-Comma":"addColumnAfter","math:Alt-KeyQ":["insert","\\theta"],"math:Alt-KeyP":["insert","\\pi"],"math:Alt-KeyV":["insert","\\sqrt{#0}"],"math:Alt-KeyW":["insert","\\sum_{i=#?}^{#?}"],"math:Alt-KeyB":["insert","\\int_{#?}^{#?}"],"math:Alt-KeyU":["insert","\\cup"],"math:Alt-KeyN":["insert","\\cap"],"math:Alt-KeyO":["insert","\\emptyset"],"math:Alt-KeyD":["insert","\\differentialD"],"math:Alt-Shift-KeyO":["insert","\\varnothing"],"math:Alt-Shift-KeyD":["insert","\\partial"],"math:Alt-Shift-KeyP":["insert","\\prod_{i=#?}^{#?}"],"math:Alt-Shift-KeyU":["insert","\\bigcup"],"math:Alt-Shift-KeyN":["insert","\\bigcap"],"math:Alt-Shift-KeyA":["insert","\\forall"],"math:Alt-Shift-KeyE":["insert","\\exists"],"math:Alt-Digit5":["insert","\\infty"],"math:Alt-Digit6":["insert","\\wedge"],"math:Alt-Shift-Digit6":["insert","\\vee"],"math:Alt-Digit9":["insert","("],"math:Alt-Digit0":["insert",")"],"math:Alt-Shift-Backslash":["insert","|"],"math:Alt-Backslash":["insert","\\backslash"],"math:Slash":["insert","\\frac{#@}{#?}"],"math:Alt-Slash":["insert","\\frac{#?}{#@}"],"math:NumpadDivide":["insert","\\frac{#@}{#?}"],"math:Alt-NumpadDivide":["insert","\\frac{#?}{#@}"],"math:Shift-Backquote":["insert","\\~"],"math:Alt-Shift-Slash":["insert","\\/"],"Alt-Shift-KeyK":"toggleKeystrokeCaption","Alt-Space":"toggleVirtualKeyboard","mac:Ctrl-Meta-Up":["speak","parent",{withHighlighting:!1}],"!mac:Ctrl-Alt-Up":["speak","parent",{withHighlighting:!1}],"mac:Ctrl-Meta-Down":["speak","all",{withHighlighting:!1}],"!mac:Ctrl-Alt-Down":["speak","all",{withHighlighting:!1}],"mac:Ctrl-Meta-Left":["speak","left",{withHighlighting:!1}],"!mac:Ctrl-Alt-Left":["speak","left",{withHighlighting:!1}],"mac:Ctrl-Meta-Right":["speak","right",{withHighlighting:!1}],"!mac:Ctrl-Alt-Right":["speak","right",{withHighlighting:!1}],"!mac:Ctrl-Alt-Period":["speak","selection",{withHighlighting:!1}],"mac:Ctrl-Meta-Period":["speak","selection",{withHighlighting:!1}],"mac:Ctrl-Meta-Shift-Up":["speak","parent",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Up":["speak","parent",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Down":["speak","all",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Down":["speak","all",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Left":["speak","left",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Left":["speak","left",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Right":["speak","right",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Right":["speak","right",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Period":["speak","selection",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Period":["speak","selection",{withHighlighting:!0}]},we={"\\theta":"Alt-KeyQ","\\sqrt":["Alt-KeyV","Ctrl-Digit2"],"\\pi":"Alt-KeyP","\\prod":"Alt-Shift-KeyP","\\sum":"Alt-KeyW","\\int":"Alt-KeyB","\\cup":"Alt-KeyU","\\cap":"Alt-KeyN","\\bigcup":"Alt-Shift-KeyU","\\bigcap":"Alt-Shift-KeyN","\\forall":"Alt-Shift-KeyA","\\exists":"Alt-Shift-KeyE","\\infty":"Alt-Digit5","\\wedge":"Alt-Digit5","\\vee":"Alt-Shift-Digit6","\\differentialD":"Alt-keyD","\\partial":"Alt-Shift-KeyD","\\frac":"Slash","\\emptyset":"Alt-KeyO","\\varnothing":"Alt-Shift-KeyO","\\~":"~"},Ee={"''":{mode:"math",value:"^{\\doubleprime}"},alpha:"\\alpha",delta:"\\delta",Delta:"\\Delta",pi:{mode:"math",value:"\\pi"},"pi ":{mode:"text",value:"\\pi "},Pi:{mode:"math",value:"\\Pi"},theta:"\\theta",Theta:"\\Theta",ii:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryI"},jj:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryJ"},ee:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\exponentialE"},nabla:{mode:"math",value:"\\nabla"},grad:{mode:"math",value:"\\nabla"},del:{mode:"math",value:"\\partial"},"∞":"\\infty",oo:{mode:"math",after:"nothing+digit+frac+surd+binop+relop+punct+array+openfence+closefence+space",value:"\\infty"},"∑":{mode:"math",value:"\\sum"},sum:{mode:"math",value:"\\sum_{#?}^{#?}"},prod:{mode:"math",value:"\\prod_{#?}^{#?}"},sqrt:{mode:"math",value:"\\sqrt"},"∆":{mode:"math",value:"\\differentialD"},"∂":{mode:"math",value:"\\differentialD"},sin:{mode:"math",value:"\\sin"},cos:{mode:"math",value:"\\cos"},tan:{mode:"math",value:"\\tan"},tanh:{mode:"math",value:"\\tanh"},log:{mode:"math",value:"\\log"},ln:{mode:"math",value:"\\ln"},exp:{mode:"math",value:"\\exp"},lim:{mode:"math",value:"\\lim_{#?}"},dx:"\\differentialD x",dy:"\\differentialD y",dt:"\\differentialD t",AA:{mode:"math",value:"\\forall"},EE:{mode:"math",value:"\\exists"},"!EE":{mode:"math",value:"\\nexists"},"&&":{mode:"math",value:"\\land"},xin:{mode:"math",after:"nothing+text+relop+punct+openfence+space",value:"x \\in"},in:{mode:"math",after:"nothing+letter+closefence",value:"\\in"},"!in":{mode:"math",value:"\\notin"},NN:"\\N",ZZ:"\\Z",QQ:"\\Q",RR:"\\R",CC:"\\C",PP:"\\P",xx:"\\times","+-":"\\pm","!=":"\\ne",">=":"\\ge","<=":"\\le","<<":"\\ll",">>":"\\gg","~~":"\\approx","≈":"\\approx","?=":"\\questeq","÷":"\\div","¬":"\\neg",":=":"\\coloneq","::":"\\Colon","(:":"\\langle",":)":"\\rangle",beta:"\\beta",chi:"\\chi",epsilon:"\\epsilon",varepsilon:"\\varepsilon",eta:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\eta"},"eta ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\eta "},gamma:"\\gamma",Gamma:"\\Gamma",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",Lambda:"\\Lambda",mu:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\mu"},"mu ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\mu "},nu:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\nu"},"nu ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\nu "},"µ":"\\mu",phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\phi"},Phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Phi"},varphi:"\\varphi",psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\psi"},Psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Psi"},rho:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\rho"},sigma:"\\sigma",Sigma:"\\Sigma",tau:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\tau"},vartheta:"\\vartheta",upsilon:"\\upsilon",xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\xi"},Xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Xi"},zeta:"\\zeta",omega:"\\omega",Omega:"\\Omega","Ω":"\\omega",forall:"\\forall",exists:{mode:"math",value:"\\exists"},"!exists":{mode:"math",value:"\\nexists"},":.":{mode:"math",value:"\\therefore"},liminf:"\\operatorname*{lim~inf}_{#?}",limsup:"\\operatorname*{lim~sup}_{#?}",argmin:"\\operatorname*{arg~min}_{#?}",argmax:"\\operatorname*{arg~max}_{#?}",det:"\\det",mod:{mode:"math",value:"\\mod"},max:{mode:"math",value:"\\max"},min:{mode:"math",value:"\\min"},erf:"\\operatorname{erf}",erfc:"\\operatorname{erfc}",bessel:{mode:"math",value:"\\operatorname{bessel}"},mean:{mode:"math",value:"\\operatorname{mean}"},median:{mode:"math",value:"\\operatorname{median}"},fft:{mode:"math",value:"\\operatorname{fft}"},lcm:{mode:"math",value:"\\operatorname{lcm}"},gcd:{mode:"math",value:"\\operatorname{gcd}"},randomReal:"\\operatorname{randomReal}",randomInteger:"\\operatorname{randomInteger}",Re:{mode:"math",value:"\\operatorname{Re}"},Im:{mode:"math",value:"\\operatorname{Im}"},mm:{mode:"math",after:"nothing+digit",value:"\\operatorname{mm}"},cm:{mode:"math",after:"nothing+digit",value:"\\operatorname{cm}"},km:{mode:"math",after:"nothing+digit",value:"\\operatorname{km}"},kg:{mode:"math",after:"nothing+digit",value:"\\operatorname{kg}"},"...":"\\ldots","+...":"+\\cdots","-...":"-\\cdots","->...":"\\to\\cdots","->":"\\to","|->":"\\mapsto","--\x3e":"\\longrightarrow","<--":"\\longleftarrow","=>":"\\Rightarrow","==>":"\\Longrightarrow","<=>":"\\Leftrightarrow","<->":"\\leftrightarrow","(.)":"\\odot","(+)":"\\oplus","(/)":"\\oslash","(*)":"\\otimes","(-)":"\\ominus","||":"\\Vert","{":"\\{","}":"\\}","*":"\\cdot"};function ke(t,e,i){if(!i)return i;if("string"==typeof i)return i;if("string"==typeof i.mode&&i.mode!==t)return null;if(!e)return i?i.value:void 0;let s=!1,n=!1,r=!1,o=!1,a=!1,l=!1,h=!1,c=!1,d=!1,u=!1,p=!1,f=!1,m=!1,g=!1,b=e[e.length-1],y=e.length-1;for(;b&&/msubsup|placeholder/.test(b.type);)b=e[y-=1];return s=!b||"first"===b.type,b&&(n=!(m="text"===b.mode)&&"mord"===b.type&&Rt.LETTER.test(b.body),r=!m&&"mord"===b.type&&/[0-9]+$/.test(b.body),o=!m&&b.isFunction,a="genfrac"===b.type,l="surd"===b.type,h="mbin"===b.type,c="mrel"===b.type,d="mpunct"===b.type||"minner"===b.type,u=b.array,p="mopen"===b.type,f="mclose"===b.type||"leftright"===b.type,g="space"===b.type),void 0!==i.after?/nothing/.test(i.after)&&s||/letter/.test(i.after)&&n||/digit/.test(i.after)&&r||/function/.test(i.after)&&o||/frac/.test(i.after)&&a||/surd/.test(i.after)&&l||/binop/.test(i.after)&&h||/relop/.test(i.after)&&c||/punct/.test(i.after)&&d||/array/.test(i.after)&&u||/openfence/.test(i.after)&&p||/closefence/.test(i.after)&&f||/text/.test(i.after)&&m||/space/.test(i.after)&&g?i.value:null:i.value}function Ae(t){let e="other";return navigator&&navigator.platform&&navigator.userAgent&&(/^(mac)/i.test(navigator.platform)?e="mac":/^(win)/i.test(navigator.platform)?e="win":/(android)/i.test(navigator.userAgent)?e="android":/(iphone)/i.test(navigator.userAgent)||/(ipod)/i.test(navigator.userAgent)||/(ipad)/i.test(navigator.userAgent)?e="ios":/\bCrOS\b/i.test(navigator.userAgent)&&(e="chromeos")),e===t?t:"!"+t}function Te(t){let e=t;return Array.isArray(e)&&e.length>0&&(e=e[0]+"("+e.slice(1).join("")+")"),e}function Me(t,e){let i="";Array.isArray(t)||(t=[t]);for(const s of t){let t;const n=s.match(/(^[^:]*):/),r=n?n[1]:"";if(r===Ae("mac")||r===Ae("win")||r===Ae("ios")||r===Ae("android")||r===Ae("chromeos")||r===Ae("other")){const e=s.match(/:([^:]*)$/);t=e?e[1]:s}else if(!["mac","!mac","win","!win","ios","!ios","android","!android","chromeos","!chromeos","other","!other"].includes(r)){const e=s.match(/:([^:]*)$/);t=e?e[1]:s}if(t){const s="mac"===Ae("mac")||"ios"===Ae("ios"),n=t.length>1?t.split("-"):[t];let r="";for(const t of n)!s&&r.length>0&&(r+='<span class="ML__shortcut-join">+</span>'),"Key"===t.substr(0,3)?r+=t.substr(3,1):"Digit"===t.substr(0,5)?r+=t.substr(5,1):r+={Meta:s?"⌘":"command",Shift:s?"⇧":"shift",Alt:s?"⌥":"alt",Ctrl:s?"⌃":"control","\n":s?"⏎":"return",Return:s?"⏎":"return",Enter:s?"⌤":"enter",Tab:s?"⇥":"tab",Esc:"esc",Backspace:s?"⌫":"backspace",Del:s?"⌦":"del",PageUp:s?"⇞":"page up",PageDown:s?"⇟":"page down",Home:s?"⤒":"home",End:s?"⤓":"end",Spacebar:"space",Semicolon:";",Period:".",Comma:",",Minus:"-",Equal:"=",Quote:"'",BracketLeft:"[",BracketRight:"]",Backslash:"\\",IntlBackslash:"\\",Backquote:"`",Slash:"/",NumpadMultiply:"* &#128290;",NumpadDivide:"/ &#128290;",NumpadSubtract:"- &#128290;",NumpadAdd:"+ &#128290;",NumpadDecimal:". &#128290;",NumpadComma:", &#128290;",Help:"help",Left:"⇠",Up:"⇡",Right:"⇢",Down:"⇣"}[t]||t;i.length>0&&(i+=e||" or "),i+=r}}return i}var Oe={KEYBOARD_SHORTCUTS:Se,INLINE_SHORTCUTS:Ee,stringify:Me,startsWithString:function(t,e){const i=[];for(let s=0;s<=t.length-1;s++){const n=t.substring(s);e&&e.overrideDefaultInlineShortcuts||Object.keys(Ee).forEach(t=>{t.startsWith(n)&&!i.includes(t)&&i.push(t)});const r=e&&e.inlineShortcuts?e.inlineShortcuts:null;r&&Object.keys(r).forEach(t=>{t.startsWith(n)&&i.push(t)})}return i},forString:function(t,e,i,s){let n="";s&&s.overrideDefaultInlineShortcuts||(n=ke(t,e,Ee[i]));const r=s&&s.inlineShortcuts?s.inlineShortcuts:null;let o;return r&&(o=ke(t,e,r[i])),o||n},selectorForKeystroke:function(t,e){for(const i of[Ae("mac")+":"+t+":"+e,Ae("win")+":"+t+":"+e,Ae("ios")+":"+t+":"+e,Ae("android")+":"+t+":"+e,Ae("chromeos")+":"+t+":"+e,Ae("other")+":"+t+":"+e,Ae("mac")+":"+e,Ae("win")+":"+e,Ae("ios")+":"+e,Ae("android")+":"+e,Ae("chromeos")+":"+e,t+":"+e,e])if(Se[i])return Se[i];return""},forCommand:function(t){let e=[];if("string"==typeof t){const i=we[t];Array.isArray(i)?e=i.slice():i&&e.push(i)}t=Te(t);const i=new RegExp("^"+t.replace("\\","\\\\").replace("|","\\|").replace("*","\\*").replace("$","\\$").replace("^","\\^")+"([^*a-zA-Z]|$)");return Object.keys(Se).forEach(t=>{if(i.test(Te(Se[t]))){const i=t.match(/:([^:]*)$/);i&&e.push(i[1])}}),Me(e)}};function Ne(t,e){this.root=pe.makeRoot(),this.path=[{relation:"body",offset:0}],this.extent=0,this.config=t?{...t}:{},this.target=e,this.suppressChangeNotifications=!1}function Le(t){const e=Object.assign(new Ne(t.config,t.target),t);return e.path=Pe.clone(t.path),e}function De(t,e){let i=0;for(let s=0;s<e.row;s++)for(let e=0;e<t[s].length;e++)i+=1;return i+e.col}function je(t,e){if("string"==typeof e){const t=e.match(/cell([0-9]*)$/);t&&(e=parseInt(t[1]))}const i={row:0,col:0};for(;e>0;)i.col+=1,(!t[i.row]||i.col>=t[i.row].length)&&(i.col=0,i.row+=1),e-=1;return i}function Ie(t,e){let i;return"object"!=typeof e&&(e=je(t,e)),Array.isArray(t[e.row])&&(i=t[e.row][e.col]||null),!i||0!==i.length&&"first"===i[0].type||i.unshift(Je()),i}function Re(t){let e=0,i=1;for(const s of t)e+=1,s.length>i&&(i=s.length);return e*i}function Be(t,e,i){if(!t)return[];e||(e=",");let s,n=[];for(let r of t)r&&r.length>0&&"first"===r[0].type&&(r=r.slice(1)),r&&r.length>0&&(s?n.push(s):s=new pe.MathAtom("math","mpunct",e,i),n=n.concat(r));return n}function Fe(t,e,i){const s={...e};if(s.row+=i,s.row<0){if(s.col+=i,s.row=t.length-1,s.col<0)return null;for(;s.row>=0&&!Ie(t,s);)s.row-=1;if(s.row<0)return null}else if(s.row>=t.length){for(s.col+=i,s.row=0;s.row<t.length&&!Ie(t,s);)s.row+=1;if(s.row>t.length-1)return null}return s}function Ye(t){return!!t&&("mord"===t.type&&/[0-9.]/.test(t.body)||"mpunct"===t.type&&","===t.body)}function ze(t,e){if(!t)return!1;if(Array.isArray(t)){for(const i of t)if(ze(i,e))return!0}else{if(t===e)return!0;if(["body","numer","denom","index","subscript","superscript","underscript","overscript"].some((function(i){return i===e||ze(t[i],e)})))return!0;if(t.array)for(let i=Re(t.array);i>=0;i--)if(ze(Ie(t.array,i),e))return!0}return!1}function Xe(t){if(t)return 1===t.length&&"leftright"===t[0].type&&"("===t[0].leftDelim&&(t=t[0].body),t}function Ue(t,e){return t?t.length<=1?t:(e&&"ASCIIMath"===e.format||(t=t.replace(/\\\\([^\s\n])/g,"\\$1")),e&&"ASCIIMath"===e.format||!/\\/.test(t)?Ge(t=(t=(t=(t=(t=(t=t.replace(/\u2061/gu,"")).replace(/\u3016/gu,"{")).replace(/\u3017/gu,"}")).replace(/([^\\])sinx/g,"$1\\sin x")).replace(/([^\\])cosx/g,"$1\\cos x ")).replace(/\u2013/g,"-"),e):t):""}function Ge(t,e){if(!t)return"";let i,s=!1;if(s||"^"!==t[0]&&"_"!==t[0]||(i=He(t.substr(1),{...e,noWrap:!0}),t=t[0]+"{"+i.match+"}",t+=Ge(i.rest,e),s=!0),s||(i=t.match(/^(sqrt|\u221a)(.*)/))&&(t="\\sqrt{"+(i=He(i[2],{...e,noWrap:!0})).match+"}",t+=Ge(i.rest,e),s=!0),s||(i=t.match(/^(\\cbrt|\u221b)(.*)/))&&(t="\\sqrt[3]{"+(i=He(i[2],{...e,noWrap:!0})).match+"}",t+=Ge(i.rest,e),s=!0),s||(i=t.match(/^abs(.*)/))&&(t="\\left|"+(i=He(i[1],{...e,noWrap:!0})).match+"\\right|",t+=Ge(i.rest,e),s=!0),s||(i=t.match(/^["”“](.*?)["”“](.*)/))&&(t="\\text{"+i[1]+"}",t+=Ge(i[2],e),s=!0),s||(i=t.match(/^([^a-zA-Z({[_^\\\s"]+)(.*)/))&&(t=qe(i[1],e),t+=Ge(i[2],e),s=!0),!s&&/^(f|g|h)[^a-zA-Z]/.test(t)&&(i=He(t.substring(1),e),t=t[0],t+=i.match,t+=Ge(i.rest,e),s=!0),s||(i=t.match(/^([a-zA-Z]+)(.*)/))&&(t=qe(i[1],e),t+=Ge(i[2],e),s=!0),!s)if((i=He(t,{...e,noWrap:!0})).match&&"/"===i.rest[0]){const n=He(i.rest.substr(1),{...e,noWrap:!0});n.match&&(t="\\frac{"+i.match+"}{"+n.match+"}"+Ge(n.rest,e)),s=!0}else i.match&&/^(\(|\{|\[)$/.test(t[0])?(t="\\left"+t[0]+i.match+"\\right"+{"(":")","{":"}","[":"]"}[t[0]]+Ge(i.rest,e),s=!0):i.match&&(t=i.match,t+=Ge(i.rest,e),s=!0);return s||(i=t.match(/^(\s+)(.*)$/))&&(t=" "+Ge(i[2],e),s=!0),t}function He(t,e){let i="",s=t=t.trim();const n=t.charAt(0),r={"(":")","{":"}","[":"]"}[n];if(r){let o=1,a=1;for(;a<t.length&&o>0;)t[a]===n&&o++,t[a]===r&&o--,a++;0===o?(i=e.noWrap&&"("===n&&")"===r?Ge(t.substring(1,a-1),e):"\\mleft"+n+Ge(t.substring(1,a-1),e)+"\\mright"+r,s=t.substring(a)):(i=t.substring(1,a),s="")}else{let n=t.match(/^([a-zA-Z]+)/);if(n){let i=Oe.forString("math",null,t,e);if(i)return{match:i=(i=i.replace("_{#?}","")).replace("^{#?}",""),rest:t.substring(i.length)}}if(n=t.match(/^([a-zA-Z])/))return{match:n[1],rest:t.substring(1)};if(n=t.match(/^(-)?\d+(\.\d*)?/))return{match:n[0],rest:t.substring(n[0].length)};/^\\(left|right)/.test(t)||(n=t.match(/^(\\[a-zA-Z]+)/))&&(s=t.substring(n[1].length),i=n[1])}return{match:i,rest:s}}function qe(t,e){let i=Oe.forString("math",null,t,e);return i?(i=(i=i.replace("_{#?}","")).replace("^{#?}",""),i+=" "):i=t,i}function Je(){return new pe.MathAtom("","first")}Ne.prototype._announce=function(t,e,i){"function"==typeof this.config.onAnnounce&&this.config.onAnnounce(this.target,t,e,i)},Ne.prototype.filter=function(t,e){e=e<0?-1:1;const i=[],s=new Ne;s.path=Pe.clone(this.path),s.extent=this.extent,s.root=this.root,e>=0?s.collapseForward():(s.collapseBackward(),s.move(1));const n=s.anchor();do{t.bind(s)(s.path,s.anchor())&&i.push(s.toString()),e>=0?s.next({iterateAll:!0}):s.previous({iterateAll:!0})}while(n!==s.anchor());return i},Ne.prototype.forEach=function(t){this.root.forEach(t)},Ne.prototype.forEachSelected=function(t,e){(e=e||{}).recursive=void 0!==e.recursive&&e.recursive;const i=this.siblings(),s=this.startOffset()+1,n=this.endOffset()+1;if(e.recursive)for(let r=s;r<n;r++)i[r]&&"first"!==i[r].type&&i[r].forEach(t);else for(let r=s;r<n;r++)i[r]&&"first"!==i[r].type&&t(i[r])},Ne.prototype.toString=function(){return Pe.pathToString(this.path,this.extent)},Ne.prototype.adjustPlaceholder=function(){const t=this.siblings();if(t&&t.length<=1){let e;const i=this.relation();if("numer"===i?e="numerator":"denom"===i?e="denominator":"surd"===this.parent().type&&"body"===i?e="radicand":"overunder"===this.parent().type&&"body"===i?e="base":"underscript"!==i&&"overscript"!==i||(e="annotation"),e){const e=[new pe.MathAtom("math","placeholder","⬚",this.anchorStyle())];Array.prototype.splice.apply(t,[1,0].concat(e))}}},Ne.prototype.selectionWillChange=function(){"function"!=typeof this.config.onSelectionWillChange||this.suppressChangeNotifications||this.config.onSelectionWillChange(this.target)},Ne.prototype.selectionDidChange=function(){"function"!=typeof this.config.onSelectionDidChange||this.suppressChangeNotifications||this.config.onSelectionDidChange(this.target)},Ne.prototype.contentWillChange=function(){"function"!=typeof this.config.onContentWillChange||this.suppressChangeNotifications||this.config.onContentWillChange(this.target)},Ne.prototype.contentDidChange=function(){"function"!=typeof this.config.onContentDidChange||this.suppressChangeNotifications||this.config.onContentDidChange(this.target)},Ne.prototype.setPath=function(t,e){if("string"==typeof t)t=Pe.pathFromString(t);else if(Array.isArray(t)){const i=Pe.clone(t),s=this.path;this.path=i,0===e&&"placeholder"===this.anchor().type&&(i[i.length-1].offset=0,e=1),t={path:i,extent:e||0},this.path=s}const i=0!==Pe.pathDistance(this.path,t.path),s=t.extent!==this.extent;return(i||s)&&(i&&this.adjustPlaceholder(),this.selectionWillChange(),this.path=Pe.clone(t.path),this.siblings().length<this.anchorOffset()?(this.path=[{relation:"body",offset:0}],this.extent=0):this.setExtent(t.extent),this.selectionDidChange()),i||s},Ne.prototype.wordBoundary=function(t,e){e=e<0?-1:1;const i=new Ne;i.path=Pe.clone(t),i.root=this.root;let s=0;for(;i.sibling(s)&&"text"===i.sibling(s).mode&&Rt.LETTER_AND_DIGITS.test(i.sibling(s).body);)s+=e;return i.sibling(s)||(s-=e),i.path[i.path.length-1].offset+=s,i.path},Ne.prototype.wordBoundaryOffset=function(t,e){e=e<0?-1:1;const i=this.siblings();if(!i[t])return t;if("text"!==i[t].mode)return t;let s;if(Rt.LETTER_AND_DIGITS.test(i[t].body)){let n,r=t;do{n="text"===i[r].mode&&Rt.LETTER_AND_DIGITS.test(i[r].body),r+=e}while(i[r]&&n);s=i[r]?r-2*e:r-e}else if(/\s/.test(i[t].body)){let n=t;for(;i[n]&&"text"===i[n].mode&&/\s/.test(i[n].body);)n+=e;if(i[n]){let t=!0;do{t="text"===i[n].mode&&!/\s/.test(i[n].body),n+=e}while(i[n]&&t);s=i[n]?n-2*e:n-e}else s=n-e}else{let n=t;for(;i[n]&&"text"===i[n].mode&&!/\s/.test(i[n].body);)n+=e;s=i[n]?n:n-e;let r=!0;for(;i[n]&&r;)(r="text"===i[n].mode&&/\s/.test(i[n].body))&&(s=n),n+=e;s=i[n]?n-2*e:n-e}return s-(e>0?0:1)},Ne.prototype.setRange=function(t,e,i){i=i||{};const s=Pe.pathDistance(t,e);if(0===s)return i.extendToWordBoundary?(t=this.wordBoundary(t,-1),e=this.wordBoundary(e,1),this.setRange(t,e)):this.setPath(Pe.clone(t),0);if(1===s){const s=e[e.length-1].offset-t[t.length-1].offset;return i.extendToWordBoundary?(t=this.wordBoundary(t,s<0?1:-1),e=this.wordBoundary(e,s<0?-1:1),this.setRange(t,e)):this.setPath(Pe.clone(t),s)}let n=Pe.pathCommonAncestor(t,e);const r=n.length;if(t.length===r||e.length===r||t[r].relation!==e[r].relation)return this.setPath(n,-1);n.push(t[r]),n=Pe.clone(n);let o=e[r].offset-t[r].offset+1;return o<=0?e.length>r+1?(n[r].relation=e[r].relation,n[r].offset=e[r].offset,n[n.length-1].offset-=1,o=2-o):(n[r].relation=e[r].relation,n[r].offset=e[r].offset,o=1-o):e.length<=t.length?n[n.length-1].offset-=1:e.length>t.length&&(n[r].offset-=1),this.setPath(n,o)},Ne.prototype.ancestor=function(t){if(t>this.path.length)return null;let e=this.root;for(let i=0;i<this.path.length-t;i++){const t=this.path[i];if(e.array)e=Ie(e.array,t.relation)[t.offset];else{if(!e[t.relation])return null;{0!==e[t.relation].length&&"first"===e[t.relation][0].type||e[t.relation].unshift(Je());const i=Math.min(t.offset,e[t.relation].length-1);e=e[t.relation][i]}}}return e},Ne.prototype.anchor=function(){if(this.parent().array)return Ie(this.parent().array,this.relation())[this.anchorOffset()];const t=this.siblings();return t[Math.min(t.length-1,this.anchorOffset())]},Ne.prototype.parent=function(){return this.ancestor(1)},Ne.prototype.relation=function(){return this.path.length>0?this.path[this.path.length-1].relation:""},Ne.prototype.anchorOffset=function(){return this.path.length>0?this.path[this.path.length-1].offset:0},Ne.prototype.focusOffset=function(){return this.path.length>0?this.path[this.path.length-1].offset+this.extent:0},Ne.prototype.startOffset=function(){return Math.min(this.focusOffset(),this.anchorOffset())},Ne.prototype.endOffset=function(){return Math.max(this.focusOffset(),this.anchorOffset())},Ne.prototype.insertFirstAtom=function(){this.siblings()},Ne.prototype.siblings=function(){if(0===this.path.length)return[];let t;return this.parent().array?t=Ie(this.parent().array,this.relation()):"string"==typeof(t=this.parent()[this.relation()]||[])&&(t=[]),0!==t.length&&"first"===t[0].type||t.unshift(Je()),t},Ne.prototype.sibling=function(t){return this.siblings()[this.startOffset()+t]},Ne.prototype.isCollapsed=function(){return 0===this.extent},Ne.prototype.setExtent=function(t){this.extent=t},Ne.prototype.collapseForward=function(){return 0!==this.extent&&(this.setSelection(this.endOffset()),!0)},Ne.prototype.collapseBackward=function(){return 0!==this.extent&&(this.setSelection(this.startOffset()),!0)},Ne.prototype.selectGroup_=function(){const t=this.siblings();if("text"===this.anchorMode()){let e=this.startOffset(),i=this.endOffset();for(;t[e]&&"text"===t[e].mode&&Rt.LETTER_AND_DIGITS.test(t[e].body);)e-=1;for(;t[i]&&"text"===t[i].mode&&Rt.LETTER_AND_DIGITS.test(t[i].body);)i+=1;if(e>=(i-=1))return void this.setSelection(this.endOffset()-1,1);this.setSelection(e,i-e)}else if("mord"===this.sibling(0).type&&/[0-9,.]/.test(this.sibling(0).body)){let e=this.startOffset(),i=this.endOffset();for(;Ye(t[e]);)e-=1;for(;Ye(t[i]);)i+=1;this.setSelection(e,(i-=1)-e)}else this.setSelection(0,"end")},Ne.prototype.selectAll_=function(){this.path=[{relation:"body",offset:0}],this.setSelection(0,"end")},Ne.prototype.deleteAll_=function(){this.selectAll_(),this.delete_()},Ne.prototype.contains=function(t){if(this.isCollapsed())return!1;const e=this.siblings(),i=this.startOffset(),s=this.endOffset();for(let n=i;n<s;n++)if(ze(e[n],t))return!0;return!1},Ne.prototype.getSelectedAtoms=function(){if(this.isCollapsed())return null;const t=[],e=this.siblings(),i=this.startOffset()+1,s=this.endOffset()+1;for(let n=i;n<s;n++)e[n]&&"first"!==e[n].type&&t.push(e[n]);return t},Ne.prototype.commandOffsets=function(){const t=this.siblings();if(t.length<=1)return null;let e=Math.min(this.endOffset(),t.length-1);if("command"!==t[e].type)return null;for(;e>0&&"command"===t[e].type;)e-=1;let i=this.startOffset()+1;for(;i<=t.length-1&&"command"===t[i].type;)i+=1;return i>e?{start:e+1,end:i}:null},Ne.prototype.extractCommandStringAroundInsertionPoint=function(t){let e="";const i=this.commandOffsets();if(i){const s=t?this.anchorOffset()+1:i.end,n=this.siblings();for(let t=i.start;t<s;t++)e+=n[t].body||""}return e},Ne.prototype.decorateCommandStringAroundInsertionPoint=function(t){const e=this.commandOffsets();if(e){const i=this.siblings();for(let s=e.start;s<e.end;s++)i[s].error=t}},Ne.prototype.commitCommandStringBeforeInsertionPoint=function(){const t=this.commandOffsets();if(t){const e=this.siblings(),i=this.anchorOffset()+1;for(let s=t.start;s<i;s++)e[s]&&(e[s].suggestion=!1)}},Ne.prototype.spliceCommandStringAroundInsertionPoint=function(t){const e=this.commandOffsets();if(e){if(this.contentWillChange(),t){Array.prototype.splice.apply(this.siblings(),[e.start,e.end-e.start].concat(t));let i=[];for(const e of t)i=i.concat(e.filter(t=>"placeholder"===t.type));this.setExtent(0),this.path[this.path.length-1].offset=e.start-1,0!==i.length&&this.leap(1,!1)||this.setSelection(e.start+t.length-1)}else this.siblings().splice(e.start,e.end-e.start),this.setSelection(e.start-1,0);this.contentDidChange()}},Ne.prototype.removeCommandString=function(){this.contentWillChange();const t=this.suppressChangeNotifications;this.suppressChangeNotifications=!0,function t(e){if(e)if(Array.isArray(e))for(let i=e.length-1;i>=0;i--)"command"===e[i].type?e.splice(i,1):t(e[i]);else if(t(e.body),t(e.superscript),t(e.subscript),t(e.underscript),t(e.overscript),t(e.numer),t(e.denom),t(e.index),e.array)for(let i=Re(e.array);i>=0;i--)t(Ie(e.array,i))}(this.root.body),this.suppressChangeNotifications=t,this.contentDidChange()},Ne.prototype.extractArgBeforeInsertionPoint=function(){const t=this.siblings();if(t.length<=1)return[];const e=[];let i=this.startOffset();if("text"===t[i].mode)for(;i>=1&&"text"===t[i].mode;)e.unshift(t[i]),i--;else for(;i>=1&&/^(mord|surd|msubsup|leftright|mop)$/.test(t[i].type);)e.unshift(t[i]),i--;return e},Ne.prototype.setSelection=function(t,e,i){t=t||0,e=e||0;const s=this.path[this.path.length-1].relation;i||(i=s);const n=this.parent();if(!n&&"body"!==i)return!1;const r=i.startsWith("cell");if(!r&&!n[i]||r&&!n.array)return!1;const o=i!==s;this.path[this.path.length-1].relation=i;const a=this.siblings().length;this.path[this.path.length-1].relation=s;const l=this.extent;"end"===e?e=a-t-1:"start"===e&&(e=-t),this.setExtent(e);const h=this.extent!==l;return this.setExtent(l),t<0&&(t=a+t),t=Math.max(0,Math.min(t,a-1)),(o||this.path[this.path.length-1].offset!==t||h)&&(o&&this.adjustPlaceholder(),this.selectionWillChange(),this.path[this.path.length-1].relation=i,this.path[this.path.length-1].offset=t,this.setExtent(e),this.selectionDidChange()),!0},Ne.prototype.next=function(t){t=t||{};const e={body:"numer",numer:"denom",denom:"index",index:"overscript",overscript:"underscript",underscript:"subscript",subscript:"superscript"};if(this.anchorOffset()===this.siblings().length-1){this.adjustPlaceholder();let i=e[this.relation()];const s=this.parent();for(;i&&!s[i];)i=e[i];if(i)return void this.setSelection(0,0,i);if(this.parent().array){const t=Re(this.parent().array);let e=parseInt(this.relation().match(/cell([0-9]*)$/)[1])+1;for(;e<t;){if(Ie(this.parent().array,e)&&this.setSelection(0,0,"cell"+e))return void this.selectionDidChange();e+=1}}if(1===this.path.length)(this.suppressChangeNotifications||!this.config.onMoveOutOf||this.config.onMoveOutOf(this,"forward"))&&(this.path[0].offset=0);else{const e=!t.iterateAll&&this.parent().skipBoundary;this.path.pop(),e&&this.next(t)}return void this.selectionDidChange()}this.setSelection(this.anchorOffset()+1);const i=this.anchor();if(i&&!i.captureSelection){let s;if(i.array){let t=0;s="";const e=Re(i.array);for(;!s&&t<e;)Ie(i.array,t)&&(s="cell"+t.toString()),t+=1;return this.path.push({relation:s,offset:0}),void this.setSelection(0,0,s)}for(s="body";s;){if(Array.isArray(i[s]))return this.path.push({relation:s,offset:0}),this.insertFirstAtom(),void(!t.iterateAll&&i.skipBoundary&&this.next(t));s=e[s]}}},Ne.prototype.previous=function(t){const e={numer:"body",denom:"numer",index:"denom",overscript:"index",underscript:"overscript",subscript:"underscript",superscript:"subscript"};if(!(t=t||{}).iterateAll&&1===this.anchorOffset()&&this.parent()&&this.parent().skipBoundary&&this.setSelection(0),this.anchorOffset()<1){let t=e[this.relation()];for(;t&&!this.setSelection(-1,0,t);)t=e[t];const i=this.parent()?this.parent().type:"none";if("body"!==t||"msubsup"!==i&&"mop"!==i||(t=null),t)return;if(this.adjustPlaceholder(),this.selectionWillChange(),this.relation().startsWith("cell")){let t=parseInt(this.relation().match(/cell([0-9]*)$/)[1])-1;for(;t>=0;){if(Ie(this.parent().array,t)&&this.setSelection(-1,0,"cell"+t))return void this.selectionDidChange();t-=1}}return 1===this.path.length?(this.suppressChangeNotifications||!this.config.onMoveOutOf||this.config.onMoveOutOf.bind(this)(-1))&&(this.path[0].offset=this.root.body.length-1):(this.path.pop(),this.setSelection(this.anchorOffset()-1)),void this.selectionDidChange()}const i=this.anchor();if(!i.captureSelection){let t;if(i.array){t="";const e=Re(i.array);let s=e-1;for(;!t&&s<e;)Ie(i.array,s)&&(t="cell"+s.toString()),s-=1;return this.path.push({relation:t,offset:Ie(i.array,s+=1).length-1}),void this.setSelection(-1,0,t)}for(t="superscript";t;){if(Array.isArray(i[t]))return this.path.push({relation:t,offset:i[t].length-1}),void this.setSelection(-1,0,t);t=e[t]}}this.setSelection(this.anchorOffset()-1),!t.iterateAll&&this.sibling(0)&&this.sibling(0).skipBoundary&&this.previous(t)},Ne.prototype.move=function(t,e){const i=(e=e||{extend:!1}).extend||!1;if(this.removeSuggestion(),i)this.extend(t,e);else{const e=Le(this);if(t>0)for(this.collapseForward()&&t--;t>0;)this.next(),t--;else if(t<0)for(this.collapseBackward()&&t++;0!==t;)this.previous(),t++;this._announce("move",e)}},Ne.prototype.up=function(t){const e=(t=t||{extend:!1}).extend||!1;this.collapseBackward();const i=this.relation();if("denom"===i)e?(this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange()):this.setSelection(this.anchorOffset(),0,"numer"),this._announce("moveUp");else if(this.parent().array){let e=je(this.parent().array,i);(e=Fe(this.parent().array,e,-1))&&Ie(e)?(this.path[this.path.length-1].relation="cell"+De(this.parent().array,e),this.setSelection(this.anchorOffset()),this._announce("moveUp")):this.move(-1,t)}else this._announce("line")},Ne.prototype.down=function(t){const e=(t=t||{extend:!1}).extend||!1;this.collapseForward();const i=this.relation();if("numer"===i)e?(this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange()):this.setSelection(this.anchorOffset(),0,"denom"),this._announce("moveDown");else if(this.parent().array){let e=je(this.parent().array,i);(e=Fe(this.parent().array,e,1))&&Ie(e)?(this.path[this.path.length-1].relation="cell"+De(this.parent().array,e),this.setSelection(this.anchorOffset()),this._announce("moveDown")):this.move(1,t)}else this._announce("line")},Ne.prototype.extend=function(t){let e=this.path[this.path.length-1].offset,i=0;const s=Le(this),n=e+(i=this.extent+t);if(n<0&&0!==i){if(this.path.length>1)return this.selectionWillChange(),this.path.pop(),this.setExtent(-1),this.selectionDidChange(),void this._announce("move",s);e=this.path[this.path.length-1].offset,i=this.extent}else if(n>=this.siblings().length){if(this.path.length>1)return this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange(),void this._announce("move",s);this.isCollapsed()&&(e-=1),i-=1}this.setSelection(e,i),this._announce("move",s)},Ne.prototype.skip=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=t<0?-1:1;const s=Le(this),n=this.siblings(),r=this.focusOffset();let o=r+t;if(i&&(o=Math.min(Math.max(0,o),n.length-1)),o<0||o>=n.length)this.move(t,e);else{if(n[o]&&"text"===n[o].mode){if((o=this.wordBoundaryOffset(o,t))<0&&!i)return void this.setSelection(0);if(o>n.length)return this.setSelection(n.length-1),void this.move(t,e)}else{const e=n[o]?n[o].type:"";if("mopen"===e&&t>0||"mclose"===e&&t<0){let i="mopen"===e?1:-1;for(o+=t>0?1:-1;o>=0&&o<n.length&&0!==i;)"mopen"===n[o].type?i+=1:"mclose"===n[o].type&&(i-=1),o+=t;0!==i&&(o=r+t),t>0&&(o-=1)}else{for(;n[o]&&"math"===n[o].mode&&n[o].type===e;)o+=t;o-=t>0?1:0}}if(i){const t=this.anchorOffset();this.setSelection(t,o-t)}else this.setSelection(o);this._announce("move",s)}},Ne.prototype.jump=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=t<0?-1:1;const s=this.siblings();let n=this.focusOffset();t>0&&(n=Math.min(n+1,s.length-1));const r=t<0?0:s.length-1;i?this.extend(r-n):this.move(r-n)},Ne.prototype.jumpToMathFieldBoundary=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=(t=t||1)<0?-1:1;const s=Le(this),n=[{relation:"body",offset:this.path[0].offset}];let r;i?t<0?n[0].offset>0&&(r=-n[0].offset):n[0].offset<this.siblings().length-1&&(r=this.siblings().length-1-n[0].offset):(n[0].offset=t<0?0:this.root.body.length-1,r=0),this.setPath(n,r),this._announce("move",s)},Ne.prototype.leap=function(t,e){t=(t=t||1)<0?-1:1,e=e||!0;const i=this.suppressChangeNotifications;this.suppressChangeNotifications=!0;const s=Le(this),n=this.extent;this.move(t),"placeholder"===this.anchor().type&&this.move(t);const r=this.filter((t,e)=>"placeholder"===e.type||t.length>1&&1===this.siblings().length,t);if(0===r.length){if(this.setPath(s,n),e)if(this.config.onTabOutOf)this.config.onTabOutOf(this.target,t>0?"forward":"backward");else if(document.activeElement){const e=Array.prototype.filter.call(document.querySelectorAll('a[href]:not([disabled]),\n                    button:not([disabled]),\n                    textarea:not([disabled]),\n                    input[type=text]:not([disabled]),\n                    select:not([disabled]),\n                    [contentEditable="true"],\n                    [tabindex]:not([disabled]):not([tabindex="-1"])'),t=>(t.offsetWidth>0||t.offsetHeight>0)&&!t.contains(document.activeElement)||t===document.activeElement);let i=e.indexOf(document.activeElement)+t;i<0&&(i=e.length-1),i>=e.length&&(i=0),e[i].focus()}return this.suppressChangeNotifications=i,!1}return this.selectionWillChange(),this.setPath(r[0]),"placeholder"===this.anchor().type&&this.setExtent(-1),this._announce("move",s),this.selectionDidChange(),this.suppressChangeNotifications=i,!0},Ne.prototype.anchorMode=function(){const t=this.isCollapsed()?this.anchor():this.sibling(1);let e;if(t){if("commandliteral"===t.type||"command"===t.type)return"command";e=t.mode}let i=1,s=this.ancestor(i);for(;!e&&s;)s&&(e=s.mode),s=this.ancestor(i+=1);return e},Ne.prototype.anchorStyle=function(){const t=this.isCollapsed()?this.anchor():this.sibling(1);let e;if(t&&"first"!==t.type){if("commandliteral"===t.type||"command"===t.type)return{};e={color:t.color,backgroundColor:t.backgroundColor,fontFamily:t.fontFamily,fontShape:t.fontShape,fontSeries:t.fontSeries,fontSize:t.fontSize}}let i=1,s=this.ancestor(i);for(;!e&&s;)s&&(e={color:s.color,backgroundColor:s.backgroundColor,fontFamily:s.fontFamily,fontShape:s.fontShape,fontSeries:s.fontSeries,fontSize:s.fontSize}),s=this.ancestor(i+=1);return e},Ne.prototype.simplifyParen=function(t){if(t&&this.config.removeExtraneousParentheses){for(let e=0;t[e];e++)if("leftright"===t[e].type&&"("===t[e].leftDelim&&Array.isArray(t[e].body)){let i=0,s=0,n=0;for(let r=0;t[e].body[r];r++)"genfrac"===t[e].body[r].type&&(i++,s=r),"first"!==t[e].body[r].type&&n++;0===n&&1===i&&(t[e]=t[e].body[s])}t.forEach(t=>{if("genfrac"===t.type&&(this.simplifyParen(t.numer),this.simplifyParen(t.denom),t.numer=Xe(t.numer),t.denom=Xe(t.denom)),t.superscript&&(this.simplifyParen(t.superscript),t.superscript=Xe(t.superscript)),t.subscript&&(this.simplifyParen(t.subscript),t.subscript=Xe(t.subscript)),t.underscript&&(this.simplifyParen(t.underscript),t.underscript=Xe(t.underscript)),t.overscript&&(this.simplifyParen(t.overscript),t.overscript=Xe(t.overscript)),t.index&&(this.simplifyParen(t.index),t.index=Xe(t.index)),"surd"===t.type?(this.simplifyParen(t.body),t.body=Xe(t.body)):t.body&&Array.isArray(t.body)&&this.simplifyParen(t.body),t.array)for(let e=Re(t.array);e>=0;e--)this.simplifyParen(Ie(t.array,e))})}},Ne.prototype.insert=function(t,e){if((e=e||{}).smartFence&&this._insertSmartFence(t,e.style))return;const i=this.suppressChangeNotifications;e.suppressChangeNotifications&&(this.suppressChangeNotifications=!0),this.contentWillChange();const s=this.suppressChangeNotifications;this.suppressChangeNotifications=!0,e.insertionMode||(e.insertionMode="replaceSelection"),e.selectionMode||(e.selectionMode="placeholder"),e.format||(e.format="auto"),e.macros=e.macros||this.config.macros;const n=e.mode||this.anchorMode();let r;const o=[this.getSelectedAtoms()];void 0!==e.placeholder&&(o["?"]=e.placeholder),"replaceSelection"!==e.insertionMode||this.isCollapsed()?"replaceAll"===e.insertionMode?(this.root.body.splice(1),this.path=[{relation:"body",offset:0}],this.extent=0):"insertBefore"===e.insertionMode?this.collapseBackward():"insertAfter"===e.insertionMode&&this.collapseForward():this.delete_();const a=this.siblings(),l=this.startOffset();if(l+1<a.length&&a[l+1]&&"placeholder"===a[l+1].type?this.delete_(1):l>0&&a[l]&&"placeholder"===a[l].type&&this.delete_(-1),"math"===n&&"ASCIIMath"===e.format)t=Ue(t,{...this.config,format:"ASCIIMath"}),r=Ce.parseTokens(v.tokenize(t),"math",null,e.macros,!1),this.simplifyParen(r);else if("text"!==n&&"auto"===e.format)if("command"===n){r=[];for(const e of t)Rt.COMMAND_MODE_CHARACTERS.test(e)&&r.push(new pe.MathAtom("command","command",e))}else""===t?r=[new pe.MathAtom("command","command","\\")]:(t=Ue(t,this.config),o[0]?t=t.replace(/(^|[^\\])#@/g,"$1#0"):/(^|[^\\])#@/.test(t)?(t=t.replace(/(^|[^\\])#@/g,"$1#0"),o[0]=this.extractArgBeforeInsertionPoint(),this._deleteAtoms(-o[0].length),Array.isArray(o[0])&&0===o[0].length&&(o[0]=void 0)):t=t.replace(/(^|[^\\])#@/g,"$1#?"),r=Ce.parseTokens(v.tokenize(t),n,o,e.macros,e.smartFence),this.simplifyParen(r));else"latex"===e.format?r=Ce.parseTokens(v.tokenize(t),n,o,e.macros,e.smartFence):"text"!==n&&"text"!==e.format||(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"\\textbackslash ")).replace(/#/g,"\\#")).replace(/\$/g,"\\$")).replace(/%/g,"\\%")).replace(/&/g,"\\&")).replace(/_/g,"\\_")).replace(/{/g,"\\textbraceleft ")).replace(/}/g,"\\textbraceright ")).replace(/\^/g,"\\textasciicircum ")).replace(/~/g,"\\textasciitilde ")).replace(/£/g,"\\textsterling "),r=Ce.parseTokens(v.tokenize(t),"text",o,e.macros,!1));!function t(e,i){e&&i&&(Array.isArray(e)?e.forEach(e=>t(e,i)):"object"==typeof e&&(e.color||e.backgroundColor||e.fontFamily||e.fontShape||e.fontSeries||e.fontSize||(e.applyStyle(i),t(e.body,i),t(e.numer,i),t(e.denom,i),t(e.index,i),t(e.overscript,i),t(e.underscript,i),t(e.subscript,i),t(e.superscript,i))))}(r,e.style);const h=this.parent();if(this.config.removeExtraneousParentheses&&h&&"leftright"===h.type&&"("===h.leftDelim&&r&&1===r.length&&"genfrac"===r[0].type?(this.path.pop(),this.siblings()[this.anchorOffset()]=r[0]):Array.prototype.splice.apply(this.siblings(),[this.anchorOffset()+1,0].concat(r)),this.insertFirstAtom(),this.suppressChangeNotifications=s,"placeholder"===e.selectionMode){let t=[];for(const e of r)t=t.concat(e.filter(t=>"placeholder"===t.type));0!==t.length&&this.leap(1,!1)?this._announce("move"):this.setSelection(this.anchorOffset()+r.length)}else"before"===e.selectionMode||("after"===e.selectionMode?this.setSelection(this.anchorOffset()+r.length):"item"===e.selectionMode&&this.setSelection(this.anchorOffset(),r.length));this.contentDidChange(),this.suppressChangeNotifications=i},Ne.prototype._insertSmartFence=function(t,e){const i=this.parent();if("leftright"===i.type&&"|"!==i.leftDelim&&/\||\\vert|\\Vert|\\mvert|\\mid/.test(t))return this.insert("\\,\\middle"+t+"\\, ",{mode:"math",format:"latex",style:e}),!0;"{"!==t&&"\\{"!==t||(t="\\lbrace"),"}"!==t&&"\\}"!==t||(t="\\rbrace"),"["!==t&&"\\["!==t||(t="\\lbrack"),"]"!==t&&"\\]"!==t||(t="\\rbrack");const s=Rt.RIGHT_DELIM[t];if(s&&("leftright"!==i.type||"|"!==i.leftDelim)){let i="";const n=this.isCollapsed()||"placeholder"===this.anchor().type;i=this.sibling(0).isFunction?"\\mleft"+t+"\\mright":"\\left"+t+"\\right",i+=n?"?":s;let r=[];return n&&(r=this.siblings().splice(this.anchorOffset()+1,this.siblings().length)),this.insert(i,{mode:"math",format:"latex",style:e}),n&&(this.sibling(0).body=r,this.move(-1)),!0}let n;if(Object.keys(Rt.RIGHT_DELIM).forEach(e=>{t===Rt.RIGHT_DELIM[e]&&(n=e)}),n){if(i&&"leftright"===i.type&&this.endOffset()===this.siblings().length-1)return this.contentWillChange(),i.rightDelim=t,this.move(1),this.contentDidChange(),!0;const s=this.siblings();let n;for(n=this.endOffset();n>=0&&("leftright"!==s[n].type||"?"!==s[n].rightDelim);n--);if(n>=0)return this.contentWillChange(),s[n].rightDelim=t,s[n].body=s[n].body.concat(s.slice(n+1,this.endOffset()+1)),s.splice(n+1,this.endOffset()-n),this.setSelection(n),this.contentDidChange(),!0;if(i&&"leftright"===i.type&&"?"===i.rightDelim){this.contentWillChange(),i.rightDelim=t;const e=s.slice(this.endOffset()+1);return s.splice(this.endOffset()+1),this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.endOffset()+1,0].concat(e)),this.contentDidChange(),!0}const r=this.ancestor(2);return r&&"leftright"===r.type&&"?"===r.rightDelim&&this.endOffset()===s.length-1?(this.move(1),this._insertSmartFence(t,e)):(this.insert(t,{mode:"math",format:"latex",style:e}),!0)}return!1},Ne.prototype.positionInsertionPointAfterCommitedCommand=function(){const t=this.siblings(),e=this.commandOffsets();let i=e.start;for(;i<e.end&&!t[i].suggestion;)i++;this.setSelection(i-1)},Ne.prototype.removeSuggestion=function(){const t=this.siblings();for(let e=t.length-1;e>=0;e--)t[e].suggestion&&t.splice(e,1)},Ne.prototype.insertSuggestion=function(t,e){this.removeSuggestion();const i=[],s=t.substr(e);for(const n of s){const t=new pe.MathAtom("command","command",n);t.suggestion=!0,i.push(t)}Array.prototype.splice.apply(this.siblings(),[this.anchorOffset()+1,0].concat(i))},Ne.prototype._deleteAtoms=function(t){t>0?this.siblings().splice(this.anchorOffset()+1,t):(this.siblings().splice(this.anchorOffset()+t+1,-t),this.setSelection(this.anchorOffset()+t))},Ne.prototype.delete=function(t){if(0===(t=t||0))this.delete_(0);else if(t>0)for(;t>0;)this.delete_(1),t--;else for(;t<0;)this.delete_(-1),t++},Ne.prototype.delete_=function(t){this.contentWillChange(),this.selectionWillChange();const e=this.suppressChangeNotifications;if(this.suppressChangeNotifications=!0,t=(t=t||0)<0?-1:t>0?1:t,this.removeSuggestion(),this.parent().array&&t<0&&0===this.startOffset()){const t=this.parent().array;if(function(t){const e={col:0,row:0};for(;e.row<t.length&&!Ie(t,e);)e.row+=1;return Ie(t,e)?"cell"+De(t,e):""}(t)===this.relation()){const e=function(t,e,i){e||(e=[";",","]);let s,n=[];for(const r of t)s?n.push(s):s=new pe.MathAtom("math","mpunct",e[0],void 0),n=n.concat(Be(r,e[1]));return n}(t);this.path.pop(),this.siblings().splice(this.anchorOffset(),1,...e),this.setSelection(this.anchorOffset()-1,e.length)}else{const e=je(t,this.relation());if(0===e.col){const i=Fe(t,e,-1);i.col=t[i.row].length-1,this.path[this.path.length-1].relation="cell"+De(t,i);const s=t[i.row][i.col].length,n=Be(t[e.row]);t[i.row][i.col]=t[i.row][i.col].concat(n),this.setSelection(s-1,n.length),function(t,e){t.splice(e,1)}(t,e.row)}else 0===function(t,e){let i=0;const s={col:e,row:0};for(;s.row<t.length;){const e=Ie(t,s);if(e&&e.length>0){let t=e.length;"first"===e[0].type&&(t-=1),t>0&&(i+=1)}s.row+=1}return i}(t,e.col)&&(function(t,e){let i=0;for(;i<t.length;)t[i][e]&&t[i].splice(e,1),i+=1}(t,e.col),e.col-=1,this.path[this.path.length-1].relation="cell"+De(t,e),this.setSelection(t[e.row][e.col].length-1,0))}return this.suppressChangeNotifications=e,this.selectionDidChange(),void this.contentDidChange()}const i=this.siblings();if(this.isCollapsed()){const e=this.anchorOffset();if(t<0)if(0!==e){const t=this.sibling(0);"leftright"===t.type?(t.rightDelim="?",this.move(-1)):!t.captureSelection&&/^(group|array|genfrac|surd|leftright|overlap|overunder|box|mathstyle|sizing)$/.test(t.type)?this.move(-1):(this._announce("delete",null,i.slice(e,e+1)),i.splice(e,1),this.setSelection(e-1))}else{const t=this.relation();if("superscript"===t||"subscript"===t){const e=this.parent()[t].filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.parent()[t]=null,this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(e)),this.setSelection(this.anchorOffset()-1),this._announce("deleted: "+t)}else if("denom"===t){const t=this.parent().numer.filter(t=>"placeholder"!==t.type&&"first"!==t.type),e=this.parent().denom.filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(e)),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(t)),this.setSelection(this.anchorOffset()+t.length-1),this._announce("deleted: denominator")}else if("body"===t){const t=this.siblings().filter(t=>"placeholder"!==t.type);this.path.length>1&&(t.shift(),this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(t)),this.setSelection(this.anchorOffset()-1),this._announce("deleted: root"))}else this.move(-1),this.delete(-1)}else if(t>0)if(e!==i.length-1)/^(group|array|genfrac|surd|leftright|overlap|overunder|box|mathstyle|sizing)$/.test(this.sibling(1).type)?this.move(1):(this._announce("delete",null,i.slice(e+1,e+2)),i.splice(e+1,1));else if("numer"===this.relation()){const t=this.parent().numer.filter(t=>"placeholder"!==t.type&&"first"!==t.type),e=this.parent().denom.filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(e)),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(t)),this.setSelection(this.anchorOffset()+t.length-1),this._announce("deleted: numerator")}else this.move(1),this.delete(1)}else{const t=this.startOffset()+1,e=this.endOffset()+1;this._announce("deleted",null,i.slice(t,e)),i.splice(t,e-t),this.setSelection(t-1)}this.suppressChangeNotifications=e,this.selectionDidChange(),this.contentDidChange()},Ne.prototype.moveToNextPlaceholder_=function(){this.leap(1)},Ne.prototype.moveToPreviousPlaceholder_=function(){this.leap(-1)},Ne.prototype.moveToNextChar_=function(){this.move(1)},Ne.prototype.moveToPreviousChar_=function(){this.move(-1)},Ne.prototype.moveUp_=function(){this.up()},Ne.prototype.moveDown_=function(){this.down()},Ne.prototype.moveToNextWord_=function(){this.skip(1)},Ne.prototype.moveToPreviousWord_=function(){this.skip(-1)},Ne.prototype.moveToGroupStart_=function(){this.setSelection(0)},Ne.prototype.moveToGroupEnd_=function(){this.setSelection(-1)},Ne.prototype.moveToMathFieldStart_=function(){this.jumpToMathFieldBoundary(-1)},Ne.prototype.moveToMathFieldEnd_=function(){this.jumpToMathFieldBoundary(1)},Ne.prototype.deleteNextChar_=function(){this.delete_(1)},Ne.prototype.deletePreviousChar_=function(){this.delete_(-1)},Ne.prototype.deleteNextWord_=function(){this.extendToNextBoundary(),this.delete_()},Ne.prototype.deletePreviousWord_=function(){this.extendToPreviousBoundary(),this.delete_()},Ne.prototype.deleteToGroupStart_=function(){this.extendToGroupStart(),this.delete_()},Ne.prototype.deleteToGroupEnd_=function(){this.extendToMathFieldStart(),this.delete_()},Ne.prototype.deleteToMathFieldEnd_=function(){this.extendToMathFieldEnd(),this.delete_()},Ne.prototype.transpose_=function(){},Ne.prototype.extendToNextChar_=function(){this.extend(1)},Ne.prototype.extendToPreviousChar_=function(){this.extend(-1)},Ne.prototype.extendToNextWord_=function(){this.skip(1,{extend:!0})},Ne.prototype.extendToPreviousWord_=function(){this.skip(-1,{extend:!0})},Ne.prototype.extendUp_=function(){this.up({extend:!0})},Ne.prototype.extendDown_=function(){this.down({extend:!0})},Ne.prototype.extendToNextBoundary_=function(){this.skip(1,{extend:!0})},Ne.prototype.extendToPreviousBoundary_=function(){this.skip(-1,{extend:!0})},Ne.prototype.extendToGroupStart_=function(){this.setExtent(-this.anchorOffset())},Ne.prototype.extendToGroupEnd_=function(){this.setExtent(this.siblings().length-this.anchorOffset())},Ne.prototype.extendToMathFieldStart_=function(){this.jumpToMathFieldBoundary(-1,{extend:!0})},Ne.prototype.extendToMathFieldEnd_=function(){this.jumpToMathFieldBoundary(1,{extend:!0})},Ne.prototype.moveToSuperscript_=function(){if(this.collapseForward(),!this.anchor().superscript)if(this.anchor().subscript)this.anchor().superscript=[Je()];else{const t=this.sibling(1);t&&t.superscript?this.path[this.path.length-1].offset+=1:t&&t.subscript?(this.path[this.path.length-1].offset+=1,this.anchor().superscript=[Je()]):("limits"!==this.anchor().limits&&(this.siblings().splice(this.anchorOffset()+1,0,new pe.MathAtom(this.parent().anchorMode,"msubsup","​",this.anchorStyle())),this.path[this.path.length-1].offset+=1),this.anchor().superscript=[Je()])}this.path.push({relation:"superscript",offset:0}),this.selectGroup_()},Ne.prototype.moveToSubscript_=function(){if(this.collapseForward(),!this.anchor().subscript)if(this.anchor().superscript)this.anchor().subscript=[Je()];else{const t=this.sibling(1);t&&t.subscript?this.path[this.path.length-1].offset+=1:t&&t.superscript?(this.path[this.path.length-1].offset+=1,this.anchor().subscript=[Je()]):("limits"!==this.anchor().limits&&(this.siblings().splice(this.anchorOffset()+1,0,new pe.MathAtom(this.parent().anchorMode,"msubsup","​",this.anchorStyle())),this.path[this.path.length-1].offset+=1),this.anchor().subscript=[Je()])}this.path.push({relation:"subscript",offset:0}),this.selectGroup_()},Ne.prototype.moveToOpposite_=function(){const t={superscript:"subscript",subscript:"superscript",denom:"numer",numer:"denom"}[this.relation()];t||this.moveToSuperscript_(),this.parent()[t]||(this.parent()[t]=[Je()]),this.setSelection(0,"end",t)},Ne.prototype.moveBeforeParent_=function(){this.path.length>1?(this.path.pop(),this.setSelection(this.anchorOffset()-1)):this._announce("plonk")},Ne.prototype.moveAfterParent_=function(){if(this.path.length>1){const t=Le(this);this.path.pop(),this.setExtent(0),this._announce("move",t)}else this._announce("plonk")},Ne.prototype._addCell=function(t){const e=this.parent();if(e&&"array"===e.type&&Array.isArray(e.array)){const i=this.relation();if(e.array){const s=je(e.array,i);"after row"===t||"before row"===t?(s.col=0,s.row=s.row+("after row"===t?1:0),e.array.splice(s.row,0,[[]])):(s.col+="after column"===t?1:0,e.array[s.row].splice(s.col,0,[]));const n=De(e.array,s);this.path.pop(),this.path.push({relation:"cell"+n.toString(),offset:0}),this.insertFirstAtom()}}},Ne.prototype.convertParentToArray=function(){const t=this.parent();if("leftright"===t.type){t.type="array";const e={"(":"pmatrix","\\lbrack":"bmatrix","\\lbrace":"cases"}[t.leftDelim]||"matrix",i=Rt.getEnvironmentInfo(e),s=[[t.body]];i.parser&&Object.assign(t,i.parser(e,[],s)),t.tabularMode=i.tabular,t.parseMode=this.anchorMode(),t.env={...i},t.env.name=e,t.array=s,t.rowGaps=[0],delete t.body,this.path[this.path.length-1].relation="cell0"}},Ne.prototype.addRowAfter_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("after row"),this.contentDidChange()},Ne.prototype.addRowBefore_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("before row"),this.contentDidChange()},Ne.prototype.addColumnAfter_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("after column"),this.contentDidChange()},Ne.prototype.addColumnBefore_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("before column"),this.contentDidChange()},Ne.prototype._applyStyle=function(t){if(this.isCollapsed())return;const e=this;function i(t,i){let s=!0;return e.forEachSelected(e=>{s=s&&e[t]===i},{recursive:!0}),s}t.color&&i("color",t.color)&&(t.color="none"),t.backgroundColor&&i("backgroundColor",t.backgroundColor)&&(t.backgroundColor="none"),t.fontFamily&&i("fontFamily",t.fontFamily)&&(t.fontFamily="none"),t.series&&(t.fontSeries=t.series),t.fontSeries&&i("fontSeries",t.fontSeries)&&(t.fontSeries="auto"),t.shape&&(t.fontShape=t.shape),t.fontShape&&i("fontShape",t.fontShape)&&(t.fontShape="auto"),t.size&&(t.fontSize=t.size),t.fontSize&&i("fontSize",t.fontSize)&&(t.fontSize="size5"),this.contentWillChange(),this.forEachSelected(e=>e.applyStyle(t),{recursive:!0}),this.contentDidChange()};var Ve={EditableMathlist:Ne,parseMathString:Ue};const $e={"#":"#","|":"|","[":"BracketLeft","]":"BracketRight","-":"Minus","+":"Plus","=":"Equal","/":"Slash","\\":"Backslash"},We={Space:"Spacebar"," ":"Spacebar",Escape:"Esc",ArrowLeft:"Left",ArrowUp:"Up",ArrowRight:"Right",ArrowDown:"Down",Delete:"Del"},Ke={q:"KeyQ",w:"KeyW",e:"KeyE",r:"KeyR",t:"KeyT",y:"KeyY",u:"KeyU",i:"KeyI",o:"KeyO",p:"KeyP",a:"KeyA",s:"KeyS",d:"KeyD",f:"KeyF",g:"KeyG",h:"KeyH",j:"KeyJ",k:"KeyK",l:"KeyL",z:"KeyZ",x:"KeyX",c:"KeyC",v:"KeyV",b:"KeyB",n:"KeyN",m:"KeyM",1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",0:"Digit0","!":"Shift-Digit1","@":"Shift-Digit2","#":"Shift-Digit3",$:"Shift-Digit4","%":"Shift-Digit5","^":"Shift-Digit6","&":"Shift-Digit7","*":"Shift-Digit8","(":"Shift-Digit9",")":"Shift-Digit0","-":"Minus",_:"Shift-Minus","/":"Slash","\\":"Backslash","|":"Shift-Backslash","?":"Shift-Slash"," ":"Spacebar"};function Ze(t){let e,i=!0;"Unidentified"===t.key&&t.target&&(e=Ke[t.target.value]||t.target.value),e||($e[t.key]?(e=$e[t.key],i=!1):e=We[t.key],e||(e=Ke[t.key.toLowerCase()]||t.key)),!e&&t.code&&(e=We[t.code]||t.code);const s=[];return t.ctrlKey&&s.push("Ctrl"),t.metaKey&&s.push("Meta"),i&&t.altKey&&s.push("Alt"),i&&t.shiftKey&&s.push("Shift"),0===s.length?e:(s.push(e),s.join("-"))}function Qe(t,e){let i,s=null,n=null,r=!1,o=!1;function a(t){clearTimeout(i),i=setTimeout((function(){clearTimeout(i),t()}))}function l(){if(function(t){return t.selectionStart!==t.selectionEnd}(t))return;const i=t.value;t.value="",i.length>0&&e.typedText(i)}const h=t||e.container;h.addEventListener("keydown",(function(i){if("function"==typeof e.allowDeadKey&&e.allowDeadKey()||"Dead"!==i.key&&"Unidentified"!==i.key&&229!==i.keyCode)o=!1;else{o=!0,r=!1;const i=e.blur,s=e.focus;e.blur=null,e.focus=null,t.blur(),t.focus(),e.blur=i,e.focus=s}return!(!r&&"CapsLock"!==i.code&&!/(Control|Meta|Alt|Shift)(Right|Left)/.test(i.code))||(s=i,n=null,e.keystroke(Ze(i),i))}),!0),h.addEventListener("keypress",(function(t){r||(s&&n&&e.keystroke(Ze(s),s),n=t,a(l))}),!0),h.addEventListener("keyup",(function(){r||!s||n||l()}),!0),h.addEventListener("paste",(function(){t.focus();const i=t.value;t.value="",i.length>0&&e.paste(i)}),!0),h.addEventListener("copy",(function(t){e.copy&&e.copy(t)}),!0),h.addEventListener("cut",(function(t){e.cut&&e.cut(t)}),!0),h.addEventListener("blur",(function(){s=null,n=null,e.blur&&e.blur()}),!0),h.addEventListener("focus",(function(){e.focus&&e.focus()}),!0),h.addEventListener("compositionstart",()=>{r=!0},!0),h.addEventListener("compositionend",()=>{r=!1,a(l)},!0),h.addEventListener("input",()=>{if(o){const i=e.blur,s=e.focus;e.blur=null,e.focus=null,t.blur(),t.focus(),e.blur=i,e.focus=s,o=!1,r=!1,a(l)}else r||a(l)})}var ti={delegateKeyboardEvents:Qe,select:Qe.select,keyboardEventToString:Ze,eventToChar:function(t){if(!t)return"";let e;return"Unidentified"===t.key&&t.target&&(e=t.target.value),/^(Return|Enter|Tab|Escape|Delete|PageUp|PageDown|Home|End|Help|ArrowLeft|ArrowRight|ArrowUp|ArrowDown)$/.test(e=e||t.key||t.code)&&(e=""),e},charToEvent:function(t){return{key:t,metaKey:!1,ctrlKey:!1,altKey:!1,shiftKey:!1}}},ei={UndoManager:class{constructor(t){this.mathlist=t,this.maximumDepth=1e3,this.record=!1,this.canCoalesce=!1,this.reset()}reset(){this.stack=[],this.index=-1}startRecording(){this.record=!0}canUndo(){return this.index>0}canRedo(){return this.index!==this.stack.length-1}undo(t){this.canUndo()&&(t&&"function"==typeof t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"undo"),this.restore(this.stack[this.index-1],t),this.index-=1,t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"undo"),this.canCoalesce=!1)}redo(t){this.canRedo()&&(t&&"function"===t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"redo"),this.index+=1,this.restore(this.stack[this.index],t),t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"redo"),this.canCoalesce=!1)}pop(){this.canUndo()&&(this.index-=1,this.stack.pop())}snapshot(t){this.record&&(t&&"function"===t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"snapshot"),this.stack.splice(this.index+1,this.stack.length-this.index-1),this.stack.push({latex:this.mathlist.root.toLatex(),selection:this.mathlist.toString()}),this.index++,this.stack.length>this.maximumDepth&&this.stack.shift(),t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"snapshot"),this.canCoalesce=!1)}snapshotAndCoalesce(t){this.canCoalesce&&this.pop(),this.snapshot(t),this.canCoalesce=!0}save(){return{latex:this.mathlist.root.toLatex(),selection:this.mathlist.toString()}}restore(t,e){const i=this.mathlist.suppressChangeNotifications;void 0!==e.suppressChangeNotifications&&(this.mathlist.suppressChangeNotifications=e.suppressChangeNotifications),this.mathlist.insert(t?t.latex:"",{mode:"math",insertionMode:"replaceAll",selectionMode:"after",format:"latex",...e}),this.mathlist.setPath(t?t.selection:[{relation:"body",offset:0}]),this.mathlist.suppressChangeNotifications=i}}};const ii={"\\mathrm":"\\mathrm{x=+3.14, x\\in A}","\\mathbf":"\\mathbf{x=+3.14, x\\in A}","\\bf":"\\bf{x=+3.14, x\\in A}","\\bm":"\\bm{x=+3.14, x\\in A}","\\bold":"\\bold{x=+3.14, x\\in A}","\\mathit":"\\mathbb{x=+3.14}","\\mathbb":"\\mathbb{ABCD}","\\Bbb":"\\mathbb{ABCD}","\\frak":"\\frak{ABCD}","\\mathfrak":"\\mathfrak{ABCD}","\\mathscr":"\\mathscr{ABCD}","\\mathsf":"\\mathsf{ABab01}","\\mathtt":"\\mathtt{x=+3.14, x\\in A}","\\mathcal":"\\mathcal{ABCD}","\\boldsymbol":"\\boldsymbol{ABab01+=}","\\text":"\\text{ABC abc}","\\textrm":"\\textrm{ABC abc}","\\textnormal":"\\textnormal{ABC abc}","\\textit":"\\textit{ABC abc}","\\textbf":"\\textbf{ABC abc}","\\texttt":"\\texttt{ABC abc}","\\textsf":"\\textsf{ABC abc}","\\textcolor":"{\\textcolor{m0}A}{\\textcolor{m1}B}{\\textcolor{m2}C }{\\textcolor{m3}a}{\\textcolor{m4}b}{\\textcolor{m5}c}{\\textcolor{m6}8}","\\color":"{\\color{m0}A}{\\color{m1}B}{\\color{m2}C}{\\color{m3}a}{\\color{m4}b}{\\color{m5}c}{\\color{m6}8}","\\underline":'\\underline{\\unicode{"2B1A}}',"\\overline":'\\overline{\\unicode{"2B1A}}',"\\vec":'\\vec{\\unicode{"25CC}}',"\\check":'\\check{\\unicode{"25CC}}',"\\acute":'\\acute{\\unicode{"25CC}}',"\\breve":'\\breve{\\unicode{"25CC}}',"\\tilde":'\\tilde{\\unicode{"25CC}}',"\\hat":'\\hat{\\unicode{"25CC}}',"\\ddot":'\\ddot{\\unicode{"25CC}}',"\\dot":'\\dot{\\unicode{"25CC}}',"\\bar":'\\bar{\\unicode{"25CC}}',"\\!":'\\unicode{"203A}\\!\\unicode{"2039}',"\\,":'\\unicode{"203A}\\,\\unicode{"2039}',"\\:":'\\unicode{"203A}\\:\\unicode{"2039}',"\\;":'\\unicode{"203A}\\;\\unicode{"2039}',"\\quad":'\\unicode{"203A}\\quad\\unicode{"2039}',"\\qquad":'\\unicode{"203A}\\qquad\\unicode{"2039}',"\\enskip":'\\unicode{"203A}\\enskip\\unicode{"2039}',"\\space":'\\unicode{"203A}\\space\\unicode{"2039}',"\\frac":'\\frac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\dfrac":'\\dfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\cfrac":'\\cfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\tfrac":'\\tfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\dbinom":'\\dbinom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\tbinom":'\\tbinom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\binom":'\\binom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\pdiff":'\\pdiff{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\in":"n\\in\\N","\\notin":"n\\notin\\N","\\not":"B \\not A","\\ni":"N\\in n","\\owns":"N\\owns n","\\subset":"A\\subset B","\\supset":"B\\supset A","\\subseteq":"A\\subseteq B","\\supseteq":"B\\supseteq A","\\nsubseteq":"A\\nsubseteq B","\\nsupseteq":"B\\nsupseteq A","\\subsetneq":"A\\subsetneq B","\\supsetneq":"B\\supsetneq A","\\varsubsetneq":"A\\varsubsetneq B","\\varsupsetneq":"B\\varsupsetneq A","\\nsubseteqq":"A\\varsupsetneq B","\\subsetneqq":"A\\subsetneqq B","\\varsubsetneqq":"A\\varsubsetneqq B","\\nsubset":"A\\nsubset B","\\nsupset":"B\\nsupset A","\\complement":"A^\\complement","\\bigcup":'\\bigcup_{\\unicode{"2B1A}}',"\\bigcap":'\\bigcap_{\\unicode{"2B1A}}',"\\sqrt":'\\sqrt{\\unicode{"2B1A}}',"\\prod":'\\prod_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\sum":'\\sum_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\int":'\\int_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\stackrel":'\\stackrel{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\stackbin":'\\stackbin{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\underset":'\\underset{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\overset":'\\overset{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\prime":'\\unicode{"2B1A}^{\\prime}',"\\boxed":'\\boxed{\\unicode{"2B1A}}',"\\colorbox":'\\colorbox{#fbc0bd}{\\unicode{"2B1A}}',"\\bbox":'\\bbox[#ffd400, solid 2px #ffd400]{\\unicode{"2B1A}}',"\\enclose":'\\enclose{updiagonalstrike,roundedbox}[1px solid red, mathbackground="#fbc0bd"]{23+45}',"\\fcolorbox":'\\fcolorbox{#cd0030}{#ffd400}{\\unicode{"2B1A}}',"\\ ":'\\char"2423',"\\top":"{\\color{red}P}\\top","\\bot":"{\\color{#0F0}P}\\bot","\\mid":"P(p\\mid q)","\\rlap":"\\rlap{x}o","\\llap":"o\\llap{/}"},si={"\\text":"roman text","\\textrm":"roman text","\\textnormal":"roman text","\\textit":"italic text","\\textbf":"bold text","\\texttt":"monospaced text","\\textsf":"sans-serif text","\\mathrm":["roman","(upright)"],"\\mathbf":"bold","\\bf":"bold","\\bold":"bold","\\mathit":"italic","\\mathbb":"blackboard","\\Bbb":"blackboard","\\mathscr":"script","\\mathtt":["typewriter","(monospaced)"],"\\mathsf":"sans-serif","\\mathcal":"caligraphic","\\frak":["fraktur","(gothic)"],"\\mathfrak":["fraktur","(gothic)"],"\\textcolor":"text color","\\color":"color","\\forall":"for all","\\exists":"there exists","\\nexists":"there does not exist","\\frac":"fraction","\\dfrac":"display fraction","\\cfrac":"continuous fraction","\\tfrac":"text fraction","\\binom":"binomial coefficient","\\dbinom":"display binomial coefficient","\\tbinom":"text binomial coefficient","\\pdiff":"partial differential","\\vec":"vector","\\check":"caron","\\acute":"acute","\\breve":"breve","\\tilde":"tilde","\\dot":"dot","\\hat":["hat","circumflex"],"\\ddot":"double dot","\\bar":"bar","\\prime":"prime","\\doubleprime":"double prime","\\varnothing":"empty set","\\emptyset":"empty set","\\subseteq":"subset of or <br>equal to","\\supseteq":"superset of or <br>equal to","\\supset":"superset of","\\subset":"subset of","\\partial":"partial derivative","\\bigcup":"union","\\bigcap":"intersection","\\approx":"approximately equal to","\\notin":"not an element of","\\in":["element of","included in"],"\\infty":"infinity","\\land":"logical and","\\sqrt":"square root","\\prod":"product","\\sum":"summation","\\amalg":["amalgamation","coproduct","free product","disjoint union"],"\\cup":"union with","\\cap":"intersection with","\\int":"integral","\\iint":"surface integral","\\oint":"curve integral","\\iiint":"volume integral","\\iff":"if and only if","\\ln":"natural logarithm","\\boldsymbol":"bold","\\setminus":"set subtraction","\\stackrel":"relation with symbol above","\\stackbin":"operator with symbol above","\\underset":"symbol with annotation below","\\overset":"symbol with annotation above","\\hslash":["h-bar","Planck constant"],"\\gtrsim":"greater than or <br>similar to","\\propto":"proportional to","\\equiv":"equivalent to","\\!":["negative thin space","(-3 mu)"],"\\ ":["space","(6 mu)"],"\\,":["thin space","(3 mu)"],"\\:":["medium space","(4 mu)"],"\\;":["thick space","(5 mu)"],"\\quad":["1 em space","(18 mu)"],"\\qquad":["2 em space","(36 mu)"],"\\enskip":["&#189; em space","(9 mu)"],"\\mp":"minus or plus","\\pm":"plus or minus","\\Im":"Imaginary part of","\\Re":"Real part of","\\gothicCapitalR":"Real part of","\\gothicCapitalI":"Imaginary part part of","\\differentialD":"differential d","\\aleph":["aleph","infinite cardinal",'<a target="_blank" href="https://en.wikipedia.org/wiki/Cardinal_number">Wikipedia <big>&#x203A;</big></a>'],"\\beth":["beth","beth number",'<a target="_blank" href="https://en.wikipedia.org/wiki/Beth_number">Wikipedia <big>&#x203A;</big></a>'],"\\gimel":["gimel","gimel function",'<a target="_blank" href="https://en.wikipedia.org/wiki/Gimel_function">Wikipedia <big>&#x203A;</big></a>'],"\\O":"empty set","\\N":"set of <br>natural numbers","\\Z":"set of <br>integers","\\Q":"set of <br>rational numbers","\\C":"set of <br>complex numbers","\\R":"set of <br>real numbers","\\P":"set of <br>prime numbers","\\lesseqqgtr":"less than, equal to or<br> greater than","\\gnapprox":"greater than and <br>not approximately","\\lnapprox":"lesser than and <br>not approximately","\\j":"dotless j","\\i":"dotless i","\\cdot":"centered dot","\\lmoustache":"left moustache","\\rmoustache":"right moustache","\\nabla":["nabla","del","differential vector operator"],"\\square":["square","d’Alembert operator",'<a target="_blank" href="https://en.wikipedia.org/wiki/D%27Alembert_operator">Wikipedia <big>&#x203A;</big></a>'],"\\blacksquare":["black square","end of proof","tombstone","Halmos symbol"],"\\Box":"end of proof","\\colon":["such that","ratio"],"\\coloneq":["is defined by","is assigned"],"\\Colon":["is defined by","as"],"\\_":["underbar","underscore"],"\\ll":"much less than","\\gg":"much greater than","\\doteq":"approximately equal to","\\Doteq":"approximately equal to","\\doteqdot":"approximately equal to","\\cong":["isomorphism of","(for algebras, modules...)"],"\\det":["determinant of","(of a matrix)"],"\\dotplus":"Cartesian product algebra","\\otimes":["tensor product","(of algebras)","Kronecker product","(of matrices)"],"\\oplus":["direct sum","(of modules)"],"\\lb":"base-2 logarithm","\\lg":"base-10 logarithm","\\wp":["Weierstrass P",'<a target="_blank" href="https://en.wikipedia.org/wiki/Weierstrass%27s_elliptic_functions">Wikipedia <big>&#x203A;</big></a>'],"\\wr":["wreath product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Wreath_product">Wikipedia <big>&#x203A;</big></a>'],"\\top":["tautology","Proposition P is universally true"],"\\bot":["contradiction","Proposition P is contradictory"],"\\mid":["probability","of event A given B"],"\\mho":["Siemens","electrical conductance in SI unit",'<a target="_blank" href="https://en.wikipedia.org/wiki/Siemens_(unit)">Wikipedia <big>&#x203A;</big></a>'],"\\Longrightarrow":"implies","\\Longleftrightarrow":"if, and only if,","\\prec":"precedes","\\preceq":"precedes or is equal to","\\succ":"succeedes","\\succeq":"succeedes or is equal to","\\perp":["is perpendicular to","is independent of"],"\\models":["entails","double-turnstyle, models","is a semantic consequence of",'<a target="_blank" href="https://en.wikipedia.org/wiki/Double_turnstile">Wikipedia <big>&#x203A;</big></a>'],"\\vdash":["satisfies","turnstyle, assertion sign","syntactic inference",'<a target="_blank" href="https://en.wikipedia.org/wiki/Turnstile_(symbol)">Wikipedia <big>&#x203A;</big></a>'],"\\implies":["implies","logical consequence"],"\\impliedby":["implied by","logical consequence"],"\\surd":["surd","root of","checkmark"],"\\ltimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\rtimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\leftthreetimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\rightthreetimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\divideontimes":["divide on times"],"\\curlywedge":"nor","\\curlyvee":"nand","\\simeq":"is group isomorphic with","\\vartriangleleft":["is a normal subgroup of","is an ideal ring of"],"\\circ":["circle","ring","function composition"],"\\rlap":["overlap right","\\rlap{x}o"],"\\llap":["overlap left","o\\llap{/}"],"\\colorbox":["color box","\\colorbox{#fbc0bd}{...}"],"\\ast":["asterisk","reflexive closure (as a superscript)"],"\\bullet":"bullet","\\lim":"limit"};function ni(t){let e=si[t]||"";return Array.isArray(e)&&(e=e.join("<br>")),e}function ri(t,e){t.popover.innerHTML=e;const i=t._getCaretPosition();i&&(t.popover.style.left=i.x-t.popover.offsetWidth/2+"px",t.popover.style.top=i.y+5+"px"),t.popover.classList.add("is-visible")}function oi(t){t.popover.classList.remove("is-visible")}var ai={getNote:ni,SAMPLES:ii,NOTES:si,showPopoverWithLatex:function(t,e,i){if(!e||0===e.length)return void oi(t);const s=e,n=function(t,e){const i=Ce.parseTokens(v.tokenize(t),"math",null,e.config.macros),s=pe.decompose({mathstyle:"displaystyle",macros:e.config.macros},i),n=et.makeSpan(s,"ML__base"),r=et.makeSpan("","ML__strut");r.setStyle("height",n.height,"em");const o=et.makeSpan("","ML__strut--bottom");return o.setStyle("height",n.height+n.depth,"em"),o.setStyle("vertical-align",-n.depth,"em"),et.makeSpan([r,o,n],"ML__mathlive").toMarkup()}(ii[s]||e,t),r=ni(s),o=Oe.forCommand(s);let a=i?'<div class="ML__popover__prev-shortcut" role="button" aria-label="Previous suggestion"><span><span>&#x25B2;</span></span></div>':"";a+='<span class="ML__popover__content" role="button">',a+='<div class="ML__popover__command">'+n+"</div>",r&&(a+='<div class="ML__popover__note">'+r+"</div>"),o&&(a+='<div class="ML__popover__shortcut">'+o+"</div>"),a+="</span>",ri(t,a+=i?'<div class="ML__popover__next-shortcut" role="button" aria-label="Next suggestion"><span><span>&#x25BC;</span></span></div>':"");let l=t.popover.getElementsByClassName("ML__popover__content");l&&l.length>0&&t._attachButtonHandlers(l[0],["complete",{acceptSuggestion:!0}]),(l=t.popover.getElementsByClassName("ML__popover__prev-shortcut"))&&l.length>0&&t._attachButtonHandlers(l[0],"previousSuggestion"),(l=t.popover.getElementsByClassName("ML__popover__next-shortcut"))&&l.length>0&&t._attachButtonHandlers(l[0],"nextSuggestion")},showPopover:ri,hidePopover:oi,updatePopoverPosition:function t(e,i){if(e.popover.classList.contains("is-visible"))if(i&&i.deferred)window.requestAnimationFrame(()=>t(e));else if(e.mathlist.anchor()&&"command"===e.mathlist.anchor().type){const t=e._getCaretPosition();t&&(e.popover.style.left=t.x-e.popover.offsetWidth/2+"px",e.popover.style.top=t.y+5+"px")}else oi(e)}};function li(t,e,i){let s="";if(Array.isArray(e)&&e.length>0){if("first"===e[0].type&&0===(e=e.slice(1)).length)return"";s=function t(e,i,s,n){if(0===s.length)return"";if(0===i.length)return s.map(t=>t.toLatex(n)).join("");let r="",o="",a="";const l=i[0];let h=s[0][l];"fontFamily"===l&&(h=s[0].fontFamily||s[0].baseFontFamily);const c=function(t,e,i){let s=0;if("fontFamily"===e)for(;t[s]&&("mop"===t[s].type||(t[s].fontFamily||t[s].baseFontFamily)===i);)s++;else for(;t[s]&&("mop"===t[s].type||t[s][e]===i);)s++;return s}(s,l,h);if("text"===s[0].mode){if("fontShape"===l&&s[0].fontShape)"it"===s[0].fontShape?(o="\\textit{",a="}"):"sl"===s[0].fontShape?(o="\\textsl{",a="}"):"sc"===s[0].fontShape?(o="\\textsc{",a="}"):"n"===s[0].fontShape?(o="\\textup{",a="}"):(o="\\text{\\fontshape{"+s[0].fontShape+"}",a="}");else if("fontSeries"===l&&s[0].fontSeries)"b"===s[0].fontSeries?(o="\\textbf{",a="}"):"l"===s[0].fontSeries?(o="\\textlf{",a="}"):"m"===s[0].fontSeries?(o="\\textmd{",a="}"):(o="\\text{\\fontseries{"+s[0].fontSeries+"}",a="}");else if("mode"===l){let t=!0;for(let e=0;e<c;e++)if(!(s[e].fontSeries||s[e].fontShape||s[e].fontFamily||s[e].baseFontFamily)){t=!1;break}t||(o="\\text{",a="}")}else if("fontSize"===l&&s[0].fontSize)o="{\\"+({size1:"tiny",size2:"scriptsize",size3:"footnotesize",size4:"small",size5:"normalsize",size6:"large",size7:"Large",size8:"LARGE",size9:"huge",size10:"Huge"}[s[0].fontSize]||"")+" ",a="}";else if("fontFamily"===l&&(s[0].fontFamily||s[0].baseFontFamily)){const t={cmr:"textrm",cmtt:"texttt",cmss:"textsf"}[s[0].fontFamily||s[0].baseFontFamily]||"";t?(o="\\"+t+"{",a="}"):(o+="{\\fontfamily{"+(s[0].fontFamily||s[0].baseFontFamily)+"}",a="}")}}else if("math"===s[0].mode)if("fontSeries"===l)"b"===s[0].fontSeries?(o="\\mathbf{",a="}"):s[0].fontSeries&&"n"!==s[0].fontSeries&&(o="{\\fontSeries{"+s[0].fontSeries+"}",a="}");else if("fontShape"===l)"it"===s[0].fontShape?(o="\\mathit{",a="}"):"n"===s[0].fontShape?(o="{\\upshape ",a="}"):s[0].fontShape&&"n"!==s[0].fontShape&&(o="{\\fontShape{"+s[0].fontShape+"}",a="}");else if("fontSize"===l&&s[0].fontSize)o="{\\"+({size1:"tiny",size2:"scriptsize",size3:"footnotesize",size4:"small",size5:"normalsize",size6:"large",size7:"Large",size8:"LARGE",size9:"huge",size10:"Huge"}[s[0].fontSize]||"")+" ",a="}";else if("fontFamily"===l&&s[0].fontFamily&&!/^(math|main)$/.test(s[0].fontFamily)){const r={cal:"mathcal",frak:"mathfrak",bb:"mathbb",scr:"mathscr",cmr:"mathrm",cmtt:"mathtt",cmss:"mathsf"}[s[0].fontFamily]||"";if(r){if(/^\\operatorname{/.test(s[0].latex))return s[0].latex+t(e,i,s.slice(c),n);s[0].isFunction||(o="\\"+r+"{",a="}"),i=[]}else o+="{\\fontfamily{"+s[0].fontFamily+"}",a="}"}return"color"!==l||!s[0].color||"none"===s[0].color||e&&e.color===s[0].color||(o="\\textcolor{"+ge.colorToString(s[0].color)+"}{",a="}"),"backgroundColor"!==l||!s[0].backgroundColor||"none"===s[0].backgroundColor||e&&e.backgroundColor===s[0].backgroundColor||(o="\\colorbox{"+ge.colorToString(s[0].backgroundColor)+"}{",a="}"),r+=o,r+=t(e,i.slice(1),s.slice(0,c),n),(r+=a)+t(e,i,s.slice(c),n)}(t,["mode","color","backgroundColor","fontSize","fontFamily","fontShape","fontSeries"],e,i)}else"number"==typeof e||"boolean"==typeof e?s=e.toString():"string"==typeof e?s=e.replace(/\s/g,"~"):e&&"function"==typeof e.toLatex&&(s=e.toLatex(i));return s}function hi(t){const e=hi.locale.substring(0,2);let i="";return hi.strings[hi.locale]&&(i=hi.strings[hi.locale][t]),!i&&hi.strings[e]&&(i=hi.strings[e][t]),i||(i=hi.strings.en[t]),i||(i=t),i}pe.MathAtom.prototype.toLatex=function(t){t=void 0!==t&&t;let e,i="",s=0,n=0;const r=this.latex?this.latex.match(/^(\\[^{\s0-9]+)/):null,o=r?r[1]:null;switch(this.type){case"group":i+=this.latexOpen||(this.cssId||this.cssClass?"":"{"),this.cssId&&(i+="\\cssId{"+this.cssId+"}{"),"ML__emph"===this.cssClass?i+="\\emph{"+li(this,this.body,t)+"}":(this.cssClass&&(i+="\\class{"+this.cssClass+"}{"),i+=t?li(this,this.body,!0):this.latex||li(this,this.body,!1),this.cssClass&&(i+="}")),this.cssId&&(i+="}"),i+=this.latexClose||(this.cssId||this.cssClass?"":"}");break;case"array":if(i+="\\begin{"+this.env.name+"}","array"===this.env.name){if(i+="{",this.colFormat)for(n=0;n<this.colFormat.length;n++)this.colFormat[n].align?i+=this.colFormat[n].align:this.colFormat[n].rule&&(i+="|");i+="}"}for(s=0;s<this.array.length;s++){for(e=0;e<this.array[s].length;e++)e>0&&(i+=" & "),i+=li(this,this.array[s][e],t);s<this.array.length-1&&(i+=" \\\\ ")}i+="\\end{"+this.env.name+"}";break;case"root":i=li(this,this.body,t);break;case"genfrac":/^(choose|atop|over)$/.test(this.body)?(i+="{",i+=li(this,this.numer,t),i+="\\"+this.body+" ",i+=li(this,this.denom,t),i+="}"):(i+=o,i+=`{${li(this,this.numer,t)}}{${li(this,this.denom,t)}}`);break;case"surd":i+="\\sqrt",this.index&&(i+="[",i+=li(this,this.index,t),i+="]"),i+=`{${li(this,this.body,t)}}`;break;case"leftright":this.inner?(i+="\\left"+(this.leftDelim||"."),this.leftDelim&&this.leftDelim.length>1&&(i+=" "),i+=li(this,this.body,t),i+="\\right"+(this.rightDelim||"."),this.rightDelim&&this.rightDelim.length>1&&(i+=" ")):(i+="\\mleft"+(this.leftDelim||"."),this.leftDelim&&this.leftDelim.length>1&&(i+=" "),i+=li(this,this.body,t),i+="\\mright"+(this.rightDelim||"."),this.rightDelim&&this.rightDelim.length>1&&(i+=" "));break;case"delim":case"sizeddelim":i+=o+"{"+this.delim+"}";break;case"rule":i+=o,this.shift&&(i+=`[${li(this,this.shift,t)}em]`),i+=`{${li(this,this.width,t)}em}{${li(this,this.height,t)}em}`;break;case"line":case"overlap":case"accent":i+=`${o}{${li(this,this.body,t)}}`;break;case"overunder":i+=`${o}{${li(this,this.overscript||this.underscript,t)}}{${li(parent,this.body,t)}}`;break;case"mord":case"minner":case"mbin":case"mrel":case"mpunct":case"mopen":case"mclose":case"textord":case"":/^\\(mathbin|mathrel|mathopen|mathclose|mathpunct|mathord|mathinner)/.test(o)?i+=o+"{"+li(this,this.body,t)+"}":'\\char"'===o?i+=this.latex+" ":"\\unicode"===o?(i+='\\unicode{"',i+=("000000"+this.body.charCodeAt(0).toString(16)).toUpperCase().substr(-6),i+="}"):(this.latex||"string"==typeof this.body)&&(this.latex&&"\\"===this.latex[0]?(i+=this.latex,/[a-zA-Z0-9]$/.test(this.latex)&&(i+=" ")):i+=o||("​"!==this.body?this.latex||this.body:""));break;case"mop":"​"!==this.body&&("\\mathop"===o?i+=o+"{"+li(this,this.body,t)+"}":"\\operatorname"===o?i+=o+"{"+this.body+"}":this.latex&&"\\"===this.latex[0]?(i+=this.latex,/[a-zA-Z0-9]$/.test(this.latex)&&(i+=" ")):i+=o||("​"!==this.body?this.latex||this.body:"")),this.explicitLimits&&("limits"===this.limits&&(i+="\\limits "),"nolimits"===this.limits&&(i+="\\nolimits "));break;case"box":if("\\bbox"===o){if(i+=o,isFinite(this.padding)||void 0!==this.border||void 0!==this.backgroundcolor){const t=[];isFinite(this.padding)&&t.push(Math.floor(100*this.padding)/100+"em"),this.border&&t.push("border:"+this.border),this.backgroundcolor&&t.push(ge.colorToString(this.backgroundcolor)),i+=`[${t.join(",")}]`}i+=`{${li(this,this.body,t)}}`}else"\\boxed"===o?i+=`\\boxed{${li(this,this.body,t)}}`:(i+=o,this.framecolor&&(i+=`{${ge.colorToString(this.framecolor)}}`),this.backgroundcolor&&(i+=`{${ge.colorToString(this.backgroundcolor)}}`),i+=`{${li(this,this.body,t)}}`);break;case"spacing":i+=o,"\\hspace"===o||"\\hspace*"===o?(i+="{",i+=this.width?this.width+"em":"0em",i+="}"):(i+=" ",this.width&&(i+=this.width+"em "));break;case"enclose":if(i+=o,"\\enclose"===o){i+="{";let t="";for(const s in this.notation)Object.prototype.hasOwnProperty.call(this.notation,s)&&this.notation[s]&&(i+=t+s,t=" ");i+="}";let e="";t="",this.backgroundcolor&&"transparent"!==this.backgroundcolor&&(e+=t+'mathbackground="'+ge.colorToString(this.backgroundcolor)+'"',t=","),this.shadow&&"auto"!==this.shadow&&(e+=t+'shadow="'+this.shadow+'"',t=","),1!==this.strokeWidth||"solid"!==this.strokeStyle?(e+=t+this.borderStyle,t=","):this.strokeColor&&"currentColor"!==this.strokeColor&&(e+=t+'mathcolor="'+ge.colorToString(this.strokeColor)+'"',t=","),e&&(i+=`[${e}]`)}i+=`{${li(this,this.body,t)}}`;break;case"mathstyle":i+="\\"+this.mathstyle+" ";break;case"space":i+=this.latex;break;case"placeholder":i+="\\placeholder{"+(this.value||"")+"}";break;case"first":case"command":case"msubsup":break;case"error":i+=this.latex}if(this.superscript){let e=li(this,this.superscript,t);1===e.length?("′"===e?e="\\prime ":"″"===e&&(e="\\doubleprime "),i+="^"+e):i+="^{"+e+"}"}if(this.subscript){const e=li(this,this.subscript,t);i+=1===e.length?"_"+e:"_{"+e+"}"}return i},hi.plural=function(t,e,i){(i=i||{}).type=i.type||"cardinal";const s=hi.locale.substring(0,2),n="ordinal"===i.type?hi.ordinal:hi.cardinal;let r,o="ordinal"===i.type?hi._ordinalPluralCategories.indexOf(n.select(t)):hi._cardinalPluralCategories.indexOf(n.select(t));return hi.strings[hi.locale]&&(r=hi.strings[hi.locale][e]),!r&&hi.strings[s]&&(r=hi.strings[s][e]),r||((r=hi.strings.en[e])||(r=e),o="ordinal"===i.type?hi._ordinalPluralCategories.indexOf(hi._ordinalEnglish.select(t)):hi._cardinalPluralCategories.indexOf(hi._cardinalEnglish.select(t))),r.split(";")[o]||r.split(";")[0]},hi.merge=function(t,e){if(t&&e){const i=hi._locale;hi.locale=t,hi.strings[t]={...hi.strings[t],...e},hi.locale=i}else t&&!e&&(e=t,Object.keys(e).forEach(t=>hi.merge(t,e[t])))},Object.defineProperty(hi,"locale",{set(t){hi._locale=t,hi._ordinal=null,hi._cardinal=null},get:()=>(hi._locale||(hi._locale="undefined"==typeof navigator?"en":navigator.language.slice(0,5)),hi._locale)}),Object.defineProperty(hi,"ordinal",{get:()=>(hi._ordinal||(hi._ordinalEnglish=new Intl.PluralRules("en",{type:"ordinal"}),hi._ordinalEnglishPluralCategories=hi._ordinalEnglish.resolvedOptions().pluralCategories,hi._ordinal=new Intl.PluralRules(hi.locale,{type:"ordinal"}),hi._ordinalPluralCategories=hi._ordinal.resolvedOptions().pluralCategories),hi._ordinal)}),Object.defineProperty(hi,"cardinal",{get:()=>(hi._cardinal||(hi._cardinalEnglish=new Intl.PluralRules("en",{type:"cardinal"}),hi._cardinalEnglishPluralCategories=hi._cardinalEnglish.resolvedOptions().pluralCategories,hi._cardinal=new Intl.PluralRules(hi.locale,{type:"cardinal"}),hi._cardinaPluralCategories=hi._ordinal.resolvedOptions().pluralCategories),hi._cardinal)}),hi.strings={en:{"keyboard.tooltip.functions":"Functions","keyboard.tooltip.greek":"Greek Letters","keyboard.tooltip.command":"LaTeX Command Mode","keyboard.tooltip.numeric":"Numeric","keyboard.tooltip.roman":"Symbols and Roman Letters","tooltip.copy to clipboard":"Copy to Clipboard","tooltip.redo":"Redo","tooltip.toggle virtual keyboard":"Toggle Virtual Keyboard","tooltip.undo":"Undo"},ar:{"keyboard.tooltip.functions":"مهام","keyboard.tooltip.greek":"حروف يونانية","keyboard.tooltip.command":"حالة تلقي الأوامر اللاتك","keyboard.tooltip.numeric":"الرقمية","keyboard.tooltip.roman":"رموز الاحرف الرومانية","tooltip.copy to clipboard":"نسخ إلى الحافظة","tooltip.redo":"الإعادة","tooltip.toggle virtual keyboard":"تبديل لوحة المفاتيح الإفتراضية","tooltip.undo":"إلغاء"},de:{"keyboard.tooltip.functions":"Funktionen","keyboard.tooltip.greek":"Griechische Buchstaben","keyboard.tooltip.command":"LaTeX-Befehlsmodus","keyboard.tooltip.numeric":"Numerisch","keyboard.tooltip.roman":"Symbole und römische Buchstaben","tooltip.copy to clipboard":"In die Zwischenablage kopieren","tooltip.redo":"Wiederholen","tooltip.toggle virtual keyboard":"Virtuelle Tastatur umschalten","tooltip.undo":"Widerrufen"},el:{"keyboard.tooltip.functions":"συναρτήσεις","keyboard.tooltip.greek":"ελληνικά γράμματα","keyboard.tooltip.command":"Λειτουργία εντολών LaTeX","keyboard.tooltip.numeric":"Αριθμητικός","keyboard.tooltip.roman":"Σύμβολα και ρωμαϊκά γράμματα","tooltip.copy to clipboard":"Αντιγραφή στο πρόχειρο","tooltip.redo":"Ξανακάνω","tooltip.toggle virtual keyboard":"Εναλλαγή εικονικού πληκτρολογίου","tooltip.undo":"Ξεκάνω"},es:{"keyboard.tooltip.functions":"Funciones","keyboard.tooltip.greek":"Letras griegas","keyboard.tooltip.command":"Modo Comando LaTeX","keyboard.tooltip.numeric":"Numérico","keyboard.tooltip.roman":"Símbolos y letras romanas","tooltip.copy to clipboard":"Copiar al portapapeles","tooltip.redo":"Rehacer","tooltip.toggle virtual keyboard":"Alternar teclado virtual","tooltip.undo":"Deshacer"},fa:{"keyboard.tooltip.functions":"توابع","keyboard.tooltip.greek":"حروف یونانی","keyboard.tooltip.command":"حالت دستور لاتک","keyboard.tooltip.numeric":"عددی","keyboard.tooltip.roman":"علائم و حروف لاتین","tooltip.copy to clipboard":"کپی به کلیپبورد","tooltip.redo":"بازگشت به بعد","tooltip.toggle virtual keyboard":"نمایش/نهفتن کیبورد مجازی","tooltip.undo":"بازگشت به قبل"},fr:{"keyboard.tooltip.functions":"Fonctions","keyboard.tooltip.greek":"Lettres grecques","keyboard.tooltip.command":"Mode de commandes LaTeX","keyboard.tooltip.numeric":"Numérique","keyboard.tooltip.roman":"Lettres et symboles romains","tooltip.copy to clipboard":"Copier dans le presse-papiers","tooltip.redo":"Rétablir","tooltip.toggle virtual keyboard":"Afficher/Masquer le clavier virtuel","tooltip.undo":"Annuler"},it:{"keyboard.tooltip.functions":"Funzioni","keyboard.tooltip.greek":"Lettere greche","keyboard.tooltip.command":"Modalità di comando LaTeX","keyboard.tooltip.numeric":"Numerico","keyboard.tooltip.roman":"Simboli e lettere romane","tooltip.copy to clipboard":"Copia negli appunti","tooltip.redo":"Rifare","tooltip.toggle virtual keyboard":"Attiva / disattiva la tastiera virtuale","tooltip.undo":"Disfare"},ja:{"keyboard.tooltip.functions":"関数","keyboard.tooltip.greek":"ギリシャ文字","keyboard.tooltip.command":"LaTeXコマンドモード","keyboard.tooltip.numeric":"数値","keyboard.tooltip.roman":"記号とローマ字","tooltip.copy to clipboard":"クリップボードにコピー","tooltip.redo":"やり直し","tooltip.toggle virtual keyboard":"仮想キーボードの切り替え","tooltip.undo":"元に戻す"},pl:{"keyboard.tooltip.functions":"Funkcje","keyboard.tooltip.greek":"Litery greckie","keyboard.tooltip.command":"Tryb poleceń LaTeX","keyboard.tooltip.numeric":"Numeryczne","keyboard.tooltip.roman":"Symbole i litery rzymskie","tooltip.copy to clipboard":"Kopiuj do Schowka","tooltip.redo":"Przywróć","tooltip.toggle virtual keyboard":"Przełącz wirtualną klawiaturę","tooltip.undo":"Cofnij"},ru:{"keyboard.tooltip.functions":"Функции","keyboard.tooltip.greek":"Греческие буквы","keyboard.tooltip.command":"Режим командной строки LaTeX","keyboard.tooltip.numeric":"числовой","keyboard.tooltip.roman":"Символы и римские буквы","tooltip.copy to clipboard":"Скопировать в буфер обмена","tooltip.redo":"переделывать","tooltip.toggle virtual keyboard":"Переключить виртуальную клавиатуру","tooltip.undo":"расстегивать"}};const ci={numeric:{tooltip:"keyboard.tooltip.numeric",layer:"math",label:"123",layers:["math"]},roman:{tooltip:"keyboard.tooltip.roman",layer:"lower-roman",label:"ABC",layers:["lower-roman","upper-roman","symbols"]},greek:{tooltip:"keyboard.tooltip.greek",layer:"lower-greek",label:"&alpha;&beta;&gamma;",classes:"tex-math",layers:["lower-greek","upper-greek"]},functions:{tooltip:"keyboard.tooltip.functions",layer:"functions",label:"<i>f</i>&thinsp;()",classes:"tex",layers:["functions"]},command:{tooltip:"keyboard.tooltip.command",command:"enterCommandMode",label:"<svg><use xlink:href='#svg-command' /></svg>",layers:["lower-command","upper-command","symbols-command"]},style:{tooltip:"keyboard.tooltip.style",layer:"style",label:"<b>b</b><i>i</i>𝔹"}},di={"\\varphi ":{label:"&Phi;",insert:"\\Phi "},"\\varsigma ":{label:"&Sigma;",insert:"\\Sigma "},"\\epsilon ":{label:"&#x0190;",insert:'{\\char"0190}'},"\\rho ":{label:"&#x3A1",insert:'{\\char"3A1}'},"\\tau ":{label:"&#x3A4;",insert:'{\\char"3A4}'},"\\upsilon ":{label:"&Upsilon;",insert:"\\Upsilon "},"\\theta ":{label:"&Theta;",insert:"\\Theta "},"\\iota ":{label:"&Iota;",insert:'{\\char"399}'},"\\omicron ":{label:"&#x039F;",insert:'{\\char"39F}'},"\\pi ":{label:"&Pi;",insert:"\\Pi "},"\\alpha ":{label:"&Alpha;",insert:'{\\char"391}'},"\\sigma ":{label:"&Sigma;",insert:"\\Sigma "},"\\delta ":{label:"&Delta;",insert:"\\Delta "},"\\phi ":{label:"&#x03a6;",insert:"\\Phi "},"\\gamma ":{label:"&Gamma;",insert:"\\Gamma "},"\\eta ":{label:"&Eta;",insert:'{\\char"397}'},"\\xi ":{label:"&Xi;",insert:"\\Xi "},"\\kappa ":{label:"&Kappa;",insert:'{\\char"39A}'},"\\lambda ":{label:"&Lambda;",insert:"\\Lambda "},"\\zeta ":{label:"&Zeta;",insert:'{\\char"396}'},"\\chi ":{label:"&Chi;",insert:'{\\char"3A7}'},"\\psi ":{label:"&Psi;",insert:"\\Psi "},"\\omega ":{label:"&Omega;",insert:"\\Omega "},"\\beta ":{label:"&Beta;",insert:'{\\char"392}'},"\\nu ":{label:"&Nu;",insert:'{\\char"39D}'},"\\mu ":{label:"&Mu;",insert:'{\\char"39C}'}},ui={0:["\\emptyset","\\varnothing","\\infty",{latex:"#?_0",insert:"#@_0"},"\\circ","\\bigcirc","\\bullet"],2:["\\frac{1}{2}",{latex:"#?^2",insert:"#@^2"}],3:["\\frac{1}{3}",{latex:"#?^3",insert:"#@^3"}],".":[",",";","\\colon",{latex:":",aside:"ratio"},{latex:"\\cdotp",aside:"center dot",classes:"box"},{latex:"\\cdots",aside:"center ellipsis",classes:"box"},{latex:"\\ldotp",aside:"low dot",classes:"box"},{latex:"\\ldots",aside:"low ellipsis",classes:"box"},{latex:"\\vdots",aside:"",classes:"box"},{latex:"\\ddots",aside:"",classes:"box"},"\\odot","\\oslash","\\circledcirc"],"*":["\\cdot","\\ast","\\star","\\bigstar","\\ltimes","\\rtimes","\\rightthreetimes","\\leftthreetimes","\\intercal","\\prod",{latex:"\\prod_{n\\mathop=0}^{\\infty}",classes:"small"}],"+":["\\pm","\\mp","\\sum",{latex:"\\sum_{n\\mathop=0}^{\\infty}",classes:"small"},"\\dotplus","\\oplus"],"-":["\\pm","\\mp","\\ominus","\\vert #0  \\vert"],"/":["\\divideontimes","/","\\div"],"(":["\\left( #0\\right)","\\left[ #0\\right]","\\left\\{ #0\\right\\}","\\left\\langle #0\\right\\rangle","\\lfloor","\\llcorner","(","\\lbrack","\\lvert","\\lVert","\\lgroup","\\langle","\\lceil","\\ulcorner","\\lmoustache","\\lbrace"],")":["\\rfloor","\\lrcorner",")","\\rbrack","\\rvert","\\rVert","\\rgroup","\\rangle","\\rceil","\\urcorner","\\rmoustache","\\rbrace"],"=":["\\cong","\\asymp","\\equiv","\\differencedelta","\\varpropto","\\thickapprox","\\approxeq","\\thicksim","\\backsim","\\eqsim","\\simeq","\\Bumpeq","\\bumpeq","\\doteq","\\Doteq","\\fallingdotseq","\\risingdotseq","\\coloneq","\\eqcirc","\\circeq","\\triangleq","\\between"],"!=":["\\neq","\\ncong","","\\nsim"],"<":["\\leq","\\leqq","\\lneqq","\\ll","\\nless","\\nleq","\\precsim","\\lesssim","\\lessgtr","\\prec","\\preccurlyeq","\\lessdot","\\nprec"],">":["\\geq","\\geqq","\\gneqq","\\gg","\\ngtr","\\ngeq","\\succsim","\\gtrsim","\\gtrless","\\succ","\\succcurlyeq","\\gtrdot","\\nsucc"],set:["\\in","\\owns","\\subset","\\nsubset","\\supset","\\nsupset"],"!set":["\\notin","\\backepsilon"],subset:[],supset:[],infinity:["\\aleph_0","\\aleph_1","\\omega","\\mathfrak{m}"],"numeric-pi":["\\prod","\\theta","\\rho","\\sin","\\cos","\\tan"],ee:["\\times 10^{#?}","\\ln","\\ln_{10}","\\log"],"^":["_{#?}"],int:[{latex:"\\int_{#?}^{#?}",classes:"small"},{latex:"\\int",classes:"small"},{latex:"\\smallint",classes:"small"},{latex:"\\iint",classes:"small"},{latex:"\\iiint",classes:"small"},{latex:"\\oint",classes:"small"},{latex:"\\dfrac{\\rd}{\\rd x}",classes:"small"},{latex:"\\frac{\\partial}{\\partial x}",classes:"small"},"\\capitalDifferentialD","\\rd","\\partial"],nabla:["\\nabla\\times","\\nabla\\cdot","\\nabla^{2}"],"!":["!!","\\Gamma","\\Pi"],accents:["\\bar{#@}","\\vec{#@}","\\hat{#@}","\\check{#@}","\\dot{#@}","\\ddot{#@}","\\mathring{#@}","\\breve{#@}","\\acute{#@}","\\tilde{#@}","\\grave{#@}"],A:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"}],a:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"}],b:[{latex:"\\beth",aside:"beth"}],B:[{latex:"\\beth",aside:"beth"}],c:[{latex:"\\C",aside:"set of complex numbers"}],d:[{latex:"\\daleth",aside:"daleth"}],D:[{latex:"\\daleth",aside:"daleth"}],e:[{latex:"\\exponentialE",aside:"exponential e"},{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isn’t"}],g:[{latex:"\\gimel",aside:"gimel"}],G:[{latex:"\\gimel",aside:"gimel"}],h:[{latex:"\\hbar",aside:"h bar"},{latex:"\\hslash",aside:"h slash"}],i:[{latex:"\\imaginaryI",aside:"imaginary i"}],j:[{latex:"\\imaginaryJ",aside:"imaginary j"}],l:[{latex:"\\ell",aside:"ell"}],n:[{latex:"\\N",aside:"set of natural numbers"}],p:[{latex:"\\P",aside:"set of primes"}],q:[{latex:"\\Q",aside:"set of rational numbers"}],r:[{latex:"\\R",aside:"set of real numbers"}],z:[{latex:"\\Z",aside:"set of integers"}],"x-var":["y","z","t","r",{latex:"f(#?)",classes:"small"},{latex:"g(#?)",classes:"small"},"x^2","x^n","x_n","x_{n+1}","x_i","x_{i+1}"],"n-var":["i","j","p","k","a","u"],ii:["\\Re","\\Im","\\imaginaryJ","\\Vert #0 \\Vert"],logic:[{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isn’t"},{latex:"\\ni",aside:"such that"},{latex:"\\Colon",aside:"such that"},{latex:"\\implies",aside:"implies"},{latex:"\\impliedby",aside:"implied by"},{latex:"\\iff",aside:"if and only if"},{latex:"\\land",aside:"and"},{latex:"\\lor",aside:"or"},{latex:"\\oplus",aside:"xor"},{latex:"\\lnot",aside:"not"},{latex:"\\downarrow",aside:"nor"},{latex:"\\uparrow",aside:"nand"},{latex:"\\curlywedge",aside:"nor"},{latex:"\\bar\\curlywedge",aside:"nand"},{latex:"\\therefore",aside:"therefore"},{latex:"\\because",aside:"because"},{latex:"^\\biconditional",aside:"biconditional"},"\\leftrightarrow","\\Leftrightarrow","\\to","\\models","\\vdash","\\gets","\\dashv","\\roundimplies"],"set-operators":["\\cap","\\cup","\\setminus","\\smallsetminus","\\complement"],"set-relations":["\\in","\\notin","\\ni","\\owns","\\subset","\\supset","\\subseteq","\\supseteq","\\subsetneq","\\supsetneq","\\varsubsetneq","\\subsetneqq","\\nsubset","\\nsupset","\\nsubseteq","\\nsupseteq"],space:[{latex:'\\char"203A\\!\\char"2039',insert:"\\!",aside:"negative thin space<br>⁻³⧸₁₈ em"},{latex:'\\unicode{"203A}\\,\\unicode{"2039}',insert:"\\,",aside:"thin space<br>³⧸₁₈ em"},{latex:'\\unicode{"203A}\\:\\unicode{"2039}',insert:"\\:",aside:"medium space<br>⁴⧸₁₈ em"},{latex:'\\unicode{"203A}\\;\\unicode{"2039}',insert:"\\;",aside:"thick space<br>⁵⧸₁₈ em"},{latex:'\\unicode{"203A}\\ \\unicode{"2039}',insert:"\\ ",aside:"⅓ em"},{latex:'\\unicode{"203A}\\enspace\\unicode{"2039}',insert:"\\enspace",aside:"½ em"},{latex:'\\unicode{"203A}\\quad\\unicode{"2039}',insert:"\\quad",aside:"1 em"},{latex:'\\unicode{"203A}\\qquad\\unicode{"2039}',insert:"\\qquad",aside:"2 em"}],delete:[{label:'<span class="warning"><svg><use xlink:href="#svg-trash" /></svg></span>',command:'"deleteAll"'}],"->|":[]};let pi={};const fi={math:"\n        <div class='rows'>\n            <ul>\n                <li class='keycap tex' data-alt-keys='x-var'><i>x</i></li>\n                <li class='keycap tex' data-alt-keys='n-var'><i>n</i></li>\n                <li class='separator w5'></li>\n                <row name='numpad-1'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-key='ee' data-alt-keys='ee'>e</li>\n                <li class='keycap tex' data-key='ii' data-alt-keys='ii'>i</li>\n                <li class='keycap tex' data-latex='\\pi' data-alt-keys='numeric-pi'></li>\n            </ul>\n            <ul>\n                <li class='keycap tex' data-key='<' data-alt-keys='<'>&lt;</li>\n                <li class='keycap tex' data-key='>' data-alt-keys='>'>&gt;</li>\n                <li class='separator w5'></li>\n                <row name='numpad-2'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='x2' data-insert='#@^{2}'><span><i>x</i>&thinsp;²</span></li>\n                <li class='keycap tex' data-alt-keys='^' data-insert='#@^{#?}'><span><i>x</i><sup>&thinsp;<small>&#x2b1a;</small></sup></span></li>\n                <li class='keycap tex' data-alt-keys='sqrt' data-insert='\\sqrt{#0}' data-latex='\\sqrt{#0}'></li>\n            </ul>\n            <ul>\n                <li class='keycap tex' data-alt-keys='(' >(</li>\n                <li class='keycap tex' data-alt-keys=')' >)</li>\n                <li class='separator w5'></li>\n                <row name='numpad-3'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex small' data-alt-keys='int' data-latex='\\int_0^\\infty'><span></span></li>\n                <li class='keycap tex' data-latex='\\forall' data-alt-keys='logic' ></li>\n                <li class='action font-glyph bottom right' data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            </ul>\n            <ul>\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428; box-sizing: border-box'></span></li>\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590; box-sizing: border-box'></span></li>\n                <li class='separator w5'></li>\n                <row name='numpad-4'/>\n                <li class='separator w5'></li>\n                <arrows/>\n            </ul>\n        </div>\n    ","lower-roman":"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <row name='lower-1' shift-layer='upper-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <row name='lower-2'  shift-layer='upper-roman''/>\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <row name='lower-3'  shift-layer='upper-roman''/>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols'>&infin;≠</li>\n                <li class='keycap' data-alt-keys=','>,</li>\n                <li class='keycap w50' data-key=' ' data-alt-keys='space'>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","upper-roman":"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <row name='upper-1'  shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <row name='upper-2' shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <row name='upper-3' shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols'>&infin;≠</li>\n                <li class='keycap' data-alt-keys='.'>;</li>\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",symbols:"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\lbrace '>{</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rbrace '>}</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='set' data-insert='\\in '>&#x2208;</li>\n                <li class='keycap tex' data-alt-keys='!set' data-insert='\\notin '>&#x2209;</li>\n                <li class='keycap tex' data-insert='\\Re '>&#x211c;<aside>Real</aside></li>\n                <li class='keycap tex' data-insert='\\Im '>&#x2111;<aside>Imaginary</aside></li>\n                <li class='keycap w15' data-insert='\\ulcorner#0\\urcorner '><span><sup>&#x250c;</sup><span><span style='color:#ddd'>o</span><sup>&#x2510;</sup></span><aside>ceil</aside></li>\n                <li class='keycap tex' data-alt-keys='nabla' data-insert='\\nabla '>&#x2207;<aside>nabla</aside></li>\n                <li class='keycap tex' data-alt-keys='infinity' data-insert='\\infty '>&#x221e;</li>\n\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\lbrack '>[</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rbrack '>]</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='subset' data-insert='\\subset '>&#x2282;</li>\n                <li class='keycap tex' data-alt-keys='supset' data-insert='\\supset '>&#x2283;</li>\n                <li class='keycap tex' data-key='!' data-alt-keys='!'>!<aside>factorial</aside></li>\n                <li class='keycap' data-insert='^{\\prime} '><span><sup><span><span style='color:#ddd'>o</span>&#x2032</sup></span><aside>prime</aside></li>\n                <li class='keycap w15' data-insert='\\llcorner#0\\lrcorner '><span><sub>&#x2514;</sub><span style='color:#ddd'>o</span><sub>&#x2518;</sub></span><aside>floor</aside></li>\n                <li class='keycap tex' data-insert='\\partial '>&#x2202;<aside>partial<br>derivative</aside></li>\n                <li class='keycap tex' data-insert='\\emptyset '>&#x2205;<aside>empty set</aside></li>\n\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\langle '>&#x27e8;</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rangle '>&#x27e9;</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-insert='\\subseteq '>&#x2286;</li>\n                <li class='keycap tex' data-insert='\\supseteq '>&#x2287;</li>\n                <li class='keycap tex' data-alt-keys='accents' data-insert='\\vec{#@}' data-latex='\\vec{#?}' data-aside='vector'></li>\n                <li class='keycap tex' data-alt-keys='accents' data-insert='\\bar{#@}' data-latex='\\bar{#?}' data-aside='bar'></li>\n                <li class='keycap tex' data-alt-keys='absnorm' data-insert='\\lvert #@ \\rvert ' data-latex='\\lvert #? \\rvert' data-aside='abs'></li>\n                <li class='keycap tex' data-insert='\\ast '>&#x2217;<aside>asterisk</aside></li>\n\n                <li class='action font-glyph bottom right w15'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='lower-roman'>abc</li>\n                <li class='keycap tex' data-insert='\\cdot '>&#x22c5;<aside>centered dot</aside></li>\n                <li class='keycap tex' data-insert='\\colon '>:<aside>colon</aside></li>\n                <li class='keycap tex' data-insert='\\circ '>&#x2218;<aside>circle</aside></li>\n                <li class='keycap tex' data-insert='\\approx '>&#x2248;<aside>approx.</aside></li>\n                <li class='keycap tex' data-insert='\\ne '>&#x2260;</li>\n                <li class='keycap tex' data-insert='\\pm '>&#x00b1;</li>\n                <arrows/>\n            </ul>\n        </div>","lower-greek":"\n        <div class='rows'>\n            <ul><li class='keycap tex' data-insert='\\varphi '><i>&#x03c6;</i><aside>phi var.</aside></li>\n                <li class='keycap tex' data-insert='\\varsigma '><i>&#x03c2;</i><aside>sigma var.</aside></li>\n                <li class='keycap tex' data-insert='\\epsilon '><i>&#x03f5;</i></li>\n                <li class='keycap tex' data-insert='\\rho '><i>&rho;</i></li>\n                <li class='keycap tex' data-insert='\\tau '><i>&tau;</i></li>\n                <li class='keycap tex' data-insert='\\upsilon '><i>&upsilon;</i></li>\n                <li class='keycap tex' data-insert='\\theta '><i>&theta;</i></li>\n                <li class='keycap tex' data-insert='\\iota '><i>&iota;</i></li>\n                <li class='keycap tex' data-insert='\\omicron '>&omicron;</i></li>\n                <li class='keycap tex' data-insert='\\pi '><i>&pi;</i></li>\n            </ul>\n            <ul><li class='keycap tex' data-insert='\\alpha ' data-shifted='&Alpha;' data-shifted-command='[\"insert\",\"{\\\\char\\\"391}\"]'><i>&alpha;</i></li>\n                <li class='keycap tex' data-insert='\\sigma '><i>&sigma;</i></li>\n                <li class='keycap tex' data-insert='\\delta '><i>&delta;</i></li>\n                <li class='keycap tex' data-insert='\\phi '><i>&#x03d5;</i></i></li>\n                <li class='keycap tex' data-insert='\\gamma '><i>&gamma;</i></li>\n                <li class='keycap tex' data-insert='\\eta '><i>&eta;</i></li>\n                <li class='keycap tex' data-insert='\\xi '><i>&xi;</i></li>\n                <li class='keycap tex' data-insert='\\kappa '><i>&kappa;</i></li>\n                <li class='keycap tex' data-insert='\\lambda '><i>&lambda;</i></li>\n            </ul>\n            <ul><li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='upper-greek'>&#x21e7;</li>\n                <li class='keycap tex' data-insert='\\zeta '><i>&zeta;</i></li>\n                <li class='keycap tex' data-insert='\\chi '><i>&chi;</i></li>\n                <li class='keycap tex' data-insert='\\psi '><i>&psi;</i></li>\n                <li class='keycap tex' data-insert='\\omega '><i>&omega;</i></li>\n                <li class='keycap tex' data-insert='\\beta '><i>&beta;</i></li>\n                <li class='keycap tex' data-insert='\\nu '><i>&nu;</i></li>\n                <li class='keycap tex' data-insert='\\mu '><i>&mu;</i></li>\n                <li class='action font-glyph bottom right w15'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <li class='keycap ' data-key=' '>&nbsp;</li>\n                <li class='keycap'>,</li>\n                <li class='keycap tex' data-insert='\\varepsilon '><i>&#x03b5;</i><aside>epsilon var.</aside></li>\n                <li class='keycap tex' data-insert='\\vartheta '><i>&#x03d1;</i><aside>theta var.</aside></li>\n                <li class='keycap tex' data-insert='\\varkappa '><i>&#x3f0;</i><aside>kappa var.</aside></li>\n                <li class='keycap tex' data-insert='\\varpi '><i>&#x03d6;<aside>pi var.</aside></i></li>\n                <li class='keycap tex' data-insert='\\varrho '><i>&#x03f1;</i><aside>rho var.</aside></li>\n                <arrows/>\n            </ul>\n        </div>","upper-greek":"\n        <div class='rows'>\n            <ul><li class='keycap tex' data-insert='\\Phi '>&Phi;<aside>phi</aside></li>\n                <li class='keycap tex' data-insert='\\Sigma '>&Sigma;<aside>sigma</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"0190}'>&#x0190;<aside>epsilon</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A1}'>&#x3A1;<aside>rho</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A4}'>&#x3A4;<aside>tau</aside></li>\n                <li class='keycap tex' data-insert='\\Upsilon '>&Upsilon;<aside>upsilon</aside></li>\n                <li class='keycap tex' data-insert='\\Theta '>&Theta;<aside>theta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"399}'>&Iota;<aside>iota</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39F}'>&#x039F;<aside>omicron</aside></li>\n                <li class='keycap tex' data-insert='\\Pi '>&Pi;<aside>pi</aside></li></ul>\n            <ul><li class='keycap tex' data-insert='{\\char\"391}'>&#x391;<aside>alpha</aside></li>\n                <li class='keycap tex' data-insert='\\Sigma '>&Sigma;<aside>sigma</aside></li>\n                <li class='keycap tex' data-insert='\\Delta '>&Delta;<aside>delta</aside></li>\n                <li class='keycap tex' data-insert='\\Phi '>&#x03a6;<aside>phi</aside></li>\n                <li class='keycap tex' data-insert='\\Gamma '>&Gamma;<aside>gamma</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"397}'>&Eta;<aside>eta</aside></li>\n                <li class='keycap tex' data-insert='\\Xi '>&Xi;<aside>xi</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39A}'>&Kappa;<aside>kappa</aside></li>\n                <li class='keycap tex' data-insert='\\Lambda '>&Lambda;<aside>lambda</aside></li></ul>\n            <ul><li class='shift modifier font-glyph bottom left selected w15 layer-switch' data-layer='lower-greek'>&#x21e7;</li>\n                <li class='keycap tex' data-insert='{\\char\"396}'>&Zeta;<aside>zeta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A7}'>&Chi;<aside>chi</aside></li>\n                <li class='keycap tex' data-insert='\\Psi '>&Psi;<aside>psi</aside></li>\n                <li class='keycap tex' data-insert='\\Omega '>&Omega;<aside>omega</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"392}'>&Beta;<aside>beta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39D}'>&Nu;<aside>nu</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39C}'>&Mu;<aside>mu</aside></li>\n                <li class='action font-glyph bottom right w15' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            <ul>\n                <li class='separator w10'>&nbsp;</li>\n                <li class='keycap'>.</li>\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","lower-command":"\n        <div class='rows'>\n            <ul><row name='lower-1' class='tt' shift-layer='upper-command'/></ul>\n            <ul><row name='lower-2' class='tt' shift-layer='upper-command'/></ul>\n            <ul><row name='lower-3' class='tt' shift-layer='upper-command'/></ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'>01#</li>\n                <li class='keycap tt' data-shifted='[' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"[\"]'>{</li>\n                <li class='keycap tt' data-shifted=']' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"]\"]'>}</li>\n                <li class='keycap tt' data-shifted='(' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"(\"]'>^</li>\n                <li class='keycap tt' data-shifted=')' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \")\"]'>_</li>\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","upper-command":"\n        <div class='rows'>\n            <ul><row name='upper-1' class='tt' shift-layer='lower-command'/></ul>\n            <ul><row name='upper-2' class='tt' shift-layer='lower-command'/></ul>\n            <ul><row name='upper-3' class='tt' shift-layer='lower-command'/></ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'01#</li>\n                <li class='keycap tt'>[</li>\n                <li class='keycap tt'>]</li>\n                <li class='keycap tt'>(</li>\n                <li class='keycap tt'>)</li>\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","symbols-command":"\n        <div class='rows'>\n            <ul><li class='keycap tt'>1</li><li class='keycap tt'>2</li><li class='keycap tt'>3</li><li class='keycap tt'>4</li><li class='keycap tt'>5</li><li class='keycap tt'>6</li><li class='keycap tt'>7</li><li class='keycap tt'>8</li><li class='keycap tt'>9</li><li class='keycap tt'>0</li></ul>\n            <ul><li class='keycap tt'>!</li><li class='keycap tt'>@</li><li class='keycap tt'>#</li><li class='keycap tt'>$</li><li class='keycap tt'>%</li><li class='keycap tt'>^</li><li class='keycap tt'>&</li><li class='keycap tt'>*</li><li class='keycap tt'>+</li><li class='keycap tt'>=</li></ul>\n            <ul>\n                <li class='keycap tt'>\\</li>\n                <li class='keycap tt'>|</li>\n                <li class='keycap tt'>/</li>\n                <li class='keycap tt'>`</li>\n                <li class='keycap tt'>;</li>\n                <li class='keycap tt'>:</li>\n                <li class='keycap tt'>?</li>\n                <li class='keycap tt'>'</li>\n                <li class='keycap tt'>\"</li>\n                <li class='action font-glyph bottom right'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='lower-command'>abc</li>\n                <li class='keycap tt'>&lt;</li>\n                <li class='keycap tt'>&gt;</li>\n                <li class='keycap tt'>~</li>\n                <li class='keycap tt'>,</li>\n                <li class='keycap tt'>.</li>\n                <li class='keycap' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",functions:"\n        <div class='rows'>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\sin'></li>\n                <li class='fnbutton' data-insert='\\sin^{-1}'></li>\n                <li class='fnbutton' data-insert='\\ln'></li>\n                <li class='fnbutton' data-insert='\\exponentialE^{#?}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{lcm}(#?)' data-latex='\\operatorname{lcm}()'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{ceil}(#?)' data-latex='\\operatorname{ceil}()'></li>\n                <li class='bigfnbutton' data-insert='\\lim_{n\\to\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\int'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{abs}(#?)' data-latex='\\operatorname{abs}()'></li>\n            </ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\cos'></li>\n                <li class='fnbutton' data-insert='\\cos^{-1}'></li>\n                <li class='fnbutton' data-insert='\\ln_{10}'></li>\n                <li class='fnbutton' data-insert='10^{#?}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{gcd}(#?)' data-latex='\\operatorname{gcd}()'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{floor}(#?)' data-latex='\\operatorname{floor}()'></li>\n                <li class='bigfnbutton' data-insert='\\sum_{n\\mathop=0}^{\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\int_{0}^{\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{sign}(#?)' data-latex='\\operatorname{sign}()'></li>\n            </ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\tan'></li>\n                <li class='fnbutton' data-insert='\\tan^{-1}'></li>\n                <li class='fnbutton' data-insert='\\log_{#?}'></li>\n                <li class='fnbutton' data-insert='\\sqrt[#?]{#0}'></li>\n                <li class='bigfnbutton' data-insert='#0 \\mod' data-latex='\\mod'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{round}(#?) ' data-latex='\\operatorname{round}()'></li>\n                <li class='bigfnbutton' data-insert='\\prod_{n\\mathop=0}^{\\infty}' data-latex='{\\tiny \\prod_{n=0}^{\\infty}}'></li>\n                <li class='bigfnbutton' data-insert='\\frac{\\differentialD #0}{\\differentialD x}'></li>\n                <li class='action font-glyph bottom right' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton'>(</li>\n                <li class='fnbutton'>)</li>\n                <li class='fnbutton' data-insert='^{#?} ' data-latex='x^{#?} '></li>\n                <li class='fnbutton' data-insert='_{#?} ' data-latex='x_{#?} '></li>\n                <li class='keycap w20 ' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",style:"\n        <div class='rows'>\n            <ul>\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428'></span></li>\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590'></span></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size3\"}]' data-latex='\\scriptsize\\text{small}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size5\"}]' data-latex='\\scriptsize\\text{normal}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size9\"}]' data-latex='\\huge\\text{big}'></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-latex='\\langle' data-command='[\"insert\", \"\\\\langle\", {\"smartFence\":true}]'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"l\"}]' data-latex='\\fontseries{l}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"m\"}]' data-latex='\\fontseries{m}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"b\"}]' data-latex='\\fontseries{b}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"bx\"}]' data-latex='\\fontseries{bx}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"sb\"}]' data-latex='\\fontseries{sb}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"c\"}]' data-latex='\\fontseries{c}\\text{Ab}'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"up\"}]' data-latex='\\textup{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"it\"}]' data-latex='\\textit{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sl\"}]' data-latex='\\textsl{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sc\"}]' data-latex='\\textsc{Ab}'></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-insert='\\emph{#?} ' data-latex='\\text{\\emph{emph}}'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmr\"}]' data-latex='\\textrm{Az}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmtt\"}]' data-latex='\\texttt{Az}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmss\"}]' data-latex='\\textsf{Az}'></li>\n\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"bb\"}]'  data-latex='\\mathbb{AZ}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"scr\"}]'  data-latex='\\mathscr{AZ}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cal\"}]' data-latex='\\mathcal{A1}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"frak\"}]' data-latex='\\mathfrak{Az}'></li>\n            </ul>\n        </div>"};function mi(t,e,i){t=t.replace(/(^|[^\\])#@/g,"$1#?");const s=Ce.parseTokens(v.tokenize(t),"math",e,i.config.macros),n=pe.decompose({mathstyle:"displaystyle",macros:i.config.macros},s),r=et.makeSpan(n,"ML__base"),o=et.makeSpan("","ML__strut");o.setStyle("height",r.height,"em");const a=et.makeSpan("","ML__strut--bottom");return a.setStyle("height",r.height+r.depth,"em"),a.setStyle("vertical-align",-r.depth,"em"),et.makeSpan([o,a,r],"ML__mathlive").toMarkup()}function gi(t,e,i){let s="<div class='left'>";const n=e.replace(/\s+/g," ").split(" ");if(n.length>1){const e=Object.assign({},ci,t.config.customVirtualKeyboards||{});for(const t of n){if(!e[t])break;s+="<div class='",s+=t===i?"selected ":e[t].command?"action ":"layer-switch ",s+=(e[t].classes||"")+"'",e[t].tooltip&&(s+="data-tooltip='"+hi(e[t].tooltip)+"' ",s+="data-placement='top' data-delay='1s'"),t!==i&&(e[t].command&&(s+="data-command='\""+e[t].command+"\"'"),e[t].layer&&(s+="data-layer='"+e[t].layer+"'")),s+=">"+e[t].label+"</div>"}}return s+="</div>","<div class='keyboard-toolbar' role='toolbar'>"+(s+=`\n        <div class='right'>\n            <div class='action'\n                data-command='"copyToClipboard"'\n                data-tooltip='${hi("tooltip.copy to clipboard")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-copy' /></svg>\n            </div>\n            <div class='action disabled'\n                data-command='"undo"'\n                data-tooltip='${hi("tooltip.undo")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-undo' /></svg>\n            </div>\n            <div class='action disabled'\n                data-command='"redo"'\n                data-tooltip='${hi("tooltip.redo")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-redo' /></svg>\n            </div>\n        </div>\n    `)+"</div>"}function bi(t,e,i){for(let s=0;s<e.length;++s){const n=e[s];n.getAttribute("data-latex")?n.innerHTML=mi(n.getAttribute("data-latex").replace(/&quot;/g,'"'),{"?":'{\\color{#555}{\\tiny \\char"2B1A}}'},t):""===n.innerHTML&&n.getAttribute("data-insert")?n.innerHTML=mi(n.getAttribute("data-insert").replace(/&quot;/g,'"'),{"?":'{\\color{#555}{\\tiny \\char"2B1A}}'},t):n.getAttribute("data-content")&&(n.innerHTML=n.getAttribute("data-content").replace(/&quot;/g,'"')),n.getAttribute("data-aside")&&(n.innerHTML+="<aside>"+n.getAttribute("data-aside").replace(/&quot;/g,'"')+"</aside>"),n.getAttribute("data-classes")&&n.classList.add(n.getAttribute("data-classes"));let r,o=n.getAttribute("data-insert");if(o&&(o=o.replace(/&quot;/g,'"')),o&&di[o]&&(n.setAttribute("data-shifted",di[o].label),n.setAttribute("data-shifted-command",JSON.stringify(["insertAndUnshiftKeyboardLayer",di[o].insert]))),r=n.getAttribute("data-command")?JSON.parse(n.getAttribute("data-command")):n.getAttribute("data-insert")?["insert",n.getAttribute("data-insert"),{focus:!0,feedback:!0,mode:"math",format:"auto",resetStyle:!0}]:n.getAttribute("data-latex")?["insert",n.getAttribute("data-latex"),{focus:!0,feedback:!0,mode:"math",format:"auto",resetStyle:!0}]:["typedText",n.getAttribute("data-key")||n.textContent,{focus:!0,feedback:!0,simulateKeystroke:!0}],i&&(r=[i,r]),n.getAttribute("data-alt-keys")){const t=pi[n.getAttribute("data-alt-keys")];t&&(r={default:r,pressAndHoldStart:["showAlternateKeys",n.getAttribute("data-alt-keys"),t],pressAndHoldEnd:"hideAlternateKeys"})}t._attachButtonHandlers(n,r)}}function yi(t,e){const i={qwerty:{"lower-1":"qwertyuiop","lower-2":" asdfghjkl ","lower-3":"^zxcvbnm~","upper-1":"QWERTYUIOP","upper-2":" ASDFGHJKL ","upper-3":"^ZXCVBNM~","numpad-1":"789/","numpad-2":"456*","numpad-3":"123-","numpad-4":"0.=+"},azerty:{"lower-1":"azertyuiop","lower-2":"qsdfghjklm","lower-3":"^ wxcvbn ~","upper-1":"AZERTYUIOP","upper-2":"QSDFGHJKLM","upper-3":"^ WXCVBN ~"},qwertz:{"lower-1":"qwertzuiop","lower-2":" asdfghjkl ","lower-3":"^yxcvbnm~","upper-1":"QWERTZUIOP","upper-2":" ASDFGHJKL","upper-3":"^YXCVBNM~"},dvorak:{"lower-1":"^  pyfgcrl ","lower-2":"aoeuidhtns","lower-3":"qjkxbmwvz~","upper-1":"^  PYFGCRL ","upper-2":"AOEUIDHTNS","upper-3":"QJKXBMWVZ~"},colemak:{"lower-1":" qwfpgjluy ","lower-2":"arstdhneio","lower-3":"^zxcvbkm~","upper-1":" QWFPGNLUY ","upper-2":"ARSTDHNEIO","upper-3":"^ZXCVBKM~"}},s=i[t.config.virtualKeyboardLayout]?i[t.config.virtualKeyboardLayout]:i.qwerty;let n,r=e,o=(r=r.replace(/<arrows\/>/g,"\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToPreviousChar\"]'\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-left\" /></svg>'\n            data-shifted-command='[\"performWithFeedback\",\"extendToPreviousChar\"]'>\n            <svg><use xlink:href='#svg-arrow-left' /></svg>\n        </li>\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextChar\"]'\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-right\" /></svg>'\n            data-shifted-command='[\"performWithFeedback\",\"extendToNextChar\"]'>\n            <svg><use xlink:href='#svg-arrow-right' /></svg>\n        </li>\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextPlaceholder\"]'>\n        <svg><use xlink:href='#svg-tab' /></svg></li>")).match(/(<row\s+)(.*)((?:<\/row|\/)>)/);for(;o;){n="";const t=o[2].match(/[a-zA-Z][a-zA-Z0-9-]*=(['"])(.*?)\1/g),e={};for(const i of t){const t=i.match(/([a-zA-Z][a-zA-Z0-9-]*)=(['"])(.*?)\2/);e[t[1]]=t[3]}let a=s[e.name];if(a||(a=i.qwerty[e.name]),a)for(const i of a){let t=e.class||"";t&&(t=" "+t),"~"===i?(n+="<li class='action font-glyph bottom right ",n+=a.length-(a.match(/ /g)||[]).length/2==10?"w10":"w15",n+='\' data-shifted=\'<span class="warning"><svg><use xlink:href="#svg-trash" /></svg></span>\'\n                        data-shifted-command=\'"deleteAll"\'\n                        data-alt-keys=\'delete\' data-command=\'["performWithFeedback","deletePreviousChar"]\'\n                        >&#x232b;</li>'):" "===i?n+="<li class='separator w5'></li>":"^"===i?n+="<li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='"+e["shift-layer"]+"'>&#x21e7;</li>":"/"===i?n+="<li class='keycap"+t+"' data-alt-keys='/' data-insert='\\frac{#0}{#?}'>&divide;</li>":"*"===i?n+="<li class='keycap"+t+"' data-alt-keys='*' data-insert='\\times '>&times;</li>":"-"===i?n+="<li class='keycap"+t+"' data-alt-keys='*' data-key='-' data-alt-keys='-'>&#x2212;</li>":/tt/.test(t)?n+="<li class='keycap"+t+"' data-alt-keys='"+i+'\' data-command=\'["typedText","'+i+'",{"commandMode":true, "focus":true, "feedback":true}]\'>'+i+"</li>":n+="<li class='keycap"+t+"' data-alt-keys='"+i+"'>"+i+"</li>"}o=(r=r.replace(new RegExp(o[1]+o[2]+o[3]),n)).match(/(<row\s+)(.*)((?:<\/row|\/)>)/)}return r}var vi={make:function(t,e){let i='<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">\n\n            <symbol id="svg-command" viewBox="0 0 640 512">\n                <path d="M34.495 36.465l211.051 211.05c4.686 4.686 4.686 12.284 0 16.971L34.495 475.535c-4.686 4.686-12.284 4.686-16.97 0l-7.071-7.07c-4.686-4.686-4.686-12.284 0-16.971L205.947 256 10.454 60.506c-4.686-4.686-4.686-12.284 0-16.971l7.071-7.07c4.686-4.687 12.284-4.687 16.97 0zM640 468v-10c0-6.627-5.373-12-12-12H300c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h328c6.627 0 12-5.373 12-12z"/>\n            </symbol>\n\n            <symbol id="svg-undo" viewBox="0 0 512 512">\n                <path d="M20 8h10c6.627 0 12 5.373 12 12v110.625C85.196 57.047 165.239 7.715 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.834 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l7.069-7.069c4.503-4.503 11.749-4.714 16.482-.454C150.782 449.238 200.935 470 256 470c117.744 0 214-95.331 214-214 0-117.744-95.331-214-214-214-82.862 0-154.737 47.077-190.289 116H180c6.627 0 12 5.373 12 12v10c0 6.627-5.373 12-12 12H20c-6.627 0-12-5.373-12-12V20c0-6.627 5.373-12 12-12z"/>\n            </symbol>\n            <symbol id="svg-redo" viewBox="0 0 512 512">\n                <path d="M492 8h-10c-6.627 0-12 5.373-12 12v110.625C426.804 57.047 346.761 7.715 255.207 8.001 118.82 8.428 7.787 120.009 8 256.396 8.214 393.181 119.166 504 256 504c63.926 0 122.202-24.187 166.178-63.908 5.113-4.618 5.354-12.561.482-17.433l-7.069-7.069c-4.503-4.503-11.749-4.714-16.482-.454C361.218 449.238 311.065 470 256 470c-117.744 0-214-95.331-214-214 0-117.744 95.331-214 214-214 82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12z"/>\n            </symbol>\n            <symbol id="svg-arrow-left" viewBox="0 0 192 512">\n                <path d="M25.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L64.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L25 264.5c-4.6-4.7-4.6-12.3.1-17z"/>\n            </symbol>\n            <symbol id="svg-arrow-right" viewBox="0 0 192 512">\n                    <path d="M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17z"/>\n            </symbol>\n            <symbol id="svg-tab" viewBox="0 0 448 512">\n                    <path d="M32 217.1c0-8.8 7.2-16 16-16h144v-93.9c0-7.1 8.6-10.7 13.6-5.7l143.5 143.1c6.3 6.3 6.3 16.4 0 22.7L205.6 410.4c-5 5-13.6 1.5-13.6-5.7v-93.9H48c-8.8 0-16-7.2-16-16v-77.7m-32 0v77.7c0 26.5 21.5 48 48 48h112v61.9c0 35.5 43 53.5 68.2 28.3l143.6-143c18.8-18.8 18.8-49.2 0-68L228.2 78.9c-25.1-25.1-68.2-7.3-68.2 28.3v61.9H48c-26.5 0-48 21.6-48 48zM436 64h-8c-6.6 0-12 5.4-12 12v360c0 6.6 5.4 12 12 12h8c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12z"/>\n            </symbol>\n            <symbol id="svg-copy" viewBox="0 0 448 512">\n                <path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM352 32.491a15.88 15.88 0 0 1 7.431 4.195l51.882 51.883A15.885 15.885 0 0 1 415.508 96H352V32.491zM288 464c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V144c0-8.822 7.178-16 16-16h80v240c0 26.51 21.49 48 48 48h112v48zm128-96c0 8.822-7.178 16-16 16H176c-8.822 0-16-7.178-16-16V48c0-8.822 7.178-16 16-16h144v72c0 13.2 10.8 24 24 24h72v240z"/>\n            </symbol>\n            <symbol id="svg-angle-double-right" viewBox="0 0 320 512">\n                <path d="M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17zm128-17l-117.8-116c-4.7-4.7-12.3-4.7-17 0l-7.1 7.1c-4.7 4.7-4.7 12.3 0 17L255.3 256 153.1 356.4c-4.7 4.7-4.7 12.3 0 17l7.1 7.1c4.7 4.7 12.3 4.7 17 0l117.8-116c4.6-4.7 4.6-12.3-.1-17z"/>\n            </symbol>\n            <symbol id="svg-angle-double-left" viewBox="0 0 320 512">\n                <path d="M153.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L192.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L153 264.5c-4.6-4.7-4.6-12.3.1-17zm-128 17l117.8 116c4.7 4.7 12.3 4.7 17 0l7.1-7.1c4.7-4.7 4.7-12.3 0-17L64.7 256l102.2-100.4c4.7-4.7 4.7-12.3 0-17l-7.1-7.1c-4.7-4.7-12.3-4.7-17 0L25 247.5c-4.6 4.7-4.6 12.3.1 17z"/>\n            </symbol>\n            <symbol id="svg-trash" viewBox="0 0 448 512">\n                <path d="M336 64l-33.6-44.8C293.3 7.1 279.1 0 264 0h-80c-15.1 0-29.3 7.1-38.4 19.2L112 64H24C10.7 64 0 74.7 0 88v2c0 3.3 2.7 6 6 6h26v368c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V96h26c3.3 0 6-2.7 6-6v-2c0-13.3-10.7-24-24-24h-88zM184 32h80c5 0 9.8 2.4 12.8 6.4L296 64H152l19.2-25.6c3-4 7.8-6.4 12.8-6.4zm200 432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V96h320v368zm-176-44V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm-80 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm160 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12z"/>\n            </symbol>\n        </svg>\n        ';ui["foreground-color"]=[];for(const d of ge.LINE_COLORS)ui["foreground-color"].push({classes:"small-button",content:'<span style="border-radius:50%;width:32px;height:32px; box-sizing: border-box; border: 3px solid '+d+'"></span>',command:'["applyStyle",{"color":"'+d+'"}]'});ui["background-color"]=[];for(const d of ge.AREA_COLORS)ui["background-color"].push({classes:"small-button",content:'<span style="border-radius:50%;width:32px;height:32px; background:'+d+'"></span>',command:'["applyStyle",{"backgroundColor":"'+d+'"}]'});pi={...ui},Object.keys(pi).forEach(t=>{pi[t]=pi[t].slice()});const s="abcdefghijklmnopqrstuvwxyz";for(let d=0;d<26;d++){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[d];pi[t]||(pi[t]=[]),pi[t].unshift({latex:"\\mathbb{"+t+"}",aside:"blackboard",insert:"\\mathbb{"+t+"}"}),pi[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),pi[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathsf{"+t+"}"}),pi[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),pi[t].unshift({latex:"\\mathcal{"+t+"}",aside:"script",insert:"\\mathcal{"+t+"}"}),pi[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"}),pi[t].unshift({latex:"\\mathbb{"+s[d]+"}",aside:"blackboard",insert:"\\mathbb{"+s[d]+"}"}),pi[t].unshift({latex:"\\mathbf{"+s[d]+"}",aside:"bold",insert:"\\mathbf{"+s[d]+"}"}),pi[t].unshift({latex:"\\mathsf{"+s[d]+"}",aside:"sans",insert:"\\mathsf{"+s[d]+"}"}),pi[t].unshift({latex:"\\mathcal{"+s[d]+"}",aside:"script",insert:"\\mathcal{"+s[d]+"}"}),pi[t].unshift({latex:"\\mathfrak{"+s[d]+"}",aside:"fraktur",insert:"\\mathfrak{"+s[d]+"}"})}for(let d=0;d<=26;d++){const t=s[d];pi[t]||(pi[t]=[]),pi[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathbb{"+t+"}"}),pi[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),pi[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),pi[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"})}for(let d=0;d<10;d++){const t="0123456789"[d];pi[t]||(pi[t]=[]),pi[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),pi[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathsf{"+t+"}"}),pi[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),pi[t].unshift({latex:"\\mathcal{"+t+"}",aside:"script",insert:"\\mathcal{"+t+"}"}),pi[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"})}let n=t.config.virtualKeyboards;n||(n="all"),n=n.replace(/\ball\b/i,"numeric roman greek functions command");const r=Object.assign({},fi,t.config.customVirtualKeyboardLayers||{}),o=Object.assign({},ci,t.config.customVirtualKeyboards||{}),a=n.replace(/\s+/g," ").split(" ");for(const d of a){if(!o[d])break;let e=o[d].layers||[];o[d].layer&&e.push(o[d].layer),e=Array.from(new Set(e));for(const s of e){if(!r[s])break;if("object"==typeof r[s]){let t="";if(r[s].styles&&(t+=`<style>${r[s].styles}</style>`),r[s].backdrop&&(t+=`<div class='${r[s].backdrop}'>`),r[s].container&&(t+=`<div class='${r[s].container}'>`),r[s].rows){t+="<div class='rows'>";for(const e of r[s].rows){t+="<ul>";for(const i of e)t+="<li",i.class&&(t+=` class="${i.class}"`),i.key&&(t+=` data-key="${i.key}"`),i.command&&("string"==typeof i.command?t+=` data-command='"${i.command}"'`:(t+=" data-command='",t+=JSON.stringify(i.command),t+="'")),i.insert&&(t+=` data-insert="${i.insert}"`),i.latex&&(t+=` data-latex="${i.latex}"`),i.aside&&(t+=` data-aside="${i.aside}"`),i.altKeys&&(t+=` data-alt-keys="${i.altKeys}"`),i.shifted&&(t+=` data-shifted="${i.shifted}"`),i.shiftedCommand&&(t+=` data-shifted-command="${i.shiftedCommand}"`),t+=`>${i.label?i.label:""}</li>`;t+="</ul>"}t+="</div>",r[s].container&&(t+="</div'>"),r[s].backdrop&&(t+="</div'>")}r[s]=t}i+="<div tabindex=\"-1\" class='keyboard-layer' id='"+s+"'>",i+=gi(t,n,d);const e="function"==typeof r[s]?r[s]():r[s];i+=yi(t,e),i+="</div>"}}const l=document.createElement("div");l.className="ML__keyboard",e?l.classList.add(e):t.config.virtualKeyboardTheme?l.classList.add(t.config.virtualKeyboardTheme):/android|cros/i.test(navigator.userAgent)&&l.classList.add("material"),l.innerHTML=i,bi(t,l.querySelectorAll(".keycap, .action, .fnbutton, .bigfnbutton"));const h=l.getElementsByClassName("layer-switch");for(let d=0;d<h.length;++d)h[d].classList.contains("shift")?t._attachButtonHandlers(h[d],{pressed:["shiftKeyboardLayer","shift"],default:["switchKeyboardLayer",h[d].getAttribute("data-layer")],pressAndHoldEnd:"unshiftKeyboardLayer"}):t._attachButtonHandlers(h[d],{default:["switchKeyboardLayer",h[d].getAttribute("data-layer")]});const c=l.getElementsByClassName("keyboard-layer");return Array.from(c).forEach(t=>{t.addEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation()}),t.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation()})}),c[0].classList.add("is-visible"),window.addEventListener("mouseup",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("blur",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("touchend",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("touchcancel",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),l},makeKeycap:bi};const Ci={"−":"-","-":"-","\\alpha":"alpha","\\beta":"beta","\\gamma":"gamma","\\delta":"delta","\\epsilon":"epsilon","\\varepsilon":"varepsilon","\\zeta":"zeta","\\eta":"eta","\\theta":"theta","\\vartheta":"vartheta","\\iota":"iota","\\kappa":"kappa","\\lambda":"lambda","\\mu":"mu","\\nu":"nu","\\xi":"xi","\\pi":"pi","\\rho":"rho","\\sigma":"sigma","\\tau":"tau","\\upsilon":"upsilon","\\phi":"phi","\\varphi":"varphi","\\chi":"chi","\\psi":"psi","\\omega":"omega","\\Gamma":"Gamma","\\Delta":"Delta","\\Theta":"Theta","\\Lambda":"Lambda","\\Xi":"Xi","\\Pi":"Pi","\\Sigma":"Sigma","\\Phi":"Phi","\\Psi":"Psi","\\Omega":"Omega"},xi={"\\pm":"+-","\\times":"xx","\\colon":":","\\vert":"|","\\Vert":"||","\\mid":"|","\\lbrace":"{","\\rbrace":"}","\\langle":"(:","\\rangle":":)"},_i={"\\pm":"&PlusMinus;","\\times":"&times;","\\colon":":","\\vert":"|","\\Vert":"∥","\\mid":"∣","\\lbrace":"{","\\rbrace":"}","\\langle":"⟨","\\rangle":"⟩","\\lfloor":"⌊","\\rfloor":"⌋","\\lceil":"⌈","\\rceil":"⌉","\\vec":"&#x20d7;","\\acute":"&#x00b4;","\\grave":"&#x0060;","\\dot":"&#x02d9;","\\ddot":"&#x00a8;","\\tilde":"&#x007e;","\\bar":"&#x00af;","\\breve":"&#x02d8;","\\check":"&#x02c7;","\\hat":"&#x005e;"};function Pi(t){return t.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Si(t,e){return t&&e.generateID?' extid="'+t+'"':""}function wi(t,e,i){let s=!1,n="",r="",o=-1,a=-1;const l=t.atoms[t.index];if(t.index<(e=e||t.atoms.length)&&("mord"===l.type||"textord"===l.type)&&"0123456789,.".indexOf(l.body)<0&&(r=l.toMathML(i),l.superscript&&(o=t.index),l.subscript&&(a=t.index),t.index+=1),r.length>0){if(s=!0,Ei(t)&&(o=t.index,t.index+=1),ki(t)&&(a=t.index,t.index+=1),o>=0&&a>=0)n="<msubsup>"+r,n+=Li(t.atoms[a].subscript,0,0,i).mathML,n+=Li(t.atoms[o].superscript,0,0,i).mathML,n+="</msubsup>";else if(o>=0){if(n="<msup>"+r,Ei(t)){const e=Li(t.atoms[o].superscript,0,0,i).mathML,s=Li(t.atoms[o+1].superscript,0,0,i).mathML;n+="<mi>′</mi>"!==e&&"<mi>&#x2032;</mi>"!==e||"<mi>′</mi>"!==s&&"<mi>&#x2032;</mi>"!==s?"<mi>′</mi>"===e||"<mi>&#x2032;</mi>"===e?"<mi>&#x2032;</mi>":e:"<mi>&#x2033;</mi>"}else n+=Li(t.atoms[o].superscript,0,0,i).mathML;n+="</msup>"}else a>=0?(n="<msub>"+r,n+=Li(t.atoms[a].subscript,0,0,i).mathML,n+="</msub>"):n=r;"mi"!==t.lastType&&"mn"!==t.lastType&&"mtext"!==t.lastType&&"fence"!==t.lastType||/^<mo>(.*)<\/mo>$/.test(n)||(n="<mo>&InvisibleTimes;</mo>"+n),r.endsWith(">f</mi>")||r.endsWith(">g</mi>")?(n+="<mo> &ApplyFunction; </mo>",t.lastType="applyfunction"):t.lastType=/^<mo>(.*)<\/mo>$/.test(n)?"mo":"mi",t.mathML+=n}return s}function Ei(t){return t.index<t.atoms.length&&t.atoms[t.index].superscript&&"msubsup"===t.atoms[t.index].type}function ki(t){return t.index<t.atoms.length&&t.atoms[t.index].subscript&&"msubsup"===t.atoms[t.index].type}function Ai(t,e,i){let s=!1,n="",r=e.atoms[e.index-1];return!!r&&(r.superscript||r.subscript||(Ei(e)||ki(e))&&(r=e.atoms[e.index],e.index+=1),!!r&&(r.superscript&&r.subscript?(n="<msubsup>"+t,n+=Li(r.subscript,0,0,i).mathML,n+=Li(r.superscript,0,0,i).mathML,n+="</msubsup>"):r.superscript?(n="<msup>"+t,n+=Li(r.superscript,0,0,i).mathML,n+="</msup>"):r.subscript&&(n="<msub>"+t,n+=Li(r.subscript,0,0,i).mathML,n+="</msub>"),n.length>0&&(s=!0,e.mathML+=n,e.lastType=""),s))}function Ti(t,e,i){let s=!1;e=e||t.atoms.length;const n=t.index;let r="";for(;t.index<e&&"text"===t.atoms[t.index].mode;)r+=t.atoms[t.index].body?t.atoms[t.index].body:" ",t.index+=1;return r.length>0&&(s=!0,r="<mtext"+Si(t.atoms[n].id,i)+">"+r+"</mtext>",t.mathML+=r,t.lastType="mtext"),s}function Mi(t,e,i){let s=!1;e=e||t.atoms.length;const n=t.index;let r="",o=function(t){let e=-1,i=t.index,s=!1,n=!1;for(;i<t.atoms.length&&!s&&!n;)n=!(s="mord"!==t.atoms[i].type||"0123456789,.".indexOf(t.atoms[i].body)<0)&&t.atoms[i].superscript,i++;return n&&(e=i-1),e}(t);for(o>=0&&o<e&&(e=o);t.index<e&&"mord"===t.atoms[t.index].type&&"0123456789,.".indexOf(t.atoms[t.index].body)>=0;)r+=t.atoms[t.index].body,t.index+=1;return r.length>0&&(s=!0,r="<mn"+Si(t.atoms[n].id,i)+">"+r+"</mn>",o<0&&Ei(t)&&(o=t.index,t.index+=1),o>=0&&(r="<msup>"+r,r+=Li(t.atoms[o].superscript,0,0,i).mathML,r+="</msup>"),t.mathML+=r,t.lastType="mn"),s}function Oi(t,e,i){let s=!1,n="",r="";if(t.index<(e=e||t.atoms.length)&&"mopen"===t.atoms[t.index].type){let o=!1,a=0;const l=t.index;let h=-1,c=l+1;for(;c<e&&!o;)"mopen"===t.atoms[c].type?a+=1:"mclose"===t.atoms[c].type&&(a-=1),-1===a&&(o=!0,h=c),c+=1;o&&(n="<mrow>",n+=Di(t.atoms[l],i),n+=Li(t.atoms,l+1,h,i).mathML,n+=Di(t.atoms[h],i),n+="</mrow>","mi"!==t.lastType&&"mn"!==t.lastType&&"mfrac"!==t.lastType&&"fence"!==t.lastType||(n="<mo>&InvisibleTimes;</mo>"+n),t.index=h+1,Ai(n,t,i)&&(s=!0,t.lastType="",n=""),r="fence")}return n.length>0&&(s=!0,t.mathML+=n,t.lastType=r),s}function Ni(t,e,i){let s=!1,n="",r="";const o=t.atoms[t.index];if(t.index<(e=e||t.atoms.length)&&("mbin"===o.type||"mrel"===o.type))n+=t.atoms[t.index].toMathML(i),t.index+=1,r="mo";else if(t.index<e&&"mop"===o.type){if("limits"===o.limits&&(o.superscript||o.subscript)){const t=Di(o,i);o.superscript&&o.subscript?(n+=("nolimits"!==o.limits?"<munderover>":"<msubsup>")+t,n+=Li(o.subscript,0,0,i).mathML,n+=Li(o.superscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</munderover>":"</msubsup>"):o.superscript?(n+=("nolimits"!==o.limits?"<mover>":"<msup>")+t,n+=Li(o.superscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</mover>":"</msup>"):(n+=("nolimits"!==o.limits?"<munder>":"<msub>")+t,n+=Li(o.subscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</munder>":"</msub>"),r="mo"}else{const e=t.atoms[t.index],o=0===e.latex.indexOf("\\operatorname"),a=o?'<mi class="MathML-Unit"'+Si(e.id,i)+">"+ji(e.body)+"</mi>":Di(e,i);n+=a,t.index+=1,Ai(n,t,i)&&(s=!0,t.lastType="",n=""),t.index-=1,o||/^<mo>(.*)<\/mo>$/.test(a)?r=o?"mi":"mo":(n+="<mo>&#x2061;</mo>",r="applyfunction")}"mi"!==t.lastType&&"mn"!==t.lastType||/^<mo>(.*)<\/mo>$/.test(n)||(n="<mo>&InvisibleTimes;</mo>"+n),t.index+=1}return n.length>0&&(s=!0,t.mathML+=n,t.lastType=r),s}function Li(t,e,i,s){const n={atoms:t,index:e||0,mathML:"",lastType:""};if(i=i||(t?t.length:0),"number"==typeof t||"boolean"==typeof t)n.mathML=t.toString();else if("string"==typeof t)n.mathML=t;else if(t&&"function"==typeof t.toMathML)n.mathML=t.toMathML(s);else if(Array.isArray(t)){let t=0;for(;n.index<i;)if(Ti(n,i,s)||Mi(n,i,s)||wi(n,i,s)||Ni(n,i,s)||Oi(n,i,s))t+=1;else if(n.index<i){let e=n.atoms[n.index].toMathML(s);"mn"===n.lastType&&e.length>0&&"genfrac"===n.atoms[n.index].type&&(e="<mo>&#x2064;</mo>"+e),n.lastType="genfrac"===n.atoms[n.index].type?"mfrac":"",e.length>0&&(n.mathML+=e,t+=1),n.index+=1}t>1&&(n.mathML="<mrow>"+n.mathML+"</mrow>")}return n}function Di(t,e){let i="";const s=ji(t.body);return s&&(i="<mo"+Si(t.id,e)+">"+s+"</mo>"),i}function ji(t){if(!t)return"";if("string"==typeof t)return Pi(t);if(!Array.isArray(t)&&"string"==typeof t.body)return Pi(t.body);let e="";for(const i of t)"string"==typeof i.body&&(e+=i.body);return Pi(e)}pe.MathAtom.prototype.toMathML=function(t){const e={"\\exponentialE":"&#x02147;","\\imaginaryI":"&#x2148;","\\differentialD":"&#x2146;","\\capitalDifferentialD":"&#x2145;","\\alpha":"&#x03b1;","\\pi":"&#x03c0;","\\infty":"&#x221e;","\\forall":"&#x2200;","\\nexists":"&#x2204;","\\exists":"&#x2203;","\\hbar":"ℏ","\\cdotp":"⋅","\\ldots":"…","\\cdots":"⋯","\\ddots":"⋱","\\vdots":"⋮","\\ldotp":"."},i={"\\!":-3/18,"\\ ":6/18,"\\,":3/18,"\\:":4/18,"\\;":5/18,"\\enspace":.5,"\\quad":1,"\\qquad":2,"\\enskip":.5};let s,n,r,o,a,l,h="",c="",d={cal:"script",frak:"fraktur",bb:"double-struck",scr:"script",cmtt:"monospace",cmss:"sans-serif"}[this.fontFamily||this.font]||"";d&&(d=' mathvariant="'+d+'"');const u=this.latex?this.latex.trim():null;let p;switch(this.type){case"group":case"root":h=Li(this.body,0,0,t).mathML;break;case"array":if((this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence)&&(h+="<mrow>",this.lFence&&"."!==this.lFence&&(h+="<mo>"+(_i[this.lFence]||this.lFence)+"</mo>")),h+="<mtable",this.colFormat){for(h+=' columnalign="',r=0;r<this.colFormat.length;r++)this.colFormat[r].align&&(h+={l:"left",c:"center",r:"right"}[this.colFormat[r].align]+" ");h+='"'}for(h+=">",n=0;n<this.array.length;n++){for(h+="<mtr>",s=0;s<this.array[n].length;s++)h+="<mtd>"+Li(this.array[n][s],0,0,t).mathML+"</mtd>";h+="</mtr>"}h+="</mtable>",(this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence)&&(this.rFence&&"."!==this.rFence&&(h+="<mo>"+(_i[this.lFence]||this.rFence)+"</mo>"),h+="</mrow>");break;case"genfrac":(this.leftDelim||this.rightDelim)&&(h+="<mrow>"),this.leftDelim&&"."!==this.leftDelim&&(h+="<mo"+Si(this.id,t)+">"+(_i[this.leftDelim]||this.leftDelim)+"</mo>"),this.hasBarLine?(h+="<mfrac>",h+=Li(this.numer,0,0,t).mathML||"<mi>&nbsp;</mi>",h+=Li(this.denom,0,0,t).mathML||"<mi>&nbsp;</mi>",h+="</mfrac>"):(h+="<mtable"+Si(this.id,t)+">",h+="<mtr>"+Li(this.numer,0,0,t).mathML+"</mtr>",h+="<mtr>"+Li(this.denom,0,0,t).mathML+"</mtr>",h+="</mtable>"),this.rightDelim&&"."!==this.rightDelim&&(h+="<mo"+Si(this.id,t)+">"+(_i[this.rightDelim]||this.rightDelim)+"</mo>"),(this.leftDelim||this.rightDelim)&&(h+="</mrow>");break;case"surd":this.index?(h+="<mroot"+Si(this.id,t)+">",h+=Li(this.body,0,0,t).mathML,h+=Li(this.index,0,0,t).mathML,h+="</mroot>"):(h+="<msqrt"+Si(this.id,t)+">",h+=Li(this.body,0,0,t).mathML,h+="</msqrt>");break;case"leftright":h="<mrow>",this.leftDelim&&"."!==this.leftDelim&&(h+="<mo"+Si(this.id,t)+">"+(_i[this.leftDelim]||this.leftDelim)+"</mo>"),this.body&&(h+=Li(this.body,0,0,t).mathML),this.rightDelim&&"."!==this.rightDelim&&(h+="<mo"+Si(this.id,t)+">"+(_i[this.rightDelim]||this.rightDelim)+"</mo>"),h+="</mrow>";break;case"sizeddelim":case"delim":h+='<mo separator="true"'+Si(this.id,t)+">"+(_i[this.delim]||this.delim)+"</mo>";break;case"accent":h+='<mover accent="true"'+Si(this.id,t)+">",h+=Li(this.body,0,0,t).mathML,h+="<mo>"+(_i[u]||this.accent)+"</mo>",h+="</mover>";break;case"line":case"overlap":break;case"overunder":o=this.underscript,(a=this.overscript)&&o?l=this.body:a?(l=this.body,this.body[0]&&this.body[0].underscript?(o=this.body[0].underscript,l=this.body[0].body):this.body[0]&&"first"===this.body[0].type&&this.body[1]&&this.body[1].underscript&&(o=this.body[1].underscript,l=this.body[1].body)):o&&(l=this.body,this.body[0]&&this.body[0].overscript?(a=this.body[0].overscript,l=this.body[0].body):this.body[0]&&"first"===this.body[0].type&&this.body[1]&&this.body[1].overscript&&(a=this.body[1].overscript,l=this.body[1].body)),a&&o?(h+="<munderover"+d+Si(this.id,t)+">"+Li(l,0,0,t).mathML,h+=Li(o,0,0,t).mathML,h+=Li(a,0,0,t).mathML,h+="</munderover>"):a?(h+="<mover"+d+Si(this.id,t)+">"+Li(l,t).mathML,h+=Li(a,0,0,t).mathML,h+="</mover>"):o&&(h+="<munder"+d+Si(this.id,t)+">"+Li(l,t).mathML,h+=Li(o,0,0,t).mathML,h+="</munder>");break;case"mord":{h=e[u]||u||("string"==typeof this.body?this.body:""),(p=u?u.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):null)?h="&#x"+p[1]+";":h.length>0&&"\\"===h.charAt(0)&&(h="string"==typeof this.body&&this.body.charCodeAt(0)>255?"&#x"+("000000"+this.body.charCodeAt(0).toString(16)).substr(-4)+";":"string"==typeof this.body?this.body.charAt(0):this.body);const i=/\d/.test(h)?"mn":"mi";h="<"+i+d+Si(this.id,t)+">"+Pi(h)+"</"+i+">";break}case"mbin":case"mrel":case"textord":case"minner":h=u&&e[u]?"<mi"+Si(this.id,t)+">"+e[u]+"</mi>":u&&_i[u]?"<mo"+Si(this.id,t)+">"+_i[u]+"</mo>":Di(this,t);break;case"mpunct":h='<mo separator="true"'+Si(this.id,t)+">"+(_i[u]||u)+"</mo>";break;case"mop":"​"!==this.body&&(h="<mo"+Si(this.id,t)+">",h+="\\operatorname"===u?this.body:u||this.body,h+="</mo>");break;case"mathstyle":break;case"box":h='<menclose notation="box"',this.backgroundcolor&&(h+=' mathbackground="'+ge.stringToColor(this.backgroundcolor)+'"'),h+=Si(this.id,t)+">"+Li(this.body,0,0,t).mathML+"</menclose>";break;case"spacing":h+='<mspace width="'+(i[u]||0)+'em"/>';break;case"enclose":h='<menclose notation="';for(const t in this.notation)Object.prototype.hasOwnProperty.call(this.notation,t)&&this.notation[t]&&(h+=c+t,c=" ");h+=Si(this.id,t)+'">'+Li(this.body,0,0,t).mathML+"</menclose>";break;case"space":h+="&nbsp;"}return h},pe.toMathML=function(t,e){return Li(t,0,0,e).mathML};const Ii={"\\imaginaryI":"ⅈ","\\imaginaryJ":"ⅉ","\\pi":"π","\\exponentialE":"ℯ","﹢":"+","＋":"+","−":"-","-":"-","﹣":"-","－":"-","\\times":"*","\\cdot":"*","⨉":"*","️✖":"*","️×":"*",".":"*","÷":"/","⁄":"/","／":"/","!":"factorial","\\mp":"minusplus","\\ne":"!=","\\coloneq":":=","\\questeq":"?=","\\approx":"approx","\\cong":"congruent","\\sim":"similar","\\equiv":"equiv","\\pm":"plusminus","\\land":"and","\\wedge":"and","\\lor":"or","\\vee":"or","\\oplus":"xor","\\veebar":"xor","\\lnot":"not","\\neg":"not","\\exists":"exists","\\nexists":"!exists","\\forall":"forAll","\\backepsilon":"suchThat","\\therefore":"therefore","\\because":"because","\\nabla":"nabla","\\circ":"circle","\\ominus":"ominus","\\odot":"odot","\\otimes":"otimes","\\zeta":"Zeta","\\Gamma":"Gamma","\\min":"min","\\max":"max","\\mod":"mod","\\lim":"lim","\\sum":"sum","\\prod":"prod","\\int":"integral","\\iint":"integral2","\\iiint":"integral3","\\Re":"Re","\\gothicCapitalR":"Re","\\Im":"Im","\\gothicCapitalI":"Im","\\binom":"nCr","\\partial":"partial","\\differentialD":"differentialD","\\capitalDifferentialD":"capitalDifferentialD","\\Finv":"Finv","\\Game":"Game","\\wp":"wp","\\ast":"ast","\\star":"star","\\asymp":"asymp","\\to":"to","\\gets":"gets","\\rightarrow":"shortLogicalImplies","\\leftarrow":"shortLogicalImpliedBy","\\leftrightarrow":"shortLogicalEquivalent","\\longrightarrow":"logicalImplies","\\longleftarrow":"logicalImpliedBy","\\longleftrightarrow":"logicalEquivalent","\\Rightarrow":"shortImplies","\\Leftarrow":"shortImpliedBy","\\Leftrightarrow":"shortEquivalent","\\implies":"implies","\\Longrightarrow":"implies","\\impliedby":"impliedBy","\\Longleftarrow":"impliedBy","\\iff":"equivalent","\\Longleftrightarrow":"equivalent"},Ri={"+":"add","*":"multiply","-":"subtract","/":"divide","=":"equal",":=":"assign","!=":"ne","?=":"questeq",approx:"approx",congruent:"congruent",similar:"similar",equiv:"equiv","<":"lt",">":"gt","<=":"le",">=":"ge","≤":"le","≥":"ge",">>":"gg","<<":"ll","**":"pow","++":"increment","--":"decrement"},Bi={equal:"%0 = %1",ne:"%0 \\ne %1",questeq:"%0 \\questeq %1",approx:"%0 \\approx %1",congruent:"%0 \\cong %1",similar:"%0 \\sim %1",equiv:"%0 \\equiv %1",assign:"%0 := %1",lt:"%0 < %1",gt:"%0 > %1",le:"%0 \\le %1",ge:"%0 \\ge %1",sin:"\\sin%_%^ %0",cos:"\\cos%_%^ %0",tan:"\\tan%_%^ %0",cot:"\\cot%_%^ %0",sec:"\\sec%_%^ %0",csc:"\\csc%_%^ %0",sinh:"\\sinh %0",cosh:"\\cosh %0",tanh:"\\tanh %0",csch:"\\csch %0",sech:"\\sech %0",coth:"\\coth %0",arcsin:"\\arcsin %0",arccos:"\\arccos %0",arctan:"\\arctan %0",arccot:"\\arcctg %0",arcsec:"\\arcsec %0",arccsc:"\\arccsc %0",arsinh:"\\arsinh %0",arcosh:"\\arcosh %0",artanh:"\\artanh %0",arcsch:"\\arcsch %0",arsech:"\\arsech %0",arcoth:"\\arcoth %0",ln:"\\ln%_%^ %",log:"\\log%_%^ %",lg:"\\lg %",lb:"\\lb %",sum:"\\sum%_%^ %0",prod:"\\prod%_%^ %0",Zeta:"\\zeta%_%^ %",Gamma:"\\Gamma %",min:"\\min%_%^ %",max:"\\max%_%^ %",mod:"\\mod%_%^ %",lim:"\\lim%_%^ %",binom:"\\binom %",nabla:"\\nabla %",curl:"\\nabla\\times %0",div:"\\nabla\\cdot %0",floor:"\\lfloor %0 \\rfloor%_%^",ceil:"\\lceil %0 \\rceil%_%^",abs:"\\left| %0 \\right|%_%^",norm:"\\lVert %0 \\rVert%_%^",ucorner:"\\ulcorner %0 \\urcorner%_%^",lcorner:"\\llcorner %0 \\lrcorner%_%^",angle:"\\langle %0 \\rangle%_%^",group:"\\lgroup %0 \\rgroup%_%^",moustache:"\\lmoustache %0 \\rmoustache%_%^",brace:"\\lbrace %0 \\rbrace%_%^","sqrt[]":"\\sqrt[%^]{%0}",sqrt:"\\sqrt{%0}",lcm:"\\operatorname{lcm}%",gcd:"\\operatorname{gcd}%",erf:"\\operatorname{erf}%",erfc:"\\operatorname{erfc}%",randomReal:"\\operatorname{randomReal}%",randomInteger:"\\operatorname{randomInteger}%",and:"%0 \\land %1",or:"%0 \\lor %1",xor:"%0 \\oplus %1",not:"%0 \\lnot %1",circle:"%0 \\circ %1",ast:"%0 \\ast %1",star:"%0 \\star %1",asymp:"%0 \\asymp %1","/":"\\frac{%0}{%1}",Re:"\\Re{%0}",Im:"\\Im{%0}",factorial:"%0!",factorial2:"%0!!"},Fi={degree:880,nabla:740,curl:740,partial:740,differentialD:740,capitalDifferentialD:740,"**":720,odot:710,not:680,div:660,solidus:660,"/":660,setminus:650,"%":640,otimes:410,union:350,intersection:350,"*":390,ast:390,".":390,oplus:300,ominus:300,"+":275,"-":275,"+-":275,"-+":275,circle:265,circledast:265,circledcirc:265,star:265,"..":263,to:262,in:262,"|":261,congruent:265,equiv:260,"=":260,"!=":255,"?=":255,similar:250,approx:247,"<":245,">":243,">=":242,"≥":242,"<=":241,complement:240,subset:240,superset:240,elementof:240,"!elementof":240,exists:230,"!exists":230,forall:230,and:200,xor:195,or:190,suchThat:110,":":100,assign:80,":=":80,therefore:70,because:70,shortLogicalImplies:52,shortImplies:51,logicalImplies:50,implies:49,shortLogicalImpliedBy:48,shortImpliedBy:47,logicalImpliedBy:46,impliedBy:45,shortLogicalEquivalent:44,shortEquivalent:43,logicalEquivalent:42,equivalent:41,",":40,";":30};function Yi(t,e){return Array.isArray(t.arg)?t.arg[e]:void 0}function zi(t){return t&&Fi[t]||-1}function Xi(t){return/=|=>/.test(t)?"right":"left"}function Ui(t){if("f"===t||"g"===t)return!0;const e=Bi[t];return!!e&&!!/%[^01_^]?/.test(e)}function Gi(t){t=(t||"").trim();let e=Ii[t];if(!e)if(/^\\[^{}]+$/.test(t)){const i=Rt.getInfo(t,"math",{});e=i&&i.value||t.slice(1)}else e=t;return e}function Hi(t){if(!t)return null;const e=Gi(Ki(t)),i=[zi(e),Xi(e)];return i[0]<=0?null:i}function qi(t){return null!==Hi(t)}const Ji={"\\lfloor\\rfloor":"floor","\\lceil\\rceil":"ceil","\\vert\\vert":"abs","\\lvert\\rvert":"abs","||":"abs","\\Vert\\Vert":"norm","\\lVert\\rVert":"norm","\\ulcorner\\urcorner":"ucorner","\\llcorner\\lrcorner":"lcorner","\\langle\\rangle":"angle","\\lgroup\\rgroup":"group","\\lmoustache\\rmoustache":"moustache","\\lbrace\\rbrace":"brace"},Vi={"!":"factorial","\\dag":"dagger","\\dagger":"dagger","\\ddagger":"dagger2","\\maltese":"maltese","\\backprime":"backprime","\\backdoubleprime":"backprime2","\\prime":"prime","\\doubleprime":"prime2","\\$":"$","\\%":"%","\\_":"_","\\degree":"degree"},$i={"+":"add","-":"add","*":"multiply","=":"equal",",":"list",";":"list2",and:"and",or:"or",xor:"xor",union:"union",shortLogicalEquivalent:"logicalEquivalent",logicalEquivalent:"logicalEquivalent",shortEquivalent:"equivalent",equivalent:"equivalent"},Wi={",":"list",";":"list2"};function Ki(t){if(Array.isArray(t)){let e="";for(const i of t)e+=Ki(i);return e}if(t.latex&&!/^\\math(op|bin|rel|open|punct|ord|inner)/.test(t.latex))return t.latex.trim();if("leftright"===t.type)return"";if("string"==typeof t.body)return t.body;if(Array.isArray(t.body)){let e="";for(const i of t.body)e+=Ki(i);return e}return""}function Zi(t){return"string"==typeof t.sym?function(t){let e=Bi[t];if(e)return e.replace("%1","").replace("%0","").replace("%","");if(t.length>1){const i=Rt.getInfo("\\"+t,"math");!i||i.fontFamily&&"cmr"!==i.fontFamily&&"ams"!==i.fontFamily||(e="\\"+t)}return e||(e=Rt.unicodeStringToLatex("math",t)),e}(t.sym)||t.sym:""}function Qi(t){return parseFloat(t.num)}function ts(t){return"object"==typeof t&&void 0!==t.num}function es(t){let e=0;return ts(t)&&(e="object"==typeof t.num?void 0!==t.num.re?Cs(t.num.re):0:parseFloat(t.num)),e}function is(t){let e=0;return ts(t)&&"object"==typeof t.num&&(e=void 0!==t.num.im?Cs(t.num.im):0),e}function ss(t){return t&&void 0!==t.sup}function ns(t){return t&&void 0!==t.sub}function rs(t,e,i){let s=!1;const n=t.atoms[t.index];return n&&n.type===e&&(s=void 0===i||Ki(n)===i),s}function os(t,...e){const i={fn:t};if(e){const t=[];for(const i of e)i&&t.push(i);t.length>0&&(i.arg=t)}return i}function as(t){return"number"==typeof t?{num:t.toString()}:"string"==typeof t?{num:t}:"object"==typeof t?{num:t}:void 0}function ls(t){if(ts(t)){const e=es(t),i=is(t);return 0!==i?(0!==e&&(t.num.re=(-e).toString()),t.num.im=(-i).toString()):t.num=(-e).toString(),t}return os("negate",t)}function hs(t){const e=t.atoms[t.index+1];return e&&"msubsup"===e.type}function cs(t,e){let i=t.atoms[t.index];return!i||void 0===i.superscript&&void 0===i.subscript?i=null:t.index+=1,i||((i=t.atoms[t.index+1])&&"msubsup"===i.type&&(i.superscript||i.subscript)?t.index+=2:i=null),i?(void 0!==i.subscript&&(t.ast.sub=bs(i.subscript,e)),void 0!==i.superscript&&("msubsup"===i.type?/['\u2032]|\\prime/.test(Ki(i.superscript))?(t.index+=1,(i=t.atoms[t.index+1])&&"msubsup"===i.type&&/['\u2032]|\\prime/.test(Ki(i.superscript))?t.ast.sup={sym:"″"}:(t.ast.sup={sym:"′"},t.index-=1)):/['\u2033]|\\doubleprime/.test(Ki(i.superscript))?t.ast.sup={sym:"″"}:t.ast&&(t.ast.sup=bs(i.superscript,e)):t.ast.sup=bs(i.superscript,e))):t.index+=1,t}function ds(t,e){const i=t.ast;if(ps(t,"!!"))return t.index+=1,t.ast=os("factorial2",i),ds(t=cs(t,e),e);if(ps(t,"++"))return t.index+=1,t.ast=os("increment",i),ds(t=cs(t,e),e);if(ps(t,"--"))return t.index+=1,t.ast=os("decrement",i),ds(t=cs(t,e),e);const s=t.atoms[t.index];return s&&s.latex&&Vi[s.latex.trim()]&&(t.ast=os(Vi[s.latex.trim()],i),t=ds(t=cs(t,e),e)),t}function us(t,e,i,s){if(t.index=t.index||0,0===t.atoms.length||t.index>=t.atoms.length)return t.ast=void 0,t;const n=t.minPrec;t.minPrec=0;let r=t.atoms[t.index];if(e){if("mopen"===r.type&&Ki(r)===e)t.index+=1,(r=(t=ms(t,s)).atoms[t.index])&&"mclose"===r.type&&Ki(r)===i&&(hs(t)&&(t.ast={group:t.ast}),t=ds(t=cs(t,s),s));else if("textord"===r.type&&Ki(r)===e)t.index+=1,(r=(t=ms(t,s)).atoms[t.index])&&"textord"===r.type&&Ki(r)===i&&(t.index+=1,t=ds(t=cs(t,s),s));else if("\\lVert"===e&&"textord"===r.type&&"|"===r.latex){if((r=t.atoms[t.index+1])&&"textord"===r.type&&"|"===r.latex){t.index+=2,r=(t=ms(t,s)).atoms[t.index];const e=t.atoms[t.index+1];r&&"textord"===r.type&&"|"===r.latex&&e&&"textord"===e.type&&"|"===e.latex&&(t.index+=2,t=ds(t=cs(t,s),s))}}else if("sizeddelim"===r.type&&r.delim===e)t.index+=1,(r=(t=ms(t,s)).atoms[t.index])&&"sizeddelim"===r.type&&r.delim===i&&(t.index+=1,t=ds(t=cs(t,s),s));else{if("leftright"!==r.type||r.leftDelim!==e||"?"!==r.rightDelim&&r.rightDelim!==i)return;t.ast=bs(r.body,s),hs(t)&&(t.ast={group:t.ast}),t=ds(t=cs(t,s),s)}return t.minPrec=n,t}{let s=!0;if("mopen"===r.type?(e=r.latex.trim(),i=Rt.RIGHT_DELIM[e]):"sizeddelim"===r.type?i=Rt.RIGHT_DELIM[e=r.delim]:"leftright"===r.type?(s=!1,e=r.leftDelim,"?"===(i=r.rightDelim)&&(i=Rt.RIGHT_DELIM[e])):"textord"===r.type&&(e=r.latex.trim(),i=Rt.RIGHT_DELIM[e]),e&&i){if("|"===e&&"|"===i){const s=t.atoms[t.index+1];s&&"textord"===s.type&&"|"===s.latex&&(e="\\lVert",i="\\rVert")}if(t=us(t,e,i))return s&&(t.index+=1),t.ast={fn:Ji[e+i]||e+i,arg:[t.ast]},t.minPrec=n,t}}}function ps(t,e){return t.index=t.index||0,!(t.atoms.length<=1||t.index>=t.atoms.length-1)&&e===Ki(t.atoms[t.index])+Ki(t.atoms[t.index+1])}function fs(t){if(t.index=t.index||0,!(t.atoms.length<=1||t.index>=t.atoms.length-1)){if(!rs(t,"textord","\\nabla")){const e=t.atoms[t.index].latex+t.atoms[t.index+1].latex,i=/^(>=|<=|>>|<<|:=|!=|\*\*|\+\+|--)$/.test(e)?e:"";return i&&(t.index+=1),i}return t.index+=1,rs(t,"mbin","\\times")?(t.index+=1,t.ast="curl",t):rs(t,"mbin","\\cdot")?(t.index+=1,t.ast="div",t):void(t.index-=1)}}function ms(t,e){if(t.index=t.index||0,t.ast=void 0,0===t.atoms.length||t.index>=t.atoms.length)return t;t.minPrec=t.minPrec||0;let i=function t(e,i){if(e.index=e.index||0,e.ast=void 0,0===e.atoms.length||e.index>=e.atoms.length)return e;let s=e.atoms[e.index];const n=Gi(Ki(s));if(fs(e))e.ast=os(e.ast,t(e,i).ast);else{if("root"===s.type)return e.index=0,e.atoms=s.body,t(e,i);if("mbin"===s.type&&"-"===n)e.index+=1,(e=t(e,i)).ast=ls(e.ast);else if("mbin"===s.type&&"+"===n)e.index+=1,(e=t(e,i)).ast=os("add",e.ast);else if("mord"===s.type&&/^[0-9.]$/.test(s.latex)){let n="",r=!1,o=/^[0-9.eEdD]$/;for(;e.index<e.atoms.length&&!r&&(rs(e,"spacing")||(rs(e,"mord")||rs(e,"mpunct",",")||rs(e,"mbin"))&&o.test(e.atoms[e.index].latex));)if("spacing"===e.atoms[e.index].type)e.index+=1;else if(void 0!==e.atoms[e.index].superscript||void 0!==e.atoms[e.index].subscript)r=!0;else{let t=e.atoms[e.index].latex;"d"===t||"D"===t?(t="e",o=/^[0-9+-.]$/):"e"===t||"E"===t?hs(e)?(t="",e.index-=1,r=!0):(t="E",o=/^[0-9+-.]$/):o===/^[0-9+-.]$/&&(o=/^[0-9]$/),n+=","===t?"":t,e.index+=1}if(e.ast=n?as(n):void 0,(s=e.atoms[e.index])&&"genfrac"===s.type&&!isNaN(e.ast.num)){const s=e.ast;(e=t(e,i)).ast=os("add",s,e.ast)}if(s&&"group"===s.type&&s.latex&&s.latex.startsWith("\\nicefrac")){const s=e.ast;(e=t(e,i)).ast=os("add",s,e.ast)}s&&"msubsup"===s.type&&(e=cs(e,i)),e=ds(e,i)}else if("genfrac"===s.type||"surd"===s.type)e.ast=s.toAST(i),e=ds(e=cs(e,i),i);else if("mord"===s.type||"mbin"===s.type){if(Ui(n)&&!qi(s)){e.ast={fn:n};const s=(e=cs(e,i)).ast,r=t(e,i).ast;r&&/^(list0|list|list2)$/.test(r.fn)?s.arg=s.arg?s.arg.arg:void 0:r&&(s.arg=[r]),e.ast=s}else e.ast=s.toAST(i),"ⅈ"===e.ast.sym&&(e.ast=as({im:"1"})),e=cs(e);e=ds(e,i)}else if("textord"===s.type){if(!qi(s)&&!Rt.RIGHT_DELIM[s.latex?s.latex.trim():s.body])if(Ui(n)){e.ast={fn:n};const s=(e=cs(e,i)).ast;e.index+=1,s.arg=[t(e,i).ast],e.ast=s,e=ds(e,i)}else e.ast=s.toAST(i),void 0===s.superscript&&(e.index+=1),e=ds(e=cs(e,i),i)}else if("mop"===s.type){if((/^\\(mathop|operatorname|operatorname\*)/.test(s.latex)||Ui(n))&&!qi(s))if(e.ast={fn:/^\\(mathop|operatorname|operatorname\*)/.test(s.latex)?s.body:n},ss((e=cs(e,i)).ast)){const s={sin:"arcsin",cos:"arccos",tan:"arctan",cot:"arccot",sec:"arcsec",csc:"arccsc",sinh:"arsinh",cosh:"arcosh",tanh:"artanh",csch:"arcsch",sech:"arsech",coth:"arcoth"};if(-1===Qi(e.ast.sup)&&s[n])e.ast=os(s[n],t(e,i).ast);else{const s=e.ast;s.arg=[t(e,i).ast],e.ast=s}}else{const s=e.ast,n=t(e,i).ast;n&&/^(list0|list|list2)$/.test(n.fn)?s.arg=n.arg:n&&(s.arg=[n]),e.ast=s}}else if("array"===s.type)e.index+=1,e.ast=s.toAST(i);else if("group"===s.type)e.index+=1,e.ast=s.toAST(i);else{if("mclose"===s.type)return e;if("error"===s.type)return e.index+=1,e.ast={error:s.latex},e}}if(void 0===e.ast){const t=us(e,"(",")",i)||us(e,null,null,i);t?e=t:qi(s)||("placeholder"===s.type?e.ast=as(0):(e.ast={text:"?"},e.ast.error="Unexpected token '"+s.type+"'",s.latex?e.ast.latex=s.latex:s.body&&s.toLatex&&(e.ast.latex=s.toLatex())),e.index+=1)}if((s=e.atoms[e.index])&&("mord"===s.type||"surd"===s.type||"mop"===s.type||"mopen"===s.type||"sizeddelim"===s.type||"leftright"===s.type)){if("sizeddelim"===s.type)for(const t in Rt.RIGHT_DELIM)if(s.delim===Rt.RIGHT_DELIM[t])return e.index+=1,e;if(("mord"===s.type||"textord"===s.type||"mop"===s.type)&&qi(s))return e;const n=e.ast;e.ast={},(e=t(e,i))&&e.ast&&n?Ui(n.fn)&&void 0===n.arg||Array.isArray(n.arg)&&0===n.arg.length?e.ast="list2"===e.ast.fn||"list"===e.ast.fn?os(n.fn,e.ast.arg):os("multiply",n,e.ast):"multiply"===e.ast.fn?e.ast.arg.unshift(n):e.ast=0===is(n)&&0!==es(n)&&1===is(e.ast)&&0===es(e.ast)?as({im:es(n).toString()}):os("multiply",n,e.ast):e.ast=n}return e}(t,e).ast,s=!1;const n=t.minPrec;for(;!s;){const r=t.atoms[t.index],o=fs(t);let a,l;if((s=!r||"text"===r.mode||!o&&!qi(r))||([a,l]=o?[zi(o),Xi(o)]:Hi(r),s=a<n),!s){const n=o||Gi(Ki(r));if(t.minPrec="left"===l?a+1:a,t.index+=1,"|"===n)if(void 0!==r.subscript||t.atoms[t.index]&&void 0!==t.atoms[t.index].subscript&&"msubsup"===t.atoms[t.index].type){t.ast={};const s=cs(t,e).ast.sub;if(i=os("bind",i),s&&"equal"===s.fn&&i.arg)i.arg.push(Yi(s,0)),i.arg.push(Yi(s,1));else if(s&&i.arg&&("list"===s.fn||"list2"===s.fn)){let t={sym:"x"};for(let e=0;e<s.arg.length;e++)"equal"===s.arg[e].fn?(t=Yi(s.arg[e],0),i.arg.push(t),i.arg.push(Yi(s.arg[e],1))):(i.arg.push(t),i.arg.push(s.arg[e]))}else s&&(i.arg.push({sym:"x"}),i.arg.push(s))}else s=!0;else{const s=ms(t,e).ast;let r=Wi[n];r&&i&&i.fn!==r&&(i=os(r,i)),"-"===n?i&&i.arg&&"add"===i.fn?void 0!==s&&i.arg.push(ls(s)):i=i&&"subtract"===i.fn?os("add",Yi(i,0),ls(Yi(i,1)),ls(s)):!ts(i)||ss(i)||!ts(s)||ss(s)||void 0!==s.num.re&&"0"!==s.num.re||void 0===s.num.im?os("subtract",i,s):{num:{re:i.num,im:(-parseFloat(s.num.im)).toString()}}:"add"===(r=$i[n])&&i&&"subtract"===i.fn?i=os("add",Yi(i,0),ls(Yi(i,1)),s):r&&i&&i.fn===r&&!ss(i)?void 0!==s&&(s.fn===r&&!ss(s)&&s.arg?i.arg=[...i.arg,...s.arg]:i.arg&&i.arg.push(s)):r&&s&&s.arg&&s.fn===r?(s.arg.unshift(i),i=s):i="multiply"===r&&ts(i)&&!ss(i)&&s&&10===Qi(s)&&ts(s.sup)?as(Qi(i)*Math.pow(10,Qi(s.sup))):"add"===r&&ts(i)&&!ss(i)&&s&&0!==is(s)&&!ss(s)?{num:{re:i.num,im:s.num.im}}:os(r||Ri[n]||n,i,s)}}}return t.ast=i,t}function gs(t){if(!t)return[];let e;if(Array.isArray(t)){e=[];for(const i of t){const t=gs(i);e=e.concat(t)}}else{if("spacing"===t.type)return[];"first"===t.type||"box"===t.type?e=gs(t.body):(t.body&&Array.isArray(t.body)&&(t.body=gs(t.body)),t.superscript&&Array.isArray(t.superscript)&&(t.superscript=gs(t.superscript)),t.subscript&&Array.isArray(t.subscript)&&(t.subscript=gs(t.subscript)),t.index&&Array.isArray(t.index)&&(t.index=gs(t.index)),t.denom&&Array.isArray(t.denom)&&(t.denom=gs(t.denom)),t.numer&&Array.isArray(t.numer)&&(t.numer=gs(t.numer)),t.array&&Array.isArray(t.array)&&(t.array=t.array.map(t=>t.map(t=>gs(t)))),e=[t])}return e}function bs(t,e){return function(t,e){t.index=t.index||0,t.ast=void 0;const i=[];for(;t.atoms[t.index];)if("text"===t.atoms[t.index].mode){let e="";for(;t.atoms[t.index]&&"text"===t.atoms[t.index].mode;)e+=t.atoms[t.index].body,t.index+=1;i.push(e)}else{const s=ms(t,e).ast;if(!s)return;i.push(s)}return i.length>1?os("text",...i):i[0]||void 0}({atoms:gs(t)},e)}function ys(t){const e=Array.prototype.slice.call(arguments);e.shift(),t=t||".. ";let i="";if(e.length>0){"."!==t[0]&&(i+=t[0]);let s="";for(const n of e)i+=s+n,s=t[2];"."!==t[1]&&(i+=t[1])}return i}function vs(t,e){const i=t.length;t=t.substr(0,e.precision-2);for(let s=0;s<t.length-16;s++){const i=t.substr(0,s);for(let n=0;n<17;n++){const r=t.substr(s,n+1),o=Math.floor((t.length-i.length)/r.length);if(o>1&&(i+r.repeat(o+1)).startsWith(t))return"0"===r?i.replace(/(\d{3})/g,"$1"+e.groupSeparator):i.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.beginRepeatingDigits+r.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.endRepeatingDigits}}return i!==t.length&&(t+="\\ldots"),t.replace(/(\d{3})/g,"$1"+e.groupSeparator)}function Cs(t){return parseFloat(parseFloat(t).toPrecision(15))}function xs(t,e){let i="";if("number"==typeof e.precision){if("number"!=typeof t){let i="",s="";if("-"===t[0]?(i="-",t=t.substr(1)):"+"===t[0]&&(t=t.substr(1)),t.indexOf(".")>=0){const n=t.match(/(\d*).(\d*)([e|E]([-+]?[0-9]*))?/),r=n[1],o=n[2].substring(0,Math.min(e.precision-r.length,n[2].length));if(s=n[4]||"","0"===r){let s=0;for(;"0"===o[s]&&s<o.length;)s+=1;let n="";if(s<=4)n="0"+e.decimalMarker,n+=o.substr(0,s),n+=vs(t.substr(n.length),e);else if(s+1>=e.precision)n="0",i="";else{n=t[s];const i=vs(t.substr(s+1),e);i&&(n+=e.decimalMarker+i)}"0"!==n&&(t.length-1>e.precision&&!n.endsWith("}")&&!n.endsWith("\\ldots")&&(n+="\\ldots"),s>4&&(n+=e.exponentProduct,n+=e.exponentMarker?e.exponentMarker+(1-s).toString():"10^{"+(1-s).toString()+"}")),t=n}else{t=r.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator);const i=vs(o,e);i&&(t+=e.decimalMarker+i)}}else if(t.length>e.precision){const i=t.length;let s=t[0];const n=vs(t.substr(2),e);n&&"}"!==(s+=e.decimalMarker+n)[s.length-1]&&(s+="\\ldots"),"1"!==s?s+=e.exponentProduct:s="",t=s+=e.exponentMarker?e.exponentMarker+(i-2).toString():"10^{"+(i-2).toString()+"}"}else t=t.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator);return s&&(s=e.exponentMarker?e.exponentMarker+s:e.exponentProduct+" 10^{"+s+"}"),i+t+s}t=Cs(t)}if("engineering"===e.scientificNotation)if(0===t)i="0";else{const s=Math.abs(t);let n=Math.round(Math.log10(s));n-=n%3,s<1e3&&(n=0);let r=s/Math.pow(10,n);const o=r.toString().match(/^(.*)\.(.*)$/);o&&o[1]&&o[2]&&(r=o[1]+e.decimalMarker+o[2]),e.groupSeparator&&(r=vs(r.toExponential(),e)),i=(t<0?"-":"")+r+(n=0===n?"":e.exponentMarker?e.exponentMarker+n:e.exponentProduct+" 10^{"+n+"}")}else{const s="string"==typeof t?t:t.toString();let n,r,o,a=s.match(/^(.*)[e|E]([-+]?[0-9]*)$/i);n=s,o="",a&&a[1]&&a[2]&&(n=a[1],r=e.exponentMarker?e.exponentMarker+a[2]:e.exponentProduct+" 10^{"+a[2]+"}"),(a=n.match(/^(.*)\.(.*)$/))&&a[1]&&a[2]&&(n=a[1],o=a[2]),e.groupSeparator&&(n=n.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator),o=vs(o,e)),o&&(o=e.decimalMarker+o),i=n+o+(r||"")}return i}pe.MathAtom.prototype.toAST=function(t){let e,i,s,n,r={},o="",a={bb:"double-struck",cal:"script",scr:"script",frak:"fraktur",cmrss:"sans-serif",cmrtt:"monospace"}[this.baseFontFamily||this.fontFamily],l="";"b"===this.fontSeries&&(l+="bold"),"it"===this.fontShape&&(l+="italic");const h=this.latex?this.latex.trim():null;switch(this.type){case"root":case"group":this.latex&&this.latex.startsWith("\\nicefrac")?(e=this.latex.slice(9).match(/({.*}|[^}])({.*}|[^}])/))?(i=1===e[1].length?e[1]:e[1].substr(1,e[1].length-2),i=Ce.parseTokens(v.tokenize(i),"math",null,t.macros),s=1===e[2].length?e[2]:e[2].substr(1,e[2].length-2),s=Ce.parseTokens(v.tokenize(s),"math",null,t.macros),r=os("divide",bs(i,t),bs(s,t))):r.fn="divide":r.group=bs(this.body,t);break;case"genfrac":r=os("divide",bs(this.numer,t),this.denom&&this.denom[0]&&"placeholder"===this.denom[0].type?as(1):bs(this.denom,t));break;case"surd":r=this.index?os("pow",bs(this.body,t),os("divide",1,bs(this.index,t))):os("sqrt",bs(this.body,t));break;case"rule":break;case"line":case"overlap":case"accent":case"overunder":break;case"mord":case"textord":case"mbin":(e=h?h.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):void 0)?o=String.fromCodePoint(parseInt(e[1],16)):(o=Gi(Ki(this))).length>0&&"\\"===o.charAt(0)&&"string"==typeof this.body&&(o=this.body),(n=Rt.mathVariantToUnicode(o,a,l).replace(/[\\]/g,"\\\\").replace(/["]/g,'\\"').replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t"))!==o?(r={sym:n},a="normal"):r={sym:o};break;case"minner":case"mop":break;case"box":r=bs(this.body,t);break;case"enclose":break;case"array":if("cardinality"===this.env.name)r=os("card",bs(this.array,t));else if(/array|matrix|pmatrix|bmatrix/.test(this.env.name)){r={fn:"array",args:[]};for(const e of this.array)r.args.push(e.map(e=>bs(e,t)))}else if("cases"===this.env.name){r={fn:"cases",args:[]};for(const e of this.array)if(e[0]){const i=[];i.push(bs(e[0],t));let s=bs(e[1],t);s&&"text"===s.fn&&s.arg&&/^(if|when|for)$/i.test(s.arg[0].trim())&&(s=s.arg.filter(t=>"string"!=typeof t)),i.push(s||{}),r.args.push(i)}}break;case"spacing":case"space":case"mathstyle":break;default:r=void 0}return r&&a&&"normal"!==a&&(r.variant=a),r&&"string"==typeof this.cssClass&&(r.class=this.cssClass),r&&"string"==typeof this.cssId&&(r.id=this.cssId),r},pe.toAST=function(t,e){return bs(t,e)};const _s={"\\alpha":"alpha ","\\mu":"mew ","\\sigma":"sigma ","\\pi":"pie ","\\imaginaryI":"eye ","\\sum":"Summation ","\\prod":"Product ",a:'<phoneme alphabet="ipa" ph="eɪ">a</phoneme>',A:'capital <phoneme alphabet="ipa" ph="eɪ">A</phoneme>',"+":"plus ","-":"minus ",";":'<break time="150ms"/> semi-colon <break time="150ms"/>',",":'<break time="150ms"/> comma  <break time="150ms"/>',"|":'<break time="150ms"/>Vertical bar<break time="150ms"/>',"(":'<break time="150ms"/>Open paren. <break time="150ms"/>',")":'<break time="150ms"/> Close paren. <break time="150ms"/>',"=":"equals ","<":"is less than ","\\lt":"is less than ","<=":"is less than or equal to ","\\le":"is less than or equal to ","\\gt":"is greater than ",">":"is greater than ","\\ge":"is greater than or equal to ","\\geq":"is greater than or equal to ","\\leq":"is less than or equal to ","!":"factorial ","\\sin":"sine ","\\cos":"cosine ","​":"","−":"minus ",":":'<break time="150ms"/> such that <break time="200ms"/> ',"\\colon":'<break time="150ms"/> such that <break time="200ms"/> ',"\\hbar":"etch bar ","\\iff":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\Longleftrightarrow":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\land":"and ","\\lor":"or ","\\neg":"not ","\\div":"divided by ","\\forall":"for all ","\\exists":"there exists ","\\nexists":"there does not exists ","\\in":"element of ","\\N":'the set <break time="150ms"/><say-as interpret-as="character">n</say-as>',"\\C":'the set <break time="150ms"/><say-as interpret-as="character">c</say-as>',"\\Z":'the set <break time="150ms"/><say-as interpret-as="character">z</say-as>',"\\Q":'the set <break time="150ms"/><say-as interpret-as="character">q</say-as>',"\\infty":"infinity ","\\nabla":"nabla ","\\partial":"partial derivative of ","\\cdots":"dot dot dot ","\\Rightarrow":"implies ","\\lbrace":'<break time="150ms"/>open brace<break time="150ms"/>',"\\{":'<break time="150ms"/>open brace<break time="150ms"/>',"\\rbrace":'<break time="150ms"/>close brace<break time="150ms"/>',"\\}":'<break time="150ms"/>close brace<break time="150ms"/>',"\\langle":'<break time="150ms"/>left angle bracket<break time="150ms"/>',"\\rangle":'<break time="150ms"/>right angle bracket<break time="150ms"/>',"\\lfloor":'<break time="150ms"/>open floor<break time="150ms"/>',"\\rfloor":'<break time="150ms"/>close floor<break time="150ms"/>',"\\lceil":'<break time="150ms"/>open ceiling<break time="150ms"/>',"\\rceil":'<break time="150ms"/>close ceiling<break time="150ms"/>',"\\vert":'<break time="150ms"/>vertical bar<break time="150ms"/>',"\\mvert":'<break time="150ms"/>divides<break time="150ms"/>',"\\lvert":'<break time="150ms"/>left vertical bar<break time="150ms"/>',"\\rvert":'<break time="150ms"/>right vertical bar<break time="150ms"/>',"\\lbrack":'<break time="150ms"/> open square bracket <break time="150ms"/>',"\\rbrack":'<break time="150ms"/> close square bracket <break time="150ms"/>',mm:"millimeters",cm:"centimeters",km:"kilometers",kg:"kilograms"};function Ps(t){let e=0;if(t&&Array.isArray(t))for(const i of t)"first"!==i.type&&(e+=1);return 1===e}function Ss(t){let e="";if(t&&Array.isArray(t))for(const i of t)"first"!==i.type&&"string"==typeof i.body&&(e+=i.body);return e}pe.toSpeakableFragment=function(t,e){function i(t){return"<emphasis>"+t+"</emphasis>"}if(!t)return"";let s="";if(t.id&&"math"===e.speechMode&&(s+='<mark name="'+t.id.toString()+'"/>'),Array.isArray(t)){let n=!1;for(let r=0;r<t.length;r++)r<t.length-2&&"mopen"===t[r].type&&"mclose"===t[r+2].type&&"mord"===t[r+1].type?(s+=" of ",s+=i(pe.toSpeakableFragment(t[r+1],e)),r+=2):"text"===t[r].mode?s+=t[r].body?t[r].body:" ":"mord"===t[r].type&&/[0123456789,.]/.test(t[r].body)?n?s+=t[r].body:(n=!0,s+=pe.toSpeakableFragment(t[r],e)):(n=!1,s+=pe.toSpeakableFragment(t[r],e))}else{let n="",r="",o="",a=!1;switch(t.type){case"group":case"root":s+=pe.toSpeakableFragment(t.body,e);break;case"genfrac":if(n=pe.toSpeakableFragment(t.numer,e),r=pe.toSpeakableFragment(t.denom,e),Ps(t.numer)&&Ps(t.denom)){const e={"1/2":" half ","1/3":" one third ","2/3":" two third","1/4":" one quarter ","3/4":" three quarter ","1/5":" one fifth ","2/5":" two fifths ","3/5":" three fifths ","4/5":" four fifths ","1/6":" one sixth ","5/6":" five sixths ","1/8":" one eight ","3/8":" three eights ","5/8":" five eights ","7/8":" seven eights ","1/9":" one ninth ","2/9":" two ninths ","4/9":" four ninths ","5/9":" five ninths ","7/9":" seven ninths ","8/9":" eight ninths "}[Ss(t.numer)+"/"+Ss(t.denom)];e?s=e:s+=n+" over "+r}else s+=' the fraction <break time="150ms"/>'+n+', over <break time="150ms"/>'+r+'.<break time="150ms"/> End fraction.<break time="150ms"/>';break;case"surd":if(o=pe.toSpeakableFragment(t.body,e),t.index){let i=pe.toSpeakableFragment(t.index,e);const n=(i=i.trim()).replace(/<mark([^\/]*)\/>/g,"");s+="3"===n?' the cube root of <break time="200ms"/>'+o+'. <break time="200ms"/> End cube root':"n"===n?' the nth root of <break time="200ms"/>'+o+'. <break time="200ms"/> End root':' the root with index: <break time="200ms"/>'+i+', of <break time="200ms"/>'+o+'. <break time="200ms"/> End root'}else Ps(t.body)?s+=" the square root of "+o+" , ":s+=' the square root of <break time="200ms"/>'+o+'. <break time="200ms"/> End square root';break;case"accent":break;case"leftright":s+=_s[t.leftDelim]||t.leftDelim,s+=pe.toSpeakableFragment(t.body,e),s+=_s[t.rightDelim]||t.rightDelim;break;case"line":case"rule":case"overunder":case"overlap":break;case"placeholder":s+="placeholder "+t.body;break;case"delim":case"sizeddelim":case"mord":case"minner":case"mbin":case"mrel":case"mpunct":case"mopen":case"mclose":case"textord":{const i=t.latex?t.latex.trim():"";if("\\mathbin"===i||"\\mathrel"===i||"\\mathopen"===i||"\\mathclose"===i||"\\mathpunct"===i||"\\mathord"===i||"\\mathinner"===i){s=pe.toSpeakableFragment(t.body,e);break}let n=t.body,r=t.latex;if("delim"!==t.type&&"sizeddelim"!==t.type||(n=r=t.delim),"text"===e.speechMode)s+=n;else{if("mbin"===t.type&&(s+='<break time="150ms"/>'),n){const t=_s[n]||(r?_s[r.trim()]:"");s+=t?" "+t:(r?function(t){let e=ai.NOTES[t];return e||"\\"!==t.charAt(0)||(e=" "+t.replace("\\","")+" "),Array.isArray(e)&&(e=e[0]),e}(r.trim()):"")||function(t){let i="";return e.textToSpeechMarkup?/[a-z]/.test(t)?i+=' <say-as interpret-as="character">'+t+"</say-as>":/[A-Z]/.test(t)?i+="capital "+t.toLowerCase():i+=t:/[a-z]/.test(t)?i+=" '"+t.toUpperCase()+"'":/[A-Z]/.test(t)?i+=" 'capital "+t.toUpperCase()+"'":i+=t,i}(n)}else s+=pe.toSpeakableFragment(t.body,e);"mbin"===t.type&&(s+='<break time="150ms"/>')}break}case"mop":if("​"!==t.body){const n=t.latex?t.latex.trim():"";if("\\sum"===n)if(t.superscript&&t.subscript){let i=pe.toSpeakableFragment(t.superscript,e);i=i.trim();let n=pe.toSpeakableFragment(t.subscript,e);s+=' the summation from <break time="200ms"/>'+(n=n.trim())+'<break time="200ms"/> to  <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else if(t.subscript){let i=pe.toSpeakableFragment(t.subscript,e);s+=' the summation from <break time="200ms"/>'+(i=i.trim())+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else s+=" the summation of";else if("\\prod"===n)if(t.superscript&&t.subscript){let i=pe.toSpeakableFragment(t.superscript,e);i=i.trim();let n=pe.toSpeakableFragment(t.subscript,e);s+=' the product from <break time="200ms"/>'+(n=n.trim())+'<break time="200ms"/> to <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else if(t.subscript){let i=pe.toSpeakableFragment(t.subscript,e);s+=' the product from <break time="200ms"/>'+(i=i.trim())+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else s+=" the product  of ";else if("\\int"===n)if(t.superscript&&t.subscript){let n=pe.toSpeakableFragment(t.superscript,e);n=n.trim();let r=pe.toSpeakableFragment(t.subscript,e);s+=' the integral from <break time="200ms"/>'+i(r=r.trim())+'<break time="200ms"/> to <break time="200ms"/>'+i(n)+' <break time="200ms"/> of ',a=!0}else s+=' the integral of <break time="200ms"/> ';else"string"==typeof t.body?s+=_s[t.body]||_s[t.latex.trim()]||" "+t.body:t.latex&&t.latex.length>0&&(s+="\\"===t.latex[0]?" "+t.latex.substr(1):" "+t.latex)}break;case"enclose":o=pe.toSpeakableFragment(t.body,e),Ps(t.body)?s+=" crossed out "+o+" , ":s+=" crossed out "+o+". End cross out"}if(!a&&t.superscript){let i=pe.toSpeakableFragment(t.superscript,e);const n=(i=i.trim()).replace(/<[^>]*>/g,"");if(Ps(t.superscript)){if("math"===e.speechMode){const e=function(t){if(t&&Array.isArray(t))for(const e of t)if("first"!==e.type&&e.id)return e.id.toString();return""}(t.superscript);e&&(s+='<mark name="'+e+'"/>')}"′"===n?s+=" prime ":"2"===n?s+=" squared ":"3"===n?s+=" cubed ":isNaN(parseInt(n))?s+=" to the "+i+"; ":s+=' to the <say-as interpret-as="ordinal">'+n+"</say-as> power; "}else isNaN(parseInt(n))?s+=" raised to the "+i+"; ":s+=' raised to the <say-as interpret-as="ordinal">'+n+"</say-as> power; "}if(!a&&t.subscript){let i=pe.toSpeakableFragment(t.subscript,e);i=i.trim(),Ps(t.subscript)?s+=" sub "+i:s+=" subscript "+i+". End subscript. "}}return s},pe.toSpeakableText=function(t,e){const i=e?JSON.parse(JSON.stringify(e)):{textToSpeechMarkup:"",textToSpeechRules:"mathlive"};if(i.speechMode="math",window.sre&&"sre"===i.textToSpeechRules){i.generateID=!0;const e=pe.toMathML(t,i);return e?(i.textToSpeechMarkup&&(i.textToSpeechRulesOptions=i.textToSpeechRulesOptions||{},i.textToSpeechRulesOptions.markup=i.textToSpeechMarkup,"ssml"===i.textToSpeechRulesOptions.markup&&(i.textToSpeechRulesOptions.markup="ssml_step"),i.textToSpeechRulesOptions.rate=i.speechEngineRate),i.textToSpeechRulesOptions&&window.sre.System.getInstance().setupEngine(i.textToSpeechRulesOptions),window.sre.System.getInstance().toSpeech(e)):""}let s=pe.toSpeakableFragment(t,i);if("ssml"===i.textToSpeechMarkup){let t="";i.speechEngineRate&&(t='<prosody rate="'+i.speechEngineRate+'">'),s='<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US"><amazon:auto-breaths>'+t+"<p><s>"+s+"</s></p>"+(t?"</prosody>":"")+"</amazon:auto-breaths></speak>"}else s="mac"===i.textToSpeechMarkup&&"mac"===function(t){let e="other";return navigator&&navigator.platform&&navigator.userAgent&&(/^(mac)/i.test(navigator.platform)?e="mac":/^(win)/i.test(navigator.platform)?e="win":/(android)/i.test(navigator.userAgent)?e="android":/(iphone)/i.test(navigator.userAgent)||/(ipod)/i.test(navigator.userAgent)||/(ipad)/i.test(navigator.userAgent)?e="ios":/\bCrOS\b/i.test(navigator.userAgent)&&(e="chromeos")),e===t?t:"!"+t}("mac")?s.replace(/<mark([^\/]*)\/>/g,"").replace(/<emphasis>/g,"[[emph+]]").replace(/<\/emphasis>/g,"").replace(/<break time="([0-9]*)ms"\/>/g,"[[slc $1]]").replace(/<say-as[^>]*>/g,"").replace(/<\/say-as>/g,""):s.replace(/<[^>]*>/g,"").replace(/\s{2,}/g," ");return s};const ws=3,Es=.5;function ks(t,e,i,s){e=e.split(" ");for(const n of e){const e=n.match(/(.*):(.*)/);if(e){const n=s||{};"active"===e[2]?n.passive=!1:n[e[2]]=!0,t.addEventListener(e[1],i,n)}else t.addEventListener(n,i,s)}}function As(t,e,i,s){e=e.split(" ");for(const n of e){const e=n.match(/(.*):(.*)/);if(e){const n=s||{};"active"===e[2]?n.passive=!1:n[e[2]]=!0,t.removeEventListener(e[1],i,n)}else t.removeEventListener(n,i,s)}}function Ts(t,e){let i=document.getElementById(t);return i?i.setAttribute("data-refcount",parseInt(i.getAttribute("data-refcount"))+1):((i=document.createElement("div")).setAttribute("aria-hidden","true"),i.setAttribute("data-refcount","1"),i.className=e,i.id=t,document.body.appendChild(i)),i}function Ms(t){if(!t)return null;const e=parseInt(t.getAttribute("data-refcount"));return e&&1!==e?t.setAttribute("data-refcount",e-1):t.remove(),t}class Os{constructor(t,e){this.$setConfig(e||{}),this.element=t,t.mathfield=this,this.originalContent=t.innerHTML;let i=this.element.textContent;i&&(i=i.trim());let s="";this.config.substituteTextArea?s+="string"==typeof this.config.substituteTextArea?this.config.substituteTextArea:"<span></span>":/android|ipad|ipod|iphone/i.test(navigator.userAgent)?s+="<span class='ML__textarea'>\n                <span class='ML__textarea__textarea'\n                    tabindex=\"0\" role=\"textbox\"\n                    style='display:inline-block;height:1px;width:1px' >\n                </span>\n            </span>":s+='<span class="ML__textarea"><textarea class="ML__textarea__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" aria-hidden="true" tabindex="0"></textarea></span>',s+='<span class="ML__fieldcontainer"><span class="ML__fieldcontainer__field"></span>',this.config.virtualKeyboardMode||(this.config.virtualKeyboardMode=window.matchMedia&&window.matchMedia("(any-pointer: coarse)").matches?"onfocus":"off"),"manual"===this.config.virtualKeyboardMode?(s+=`<button class="ML__virtual-keyboard-toggle" data-tooltip="${hi("tooltip.toggle virtual keyboard")}">`,s+=this.config.virtualKeyboardToggleGlyph?this.config.virtualKeyboardToggleGlyph:'<span style="width: 21px; margin-top: 4px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M528 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm16 336c0 8.823-7.177 16-16 16H48c-8.823 0-16-7.177-16-16V112c0-8.823 7.177-16 16-16h480c8.823 0 16 7.177 16 16v288zM168 268v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-336 80v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm384 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zM120 188v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-96 152v-8c0-6.627-5.373-12-12-12H180c-6.627 0-12 5.373-12 12v8c0 6.627 5.373 12 12 12h216c6.627 0 12-5.373 12-12z"/></svg></span>',s+="</button>"):s+="<span ></span>",s+="</span>",this.element.innerHTML=s+='\n        <div class="sr-only">\n            <span aria-live="assertive" aria-atomic="true"></span>\n            <span></span>\n        </div>\n    ';let n=0;this.textarea="function"==typeof this.config.substituteTextArea?this.config.substituteTextArea():this.element.children[n++].firstElementChild,this.field=this.element.children[n].children[0],this.field.addEventListener("wheel",t=>{t.preventDefault(),t.stopPropagation();let e=void 0===t.deltaX?t.detail:-t.deltaX;isFinite(e)||(e=t.wheelDelta/10),this.field.scroll({top:0,left:this.field.scrollLeft-5*e})},{passive:!1}),this.virtualKeyboardToggleDOMNode=this.element.children[n++].children[1],this._attachButtonHandlers(this.virtualKeyboardToggleDOMNode,{default:"toggleVirtualKeyboard",alt:"toggleVirtualKeyboardAlt",shift:"toggleVirtualKeyboardShift"}),this.ariaLiveText=this.element.children[n].children[0],this.accessibleNode=this.element.children[n++].children[1],this.popover=Ts("mathlive-popover-panel","ML__popover"),this.keystrokeCaption=Ts("mathlive-keystroke-caption-panel","ML__keystroke-caption"),this.keystrokeCaptionVisible=!1,this.virtualKeyboardVisible=!1,this.keystrokeBuffer="",this.keystrokeBufferStates=[],this.keystrokeBufferResetTimer=null,this.suggestionIndex=0,this.mode=e.defaultMode||"math",this.smartModeSuppressed=!1,this.style={},this.blurred=!0,ks(this.element,"focus",this),ks(this.element,"blur",this),ks(this.textarea,"cut",this),ks(this.textarea,"copy",this),ks(this.textarea,"paste",this),ti.delegateKeyboardEvents(this.textarea,{container:this.element,allowDeadKey:()=>"text"===this.mode,typedText:this._onTypedText.bind(this),paste:this._onPaste.bind(this),keystroke:this._onKeystroke.bind(this),focus:this._onFocus.bind(this),blur:this._onBlur.bind(this)}),window.PointerEvent?ks(this.field,"pointerdown",this):ks(this.field,"touchstart:active mousedown",this),ks(window,"resize",this);const r={...e};r.onSelectionDidChange=Os.prototype._onSelectionDidChange.bind(this),r.onContentDidChange=Os.prototype._onContentDidChange.bind(this),r.onAnnounce=this.config.onAnnounce,r.macros=this.config.macros,r.removeExtraneousParentheses=this.config.removeExtraneousParentheses,this.mathlist=new Ve.EditableMathlist(r,this),this.undoManager=new ei.UndoManager(this.mathlist),i.length>0&&this.$latex(i),this.undoManager.startRecording(),this.undoManager.snapshot(this.config)}handleEvent(t){switch(t.type){case"focus":this._onFocus(t);break;case"blur":this._onBlur(t);break;case"touchstart":case"mousedown":case"pointerdown":this._onPointerDown(t);break;case"resize":this._resizeTimer&&window.cancelAnimationFrame(this._resizeTimer),this._resizeTimer=window.requestAnimationFrame(()=>this._onResize());break;case"cut":this._onCut(t);break;case"copy":this._onCopy(t);break;case"paste":this._onPaste(t)}}$revertToOriginalContent(){this.element.innerHTML=this.originalContent,this.element.mathfield=null,delete this.accessibleNode,delete this.ariaLiveText,delete this.field,As(this.textarea,"cut",this),As(this.textarea,"copy",this),As(this.textarea,"paste",this),this.textarea.remove(),delete this.textarea,this.virtualKeyboardToggleDOMNode.remove(),delete this.virtualKeyboardToggleDOMNode,Ms(this.popover),Ms(this.keystrokeCaption),Ms(this.virtualKeyboard),Ms(document.getElementById("mathlive-alternate-keys-panel")),As(this.element,"pointerdown",this),As(this.element,"touchstart:active mousedown",this),As(this.element,"focus",this),As(this.element,"blur",this),As(window,"resize",this)}_resetKeystrokeBuffer(){this.keystrokeBuffer="",this.keystrokeBufferStates=[],clearTimeout(this.keystrokeBufferResetTimer)}_getCaretPosition(){const t=function t(e){if(e.classList.contains("ML__caret")||e.classList.contains("ML__text-caret")||e.classList.contains("ML__command-caret"))return e;let i;return Array.from(e.children).forEach((function(e){i=i||t(e)})),i}(this.field);if(t){const e=t.getBoundingClientRect();return{x:e.right+window.scrollX,y:e.bottom+window.scrollY}}return null}_getSelectionBounds(){const t=this.field.querySelectorAll(".ML__selected");if(t&&t.length>0){const e={top:1/0,bottom:-1/0,left:1/0,right:-1/0};t.forEach(t=>{const i=t.getBoundingClientRect();i.left<e.left&&(e.left=i.left),i.right>e.right&&(e.right=i.right),i.bottom>e.bottom&&(e.bottom=i.bottom),i.top<e.top&&(e.top=i.top)});const i=this.field.getBoundingClientRect(),s=e.right-e.left,n=e.bottom-e.top;return e.left=Math.ceil(e.left-i.left+this.field.scrollLeft),e.right=e.left+s,e.top=Math.ceil(e.top-i.top),e.bottom=e.top+n,e}return null}_pathFromPoint(t,e,i){let s;(i=i||{}).bias=i.bias||0;const n=function t(e,i,s){let n={element:null},r=!0;if(e.getAttribute("data-atom-id")){n.element=e;const t=e.getBoundingClientRect(),o=Math.max(t.left-i,i-t.right),a=Math.max(t.top-s,s-t.bottom);n.distance=o*o+a*a,r=i>=t.left&&i<=t.right}else n.distance=Number.POSITIVE_INFINITY;return r&&e.children&&Array.from(e.children).forEach((function(e){const r=t(e,i,s);r.element&&r.distance<=n.distance&&(n=r)})),n}(this.field,t,e).element,r=n?n.getAttribute("data-atom-id"):null;if(r){const e=this.mathlist.filter((function(t,e){return e.captureSelection?e.filter(t=>t.id===r).length>0:e.id===r}));if(e&&e.length>0)if(s=Pe.pathFromString(e[0]).path,0===i.bias){const e=n.getBoundingClientRect();t<e.left+e.width/2&&!n.classList.contains("ML__placeholder")&&(s[s.length-1].offset=Math.max(0,s[s.length-1].offset-1))}else i.bias<0&&(s[s.length-1].offset=Math.min(this.mathlist.siblings().length-1,Math.max(0,s[s.length-1].offset+i.bias)))}return s}_onPointerDown(t){const e=this;let i,s=!1,n=!1,r=!1;if(1!==t.buttons)return;function o(t){window.PointerEvent?(As(e.field,"pointermove",c),As(e.field,"pointerend pointerleave pointercancel",o),e.field.releasePointerCapture(t.pointerId)):(As(e.field,"touchmove",c),As(e.field,"touchend touchleave",o),As(window,"mousemove",c),As(window,"mouseup blur",o)),s=!1,clearInterval(h),e.element.querySelectorAll(".ML__scroller").forEach(t=>t.parentNode.removeChild(t)),t.preventDefault(),t.stopPropagation()}let a=!1,l=!1;const h=setInterval(()=>{a?e.field.scroll({top:0,left:e.field.scrollLeft-16}):l&&e.field.scroll({top:0,left:e.field.scrollLeft+16})},32);function c(t){const s=t.touches?t.touches[0].clientX:t.clientX,r=t.touches?t.touches[0].clientY:t.clientY,o="touch"===t.pointerType?20:5;if(Date.now()<p+500&&Math.abs(d-s)<o&&Math.abs(u-r)<o)return t.preventDefault(),void t.stopPropagation();const h=e.field.getBoundingClientRect();l=s>h.right,a=s<h.left;let c=i;window.PointerEvent?t.isPrimary||(c=e._pathFromPoint(t.clientX,t.clientY,{bias:0})):t.touches&&2===t.touches.length&&(c=e._pathFromPoint(t.touches[1].clientX,t.touches[1].clientY,{bias:0}));const f=e._pathFromPoint(s,r,{bias:s<=d?s===d?0:-1:1});f&&e.mathlist.setRange(c,f,{extendToWordBoundary:n})&&e._requestUpdate(),t.preventDefault(),t.stopPropagation()}const d=t.touches?t.touches[0].clientX:t.clientX,u=t.touches?t.touches[0].clientY:t.clientY,p=Date.now();Ns&&Math.abs(Ns.x-d)<5&&Math.abs(Ns.y-u)<5&&Date.now()<Ns.time+500?(Ls+=1,Ns.time=p):(Ns={x:d,y:u,time:p},Ls=1);const f=this.field.getBoundingClientRect();if(d>=f.left&&d<=f.right&&u>=f.top&&u<=f.bottom){let a=document.createElement("div");a.className="ML__scroller",this.element.appendChild(a),a.style.left=f.left-200+"px",(a=document.createElement("div")).className="ML__scroller",this.element.appendChild(a),a.style.left=f.right+"px",this.$hasFocus()||(r=!0,this.textarea.focus&&this.textarea.focus()),this._resetKeystrokeBuffer(),this.smartModeSuppressed=!1,(i=this._pathFromPoint(d,u,{bias:0}))&&(t.shiftKey?(this.mathlist.setRange(this.mathlist.path,i),(i=Pe.clone(this.mathlist.path))[i.length-1].offset-=1):this.mathlist.setPath(i,0),r=!0,this.style={},3===t.detail||Ls>2?(o(t),3!==t.detail&&3!==Ls||this.mathlist.selectAll_()):s||(s=!0,window.PointerEvent?(ks(e.field,"pointermove",c),ks(e.field,"pointerend pointercancel pointerup",o),e.field.setPointerCapture(t.pointerId)):(ks(window,"blur",o),t.touches?(ks(t.target,"touchmove",c),ks(t.target,"touchend",o)):(ks(window,"mousemove",c),ks(window,"mouseup",o))),2!==t.detail&&2!==Ls||(n=!0,this.mathlist.selectGroup_())))}else Ns=null;r&&this._requestUpdate(),t.preventDefault()}_onSelectionDidChange(){this.mathlist.commitCommandStringBeforeInsertionPoint();let t="";this.mathlist.forEachSelected(e=>{t+=e.toLatex()}),t?(this.textarea.value=t,this.$hasFocus()&&this.textarea.select&&this.textarea.select()):(this.textarea.value="",this.textarea.setAttribute("aria-label",""));{const t=this.mode;this.mode=this.mathlist.anchorMode()||this.config.defaultMode,this.mode!==t&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode),"command"===t&&"command"!==this.mode&&(ai.hidePopover(this),this.mathlist.removeCommandString())}ai.updatePopoverPosition(this,{deferred:!0}),"function"==typeof this.config.onSelectionDidChange&&this.config.onSelectionDidChange(this)}_onContentDidChange(){this.undoManager.canRedo()?this.element.classList.add("can-redo"):this.element.classList.remove("can-redo"),this.undoManager.canUndo()?this.element.classList.add("can-undo"):this.element.classList.remove("can-undo"),"function"==typeof this.config.onContentDidChange&&this.config.onContentDidChange(this)}_nextAtomSpeechText(t){function e(t,e){return"body"===e.relation?{enclose:"cross out",leftright:"fence",surd:"square root",root:"math field"}[t.type]:{numer:"numerator",denom:"denominator",index:"index",body:"parent",subscript:"subscript",superscript:"superscript"}[e.relation]}const i=t?t.path:[],s=this.mathlist.path,n=s[s.length-1];let r="";for(;i.length>s.length;)r+="out of "+e(t.parent(),i[i.length-1])+"; ",i.pop();if(!this.mathlist.isCollapsed())return Ds(this,"",this.mathlist.getSelectedAtoms());const o=e(this.mathlist.parent(),n);0===n.offset&&(r+=(o?"start of "+o:"unknown")+": ");const a=this.mathlist.sibling(Math.max(1,this.mathlist.extent));return a?r+=Ds(this,"",a):0!==n.offset&&(r+=o?"end of "+o:"unknown"),r}_announce(t,e,i){"function"==typeof this.config.onAnnounce&&this.config.onAnnounce(this,t,e,i)}_onFocus(){this.blurred&&(this.blurred=!1,this.textarea.focus&&this.textarea.focus(),"onfocus"===this.config.virtualKeyboardMode&&this.showVirtualKeyboard_(),ai.updatePopoverPosition(this),this.config.onFocus&&this.config.onFocus(this),this._requestUpdate())}_onBlur(){this.blurred||(this.blurred=!0,this.ariaLiveText.textContent="","onfocus"===this.config.virtualKeyboardMode&&this.hideVirtualKeyboard_(),this.complete_({discard:!0}),this._requestUpdate(),this.config.onBlur&&this.config.onBlur(this))}_onResize(){this.element.classList.remove("ML__isNarrowWidth","ML__isWideWidth","ML__isExtendedWidth"),window.innerWidth>=1024?this.element.classList.add("ML__isExtendedWidth"):window.innerWidth>=768?this.element.classList.add("ML__isWideWidth"):this.element.classList.add("ML__isNarrowWidth"),ai.updatePopoverPosition(this)}toggleKeystrokeCaption_(){this.keystrokeCaptionVisible=!this.keystrokeCaptionVisible,this.keystrokeCaption.innerHTML="",this.keystrokeCaptionVisible||(this.keystrokeCaption.style.visibility="hidden")}_showKeystroke(t){const e=this.keystrokeCaption;if(e&&this.keystrokeCaptionVisible){const i=this.element.getBoundingClientRect();e.style.left=i.left+"px",e.style.top=i.top-64+"px",e.innerHTML="<span>"+(Oe.stringify(t)||t)+"</span>"+e.innerHTML,e.style.visibility="visible",setTimeout((function(){e.childNodes.length>0&&e.removeChild(e.childNodes[e.childNodes.length-1]),0===e.childNodes.length&&(e.style.visibility="hidden")}),3e3)}}$perform(t){if(!t)return!1;let e,i=!1,s=[],n=!1;if(Array.isArray(t)?(e=t[0],s=t.slice(1)):e=t,e=e.replace(/-\w/g,t=>t[1].toUpperCase()),"function"==typeof this.mathlist[e+="_"]){if(/^(delete|transpose|add)/.test(e)&&this._resetKeystrokeBuffer(),/^(delete|transpose|add)/.test(e)&&"command"!==this.mode&&(this.undoManager.pop(),this.undoManager.snapshot(this.config)),this.mathlist[e](...s),/^(delete|transpose|add)/.test(e)&&"command"!==this.mode&&this.undoManager.snapshot(this.config),/^(delete)/.test(e)&&"command"===this.mode){const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=Rt.suggest(t);0===e.length?ai.hidePopover(this):ai.showPopoverWithLatex(this,e[0].match,e.length>1)}n=!0,i=!0}else"function"==typeof this[e]&&(n=this[e](...s),i=!0);return this.mathlist.isCollapsed()&&!/^(transpose|paste|complete|((moveToNextChar|moveToPreviousChar|extend).*))_$/.test(e)||(this._resetKeystrokeBuffer(),this.style={}),n&&this._requestUpdate(),i}performWithFeedback_(t){return this.$focus(),this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(ws),"moveToNextPlaceholder"===(t=t.replace(/-\w/g,t=>t[1].toUpperCase()))||"moveToPreviousPlaceholder"===t||"complete"===t?this.returnKeypressSound?(this.returnKeypressSound.load(),this.returnKeypressSound.play().catch(t=>void 0)):this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>void 0)):"deletePreviousChar"!==t&&"deleteNextChar"!==t&&"deletePreviousWord"!==t&&"deleteNextWord"!==t&&"deleteToGroupStart"!==t&&"deleteToGroupEnd"!==t&&"deleteToMathFieldStart"!==t&&"deleteToMathFieldEnd"!==t||!this.deleteKeypressSound?this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>void 0)):(this.deleteKeypressSound.load(),this.deleteKeypressSound.play().catch(t=>void 0)),this.$perform(t)}convertLastAtomsToText_(t,e){"function"==typeof t&&(e=t,t=1/0),void 0===t&&(t=1/0);let i=0,s=!1;for(this.mathlist.contentWillChange();!s;){const n=this.mathlist.sibling(i);(s=0===t||!n||"math"!==n.mode||!(/mord|textord|mpunct/.test(n.type)||"mop"===n.type&&/[a-zA-Z]+/.test(n.body))||n.superscript||n.subscript||e&&!e(n))||(n.applyStyle({mode:"text"}),n.latex=n.body),i-=1,t-=1}this.mathlist.contentDidChange()}convertLastAtomsToMath_(t,e){"function"==typeof t&&(e=t,t=1/0),void 0===t&&(t=1/0),this.mathlist.contentWillChange();let i=0,s=!1;for(;!s;){const n=this.mathlist.sibling(i);(s=0===t||!n||"text"!==n.mode||" "===n.body||e&&!e(n))||n.applyStyle({mode:"math",type:"mord"}),i-=1,t-=1}this.removeIsolatedSpace_(),this.mathlist.contentDidChange()}removeIsolatedSpace_(){let t=0;for(;this.mathlist.sibling(t)&&"math"===this.mathlist.sibling(t).mode;)t-=1;if(this.mathlist.sibling(t)&&"text"===this.mathlist.sibling(t).mode&&" "===this.mathlist.sibling(t).body&&(!this.mathlist.sibling(t-1)||"math"===this.mathlist.sibling(t-1).mode)){this.mathlist.contentWillChange(),this.mathlist.siblings().splice(t-1,1),this.mathlist.contentDidChange();const e=this.mathlist.suppressChangeNotifications;this.mathlist.suppressChangeNotifications=!0,this.mathlist.setSelection(this.mathlist.anchorOffset()-1),this.mathlist.suppressChangeNotifications=e}}getTextBeforeAnchor_(){let t="",e=0,i=!1;for(;!i;){const s=this.mathlist.sibling(e);(i=!(s&&("text"===s.mode&&!s.type||"math"===s.mode&&/mord|textord|mpunct/.test(s.type))))||(t=s.body+t),e-=1}return t}smartMode_(t,e){if(this.smartModeSuppressed)return!1;if(this.mathlist.endOffset()<this.mathlist.siblings().length-1)return!1;if(!e||e.ctrlKey||e.metaKey)return!1;const i=ti.eventToChar(e);if(i.length>1)return!1;if(!this.mathlist.isCollapsed())return!("text"!==this.mode||!/[\/_^]/.test(i));const s=this.getTextBeforeAnchor_()+i;if("text"===this.mode){if("Esc"===t||/[\/\\]/.test(i))return!0;if(/[\^_]/.test(i))return/(^|\s)[a-zA-Z][^_]$/.test(s)&&this.convertLastAtomsToMath_(1),!0;const e={")":"(","}":"{","]":"["}[i];if(e&&this.mathlist.parent()&&"leftright"===this.mathlist.parent().type&&this.mathlist.parent().leftDelim===e)return!0;if(/(^|[^a-zA-Z])(a|I)[ ]$/.test(s))return!1;if(/[$€£₤₺¥¤฿¢₡₧₨₹₩₱]/u.test(i))return!0;if(/(^|[^a-zA-Z'’])[a-zA-Z][ ]$/.test(s))return this.convertLastAtomsToMath_(1),!1;if(/[^0-9]\.[^0-9\s]$/.test(s)){this.convertLastAtomsToMath_(1);const t=this.mathlist.sibling(0);return t.body="⋅",t.autoFontFamily="cmr",t.latex="\\cdot",!0}if(/(^|\s)[a-zA-Z][^a-zA-Z]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/\.[0-9]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/[(][0-9+\-.]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/[(][a-z][,;]$/.test(s))return this.convertLastAtomsToMath_(2),!0;if(/[0-9+\-=><*|]$/.test(i))return this.removeIsolatedSpace_(),!0}else{if("Spacebar"===t)return this.convertLastAtomsToText_(t=>/[a-z][:,;.]$/.test(t.body)),!0;if(/[a-zA-Z]{3,}$/.test(s)&&!/(dxd|abc|xyz|uvw)$/.test(s))return this.convertLastAtomsToText_(t=>/[a-zA-Z:,;.]/.test(t.body)),!0;if(/(^|\W)(if|If)$/i.test(s))return this.convertLastAtomsToText_(1),!0;if(/(\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5){3,}$/u.test(s)&&!/(αβγ)$/.test(s))return this.convertLastAtomsToText_(t=>/(:|,|;|.|\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5)/u.test(t.body)),!0;if(/\?|\./.test(i))return!0}return!1}_onKeystroke(t,e){if(this._showKeystroke(t),clearTimeout(this.keystrokeBufferResetTimer),this.config.onKeystroke&&!this.config.onKeystroke(this,t,e))return e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1;let i,s,n,r=!1;if("command"!==this.mode&&(!e||!e.ctrlKey&&!e.metaKey)){const t=ti.eventToChar(e);if("Backspace"!==t)if(!t||t.length>1)this._resetKeystrokeBuffer();else{const e=this.keystrokeBuffer+t;let n=0;for(;!i&&n<e.length;){let t;if(this.keystrokeBufferStates[n]){const e=new Ve.EditableMathlist;e.root=pe.makeRoot("math",Ce.parseTokens(v.tokenize(this.keystrokeBufferStates[n].latex),this.config.default,null,this.config.macros)),e.setPath(this.keystrokeBufferStates[n].selection),t=e.siblings()}else t=this.mathlist.siblings();i=Oe.forString(this.mode,t,e.slice(n),this.config),n+=1}s=n-1,this.keystrokeBuffer+=t,this.keystrokeBufferStates.push(this.undoManager.save()),Oe.startsWithString(e,this.config).length<=1?r=!0:this.config.inlineShortcutTimeout&&(this.keystrokeBufferResetTimer=setTimeout(()=>{this._resetKeystrokeBuffer()},this.config.inlineShortcutTimeout))}}if(this.config.smartMode){const s=this.mode;i?this.mode="math":this.smartMode_(t,e)&&(this.mode={math:"text",text:"math"}[this.mode],n=""),this.mode!==s&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode)}if(i||n||(n=Oe.selectorForKeystroke(this.mode,t)),!i&&!n)return!0;this.mathlist.decorateCommandStringAroundInsertionPoint(!1);const o=this.mathlist.parent();if("moveAfterParent"===n&&o&&"leftright"===o.type&&this.mathlist.endOffset()===this.mathlist.siblings().length-1&&this.config.smartFence&&this.mathlist._insertSmartFence(".")&&(n="",this._requestUpdate()),"math"===this.mode&&"Spacebar"===t&&!i){const t=this.mathlist.sibling(1),e=this.mathlist.sibling(-1);(t&&"text"===t.mode||e&&"text"===e.mode)&&this.mathlist.insert(" ",{mode:"text"})}if((n&&!this.$perform(n)||i)&&i){if(!/^(\\{|\\}|\\[|\\]|\\@|\\#|\\$|\\%|\\^|\\_|\\backslash)$/.test(i)){const t={...this.mathlist.anchorStyle(),...this.style};this.mathlist.insert(ti.eventToChar(e),{suppressChangeNotifications:!0,mode:this.mode,style:t});const i=this.mode;this.undoManager.snapshotAndCoalesce(this.config),this.undoManager.restore(this.keystrokeBufferStates[s],{...this.config,suppressChangeNotifications:!0}),this.mode=i}this.mathlist.contentWillChange();const t=this.mathlist.suppressChangeNotifications;this.mathlist.suppressChangeNotifications=!0;const n={...this.mathlist.anchorStyle(),...this.style};this.mathlist.insert(i,{format:"latex",mode:this.mode,style:n,smartFence:!0}),this.removeIsolatedSpace_(),i.endsWith(" ")&&(this.mode="text",this.mathlist.insert(" ",{mode:"text",style:n})),this.mathlist.suppressChangeNotifications=t,this.mathlist.contentDidChange(),this.undoManager.snapshot(this.config),this._requestUpdate(),this._announce("replacement"),r&&this._resetKeystrokeBuffer()}return this.scrollIntoView(),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1}_onTypedText(t,e){if((e=e||{}).focus&&this.$focus(),e.feedback&&(this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(ws),this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>void 0))),e.commandMode&&"command"!==this.mode&&this.switchMode_("command"),this.mathlist.decorateCommandStringAroundInsertionPoint(!1),e.simulateKeystroke){const e=t.charAt(0),i=ti.charToEvent(e);if(!this.$keystroke(ti.keyboardEventToString(i),i))return}let i="",s=!1;if(this.pasteInProgress)this.pasteInProgress=!1,this.mathlist.insert(t,{smartFence:this.config.smartFence,mode:"math"});else{const e={...this.mathlist.anchorStyle(),...this.style},n=g.splitGraphemes(t);for(const t of n)if("command"===this.mode){this.mathlist.removeSuggestion(),this.suggestionIndex=0;const e=this.mathlist.extractCommandStringAroundInsertionPoint(),n=Rt.suggest(e+t);s=n.length>1,0===n.length?(this.mathlist.insert(t,{mode:"command"}),/^\\[a-zA-Z\\*]+$/.test(e+t)&&this.mathlist.decorateCommandStringAroundInsertionPoint(!0),ai.hidePopover(this)):(this.mathlist.insert(t,{mode:"command"}),n[0].match!==e+t&&this.mathlist.insertSuggestion(n[0].match,-n[0].match.length+e.length+1),i=n[0].match)}else if("math"===this.mode){const i={"^":"moveToSuperscript",_:"moveToSubscript"," ":"moveAfterParent"}[t];if(i){if("moveToSuperscript"===i){if(this._superscriptDepth()>=this.config.scriptDepth[1])return void this._announce("plonk")}else if("moveToSubscript"===i&&this._subscriptDepth()>=this.config.scriptDepth[0])return void this._announce("plonk");this.$perform(i)}else this.config.smartSuperscript&&"superscript"===this.mathlist.relation()&&/[0-9]/.test(t)&&0===this.mathlist.siblings().filter(t=>"first"!==t.type).length?(this.mathlist.insert(t,{mode:"math",style:e}),this.mathlist.moveAfterParent_()):this.mathlist.insert(t,{mode:"math",style:e,smartFence:this.config.smartFence})}else"text"===this.mode&&this.mathlist.insert(t,{mode:"text",style:e})}"command"!==this.mode&&this.undoManager.snapshotAndCoalesce(this.config),this._requestUpdate(),this.scrollIntoView(),ai.showPopoverWithLatex(this,i,s)}_hash(){let t=0;const e=this.mathlist.root.toLatex(!1);for(let i=0;i<e.length;i++)t=31*t+e.charCodeAt(i),t|=0;return Math.abs(t)}_requestUpdate(){this.dirty||(this.dirty=!0,requestAnimationFrame(t=>this._render()))}_render(t){t=t||{},this.dirty=!1,window.mathlive||(window.mathlive={}),this.mathlist.anchor()||(this.mathlist.path=[{relation:"body",offset:0}]),this.mathlist.forEach(t=>{t.caret="",t.isSelected=!1});const e=this.$hasFocus();this.mathlist.isCollapsed()?this.mathlist.anchor().caret=e?this.mode:"":this.mathlist.forEachSelected(t=>{t.isSelected=!0});const i=pe.decompose({mathstyle:"displaystyle",generateID:{seed:this._hash(),groupNumbers:t.forHighlighting},macros:this.config.macros},this.mathlist.root),s=et.makeSpan(i,"ML__base");s.attributes={translate:"no","aria-hidden":"true"};const n=et.makeSpan("","ML__strut");n.setStyle("height",s.height,"em");const r=[n];if(0!==s.depth){const t=et.makeSpan("","ML__strut--bottom");t.setStyle("height",s.height+s.depth,"em"),t.setStyle("vertical-align",-s.depth,"em"),r.push(t)}r.push(s);const o=et.makeSpan(r,"ML__mathlive");this.field.innerHTML=o.toMarkup(0,this.config.horizontalSpacingScale),this.field.classList.toggle("ML__focused",e),this.accessibleNode.innerHTML="<math xmlns='http://www.w3.org/1998/Math/MathML'>"+pe.toMathML(this.mathlist.root,this.config)+"</math>";const a=this._getSelectionBounds();if(a){const t=document.createElement("div");t.classList.add("ML__selection"),t.style.position="absolute",t.style.left=a.left+"px",t.style.top=a.top+"px",t.style.width=Math.ceil(a.right-a.left)+"px",t.style.height=Math.ceil(a.bottom-a.top-1)+"px",this.field.insertBefore(t,this.field.childNodes[0])}}_onPaste(){return this.pasteInProgress=!0,!0}_onCut(){return setTimeout((function(){this.$clearSelection(),this._requestUpdate()}).bind(this),0),!0}_onCopy(t){this.mathlist.isCollapsed()?(t.clipboardData.setData("text/plain",this.$text("latex-expanded")),t.clipboardData.setData("application/json",this.$text("json")),t.clipboardData.setData("application/xml",this.$text("mathML"))):(t.clipboardData.setData("text/plain",this.$selectedText("latex-expanded")),t.clipboardData.setData("application/json",this.$selectedText("json")),t.clipboardData.setData("application/xml",this.$selectedText("mathML"))),t.preventDefault()}formatMathlist(t,e){let i="";if("latex"===(e=e||"latex")||"latex-expanded"===e)i=t.toLatex("latex-expanded"===e);else if("mathML"===e)i=t.toMathML(this.config);else if("spoken"===e)i=pe.toSpeakableText(t,this.config);else if("spoken-text"===e){const e=this.config.textToSpeechMarkup;this.config.textToSpeechMarkup="",i=pe.toSpeakableText(t,this.config),this.config.textToSpeechMarkup=e}else if("spoken-ssml"===e||"spoken-ssml-withHighlighting"===e){const s=this.config.textToSpeechMarkup,n=this.config.generateID;this.config.textToSpeechMarkup="ssml","spoken-ssml-withHighlighting"===e&&(this.config.generateID=!0),i=pe.toSpeakableText(t,this.config),this.config.textToSpeechMarkup=s,this.config.generateID=n}else if("json"===e){const e=pe.toAST(t,this.config);i=JSON.stringify(e)}else"ASCIIMath"===e&&(i=function t(e,i){if(!e)return"";if(Array.isArray(e)){let i="";if(0===e.length)return"";if("first"===e[0].type&&e.shift(),"text"===e[0].mode){let s=0;for(i='"';e[s]&&"text"===e[s].mode;)i+=e[s].body,s++;i+='"'+t(e.slice(s))}else{let s=0;for(;e[s]&&"math"===e[s].mode;)i+=t(e[s]),s++;i+=t(e.slice(s))}return i.trim()}let s="";const n=e.latex?e.latex.trim():null;let r;switch(e.type){case"group":case"root":s=t(e.body);break;case"array":break;case"genfrac":(e.leftDelim||e.rightDelim)&&(s+="."!==e.leftDelim&&e.leftDelim?e.leftDelim:"{:"),e.hasBarLine?(s+="(",s+=t(e.numer),s+=")/(",s+=t(e.denom),s+=")"):(s+="("+t(e.numer)+"),",s+="("+t(e.denom)+")"),(e.leftDelim||e.rightDelim)&&(s+="."!==e.rightDelim&&e.rightDelim?e.rightDelim:"{:");break;case"surd":s+=e.index?"root("+t(e.index)+")("+t(e.body)+")":"sqrt("+t(e.body)+")";break;case"leftright":s+="."!==e.leftDelim&&e.leftDelim?e.leftDelim:"{:",s+=t(e.body),s+="."!==e.rightDelim&&e.rightDelim?e.rightDelim:"{:";break;case"sizeddelim":case"delim":case"accent":break;case"line":case"overlap":case"overunder":break;case"mord":"\\"===(s=Ci[n]||n||("string"==typeof e.body?e.body:""))[0]&&(s+=""),(r=n?n.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):null)?s=String.fromCharCode(parseInt("0x"+r[1])):s.length>0&&"\\"===s.charAt(0)&&(s="string"==typeof e.body?e.body.charAt(0):e.latex);break;case"mbin":case"mrel":case"textord":case"minner":s=n&&Ci[n]?Ci[n]:n&&xi[n]?xi[n]:e.body;break;case"mopen":case"mclose":s+=e.body;break;case"mpunct":s=xi[n]||n;break;case"mop":"​"!==e.body&&(s="",s+="\\operatorname"===n?e.body:e.body||n,s+=" ");break;case"mathstyle":case"box":case"spacing":case"enclose":break;case"space":s=" "}if(e.subscript){s+="_";const i=t(e.subscript);i.length>1&&!/^(-)?\d+(\.\d*)?$/.test(i)?s+="("+i+")":s+=i}if(e.superscript){s+="^";const i=t(e.superscript);i.length>1&&!/^(-)?\d+(\.\d*)?$/.test(i)?s+="("+i+")":s+=i}return s}(t));return i}$text(t){return this.formatMathlist(this.mathlist.root,t)}$selectedText(t){const e=this.mathlist.getSelectedAtoms();if(!e)return"";const i=pe.makeRoot("math",e);return this.formatMathlist(i,t)}$selectionIsCollapsed(){return this.mathlist.isCollapsed()}$selectionDepth(){return this.mathlist.path.length}_superscriptDepth(){let t=0,e=0,i=this.mathlist.ancestor(e),s=!1;for(;i;)(i.superscript||i.subscript)&&(t+=1),i.superscript?s=!0:i.subscript&&(s=!1),i=this.mathlist.ancestor(e+=1);return s?t:0}_subscriptDepth(){let t=0,e=0,i=this.mathlist.ancestor(e),s=!1;for(;i;)(i.superscript||i.subscript)&&(t+=1),i.superscript?s=!1:i.subscript&&(s=!0),i=this.mathlist.ancestor(e+=1);return s?t:0}$selectionAtStart(){return 0===this.mathlist.startOffset()}$selectionAtEnd(){return this.mathlist.endOffset()>=this.mathlist.siblings().length-1}groupIsSelected(){return 0===this.mathlist.startOffset()&&this.mathlist.endOffset()>=this.mathlist.siblings().length-1}$latex(t,e){return t?(t!==this.mathlist.root.toLatex()&&(e=e||{},this.mathlist.insert(t,Object.assign({},this.config,{insertionMode:"replaceAll",selectionMode:"after",format:"latex",mode:"math",suppressChangeNotifications:e.suppressChangeNotifications})),this.undoManager.snapshot(this.config),this._requestUpdate()),t):this.mathlist.root.toLatex()}$el(){return this.element}undo(){return this.complete_(),this.undoManager.undo(this.config),!0}redo(){return this.complete_(),this.undoManager.redo(this.config),!0}scrollIntoView(){this.dirty&&this._render();let t=this._getCaretPosition();const e=this.field.getBoundingClientRect();if(!t){const i=this._getSelectionBounds();i&&(t={x:i.right+e.left-this.field.scrollLeft,y:i.top+e.top-this.field.scrollTop})}if(t){const i=t.x-window.scrollX;i<e.left?this.field.scroll({top:0,left:i-e.left+this.field.scrollLeft-20,behavior:"smooth"}):i>e.right&&this.field.scroll({top:0,left:i-e.right+this.field.scrollLeft+20,behavior:"smooth"})}}scrollToStart(){this.field.scroll(0,0)}scrollToEnd(){const t=this.field.getBoundingClientRect();this.field.scroll(t.left-window.scrollX,0)}enterCommandMode_(){this.switchMode_("command")}copyToClipboard_(){return this.$focus(),this.mathlist.isCollapsed()&&this.$select(),document.execCommand("copy"),!1}cutToClipboard_(){return this.$focus(),document.execCommand("cut"),!0}pasteFromClipboard_(){return this.$focus(),document.execCommand("paste"),!0}$insert(t,e){if("string"==typeof t&&t.length>0){if((e=e||{}).focus&&this.$focus(),e.feedback&&(this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(ws),this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play())),"\\\\"===t)this.mathlist.addRowAfter_();else if("&"===t)this.mathlist.addColumnAfter_();else{const i=this.style;this.mathlist.insert(t,{mode:this.mode,style:this.mathlist.anchorStyle(),...e}),e.resetStyle&&(this.style=i)}return this.undoManager.snapshot(this.config),this._requestUpdate(),!0}return!1}switchMode_(t,e,i){this._resetKeystrokeBuffer(),this.smartModeSuppressed=/text|math/.test(this.mode)&&/text|math/.test(t),e&&this.$insert(e,{format:"latex",mode:{math:"text",text:"math"}[t]}),this.mathlist.decorateCommandStringAroundInsertionPoint(!1),"command"===t?(this.mathlist.removeSuggestion(),ai.hidePopover(this),this.suggestionIndex=0,this.virtualKeyboardVisible&&this.switchKeyboardLayer_("lower-command"),this.mathlist.insert("",{mode:"math"})):this.mode=t,i&&this.$insert(i,{format:"latex",mode:t}),"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode),this._requestUpdate()}complete_(t){if(t=t||{},ai.hidePopover(this),t.discard)return this.mathlist.spliceCommandStringAroundInsertionPoint(null),this.switchMode_("math"),!0;const e=this.mathlist.extractCommandStringAroundInsertionPoint(!t.acceptSuggestion);if(e){if("\\("===e||"\\)"===e)this.mathlist.spliceCommandStringAroundInsertionPoint([]),this.mathlist.insert(e.slice(1),{mode:this.mode});else{const t="math";if(Rt.commandAllowed(t,e)){const i=Ce.parseTokens(v.tokenize(e),t,null,this.config.macros);this.mathlist.spliceCommandStringAroundInsertionPoint(i)}else{const i=Ce.parseTokens(v.tokenize(e),t,null,this.config.macros);i?this.mathlist.spliceCommandStringAroundInsertionPoint(i):this.mathlist.decorateCommandStringAroundInsertionPoint(!0)}}return this.undoManager.snapshot(this.config),this._announce("replacement"),!0}return!1}_updateSuggestion(){this.mathlist.positionInsertionPointAfterCommitedCommand(),this.mathlist.removeSuggestion();const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=Rt.suggest(t);if(0===e.length)ai.hidePopover(this),this.mathlist.decorateCommandStringAroundInsertionPoint(!0);else{const i=this.suggestionIndex%e.length,s=t.length-e[i].match.length;0!==s&&this.mathlist.insertSuggestion(e[i].match,s),ai.showPopoverWithLatex(this,e[i].match,e.length>1)}this._requestUpdate()}nextSuggestion_(){return this.suggestionIndex+=1,this._updateSuggestion(),!1}previousSuggestion_(){if(this.suggestionIndex-=1,this.suggestionIndex<0){this.mathlist.removeSuggestion();const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=Rt.suggest(t);this.suggestionIndex=e.length-1}return this._updateSuggestion(),!1}_attachButtonHandlers(t,e){const i=this;let s,n,r,o,a;"object"==typeof e&&(e.default||e.pressed)?(e.default&&t.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e.default)),e.alt&&t.setAttribute("data-"+this.config.namespace+"command-alt",JSON.stringify(e.alt)),e.altshift&&t.setAttribute("data-"+this.config.namespace+"command-altshift",JSON.stringify(e.altshift)),e.shift&&t.setAttribute("data-"+this.config.namespace+"command-shift",JSON.stringify(e.shift)),e.pressed&&t.setAttribute("data-"+this.config.namespace+"command-pressed",JSON.stringify(e.pressed)),e.pressAndHoldStart&&t.setAttribute("data-"+this.config.namespace+"command-pressAndHoldStart",JSON.stringify(e.pressAndHoldStart)),e.pressAndHoldEnd&&t.setAttribute("data-"+this.config.namespace+"command-pressAndHoldEnd",JSON.stringify(e.pressAndHoldEnd))):t.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e)),ks(t,"mousedown touchstart:passive",(function(e){if("mousedown"!==e.type||1===e.buttons){e.stopPropagation(),e.preventDefault(),t.classList.add("pressed"),s=Date.now(),"touchstart"===e.type&&(r=e.changedTouches[0].identifier);const o=t.getAttribute("data-"+i.config.namespace+"command-pressed");o&&i.$perform(JSON.parse(o));const l=t.getAttribute("data-"+i.config.namespace+"command-pressAndHoldStart");l&&(n=t,a&&clearTimeout(a),a=window.setTimeout((function(){t.classList.contains("pressed")&&i.$perform(JSON.parse(l))}),300))}})),ks(t,"mouseleave touchcancel",(function(){t.classList.remove("pressed")})),ks(t,"touchmove:passive",(function(t){t.preventDefault();for(let e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].identifier===r){const i=document.elementFromPoint(t.changedTouches[e].clientX,t.changedTouches[e].clientY);i!==o&&o&&(o.dispatchEvent(new MouseEvent("mouseleave"),{bubbles:!0}),o=null),i&&(o=i,i.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,buttons:1})))}})),ks(t,"mouseenter",(function(e){1===e.buttons&&t.classList.add("pressed")})),ks(t,"mouseup touchend click",(function(e){if(o){e.stopPropagation(),e.preventDefault();const t=o;return o=null,void t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0}))}if(t.classList.remove("pressed"),t.classList.add("active"),"click"===e.type&&0!==e.detail)return e.stopPropagation(),void e.preventDefault();window.setTimeout((function(){t.classList.remove("active")}),150);let r=t.getAttribute("data-"+i.config.namespace+"command-pressAndHoldEnd");const a=Date.now();(t!==n||a<s+300)&&(r=void 0),!r&&e.altKey&&e.shiftKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-altshift")),!r&&e.altKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-alt")),!r&&e.shiftKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-shift")),r||(r=t.getAttribute("data-"+i.config.namespace+"command")),r&&i.$perform(JSON.parse(r)),e.stopPropagation(),e.preventDefault()}))}_makeButton(t,e,i,s){const n=document.createElement("span");return n.innerHTML=t,e&&n.classList.add([].slice.call(e.split(" "))),i&&n.setAttribute("aria-label",i),this._attachButtonHandlers(n,s),n}showAlternateKeys_(t,e){const i=Ts("mathlive-alternate-keys-panel","ML__keyboard alternate-keys");this.virtualKeyboard.classList.contains("material")&&i.classList.add("material"),i.style.width=e.length>=7?"286px":4===e.length||2===e.length?"146px":1===e.length?"86px":"146px",i.style.height="auto";let s="";for(const r of e)s+="<li","string"==typeof r?s+=' data-latex="'+r.replace(/"/g,"&quot;")+'"':(r.latex&&(s+=' data-latex="'+r.latex.replace(/"/g,"&quot;")+'"'),r.content&&(s+=' data-content="'+r.content.replace(/"/g,"&quot;")+'"'),r.insert&&(s+=' data-insert="'+r.insert.replace(/"/g,"&quot;")+'"'),r.command&&(s+=" data-command='"+r.command.replace(/"/g,"&quot;")+"'"),r.aside&&(s+=' data-aside="'+r.aside.replace(/"/g,"&quot;")+'"'),r.classes&&(s+=' data-classes="'+r.classes+'"')),s+=">",s+=r.label||"",s+="</li>";i.innerHTML=s="<ul>"+s+"</ul>",vi.makeKeycap(this,i.getElementsByTagName("li"),"performAlternateKeys");const n=this.virtualKeyboard.querySelector('div.keyboard-layer.is-visible div.rows ul li[data-alt-keys="'+t+'"]').getBoundingClientRect();if(n){n.top-i.clientHeight<0&&(i.style.width="auto",i.style.height=e.length<=6?"56px":e.length<=12?"108px":"205px");const t=(n.top-i.clientHeight+5).toString()+"px",s=Math.max(0,Math.min(window.innerWidth-i.offsetWidth,(n.left+n.right-i.offsetWidth)/2))+"px";i.style.transform="translate("+s+","+t+")",i.classList.add("is-visible")}return!1}hideAlternateKeys_(){const t=document.getElementById("mathlive-alternate-keys-panel");return t&&(t.classList.remove("is-visible"),t.innerHTML="",Ms(t)),!1}performAlternateKeys_(t){return this.hideAlternateKeys_(),this.$perform(t)}switchKeyboardLayer_(t){if("off"!==this.config.virtualKeyboardMode){"lower-command"!==t&&"upper-command"!==t&&"symbols-command"!==t&&this.complete_(),this.showVirtualKeyboard_(),this.hideAlternateKeys_(),this.unshiftKeyboardLayer_();const e=this.virtualKeyboard.getElementsByClassName("keyboard-layer");let i=!1;for(let s=0;s<e.length;s++)if(e[s].id===t){i=!0;break}if(i)for(let s=0;s<e.length;s++)e[s].id===t?e[s].classList.add("is-visible"):e[s].classList.remove("is-visible");this.$focus()}return!0}shiftKeyboardLayer_(){const t=this.virtualKeyboard.querySelectorAll("div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action");if(t)for(let e=0;e<t.length;e++){const i=t[e];let s=i.getAttribute("data-shifted");if(s||/^[a-z]$/.test(i.innerHTML)){i.setAttribute("data-unshifted-content",i.innerHTML),s||(s=i.innerHTML.toUpperCase()),i.innerHTML=s;const t=i.getAttribute("data-"+this.config.namespace+"command");if(t){i.setAttribute("data-unshifted-command",t);const e=i.getAttribute("data-shifted-command");if(e)i.setAttribute("data-"+this.config.namespace+"command",e);else{const e=JSON.parse(t);Array.isArray(e)&&(e[1]=e[1].toUpperCase()),i.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e))}}}}return!1}unshiftKeyboardLayer_(){const t=this.virtualKeyboard.querySelectorAll("div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action");if(t)for(let e=0;e<t.length;e++){const i=t[e],s=i.getAttribute("data-unshifted-content");s&&(i.innerHTML=s);const n=i.getAttribute("data-unshifted-command");n&&i.setAttribute("data-"+this.config.namespace+"command",n)}return!1}insertAndUnshiftKeyboardLayer_(t){return this.$insert(t),this.unshiftKeyboardLayer_(),!0}toggleVirtualKeyboardAlt_(){let t=!1;return this.virtualKeyboard&&(t=this.virtualKeyboard.classList.contains("material"),this.virtualKeyboard.remove(),delete this.virtualKeyboard,this.virtualKeyboard=null),this.showVirtualKeyboard_(t?"":"material"),!1}toggleVirtualKeyboardShift_(){this.config.virtualKeyboardLayout={qwerty:"azerty",azerty:"qwertz",qwertz:"dvorak",dvorak:"colemak",colemak:"qwerty"}[this.config.virtualKeyboardLayout];let t=this.virtualKeyboard?this.virtualKeyboard.querySelector("div.keyboard-layer.is-visible"):null;return t=t?t.id:"",this.virtualKeyboard&&(this.virtualKeyboard.remove(),delete this.virtualKeyboard,this.virtualKeyboard=null),this.showVirtualKeyboard_(),t&&this.switchKeyboardLayer_(t),!1}showVirtualKeyboard_(t){return this.virtualKeyboardVisible=!1,this.toggleVirtualKeyboard_(t),!1}hideVirtualKeyboard_(){return this.virtualKeyboardVisible=!0,this.toggleVirtualKeyboard_(),!1}toggleVirtualKeyboard_(t){if(this.virtualKeyboardVisible=!this.virtualKeyboardVisible,this.virtualKeyboardVisible){this.virtualKeyboard?this.virtualKeyboard.classList.add("is-visible"):(this.virtualKeyboard=vi.make(this,t),ks(this.virtualKeyboard,"touchstart:passive mousedown",(function(){e.$focus()})),document.body.appendChild(this.virtualKeyboard));const e=this;window.setTimeout((function(){e.virtualKeyboard.classList.add("is-visible")}),1)}else this.virtualKeyboard&&this.virtualKeyboard.classList.remove("is-visible");return"function"==typeof this.config.onVirtualKeyboardToggle&&this.config.onVirtualKeyboardToggle(this,this.virtualKeyboardVisible,this.virtualKeyboard),!1}$applyStyle(t){if(this._resetKeystrokeBuffer(),(t=function(t){const e={};return"string"==typeof t.mode&&(e.mode=t.mode.toLowerCase()),"string"==typeof t.color&&(e.color=t.color),"string"==typeof t.backgroundColor&&(e.backgroundColor=t.backgroundColor),"string"==typeof t.fontFamily&&(e.fontFamily=t.fontFamily),"string"==typeof t.series&&(e.fontSeries=t.series),"string"==typeof t.fontSeries&&(e.fontSeries=t.fontSeries.toLowerCase()),e.fontSeries&&(e.fontSeries={bold:"b",medium:"m",normal:"mn"}[e.fontSeries]||e.fontSeries),"string"==typeof t.shape&&(e.fontShape=t.shape),"string"==typeof t.fontShape&&(e.fontShape=t.fontShape.toLowerCase()),e.fontShape&&(e.fontShape={italic:"it",up:"n",upright:"n",normal:"n"}[e.fontShape]||e.fontShape),"string"==typeof t.size?e.fontSize=t.size:"number"==typeof t.size&&(e.fontSize="size"+Math.min(0,Math.max(10,t.size))),"string"==typeof t.fontSize&&(e.fontSize=t.fontSize.toLowerCase()),e.fontSize&&(e.fontSize={tiny:"size1",scriptsize:"size2",footnotesize:"size3",small:"size4",normal:"size5",normalsize:"size5",large:"size6",Large:"size7",LARGE:"size8",huge:"size9",Huge:"size10"}[e.fontSize]||e.fontSize),e}(t)).mode){if(this.mathlist.isCollapsed())this.switchMode_(t.mode);else{const t=this.mode,e="math"===(this.mathlist.anchorMode()||this.config.default)?"text":"math";let i=this.$selectedText("ASCIIMath");if("math"===e&&/^"[^"]+"$/.test(i)&&(i=i.slice(1,-1)),this.$insert(i,{mode:e,selectionMode:"item",format:"text"===e?"text":"ASCIIMath"}),this.mode=e,this.groupIsSelected()){const t=this.mathlist.parent();!t||"group"!==t.type&&"root"!==t.type||(t.mode=e)}this.mode!==t&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode)}delete t.mode}return this.mathlist.isCollapsed()?(this.style.fontSeries&&t.fontSeries===this.style.fontSeries&&(t.fontSeries="auto"),t.fontShape&&t.fontShape===this.style.fontShape&&(t.fontShape="auto"),t.color&&t.color===this.style.color&&(t.color="none"),t.backgroundColor&&t.backgroundColor===this.style.backgroundColor&&(t.backgroundColor="none"),t.fontSize&&t.fontSize===this.style.fontSize&&(t.fontSize="auto"),this.style={...this.style,...t}):(this.mathlist._applyStyle(t),this.undoManager.snapshot(this.config)),!0}$hasFocus(){return document.hasFocus()&&document.activeElement===this.textarea}$focus(){this.$hasFocus()||(this.textarea.focus&&this.textarea.focus(),this._announce("line"))}$blur(){this.$hasFocus()&&this.textarea.blur&&this.textarea.blur()}$select(){this.mathlist.selectAll_()}$clearSelection(){this.mathlist.delete_()}$keystroke(t,e){return this._onKeystroke(t,e)}$typedText(t){this._onTypedText(t)}typedText_(t,e){return this._onTypedText(t,e)}$setConfig(t){if(this.config||(this.config={smartFence:!0,smartSuperscript:!0,scriptDepth:[1/0,1/0],removeExtraneousParentheses:!0,overrideDefaultInlineShortcuts:!1,virtualKeyboard:"",virtualKeyboardLayout:"qwerty",namespace:""}),this.config={...this.config,...t},void 0!==this.config.scriptDepth&&!Array.isArray(this.config.scriptDepth)){const t=parseInt(this.config.scriptDepth);this.config.scriptDepth=[t,t]}if(void 0===this.config.removeExtraneousParentheses&&(this.config.removeExtraneousParentheses=!0),this.config.onAnnounce=t.onAnnounce||js,this.config.macros=Object.assign({},Rt.MACROS,this.config.macros),!/^[a-z]*[-]?$/.test(this.config.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(this.config.namespace)||(this.config.namespace+="-"),hi.locale=this.config.locale||hi.locale,hi.merge(this.config.strings),this.config.virtualKeyboardLayout=t.virtualKeyboardLayout||{fr:"azerty",be:"azerty",al:"qwertz",ba:"qwertz",cz:"qwertz",de:"qwertz",hu:"qwertz",sk:"qwertz",ch:"qwertz"}[hi.locale.substring(0,2)]||"qwerty",this.keypressSound=void 0,this.spacebarKeypressSound=void 0,this.returnKeypressSound=void 0,this.deleteKeypressSound=void 0,this.config.keypressSound&&("string"==typeof this.config.keypressSound?(this.keypressSound=new Audio,this.keypressSound.preload="none",this.keypressSound.src=this.config.keypressSound,this.keypressSound.volume=Es,this.spacebarKeypressSound=this.keypressSound,this.returnKeypressSound=this.keypressSound,this.deleteKeypressSound=this.keypressSound):(this.keypressSound=new Audio,this.keypressSound.preload="none",this.keypressSound.src=this.config.keypressSound.default,this.keypressSound.volume=Es,this.spacebarKeypressSound=this.keypressSound,this.returnKeypressSound=this.keypressSound,this.deleteKeypressSound=this.keypressSound,this.config.keypressSound.spacebar&&(this.spacebarKeypressSound=new Audio,this.spacebarKeypressSound.preload="none",this.spacebarKeypressSound.src=this.config.keypressSound.spacebar,this.spacebarKeypressSound.volume=Es),this.config.keypressSound.return&&(this.returnKeypressSound=new Audio,this.returnKeypressSound.preload="none",this.returnKeypressSound.src=this.config.keypressSound.return,this.returnKeypressSound.volume=Es),this.config.keypressSound.delete&&(this.deleteKeypressSound=new Audio,this.deleteKeypressSound.preload="none",this.deleteKeypressSound.src=this.config.keypressSound.delete,this.deleteKeypressSound.volume=Es))),this.config.plonkSound&&(this.plonkSound=new Audio,this.plonkSound.preload="none",this.plonkSound.src=this.config.plonkSound,this.plonkSound.volume=Es)}speak_(t,e){e=e||{withHighlighting:!1};const i=function(t,e){let i=null;switch(e){case"all":i=t.mathlist.root;break;case"selection":t.mathlist.isCollapsed()||(i=t.mathlist.getSelectedAtoms());break;case"left":{const e=t.mathlist.siblings(),s=t.mathlist.startOffset();if(s>=1){i=[];for(let t=1;t<=s;t++)i.push(e[t])}break}case"right":{const e=t.mathlist.siblings(),s=t.mathlist.endOffset()+1;if(s<=e.length-1){i=[];for(let t=s;t<=e.length-1;t++)i.push(e[t])}break}case"start":case"end":break;case"group":i=t.mathlist.siblings();break;case"parent":{const e=t.mathlist.parent();e&&"root"!==e.type&&(i=t.mathlist.parent());break}}return i}(this,t);if(null===i)return this.config.handleSpeak(function(t){let e="";switch(t){case"all":break;case"selection":e="no selection";break;case"left":e="at start";break;case"right":e="at end";break;case"group":break;case"parent":e="no parent"}return e}(t)),!1;const s={...this.config};(e.withHighlighting||"amazon"===s.speechEngine)&&(s.textToSpeechMarkup=window.sre&&"sre"===s.textToSpeechRules?"ssml_step":"ssml",e.withHighlighting&&(s.generateID=!0));const n=pe.toSpeakableText(i,s);return e.withHighlighting?(window.mathlive.readAloudMathField=this,this._render({forHighlighting:!0}),this.config.handleReadAloud&&this.config.handleReadAloud(this.field,n,this.config)):this.config.handleSpeak&&this.config.handleSpeak(n,s),!1}}let Ns,Ls=0;function Ds(t,e,i){const s=Object.assign({},t.config);return s.textToSpeechMarkup="",s.textToSpeechRulesOptions=s.textToSpeechRulesOptions||{},s.textToSpeechRulesOptions.markup="none",e+pe.toSpeakableText(i,s)}function js(t,e,i,s){let n="";"plonk"===e?(t.plonkSound&&(t.plonkSound.load(),t.plonkSound.play().catch(t=>void 0)),t._resetKeystrokeBuffer()):"delete"===e?n=Ds(t,"deleted: ",s):"focus"===e||/move/.test(e)?n=(t.mathlist.isCollapsed()?"":"selected: ")+t._nextAtomSpeechText(i):"replacement"===e?n=Ds(t,"",t.mathlist.sibling(0)):"line"===e?(n=Ds(t,"",t.mathlist.root),t.accessibleNode.innerHTML='<math xmlns="http://www.w3.org/1998/Math/MathML">'+pe.toMathML(t.mathlist.root,t.config)+"</math>",t.textarea.setAttribute("aria-label","after: "+n)):n=s?Ds(t,e+" ",s):e;const r=/\u00a0/.test(t.ariaLiveText.textContent)?"   ":"   ";t.ariaLiveText.textContent=n+r}Os.prototype.undo_=Os.prototype.undo,Os.prototype.redo_=Os.prototype.redo,Os.prototype.scrollIntoView_=Os.prototype.scrollIntoView,Os.prototype.scrollToStart_=Os.prototype.scrollToStart,Os.prototype.scrollToEnd_=Os.prototype.scrollToEnd,Os.prototype.insert_=Os.prototype.$insert;var Is={MathField:Os};function Rs(t,e,i){let s=i,n=0;const r=t.length;for(;s<e.length;){const i=e[s];if(n<=0&&e.slice(s,s+r)===t)return s;"\\"===i?s++:"{"===i?n++:"}"===i&&n--,s++}return-1}function Bs(t,e,i,s){const n=[];for(let r=0;r<t.length;r++)if("text"===t[r].type){const o=t[r].data;let a,l=!0,h=0;-1!==(a=o.indexOf(e))&&((h=a)>0&&n.push({type:"text",data:o.slice(0,h)}),l=!1);let c=!1;for(;!c;){if(l){if(-1===(a=o.indexOf(e,h))){c=!0;break}h!==a&&n.push({type:"text",data:o.slice(h,a)}),h=a}else{if(-1===(a=Rs(i,o,h+e.length))){c=!0;break}n.push({type:"math",data:o.slice(h+e.length,a),rawData:o.slice(h,a+i.length),mathstyle:s}),h=a+i.length}l=!l}h<o.length&&n.push({type:"text",data:o.slice(h)})}else n.push(t[r]);return n}function Fs(t,e){let i=[{type:"text",data:t}];for(let s=0;s<e.inline.length;s++){const t=e.inline[s];i=Bs(i,t[0],t[1],"textstyle")}for(let s=0;s<e.display.length;s++){const t=e.display[s];i=Bs(i,t[0],t[1],"displaystyle")}return i}function Ys(t,e,i,s){const n=function(t,e,i,s){let n=document.createElement("span");n.setAttribute("aria-hidden","true"),e.preserveOriginalContent&&(n.setAttribute("data-"+e.namespace+"original-content",t),i&&n.setAttribute("data-"+e.namespace+"original-mathstyle",i));try{n.innerHTML=e.renderToMarkup(t,i||"displaystyle","html",e.macros)}catch(e){if(!s)return null;n=document.createTextNode(t)}return n}(t,i,e,s);if(n&&/\b(mathml|speakable-text)\b/i.test(i.renderAccessibleContent)){const e=document.createDocumentFragment();if(/\bmathml\b/i.test(i.renderAccessibleContent)&&i.renderToMathML&&e.appendChild(function(t,e){const i=document.createElement("span");try{i.innerHTML="<math xmlns='http://www.w3.org/1998/Math/MathML'>"+e.renderToMathML(t,e)+"</math>"}catch(e){i.textContent=t}return i.className="sr-only",i}(t,i)),/\bspeakable-text\b/i.test(i.renderAccessibleContent)&&i.renderToSpeakableText){const s=document.createElement("span");s.innerHTML=i.renderToSpeakableText(t,i),s.className="sr-only",e.appendChild(s)}return e.appendChild(n),e}return n}function zs(t,e){let i=null;if(e.TeX.processEnvironments&&/^\s*\\begin/.test(t))(i=document.createDocumentFragment()).appendChild(Ys(t,void 0,e,!0));else{const s=Fs(t,e.TeX.delimiters);if(1===s.length&&"text"===s[0].type)return null;i=document.createDocumentFragment();for(let t=0;t<s.length;t++)i.appendChild("text"===s[t].type?document.createTextNode(s[t].data):Ys(s[t].data,s[t].mathstyle,e,!0))}return i}const Xs={namespace:"",skipTags:["noscript","style","textarea","pre","code","annotation","annotation-xml"],processScriptType:"math/tex",ignoreClass:"tex2jax_ignore",processClass:"tex2jax_process",preserveOriginalContent:!0,renderAccessibleContent:"mathml",TeX:{disabled:!1,processEnvironments:!0,delimiters:{inline:[["\\(","\\)"]],display:[["$$","$$"],["\\[","\\]"]]}}};var Us={renderMathInElement:function(t,e){try{if((e=Object.assign({},Xs,e)).ignoreClassPattern=new RegExp(e.ignoreClass),e.processClassPattern=new RegExp(e.processClass),e.processScriptTypePattern=new RegExp(e.processScriptType),e.macros=Rt.MACROS,e.namespace){if(!/^[a-z]+[-]?$/.test(e.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(e.namespace)||(e.namespace+="-")}!function t(e,i){const s=e.getAttribute("data-"+i.namespace+"original-content");if(s){const t=Ys(s,e.getAttribute("data-"+i.namespace+"mathstyle"),i,!1);null!=t&&(e.textContent="",e.appendChild(t))}else{if(1===e.childNodes.length&&3===e.childNodes[0].nodeType){const t=e.childNodes[0].textContent;if(i.TeX.processEnvironments&&/^\s*\\begin/.test(t))return e.textContent="",void e.appendChild(Ys(t,void 0,i,!0));const s=Fs(t,i.TeX.delimiters);if(1===s.length&&"math"===s[0].type)return e.textContent="",void e.appendChild(Ys(s[0].data,s[0].mathstyle,i,!0));if(1===s.length&&"text"===s[0].type)return}for(let s=0;s<e.childNodes.length;s++){const n=e.childNodes[s];if(3===n.nodeType){const t=zs(n.textContent,i);t&&(s+=t.childNodes.length-1,e.replaceChild(t,n))}else if(1===n.nodeType){const e=n.nodeName.toLowerCase();if("script"===e&&i.processScriptTypePattern.test(n.type)){let t="displaystyle";for(const i of n.type.split(";")){const e=i.split("=");"mode"===e[0].toLowerCase()&&(t="display"===e[1].toLoweCase()?"displaystyle":"textstyle")}const e=Ys(n.textContent,t,i,!0);n.parentNode.replaceChild(e,n)}else(i.processClassPattern.test(n.className)||!i.skipTags.includes(e)&&!i.ignoreClassPattern.test(n.className))&&t(n,i)}}}}(t,e)}catch(t){Error}}};function Gs(t,e,i,s){e=e||"displaystyle";const n=v.tokenize(t),r=Ce.parseTokens(n,"math",null,s);if("mathlist"===i)return r;let o=pe.decompose({mathstyle:e},r);if(o=et.coalesce(o),"span"===i)return o;const a=et.makeSpan(o,"ML__base"),l=et.makeSpan("","ML__strut");l.setStyle("height",a.height,"em");const h=[l];if(0!==a.depth){const t=et.makeSpan("","ML__strut--bottom");t.setStyle("height",a.height+a.depth,"em"),t.setStyle("vertical-align",-a.depth,"em"),h.push(t)}return h.push(a),et.makeSpan(h,"ML__mathlive").toMarkup()}function Hs(t,e){if(!pe.toMathML)return"";(e=e||{}).macros=e.macros||{},Object.assign(e.macros,Rt.MACROS);const i=Ce.parseTokens(v.tokenize(t),"math",null,e.macros);return pe.toMathML(i,e)}function qs(t,e){if(!pe.toSpeakableText)return"";(e=e||{}).macros=e.macros||{},Object.assign(e.macros,Rt.MACROS);const i=Ce.parseTokens(v.tokenize(t),"math",null,e.macros);return pe.toSpeakableText(i,e)}function Js(t,e){if(!e&&window&&window.mathlive&&(e=window.mathlive.config),(e=e||{}).speechEngine&&"local"!==e.speechEngine)"amazon"===e.speechEngine&&window&&window.AWS&&new window.AWS.Polly({apiVersion:"2016-06-10"}).synthesizeSpeech({OutputFormat:"mp3",VoiceId:e.speechEngineVoice||"Joanna",Text:t,TextType:"ssml"},(function(t,e){if(t);else if(e&&e.AudioStream){const t=new Uint8Array(e.AudioStream),i=new Blob([t.buffer],{type:"audio/mpeg"}),s=URL.createObjectURL(i);new Audio(s).play().catch(t=>void 0)}}));else{const e=new SpeechSynthesisUtterance(t);window&&window.speechSynthesis.speak(e)}}function Vs(t,e,i){if(!window)return;if(!i&&window.mathlive&&(i=window.mathlive.config),"amazon"!==(i=i||{}).speechEngine)return void(i.handleSpeak&&i.handleSpeak(e));if(!window.AWS)return;const s=new window.AWS.Polly({apiVersion:"2016-06-10"}),n={OutputFormat:"json",VoiceId:i.speechEngineVoice||"Joanna",Text:e,TextType:"ssml",SpeechMarkTypes:["ssml"]};window.mathlive=window.mathlive||{},window.mathlive.readAloudElement=t;const r=i.onReadAloudStatus||window.mathlive.onReadAloudStatus;s.synthesizeSpeech(n,(function(t,e){if(t);else if(e&&e.AudioStream){const t=new TextDecoder("utf-8").decode(new Uint8Array(e.AudioStream));window.mathlive.readAloudMarks=t.split("\n").map(t=>t?JSON.parse(t):{}),window.mathlive.readAloudTokens=[];for(const e of window.mathlive.readAloudMarks)e.value&&window.mathlive.readAloudTokens.push(e.value);window.mathlive.readAloudCurrentMark="",n.OutputFormat="mp3",n.SpeechMarkTypes=[],s.synthesizeSpeech(n,(function(t,e){if(t);else if(e&&e.AudioStream){const t=new Uint8Array(e.AudioStream),i=new Blob([t.buffer],{type:"audio/mpeg"}),s=URL.createObjectURL(i);window.mathlive.readAloudAudio?window.mathlive.readAloudAudio.pause():(window.mathlive.readAloudAudio=new Audio,window.mathlive.readAloudAudio.addEventListener("ended",()=>{r&&r(window.mathlive.readAloudMathField,"ended"),window.mathlive.readAloudMathField?(window.mathlive.readAloudMathField._render(),window.mathlive.readAloudElement=null,window.mathlive.readAloudMathField=null,window.mathlive.readAloudTokens=[],window.mathlive.readAloudMarks=[],window.mathlive.readAloudCurrentMark=""):function t(e){e.classList.remove("highlight"),e.children&&Array.from(e.children).forEach(e=>{t(e)})}(window.mathlive.readAloudElement)}),window.mathlive.readAloudAudio.addEventListener("timeupdate",()=>{let t="";const e=1e3*window.mathlive.readAloudAudio.currentTime+100;for(const i of window.mathlive.readAloudMarks)i.time<e&&(t=i.value);window.mathlive.readAloudCurrentMark!==t&&(window.mathlive.readAloudCurrentToken=t,t&&t===window.mathlive.readAloudFinalToken?window.mathlive.readAloudAudio.pause():(window.mathlive.readAloudCurrentMark=t,function t(e,i){i&&e.dataset.atomId!==i?(e.classList.remove("highlight"),e.children&&e.children.length>0&&Array.from(e.children).forEach(e=>{t(e,i)})):(e.classList.add("highlight"),e.children&&e.children.length>0&&Array.from(e.children).forEach(e=>{t(e)}))}(window.mathlive.readAloudElement,window.mathlive.readAloudCurrentMark)))})),window.mathlive.readAloudAudio.src=s,r&&r(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()}}))}}))}function $s(t){let e=t;if("string"==typeof t&&!(e=document.getElementById(t)))throw Error(`The element with ID "${t}" could not be found.`);return e}function Ws(t,e){Us&&((e=e||{}).renderToMarkup=e.renderToMarkup||Gs,e.renderToMathML=e.renderToMathML||Hs,e.renderToSpeakableText=e.renderToSpeakableText||qs,e.macros=e.macros||Rt.MACROS,Us.renderMathInElement($s(t),e))}function Ks(t){if(t.namespace){if(!/^[a-z]+[-]?$/.test(t.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(t.namespace)||(t.namespace+="-")}}return{latexToMarkup:Gs,latexToMathML:Hs,latexToSpeakableText:qs,latexToAST:function(t,e){if(!pe.toAST)return{};(e=e||{}).macros=e.macros||{},Object.assign(e.macros,Rt.MACROS);const i=Ce.parseTokens(v.tokenize(t),"math",null,e.macros);return pe.toAST(i,e)},astToLatex:function(t,e){return function t(e,i){const s=Object.assign({precision:14,decimalMarker:".",groupSeparator:"\\, ",product:"\\cdot ",exponentProduct:"\\cdot ",exponentMarker:"",arcSeparator:"\\,",scientificNotation:"auto",beginRepeatingDigits:"\\overline{",endRepeatingDigits:"}"},i);let n="";if(void 0===e)return"";if("string"==typeof e&&(e=JSON.parse(e)),e.latex)n=e.latex;else if(ts(e)){const i=Qi(e);if(i===-1/0)n="-\\infty ";else if(i===1/0)n="\\infty ";else if("object"!=typeof e.num||"string"!=typeof e.num.re&&"string"!=typeof e.num.im)n=isNaN(i)?"\\text{NaN}":xs(e.num,s);else{const t=es(e),i=is(e);isNaN(t)||isNaN(i)?n="\\text{NaN}":Math.abs(i)<=Number.EPSILON&&Math.abs(t)<=Number.EPSILON?n="0":(Math.abs(t)>Number.EPSILON&&(n=xs(t,s)),Math.abs(i)>Number.EPSILON&&(Math.abs(t)>Number.EPSILON&&(n+=i>0?"+":""),n+=(1!==Math.abs(i)?xs(i,s):"")+"\\imaginaryI "))}ss(e)&&(n+="^{"+t(e.sup,s)+"}"),ns(e)&&(n+="_{"+t(e.sub,s)+"}")}else if(e.group)n=t(e.group,s),ts(e.group)||Zi(e.group)?0!==is(e.group)&&(n=ys(e.fence||"(),",n)):n=ys(e.fence||"(),",n),ss(e)&&(n+="^{"+t(e.sup,s)+"}"),ns(e)&&(n+="_{"+t(e.sub,s)+"}");else if(e.fn)if("bind"===e.fn){if(n=t(Yi(e,0),s)+"|_{",e.arg&&2===e.arg.length)n+=t(Yi(e,1));else{let i="";for(let s=1;s<e.arg.length;s+=2)n+=i+t(Yi(e,s))+" = "+t(Yi(e,s+1)),i=", "}n+="}"}else if("divide"===e.fn)n="\\frac{"+t(Yi(e,0),s)+"}{"+t(Yi(e,1),s)+"}";else if("negate"===e.fn)n="-"+t(Yi(e,0),s);else if("subtract"===e.fn)n=t(Yi(e,0),s)+" - "+t(Yi(e,1),s);else if("add"!==e.fn&&"multiply"!==e.fn||!Array.isArray(e.arg))if("list"===e.fn||"list2"===e.fn){const i=[];for(const n of e.arg)i.push(t(n,s));n=i.join("list2"===e.fn?"; ":", ")}else if("pow"===e.fn&&Array.isArray(e.arg)&&e.arg.length>=2)n=t(Yi(e,0),s),ts(Yi(e,0))||Zi(Yi(e,0))||(n=ys(e.fence||"(),",n)),n+="^{"+t(Yi(e,1),s)+"}";else if("equal"===e.fn&&e.arg&&e.arg.length>2)n=e.arg.map(e=>t(e,s)).join(" = ");else{const i=function(t){let e=Bi[t];return e||(e=t.length>1?"\\operatorname{"+t+"}%^%_ %":t+"%^%_ %"),e}(e.fn);n=i;let r="";if(/%(?![01_^])/.test(i)&&Array.isArray(e.arg)&&e.arg.length>1)n+=ys(e.fence||"(),",...e.arg.map(e=>t(e,s)));else if(Array.isArray(e.arg)&&e.arg.length>0){const o=t(Yi(e,0),s),a=t(Yi(e,1),s),l=[...e.arg];/%0/.test(i)&&(n=n.replace("%0",o),l.shift()),/%1/.test(i)&&(n=n.replace("%1",a),l.shift()),l.length>0&&(r=ys(e.fence||"(),",...l.map(e=>t(e,s))))}else r=ys(e.fence||"(),","");n=ss(e)?n.replace("%^","^{"+t(e.sup,s)+"}"):n.replace("%^",""),n=(n=(n=ns(e)?n.replace("%_","_{"+t(e.sub,s)+"}"):n.replace("%_","")).replace(/%(?![01_^])/,r)).replace("%0","").replace("%1","")}else{const i=[];for(const n of e.arg)"add"===n.fn||"subtract"===n.fn?i.push(ys("() ",t(n,s))):0!==es(r=n)&&0!==is(r)?i.push(ys("() ",t(n,s))):ss(e)&&0!==is(n)&&1!==is(n)?i.push(ys("() ",t(n,s))):i.push(t(n,s));if("multiply"===e.fn)n=!e.arg||2!==e.arg.length||!ts(e.arg[0])&&"divide"!==e.arg[0].fn||ts(e.arg[1])&&(0!==es(e.arg[1])||1!==is(e.arg[1]))?i.join(" \\times "):i[0]+i[1];else if(e.arg&&1===e.arg.length)n="negate"===e.arg[0].fn||ts(e.arg[0])&&Qi(e.arg[0])<0?i[0]:"+"+i[0];else{n=i[0];for(let t=1;t<e.arg.length;t++)"negate"===e.arg[t].fn||ts(e.arg[t])&&Qi(e.arg[t])<0?n+=i[t]:n+=" + "+i[t]}}else if("string"==typeof e.sym){let i=(n=Zi(e)).match(/^&#x([0-9a-f]+);$/i);i&&i[1]?n=String.fromCodePoint(parseInt(i[1],16)):(i=n.match(/^&#([0-9]+);$/i))&&i[1]&&(n=String.fromCodePoint(parseInt(i[1]))),"string"==typeof e.variant&&(n="\\"+{normal:"mathrm","double-struck":"mathbb",bold:"mathbf",fraktur:"mathfrak",script:"mathscr","sans-serif":"mathsf",monospace:"mathtt"}[e.variant]+"{"+n+"}"),ss(e)&&(n+="^{"+t(e.sup,s)+"}"),ns(e)&&(n+="_{"+t(e.sub,s)+"}")}else"string"==typeof e.text&&(n="\\text{"+e.text+"}");var r;return"string"==typeof e.error&&(n="\\bbox[#F56165]{"+n+"}"),n}(t,e)},makeMathField:function(t,e){if(!Is)throw Error("The MathField module is not loaded.");return(e=e||{}).handleSpeak=e.handleSpeak||Js,e.handleReadAloud=e.handleReadAloud||Vs,new Is.MathField($s(t),e)},renderMathInDocument:function(t){Ws(document.body,t)},renderMathInElement:Ws,revertToOriginalContent:function(t,e){(t=(t=$s(t)).children[1])instanceof Is.MathField?t.revertToOriginalContent():(Ks(e=e||{}),t.innerHTML=t.getAttribute("data-"+(e.namespace||"")+"original-content"))},getOriginalContent:function(t,e){return(t=(t=$s(t)).children[1])instanceof Is.MathField?t.originalContent:(Ks(e=e||{}),t.getAttribute("data-"+(e.namespace||"")+"original-content"))},readAloud:Vs,readAloudStatus:function(){return window?(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio?window.mathlive.readAloudAudio.paused?"paused":window.mathlive.readAloudAudio.ended?"ready":"playing":"ready"):"unavailable"},pauseReadAloud:function(){window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio&&(window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"paused"),window.mathlive.readAloudAudio.pause()))},resumeReadAloud:function(){window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio&&(window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()))},playReadAloud:function(t,e){if(window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio)){let i=0;if(window.mathlive.readAloudFinalToken=null,t){window.mathlive.readAloudMarks=window.mathlive.readAloudMarks||[];for(const e of window.mathlive.readAloudMarks)e.value===t&&(i=e.time/1e3);let s=window.mathlive.readAloudTokens.indexOf(t);s>=0&&(s+=e)<window.mathlive.readAloudTokens.length&&(window.mathlive.readAloudFinalToken=s)}window.mathlive.readAloudAudio.currentTime=i,window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()}}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).MathLive=factory();