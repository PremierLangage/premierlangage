/*! For license information please see scripts.js.LICENSE.txt */
class ComponentFramework{static createElement(t){const e=document.querySelector(`[cid="${t.cid}"]`),i=document.createElement(t.selector||{AutomatonEditor:"c-automaton-editor",AutomatonDrawer:"c-automaton-drawer",AutomatonViewer:"c-automaton-viewer",CheckboxGroup:"c-checkbox-group",CodeEditor:"c-code-editor",Countdown:"c-countdown",DragDrop:"c-drag-drop",GraphDrawer:"c-graph-drawer",GraphViewer:"c-graph-viewer",Input:"c-input",Hint:"c-hint",JSXGraph:"c-jsxgraph",KekuleEditor:"c-kekule-editor",KekuleViewer:"c-kekule-viewer",MatchList:"c-match-list",MathDrawer:"c-math-drawer",MathInput:"c-math-input",MathMatrix:"c-math-matrix",RadioGroup:"c-radio-group",SortList:"c-sort-list",Text:"c-text",TextSelect:"c-text-select",EvalGrid:"c-eval-grid"}[t.controller]);i.setAttribute("cid",t.cid),e.replaceWith(i),i.deserialize(t)}static findAnswers(t){return document.querySelectorAll("[cid]").forEach(e=>{t[e.getAttribute("cid")]=e.serialize()||{}}),t}}var global,factory;!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){"use strict";var i=[],s=Object.getPrototypeOf,n=i.slice,r=i.flat?function(t){return i.flat.call(t)}:function(t){return i.concat.apply([],t)},o=i.push,a=i.indexOf,l={},c=l.toString,h=l.hasOwnProperty,u=h.toString,d=u.call(Object),p={},f=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},m=function(t){return null!=t&&t===t.window},g=t.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function y(t,e,i){var s,n,r=(i=i||g).createElement("script");if(r.text=t,e)for(s in b)(n=e[s]||e.getAttribute&&e.getAttribute(s))&&r.setAttribute(s,n);i.head.appendChild(r).parentNode.removeChild(r)}function v(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t}var x=function(t,e){return new x.fn.init(t,e)};function C(t){var e=!!t&&"length"in t&&t.length,i=v(t);return!f(t)&&!m(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}x.fn=x.prototype={jquery:"3.6.0",constructor:x,length:0,toArray:function(){return n.call(this)},get:function(t){return null==t?n.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=x.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return x.each(this,t)},map:function(t){return this.pushStack(x.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:i.sort,splice:i.splice},x.extend=x.fn.extend=function(){var t,e,i,s,n,r,o=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[a]||{},a++),"object"==typeof o||f(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)s=t[e],"__proto__"!==e&&o!==s&&(c&&s&&(x.isPlainObject(s)||(n=Array.isArray(s)))?(i=o[e],r=n&&!Array.isArray(i)?[]:n||x.isPlainObject(i)?i:{},n=!1,o[e]=x.extend(c,r,s)):void 0!==s&&(o[e]=s));return o},x.extend({expando:"jQuery"+("3.6.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==c.call(t)||(e=s(t))&&("function"!=typeof(i=h.call(e,"constructor")&&e.constructor)||u.call(i)!==d))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){y(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,s=0;if(C(t))for(i=t.length;s<i&&!1!==e.call(t[s],s,t[s]);s++);else for(s in t)if(!1===e.call(t[s],s,t[s]))break;return t},makeArray:function(t,e){var i=e||[];return null!=t&&(C(Object(t))?x.merge(i,"string"==typeof t?[t]:t):o.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:a.call(e,t,i)},merge:function(t,e){for(var i=+e.length,s=0,n=t.length;s<i;s++)t[n++]=e[s];return t.length=n,t},grep:function(t,e,i){for(var s=[],n=0,r=t.length,o=!i;n<r;n++)!e(t[n],n)!==o&&s.push(t[n]);return s},map:function(t,e,i){var s,n,o=0,a=[];if(C(t))for(s=t.length;o<s;o++)null!=(n=e(t[o],o,i))&&a.push(n);else for(o in t)null!=(n=e(t[o],o,i))&&a.push(n);return r(a)},guid:1,support:p}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=i[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var _=function(t){var e,i,s,n,r,o,a,l,c,h,u,d,p,f,m,g,b,y,v,x="sizzle"+1*new Date,C=t.document,_=0,w=0,S=lt(),P=lt(),k=lt(),E=lt(),T=function(t,e){return t===e&&(u=!0),0},A={}.hasOwnProperty,O=[],M=O.pop,N=O.push,L=O.push,D=O.slice,j=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+I+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",F="\\["+I+"*("+B+")(?:"+I+"*([*^$|!~]?=)"+I+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+I+"*\\]",Y=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",z=new RegExp(I+"+","g"),q=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=new RegExp("^"+I+"*,"+I+"*"),U=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),G=new RegExp(I+"|>"),H=new RegExp(Y),J=new RegExp("^"+B+"$"),$={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+Y),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},V=/HTML$/i,W=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+I+"?|\\\\([^\\r\\n\\f])","g"),it=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},st=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){d()},ot=xt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{L.apply(O=D.call(C.childNodes),C.childNodes)}catch(Pt){L={apply:O.length?function(t,e){N.apply(t,D.call(e))}:function(t,e){for(var i=t.length,s=0;t[i++]=e[s++];);t.length=i-1}}}function at(t,e,s,n){var r,a,c,h,u,f,b,y=e&&e.ownerDocument,C=e?e.nodeType:9;if(s=s||[],"string"!=typeof t||!t||1!==C&&9!==C&&11!==C)return s;if(!n&&(d(e),e=e||p,m)){if(11!==C&&(u=Z.exec(t)))if(r=u[1]){if(9===C){if(!(c=e.getElementById(r)))return s;if(c.id===r)return s.push(c),s}else if(y&&(c=y.getElementById(r))&&v(e,c)&&c.id===r)return s.push(c),s}else{if(u[2])return L.apply(s,e.getElementsByTagName(t)),s;if((r=u[3])&&i.getElementsByClassName&&e.getElementsByClassName)return L.apply(s,e.getElementsByClassName(r)),s}if(i.qsa&&!E[t+" "]&&(!g||!g.test(t))&&(1!==C||"object"!==e.nodeName.toLowerCase())){if(b=t,y=e,1===C&&(G.test(t)||U.test(t))){for((y=tt.test(t)&&bt(e.parentNode)||e)===e&&i.scope||((h=e.getAttribute("id"))?h=h.replace(st,nt):e.setAttribute("id",h=x)),a=(f=o(t)).length;a--;)f[a]=(h?"#"+h:":scope")+" "+vt(f[a]);b=f.join(",")}try{return L.apply(s,y.querySelectorAll(b)),s}catch(_){E(t,!0)}finally{h===x&&e.removeAttribute("id")}}}return l(t.replace(q,"$1"),e,s,n)}function lt(){var t=[];return function e(i,n){return t.push(i+" ")>s.cacheLength&&delete e[t.shift()],e[i+" "]=n}}function ct(t){return t[x]=!0,t}function ht(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(Pt){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ut(t,e){for(var i=t.split("|"),n=i.length;n--;)s.attrHandle[i[n]]=e}function dt(t,e){var i=e&&t,s=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(s)return s;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ot(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return ct((function(e){return e=+e,ct((function(i,s){for(var n,r=t([],i.length,e),o=r.length;o--;)i[n=r[o]]&&(i[n]=!(s[n]=i[n]))}))}))}function bt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=at.support={},r=at.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!V.test(t&&t.namespaceURI||e&&e.nodeName||"HTML")},d=at.setDocument=function(t){var e,n,o=t?t.ownerDocument||t:C;return o!=p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,m=!r(p),C!=p&&(n=p.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",rt,!1):n.attachEvent&&n.attachEvent("onunload",rt)),i.scope=ht((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),i.attributes=ht((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=ht((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=Q.test(p.getElementsByClassName),i.getById=ht((function(t){return f.appendChild(t).id=x,!p.getElementsByName||!p.getElementsByName(x).length})),i.getById?(s.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}},s.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var i=e.getElementById(t);return i?[i]:[]}}):(s.filter.ID=function(t){var e=t.replace(et,it);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},s.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var i,s,n,r=e.getElementById(t);if(r){if((i=r.getAttributeNode("id"))&&i.value===t)return[r];for(n=e.getElementsByName(t),s=0;r=n[s++];)if((i=r.getAttributeNode("id"))&&i.value===t)return[r]}return[]}}),s.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,s=[],n=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[n++];)1===i.nodeType&&s.push(i);return s}return r},s.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},b=[],g=[],(i.qsa=Q.test(p.querySelectorAll))&&(ht((function(t){var e;f.appendChild(t).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+I+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+I+"*(?:value|"+R+")"),t.querySelectorAll("[id~="+x+"-]").length||g.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+I+"*name"+I+"*="+I+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),ht((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+I+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Q.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ht((function(t){i.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),b.push("!=",Y)})),g=g.length&&new RegExp(g.join("|")),b=b.length&&new RegExp(b.join("|")),e=Q.test(f.compareDocumentPosition),v=e||Q.test(f.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,s=e&&e.parentNode;return t===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):t.compareDocumentPosition&&16&t.compareDocumentPosition(s)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},T=e?function(t,e){if(t===e)return u=!0,0;var s=!t.compareDocumentPosition-!e.compareDocumentPosition;return s||(1&(s=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===s?t==p||t.ownerDocument==C&&v(C,t)?-1:e==p||e.ownerDocument==C&&v(C,e)?1:h?j(h,t)-j(h,e):0:4&s?-1:1)}:function(t,e){if(t===e)return u=!0,0;var i,s=0,n=t.parentNode,r=e.parentNode,o=[t],a=[e];if(!n||!r)return t==p?-1:e==p?1:n?-1:r?1:h?j(h,t)-j(h,e):0;if(n===r)return dt(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;o[s]===a[s];)s++;return s?dt(o[s],a[s]):o[s]==C?-1:a[s]==C?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),i.matchesSelector&&m&&!E[e+" "]&&(!b||!b.test(e))&&(!g||!g.test(e)))try{var s=y.call(t,e);if(s||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return s}catch(Pt){E(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),v(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var n=s.attrHandle[e.toLowerCase()],r=n&&A.call(s.attrHandle,e.toLowerCase())?n(t,e,!m):void 0;return void 0!==r?r:i.attributes||!m?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},at.escape=function(t){return(t+"").replace(st,nt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,s=[],n=0,r=0;if(u=!i.detectDuplicates,h=!i.sortStable&&t.slice(0),t.sort(T),u){for(;e=t[r++];)e===t[r]&&(n=s.push(r));for(;n--;)t.splice(s[n],1)}return h=null,t},n=at.getText=function(t){var e,i="",s=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=n(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[s++];)i+=n(e);return i},(s=at.selectors={cacheLength:50,createPseudo:ct,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return $.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&H.test(i)&&(e=o(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+I+")"+t+"("+I+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(s){var n=at.attr(s,t);return null==n?"!="===e:!e||(n+="","="===e?n===i:"!="===e?n!==i:"^="===e?i&&0===n.indexOf(i):"*="===e?i&&n.indexOf(i)>-1:"$="===e?i&&n.slice(-i.length)===i:"~="===e?(" "+n.replace(z," ")+" ").indexOf(i)>-1:"|="===e&&(n===i||n.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,s,n){var r="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===s&&0===n?function(t){return!!t.parentNode}:function(e,i,l){var c,h,u,d,p,f,m=r!==o?"nextSibling":"previousSibling",g=e.parentNode,b=a&&e.nodeName.toLowerCase(),y=!l&&!a,v=!1;if(g){if(r){for(;m;){for(d=e;d=d[m];)if(a?d.nodeName.toLowerCase()===b:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&y){for(v=(p=(c=(h=(u=(d=g)[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]||[])[0]===_&&c[1])&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(v=p=0)||f.pop();)if(1===d.nodeType&&++v&&d===e){h[t]=[_,p,v];break}}else if(y&&(v=p=(c=(h=(u=(d=e)[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]||[])[0]===_&&c[1]),!1===v)for(;(d=++p&&d&&d[m]||(v=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==b:1!==d.nodeType)||!++v||(y&&((h=(u=d[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]=[_,v]),d!==e)););return(v-=n)===s||v%s==0&&v/s>=0}}},PSEUDO:function(t,e){var i,n=s.pseudos[t]||s.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return n[x]?n(e):n.length>1?(i=[t,t,"",e],s.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,i){for(var s,r=n(t,e),o=r.length;o--;)t[s=j(t,r[o])]=!(i[s]=r[o])})):function(t){return n(t,0,i)}):n}},pseudos:{not:ct((function(t){var e=[],i=[],s=a(t.replace(q,"$1"));return s[x]?ct((function(t,e,i,n){for(var r,o=s(t,null,n,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))})):function(t,n,r){return e[0]=t,s(e,null,r,i),e[0]=null,!i.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,it),function(e){return(e.textContent||n(e)).indexOf(t)>-1}})),lang:ct((function(t){return J.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,it).toLowerCase(),function(e){var i;do{if(i=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!s.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return W.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,i){return[i<0?i+e:i]})),even:gt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:gt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:gt((function(t,e,i){for(var s=i<0?i+e:i>e?e:i;--s>=0;)t.push(s);return t})),gt:gt((function(t,e,i){for(var s=i<0?i+e:i;++s<e;)t.push(s);return t}))}}).pseudos.nth=s.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})s.pseudos[e]=ft(e);function yt(){}function vt(t){for(var e=0,i=t.length,s="";e<i;e++)s+=t[e].value;return s}function xt(t,e,i){var s=e.dir,n=e.next,r=n||s,o=i&&"parentNode"===r,a=w++;return e.first?function(e,i,n){for(;e=e[s];)if(1===e.nodeType||o)return t(e,i,n);return!1}:function(e,i,l){var c,h,u,d=[_,a];if(l){for(;e=e[s];)if((1===e.nodeType||o)&&t(e,i,l))return!0}else for(;e=e[s];)if(1===e.nodeType||o)if(h=(u=e[x]||(e[x]={}))[e.uniqueID]||(u[e.uniqueID]={}),n&&n===e.nodeName.toLowerCase())e=e[s]||e;else{if((c=h[r])&&c[0]===_&&c[1]===a)return d[2]=c[2];if(h[r]=d,d[2]=t(e,i,l))return!0}return!1}}function Ct(t){return t.length>1?function(e,i,s){for(var n=t.length;n--;)if(!t[n](e,i,s))return!1;return!0}:t[0]}function _t(t,e,i,s,n){for(var r,o=[],a=0,l=t.length,c=null!=e;a<l;a++)(r=t[a])&&(i&&!i(r,s,n)||(o.push(r),c&&e.push(a)));return o}function wt(t,e,i,s,n,r){return s&&!s[x]&&(s=wt(s)),n&&!n[x]&&(n=wt(n,r)),ct((function(r,o,a,l){var c,h,u,d=[],p=[],f=o.length,m=r||function(t,e,i){for(var s=0,n=e.length;s<n;s++)at(t,e[s],i);return i}(e||"*",a.nodeType?[a]:a,[]),g=!t||!r&&e?m:_t(m,d,t,a,l),b=i?n||(r?t:f||s)?[]:o:g;if(i&&i(g,b,a,l),s)for(c=_t(b,p),s(c,[],a,l),h=c.length;h--;)(u=c[h])&&(b[p[h]]=!(g[p[h]]=u));if(r){if(n||t){if(n){for(c=[],h=b.length;h--;)(u=b[h])&&c.push(g[h]=u);n(null,b=[],c,l)}for(h=b.length;h--;)(u=b[h])&&(c=n?j(r,u):d[h])>-1&&(r[c]=!(o[c]=u))}}else b=_t(b===o?b.splice(f,b.length):b),n?n(null,o,b,l):L.apply(o,b)}))}function St(t){for(var e,i,n,r=t.length,o=s.relative[t[0].type],a=o||s.relative[" "],l=o?1:0,h=xt((function(t){return t===e}),a,!0),u=xt((function(t){return j(e,t)>-1}),a,!0),d=[function(t,i,s){var n=!o&&(s||i!==c)||((e=i).nodeType?h(t,i,s):u(t,i,s));return e=null,n}];l<r;l++)if(i=s.relative[t[l].type])d=[xt(Ct(d),i)];else{if((i=s.filter[t[l].type].apply(null,t[l].matches))[x]){for(n=++l;n<r&&!s.relative[t[n].type];n++);return wt(l>1&&Ct(d),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(q,"$1"),i,l<n&&St(t.slice(l,n)),n<r&&St(t=t.slice(n)),n<r&&vt(t))}d.push(i)}return Ct(d)}return yt.prototype=s.filters=s.pseudos,s.setFilters=new yt,o=at.tokenize=function(t,e){var i,n,r,o,a,l,c,h=P[t+" "];if(h)return e?0:h.slice(0);for(a=t,l=[],c=s.preFilter;a;){for(o in i&&!(n=X.exec(a))||(n&&(a=a.slice(n[0].length)||a),l.push(r=[])),i=!1,(n=U.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(q," ")}),a=a.slice(i.length)),s.filter)!(n=$[o].exec(a))||c[o]&&!(n=c[o](n))||(i=n.shift(),r.push({value:i,type:o,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?at.error(t):P(t,l).slice(0)},a=at.compile=function(t,e){var i,n=[],r=[],a=k[t+" "];if(!a){for(e||(e=o(t)),i=e.length;i--;)(a=St(e[i]))[x]?n.push(a):r.push(a);(a=k(t,function(t,e){var i=e.length>0,n=t.length>0,r=function(r,o,a,l,h){var u,f,g,b=0,y="0",v=r&&[],x=[],C=c,w=r||n&&s.find.TAG("*",h),S=_+=null==C?1:Math.random()||.1,P=w.length;for(h&&(c=o==p||o||h);y!==P&&null!=(u=w[y]);y++){if(n&&u){for(f=0,o||u.ownerDocument==p||(d(u),a=!m);g=t[f++];)if(g(u,o||p,a)){l.push(u);break}h&&(_=S)}i&&((u=!g&&u)&&b--,r&&v.push(u))}if(b+=y,i&&y!==b){for(f=0;g=e[f++];)g(v,x,o,a);if(r){if(b>0)for(;y--;)v[y]||x[y]||(x[y]=M.call(l));x=_t(x)}L.apply(l,x),h&&!r&&x.length>0&&b+e.length>1&&at.uniqueSort(l)}return h&&(_=S,c=C),v};return i?ct(r):r}(r,n))).selector=t}return a},l=at.select=function(t,e,i,n){var r,l,c,h,u,d="function"==typeof t&&t,p=!n&&o(t=d.selector||t);if(i=i||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&m&&s.relative[l[1].type]){if(!(e=(s.find.ID(c.matches[0].replace(et,it),e)||[])[0]))return i;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(r=$.needsContext.test(t)?0:l.length;r--&&!s.relative[h=(c=l[r]).type];)if((u=s.find[h])&&(n=u(c.matches[0].replace(et,it),tt.test(l[0].type)&&bt(e.parentNode)||e))){if(l.splice(r,1),!(t=n.length&&vt(l)))return L.apply(i,n),i;break}}return(d||a(t,p))(n,e,!m,i,!e||tt.test(t)&&bt(e.parentNode)||e),i},i.sortStable=x.split("").sort(T).join("")===x,i.detectDuplicates=!!u,d(),i.sortDetached=ht((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ht((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ut("type|href|height|width",(function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&ht((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ut("value",(function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ht((function(t){return null==t.getAttribute("disabled")}))||ut(R,(function(t,e,i){var s;if(!i)return!0===t[e]?e.toLowerCase():(s=t.getAttributeNode(e))&&s.specified?s.value:null})),at}(t);x.find=_,x.expr=_.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=_.uniqueSort,x.text=_.getText,x.isXMLDoc=_.isXML,x.contains=_.contains,x.escapeSelector=_.escape;var w=function(t,e,i){for(var s=[],n=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(n&&x(t).is(i))break;s.push(t)}return s},S=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},P=x.expr.match.needsContext;function k(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var E=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(t,e,i){return f(e)?x.grep(t,(function(t,s){return!!e.call(t,s,t)!==i})):e.nodeType?x.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?x.grep(t,(function(t){return a.call(e,t)>-1!==i})):x.filter(e,t,i)}x.filter=function(t,e,i){var s=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===s.nodeType?x.find.matchesSelector(s,t)?[s]:[]:x.find.matches(t,x.grep(e,(function(t){return 1===t.nodeType})))},x.fn.extend({find:function(t){var e,i,s=this.length,n=this;if("string"!=typeof t)return this.pushStack(x(t).filter((function(){for(e=0;e<s;e++)if(x.contains(n[e],this))return!0})));for(i=this.pushStack([]),e=0;e<s;e++)x.find(t,n[e],i);return s>1?x.uniqueSort(i):i},filter:function(t){return this.pushStack(T(this,t||[],!1))},not:function(t){return this.pushStack(T(this,t||[],!0))},is:function(t){return!!T(this,"string"==typeof t&&P.test(t)?x(t):t||[],!1).length}});var A,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(t,e,i){var s,n;if(!t)return this;if(i=i||A,"string"==typeof t){if(!(s="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:O.exec(t))||!s[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(s[1]){if(x.merge(this,x.parseHTML(s[1],(e=e instanceof x?e[0]:e)&&e.nodeType?e.ownerDocument||e:g,!0)),E.test(s[1])&&x.isPlainObject(e))for(s in e)f(this[s])?this[s](e[s]):this.attr(s,e[s]);return this}return(n=g.getElementById(s[2]))&&(this[0]=n,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):f(t)?void 0!==i.ready?i.ready(t):t(x):x.makeArray(t,this)}).prototype=x.fn,A=x(g);var M=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function L(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}x.fn.extend({has:function(t){var e=x(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(x.contains(this,e[t]))return!0}))},closest:function(t,e){var i,s=0,n=this.length,r=[],o="string"!=typeof t&&x(t);if(!P.test(t))for(;s<n;s++)for(i=this[s];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&x.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?x.uniqueSort(r):r)},index:function(t){return t?"string"==typeof t?a.call(x(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),x.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return w(t,"parentNode")},parentsUntil:function(t,e,i){return w(t,"parentNode",i)},next:function(t){return L(t,"nextSibling")},prev:function(t){return L(t,"previousSibling")},nextAll:function(t){return w(t,"nextSibling")},prevAll:function(t){return w(t,"previousSibling")},nextUntil:function(t,e,i){return w(t,"nextSibling",i)},prevUntil:function(t,e,i){return w(t,"previousSibling",i)},siblings:function(t){return S((t.parentNode||{}).firstChild,t)},children:function(t){return S(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(k(t,"template")&&(t=t.content||t),x.merge([],t.childNodes))}},(function(t,e){x.fn[t]=function(i,s){var n=x.map(this,e,i);return"Until"!==t.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=x.filter(s,n)),this.length>1&&(N[t]||x.uniqueSort(n),M.test(t)&&n.reverse()),this.pushStack(n)}}));var D=/[^\x20\t\r\n\f]+/g;function j(t){return t}function R(t){throw t}function I(t,e,i,s){var n;try{t&&f(n=t.promise)?n.call(t).done(e).fail(i):t&&f(n=t.then)?n.call(t,e,i):e.apply(void 0,[t].slice(s))}catch(t){i.apply(void 0,[t])}}x.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return x.each(t.match(D)||[],(function(t,i){e[i]=!0})),e}(t):x.extend({},t);var e,i,s,n,r=[],o=[],a=-1,l=function(){for(n=n||t.once,s=e=!0;o.length;a=-1)for(i=o.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=r.length,i=!1);t.memory||(i=!1),e=!1,n&&(r=i?[]:"")},c={add:function(){return r&&(i&&!e&&(a=r.length-1,o.push(i)),function e(i){x.each(i,(function(i,s){f(s)?t.unique&&c.has(s)||r.push(s):s&&s.length&&"string"!==v(s)&&e(s)}))}(arguments),i&&!e&&l()),this},remove:function(){return x.each(arguments,(function(t,e){for(var i;(i=x.inArray(e,r,i))>-1;)r.splice(i,1),i<=a&&a--})),this},has:function(t){return t?x.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return n=o=[],r=i="",this},disabled:function(){return!r},lock:function(){return n=o=[],i||e||(r=i=""),this},locked:function(){return!!n},fireWith:function(t,i){return n||(i=[t,(i=i||[]).slice?i.slice():i],o.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!s}};return c},x.extend({Deferred:function(e){var i=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],s="pending",n={state:function(){return s},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return n.then(null,t)},pipe:function(){var t=arguments;return x.Deferred((function(e){x.each(i,(function(i,s){var n=f(t[s[4]])&&t[s[4]];r[s[1]]((function(){var t=n&&n.apply(this,arguments);t&&f(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[s[0]+"With"](this,n?[t]:arguments)}))})),t=null})).promise()},then:function(e,s,n){var r=0;function o(e,i,s,n){return function(){var a=this,l=arguments,c=function(){var t,c;if(!(e<r)){if((t=s.apply(a,l))===i.promise())throw new TypeError("Thenable self-resolution");f(c=t&&("object"==typeof t||"function"==typeof t)&&t.then)?n?c.call(t,o(r,i,j,n),o(r,i,R,n)):(r++,c.call(t,o(r,i,j,n),o(r,i,R,n),o(r,i,j,i.notifyWith))):(s!==j&&(a=void 0,l=[t]),(n||i.resolveWith)(a,l))}},h=n?c:function(){try{c()}catch(t){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(t,h.stackTrace),e+1>=r&&(s!==R&&(a=void 0,l=[t]),i.rejectWith(a,l))}};e?h():(x.Deferred.getStackHook&&(h.stackTrace=x.Deferred.getStackHook()),t.setTimeout(h))}}return x.Deferred((function(t){i[0][3].add(o(0,t,f(n)?n:j,t.notifyWith)),i[1][3].add(o(0,t,f(e)?e:j)),i[2][3].add(o(0,t,f(s)?s:R))})).promise()},promise:function(t){return null!=t?x.extend(t,n):n}},r={};return x.each(i,(function(t,e){var o=e[2],a=e[5];n[e[1]]=o.add,a&&o.add((function(){s=a}),i[3-t][2].disable,i[3-t][3].disable,i[0][2].lock,i[0][3].lock),o.add(e[3].fire),r[e[0]]=function(){return r[e[0]+"With"](this===r?void 0:this,arguments),this},r[e[0]+"With"]=o.fireWith})),n.promise(r),e&&e.call(r,r),r},when:function(t){var e=arguments.length,i=e,s=Array(i),r=n.call(arguments),o=x.Deferred(),a=function(t){return function(i){s[t]=this,r[t]=arguments.length>1?n.call(arguments):i,--e||o.resolveWith(s,r)}};if(e<=1&&(I(t,o.done(a(i)).resolve,o.reject,!e),"pending"===o.state()||f(r[i]&&r[i].then)))return o.then();for(;i--;)I(r[i],a(i),o.reject);return o.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&B.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},x.readyException=function(e){t.setTimeout((function(){throw e}))};var F=x.Deferred();function Y(){g.removeEventListener("DOMContentLoaded",Y),t.removeEventListener("load",Y),x.ready()}x.fn.ready=function(t){return F.then(t).catch((function(t){x.readyException(t)})),this},x.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==t&&--x.readyWait>0||F.resolveWith(g,[x]))}}),x.ready.then=F.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?t.setTimeout(x.ready):(g.addEventListener("DOMContentLoaded",Y),t.addEventListener("load",Y));var z=function(t,e,i,s,n,r,o){var a=0,l=t.length,c=null==i;if("object"===v(i))for(a in n=!0,i)z(t,e,a,i[a],!0,r,o);else if(void 0!==s&&(n=!0,f(s)||(o=!0),c&&(o?(e.call(t,s),e=null):(c=e,e=function(t,e,i){return c.call(x(t),i)})),e))for(;a<l;a++)e(t[a],i,o?s:s.call(t[a],a,e(t[a],i)));return n?t:c?e.call(t):l?e(t[0],i):r},q=/^-ms-/,X=/-([a-z])/g;function U(t,e){return e.toUpperCase()}function G(t){return t.replace(q,"ms-").replace(X,U)}var H=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function J(){this.expando=x.expando+J.uid++}J.uid=1,J.prototype={cache:function(t){var e=t[this.expando];return e||(e={},H(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var s,n=this.cache(t);if("string"==typeof e)n[G(e)]=i;else for(s in e)n[G(s)]=e[s];return n},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][G(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,s=t[this.expando];if(void 0!==s){if(void 0!==e){i=(e=Array.isArray(e)?e.map(G):(e=G(e))in s?[e]:e.match(D)||[]).length;for(;i--;)delete s[e[i]]}(void 0===e||x.isEmptyObject(s))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!x.isEmptyObject(e)}};var $=new J,V=new J,W=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Q(t,e,i){var s;if(void 0===i&&1===t.nodeType)if(s="data-"+e.replace(K,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(s))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:W.test(t)?JSON.parse(t):t)}(i)}catch(n){}V.set(t,e,i)}else i=void 0;return i}x.extend({hasData:function(t){return V.hasData(t)||$.hasData(t)},data:function(t,e,i){return V.access(t,e,i)},removeData:function(t,e){V.remove(t,e)},_data:function(t,e,i){return $.access(t,e,i)},_removeData:function(t,e){$.remove(t,e)}}),x.fn.extend({data:function(t,e){var i,s,n,r=this[0],o=r&&r.attributes;if(void 0===t){if(this.length&&(n=V.get(r),1===r.nodeType&&!$.get(r,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(s=o[i].name).indexOf("data-")&&(s=G(s.slice(5)),Q(r,s,n[s]));$.set(r,"hasDataAttrs",!0)}return n}return"object"==typeof t?this.each((function(){V.set(this,t)})):z(this,(function(e){var i;if(r&&void 0===e)return void 0!==(i=V.get(r,t))||void 0!==(i=Q(r,t))?i:void 0;this.each((function(){V.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){V.remove(this,t)}))}}),x.extend({queue:function(t,e,i){var s;if(t)return s=$.get(t,e=(e||"fx")+"queue"),i&&(!s||Array.isArray(i)?s=$.access(t,e,x.makeArray(i)):s.push(i)),s||[]},dequeue:function(t,e){var i=x.queue(t,e=e||"fx"),s=i.length,n=i.shift(),r=x._queueHooks(t,e);"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===e&&i.unshift("inprogress"),delete r.stop,n.call(t,(function(){x.dequeue(t,e)}),r)),!s&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return $.get(t,i)||$.access(t,i,{empty:x.Callbacks("once memory").add((function(){$.remove(t,[e+"queue",i])}))})}}),x.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?x.queue(this[0],t):void 0===e?this:this.each((function(){var i=x.queue(this,t,e);x._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&x.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){x.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,s=1,n=x.Deferred(),r=this,o=this.length,a=function(){--s||n.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=$.get(r[o],t+"queueHooks"))&&i.empty&&(s++,i.empty.add(a));return a(),n.promise(e)}});var Z=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,tt=new RegExp("^(?:([+-])=|)("+Z+")([a-z%]*)$","i"),et=["Top","Right","Bottom","Left"],it=g.documentElement,st=function(t){return x.contains(t.ownerDocument,t)},nt={composed:!0};it.getRootNode&&(st=function(t){return x.contains(t.ownerDocument,t)||t.getRootNode(nt)===t.ownerDocument});var rt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&st(t)&&"none"===x.css(t,"display")};function ot(t,e,i,s){var n,r,o=20,a=s?function(){return s.cur()}:function(){return x.css(t,e,"")},l=a(),c=i&&i[3]||(x.cssNumber[e]?"":"px"),h=t.nodeType&&(x.cssNumber[e]||"px"!==c&&+l)&&tt.exec(x.css(t,e));if(h&&h[3]!==c){for(c=c||h[3],h=+(l/=2)||1;o--;)x.style(t,e,h+c),(1-r)*(1-(r=a()/l||.5))<=0&&(o=0),h/=r;x.style(t,e,(h*=2)+c),i=i||[]}return i&&(h=+h||+l||0,n=i[1]?h+(i[1]+1)*i[2]:+i[2],s&&(s.unit=c,s.start=h,s.end=n)),n}var at={};function lt(t){var e,i=t.ownerDocument,s=t.nodeName,n=at[s];return n||(e=i.body.appendChild(i.createElement(s)),n=x.css(e,"display"),e.parentNode.removeChild(e),"none"===n&&(n="block"),at[s]=n,n)}function ct(t,e){for(var i,s,n=[],r=0,o=t.length;r<o;r++)(s=t[r]).style&&(i=s.style.display,e?("none"===i&&(n[r]=$.get(s,"display")||null,n[r]||(s.style.display="")),""===s.style.display&&rt(s)&&(n[r]=lt(s))):"none"!==i&&(n[r]="none",$.set(s,"display",i)));for(r=0;r<o;r++)null!=n[r]&&(t[r].style.display=n[r]);return t}x.fn.extend({show:function(){return ct(this,!0)},hide:function(){return ct(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){rt(this)?x(this).show():x(this).hide()}))}});var ht,ut,dt=/^(?:checkbox|radio)$/i,pt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ft=/^$|^module$|\/(?:java|ecma)script/i;ht=g.createDocumentFragment().appendChild(g.createElement("div")),(ut=g.createElement("input")).setAttribute("type","radio"),ut.setAttribute("checked","checked"),ut.setAttribute("name","t"),ht.appendChild(ut),p.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",p.option=!!ht.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&k(t,e)?x.merge([t],i):i}function bt(t,e){for(var i=0,s=t.length;i<s;i++)$.set(t[i],"globalEval",!e||$.get(e[i],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,p.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var yt=/<|&#?\w+;/;function vt(t,e,i,s,n){for(var r,o,a,l,c,h,u=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((r=t[p])||0===r)if("object"===v(r))x.merge(d,r.nodeType?[r]:r);else if(yt.test(r)){for(o=o||u.appendChild(e.createElement("div")),a=(pt.exec(r)||["",""])[1].toLowerCase(),o.innerHTML=(l=mt[a]||mt._default)[1]+x.htmlPrefilter(r)+l[2],h=l[0];h--;)o=o.lastChild;x.merge(d,o.childNodes),(o=u.firstChild).textContent=""}else d.push(e.createTextNode(r));for(u.textContent="",p=0;r=d[p++];)if(s&&x.inArray(r,s)>-1)n&&n.push(r);else if(c=st(r),o=gt(u.appendChild(r),"script"),c&&bt(o),i)for(h=0;r=o[h++];)ft.test(r.type||"")&&i.push(r);return u}var xt=/^([^.]*)(?:\.(.+)|)/;function Ct(){return!0}function _t(){return!1}function wt(t,e){return t===function(){try{return g.activeElement}catch(t){}}()==("focus"===e)}function St(t,e,i,s,n,r){var o,a;if("object"==typeof e){for(a in"string"!=typeof i&&(s=s||i,i=void 0),e)St(t,a,i,s,e[a],r);return t}if(null==s&&null==n?(n=i,s=i=void 0):null==n&&("string"==typeof i?(n=s,s=void 0):(n=s,s=i,i=void 0)),!1===n)n=_t;else if(!n)return t;return 1===r&&(o=n,(n=function(t){return x().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=x.guid++)),t.each((function(){x.event.add(this,e,n,s,i)}))}function Pt(t,e,i){i?($.set(t,e,!1),x.event.add(t,e,{namespace:!1,handler:function(t){var s,r,o=$.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(x.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=n.call(arguments),$.set(this,e,o),s=i(this,e),this[e](),o!==(r=$.get(this,e))||s?$.set(this,e,!1):r={},o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r&&r.value}else o.length&&($.set(this,e,{value:x.event.trigger(x.extend(o[0],x.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===$.get(t,e)&&x.event.add(t,e,Ct)}x.event={global:{},add:function(t,e,i,s,n){var r,o,a,l,c,h,u,d,p,f,m,g=$.get(t);if(H(t))for(i.handler&&(i=(r=i).handler,n=r.selector),n&&x.find.matchesSelector(it,n),i.guid||(i.guid=x.guid++),(l=g.events)||(l=g.events=Object.create(null)),(o=g.handle)||(o=g.handle=function(e){return void 0!==x&&x.event.triggered!==e.type?x.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(D)||[""]).length;c--;)p=m=(a=xt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(u=x.event.special[p]||{},u=x.event.special[p=(n?u.delegateType:u.bindType)||p]||{},h=x.extend({type:p,origType:m,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&x.expr.match.needsContext.test(n),namespace:f.join(".")},r),(d=l[p])||((d=l[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,s,f,o)||t.addEventListener&&t.addEventListener(p,o)),u.add&&(u.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),n?d.splice(d.delegateCount++,0,h):d.push(h),x.event.global[p]=!0)},remove:function(t,e,i,s,n){var r,o,a,l,c,h,u,d,p,f,m,g=$.hasData(t)&&$.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(D)||[""]).length;c--;)if(p=m=(a=xt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(u=x.event.special[p]||{},d=l[p=(s?u.delegateType:u.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=d.length;r--;)h=d[r],!n&&m!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||s&&s!==h.selector&&("**"!==s||!h.selector)||(d.splice(r,1),h.selector&&d.delegateCount--,u.remove&&u.remove.call(t,h));o&&!d.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||x.removeEvent(t,p,g.handle),delete l[p])}else for(p in l)x.event.remove(t,p+e[c],i,s,!0);x.isEmptyObject(l)&&$.remove(t,"handle events")}},dispatch:function(t){var e,i,s,n,r,o,a=new Array(arguments.length),l=x.event.fix(t),c=($.get(this,"events")||Object.create(null))[l.type]||[],h=x.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,l)){for(o=x.event.handlers.call(this,l,c),e=0;(n=o[e++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,i=0;(r=n.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(s=((x.event.special[r.origType]||{}).handle||r.handler).apply(n.elem,a))&&!1===(l.result=s)&&(l.preventDefault(),l.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,s,n,r,o,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(r=[],o={},i=0;i<l;i++)void 0===o[n=(s=e[i]).selector+" "]&&(o[n]=s.needsContext?x(n,this).index(c)>-1:x.find(n,this,null,[c]).length),o[n]&&r.push(s);r.length&&a.push({elem:c,handlers:r})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(x.Event.prototype,t,{enumerable:!0,configurable:!0,get:f(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[x.expando]?t:new x.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return dt.test(e.type)&&e.click&&k(e,"input")&&Pt(e,"click",Ct),!1},trigger:function(t){var e=this||t;return dt.test(e.type)&&e.click&&k(e,"input")&&Pt(e,"click"),!0},_default:function(t){var e=t.target;return dt.test(e.type)&&e.click&&k(e,"input")&&$.get(e,"click")||k(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},x.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},x.Event=function(t,e){if(!(this instanceof x.Event))return new x.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Ct:_t,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&x.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:_t,isPropagationStopped:_t,isImmediatePropagationStopped:_t,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Ct,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Ct,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Ct,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(t,e){x.event.special[t]={setup:function(){return Pt(this,t,wt),!1},trigger:function(){return Pt(this,t),!0},_default:function(){return!0},delegateType:e}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){x.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,s=this,n=t.relatedTarget,r=t.handleObj;return n&&(n===s||x.contains(s,n))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}})),x.fn.extend({on:function(t,e,i,s){return St(this,t,e,i,s)},one:function(t,e,i,s){return St(this,t,e,i,s,1)},off:function(t,e,i){var s,n;if(t&&t.preventDefault&&t.handleObj)return s=t.handleObj,x(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof t){for(n in t)this.off(n,e,t[n]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=_t),this.each((function(){x.event.remove(this,t,i,e)}))}});var kt=/<script|<style|<link/i,Et=/checked\s*(?:[^=]|=\s*.checked.)/i,Tt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function At(t,e){return k(t,"table")&&k(11!==e.nodeType?e:e.firstChild,"tr")&&x(t).children("tbody")[0]||t}function Ot(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Mt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Nt(t,e){var i,s,n,r,o,a;if(1===e.nodeType){if($.hasData(t)&&(a=$.get(t).events))for(n in $.remove(e,"handle events"),a)for(i=0,s=a[n].length;i<s;i++)x.event.add(e,n,a[n][i]);V.hasData(t)&&(r=V.access(t),o=x.extend({},r),V.set(e,o))}}function Lt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&dt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Dt(t,e,i,s){e=r(e);var n,o,a,l,c,h,u=0,d=t.length,m=d-1,g=e[0],b=f(g);if(b||d>1&&"string"==typeof g&&!p.checkClone&&Et.test(g))return t.each((function(n){var r=t.eq(n);b&&(e[0]=g.call(this,n,r.html())),Dt(r,e,i,s)}));if(d&&(o=(n=vt(e,t[0].ownerDocument,!1,t,s)).firstChild,1===n.childNodes.length&&(n=o),o||s)){for(l=(a=x.map(gt(n,"script"),Ot)).length;u<d;u++)c=n,u!==m&&(c=x.clone(c,!0,!0),l&&x.merge(a,gt(c,"script"))),i.call(t[u],c,u);if(l)for(h=a[a.length-1].ownerDocument,x.map(a,Mt),u=0;u<l;u++)ft.test((c=a[u]).type||"")&&!$.access(c,"globalEval")&&x.contains(h,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?x._evalUrl&&!c.noModule&&x._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},h):y(c.textContent.replace(Tt,""),c,h))}return t}function jt(t,e,i){for(var s,n=e?x.filter(e,t):t,r=0;null!=(s=n[r]);r++)i||1!==s.nodeType||x.cleanData(gt(s)),s.parentNode&&(i&&st(s)&&bt(gt(s,"script")),s.parentNode.removeChild(s));return t}x.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var s,n,r,o,a=t.cloneNode(!0),l=st(t);if(!(p.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||x.isXMLDoc(t)))for(o=gt(a),s=0,n=(r=gt(t)).length;s<n;s++)Lt(r[s],o[s]);if(e)if(i)for(r=r||gt(t),o=o||gt(a),s=0,n=r.length;s<n;s++)Nt(r[s],o[s]);else Nt(t,a);return(o=gt(a,"script")).length>0&&bt(o,!l&&gt(t,"script")),a},cleanData:function(t){for(var e,i,s,n=x.event.special,r=0;void 0!==(i=t[r]);r++)if(H(i)){if(e=i[$.expando]){if(e.events)for(s in e.events)n[s]?x.event.remove(i,s):x.removeEvent(i,s,e.handle);i[$.expando]=void 0}i[V.expando]&&(i[V.expando]=void 0)}}}),x.fn.extend({detach:function(t){return jt(this,t,!0)},remove:function(t){return jt(this,t)},text:function(t){return z(this,(function(t){return void 0===t?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Dt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||At(this,t).appendChild(t)}))},prepend:function(){return Dt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=At(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(x.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return x.clone(this,t,e)}))},html:function(t){return z(this,(function(t){var e=this[0]||{},i=0,s=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!kt.test(t)&&!mt[(pt.exec(t)||["",""])[1].toLowerCase()]){t=x.htmlPrefilter(t);try{for(;i<s;i++)1===(e=this[i]||{}).nodeType&&(x.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(n){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Dt(this,arguments,(function(e){var i=this.parentNode;x.inArray(this,t)<0&&(x.cleanData(gt(this)),i&&i.replaceChild(e,this))}),t)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){x.fn[t]=function(t){for(var i,s=[],n=x(t),r=n.length-1,a=0;a<=r;a++)i=a===r?this:this.clone(!0),x(n[a])[e](i),o.apply(s,i.get());return this.pushStack(s)}}));var Rt=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),It=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},Bt=function(t,e,i){var s,n,r={};for(n in e)r[n]=t.style[n],t.style[n]=e[n];for(n in s=i.call(t),e)t.style[n]=r[n];return s},Ft=new RegExp(et.join("|"),"i");function Yt(t,e,i){var s,n,r,o,a=t.style;return(i=i||It(t))&&(""!==(o=i.getPropertyValue(e)||i[e])||st(t)||(o=x.style(t,e)),!p.pixelBoxStyles()&&Rt.test(o)&&Ft.test(e)&&(s=a.width,n=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=s,a.minWidth=n,a.maxWidth=r)),void 0!==o?o+"":o}function zt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",it.appendChild(c).appendChild(h);var e=t.getComputedStyle(h);s="1%"!==e.top,l=12===i(e.marginLeft),h.style.right="60%",o=36===i(e.right),n=36===i(e.width),h.style.position="absolute",r=12===i(h.offsetWidth/3),it.removeChild(c),h=null}}function i(t){return Math.round(parseFloat(t))}var s,n,r,o,a,l,c=g.createElement("div"),h=g.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===h.style.backgroundClip,x.extend(p,{boxSizingReliable:function(){return e(),n},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),s},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),r},reliableTrDimensions:function(){var e,i,s,n;return null==a&&(e=g.createElement("table"),i=g.createElement("tr"),s=g.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",i.style.cssText="border:1px solid",i.style.height="1px",s.style.height="9px",s.style.display="block",it.appendChild(e).appendChild(i).appendChild(s),n=t.getComputedStyle(i),a=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===i.offsetHeight,it.removeChild(e)),a}}))}();var qt=["Webkit","Moz","ms"],Xt=g.createElement("div").style,Ut={};function Gt(t){return x.cssProps[t]||Ut[t]||(t in Xt?t:Ut[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=qt.length;i--;)if((t=qt[i]+e)in Xt)return t}(t)||t)}var Ht=/^(none|table(?!-c[ea]).+)/,Jt=/^--/,$t={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:"0",fontWeight:"400"};function Wt(t,e,i){var s=tt.exec(e);return s?Math.max(0,s[2]-(i||0))+(s[3]||"px"):e}function Kt(t,e,i,s,n,r){var o="width"===e?1:0,a=0,l=0;if(i===(s?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(l+=x.css(t,i+et[o],!0,n)),s?("content"===i&&(l-=x.css(t,"padding"+et[o],!0,n)),"margin"!==i&&(l-=x.css(t,"border"+et[o]+"Width",!0,n))):(l+=x.css(t,"padding"+et[o],!0,n),"padding"!==i?l+=x.css(t,"border"+et[o]+"Width",!0,n):a+=x.css(t,"border"+et[o]+"Width",!0,n));return!s&&r>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-r-l-a-.5))||0),l}function Qt(t,e,i){var s=It(t),n=(!p.boxSizingReliable()||i)&&"border-box"===x.css(t,"boxSizing",!1,s),r=n,o=Yt(t,e,s),a="offset"+e[0].toUpperCase()+e.slice(1);if(Rt.test(o)){if(!i)return o;o="auto"}return(!p.boxSizingReliable()&&n||!p.reliableTrDimensions()&&k(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===x.css(t,"display",!1,s))&&t.getClientRects().length&&(n="border-box"===x.css(t,"boxSizing",!1,s),(r=a in t)&&(o=t[a])),(o=parseFloat(o)||0)+Kt(t,e,i||(n?"border":"content"),r,s,o)+"px"}function Zt(t,e,i,s,n){return new Zt.prototype.init(t,e,i,s,n)}x.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Yt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n,r,o,a=G(e),l=Jt.test(e),c=t.style;if(l||(e=Gt(a)),o=x.cssHooks[e]||x.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(n=o.get(t,!1,s))?n:c[e];"string"==(r=typeof i)&&(n=tt.exec(i))&&n[1]&&(i=ot(t,e,n),r="number"),null!=i&&i==i&&("number"!==r||l||(i+=n&&n[3]||(x.cssNumber[a]?"":"px")),p.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,s))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,s){var n,r,o,a=G(e);return Jt.test(e)||(e=Gt(a)),(o=x.cssHooks[e]||x.cssHooks[a])&&"get"in o&&(n=o.get(t,!0,i)),void 0===n&&(n=Yt(t,e,s)),"normal"===n&&e in Vt&&(n=Vt[e]),""===i||i?(r=parseFloat(n),!0===i||isFinite(r)?r||0:n):n}}),x.each(["height","width"],(function(t,e){x.cssHooks[e]={get:function(t,i,s){if(i)return!Ht.test(x.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Qt(t,e,s):Bt(t,$t,(function(){return Qt(t,e,s)}))},set:function(t,i,s){var n,r=It(t),o=!p.scrollboxSize()&&"absolute"===r.position,a=(o||s)&&"border-box"===x.css(t,"boxSizing",!1,r),l=s?Kt(t,e,s,a,r):0;return a&&o&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(r[e])-Kt(t,e,"border",!1,r)-.5)),l&&(n=tt.exec(i))&&"px"!==(n[3]||"px")&&(t.style[e]=i,i=x.css(t,e)),Wt(0,i,l)}}})),x.cssHooks.marginLeft=zt(p.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Yt(t,"marginLeft"))||t.getBoundingClientRect().left-Bt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(t,e){x.cssHooks[t+e]={expand:function(i){for(var s=0,n={},r="string"==typeof i?i.split(" "):[i];s<4;s++)n[t+et[s]+e]=r[s]||r[s-2]||r[0];return n}},"margin"!==t&&(x.cssHooks[t+e].set=Wt)})),x.fn.extend({css:function(t,e){return z(this,(function(t,e,i){var s,n,r={},o=0;if(Array.isArray(e)){for(s=It(t),n=e.length;o<n;o++)r[e[o]]=x.css(t,e[o],!1,s);return r}return void 0!==i?x.style(t,e,i):x.css(t,e)}),t,e,arguments.length>1)}}),x.Tween=Zt,(Zt.prototype={constructor:Zt,init:function(t,e,i,s,n,r){this.elem=t,this.prop=i,this.easing=n||x.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=s,this.unit=r||(x.cssNumber[i]?"":"px")},cur:function(){var t=Zt.propHooks[this.prop];return t&&t.get?t.get(this):Zt.propHooks._default.get(this)},run:function(t){var e,i=Zt.propHooks[this.prop];return this.pos=e=this.options.duration?x.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Zt.propHooks._default.set(this),this}}).init.prototype=Zt.prototype,(Zt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=x.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){x.fx.step[t.prop]?x.fx.step[t.prop](t):1!==t.elem.nodeType||!x.cssHooks[t.prop]&&null==t.elem.style[Gt(t.prop)]?t.elem[t.prop]=t.now:x.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Zt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},x.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},x.fx=Zt.prototype.init,x.fx.step={};var te,ee,ie=/^(?:toggle|show|hide)$/,se=/queueHooks$/;function ne(){ee&&(!1===g.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(ne):t.setTimeout(ne,x.fx.interval),x.fx.tick())}function re(){return t.setTimeout((function(){te=void 0})),te=Date.now()}function oe(t,e){var i,s=0,n={height:t};for(e=e?1:0;s<4;s+=2-e)n["margin"+(i=et[s])]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function ae(t,e,i){for(var s,n=(le.tweeners[e]||[]).concat(le.tweeners["*"]),r=0,o=n.length;r<o;r++)if(s=n[r].call(i,e,t))return s}function le(t,e,i){var s,n,r=0,o=le.prefilters.length,a=x.Deferred().always((function(){delete l.elem})),l=function(){if(n)return!1;for(var e=te||re(),i=Math.max(0,c.startTime+c.duration-e),s=1-(i/c.duration||0),r=0,o=c.tweens.length;r<o;r++)c.tweens[r].run(s);return a.notifyWith(t,[c,s,i]),s<1&&o?i:(o||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:x.extend({},e),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},i),originalProperties:e,originalOptions:i,startTime:te||re(),duration:i.duration,tweens:[],createTween:function(e,i){var s=x.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(s),s},stop:function(e){var i=0,s=e?c.tweens.length:0;if(n)return this;for(n=!0;i<s;i++)c.tweens[i].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),h=c.props;for(function(t,e){var i,s,n,r,o;for(i in t)if(n=e[s=G(i)],r=t[i],Array.isArray(r)&&(n=r[1],r=t[i]=r[0]),i!==s&&(t[s]=r,delete t[i]),(o=x.cssHooks[s])&&"expand"in o)for(i in r=o.expand(r),delete t[s],r)i in t||(t[i]=r[i],e[i]=n);else e[s]=n}(h,c.opts.specialEasing);r<o;r++)if(s=le.prefilters[r].call(c,t,h,c.opts))return f(s.stop)&&(x._queueHooks(c.elem,c.opts.queue).stop=s.stop.bind(s)),s;return x.map(h,ae,c),f(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),x.fx.timer(x.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}x.Animation=x.extend(le,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return ot(i.elem,t,tt.exec(e),i),i}]},tweener:function(t,e){f(t)?(e=t,t=["*"]):t=t.match(D);for(var i,s=0,n=t.length;s<n;s++)(le.tweeners[i=t[s]]=le.tweeners[i]||[]).unshift(e)},prefilters:[function(t,e,i){var s,n,r,o,a,l,c,h,u="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&rt(t),g=$.get(t,"fxshow");for(s in i.queue||(null==(o=x._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,x.queue(t,"fx").length||o.empty.fire()}))}))),e)if(ie.test(n=e[s])){if(delete e[s],r=r||"toggle"===n,n===(m?"hide":"show")){if("show"!==n||!g||void 0===g[s])continue;m=!0}p[s]=g&&g[s]||x.style(t,s)}if((l=!x.isEmptyObject(e))||!x.isEmptyObject(p))for(s in u&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=g&&g.display)&&(c=$.get(t,"display")),"none"===(h=x.css(t,"display"))&&(c?h=c:(ct([t],!0),c=t.style.display||c,h=x.css(t,"display"),ct([t]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===x.css(t,"float")&&(l||(d.done((function(){f.display=c})),null==c&&(c="none"===(h=f.display)?"":h)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(m=g.hidden):g=$.access(t,"fxshow",{display:c}),r&&(g.hidden=!m),m&&ct([t],!0),d.done((function(){for(s in m||ct([t]),$.remove(t,"fxshow"),p)x.style(t,s,p[s])}))),l=ae(m?g[s]:0,s,d),s in g||(g[s]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?le.prefilters.unshift(t):le.prefilters.push(t)}}),x.speed=function(t,e,i){var s=t&&"object"==typeof t?x.extend({},t):{complete:i||!i&&e||f(t)&&t,duration:t,easing:i&&e||e&&!f(e)&&e};return x.fx.off?s.duration=0:"number"!=typeof s.duration&&(s.duration=s.duration in x.fx.speeds?x.fx.speeds[s.duration]:x.fx.speeds._default),null!=s.queue&&!0!==s.queue||(s.queue="fx"),s.old=s.complete,s.complete=function(){f(s.old)&&s.old.call(this),s.queue&&x.dequeue(this,s.queue)},s},x.fn.extend({fadeTo:function(t,e,i,s){return this.filter(rt).css("opacity",0).show().end().animate({opacity:e},t,i,s)},animate:function(t,e,i,s){var n=x.isEmptyObject(t),r=x.speed(e,i,s),o=function(){var e=le(this,x.extend({},t),r);(n||$.get(this,"finish"))&&e.stop(!0)};return o.finish=o,n||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(t,e,i){var s=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,n=null!=t&&t+"queueHooks",r=x.timers,o=$.get(this);if(n)o[n]&&o[n].stop&&s(o[n]);else for(n in o)o[n]&&o[n].stop&&se.test(n)&&s(o[n]);for(n=r.length;n--;)r[n].elem!==this||null!=t&&r[n].queue!==t||(r[n].anim.stop(i),e=!1,r.splice(n,1));!e&&i||x.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=$.get(this),s=i[t+"queue"],n=i[t+"queueHooks"],r=x.timers,o=s?s.length:0;for(i.finish=!0,x.queue(this,t,[]),n&&n.stop&&n.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<o;e++)s[e]&&s[e].finish&&s[e].finish.call(this);delete i.finish}))}}),x.each(["toggle","show","hide"],(function(t,e){var i=x.fn[e];x.fn[e]=function(t,s,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(oe(e,!0),t,s,n)}})),x.each({slideDown:oe("show"),slideUp:oe("hide"),slideToggle:oe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){x.fn[t]=function(t,i,s){return this.animate(e,t,i,s)}})),x.timers=[],x.fx.tick=function(){var t,e=0,i=x.timers;for(te=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||x.fx.stop(),te=void 0},x.fx.timer=function(t){x.timers.push(t),x.fx.start()},x.fx.interval=13,x.fx.start=function(){ee||(ee=!0,ne())},x.fx.stop=function(){ee=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,i){return e=x.fx&&x.fx.speeds[e]||e,this.queue(i=i||"fx",(function(i,s){var n=t.setTimeout(i,e);s.stop=function(){t.clearTimeout(n)}}))},function(){var t=g.createElement("input"),e=g.createElement("select").appendChild(g.createElement("option"));t.type="checkbox",p.checkOn=""!==t.value,p.optSelected=e.selected,(t=g.createElement("input")).value="t",t.type="radio",p.radioValue="t"===t.value}();var ce,he=x.expr.attrHandle;x.fn.extend({attr:function(t,e){return z(this,x.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){x.removeAttr(this,t)}))}}),x.extend({attr:function(t,e,i){var s,n,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?x.prop(t,e,i):(1===r&&x.isXMLDoc(t)||(n=x.attrHooks[e.toLowerCase()]||(x.expr.match.bool.test(e)?ce:void 0)),void 0!==i?null===i?void x.removeAttr(t,e):n&&"set"in n&&void 0!==(s=n.set(t,i,e))?s:(t.setAttribute(e,i+""),i):n&&"get"in n&&null!==(s=n.get(t,e))?s:null==(s=x.find.attr(t,e))?void 0:s)},attrHooks:{type:{set:function(t,e){if(!p.radioValue&&"radio"===e&&k(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,s=0,n=e&&e.match(D);if(n&&1===t.nodeType)for(;i=n[s++];)t.removeAttribute(i)}}),ce={set:function(t,e,i){return!1===e?x.removeAttr(t,i):t.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=he[e]||x.find.attr;he[e]=function(t,e,s){var n,r,o=e.toLowerCase();return s||(r=he[o],he[o]=n,n=null!=i(t,e,s)?o:null,he[o]=r),n}}));var ue=/^(?:input|select|textarea|button)$/i,de=/^(?:a|area)$/i;function pe(t){return(t.match(D)||[]).join(" ")}function fe(t){return t.getAttribute&&t.getAttribute("class")||""}function me(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(D)||[]}x.fn.extend({prop:function(t,e){return z(this,x.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[x.propFix[t]||t]}))}}),x.extend({prop:function(t,e,i){var s,n,r=t.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&x.isXMLDoc(t)||(n=x.propHooks[e=x.propFix[e]||e]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(t,i,e))?s:t[e]=i:n&&"get"in n&&null!==(s=n.get(t,e))?s:t[e]},propHooks:{tabIndex:{get:function(t){var e=x.find.attr(t,"tabindex");return e?parseInt(e,10):ue.test(t.nodeName)||de.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(x.propHooks.selected={get:function(t){return null},set:function(t){}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(t){var e,i,s,n,r,o,a,l=0;if(f(t))return this.each((function(e){x(this).addClass(t.call(this,e,fe(this)))}));if((e=me(t)).length)for(;i=this[l++];)if(n=fe(i),s=1===i.nodeType&&" "+pe(n)+" "){for(o=0;r=e[o++];)s.indexOf(" "+r+" ")<0&&(s+=r+" ");n!==(a=pe(s))&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,s,n,r,o,a,l=0;if(f(t))return this.each((function(e){x(this).removeClass(t.call(this,e,fe(this)))}));if(!arguments.length)return this.attr("class","");if((e=me(t)).length)for(;i=this[l++];)if(n=fe(i),s=1===i.nodeType&&" "+pe(n)+" "){for(o=0;r=e[o++];)for(;s.indexOf(" "+r+" ")>-1;)s=s.replace(" "+r+" "," ");n!==(a=pe(s))&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t,s="string"===i||Array.isArray(t);return"boolean"==typeof e&&s?e?this.addClass(t):this.removeClass(t):f(t)?this.each((function(i){x(this).toggleClass(t.call(this,i,fe(this),e),e)})):this.each((function(){var e,n,r,o;if(s)for(n=0,r=x(this),o=me(t);e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==i||((e=fe(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))}))},hasClass:function(t){var e,i,s=0;for(e=" "+t+" ";i=this[s++];)if(1===i.nodeType&&(" "+pe(fe(i))+" ").indexOf(e)>-1)return!0;return!1}});var ge=/\r/g;x.fn.extend({val:function(t){var e,i,s,n=this[0];return arguments.length?(s=f(t),this.each((function(i){var n;1===this.nodeType&&(null==(n=s?t.call(this,i,x(this).val()):t)?n="":"number"==typeof n?n+="":Array.isArray(n)&&(n=x.map(n,(function(t){return null==t?"":t+""}))),(e=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,n,"value")||(this.value=n))}))):n?(e=x.valHooks[n.type]||x.valHooks[n.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(n,"value"))?i:"string"==typeof(i=n.value)?i.replace(ge,""):null==i?"":i:void 0}}),x.extend({valHooks:{option:{get:function(t){var e=x.find.attr(t,"value");return null!=e?e:pe(x.text(t))}},select:{get:function(t){var e,i,s,n=t.options,r=t.selectedIndex,o="select-one"===t.type,a=o?null:[],l=o?r+1:n.length;for(s=r<0?l:o?r:0;s<l;s++)if(((i=n[s]).selected||s===r)&&!i.disabled&&(!i.parentNode.disabled||!k(i.parentNode,"optgroup"))){if(e=x(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,s,n=t.options,r=x.makeArray(e),o=n.length;o--;)((s=n[o]).selected=x.inArray(x.valHooks.option.get(s),r)>-1)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=x.inArray(x(t).val(),e)>-1}},p.checkOn||(x.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),p.focusin="onfocusin"in t;var be=/^(?:focusinfocus|focusoutblur)$/,ye=function(t){t.stopPropagation()};x.extend(x.event,{trigger:function(e,i,s,n){var r,o,a,l,c,u,d,p,b=[s||g],y=h.call(e,"type")?e.type:e,v=h.call(e,"namespace")?e.namespace.split("."):[];if(o=p=a=s=s||g,3!==s.nodeType&&8!==s.nodeType&&!be.test(y+x.event.triggered)&&(y.indexOf(".")>-1&&(v=y.split("."),y=v.shift(),v.sort()),c=y.indexOf(":")<0&&"on"+y,(e=e[x.expando]?e:new x.Event(y,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=s),i=null==i?[e]:x.makeArray(i,[e]),d=x.event.special[y]||{},n||!d.trigger||!1!==d.trigger.apply(s,i))){if(!n&&!d.noBubble&&!m(s)){for(be.test((l=d.delegateType||y)+y)||(o=o.parentNode);o;o=o.parentNode)b.push(o),a=o;a===(s.ownerDocument||g)&&b.push(a.defaultView||a.parentWindow||t)}for(r=0;(o=b[r++])&&!e.isPropagationStopped();)p=o,e.type=r>1?l:d.bindType||y,(u=($.get(o,"events")||Object.create(null))[e.type]&&$.get(o,"handle"))&&u.apply(o,i),(u=c&&o[c])&&u.apply&&H(o)&&(e.result=u.apply(o,i),!1===e.result&&e.preventDefault());return e.type=y,n||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(b.pop(),i)||!H(s)||c&&f(s[y])&&!m(s)&&((a=s[c])&&(s[c]=null),x.event.triggered=y,e.isPropagationStopped()&&p.addEventListener(y,ye),s[y](),e.isPropagationStopped()&&p.removeEventListener(y,ye),x.event.triggered=void 0,a&&(s[c]=a)),e.result}},simulate:function(t,e,i){var s=x.extend(new x.Event,i,{type:t,isSimulated:!0});x.event.trigger(s,null,e)}}),x.fn.extend({trigger:function(t,e){return this.each((function(){x.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return x.event.trigger(t,e,i,!0)}}),p.focusin||x.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){x.event.simulate(e,t.target,x.event.fix(t))};x.event.special[e]={setup:function(){var s=this.ownerDocument||this.document||this,n=$.access(s,e);n||s.addEventListener(t,i,!0),$.access(s,e,(n||0)+1)},teardown:function(){var s=this.ownerDocument||this.document||this,n=$.access(s,e)-1;n?$.access(s,e,n):(s.removeEventListener(t,i,!0),$.remove(s,e))}}}));var ve=t.location,xe={guid:Date.now()},Ce=/\?/;x.parseXML=function(e){var i,s;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(n){}return s=i&&i.getElementsByTagName("parsererror")[0],i&&!s||x.error("Invalid XML: "+(s?x.map(s.childNodes,(function(t){return t.textContent})).join("\n"):e)),i};var _e=/\[\]$/,we=/\r?\n/g,Se=/^(?:submit|button|image|reset|file)$/i,Pe=/^(?:input|select|textarea|keygen)/i;function ke(t,e,i,s){var n;if(Array.isArray(e))x.each(e,(function(e,n){i||_e.test(t)?s(t,n):ke(t+"["+("object"==typeof n&&null!=n?e:"")+"]",n,i,s)}));else if(i||"object"!==v(e))s(t,e);else for(n in e)ke(t+"["+n+"]",e[n],i,s)}x.param=function(t,e){var i,s=[],n=function(t,e){var i=f(e)?e():e;s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!x.isPlainObject(t))x.each(t,(function(){n(this.name,this.value)}));else for(i in t)ke(i,t[i],e,n);return s.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=x.prop(this,"elements");return t?x.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!x(this).is(":disabled")&&Pe.test(this.nodeName)&&!Se.test(t)&&(this.checked||!dt.test(t))})).map((function(t,e){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,(function(t){return{name:e.name,value:t.replace(we,"\r\n")}})):{name:e.name,value:i.replace(we,"\r\n")}})).get()}});var Ee=/%20/g,Te=/#.*$/,Ae=/([?&])_=[^&]*/,Oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,Me=/^(?:GET|HEAD)$/,Ne=/^\/\//,Le={},De={},je="*/".concat("*"),Re=g.createElement("a");function Ie(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var s,n=0,r=e.toLowerCase().match(D)||[];if(f(i))for(;s=r[n++];)"+"===s[0]?(s=s.slice(1)||"*",(t[s]=t[s]||[]).unshift(i)):(t[s]=t[s]||[]).push(i)}}function Be(t,e,i,s){var n={},r=t===De;function o(a){var l;return n[a]=!0,x.each(t[a]||[],(function(t,a){var c=a(e,i,s);return"string"!=typeof c||r||n[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)})),l}return o(e.dataTypes[0])||!n["*"]&&o("*")}function Fe(t,e){var i,s,n=x.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((n[i]?t:s||(s={}))[i]=e[i]);return s&&x.extend(!0,t,s),t}Re.href=ve.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ve.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ve.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Fe(Fe(t,x.ajaxSettings),e):Fe(x.ajaxSettings,t)},ajaxPrefilter:Ie(Le),ajaxTransport:Ie(De),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0);var s,n,r,o,a,l,c,h,u,d,p=x.ajaxSetup({},i=i||{}),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?x(f):x.event,b=x.Deferred(),y=x.Callbacks("once memory"),v=p.statusCode||{},C={},_={},w="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(c){if(!o)for(o={};e=Oe.exec(r);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(t,e){return null==c&&(t=_[t.toLowerCase()]=_[t.toLowerCase()]||t,C[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)S.always(t[S.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return s&&s.abort(e),P(0,e),this}};if(b.promise(S),p.url=((e||p.url||ve.href)+"").replace(Ne,ve.protocol+"//"),p.type=i.method||i.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(D)||[""],null==p.crossDomain){l=g.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Re.protocol+"//"+Re.host!=l.protocol+"//"+l.host}catch(k){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),Be(Le,p,i,S),c)return S;for(u in(h=x.event&&p.global)&&0==x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Me.test(p.type),n=p.url.replace(Te,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ee,"+")):(d=p.url.slice(n.length),p.data&&(p.processData||"string"==typeof p.data)&&(n+=(Ce.test(n)?"&":"?")+p.data,delete p.data),!1===p.cache&&(n=n.replace(Ae,"$1"),d=(Ce.test(n)?"&":"?")+"_="+xe.guid+++d),p.url=n+d),p.ifModified&&(x.lastModified[n]&&S.setRequestHeader("If-Modified-Since",x.lastModified[n]),x.etag[n]&&S.setRequestHeader("If-None-Match",x.etag[n])),(p.data&&p.hasContent&&!1!==p.contentType||i.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+je+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(u,p.headers[u]);if(p.beforeSend&&(!1===p.beforeSend.call(f,S,p)||c))return S.abort();if(w="abort",y.add(p.complete),S.done(p.success),S.fail(p.error),s=Be(De,p,i,S)){if(S.readyState=1,h&&m.trigger("ajaxSend",[S,p]),c)return S;p.async&&p.timeout>0&&(a=t.setTimeout((function(){S.abort("timeout")}),p.timeout));try{c=!1,s.send(C,P)}catch(k){if(c)throw k;P(-1,k)}}else P(-1,"No Transport");function P(e,i,o,l){var u,d,g,C,_,w=i;c||(c=!0,a&&t.clearTimeout(a),s=void 0,r=l||"",S.readyState=e>0?4:0,u=e>=200&&e<300||304===e,o&&(C=function(t,e,i){for(var s,n,r,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=t.mimeType||e.getResponseHeader("Content-Type"));if(s)for(n in a)if(a[n]&&a[n].test(s)){l.unshift(n);break}if(l[0]in i)r=l[0];else{for(n in i){if(!l[0]||t.converters[n+" "+l[0]]){r=n;break}o||(o=n)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),i[r]}(p,S,o)),!u&&x.inArray("script",p.dataTypes)>-1&&x.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),C=function(t,e,i,s){var n,r,o,a,l,c={},h=t.dataTypes.slice();if(h[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(r=h.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&s&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=h.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=c[l+" "+r]||c["* "+r]))for(n in c)if((a=n.split(" "))[1]===r&&(o=c[l+" "+a[0]]||c["* "+a[0]])){!0===o?o=c[n]:!0!==c[n]&&(r=a[0],h.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(k){return{state:"parsererror",error:o?k:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}(p,C,S,u),u?(p.ifModified&&((_=S.getResponseHeader("Last-Modified"))&&(x.lastModified[n]=_),(_=S.getResponseHeader("etag"))&&(x.etag[n]=_)),204===e||"HEAD"===p.type?w="nocontent":304===e?w="notmodified":(w=C.state,d=C.data,u=!(g=C.error))):(g=w,!e&&w||(w="error",e<0&&(e=0))),S.status=e,S.statusText=(i||w)+"",u?b.resolveWith(f,[d,w,S]):b.rejectWith(f,[S,w,g]),S.statusCode(v),v=void 0,h&&m.trigger(u?"ajaxSuccess":"ajaxError",[S,p,u?d:g]),y.fireWith(f,[S,w]),h&&(m.trigger("ajaxComplete",[S,p]),--x.active||x.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,i){return x.get(t,e,i,"json")},getScript:function(t,e){return x.get(t,void 0,e,"script")}}),x.each(["get","post"],(function(t,e){x[e]=function(t,i,s,n){return f(i)&&(n=n||s,s=i,i=void 0),x.ajax(x.extend({url:t,type:e,dataType:n,data:i,success:s},x.isPlainObject(t)&&t))}})),x.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),x._evalUrl=function(t,e,i){return x.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){x.globalEval(t,e,i)}})},x.fn.extend({wrapAll:function(t){var e;return this[0]&&(f(t)&&(t=t.call(this[0])),e=x(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return f(t)?this.each((function(e){x(this).wrapInner(t.call(this,e))})):this.each((function(){var e=x(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=f(t);return this.each((function(i){x(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(t){return!x.expr.pseudos.visible(t)},x.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var Ye={0:200,1223:204},ze=x.ajaxSettings.xhr();p.cors=!!ze&&"withCredentials"in ze,p.ajax=ze=!!ze,x.ajaxTransport((function(e){var i,s;if(p.cors||ze&&!e.crossDomain)return{send:function(n,r){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)a.setRequestHeader(o,n[o]);i=function(t){return function(){i&&(i=s=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Ye[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),s=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=s:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout((function(){i&&s()}))},i=i("abort");try{a.send(e.hasContent&&e.data||null)}catch(l){if(i)throw l}},abort:function(){i&&i()}}})),x.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return x.globalEval(t),t}}}),x.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),x.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(s,n){e=x("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&n("error"===t.type?404:200,t.type)}),g.head.appendChild(e[0])},abort:function(){i&&i()}}}));var qe,Xe=[],Ue=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Xe.pop()||x.expando+"_"+xe.guid++;return this[t]=!0,t}}),x.ajaxPrefilter("json jsonp",(function(e,i,s){var n,r,o,a=!1!==e.jsonp&&(Ue.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ue.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=f(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ue,"$1"+n):!1!==e.jsonp&&(e.url+=(Ce.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return o||x.error(n+" was not called"),o[0]},e.dataTypes[0]="json",r=t[n],t[n]=function(){o=arguments},s.always((function(){void 0===r?x(t).removeProp(n):t[n]=r,e[n]&&(e.jsonpCallback=i.jsonpCallback,Xe.push(n)),o&&f(r)&&r(o[0]),o=r=void 0})),"script"})),p.createHTMLDocument=((qe=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===qe.childNodes.length),x.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(p.createHTMLDocument?((s=(e=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,e.head.appendChild(s)):e=g),r=!i&&[],(n=E.exec(t))?[e.createElement(n[1])]:(n=vt([t],e,r),r&&r.length&&x(r).remove(),x.merge([],n.childNodes)));var s,n,r},x.fn.load=function(t,e,i){var s,n,r,o=this,a=t.indexOf(" ");return a>-1&&(s=pe(t.slice(a)),t=t.slice(0,a)),f(e)?(i=e,e=void 0):e&&"object"==typeof e&&(n="POST"),o.length>0&&x.ajax({url:t,type:n||"GET",dataType:"html",data:e}).done((function(t){r=arguments,o.html(s?x("<div>").append(x.parseHTML(t)).find(s):t)})).always(i&&function(t,e){o.each((function(){i.apply(this,r||[t.responseText,e,t])}))}),this},x.expr.pseudos.animated=function(t){return x.grep(x.timers,(function(e){return t===e.elem})).length},x.offset={setOffset:function(t,e,i){var s,n,r,o,a,l,c=x.css(t,"position"),h=x(t),u={};"static"===c&&(t.style.position="relative"),a=h.offset(),r=x.css(t,"top"),l=x.css(t,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(o=(s=h.position()).top,n=s.left):(o=parseFloat(r)||0,n=parseFloat(l)||0),f(e)&&(e=e.call(t,i,x.extend({},a))),null!=e.top&&(u.top=e.top-a.top+o),null!=e.left&&(u.left=e.left-a.left+n),"using"in e?e.using.call(t,u):h.css(u)}},x.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){x.offset.setOffset(this,t,e)}));var e,i,s=this[0];return s?s.getClientRects().length?{top:(e=s.getBoundingClientRect()).top+(i=s.ownerDocument.defaultView).pageYOffset,left:e.left+i.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,s=this[0],n={top:0,left:0};if("fixed"===x.css(s,"position"))e=s.getBoundingClientRect();else{for(e=this.offset(),i=s.ownerDocument,t=s.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===x.css(t,"position");)t=t.parentNode;t&&t!==s&&1===t.nodeType&&((n=x(t).offset()).top+=x.css(t,"borderTopWidth",!0),n.left+=x.css(t,"borderLeftWidth",!0))}return{top:e.top-n.top-x.css(s,"marginTop",!0),left:e.left-n.left-x.css(s,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===x.css(t,"position");)t=t.offsetParent;return t||it}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;x.fn[t]=function(s){return z(this,(function(t,s,n){var r;if(m(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===n)return r?r[e]:t[s];r?r.scrollTo(i?r.pageXOffset:n,i?n:r.pageYOffset):t[s]=n}),t,s,arguments.length)}})),x.each(["top","left"],(function(t,e){x.cssHooks[e]=zt(p.pixelPosition,(function(t,i){if(i)return i=Yt(t,e),Rt.test(i)?x(t).position()[e]+"px":i}))})),x.each({Height:"height",Width:"width"},(function(t,e){x.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,s){x.fn[s]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===r?"margin":"border");return z(this,(function(e,i,n){var r;return m(e)?0===s.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?x.css(e,i,a):x.style(e,i,n,a)}),e,o?n:void 0,o)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){x.fn[e]=function(t){return this.on(e,t)}})),x.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,s){return this.on(e,t,i,s)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){x.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var Ge=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;x.proxy=function(t,e){var i,s,r;if("string"==typeof e&&(i=t[e],e=t,t=i),f(t))return s=n.call(arguments,2),(r=function(){return t.apply(e||this,s.concat(n.call(arguments)))}).guid=t.guid=t.guid||x.guid++,r},x.holdReady=function(t){t?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=k,x.isFunction=f,x.isWindow=m,x.camelCase=G,x.type=v,x.now=Date.now,x.isNumeric=function(t){var e=x.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},x.trim=function(t){return null==t?"":(t+"").replace(Ge,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return x}));var He=t.jQuery,Je=t.$;return x.noConflict=function(e){return t.$===x&&(t.$=Je),e&&t.jQuery===x&&(t.jQuery=He),x},void 0===e&&(t.jQuery=t.$=x),x})),function(){var t=window.jQuery,e="mathquill-block-id",i=Math.min,s=Math.max;if(!t)throw"MathQuill requires jQuery 1.5.2+ to be loaded first";function n(){}var r=[].slice;function o(t){var e=t.length-1;return function(){var i=r.call(arguments,0,e),s=r.call(arguments,e);return t.apply(this,i.concat([s]))}}var a=o((function(t,e){return o((function(i,s){if(t in i)return i[t].apply(i,e.concat(s))}))}));function l(t){return o((function(e,i){return"function"!=typeof e&&(e=a(e)),t.call(this,(function(t){return e.apply(t,[t].concat(i))}))}))}function c(t){var e=r.call(arguments,1);return function(){return t.apply(this,e)}}function h(t,e){if(!e)throw new Error("prayer failed: "+t)}var u=function(t,e,i){function s(t){return"object"==typeof t}function n(t){return"function"==typeof t}function r(){}return function t(i,o){function a(){var t=new l;return n(t.init)&&t.init.apply(t,arguments),t}function l(){}void 0===o&&(o=i,i=Object),a.Bare=l;var c,h=r.prototype=i.prototype,u=l.prototype=a.prototype=a.p=new r;return u.constructor=a,a.extend=function(e){return t(a,e)},(a.open=function(t){if(c={},n(t)?c=t.call(a,u,h,a,i):s(t)&&(c=t),s(c))for(var r in c)e.call(c,r)&&(u[r]=c[r]);return n(u.init)||(u.init=i),a})(o)}}(0,{}.hasOwnProperty),d=-1;function p(t){h("a direction was passed",t===d||1===t)}var f=u(t,(function(t){t.insDirOf=function(t,e){return t===d?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===d?this.prependTo(e):this.appendTo(e)}})),m=u((function(t){t.parent=0,t[d]=0,t[1]=0,t.init=function(t,e,i){this.parent=t,this[d]=e,this[1]=i},this.copy=function(t){return m(t.parent,t[d],t[1])}})),g=u((function(t){t[d]=0,t[1]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,g.byId[this.id]=this,this.ends={},this.ends[d]=0,this.ends[1]=0},t.dispose=function(){delete g.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=f(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){function e(t){if(t.getAttribute){var i=t.getAttribute("mathquill-command-id"),s=t.getAttribute("mathquill-block-id");i&&g.byId[i].jQadd(t),s&&g.byId[s].jQadd(t)}for(t=t.firstChild;t;t=t.nextSibling)e(t)}t=f(t||this.html());for(var i=0;i<t.length;i+=1)e(t[i]);return t},t.createDir=function(t,e){return p(t),this.jQize(),this.jQ.insDirOf(t,e.jQ),e[t]=this.adopt(e.parent,e[d],e[1]),this},t.createLeftOf=function(t){return this.createDir(d,t)},t.selectChildren=function(t,e){return _(t,e)},t.bubble=l((function(t){for(var e=this;e&&!1!==t(e);e=e.parent);return this})),t.postOrder=l((function(t){return function e(i){i.eachChild(e),t(i)}(this),this})),t.isEmpty=function(){return 0===this.ends[d]&&0===this.ends[1]},t.isStyleBlock=function(){return!1},t.children=function(){return y(this.ends[d],this.ends[1])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,i,s){return y(this,this).withDirAdopt(t,e,i,s),this},t.adopt=function(t,e,i){return y(this,this).adopt(t,e,i),this},t.disown=function(){return y(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}}));function b(t,e,i){h("a parent is always present",t),h("leftward is properly set up",e?e[1]===i&&e.parent===t:t.ends[d]===i),h("rightward is properly set up",i?i[d]===e&&i.parent===t:t.ends[1]===e)}var y=u((function(t){t.init=function(t,e,i){if(void 0===i&&(i=d),p(i),h("no half-empty fragments",!t==!e),this.ends={},t){h("withDir is passed to Fragment",t instanceof g),h("oppDir is passed to Fragment",e instanceof g),h("withDir and oppDir have the same parent",t.parent===e.parent),this.ends[i]=t,this.ends[-i]=e;var s=this.fold([],(function(t,e){return t.push.apply(t,e.jQ.get()),t}));this.jQ=this.jQ.add(s)}},t.jQ=f(),t.withDirAdopt=function(t,e,i,s){return t===d?this.adopt(e,i,s):this.adopt(e,s,i)},t.adopt=function(t,e,i){b(t,e,i),this.disowned=!1;var s=this.ends[d];if(!s)return this;var n=this.ends[1];return e||(t.ends[d]=s),i?i[d]=n:t.ends[1]=n,this.ends[1][1]=i,this.each((function(i){i[d]=e,i.parent=t,e&&(e[1]=i),e=i})),this},t.disown=function(){var t=this.ends[d];if(!t||this.disowned)return this;this.disowned=!0;var e=this.ends[1],i=t.parent;return b(i,t[d],t),b(i,e,e[1]),t[d]?t[d][1]=e[1]:i.ends[d]=e[1],e[1]?e[1][d]=t[d]:i.ends[1]=t[d],this},t.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},t.each=l((function(t){var e=this.ends[d];if(!e)return this;for(;e!==this.ends[1][1]&&!1!==t(e);e=e[1]);return this})),t.fold=function(t,e){return this.each((function(i){t=e.call(this,t,i)})),t}})),v={},x={},C=u(m,(function(t){t.init=function(t,e){this.parent=t,this.options=e;var i=this.jQ=this._jQ=f('<span class="mq-cursor">&#8203;</span>');this.blink=function(){i.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[1]?this.jQ.insertBefore(this.selection&&this.selection.ends[d][d]===this[d]?this.selection.jQ:this[1].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=f(),this},t.withDirInsertAt=function(t,e,i,s){var n=this.parent;this.parent=e,this[t]=i,this[-t]=s,n!==e&&n.blur&&n.blur(this)},t.insDirOf=function(t,e){return p(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},t.insLeftOf=function(t){return this.insDirOf(d,t)},t.insRightOf=function(t){return this.insDirOf(1,t)},t.insAtDirEnd=function(t,e){return p(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(d,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(1,t)},t.jumpUpDown=function(t,e){this.upDownCache[t.id]=m.copy(this);var i=this.upDownCache[e.id];if(i)i[1]?this.insLeftOf(i[1]):this.insAtRightEnd(i.parent);else{var s=this.offset().left;e.seek(s,this)}},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,i=t[1],s=t[d];if(t.disown().eachChild((function(n){n.isEmpty()||(n.children().adopt(e,s,i).each((function(e){e.jQ.insertBefore(t.jQ.first())})),s=n.ends[1])})),!this[1])if(this[d])this[1]=this[d][1];else for(;!this[1];){if(this.parent=this.parent[1],!this.parent){this[1]=t[1],this.parent=e;break}this[1]=this.parent.ends[d]}this[1]?this.insLeftOf(this[1]):this.insAtRightEnd(e),t.jQ.remove(),t[d].siblingDeleted&&t[d].siblingDeleted(this.options,1),t[1].siblingDeleted&&t[1].siblingDeleted(this.options,d)},t.startSelection=function(){for(var t=this.anticursor=m.copy(this),e=t.ancestors={},i=t;i.parent;i=i.parent)e[i.parent.id]=i},t.endSelection=function(){delete this.anticursor},t.select=function(){var t=this.anticursor;if(this[d]===t[d]&&this.parent===t.parent)return!1;for(var e=this;e.parent;e=e.parent)if(e.parent.id in t.ancestors){var i=e.parent;break}h("cursor and anticursor in the same tree",i);var s,n,r=t.ancestors[i.id],o=1;if(e[d]!==r)for(var a=e;a;a=a[1])if(a[1]===r[1]){o=d,s=e,n=r;break}return 1===o&&(s=r,n=e),s instanceof m&&(s=s[1]),n instanceof m&&(n=n[d]),this.hide().selection=i.selectChildren(s,n),this.insDirOf(o,this.selection.ends[o]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[d]=this.selection.ends[d][d],this[1]=this.selection.ends[1][1],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[d]=t.ends[d][d],this[1]=t.ends[1][1],delete this.selection),t}})),_=u(y,(function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",(function(e,i){return e+i[t]()}))}})),w=u((function(t){t.init=function(t,e,i){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=i,t.controller=this,this.cursor=t.cursor=C(t,i)},t.handle=function(t,e){var i=this.options.handlers;if(i&&i.fns[t]){var s=i.APIClasses[this.KIND_OF_MQ](this);e===d||1===e?i.fns[t](e,s):i.fns[t](s)}};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}})),S={},P=u(),k={},E=u(),T={};function A(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014â2015) â v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function O(t){return A(),Lt(t)}O.prototype=E.p,O.VERSION="v0.10.1",O.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(A=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014â2015) â v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),O},O.getInterface=L;var M=L.MIN=1,N=L.MAX=2;function L(i){if(!(M<=i&&i<=N))throw"Only interface versions between "+M+" and "+N+" supported. You specified: "+i;function s(t){if(!t||!t.nodeType)return null;var i=f(t).children(".mq-root-block").attr(e),s=i&&g.byId[i].controller;return s?r[s.KIND_OF_MQ](s):null}var r={};function o(t,e){for(var i in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:r}),e)if(e.hasOwnProperty(i)){var s=e[i],n=k[i];t[i]=n?n(s):s}}s.L=d,s.R=1,s.saneKeyboardEvents=B,s.config=function(t){return o(P.p,t),this},s.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";T[t]=e};var a=r.AbstractMathQuill=u(E,(function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var i=this.__controller,s=i.root,n=i.container;i.createTextarea();var r=n.addClass(t).contents().detach();s.jQ=f('<span class="mq-root-block"/>').attr(e,s.id).appendTo(n),this.latex(r.text()),this.revert=function(){return n.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(r)}},t.config=function(t){return o(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}}));for(var l in s.prototype=a.prototype,r.EditableField=u(a,(function(e,i){e.__mathquillify=function(){return i.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},e.focus=function(){return this.__controller.textarea.focus(),this},e.blur=function(){return this.__controller.textarea.blur(),this},e.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},e.cmd=function(t){var e=this.__controller.notify(),i=e.cursor;if(/^\\[a-z]+$/i.test(t)){t=t.slice(1);var s=v[t];s&&(t=s(t),i.selection&&t.replaces(i.replaceSelection()),t.createLeftOf(i.show()),this.__controller.scrollHoriz())}else i.parent.write(i,t);return e.blurred&&i.hide().parent.blur(),this},e.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[d];)t.selectLeft();return this},e.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},e.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},e.moveToLeftEnd=function(){return this.moveToDirEnd(d)},e.moveToRightEnd=function(){return this.moveToDirEnd(1)},e.keystroke=function(t){t=t.replace(/^\s+|\s+$/g,"").split(/\s+/);for(var e=0;e<t.length;e+=1)this.__controller.keystroke(t[e],{preventDefault:n});return this},e.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},e.dropEmbedded=function(t,e,i){var s=t-f(window).scrollLeft(),n=e-f(window).scrollTop(),r=document.elementFromPoint(s,n);this.__controller.seek(f(r),t,e),Nt().setOptions(i).createLeftOf(this.__controller.cursor)},e.clickAt=function(e,i,s){s=s||document.elementFromPoint(e,i);var n=this.__controller,r=n.root;return t.contains(r.jQ[0],s)||(s=r.jQ[0]),n.seek(f(s),e+pageXOffset,i+pageYOffset),n.blurred&&this.focus(),this},e.ignoreNextMousedown=function(t){return this.__controller.cursor.options.ignoreNextMousedown=t,this}})),(s.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"}).prototype=r.EditableField.prototype,S)!function(t,e){var n=r[t]=e(r);(s[t]=function(e,r){var o=s(e);if(o instanceof n||!e||!e.nodeType)return o;var a=w(n.RootBlock(),f(e),P());return a.KIND_OF_MQ=t,n(a).__mathquillify(r,i)}).prototype=n.prototype}(l,S[l]);return s}O.noConflict=function(){return window.MathQuill=D,O};var D=window.MathQuill;function j(t){for(var e="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" "),i=0;i<e.length;i+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(e[i]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}window.MathQuill=O;var R,I=u((function(t,e,i){function s(t,e){throw"Parse Error: "+e+" at "+(t?"'"+t+"'":"EOF")}t.init=function(t){this._=t},t.parse=function(t){return this.skip(o)._(""+t,(function(t,e){return e}),s)},t.or=function(t){h("or is passed a parser",t instanceof i);var e=this;return i((function(i,s,n){return e._(i,s,(function(e){return t._(i,s,n)}))}))},t.then=function(t){var e=this;return i((function(s,n,r){return e._(s,(function(e,s){var o=t instanceof i?t:t(s);return h("a parser is returned",o instanceof i),o._(e,n,r)}),r)}))},t.many=function(){var t=this;return i((function(e,i,s){for(var n=[];t._(e,r,o););return i(e,n);function r(t,i){return e=t,n.push(i),!0}function o(){return!1}}))},t.times=function(t,e){arguments.length<2&&(e=t);var s=this;return i((function(i,n,r){for(var o,a=[],l=!0,c=0;c<t;c+=1)if(!(l=s._(i,h,u)))return r(i,o);for(;c<e&&l;c+=1)l=s._(i,h,d);return n(i,a);function h(t,e){return a.push(e),i=t,!0}function u(t,e){return o=e,i=t,!1}function d(t,e){return!1}}))},t.result=function(t){return this.then(r(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then((function(t){return e.many().map((function(e){return t.concat(e)}))}))},t.map=function(t){return this.then((function(e){return r(t(e))}))},t.skip=function(t){return this.then((function(e){return t.result(e)}))},this.string=function(t){var e=t.length,s="expected '"+t+"'";return i((function(i,n,r){var o=i.slice(0,e);return o===t?n(i.slice(e),o):r(i,s)}))};var n=this.regex=function(t){h("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return i((function(i,s,n){var r=t.exec(i);if(r){var o=r[0];return s(i.slice(o.length),o)}return n(i,e)}))},r=i.succeed=function(t){return i((function(e,i){return i(e,t)}))},o=(i.fail=function(t){return i((function(e,i,s){return s(e,t)}))},i.letter=n(/^[a-z]/i),i.letters=n(/^[a-z]*/i),i.digit=n(/^[0-9]/),i.digits=n(/^[0-9]*/),i.whitespace=n(/^\s+/),i.optWhitespace=n(/^\s*/),i.any=i((function(t,e,i){return t?e(t.slice(1),t.charAt(0)):i(t,"expected any character")})),i.all=i((function(t,e,i){return e("",t)})),i.eof=i((function(t,e,i){return t?i(t,"expected EOF"):e(t,t)})))})),B=(R={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},function(e,i){var s,r=null,o=null,a=t(e),l=t(i.container||a),c=n;function h(t){c=t,clearTimeout(s),s=setTimeout(t)}function u(t){h((function(e){c=n,clearTimeout(s),t(e)}))}l.bind("keydown keypress input keyup focusout paste",(function(t){c(t)}));var d=!1;function p(){i.keystroke(function(t){var e,i=t.which||t.keyCode,s=R[i],n=[];return t.ctrlKey&&n.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&n.push("Meta"),t.altKey&&n.push("Alt"),t.shiftKey&&n.push("Shift"),e=s||String.fromCharCode(i),n.length||s?(n.push(e),n.join("-")):e}(r),r)}function f(){if(!("selectionStart"in(t=a[0]))||t.selectionStart===t.selectionEnd){var t,e=a.val();1===e.length?(a.val(""),i.typedText(e)):e&&a[0].select&&a[0].select()}}function m(){var t=a.val();a.val(""),t&&i.paste(t)}return l.bind({keydown:function(t){r=t,o=null,d&&u((function(t){t&&"focusout"===t.type||!a[0].select||a[0].select()})),p()},keypress:function(t){r&&o&&p(),o=t,h(f)},keyup:function(t){r&&!o&&h(f)},focusout:function(){r=o=null},cut:function(){u((function(){i.cut()}))},copy:function(){u((function(){i.copy()}))},paste:function(t){a.focus(),h(m)}}),{select:function(t){c(),c=n,clearTimeout(s),a.val(t),t&&a[0].select&&a[0].select(),d=!!t}}});w.open((function(t,e){t.exportText=function(){return this.root.foldChildren("",(function(t,e){return t+e.text()}))}})),w.open((function(t){t.focusBlurEvents=function(){var t,e=this,i=e.root,s=e.cursor;function n(){clearTimeout(t),s.selection&&s.selection.jQ.addClass("mq-blur"),r()}function r(){s.hide().parent.blur(),e.container.removeClass("mq-focused"),f(window).unbind("blur",n)}e.textarea.focus((function(){e.blurred=!1,clearTimeout(t),e.container.addClass("mq-focused"),s.parent||s.insAtRightEnd(i),s.selection?(s.selection.jQ.removeClass("mq-blur"),e.selectionChanged()):s.show()})).blur((function(){e.blurred=!0,t=setTimeout((function(){i.postOrder("intentionalBlur"),s.clearSelection().endSelection(),r()})),f(window).bind("blur",n)})),e.blurred=!0,s.hide().parent.blur()}})),w.open((function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}})),g.open((function(t){t.keystroke=function(t,e,i){var s=i.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":i.ctrlDeleteDir(d);break;case"Shift-Backspace":case"Backspace":i.backspace();break;case"Esc":case"Tab":return void i.escapeDir(1,t,e);case"Shift-Tab":case"Shift-Esc":return void i.escapeDir(d,t,e);case"End":i.notify("move").cursor.insAtRightEnd(s.parent);break;case"Ctrl-End":i.notify("move").cursor.insAtRightEnd(i.root);break;case"Shift-End":for(;s[1];)i.selectRight();break;case"Ctrl-Shift-End":for(;s[1]||s.parent!==i.root;)i.selectRight();break;case"Home":i.notify("move").cursor.insAtLeftEnd(s.parent);break;case"Ctrl-Home":i.notify("move").cursor.insAtLeftEnd(i.root);break;case"Shift-Home":for(;s[d];)i.selectLeft();break;case"Ctrl-Shift-Home":for(;s[d]||s.parent!==i.root;)i.selectLeft();break;case"Left":i.moveLeft();break;case"Shift-Left":i.selectLeft();break;case"Ctrl-Left":break;case"Right":i.moveRight();break;case"Shift-Right":i.selectRight();break;case"Ctrl-Right":break;case"Up":i.moveUp();break;case"Down":i.moveDown();break;case"Shift-Up":if(s[d])for(;s[d];)i.selectLeft();else i.selectLeft();case"Shift-Down":if(s[1])for(;s[1];)i.selectRight();else i.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":i.ctrlDeleteDir(1);break;case"Shift-Del":case"Del":i.deleteForward();break;case"Meta-A":case"Ctrl-A":for(i.notify("move").cursor.insAtRightEnd(i.root);s[d];)i.selectLeft();break;default:return}e.preventDefault(),i.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){h("overridden or never called on this node")}})),w.open((function(t){function e(t,e){var i=t.notify("upDown").cursor,s=e+"Into",n=e+"OutOf";return i[1][s]?i.insAtLeftEnd(i[1][s]):i[d][s]?i.insAtRightEnd(i[d][s]):i.parent.bubble((function(t){var e=t[n];if(e&&("function"==typeof e&&(e=t[n](i)),e instanceof g&&i.jumpUpDown(t,e),!0!==e))return!1})),t}this.onNotify((function(t){"move"!==t&&"upDown"!==t||this.show().clearSelection()})),t.escapeDir=function(t,e,i){p(t);var s=this.cursor;if(s.parent!==this.root&&i.preventDefault(),s.parent!==this.root)return s.parent.moveOutOf(t,s),this.notify("move")},k.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){p(t);var e=this.cursor,i=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,i):e.parent.moveOutOf(t,e,i),this.notify("move")},t.moveLeft=function(){return this.moveDir(d)},t.moveRight=function(){return this.moveDir(1)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},this.onNotify((function(t){"upDown"!==t&&(this.upDownCache={})})),this.onNotify((function(t){"edit"===t&&this.show().deleteSelection()})),t.deleteDir=function(t){p(t);var e=this.cursor,i=e.selection;return this.notify("edit"),i||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[d].siblingDeleted&&e[d].siblingDeleted(e.options,1),e[1].siblingDeleted&&e[1].siblingDeleted(e.options,d),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){p(t);var e=this.cursor;return!e[d]||e.selection?this.deleteDir():(this.notify("edit"),y(e.parent.ends[d],e[d]).remove(),e.insAtDirEnd(d,e.parent),e[d].siblingDeleted&&e[d].siblingDeleted(e.options,1),e[1].siblingDeleted&&e[1].siblingDeleted(e.options,d),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(d)},t.deleteForward=function(){return this.deleteDir(1)},this.onNotify((function(t){"select"!==t&&this.endSelection()})),t.selectDir=function(t){var e=this.notify("select").cursor,i=e.selection;p(t),e.anticursor||e.startSelection();var s=e[t];s?i&&i.ends[t]===s&&e.anticursor[-t]!==s?s.unselectInto(t,e):s.selectTowards(t,e):e.parent.selectOutOf(t,e),e.clearSelection(),e.select()||e.show()},t.selectLeft=function(){return this.selectDir(d)},t.selectRight=function(){return this.selectDir(1)}}));var F=function(){function t(t){for(var e=t[0]||G(),i=1;i<t.length;i+=1)t[i].children().adopt(e,e.ends[1],0);return e}var e=I.string,i=I.regex,s=I.any,n=I.optWhitespace,r=I.succeed,o=I.fail,a=I.letter.map((function(t){return tt(t)})),l=i(/^[^${}\\_^]/).map((function(t){return X(t)})),c=i(/^[^\\a-eg-zA-Z]/).or(e("\\").then(i(/^[a-z]+/i).or(i(/^\s+/).result(" ")).or(s))).then((function(t){var e=v[t];return e?e(t).parser():o("unknown command: \\"+t)})).or(a).or(l),h=e("{").then((function(){return d})).skip(e("}")),u=n.then(h.or(c.map((function(t){var e=G();return t.adopt(e,0,0),e})))),d=u.many().map(t).skip(n),p=e("[").then(u.then((function(t){return"]"!==t.join("latex")?r(t):o()})).many().map(t).skip(n)).skip(e("]")),f=d;return f.block=u,f.optBlock=p,f}();w.open((function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.writeLatex=function(t){var e=this.notify("edit").cursor,i=I.all,s=F.skip(I.eof).or(i.result(!1)).parse(t);return s&&!s.isEmpty()&&(s.children().adopt(e.parent,e[d],e[1]),s.jQize().insertBefore(e.jQ),e[d]=s.ends[1],s.finalizeInsert(e.options,e),s.ends[1][1].siblingCreated&&s.ends[1][1].siblingCreated(e.options,d),s.ends[d][d].siblingCreated&&s.ends[d][d].siblingCreated(e.options,1),e.parent.bubble("reflow")),this},t.renderLatexMath=function(t){var e=this.root,i=this.cursor,s=I.all,n=F.skip(I.eof).or(s.result(!1)).parse(t);e.eachChild("postOrder","dispose"),e.ends[d]=e.ends[1]=0,n&&n.children().adopt(e,0,0);var r=e.jQ;if(n){var o=n.join("html");r.html(o),e.jQize(r.children()),e.finalizeInsert(i.options)}else r.empty();delete i.selection,i.insAtRightEnd(e)},t.renderLatexText=function(t){var e=this.root,i=this.cursor;e.jQ.children().slice(1).remove(),e.eachChild("postOrder","dispose"),e.ends[d]=e.ends[1]=0,delete i.selection,i.show().insAtRightEnd(e);var s=I.regex,n=I.string,r=I.eof,o=I.all,a=n("$").then(F).skip(n("$").or(r)).map((function(t){var e=W(i);e.createBlocks();var s=e.ends[d];return t.children().adopt(s,0,0),e})),l=n("\\$").result("$").or(s(/^[^$]/)).map(X),c=a.or(l).many().skip(r).or(o.result(!1)).parse(t);if(c){for(var h=0;h<c.length;h+=1)c[h].adopt(e,e.ends[1],0);e.jQize().appendTo(e.jQ),e.finalizeInsert(i.options)}}})),w.open((function(t){P.p.ignoreNextMousedown=n,t.delegateMouseEvents=function(){var t=this.root.jQ;this.container.bind("mousedown.mathquill",(function(i){var s,r=f(i.target).closest(".mq-root-block"),o=g.byId[r.attr(e)||t.attr(e)].controller,a=o.cursor,l=a.blink,c=o.textareaSpan,h=o.textarea;function u(t){s=f(t.target)}function d(t){a.anticursor||a.startSelection(),o.seek(s,t.pageX,t.pageY).cursor.select(),s=void 0}i.preventDefault(),i.target.unselectable=!0,a.options.ignoreNextMousedown(i)||(a.options.ignoreNextMousedown=n,o.blurred&&(o.editable||r.prepend(c),h.focus()),a.blink=n,o.seek(f(i.target),i.pageX,i.pageY).cursor.startSelection(),r.mousemove(u),f(i.target.ownerDocument).mousemove(d).mouseup((function t(e){a.blink=l,a.selection||(o.editable?a.show():c.detach()),r.unbind("mousemove",u),f(e.target.ownerDocument).unbind("mousemove",d).unbind("mouseup",t)})))}))}})),w.open((function(t){t.seek=function(t,i,s){var n=this.notify("select").cursor;if(t){var r=t.attr(e)||t.attr("mathquill-command-id");if(!r){var o=t.parent();r=o.attr(e)||o.attr("mathquill-command-id")}}var a=r?g.byId[r]:this.root;return h("nodeId is the id of some Node that exists",a),n.clearSelection().show(),a.seek(i,n),this.scrollHoriz(),this}})),w.open((function(t){t.scrollHoriz=function(){var t=this.cursor,e=t.selection,i=this.root.jQ[0].getBoundingClientRect();if(e){var s=e.jQ[0].getBoundingClientRect(),n=s.left-(i.left+20),r=s.right-(i.right-20);if(e.ends[d]===t[1])if(n<0)a=n;else{if(!(r>0))return;a=s.left-r<i.left+20?n:r}else if(r>0)a=r;else{if(!(n<0))return;a=s.right-n>i.right-20?r:n}}else{var o=t.jQ[0].getBoundingClientRect().left;if(o>i.right-20)var a=o-(i.right-20);else{if(!(o<i.left+20))return;a=o-(i.left+20)}}this.root.jQ.stop().animate({scrollLeft:"+="+a},100)}})),w.open((function(t){P.p.substituteTextarea=function(){return f("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},t.createTextarea=function(){var t=this.textareaSpan=f('<span class="mq-textarea"></span>'),e=this.options.substituteTextarea();if(!e.nodeType)throw"substituteTextarea() must return a DOM element, got "+e;e=this.textarea=f(e).appendTo(t);var i=this;i.cursor.selectionChanged=function(){i.selectionChanged()}},t.selectionChanged=function(){var t=this;mt(t.container[0]),void 0===t.textareaSelectionTimeout&&(t.textareaSelectionTimeout=setTimeout((function(){t.setTextareaSelection()})))},t.setTextareaSelection=function(){this.textareaSelectionTimeout=void 0;var t="";this.cursor.selection&&(t=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(t="$"+t+"$")),this.selectFn(t)},t.staticMathTextareaEvents=function(){var t=this,e=t.cursor,i=t.textarea,s=t.textareaSpan;function n(){s.detach(),t.blurred=!0}this.container.prepend('<span class="mq-selectable">$'+t.exportLatex()+"$</span>"),t.blurred=!0,i.bind("cut paste",!1).bind("copy",(function(){t.setTextareaSelection()})).focus((function(){t.blurred=!1})).blur((function(){e.selection&&e.selection.clear(),setTimeout(n)})),t.selectFn=function(t){i.val(t),t&&i.select()}},P.p.substituteKeyboardEvents=B,t.editablesTextareaEvents=function(){var t=this.textareaSpan,e=this.options.substituteKeyboardEvents(this.textarea,this);this.selectFn=function(t){e.select(t)},this.container.prepend(t),this.focusBlurEvents()},t.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},t.cut=function(){var t=this,e=t.cursor;e.selection&&setTimeout((function(){t.notify("edit"),e.parent.bubble("reflow")}))},t.copy=function(){this.setTextareaSelection()},t.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}}));var Y=u(g,(function(t,e){t.finalizeInsert=function(t,e){this.postOrder("finalizeTree",t),this.postOrder("contactWeld",e),this.postOrder("blur"),this.postOrder("reflow"),this[1].siblingCreated&&this[1].siblingCreated(t,d),this[d].siblingCreated&&this[d].siblingCreated(t,1),this.bubble("reflow")}})),z=u(Y,(function(t,e){t.init=function(t,i,s){e.init.call(this),this.ctrlSeq||(this.ctrlSeq=t),i&&(this.htmlTemplate=i),s&&(this.textTemplate=s)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,(function(t,e){return t&&e.isEmpty()}))},t.parser=function(){var t=this;return F.block.times(t.numBlocks()).map((function(e){t.blocks=e;for(var i=0;i<e.length;i+=1)e[i].adopt(t,t.ends[1],0);return t}))},t.createLeftOf=function(t){var i=this.replacedFragment;this.createBlocks(),e.createLeftOf.call(this,t),i&&(i.adopt(this.ends[d],0,0),i.jQ.appendTo(this.ends[d].jQ)),this.finalizeInsert(t.options),this.placeCursor(t)},t.createBlocks=function(){for(var t=this.numBlocks(),e=this.blocks=Array(t),i=0;i<t;i+=1)(e[i]=G()).adopt(this,this.ends[1],0)},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[d],(function(t,e){return t.isEmpty()?t:e})))},t.moveTowards=function(t,e,i){e.insAtDirEnd(-t,i&&this[i+"Into"]||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return _(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function i(t){var e={};return e[d]=t.jQ.offset().left,e[1]=e[d]+t.jQ.outerWidth(),e}var s=this,n=i(s);if(t<n[d])return e.insLeftOf(s);if(t>n[1])return e.insRightOf(s);var r=n[d];s.eachChild((function(o){var a=i(o);return t<a[d]?(t-r<a[d]-t?o[d]?e.insAtRightEnd(o[d]):e.insLeftOf(s):e.insAtLeftEnd(o),!1):t>a[1]?void(o[1]?r=a[1]:n[1]-t<t-a[1]?e.insRightOf(s):e.insAtRightEnd(o)):(o.seek(t,e),!1)}))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t=this.blocks,e=" mathquill-command-id="+this.id,i=this.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);h("no unmatched angle brackets",i.join("")===this.htmlTemplate);for(var s=0,n=i[0];n;n=i[s+=1])if("/>"===n.slice(-2))i[s]=n.slice(0,-2)+e+"/>";else if("<"===n.charAt(0)){h("not an unmatched top-level close tag","/"!==n.charAt(1)),i[s]=n.slice(0,-1)+e+">";var r=1;do{h("no missing close tags",n=i[s+=1]),"</"===n.slice(0,2)?r-=1:"<"===n.charAt(0)&&"/>"!==n.slice(-2)&&(r+=1)}while(r>0)}return i.join("").replace(/>&(\d+)/g,(function(e,i){return" mathquill-block-id="+t[i].id+">"+t[i].join("html")}))},t.latex=function(){return this.foldChildren(this.ctrlSeq,(function(t,e){return t+"{"+(e.latex()||" ")+"}"}))},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],(function(i,s){e+=1;var n=s.text();return i&&"("===t.textTemplate[e]&&"("===n[0]&&")"===n.slice(-1)?i+n.slice(1,-1)+t.textTemplate[e]:i+s.text()+(t.textTemplate[e]||"")}))}})),q=u(z,(function(t,e){t.init=function(t,i,s){s||(s=t&&t.length>1?t.slice(1):t),e.init.call(this,t,i,[s])},t.parser=function(){return I.succeed(this)},t.numBlocks=function(){return 0},t.replaces=function(t){t.remove()},t.createBlocks=n,t.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},t.deleteTowards=function(t,e){e[t]=this.remove()[t]},t.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},t.latex=function(){return this.ctrlSeq},t.text=function(){return this.textTemplate},t.placeCursor=n,t.isEmpty=function(){return!0}})),X=u(q,(function(t,e){t.init=function(t,i){e.init.call(this,t,"<span>"+(i||t)+"</span>")}})),U=u(q,(function(t,e){t.init=function(t,i,s){e.init.call(this,t,'<span class="mq-binary-operator">'+i+"</span>",s)}})),G=u(Y,(function(t,e){t.join=function(t){return this.foldChildren("",(function(e,i){return e+i[t]()}))},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[d]===this.ends[1]&&0!==this.ends[d]?this.ends[d].text():this.join("text")},t.keystroke=function(t,i,s){return!s.options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(i.preventDefault(),void s.escapeDir("Shift-Spacebar"===t?d:1,t,i))},t.moveOutOf=function(t,e,i){i&&this.parent[i+"Into"]||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var i=this.ends[1];if(!i||i.jQ.offset().left+i.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[d].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<i.jQ.offset().left;)i=i[d];return i.seek(t,e)},t.chToCmd=function(t,e){var i;return t.match(/^[a-eg-zA-Z]$/)?tt(t):/^\d$/.test(t)?Q(t):e&&e.typingSlashWritesDivisionSymbol&&"/"===t?v["Ã·"](t):e&&e.typingAsteriskWritesTimesSymbol&&"*"===t?v["Ã"](t):(i=x[t]||v[t])?i(t):X(t)},t.write=function(t,e){var i=this.chToCmd(e,t.options);t.selection&&i.replaces(t.replaceSelection()),i.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}}));S.StaticMath=function(t){return u(t.AbstractMathQuill,(function(e,i){this.RootBlock=G,e.__mathquillify=function(t,e){return this.config(t),i.__mathquillify.call(this,"mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){i.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=i.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}}))};var H=u(G,j);S.MathField=function(t){return u(t.EditableField,(function(t,e){this.RootBlock=H,t.__mathquillify=function(t,i){return this.config(t),i>1&&(this.__controller.root.reflow=n),e.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}}))};var J=u(g,(function(t,e){function i(t){t.jQ[0].normalize();var e=t.jQ[0].firstChild;if(e){h("only node in TextBlock span is Text node",3===e.nodeType);var i=$(e.data);return i.jQadd(e),t.children().disown(),i.adopt(t,0,0)}}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof y?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[d]&&this.ends[d].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this[1].siblingCreated&&this[1].siblingCreated(t.options,d),this[d].siblingCreated&&this[d].siblingCreated(t.options,1),this.bubble("reflow"),t.insAtRightEnd(this),this.replacedText)for(var i=0;i<this.replacedText.length;i+=1)this.write(t,this.replacedText.charAt(i))},t.parser=function(){var t=this,e=I.string,i=I.regex;return I.optWhitespace.then(e("{")).then(i(/^[^}]*/)).skip(e("}")).map((function(e){return 0===e.length?y():($(e).adopt(t,0,0),t)}))},t.textContents=function(){return this.foldChildren("",(function(t,e){return t+e.text}))},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){var t=this.textContents();return 0===t.length?"":"\\text{"+t+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=z.prototype.selectTowards,t.deleteTowards=z.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,i){if(t.show().deleteSelection(),"$"!==i)t[d]?t[d].appendText(i):$(i).createLeftOf(t);else if(this.isEmpty())t.insRightOf(this),X("\\$","$").createLeftOf(t);else if(t[1])if(t[d]){var s=J(),n=this.ends[d];n.disown().jQ.detach(),n.adopt(s,0,0),t.insLeftOf(this),e.createLeftOf.call(s,t)}else t.insLeftOf(this);else t.insRightOf(this)},t.seek=function(t,e){e.hide();var s=i(this),n=this.jQ.width()/this.text.length,r=Math.round((t-this.jQ.offset().left)/n);r<=0?e.insAtLeftEnd(this):r>=s.text.length?e.insAtRightEnd(this):e.insLeftOf(s.splitRight(r));for(var o=t-e.show().offset().left,a=o&&o<0?d:1,l=a;e[a]&&o*l>0;)e[a].moveTowards(a,e),l=o,o=t-e.offset().left;if(a*o<-a*l&&e[-a].moveTowards(-a,e),e.anticursor){if(e.anticursor.parent===this){var c=e[d]&&e[d].text.length;if(this.anticursorPosition===c)e.anticursor=m.copy(e);else{if(this.anticursorPosition<c){var h=e[d].splitRight(this.anticursorPosition);e[d]=h}else h=e[1].splitRight(this.anticursorPosition-c);e.anticursor=m(this,h[d],h)}}}else this.anticursorPosition=e[d]&&e[d].text.length},t.blur=function(t){G.prototype.blur.call(this),t&&(""===this.textContents()?(this.remove(),t[d]===this?t[d]=this[d]:t[1]===this&&(t[1]=this[1])):i(this))},t.focus=G.prototype.focus})),$=u(g,(function(t,e){function i(t,e){return e.charAt(t===d?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=f(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){p(e),1===e?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=$(this.text.slice(t)).adopt(this.parent,this,this[1]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){p(t);var s=i(-t,this.text),n=this[-t];return n?n.insTextAtDirEnd(s,t):$(s).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?1===t?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){p(t);var s=e.anticursor,n=i(-t,this.text);if(s[t]===this){var r=$(n).createDir(t,e);s[t]=r,e.insDirOf(t,r)}else{var o=this[-t];o?o.insTextAtDirEnd(n,t):(r=$(n).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ),1===this.text.length&&s[-t]===this&&(s[-t]=this[-t])}return this.deleteTowards(t,e)}}));function V(t,e,i){return u(J,{ctrlSeq:t,htmlTemplate:"<"+e+" "+i+">&0</"+e+">"})}v.text=v.textnormal=v.textrm=v.textup=v.textmd=J,v.em=v.italic=v.italics=v.emph=v.textit=v.textsl=V("\\textit","i",'class="mq-text-mode"'),v.strong=v.bold=v.textbf=V("\\textbf","b",'class="mq-text-mode"'),v.sf=v.textsf=V("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),v.tt=v.texttt=V("\\texttt","span",'class="mq-monospace mq-text-mode"'),v.textsc=V("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),v.uppercase=V("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),v.lowercase=V("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"');var W=u(z,(function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[d].cursor=this.cursor,this.ends[d].write=function(t,e){"$"!==e?G.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),X("\\$","$").createLeftOf(t.show())):t[1]?t[d]?G.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[d].latex()+"$"}})),K=u(H,(function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){var i;t.show().deleteSelection(),"$"===e?W(t).createLeftOf(t):("<"===e?i="&lt;":">"===e&&(i="&gt;"),X(e,i).createLeftOf(t))}}));S.TextField=function(t){return u(t.EditableField,(function(t,e){this.RootBlock=K,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}}))},x["\\"]=u(z,(function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[d].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[d].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[d].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?X(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))},this.ends[d].keystroke=function(t,i,s){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(s.cursor),void i.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var i=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",(function(t){return f(t.target=i).trigger(t),!1})).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[d].latex()+" "},t.renderCommand=function(t){this.jQ=this.jQ.last(),this.remove(),this[1]?t.insLeftOf(this[1]):t.insAtRightEnd(this.parent);var e=this.ends[d].latex();e||(e=" ");var i=v[e];i?(i=i(e),this._replacedFragment&&i.replaces(this._replacedFragment),i.createLeftOf(t)):((i=J()).replaces(e),i.createLeftOf(t),t.insRightOf(i),this._replacedFragment&&this._replacedFragment.remove())}})),v.notin=v.cong=v.equiv=v.oplus=v.otimes=u(U,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),v["â "]=v.ne=v.neq=c(U,"\\ne ","&ne;"),v["â"]=v.ast=v.star=v.loast=v.lowast=c(U,"\\ast ","&lowast;"),v.therefor=v.therefore=c(U,"\\therefore ","&there4;"),v.cuz=v.because=c(U,"\\because ","&#8757;"),v.prop=v.propto=c(U,"\\propto ","&prop;"),v["â"]=v.asymp=v.approx=c(U,"\\approx ","&asymp;"),v.isin=v.in=c(U,"\\in ","&isin;"),v.ni=v.contains=c(U,"\\ni ","&ni;"),v.notni=v.niton=v.notcontains=v.doesnotcontain=c(U,"\\not\\ni ","&#8716;"),v.sub=v.subset=c(U,"\\subset ","&sub;"),v.sup=v.supset=v.superset=c(U,"\\supset ","&sup;"),v.nsub=v.notsub=v.nsubset=v.notsubset=c(U,"\\not\\subset ","&#8836;"),v.nsup=v.notsup=v.nsupset=v.notsupset=v.nsuperset=v.notsuperset=c(U,"\\not\\supset ","&#8837;"),v.sube=v.subeq=v.subsete=v.subseteq=c(U,"\\subseteq ","&sube;"),v.supe=v.supeq=v.supsete=v.supseteq=v.supersete=v.superseteq=c(U,"\\supseteq ","&supe;"),v.nsube=v.nsubeq=v.notsube=v.notsubeq=v.nsubsete=v.nsubseteq=v.notsubsete=v.notsubseteq=c(U,"\\not\\subseteq ","&#8840;"),v.nsupe=v.nsupeq=v.notsupe=v.notsupeq=v.nsupsete=v.nsupseteq=v.notsupsete=v.notsupseteq=v.nsupersete=v.nsuperseteq=v.notsupersete=v.notsuperseteq=c(U,"\\not\\supseteq ","&#8841;"),v.N=v.naturals=v.Naturals=c(X,"\\mathbb{N}","&#8469;"),v.P=v.primes=v.Primes=v.projective=v.Projective=v.probability=v.Probability=c(X,"\\mathbb{P}","&#8473;"),v.Z=v.integers=v.Integers=c(X,"\\mathbb{Z}","&#8484;"),v.Q=v.rationals=v.Rationals=c(X,"\\mathbb{Q}","&#8474;"),v.R=v.reals=v.Reals=c(X,"\\mathbb{R}","&#8477;"),v.C=v.complex=v.Complex=v.complexes=v.Complexes=v.complexplane=v.Complexplane=v.ComplexPlane=c(X,"\\mathbb{C}","&#8450;"),v.H=v.Hamiltonian=v.quaternions=v.Quaternions=c(X,"\\mathbb{H}","&#8461;"),v.quad=v.emsp=c(X,"\\quad ","    "),v.qquad=c(X,"\\qquad ","        "),v.diamond=c(X,"\\diamond ","&#9671;"),v.bigtriangleup=c(X,"\\bigtriangleup ","&#9651;"),v.ominus=c(X,"\\ominus ","&#8854;"),v.uplus=c(X,"\\uplus ","&#8846;"),v.bigtriangledown=c(X,"\\bigtriangledown ","&#9661;"),v.sqcap=c(X,"\\sqcap ","&#8851;"),v.triangleleft=c(X,"\\triangleleft ","&#8882;"),v.sqcup=c(X,"\\sqcup ","&#8852;"),v.triangleright=c(X,"\\triangleright ","&#8883;"),v.odot=v.circledot=c(X,"\\odot ","&#8857;"),v.bigcirc=c(X,"\\bigcirc ","&#9711;"),v.dagger=c(X,"\\dagger ","&#0134;"),v.ddagger=c(X,"\\ddagger ","&#135;"),v.wr=c(X,"\\wr ","&#8768;"),v.amalg=c(X,"\\amalg ","&#8720;"),v.models=c(X,"\\models ","&#8872;"),v.prec=c(X,"\\prec ","&#8826;"),v.succ=c(X,"\\succ ","&#8827;"),v.preceq=c(X,"\\preceq ","&#8828;"),v.succeq=c(X,"\\succeq ","&#8829;"),v.simeq=c(X,"\\simeq ","&#8771;"),v.mid=c(X,"\\mid ","&#8739;"),v.ll=c(X,"\\ll ","&#8810;"),v.gg=c(X,"\\gg ","&#8811;"),v.parallel=c(X,"\\parallel ","&#8741;"),v.nparallel=c(X,"\\nparallel ","&#8742;"),v.bowtie=c(X,"\\bowtie ","&#8904;"),v.sqsubset=c(X,"\\sqsubset ","&#8847;"),v.sqsupset=c(X,"\\sqsupset ","&#8848;"),v.smile=c(X,"\\smile ","&#8995;"),v.sqsubseteq=c(X,"\\sqsubseteq ","&#8849;"),v.sqsupseteq=c(X,"\\sqsupseteq ","&#8850;"),v.doteq=c(X,"\\doteq ","&#8784;"),v.frown=c(X,"\\frown ","&#8994;"),v.vdash=c(X,"\\vdash ","&#8870;"),v.dashv=c(X,"\\dashv ","&#8867;"),v.nless=c(X,"\\nless ","&#8814;"),v.ngtr=c(X,"\\ngtr ","&#8815;"),v.longleftarrow=c(X,"\\longleftarrow ","&#8592;"),v.longrightarrow=c(X,"\\longrightarrow ","&#8594;"),v.Longleftarrow=c(X,"\\Longleftarrow ","&#8656;"),v.Longrightarrow=c(X,"\\Longrightarrow ","&#8658;"),v.longleftrightarrow=c(X,"\\longleftrightarrow ","&#8596;"),v.updownarrow=c(X,"\\updownarrow ","&#8597;"),v.Longleftrightarrow=c(X,"\\Longleftrightarrow ","&#8660;"),v.Updownarrow=c(X,"\\Updownarrow ","&#8661;"),v.mapsto=c(X,"\\mapsto ","&#8614;"),v.nearrow=c(X,"\\nearrow ","&#8599;"),v.hookleftarrow=c(X,"\\hookleftarrow ","&#8617;"),v.hookrightarrow=c(X,"\\hookrightarrow ","&#8618;"),v.searrow=c(X,"\\searrow ","&#8600;"),v.leftharpoonup=c(X,"\\leftharpoonup ","&#8636;"),v.rightharpoonup=c(X,"\\rightharpoonup ","&#8640;"),v.swarrow=c(X,"\\swarrow ","&#8601;"),v.leftharpoondown=c(X,"\\leftharpoondown ","&#8637;"),v.rightharpoondown=c(X,"\\rightharpoondown ","&#8641;"),v.nwarrow=c(X,"\\nwarrow ","&#8598;"),v.ldots=c(X,"\\ldots ","&#8230;"),v.cdots=c(X,"\\cdots ","&#8943;"),v.vdots=c(X,"\\vdots ","&#8942;"),v.ddots=c(X,"\\ddots ","&#8945;"),v.surd=c(X,"\\surd ","&#8730;"),v.triangle=c(X,"\\triangle ","&#9651;"),v.ell=c(X,"\\ell ","&#8467;"),v.top=c(X,"\\top ","&#8868;"),v.flat=c(X,"\\flat ","&#9837;"),v.natural=c(X,"\\natural ","&#9838;"),v.sharp=c(X,"\\sharp ","&#9839;"),v.wp=c(X,"\\wp ","&#8472;"),v.bot=c(X,"\\bot ","&#8869;"),v.clubsuit=c(X,"\\clubsuit ","&#9827;"),v.diamondsuit=c(X,"\\diamondsuit ","&#9826;"),v.heartsuit=c(X,"\\heartsuit ","&#9825;"),v.spadesuit=c(X,"\\spadesuit ","&#9824;"),v.parallelogram=c(X,"\\parallelogram ","&#9649;"),v.square=c(X,"\\square ","&#11036;"),v.oint=c(X,"\\oint ","&#8750;"),v.bigcap=c(X,"\\bigcap ","&#8745;"),v.bigcup=c(X,"\\bigcup ","&#8746;"),v.bigsqcup=c(X,"\\bigsqcup ","&#8852;"),v.bigvee=c(X,"\\bigvee ","&#8744;"),v.bigwedge=c(X,"\\bigwedge ","&#8743;"),v.bigodot=c(X,"\\bigodot ","&#8857;"),v.bigotimes=c(X,"\\bigotimes ","&#8855;"),v.bigoplus=c(X,"\\bigoplus ","&#8853;"),v.biguplus=c(X,"\\biguplus ","&#8846;"),v.lfloor=c(X,"\\lfloor ","&#8970;"),v.rfloor=c(X,"\\rfloor ","&#8971;"),v.lceil=c(X,"\\lceil ","&#8968;"),v.rceil=c(X,"\\rceil ","&#8969;"),v.opencurlybrace=v.lbrace=c(X,"\\lbrace ","{"),v.closecurlybrace=v.rbrace=c(X,"\\rbrace ","}"),v.lbrack=c(X,"["),v.rbrack=c(X,"]"),v.slash=c(X,"/"),v.vert=c(X,"|"),v.perp=v.perpendicular=c(X,"\\perp ","&perp;"),v.nabla=v.del=c(X,"\\nabla ","&nabla;"),v.hbar=c(X,"\\hbar ","&#8463;"),v.AA=v.Angstrom=v.angstrom=c(X,"\\text\\AA ","&#8491;"),v.ring=v.circ=v.circle=c(X,"\\circ ","&#8728;"),v.bull=v.bullet=c(X,"\\bullet ","&bull;"),v.setminus=v.smallsetminus=c(X,"\\setminus ","&#8726;"),v.not=v["Â¬"]=v.neg=c(X,"\\neg ","&not;"),v["â¦"]=v.dots=v.ellip=v.hellip=v.ellipsis=v.hellipsis=c(X,"\\dots ","&hellip;"),v.converges=v.darr=v.dnarr=v.dnarrow=v.downarrow=c(X,"\\downarrow ","&darr;"),v.dArr=v.dnArr=v.dnArrow=v.Downarrow=c(X,"\\Downarrow ","&dArr;"),v.diverges=v.uarr=v.uparrow=c(X,"\\uparrow ","&uarr;"),v.uArr=v.Uparrow=c(X,"\\Uparrow ","&uArr;"),v.to=c(U,"\\to ","&rarr;"),v.rarr=v.rightarrow=c(X,"\\rightarrow ","&rarr;"),v.implies=c(U,"\\Rightarrow ","&rArr;"),v.rArr=v.Rightarrow=c(X,"\\Rightarrow ","&rArr;"),v.gets=c(U,"\\gets ","&larr;"),v.larr=v.leftarrow=c(X,"\\leftarrow ","&larr;"),v.impliedby=c(U,"\\Leftarrow ","&lArr;"),v.lArr=v.Leftarrow=c(X,"\\Leftarrow ","&lArr;"),v.harr=v.lrarr=v.leftrightarrow=c(X,"\\leftrightarrow ","&harr;"),v.iff=c(U,"\\Leftrightarrow ","&hArr;"),v.hArr=v.lrArr=v.Leftrightarrow=c(X,"\\Leftrightarrow ","&hArr;"),v.Re=v.Real=v.real=c(X,"\\Re ","&real;"),v.Im=v.imag=v.image=v.imagin=v.imaginary=v.Imaginary=c(X,"\\Im ","&image;"),v.part=v.partial=c(X,"\\partial ","&part;"),v.infty=v.infin=v.infinity=c(X,"\\infty ","&infin;"),v.alef=v.alefsym=v.aleph=v.alephsym=c(X,"\\aleph ","&alefsym;"),v.xist=v.xists=v.exist=v.exists=c(X,"\\exists ","&exist;"),v.nexists=v.nexist=c(X,"\\nexists ","&#8708;"),v.and=v.land=v.wedge=c(X,"\\wedge ","&and;"),v.or=v.lor=v.vee=c(X,"\\vee ","&or;"),v.o=v.O=v.empty=v.emptyset=v.oslash=v.Oslash=v.nothing=v.varnothing=c(U,"\\varnothing ","&empty;"),v.cup=v.union=c(U,"\\cup ","&cup;"),v.cap=v.intersect=v.intersection=c(U,"\\cap ","&cap;"),v.deg=v.degree=c(X,"\\degree ","&deg;"),v.ang=v.angle=c(X,"\\angle ","&ang;"),v.measuredangle=c(X,"\\measuredangle ","&#8737;");var Q=u(X,(function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[d]instanceof Z&&!1!==t[d].isItalic||t[d]instanceof vt&&t[d][d]instanceof Z&&!1!==t[d][d].isItalic)?(v._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}})),Z=u(q,(function(t,e){t.init=function(t,i){e.init.call(this,t,"<var>"+(i||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return this.isPartOfOperator?"\\"==t[0]?t=t.slice(1,t.length):" "==t[t.length-1]&&(t=t.slice(0,-1)):(!this[d]||this[d]instanceof Z||this[d]instanceof U||"\\ "===this[d].ctrlSeq||(t="*"+t),!this[1]||this[1]instanceof U||this[1]instanceof vt||(t+="*")),t}}));P.p.autoCommands={_maxLength:0},k.autoCommands=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),i={},n=0,r=0;r<e.length;r+=1){var o=e[r];if(o.length<2)throw'autocommand "'+o+'" not minimum length of 2';if(v[o]===nt)throw'"'+o+'" is a built-in operator name';i[o]=1,n=s(n,o.length)}return i._maxLength=n,i};var tt=u(Z,(function(t,e){function s(t){return!t||t instanceof U||t instanceof Ct}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments);var i=t.options.autoCommands,s=i._maxLength;if(s>0){for(var n="",r=this,o=0;r instanceof tt&&r.ctrlSeq===r.letter&&o<s;)n=r.letter+n,r=r[d],o+=1;for(;n.length;){if(i.hasOwnProperty(n)){for(o=1,r=this;o<n.length;o+=1,r=r[d]);return y(r,this).remove(),t[d]=r[d],v[n](n).createLeftOf(t)}n=n.slice(1)}}},t.italicize=function(t){return this.isItalic=t,this.isPartOfOperator=!t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==d&&this[1]instanceof tt||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e=t.autoOperatorNames;if(0!==e._maxLength){for(var n=this.letter,r=this[d];r instanceof tt;r=r[d])n=r.letter+n;for(var o=this[1];o instanceof tt;o=o[1])n+=o.letter;y(r[1]||this.parent.ends[d],o[d]||this.parent.ends[1]).each((function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last mq-followed-by-supsub"),t.ctrlSeq=t.letter}));t:for(var a=0,l=r[1]||this.parent.ends[d];a<n.length;a+=1,l=l[1])for(var c=i(e._maxLength,n.length-a);c>0;c-=1){var h=n.slice(a,a+c);if(e.hasOwnProperty(h)){for(var u=0,p=l;u<c;u+=1,p=p[1]){p.italicize(!1);var f=p}var m=et.hasOwnProperty(h);if(l.ctrlSeq=(m?"\\":"\\operatorname{")+l.ctrlSeq,f.ctrlSeq+=m?" ":"}",st.hasOwnProperty(h)&&f[d][d][d].jQ.addClass("mq-last"),s(l[d])||l.jQ.addClass("mq-first"),!s(f[1]))if(f[1]instanceof vt){var g=f[1];(g.siblingCreated=g.siblingDeleted=function(){g.jQ.toggleClass("mq-after-operator-name",!(g[1]instanceof Tt))})()}else f.jQ.toggleClass("mq-last",!(f[1]instanceof Tt));a+=c-1,l=f;continue t}}}}})),et={},it=P.p.autoOperatorNames={_maxLength:9},st={limsup:1,liminf:1,projlim:1,injlim:1};!function(){for(var t="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),e=0;e<t.length;e+=1)et[t[e]]=it[t[e]]=1;var i="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");for(e=0;e<i.length;e+=1)et[i[e]]=1;var s="sin cos tan sec cosec csc cotan cot ctg".split(" ");for(e=0;e<s.length;e+=1)it[s[e]]=it["arc"+s[e]]=it[s[e]+"h"]=it["ar"+s[e]+"h"]=it["arc"+s[e]+"h"]=1;var n="gcf hcf lcm proj span".split(" ");for(e=0;e<n.length;e+=1)it[n[e]]=1}(),k.autoOperatorNames=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),i={},n=0,r=0;r<e.length;r+=1){var o=e[r];if(o.length<2)throw'"'+o+'" not minimum length of 2';i[o]=1,n=s(n,o.length)}return i._maxLength=n,i};var nt=u(q,(function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){for(var e=this.ctrlSeq,i=0;i<e.length;i+=1)tt(e.charAt(i)).createLeftOf(t)},t.parser=function(){for(var t=this.ctrlSeq,e=G(),i=0;i<t.length;i+=1)tt(t.charAt(i)).adopt(e,e.ends[1],0);return I.succeed(e.children())}}));for(var rt in it)it.hasOwnProperty(rt)&&(v[rt]=nt);v.operatorname=u(z,(function(t){t.createLeftOf=n,t.numBlocks=function(){return 1},t.parser=function(){return F.block.map((function(t){return t.children()}))}})),v.f=u(tt,(function(t,e){t.init=function(){q.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}})),v[" "]=v.space=c(X,"\\ ","&nbsp;"),v["'"]=v.prime=c(X,"'","&prime;"),v["â³"]=v.dprime=c(X,"â³","&Prime;"),v.backslash=c(X,"\\backslash ","\\"),x["\\"]||(x["\\"]=v.backslash),v.$=c(X,"\\$","$");var ot=u(q,(function(t,e){t.init=function(t,i){e.init.call(this,t,'<span class="mq-nonSymbola">'+(i||t)+"</span>")}}));v["@"]=ot,v["&"]=c(ot,"\\&","&amp;"),v["%"]=c(ot,"\\%","%"),v.alpha=v.beta=v.gamma=v.delta=v.zeta=v.eta=v.theta=v.iota=v.kappa=v.mu=v.nu=v.xi=v.rho=v.sigma=v.tau=v.chi=v.psi=v.omega=u(Z,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),v.phi=c(Z,"\\phi ","&#981;"),v.phiv=v.varphi=c(Z,"\\varphi ","&phi;"),v.epsilon=c(Z,"\\epsilon ","&#1013;"),v.epsiv=v.varepsilon=c(Z,"\\varepsilon ","&epsilon;"),v.piv=v.varpi=c(Z,"\\varpi ","&piv;"),v.sigmaf=v.sigmav=v.varsigma=c(Z,"\\varsigma ","&sigmaf;"),v.thetav=v.vartheta=v.thetasym=c(Z,"\\vartheta ","&thetasym;"),v.upsilon=v.upsi=c(Z,"\\upsilon ","&upsilon;"),v.gammad=v.Gammad=v.digamma=c(Z,"\\digamma ","&#989;"),v.kappav=v.varkappa=c(Z,"\\varkappa ","&#1008;"),v.rhov=v.varrho=c(Z,"\\varrho ","&#1009;"),v.pi=v["Ï"]=c(ot,"\\pi ","&pi;"),v.lambda=c(ot,"\\lambda ","&lambda;"),v.Upsilon=v.Upsi=v.upsih=v.Upsih=c(q,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),v.Gamma=v.Delta=v.Theta=v.Lambda=v.Xi=v.Pi=v.Sigma=v.Phi=v.Psi=v.Omega=v.forall=u(X,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}));var at=u(z,(function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=F.parse(this.latex);e.children().adopt(t.parent,t[d],t[1]),t[d]=e.ends[1],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[1][1].siblingCreated&&e.ends[1][1].siblingCreated(t.options,d),e.ends[d][d].siblingCreated&&e.ends[d][d].siblingCreated(t.options,1),t.parent.bubble("reflow")},t.parser=function(){var t=F.parse(this.latex).children();return I.succeed(t)}}));v["Â¹"]=c(at,"^1"),v["Â²"]=c(at,"^2"),v["Â³"]=c(at,"^3"),v["Â¼"]=c(at,"\\frac14"),v["Â½"]=c(at,"\\frac12"),v["Â¾"]=c(at,"\\frac34");var lt=u(U,(function(t){t.init=X.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(1!==e)return this.jQ[0].className=function t(e){return e[d]?e[d]instanceof U||/^[,;:\(\[]$/.test(e[d].ctrlSeq)?"":"mq-binary-operator":e.parent&&e.parent.parent&&e.parent.parent.isStyleBlock()?t(e.parent.parent):""}(this),this}}));v["+"]=c(lt,"+","+"),v["â"]=v["-"]=c(lt,"-","&minus;"),v["Â±"]=v.pm=v.plusmn=v.plusminus=c(lt,"\\pm ","&plusmn;"),v.mp=v.mnplus=v.minusplus=c(lt,"\\mp ","&#8723;"),x["*"]=v.sdot=v.cdot=c(U,"\\cdot ","&middot;","*");var ct=u(U,(function(t,e){t.init=function(t,i){this.data=t,this.strict=i;var s=i?"Strict":"";e.init.call(this,t["ctrlSeq"+s],t["html"+s],t["text"+s])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,i){if(t===d&&!this.strict)return this.swap(!0),void this.bubble("reflow");e.deleteTowards.apply(this,arguments)}})),ht={ctrlSeq:"\\le ",html:"&le;",text:"â¤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},ut={ctrlSeq:"\\ge ",html:"&ge;",text:"â¥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"};v["<"]=v.lt=c(ct,ht,!0),v[">"]=v.gt=c(ct,ut,!0),v["â¤"]=v.le=v.leq=c(ct,ht,!1),v["â¥"]=v.ge=v.geq=c(ct,ut,!1);var dt=u(U,(function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){if(t[d]instanceof ct&&t[d].strict)return t[d].swap(!1),void t[d].bubble("reflow");e.createLeftOf.apply(this,arguments)}}));v["="]=dt,v["Ã"]=v.times=c(U,"\\times ","&times;","[x]"),v["Ã·"]=v.div=v.divide=v.divides=c(U,"\\div ","&divide;","[/]"),x["~"]=v.sim=c(U,"\\sim ","~","~");var pt,ft,mt=n,gt=document.createElement("div").style;for(var bt in{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(bt in gt){ft=bt;break}ft?pt=function(t,e,i){t.css(ft,"scale("+e+","+i+")")}:"filter"in gt?(mt=function(t){t.className=t.className},pt=function(t,e,i){e/=1+(i-1)/2,t.css("fontSize",i+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>');var s=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')");function n(){t.css("marginRight",(s.width()-1)*(e-1)/e+"px")}n();var r=setInterval(n);f(window).load((function(){clearTimeout(r),n()}))}):pt=function(t,e,i){t.css("fontSize",i+"em")};var yt=u(z,(function(t,e){t.init=function(t,i,s){e.init.call(this,t,"<"+i+" "+s+">&0</"+i+">")}}));v.mathrm=c(yt,"\\mathrm","span",'class="mq-roman mq-font"'),v.mathit=c(yt,"\\mathit","i",'class="mq-font"'),v.mathbf=c(yt,"\\mathbf","b",'class="mq-font"'),v.mathsf=c(yt,"\\mathsf","span",'class="mq-sans-serif mq-font"'),v.mathtt=c(yt,"\\mathtt","span",'class="mq-monospace mq-font"'),v.underline=c(yt,"\\underline","span",'class="mq-non-leaf mq-underline"'),v.overline=v.bar=c(yt,"\\overline","span",'class="mq-non-leaf mq-overline"'),v.overrightarrow=c(yt,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),v.overleftarrow=c(yt,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),v.textcolor=u(z,(function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,i=I.string,s=I.regex;return I.optWhitespace.then(i("{")).then(s(/^[#\w\s.,()%-]*/)).skip(i("}")).then((function(i){return t.setColor(i),e.parser.call(t)}))},t.isStyleBlock=function(){return!0}})),v.class=u(z,(function(t,e){t.parser=function(){var t=this,i=I.string,s=I.regex;return I.optWhitespace.then(i("{")).then(s(/^[-\w\s\\\xA0-\xFF]*/)).skip(i("}")).then((function(i){return t.cls=i||"",t.htmlTemplate='<span class="mq-class '+i+'">&0</span>',e.parser.call(t)}))},t.latex=function(){return"\\class{"+this.cls+"}{"+this.blocks[0].latex()+"}"},t.isStyleBlock=function(){return!0}}));var vt=u(z,(function(t,i){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(this.replacedFragment||t[d]||!t.options.supSubsRequireOperand)return i.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){for(var e=d;e;e=e===d&&1)if(this[e]instanceof vt){for(var i="sub";i;i="sub"===i&&"sup"){var s=this[i],n=this[e][i];if(s){if(n)if(s.isEmpty())o=m(n,0,n.ends[d]);else{s.jQ.children().insAtDirEnd(-e,n.jQ);var r=s.children().disown(),o=m(n,r.ends[1],n.ends[d]);e===d?r.adopt(n,n.ends[1],0):r.adopt(n,0,n.ends[d])}else this[e].addBlock(s.disown());this.placeCursor=function(t,i){return function(s){s.insAtDirEnd(-e,t||i)}}(n,s)}}this.remove(),t&&t[d]===this&&(1===e&&o?o[d]?t.insRightOf(o[d]):t.insAtLeftEnd(o.parent):t.insRightOf(this[e]));break}},P.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[d].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var i=this.chToCmd(e,t.options);return i instanceof q?t.deleteSelection():t.clearSelection().insRightOf(this.parent),i.createLeftOf(t.show())}t[d]&&!t[1]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),G.p.write.apply(this,arguments)}},t.moveTowards=function(t,e,s){e.options.autoSubscriptNumerals&&!this.sup?e.insDirOf(t,this):i.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,e){if(e.options.autoSubscriptNumerals&&this.sub){var s=this.sub.ends[-t];s instanceof q?s.remove():s&&s.deleteTowards(t,e.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(d,e.insAtLeftEnd(this.sub)),this.sup&&e.insDirOf(-t,this))}else i.deleteTowards.apply(this,arguments)},t.latex=function(){function t(t,e){var i=e&&e.latex();return e?t+(1===i.length?i:"{"+(i||" ")+"}"):""}return t("_",this.sub)+t("^",this.sup)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=f('<span class="mq-sup"/>').append(t.jQ.children()).attr(e,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=f('<span class="mq-sub"></span>').append(t.jQ.children()).attr(e,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var i=0;i<2;i+=1)!function(t,e,i,s){t[e].deleteOutOf=function(n,r){if(r.insDirOf(this[n]?-n:n,this.parent),!this.isEmpty()){var o=this.ends[n];this.children().disown().withDirAdopt(n,r.parent,r[n],r[-n]).jQ.insDirOf(-n,r.jQ),r[-n]=o}t.supsub=i,delete t[e],delete t[s+"Into"],t[i][s+"OutOf"]=xt,delete t[i].deleteOutOf,"sub"===e&&f(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[i],"sup sub".split(" ")[i],"down up".split(" ")[i])}}));function xt(t){var e=this.parent,i=t;do{if(i[1])return t.insLeftOf(e);i=i.parent.parent}while(i!==e);t.insRightOf(e)}v.subscript=v._=u(vt,(function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[d],this.sub.upOutOf=xt,e.finalizeTree.call(this)}})),v.superscript=v.supscript=v["^"]=u(vt,(function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[1],this.sup.downOutOf=xt,e.finalizeTree.call(this)}}));var Ct=u(z,(function(t,e){t.init=function(t,e){q.prototype.init.call(this,t,'<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>')},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(tt("n").createLeftOf(t),dt().createLeftOf(t))},t.latex=function(){function t(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+t(this.ends[d].latex())+"^"+t(this.ends[1].latex())},t.parser=function(){for(var t=I.string,e=I.optWhitespace,i=I.succeed,s=F.block,n=this,r=n.blocks=[G(),G()],o=0;o<r.length;o+=1)r[o].adopt(n,n.ends[1],0);return e.then(t("_").or(t("^"))).then((function(t){var e=r["_"===t?0:1];return s.then((function(t){return t.children().adopt(e,e.ends[1],0),i(n)}))})).many().result(n)},t.finalizeTree=function(){this.downInto=this.ends[d],this.upInto=this.ends[1],this.ends[d].upOutOf=this.ends[1],this.ends[1].downOutOf=this.ends[d]}}));v["â"]=v.sum=v.summation=c(Ct,"\\sum ","&sum;"),v["â"]=v.prod=v.product=c(Ct,"\\prod ","&prod;"),v.coprod=v.coproduct=c(Ct,"\\coprod ","&#8720;"),v["â«"]=v.int=v.integral=u(Ct,(function(t,e){t.init=function(){q.prototype.init.call(this,"\\int ",'<span class="mq-int mq-non-leaf"><big>&int;</big><span class="mq-supsub mq-non-leaf"><span class="mq-sup"><span class="mq-sup-inner">&1</span></span><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>')},t.createLeftOf=z.p.createLeftOf}));var _t=v.frac=v.dfrac=v.cfrac=v.fraction=u(z,(function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[1].upOutOf=this.ends[d],this.downInto=this.ends[d].downOutOf=this.ends[1]}})),wt=v.over=x["/"]=u(_t,(function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var i=t[d];i&&!(i instanceof U||i instanceof(v.text||n)||i instanceof Ct||"\\ "===i.ctrlSeq||/^[,;:]$/.test(i.ctrlSeq));)i=i[d];i instanceof Ct&&i[1]instanceof vt&&(i=i[1])[1]instanceof vt&&i[1].ctrlSeq!=i.ctrlSeq&&(i=i[1]),i!==t[d]&&(this.replaces(y(i[1]||t.parent.ends[d],t[d])),t[d]=i)}e.createLeftOf.call(this,t)}})),St=v.sqrt=v["â"]=u(z,(function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return F.optBlock.then((function(t){return F.block.map((function(e){var i=Pt();return i.blocks=[t,e],t.adopt(i,0,0),e.adopt(i,t,0),i}))})).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[1].jQ;pt(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}})),Pt=(v.hat=u(z,(function(t,e){t.ctrlSeq="\\hat",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-hat-prefix">^</span><span class="mq-hat-stem">&0</span></span>',t.textTemplate=["hat(",")"]})),v.nthroot=u(St,(function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[d].latex()+"]{"+this.ends[1].latex()+"}"}}))),kt=u(z,(function(t,e){t.init=function(t,i,s){e.init.call(this,t,'<span class="mq-non-leaf"><span class="mq-diacritic-above">'+i+'</span><span class="mq-diacritic-stem">&0</span></span>',s)}}));function Et(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));pt(this.delimjQs,i(1+.2*(t-1),1.2),1.2*t)}}v.vec=c(kt,"\\vec","&rarr;",["vec(",")"]),v.tilde=c(kt,"\\tilde","~",["tilde(",")"]);var Tt=u(u(z,Et),(function(t,e){t.init=function(t,i,s,n,r){e.init.call(this,"\\left"+n,void 0,[i,s]),this.side=t,this.sides={},this.sides[d]={ch:i,ctrlSeq:n},this.sides[1]={ch:s,ctrlSeq:r}},t.numBlocks=function(){return 1},t.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(1===this.side?" mq-ghost":"")+'">'+this.sides[d].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===d?" mq-ghost":"")+'">'+this.sides[1].ch+"</span></span>",e.html.call(this)},t.latex=function(){return"\\left"+this.sides[d].ctrlSeq+this.ends[d].latex()+"\\right"+this.sides[1].ctrlSeq},t.matchBrack=function(t,e,i){return i instanceof Tt&&i.side&&i.side!==-e&&(!t.restrictMismatchedBrackets||At[this.sides[this.side].ch]===i.sides[i.side].ch||{"(":"]","[":")"}[this.sides[d].ch]===i.sides[1].ch)&&i},t.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===d?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},t.createLeftOf=function(t){if(!this.replacedFragment){var i=t.options;if("|"===this.sides[d].ch)var s=this.matchBrack(i,1,t[1])||this.matchBrack(i,d,t[d])||this.matchBrack(i,0,t.parent.parent);else s=this.matchBrack(i,-this.side,t[-this.side])||this.matchBrack(i,-this.side,t.parent.parent)}if(s){var n=this.side=-s.side;this.closeOpposing(s),s===t.parent.parent&&t[n]&&y(t[n],t.parent.ends[n],-n).disown().withDirAdopt(-n,s.parent,s,s[n]).jQ.insDirOf(n,s.jQ),s.bubble("reflow")}else n=(s=this).side,s.replacedFragment?s.side=0:t[-n]&&(s.replaces(y(t[-n],t.parent.ends[-n],n)),t[-n]=0),e.createLeftOf.call(s,t);n===d?t.insAtLeftEnd(s.ends[d]):t.insRightOf(s)},t.placeCursor=n,t.unwrap=function(){this.ends[d].children().disown().adopt(this.parent,this,this[1]).jQ.insertAfter(this.jQ),this.remove()},t.deleteSide=function(t,e,i){var s=this.parent,n=this[t],r=s.ends[t];if(t===this.side)return this.unwrap(),void(n?i.insDirOf(-t,n):i.insAtDirEnd(t,s));var o=i.options,a=!this.side;if(this.side=-t,this.matchBrack(o,t,this.ends[d].ends[this.side])){this.closeOpposing(this.ends[d].ends[this.side]);var l=this.ends[d].ends[t];this.unwrap(),l.siblingCreated&&l.siblingCreated(i.options,t),n?i.insDirOf(-t,n):i.insAtDirEnd(t,s)}else{if(this.matchBrack(o,t,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(e&&a)return this.unwrap(),void(n?i.insDirOf(-t,n):i.insAtDirEnd(t,s));this.sides[t]={ch:At[this.sides[this.side].ch],ctrlSeq:At[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===d?0:1).addClass("mq-ghost").html(this.sides[t].ch)}n?(l=this.ends[d].ends[t],y(n,r,-t).disown().withDirAdopt(-t,this.ends[d],l,0).jQ.insAtDirEnd(t,this.ends[d].jQ.removeClass("mq-empty")),l.siblingCreated&&l.siblingCreated(i.options,t),i.insDirOf(-t,n)):e?i.insDirOf(t,this):i.insAtDirEnd(t,this.ends[d])}},t.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},t.finalizeTree=function(){this.ends[d].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===d?1:0).removeClass("mq-ghost"),this.side=0}},t.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}})),At={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "};function Ot(t,e){var i=At[t],s=At[e=e||t];x[t]=c(Tt,d,t,i,e,s),x[i]=c(Tt,1,t,i,e,s)}Ot("("),Ot("["),Ot("{","\\{"),v.langle=c(Tt,d,"&lang;","&rang;","\\langle ","\\rangle "),v.rangle=c(Tt,1,"&lang;","&rang;","\\langle ","\\rangle "),x["|"]=c(Tt,d,"|","|","|","|"),v.lVert=c(Tt,d,"&#8741;","&#8741;","\\lVert ","\\rVert "),v.rVert=c(Tt,1,"&#8741;","&#8741;","\\lVert ","\\rVert "),v.left=u(z,(function(t){t.parser=function(){var t=I.regex,e=I.string,i=I.optWhitespace;return i.then(t(/^(?:[([|]|\\\{|\\langle\b|\\lVert\b)/)).then((function(s){var n="\\"===s.charAt(0)?s.slice(1):s;return"\\langle"==s&&(n="&lang;",s+=" "),"\\lVert"==s&&(n="&#8741;",s+=" "),F.then((function(r){return e("\\right").skip(i).then(t(/^(?:[\])|]|\\\}|\\rangle\b|\\rVert\b)/)).map((function(t){var e="\\"===t.charAt(0)?t.slice(1):t;"\\rangle"==t&&(e="&rang;",t+=" "),"\\rVert"==t&&(e="&#8741;",t+=" ");var i=Tt(0,n,e,s,t);return i.blocks=[r],r.adopt(i,0,0),i}))}))}))}})),v.right=u(z,(function(t){t.parser=function(){return I.fail("unmatched \\right")}}));var Mt=v.binom=v.binomial=u(u(z,Et),(function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]}));v.choose=u(Mt,(function(t){t.createLeftOf=wt.prototype.createLeftOf})),v.editable=v.MathQuillMathField=u(z,(function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,i=I.string,s=I.regex,n=I.succeed;return i("[").then(s(/^[a-z][a-z0-9]*/i)).skip(i("]")).map((function(e){t.name=e})).or(n()).then(e.parser.call(t))},t.finalizeTree=function(t){var e=w(this.ends[d],this.jQ,t);e.KIND_OF_MQ="MathField",e.editable=!0,e.createTextarea(),e.editablesTextareaEvents(),e.cursor.insAtRightEnd(e.root),j(e.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[d].controller))},t.latex=function(){return this.ends[d].latex()},t.text=function(){return this.ends[d].text()}}));var Nt=v.embed=u(q,(function(t,e){t.setOptions=function(t){function e(){return""}return this.text=t.text||e,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||e,this},t.parser=function(){var t=this,e=I.string,i=I.regex,s=I.succeed;return e("{").then(i(/^[a-z][a-z0-9]*/i)).skip(e("}")).then((function(n){return e("[").then(i(/^[-\w\s]*/)).skip(e("]")).or(s()).map((function(e){return t.setOptions(T[n](e))}))}))}})),Lt=L(1);for(var Dt in Lt)!function(t,e){"function"==typeof e?(O[t]=function(){return A(),e.apply(this,arguments)}).prototype=e.prototype:O[t]=e}(Dt,Lt[Dt])}(),function(t,e){"use strict";function i(){var t=P.splice(0,P.length);for(Kt=0;t.length;)t.shift().call(null,t.shift())}function s(t,e){for(var i=0,s=t.length;i<s;i++)f(t[i],e)}function n(t){return function(e){Rt(e)&&(f(e,t),rt.length&&s(e.querySelectorAll(rt),t))}}function r(t){var e=qt.call(t,"is"),i=t.nodeName.toUpperCase(),s=at.call(st,e?tt+e.toUpperCase():Z+i);return e&&-1<s&&!o(i,e)?-1:s}function o(t,e){return-1<rt.indexOf(t+'[is="'+e+'"]')}function a(t){var e=t.currentTarget,i=t.attrChange,s=t.attrName,n=t.target,r=t[$]||2,o=t[V]||3;!se||n&&n!==e||!e[q]||"style"===s||t.prevValue===t.newValue&&(""!==t.newValue||i!==r&&i!==o)||e[q](s,i===r?null:t.prevValue,i===o?null:t.newValue)}function l(t){var e=n(t);return function(t){P.push(e,t.target),Kt&&clearTimeout(Kt),Kt=setTimeout(i,1)}}function c(t){ie&&(ie=!1,t.currentTarget.removeEventListener(K,c)),rt.length&&s((t.target||_).querySelectorAll(rt),t.detail===Y?Y:B),Dt&&function(){for(var t,e=0,i=It.length;e<i;e++)ot.contains(t=It[e])||(i--,It.splice(e--,1),f(t,Y))}()}function h(t,e){var i=this;Gt.call(i,t,e),k.call(i,{target:i})}function u(t,e,i){var s=e.apply(t,i),n=r(s);return-1<n&&N(s,nt[n]),i.pop()&&rt.length&&function(t){for(var e,i=0,s=t.length;i<s;i++)N(e=t[i],nt[r(e)])}(s.querySelectorAll(rt)),s}function d(t,e){Ot(t,e),A?A.observe(t,Vt):(ee&&(t.setAttribute=h,t[R]=T(t),t[I](Q,k)),t[I](W,a)),t[H]&&se&&(t.created=!0,t[H](),t.created=!1)}function p(t){throw new Error("A "+t+" type is already registered")}function f(t,e){var i,s,n=r(t);-1<n&&!Yt.call(t,"TEMPLATE")&&(M(t,nt[n]),n=0,e!==B||t[B]?e!==Y||t[Y]||(t[B]=!1,t[Y]=!0,s="disconnected",n=1):(t[Y]=!1,t[B]=!0,s="connected",n=1,Dt&&at.call(It,t)<0&&It.push(t)),n&&(i=t[e+F]||t[s+F])&&i.call(t))}function m(){}function g(t,e,i){var s=i&&i[z]||"",n=e.prototype,r=At(n),o=e.observedAttributes||dt,a={prototype:r};jt(r,H,{value:function(){if(St)St=!1;else if(!this[yt]){this[yt]=!0,new e(this),n[H]&&n[H].call(this);var t=Pt[Et.get(e)];(!xt||t.create.length>1)&&v(this)}}}),jt(r,q,{value:function(t){-1<at.call(o,t)&&n[q]&&n[q].apply(this,arguments)}}),n[U]&&jt(r,X,{value:n[U]}),n[G]&&jt(r,J,{value:n[G]}),s&&(a[z]=s),t=t.toUpperCase(),Pt[t]={constructor:e,create:s?[s,Tt(t)]:[t]},Et.set(e,t),_[D](t.toLowerCase(),a),x(t),kt[t].r()}function b(t){var e=Pt[t.toUpperCase()];return e&&e.constructor}function y(t){return"string"==typeof t?t:t&&t.is||""}function v(t){for(var e,i=t[q],s=i?t.attributes:dt,n=s.length;n--;)i.call(t,(e=s[n]).name||e.nodeName,null,e.value||e.nodeValue)}function x(t){return(t=t.toUpperCase())in kt||(kt[t]={},kt[t].p=new wt((function(e){kt[t].r=e}))),kt[t].p}function C(){vt&&delete t.customElements,ut(t,"customElements",{configurable:!0,value:new m}),ut(t,"CustomElementRegistry",{configurable:!0,value:m});for(var e=S.get(/^HTML[A-Z]*[a-z]/),i=e.length;i--;function(e){var i=t[e];if(i){t[e]=function(t){var e,s;return t||(t=this),t[yt]||(St=!0,e=Pt[Et.get(t.constructor)],(t=(s=xt&&1===e.create.length)?Reflect.construct(i,dt,e.constructor):_.createElement.apply(_,e.create))[yt]=!0,St=!1,s||v(t)),t},t[e].prototype=i.prototype;try{i.prototype.constructor=t[e]}catch(s){ut(i,yt,{value:t[e]})}}}(e[i]));_.createElement=function(t,e){var i=y(e);return i?$t.call(this,t,Tt(i)):$t.call(this,t)},Qt||(te=!0,_[D](""))}var _=t.document,w=t.Object,S=function(t){var e,i,s,n,r=/^[A-Z]+[a-z]/,o=function(t,e){(e=e.toLowerCase())in a||(a[t]=(a[t]||[]).concat(e),a[e]=a[e.toUpperCase()]=t)},a=(w.create||w)(null),l={};for(i in t)for(n in t[i])for(a[n]=s=t[i][n],e=0;e<s.length;e++)a[s[e].toLowerCase()]=a[s[e].toUpperCase()]=n;return l.get=function(t){return"string"==typeof t?a[t]||(r.test(t)?[]:""):function(t){var e,i=[];for(e in a)t.test(e)&&i.push(e);return i}(t)},l.set=function(t,e){return r.test(t)?o(t,e):o(e,t),l},l}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof e&&(e={type:e||"auto"});var P,k,E,T,A,O,M,N,L,D="registerElement",j=1e5*t.Math.random()>>0,R="__"+D+j,I="addEventListener",B="attached",F="Callback",Y="detached",z="extends",q="attributeChanged"+F,X=B+F,U="connected"+F,G="disconnected"+F,H="created"+F,J=Y+F,$="ADDITION",V="REMOVAL",W="DOMAttrModified",K="DOMContentLoaded",Q="DOMSubtreeModified",Z="<",tt="=",et=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,it=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],st=[],nt=[],rt="",ot=_.documentElement,at=st.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},lt=w.prototype,ct=lt.hasOwnProperty,ht=lt.isPrototypeOf,ut=w.defineProperty,dt=[],pt=w.getOwnPropertyDescriptor,ft=w.getOwnPropertyNames,mt=w.getPrototypeOf,gt=w.setPrototypeOf,bt=!!w.__proto__,yt="__dreCEv1",vt=t.customElements,xt=!/^force/.test(e.type)&&!!(vt&&vt.define&&vt.get&&vt.whenDefined),Ct=w.create||w,_t=t.Map||function(){var t,e=[],i=[];return{get:function(t){return i[at.call(e,t)]},set:function(s,n){(t=at.call(e,s))<0?i[e.push(s)-1]=n:i[t]=n}}},wt=t.Promise||function(t){function e(t){for(s=!0;i.length;)i.shift()(t)}var i=[],s=!1,n={catch:function(){return n},then:function(t){return i.push(t),s&&setTimeout(e,1),n}};return t(e),n},St=!1,Pt=Ct(null),kt=Ct(null),Et=new _t,Tt=function(t){return t.toLowerCase()},At=w.create||function t(e){return e?(t.prototype=e,new t):this},Ot=gt||(bt?function(t,e){return t.__proto__=e,t}:ft&&pt?function(){function t(t,e){for(var i,s=ft(e),n=0,r=s.length;n<r;n++)ct.call(t,i=s[n])||ut(t,i,pt(e,i))}return function(e,i){do{t(e,i)}while((i=mt(i))&&!ht.call(i,e));return e}}():function(t,e){for(var i in e)t[i]=e[i];return t}),Mt=t.MutationObserver||t.WebKitMutationObserver,Nt=t.HTMLAnchorElement,Lt=(t.HTMLElement||t.Element||t.Node).prototype,Dt=!ht.call(Lt,ot),jt=Dt?function(t,e,i){return t[e]=i.value,t}:ut,Rt=Dt?function(t){return 1===t.nodeType}:function(t){return ht.call(Lt,t)},It=Dt&&[],Bt=Lt.attachShadow,Ft=Lt.cloneNode,Yt=Lt.closest||function(t){for(var e=this;e&&e.nodeName!==t;)e=e.parentNode;return e},zt=Lt.dispatchEvent,qt=Lt.getAttribute,Xt=Lt.hasAttribute,Ut=Lt.removeAttribute,Gt=Lt.setAttribute,Ht=_.createElement,Jt=_.importNode,$t=Ht,Vt=Mt&&{attributes:!0,characterData:!0,attributeOldValue:!0},Wt=Mt||function(t){ee=!1,ot.removeEventListener(W,Wt)},Kt=0,Qt=D in _&&!/^force-all/.test(e.type),Zt=!0,te=!1,ee=!0,ie=!0,se=!0;if(Mt&&((L=_.createElement("div")).innerHTML="<div><div></div></div>",new Mt((function(t,e){if(t[0]&&"childList"==t[0].type&&!t[0].removedNodes[0].childNodes.length){var i=(L=pt(Lt,"innerHTML"))&&L.set;i&&ut(Lt,"innerHTML",{set:function(t){for(;this.lastChild;)this.removeChild(this.lastChild);i.call(this,t)}})}e.disconnect(),L=null})).observe(L,{childList:!0,subtree:!0}),L.innerHTML=""),Qt||(gt||bt?(M=function(t,e){ht.call(e,t)||d(t,e)},N=d):N=M=function(t,e){t[R]||(t[R]=w(!0),d(t,e))},Dt?(ee=!1,function(){var t=pt(Lt,I),e=t.value,i=function(t){var e=new CustomEvent(W,{bubbles:!0});e.attrName=t,e.prevValue=qt.call(this,t),e.newValue=null,e[V]=e.attrChange=2,Ut.call(this,t),zt.call(this,e)},s=function(t,e){var i=Xt.call(this,t),s=i&&qt.call(this,t),n=new CustomEvent(W,{bubbles:!0});Gt.call(this,t,e),n.attrName=t,n.prevValue=i?s:null,n.newValue=e,i?n.MODIFICATION=n.attrChange=1:n[$]=n.attrChange=0,zt.call(this,n)},n=function(t){var e,i=t.currentTarget,s=i[R],n=t.propertyName;s.hasOwnProperty(n)&&(s=s[n],(e=new CustomEvent(W,{bubbles:!0})).attrName=s.name,e.prevValue=s.value||null,e.newValue=s.value=i[n]||null,null==e.prevValue?e[$]=e.attrChange=0:e.MODIFICATION=e.attrChange=1,zt.call(i,e))};t.value=function(t,r,o){t===W&&this[q]&&this.setAttribute!==s&&(this[R]={className:{name:"class",value:this.className}},this.setAttribute=s,this.removeAttribute=i,e.call(this,"propertychange",n)),e.call(this,t,r,o)},ut(Lt,I,t)}()):Mt||(ot[I](W,Wt),ot.setAttribute(R,1),ot.removeAttribute(R),ee&&(k=function(t){var e,i,s,n=this;if(n===t.target){for(s in e=n[R],n[R]=i=T(n),i){if(!(s in e))return E(0,n,s,e[s],i[s],$);if(i[s]!==e[s])return E(1,n,s,e[s],i[s],"MODIFICATION")}for(s in e)if(!(s in i))return E(2,n,s,e[s],i[s],V)}},E=function(t,e,i,s,n,r){var o={attrChange:t,currentTarget:e,attrName:i,prevValue:s,newValue:n};o[r]=t,a(o)},T=function(t){for(var e,i,s={},n=t.attributes,r=0,o=n.length;r<o;r++)"setAttribute"!==(i=(e=n[r]).name)&&(s[i]=e.value);return s})),_[D]=function(t,e){if(i=t.toUpperCase(),Zt&&(Zt=!1,Mt?(A=function(t,e){function i(t,e){for(var i=0,s=t.length;i<s;e(t[i++]));}return new Mt((function(s){for(var n,r,o,a=0,l=s.length;a<l;a++)"childList"===(n=s[a]).type?(i(n.addedNodes,t),i(n.removedNodes,e)):(r=n.target,se&&r[q]&&"style"!==n.attributeName&&(o=qt.call(r,n.attributeName))!==n.oldValue&&r[q](n.attributeName,n.oldValue,o))}))}(n(B),n(Y)),(O=function(t){return A.observe(t,{childList:!0,subtree:!0}),t})(_),Bt&&(Lt.attachShadow=function(){return O(Bt.apply(this,arguments))})):(P=[],_[I]("DOMNodeInserted",l(B)),_[I]("DOMNodeRemoved",l(Y))),_[I](K,c),_[I]("readystatechange",c),_.importNode=function(t,e){switch(t.nodeType){case 1:return u(_,Jt,[t,!!e]);case 11:for(var i=_.createDocumentFragment(),s=t.childNodes,n=s.length,r=0;r<n;r++)i.appendChild(_.importNode(s[r],!!e));return i;default:return Ft.call(t,!!e)}},Lt.cloneNode=function(t){return u(this,Ft,[!!t])}),te)return te=!1;if(-2<at.call(st,tt+i)+at.call(st,Z+i)&&p(t),!et.test(i)||-1<at.call(it,i))throw new Error("The type "+t+" is invalid");var i,r,o=function(){return h?_.createElement(d,i):_.createElement(d)},a=e||lt,h=ct.call(a,z),d=h?e[z].toUpperCase():i;return h&&-1<at.call(st,Z+d)&&p(d),r=st.push((h?tt:Z)+i)-1,rt=rt.concat(rt.length?",":"",h?d+'[is="'+t.toLowerCase()+'"]':d),o.prototype=nt[r]=ct.call(a,"prototype")?a.prototype:At(Lt),rt.length&&s(_.querySelectorAll(rt),B),o},_.createElement=$t=function(t,e){var i=y(e),s=i?Ht.call(_,t,Tt(i)):Ht.call(_,t),n=""+t,r=at.call(st,(i?tt:Z)+(i||n).toUpperCase()),a=-1<r;return i&&(s.setAttribute("is",i=i.toLowerCase()),a&&(a=o(n.toUpperCase(),i))),se=!_.createElement.innerHTMLHelper,a&&N(s,nt[r]),s}),addEventListener("beforeunload",(function(){delete _.createElement,delete _.importNode,delete _[D]}),!1),m.prototype={constructor:m,define:xt?function(t,e,i){if(i)g(t,e,i);else{var s=t.toUpperCase();Pt[s]={constructor:e,create:[s]},Et.set(e,s),vt.define(t,e)}}:g,get:xt?function(t){return vt.get(t)||b(t)}:b,whenDefined:xt?function(t){return wt.race([vt.whenDefined(t),x(t)])}:x},!vt||/^force/.test(e.type))C();else if(!e.noBuiltIn)try{!function(e,i,s){var n=new RegExp("^<a\\s+is=('|\")"+s+"\\1></a>$");if(i[z]="a",(e.prototype=At(Nt.prototype)).constructor=e,t.customElements.define(s,e,i),!n.test(_.createElement("a",{is:s}).outerHTML)||!n.test((new e).outerHTML))throw i}((function t(){return Reflect.construct(Nt,[],t)}),{},"document-register-element-a"+j)}catch(ne){C()}if(!e.noBuiltIn)try{if(Ht.call(_,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(re){Tt=function(t){return{is:t.toLowerCase()}}}}(window),(function(){function t(t,e){return[3*t[1][e]-t[0][e]+-3*t[2][e]+t[3][e],3*t[0][e]-6*t[1][e]+3*t[2][e],-3*t[0][e]+3*t[1][e],t[0][e]]}function e(e){return[t(e,"x"),t(e,"y")]}function i(t){return 0>t?-1:t>0?1:0}function s(t,e,s,n){var r,o,a=e/t,l=s/t,c=n/t,h=(3*l-Math.pow(a,2))/9,u=(9*a*l-27*c-2*Math.pow(a,3))/54,d=Math.pow(h,3)+Math.pow(u,2),p=[];if(d>=0)r=i(u+Math.sqrt(d))*Math.pow(Math.abs(u+Math.sqrt(d)),1/3),o=i(u-Math.sqrt(d))*Math.pow(Math.abs(u-Math.sqrt(d)),1/3),p[0]=-a/3+(r+o),p[1]=-a/3-(r+o)/2,p[2]=-a/3-(r+o)/2,0!==Math.abs(Math.sqrt(3)*(r-o)/2)&&(p[1]=-1,p[2]=-1);else{var f=Math.acos(u/Math.sqrt(-Math.pow(h,3)));p[0]=2*Math.sqrt(-h)*Math.cos(f/3)-a/3,p[1]=2*Math.sqrt(-h)*Math.cos((f+2*Math.PI)/3)-a/3,p[2]=2*Math.sqrt(-h)*Math.cos((f+4*Math.PI)/3)-a/3}for(var m=0;3>m;m++)(p[m]<0||p[m]>1)&&(p[m]=-1);return p}void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:t>0?1:-1});var n=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},r=function(t,e){return t.x*e.x+t.y*e.y},o=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},a=function(t,e){return{x:t.x*e,y:t.y*e}},l=Math.pow(2,-65),c=function(t,e){for(var i=[],s=h(t,e),r=e.length-1,a=u(s,2*r-1,i,0),l=n(t,e[0]),c=o(l),d=0,p=0;a>p;p++){l=n(t,m(e,r,i[p],null,null));var f=o(l);c>f&&(c=f,d=i[p])}return l=n(t,e[r]),c>(f=o(l))&&(c=f,d=1),{location:d,distance:c}},h=function(t,e){for(var i=e.length-1,s=2*i-1,o=[],l=[],c=[],h=[],u=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],d=0;i>=d;d++)o[d]=n(e[d],t);for(d=0;i-1>=d;d++)l[d]=n(e[d+1],e[d]),l[d]=a(l[d],3);for(var p=0;i-1>=p;p++)for(var f=0;i>=f;f++)c[p]||(c[p]=[]),c[p][f]=r(l[p],o[f]);for(d=0;s>=d;d++)h[d]||(h[d]=[]),h[d].y=0,h[d].x=parseFloat(d)/s;for(var m=i,g=i-1,b=0;m+g>=b;b++){var y=Math.max(0,b-g),v=Math.min(b,m);for(d=y;v>=d;d++){var x=b-d;h[d+x].y+=c[x][d]*u[x][d]}}return h},u=function(t,e,i,s){var n,r,o=[],a=[],l=[],c=[];switch(d(t,e)){case 0:return 0;case 1:if(s>=64)return i[0]=(t[0].x+t[e].x)/2,1;if(p(t,e))return i[0]=f(t,e),1}m(t,e,.5,o,a),n=u(o,e,l,s+1),r=u(a,e,c,s+1);for(var h=0;n>h;h++)i[h]=l[h];for(h=0;r>h;h++)i[h+n]=c[h];return n+r},d=function(t,e){var i,s,n=0;i=s=Math.sgn(t[0].y);for(var r=1;e>=r;r++)(i=Math.sgn(t[r].y))!=s&&n++,s=i;return n},p=function(t,e){var i,s,n,r,o,a,c,h,u,d;o=t[0].y-t[e].y,a=t[e].x-t[0].x,c=t[0].x*t[e].y-t[e].x*t[0].y,u=d=0;for(var p=1;e>p;p++){var f=o*t[p].x+a*t[p].y+c;f>u?u=f:d>f&&(d=f)}return i=(1*(c-u)-0*(h=a))*(1/(0*h-1*o)),s=(1*(c-d)-0*(h=a))*(1/(0*h-1*o)),n=Math.min(i,s),r=Math.max(i,s),l>r-n?1:0},f=function(t,e){var i=t[e].x-t[0].x,s=t[e].y-t[0].y;return 0+1/(0*i-1*s)*(i*(t[0].y-0)-s*(t[0].x-0))*1},m=function(t,e,i,s,n){for(var r=[[]],o=0;e>=o;o++)r[0][o]=t[o];for(var a=1;e>=a;a++)for(o=0;e-a>=o;o++)r[a]||(r[a]=[]),r[a][o]||(r[a][o]={}),r[a][o].x=(1-i)*r[a-1][o].x+i*r[a-1][o+1].x,r[a][o].y=(1-i)*r[a-1][o].y+i*r[a-1][o+1].y;if(null!=s)for(o=0;e>=o;o++)s[o]=r[o][0];if(null!=n)for(o=0;e>=o;o++)n[o]=r[e-o][o];return r[e][0]},g={},b=function(t,e){for(var i=function(t){var e=g[t];if(!e){var i=function(t){return function(e){return t}},s=function(){return function(t){return t}},n=function(){return function(t){return 1-t}},r=function(t){return function(e){for(var i=1,s=0;s<t.length;s++)i*=t[s](e);return i}};(e=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var o=1;t>o;o++){for(var a=[new i(t)],l=0;t-o>l;l++)a.push(new s);for(l=0;o>l;l++)a.push(new n);e.push(new r(a))}e.push(new function(){return function(e){return Math.pow(1-e,t)}}),g[t]=e}return e}(t.length-1),s=0,n=0,r=0;r<t.length;r++)s+=t[r].x*i[r](e),n+=t[r].y*i[r](e);return{x:s,y:n}},y=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},v=function(t){return t[0].x===t[1].x&&t[0].y===t[1].y},x=function(t,e,i){if(v(t))return{point:t[0],location:e};for(var s=b(t,e),n=0,r=e,o=i>0?1:-1,a=null;n<Math.abs(i);)a=b(t,r+=.005*o),n+=y(a,s),s=a;return{point:a,location:r}},C=function(t,e){var i=b(t,e),s=b(t.slice(0,t.length-1),e),n=s.y-i.y;return 0===n?1/0:Math.atan(n/(s.x-i.x))},_=function(t,i,n,r,o){var a=r-i,l=t-n,c=t*(i-r)+i*(n-t),h=e(o),u=s.apply(null,[a*h[0][0]+l*h[1][0],a*h[0][1]+l*h[1][1],a*h[0][2]+l*h[1][2],a*h[0][3]+l*h[1][3]+c]),d=[];if(null!=u)for(var p=0;3>p;p++){var f,m=u[p],g=Math.pow(m,2),b=Math.pow(m,3),y=[h[0][0]*b+h[0][1]*g+h[0][2]*m+h[0][3],h[1][0]*b+h[1][1]*g+h[1][2]*m+h[1][3]];f=n-t!=0?(y[0]-t)/(n-t):(y[1]-i)/(r-i),m>=0&&1>=m&&f>=0&&1>=f&&d.push(y)}return d},w=this.jsBezier={distanceFromCurve:c,gradientAtPoint:C,gradientAtPointAlongCurveFrom:function(t,e,i){var s=x(t,e,i);return s.location>1&&(s.location=1),s.location<0&&(s.location=0),C(t,s.location)},nearestPointOnCurve:function(t,e){var i=c(t,e);return{point:m(e,e.length-1,i.location,null,null),location:i.location}},pointOnCurve:b,pointAlongCurveFrom:function(t,e,i){return x(t,e,i).point},perpendicularToCurveAt:function(t,e,i,s){var n=x(t,e,s=null==s?0:s),r=C(t,n.location),o=Math.atan(-1/r),a=i/2*Math.sin(o),l=i/2*Math.cos(o);return[{x:n.point.x+l,y:n.point.y+a},{x:n.point.x-l,y:n.point.y-a}]},locationAlongCurveFrom:function(t,e,i){return x(t,e,i).location},getLength:function(t){var e=(new Date).getTime();if(v(t))return 0;for(var i=b(t,0),s=0,n=0,r=null;1>n;)r=b(t,n+=.005),s+=y(r,i),i=r;return console.log("length",(new Date).getTime()-e),s},lineIntersection:_,boxIntersection:function(t,e,i,s,n){var r=[];return r.push.apply(r,_(t,e,t+i,e,n)),r.push.apply(r,_(t+i,e,t+i,e+s,n)),r.push.apply(r,_(t+i,e+s,t,e+s,n)),r.push.apply(r,_(t,e+s,t,e,n)),r},boundingBoxIntersection:function(t,e){var i=[];return i.push.apply(i,_(t.x,t.y,t.x+t.w,t.y,e)),i.push.apply(i,_(t.x+t.w,t.y,t.x+t.w,t.y+t.h,e)),i.push.apply(i,_(t.x+t.w,t.y+t.h,t.x,t.y+t.h,e)),i.push.apply(i,_(t.x,t.y+t.h,t.x,t.y,e)),i},version:"0.9.0"};"undefined"!=typeof exports&&(exports.jsBezier=w)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.Biltong={version:"0.4.0"};"undefined"!=typeof exports&&(exports.Biltong=t);var e=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=function(t,i,s){return s(t=e(t)?t:[t.x,t.y],i=e(i)?i:[i.x,i.y])},s=t.gradient=function(t,e){return i(t,e,(function(t,e){return e[0]==t[0]?e[1]>t[1]?1/0:-1/0:e[1]==t[1]?e[0]>t[0]?0:-0:(e[1]-t[1])/(e[0]-t[0])}))},n=(t.normal=function(t,e){return-1/s(t,e)},t.lineLength=function(t,e){return i(t,e,(function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))}))},t.quadrant=function(t,e){return i(t,e,(function(t,e){return e[0]>t[0]||e[0]==t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4}))}),r=(t.theta=function(t,e){return i(t,e,(function(t,e){var i=s(t,e),r=Math.atan(i),o=n(t,e);return(4==o||3==o)&&(r+=Math.PI),0>r&&(r+=2*Math.PI),r}))},t.intersects=function(t,e){var i=t.x,s=t.x+t.w,n=t.y,r=t.y+t.h,o=e.x,a=e.x+e.w,l=e.y,c=e.y+e.h;return o>=i&&s>=o&&l>=n&&r>=l||a>=i&&s>=a&&l>=n&&r>=l||o>=i&&s>=o&&c>=n&&r>=c||a>=i&&s>=o&&c>=n&&r>=c||i>=o&&a>=i&&n>=l&&c>=n||s>=o&&a>=s&&n>=l&&c>=n||i>=o&&a>=i&&r>=l&&c>=r||s>=o&&a>=i&&r>=l&&c>=r},t.encloses=function(t,e,i){var s=t.y,n=t.y+t.h,r=e.y,o=e.y+e.h,a=function(t,e,s,n){return i?e>=t&&s>=n:e>t&&s>n};return a(t.x,e.x,t.x+t.w,e.x+e.w)&&a(s,r,n,o)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),o=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(t,e,i){var a=s(t,e),l=n(t,e),c=i>0?r[l]:o[l],h=Math.atan(a),u=Math.abs(i*Math.sin(h))*c[1],d=Math.abs(i*Math.cos(h))*c[0];return{x:t.x+d,y:t.y+u}},t.perpendicularLineTo=function(t,e,i){var n=s(t,e),r=Math.atan(-1/n),o=i/2*Math.sin(r),a=i/2*Math.cos(r);return[{x:e.x+a,y:e.y+o},{x:e.x-a,y:e.y-o}]}}).call("undefined"!=typeof window?window:this),(function(){"use strict";function t(t,e,i,s,n,r,o,a){return new Touch({target:e,identifier:N(),pageX:i,pageY:s,screenX:n,screenY:r,clientX:o||n,clientY:a||r})}function e(){var t=[];return Array.prototype.push.apply(t,arguments),t.item=function(t){return this[t]},t}function i(i,s,n,r,o,a,l,c){return e(t.apply(null,arguments))}var s=this,n=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},r=function(t){return"string"==typeof t||t.constructor===String?document.getElementById(t):t},o=function(t){return t.srcElement||t.target},a=function(t,e,i,s){if(s){if(void 0!==t.path&&t.path.indexOf)return{path:t.path,end:t.path.indexOf(i)};var n={path:[],end:-1},r=function(t){n.path.push(t),t===i?n.end=n.path.length-1:null!=t.parentNode&&r(t.parentNode)};return r(e),n}return{path:[e],end:1}},l=function(t,e){for(var i=0,s=t.length;s>i&&t[i]!=e;i++);i<t.length&&t.splice(i,1)},c=1,h=function(t,e,i){var s=c++;return t.__ta=t.__ta||{},t.__ta[e]=t.__ta[e]||{},t.__ta[e][s]=i,i.__tauid=s,s},u=function(t,e,i,s){if(null==t)return i;var r=t.split(","),l=function(s){l.__tauid=i.__tauid;var c=o(s),h=c,u=a(s,c,e,null!=t);if(-1!=u.end)for(var d=0;d<u.end;d++){h=u.path[d];for(var p=0;p<r.length;p++)n(h,r[p],e)&&i.apply(h,arguments)}};return d(i,s,l),l},d=function(t,e,i){t.__taExtra=t.__taExtra||[],t.__taExtra.push([e,i])},p=function(t,e,i,s){if(v&&C[e]){var n=u(s,t,i,C[e]);A(t,C[e],n,i)}"focus"===e&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1"),A(t,e,u(s,t,i,e),i)},f=function(t,e,i,s){null==t.__taSmartClicks&&(p(t,"mousedown",(function(e){t.__tad=P(e)}),s),p(t,"mouseup",(function(e){t.__tau=P(e)}),s),p(t,"click",(function(e){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1])for(var i=0;i<t.__taSmartClicks.length;i++)t.__taSmartClicks[i].apply(o(e),[e])}),s),t.__taSmartClicks=[]),t.__taSmartClicks.push(i),i.__taUnstore=function(){l(t.__taSmartClicks,i)}},m={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},g=function(t,e){return function(i,s,r,c){if("contextmenu"==s&&x)p(i,s,r,c);else{if(null==i.__taTapHandler){var h=i.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},u=function(){h.down=!1},d=function(){h.taps=0};p(i,"mousedown",(function(s){for(var r=o(s),l=a(s,r,i,null!=c),p=!1,f=0;f<l.end;f++){if(p)return;r=l.path[f];for(var m=0;m<h.downSelectors.length;m++)if(null==h.downSelectors[m]||n(r,h.downSelectors[m],i)){h.down=!0,setTimeout(u,t),setTimeout(d,e),p=!0;break}}})),p(i,"mouseup",(function(t){if(h.down){var e,s,r=o(t);h.taps++;var l=T(t);for(var c in m)if(m.hasOwnProperty(c)){var u=m[c];if(u.touches===l&&(1===u.taps||u.taps===h.taps))for(var d=0;d<h[c].length;d++){s=a(t,r,i,null!=h[c][d][1]);for(var p=0;p<s.end;p++)if(e=s.path[p],null==h[c][d][1]||n(e,h[c][d][1],i)){h[c][d][0].apply(e,[t]);break}}}}}))}i.__taTapHandler.downSelectors.push(c),i.__taTapHandler[s].push([r,c]),r.__taUnstore=function(){l(i.__taTapHandler[s],r)}}}},b=function(t,e,i,s){for(var n in i.__tamee[t])i.__tamee[t].hasOwnProperty(n)&&i.__tamee[t][n].apply(s,[e])},y=function(){var t=[];return function(e,i,s,r){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};var a=function(i){var s=o(i);(null==r&&s==e&&!e.__tamee.over||n(s,r,e)&&(null==s.__tamee||!s.__tamee.over))&&(b("mouseenter",i,e,s),s.__tamee=s.__tamee||{},s.__tamee.over=!0,t.push(s))},l=function(i){for(var s=o(i),r=0;r<t.length;r++)s!=t[r]||n(i.relatedTarget||i.toElement,"*",s)||(s.__tamee.over=!1,t.splice(r,1),b("mouseexit",i,e,s))};A(e,"mouseover",u(r,e,a,"mouseover"),a),A(e,"mouseout",u(r,e,l,"mouseout"),l)}s.__taUnstore=function(){delete e.__tamee[i][s.__tauid]},h(e,i,s),e.__tamee[i][s.__tauid]=s}},v="ontouchstart"in document.documentElement||navigator.maxTouchPoints,x="onmousedown"in document.documentElement,C={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},_=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),w=_>-1&&9>_,S=function(t,e){if(null==t)return[0,0];var i=E(t),s=k(i,0);return[s[e+"X"],s[e+"Y"]]},P=function(t){return null==t?[0,0]:w?[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]:S(t,"page")},k=function(t,e){return t.item?t.item(e):t[e]},E=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},T=function(t){return E(t).length},A=function(t,e,i,s){if(h(t,e,i),s.__tauid=i.__tauid,t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent){var n=e+i.__tauid;t["e"+n]=i,t[n]=function(){t["e"+n]&&t["e"+n](window.event)},t.attachEvent("on"+e,t[n])}},O=function(t,e,i){null!=i&&M(t,(function(){var s=r(this);if(function(t,e,i){if(t.__ta&&t.__ta[e]&&delete t.__ta[e][i.__tauid],i.__taExtra){for(var s=0;s<i.__taExtra.length;s++)O(t,i.__taExtra[s][0],i.__taExtra[s][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()}(s,e,i),null!=i.__tauid)if(s.removeEventListener)s.removeEventListener(e,i,!1),v&&C[e]&&s.removeEventListener(C[e],i,!1);else if(this.detachEvent){var n=e+i.__tauid;s[n]&&s.detachEvent("on"+e,s[n]),s[n]=null,s["e"+n]=null}i.__taTouchProxy&&O(t,i.__taTouchProxy[1],i.__taTouchProxy[0])}))},M=function(t,e){if(null!=t){t="undefined"!=typeof Window&&"unknown"!=typeof t.top&&t==t.top?[t]:"string"!=typeof t&&null==t.tagName&&null!=t.length?t:"string"==typeof t?document.querySelectorAll(t):[t];for(var i=0;i<t.length;i++)e.apply(t[i])}},N=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))};s.Mottle=function(t){var e=(t=t||{}).clickThreshold||250,s=t.dblClickThreshold||450,n=new y,o=new g(e,s),a=t.smartClicks,l=function(t,e,i,s){null!=i&&M(t,(function(){var t=r(this);a&&"click"===e?f(t,0,i,s):"tap"===e||"dbltap"===e||"contextmenu"===e?o(t,e,i,s):"mouseenter"===e||"mouseexit"==e?n(t,e,i,s):p(t,e,i,s)}))};this.remove=function(t){return M(t,(function(){var t=r(this);if(t.__ta)for(var e in t.__ta)if(t.__ta.hasOwnProperty(e))for(var i in t.__ta[e])t.__ta[e].hasOwnProperty(i)&&O(t,e,t.__ta[e][i]);t.parentNode&&t.parentNode.removeChild(t)})),this},this.on=function(t,e,i,s){var n=arguments[0],r=4==arguments.length?arguments[2]:null,o=arguments[1],a=arguments[arguments.length-1];return l(n,o,a,r),this},this.off=function(t,e,i){return O(t,e,i),this},this.trigger=function(t,e,s,n){var o=x&&("undefined"==typeof MouseEvent||null==s||s.constructor===MouseEvent),a=v&&!x&&C[e]?C[e]:e,l=!(v&&!x&&C[e]),c=P(s),h=function(t){return S(t,"screen")}(s),u=function(t){return S(t,"client")}(s);return M(t,(function(){var t,d=r(this);s=s||{screenX:h[0],screenY:h[1],clientX:u[0],clientY:u[1]};var p=function(t){n&&(t.payload=n)},f={TouchEvent:function(t){var e=i(window,d,0,c[0],c[1],h[0],h[1],u[0],u[1]);(t.initTouchEvent||t.initEvent)(a,!0,!0,window,null,h[0],h[1],u[0],u[1],!1,!1,!1,!1,e,e,e,1,0)},MouseEvents:function(t){t.initMouseEvent(a,!0,!0,window,0,h[0],h[1],u[0],u[1],!1,!1,!1,!1,1,d)}};if(document.createEvent){var m=!l&&!o&&v&&C[e]?"TouchEvent":"MouseEvents";t=document.createEvent(m),f[m](t),p(t),d.dispatchEvent(t)}else document.createEventObject&&((t=document.createEventObject()).eventType=t.eventName=a,t.screenX=h[0],t.screenY=h[1],t.clientX=u[0],t.clientY=u[1],p(t),d.fireEvent("on"+a,t))})),this}},s.Mottle.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},s.Mottle.pageLocation=P,s.Mottle.setForceTouchEvents=function(t){v=t},s.Mottle.setForceMouseEvents=function(t){x=t},s.Mottle.version="0.8.0","undefined"!=typeof exports&&(exports.Mottle=s.Mottle)}).call("undefined"==typeof window?this:window),(function(){"use strict";var t=this,e=function(t,e,i){return-1===t.indexOf(e)&&(i?t.unshift(e):t.push(e),!0)},i=function(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},s=function(t,e){for(var i=[],s=0;s<t.length;s++)-1===e.indexOf(t[s])&&i.push(t[s]);return i},n=function(t){return null!=t&&("string"==typeof t||t.constructor===String)},r=function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,r=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=e.left+r-(s.clientLeft||i.clientLeft||0);return{top:Math.round(e.top+n-(s.clientTop||i.clientTop||0)),left:Math.round(o)}},o=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},a=function(t,e,i){if(o(e,i,t))return e;for(var s=e.parentNode;null!=s&&s!==t;){if(o(s,i,t))return s;s=s.parentNode}},l=function(t,e,i){for(var s=null,n=e.getAttribute("katavorio-draggable"),r=null!=n?"[katavorio-draggable='"+n+"'] ":"",l=0;l<t.length;l++)if(null!=(s=a(e,i,r+t[l].selector))){if(t[l].filter){var c=o(i,t[l].filter,s);if(!0===t[l].filterExclude&&!c||c)return null}return[t[l],s]}return null},c=function(){var t=-1;if("Microsoft Internet Explorer"===navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),h=c>-1&&9>c,u=9===c,d=function(t){if(h)return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop];var e=f(t),i=p(e,0);return u?[i.pageX||i.clientX,i.pageY||i.clientY]:[i.pageX,i.pageY]},p=function(t,e){return t.item?t.item(e):t[e]},f=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},m={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},g=["stop","start","drag","drop","over","out","beforeStart"],b=function(){},y=function(){return!0},v=function(t,e,i){for(var s=0;s<t.length;s++)t[s]!=i&&e(t[s])},x=function(t,e,i,s){v(t,(function(t){t.setActive(e),e&&t.updatePosition(),i&&t.setHover(s,e)}))},C=function(t,e){if(null!=t){t=n(t)||null!=t.tagName||null==t.length?[t]:t;for(var i=0;i<t.length;i++)e.apply(t[i],[t[i]])}},_=function(t){t.stopPropagation?(t.stopPropagation(),t.preventDefault()):t.returnValue=!1},w=function(t,e,i){return!o(t.srcElement||t.target,i.getInputFilterSelector(),e)},S=function(t,e,i,s){this.params=e||{},this.el=t,this.params.addClass(this.el,this._class),this.uuid=A();var n=!0;return this.setEnabled=function(t){n=t},this.isEnabled=function(){return n},this.toggleEnabled=function(){n=!n},this.setScope=function(t){this.scopes=t?t.split(/\s+/):[s]},this.addScope=function(t){var e={};for(var i in C(this.scopes,(function(t){e[t]=!0})),C(t?t.split(/\s+/):[],(function(t){e[t]=!0})),this.scopes=[],e)this.scopes.push(i)},this.removeScope=function(t){var e={};for(var i in C(this.scopes,(function(t){e[t]=!0})),C(t?t.split(/\s+/):[],(function(t){delete e[t]})),this.scopes=[],e)this.scopes.push(i)},this.toggleScope=function(t){var e={};for(var i in C(this.scopes,(function(t){e[t]=!0})),C(t?t.split(/\s+/):[],(function(t){e[t]?delete e[t]:e[t]=!0})),this.scopes=[],e)this.scopes.push(i)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},P=function(){return!0},k=function(){return!1},E=function(t,e,i,s){this._class=i.draggable;var a=S.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var c,h,u,p,f,g,b=[0,0],v=null,C=null,E=[0,0],T=!1,M=[0,0],N=!1!==this.params.consumeStartEvent,L=this.el,D=this.params.clone,j=!1!==e.multipleDrop,R=!1,I=null,B=[],F=null,Y=e.ghostProxyParent;if(c=!0===e.ghostProxy?P:e.ghostProxy&&"function"==typeof e.ghostProxy?e.ghostProxy:function(t,e){return!(!F||!F.useGhostProxy)&&F.useGhostProxy(t,e)},h=e.makeGhostProxy?e.makeGhostProxy:function(t){return F&&F.makeGhostProxy?F.makeGhostProxy(t):t.cloneNode(!0)},e.selector){var z=t.getAttribute("katavorio-draggable");null==z&&(z=""+(new Date).getTime(),t.setAttribute("katavorio-draggable",z)),B.push(e)}var q=e.snapThreshold,X=function(t,e,i,s,n){var r=e*Math.floor(t[0]/e),o=r+e,a=Math.abs(t[0]-r)<=s?r:Math.abs(o-t[0])<=s?o:t[0],l=i*Math.floor(t[1]/i),c=l+i;return[a,Math.abs(t[1]-l)<=n?l:Math.abs(c-t[1])<=n?c:t[1]]};this.posses=[],this.posseRoles={},this.toGrid=function(t){return null==this.params.grid?t:X(t,this.params.grid[0],this.params.grid[1],this.params.grid?this.params.grid[0]/2:q||5,this.params.grid?this.params.grid[1]/2:q||5)},this.snap=function(t,e){if(null!=L){t=t||(this.params.grid?this.params.grid[0]:10),e=e||(this.params.grid?this.params.grid[1]:10);var i=this.params.getPosition(L),s=X(i,t,e,this.params.grid?this.params.grid[0]/2:q,this.params.grid?this.params.grid[1]/2:q);return this.params.setPosition(L,s),s}},this.setUseGhostProxy=function(t){c=t?P:k};var U,G=function(t){return!1===e.allowNegative?[Math.max(0,t[0]),Math.max(0,t[1])]:t},H=(function(t){U="function"==typeof t?t:t?(function(t,e,i,s){return G([Math.max(0,Math.min(i.w-s[0],t[0])),Math.max(0,Math.min(i.h-s[1],t[1]))])}).bind(this):function(t){return G(t)}}).bind(this);H("function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(t){H(t)};var J,$=function(t,e,i,s){return null!=F&&F.constrain&&"function"==typeof F.constrain?F.constrain(t,e,i,s):U(t,e,i,s)};this.setRevert=function(t){J=t},this.params.revert&&(J=this.params.revert);var V=function(t){return"function"==typeof t?(t._katavorioId=A(),t._katavorioId):t},W={},K=function(t){for(var e in W){var i=W[e],s=i[0](t);if(i[1]&&(s=!s),!s)return!1}return!0},Q=this.setFilter=function(e,i){if(e){var s=V(e);W[s]=[function(i){var s,r=i.srcElement||i.target;return n(e)?s=o(r,e,t):"function"==typeof e&&(s=e(i,t)),s},!1!==i]}};this.addFilter=Q,this.removeFilter=function(t){delete W["function"==typeof t?t._katavorioId:t]},this.clearAllFilters=function(){W={}},this.canDrag=this.params.canDrag||y;var Z,tt=[],et=[];this.addSelector=function(t){t.selector&&B.push(t)},this.downListener=(function(t){if(!t.defaultPrevented&&(this.rightButtonCanDrag||3!==t.which&&2!==t.button)&&this.isEnabled()&&this.canDrag())if(K(t)&&w(t,this.el,this.k)){if(F=null,I=null,B.length>0){var e=l(B,this.el,t.target||t.srcElement);if(null!=e&&(F=e[0],I=e[1]),null==I)return}else I=this.el;if(D)if(L=I.cloneNode(!0),this.params.addClass(L,m.clonedDrag),L.setAttribute("id",null),L.style.position="absolute",null!=this.params.parent){var s=this.params.getPosition(this.el);L.style.left=s[0]+"px",L.style.top=s[1]+"px",this.params.parent.appendChild(L)}else{var n=r(I);L.style.left=n.left+"px",L.style.top=n.top+"px",document.body.appendChild(L)}else L=I;N&&_(t),b=d(t),L&&L.parentNode&&(M=[L.parentNode.scrollLeft,L.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),a.markSelection(this),a.markPosses(this),this.params.addClass(document.body,i.noSelect),nt("beforeStart",{el:this.el,pos:v,e:t,drag:this})}else this.params.consumeFilteredEvents&&_(t)}).bind(this),this.moveListener=(function(t){if(b){if(!T)if(!1!==nt("start",{el:this.el,pos:v,e:t,drag:this})){if(!b)return;this.mark(!0),T=!0}else this.abort();if(b){et.length=0;var e=d(t),i=e[0]-b[0],s=e[1]-b[1],n=this.params.ignoreZoom?1:a.getZoom();L&&L.parentNode&&(i+=L.parentNode.scrollLeft-M[0],s+=L.parentNode.scrollTop-M[1]),this.moveBy(i/=n,s/=n,t),a.updateSelection(i,s,this),a.updatePosses(i,s,this)}}}).bind(this),this.upListener=(function(t){b&&(b=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(t),a.unmarkSelection(this,t),a.unmarkPosses(this,t),this.stop(t),a.notifyPosseDragStop(this,t),T=!1,et.length=0,D?(L&&L.parentNode&&L.parentNode.removeChild(L),L=null):J&&!0===J(L,this.params.getPosition(L))&&(this.params.setPosition(L,v),nt("revert",L)))}).bind(this),this.getFilters=function(){return W},this.abort=function(){null!=b&&this.upListener()},this.getDragElement=function(t){return t?I||this.el:L||this.el};var it={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&it.start.push(e.events.start),e.events.beforeStart&&it.beforeStart.push(e.events.beforeStart),e.events.stop&&it.stop.push(e.events.stop),e.events.drag&&it.drag.push(e.events.drag),e.events.revert&&it.revert.push(e.events.revert),this.on=function(t,e){it[t]&&it[t].push(e)},this.off=function(t,e){if(it[t]){for(var i=[],s=0;s<it[t].length;s++)it[t][s]!==e&&i.push(it[t][s]);it[t]=i}};var st,nt=function(t,e){var i=null;if(F&&F[t])i=F[t](e);else if(it[t])for(var s=0;s<it[t].length;s++)try{var n=it[t][s](e);null!=n&&(i=n)}catch(r){}return i};this.notifyStart=function(t){nt("start",{el:this.el,pos:this.params.getPosition(L),e:t,drag:this})},this.stop=function(t,e){if(e||T){var i=[],s=a.getSelection(),n=this.params.getPosition(L);if(s.length>0)for(var r=0;r<s.length;r++){var o=this.params.getPosition(s[r].el);i.push([s[r].el,{left:o[0],top:o[1]},s[r]])}else i.push([L,{left:n[0],top:n[1]},this]);nt("stop",{el:L,pos:st||n,finalPos:n,e:t,drag:this,selection:i})}},this.mark=function(t){var e;v=this.params.getPosition(L),C=this.params.getPosition(L,!0),E=[C[0]-v[0],C[1]-v[1]],this.size=this.params.getSize(L),tt=a.getMatchingDroppables(this),x(tt,!0,!1,this),this.params.addClass(L,this.params.dragClass||i.drag),e=this.params.getConstrainingRectangle?this.params.getConstrainingRectangle(L):this.params.getSize(L.parentNode),Z={w:e[0],h:e[1]},f=0,g=0,t&&a.notifySelectionDragStart(this)},this.unmark=function(t,s){if(x(tt,!1,!0,this),R&&c(I,L)?(st=[L.offsetLeft-f,L.offsetTop-g],L.parentNode.removeChild(L),L=I):st=null,this.params.removeClass(L,this.params.dragClass||i.drag),tt.length=0,R=!1,!s){et.length>0&&st&&e.setPosition(I,st),et.sort(O);for(var n=0;n<et.length&&!0!==et[n].drop(this,t);n++);}},this.moveBy=function(t,i,s){et.length=0;var n=this.toGrid([v[0]+t,v[1]+i]),r=$(n,L,Z,this.size);if(c(this.el,L))if(n[0]!==r[0]||n[1]!==r[1]){if(!R){var o=h(I);e.addClass(o,m.ghostProxy),Y?(Y.appendChild(o),u=e.getPosition(I.parentNode,!0),p=e.getPosition(e.ghostProxyParent,!0),f=u[0]-p[0],g=u[1]-p[1]):I.parentNode.appendChild(o),L=o,R=!0}r=n}else R&&(L.parentNode.removeChild(L),L=I,R=!1,u=null,p=null,f=0,g=0);var a={x:r[0],y:r[1],w:this.size[0],h:this.size[1]},l={x:a.x+E[0],y:a.y+E[1],w:a.w,h:a.h},d=null;this.params.setPosition(L,[r[0]+f,r[1]+g]);for(var b=0;b<tt.length;b++)this.params.intersects(l,{x:tt[b].pagePosition[0],y:tt[b].pagePosition[1],w:tt[b].size[0],h:tt[b].size[1]})&&(j||null==d||d===tt[b].el)&&tt[b].canDrop(this)?(d||(d=tt[b].el),et.push(tt[b]),tt[b].setHover(this,!0,s)):tt[b].isHover()&&tt[b].setHover(this,!1,s);nt("drag",{el:this.el,pos:r,e:s,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?Q(this.params.handle,!1):Q(this.params.filter,this.params.filterExclude)},T=function(t,e,i,s){this._class=i.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||i.active,this._hoverClass=this.params.hoverClass||i.hover,S.apply(this,arguments);var n=!1;this.allowLoopback=!1!==this.params.allowLoopback,this.setActive=function(t){this.params[t?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(t){return!0},this.isHover=function(){return n},this.setHover=function(t,e,i){(e||null==this.el._katavorioDragHover||this.el._katavorioDragHover===t.el._katavorio)&&(this.params[e?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=e?t.el._katavorio:null,n!==e&&this.params.events[e?"over":"out"]({el:this.el,e:i,drag:t,drop:this}),n=e)},this.drop=function(t,e){return this.params.events.drop({drag:t,e:e,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,n=null}},A=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},O=function(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:0},M=function(t){return null==t||null==(t="string"==typeof t||t.constructor===String?document.getElementById(t):t)?null:(t._katavorio=t._katavorio||A(),t)};t.Katavorio=function(t){var r=[],o={};this._dragsByScope={},this._dropsByScope={};var a=1,l=function(t,e){C(t,(function(t){for(var i=0;i<t.scopes.length;i++)e[t.scopes[i]]=e[t.scopes[i]]||[],e[t.scopes[i]].push(t)}))},c=function(e,i){var s=0;return C(e,(function(e){for(var n=0;n<e.scopes.length;n++)if(i[e.scopes[n]]){var r=t.indexOf(i[e.scopes[n]],e);-1!==r&&(i[e.scopes[n]].splice(r,1),s++)}})),s>0},h=(this.getMatchingDroppables=function(t){for(var e=[],i={},s=0;s<t.scopes.length;s++){var n=this._dropsByScope[t.scopes[s]];if(n)for(var r=0;r<n.length;r++)!n[r].canDrop(t)||i[n[r].uuid]||!n[r].allowLoopback&&n[r].el===t.el||(i[n[r].uuid]=!0,e.push(n[r]))}return e.sort(O),e},(function(e){e=e||{};var i,s={events:{}};for(i in t)s[i]=t[i];for(i in e)s[i]=e[i];for(i=0;i<g.length;i++)s.events[g[i]]=e[g[i]]||b;return s.katavorio=this,s}).bind(this)),u=(function(t,e){for(var i=0;i<g.length;i++)e[g[i]]&&t.on(g[i],e[g[i]])}).bind(this),d={},p=t.css||{},f=t.scope||"katavorio-drag-scope";for(var y in m)d[y]=m[y];for(var y in p)d[y]=p[y];var x=t.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return x},this.setInputFilterSelector=function(t){return x=t,this},this.draggable=function(e,i){var s=[];return C(e,(function(e){if(null!=(e=M(e)))if(null==e._katavorioDrag){var n=h(i);e._katavorioDrag=new E(e,n,d,f),l(e._katavorioDrag,this._dragsByScope),s.push(e._katavorioDrag),t.addClass(e,n.selector?d.delegatedDraggable:d.draggable)}else u(e._katavorioDrag,i)}).bind(this)),s},this.droppable=function(e,i){var s=[];return C(e,(function(e){if(null!=(e=M(e))){var n=new T(e,h(i),d,f);e._katavorioDrop=e._katavorioDrop||[],e._katavorioDrop.push(n),l(n,this._dropsByScope),s.push(n),t.addClass(e,d.droppable)}}).bind(this)),s},this.select=function(e){return C(e,(function(){var e=M(this);e&&e._katavorioDrag&&(o[e._katavorio]||(r.push(e._katavorioDrag),o[e._katavorio]=[e,r.length-1],t.addClass(e,d.selected)))})),this},this.deselect=function(e){return C(e,(function(){var e=M(this);if(e&&e._katavorio&&o[e._katavorio]){for(var i=[],s=0;s<r.length;s++)r[s].el!==e&&i.push(r[s]);r=i,delete o[e._katavorio],t.removeClass(e,d.selected)}})),this},this.deselectAll=function(){for(var e in o)t.removeClass(o[e][0],d.selected);r.length=0,o={}},this.markSelection=function(t){v(r,(function(t){t.mark()}),t)},this.markPosses=function(t){t.posses&&C(t.posses,(function(e){t.posseRoles[e]&&k[e]&&v(k[e].members,(function(t){t.mark()}),t)}))},this.unmarkSelection=function(t,e){v(r,(function(t){t.unmark(e)}),t)},this.unmarkPosses=function(t,e){t.posses&&C(t.posses,(function(i){t.posseRoles[i]&&k[i]&&v(k[i].members,(function(t){t.unmark(e,!0)}),t)}))},this.getSelection=function(){return r.slice(0)},this.updateSelection=function(t,e,i){v(r,(function(i){i.moveBy(t,e)}),i)};var _=function(t,e){e.posses&&C(e.posses,(function(i){e.posseRoles[i]&&k[i]&&v(k[i].members,(function(e){t(e)}),e)}))};this.updatePosses=function(t,e,i){_((function(i){i.moveBy(t,e)}),i)},this.notifyPosseDragStop=function(t,e){_((function(t){t.stop(e,!0)}),t)},this.notifySelectionDragStop=function(t,e){v(r,(function(t){t.stop(e,!0)}),t)},this.notifySelectionDragStart=function(t,e){v(r,(function(t){t.notifyStart(e)}),t)},this.setZoom=function(t){a=t},this.getZoom=function(){return a};var w=function(t,e,i,s){C(t,(function(t){c(t,i),t[s](e),l(t,i)}))};C(["set","add","remove","toggle"],(function(t){this[t+"Scope"]=(function(e,i){w(e._katavorioDrag,i,this._dragsByScope,t+"Scope"),w(e._katavorioDrop,i,this._dropsByScope,t+"Scope")}).bind(this),this[t+"DragScope"]=(function(e,i){w(e.constructor===E?e:e._katavorioDrag,i,this._dragsByScope,t+"Scope")}).bind(this),this[t+"DropScope"]=(function(e,i){w(e.constructor===T?e:e._katavorioDrop,i,this._dropsByScope,t+"Scope")}).bind(this)}).bind(this)),this.snapToGrid=function(t,e){for(var i in this._dragsByScope)v(this._dragsByScope[i],(function(i){i.snap(t,e)}))},this.getDragsForScope=function(t){return this._dragsByScope[t]},this.getDropsForScope=function(t){return this._dropsByScope[t]};var S=function(t,e,i){if((t=M(t))[e]){var s=r.indexOf(t[e]);s>=0&&r.splice(s,1),c(t[e],i)&&C(t[e],(function(t){t.destroy()})),delete t[e]}},P=function(t,e,i,s){(t=M(t))[e]&&t[e].off(i,s)};this.elementRemoved=function(t){t._katavorioDrag&&this.destroyDraggable(t),t._katavorioDrop&&this.destroyDroppable(t)},this.destroyDraggable=function(t,e,i){1===arguments.length?S(t,"_katavorioDrag",this._dragsByScope):P(t,"_katavorioDrag",e,i)},this.destroyDroppable=function(t,e,i){1===arguments.length?S(t,"_katavorioDrop",this._dropsByScope):P(t,"_katavorioDrop",e,i)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},r=[],o={},k={}};var k={},A=function(t,i,s){var r=n(i)?i:i.id,o=!!n(i)||!1!==i.active,a=k[r]||function(){var t={name:r,members:[]};return k[r]=t,t}();return C(t,(function(t){if(t._katavorioDrag){if(s&&null!=t._katavorioDrag.posseRoles[a.name])return;e(a.members,t._katavorioDrag),e(t._katavorioDrag.posses,a.name),t._katavorioDrag.posseRoles[a.name]=o}})),a};this.addToPosse=function(t,e){for(var i=[],s=1;s<arguments.length;s++)i.push(A(t,arguments[s]));return 1===i.length?i[0]:i},this.setPosse=function(t,e){for(var i=[],n=1;n<arguments.length;n++)i.push(A(t,arguments[n],!0).name);return C(t,(function(t){if(t._katavorioDrag){var e=s(t._katavorioDrag.posses,i);Array.prototype.push.apply([],t._katavorioDrag.posses);for(var n=0;n<e.length;n++)this.removeFromPosse(t,e[n])}}).bind(this)),1===i.length?i[0]:i},this.removeFromPosse=function(t,e){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var s=1;s<arguments.length;s++)e=arguments[s],C(t,(function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var s=t._katavorioDrag;C(e,(function(t){i(k[t].members,s),i(s.posses,t),delete s.posseRoles[t]}))}}))},this.removeFromAllPosses=function(t){C(t,(function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var e=t._katavorioDrag;C(e.posses,(function(t){i(k[t].members,e)})),e.posses.length=0,e.posseRoles={}}}))},this.setPosseState=function(t,e,i){var s=k[e];s&&C(t,(function(t){t._katavorioDrag&&t._katavorioDrag.posses&&(t._katavorioDrag.posseRoles[s.name]=i)}))}},t.Katavorio.version="1.0.0","undefined"!=typeof exports&&(exports.Katavorio=t.Katavorio)}).call("undefined"!=typeof window?window:this),(function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(t){return"string"==typeof t}function i(t){return"boolean"==typeof t}function s(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function n(t){return"[object Date]"===Object.prototype.toString.call(t)}function r(t){return"[object Function]"===Object.prototype.toString.call(t)}function o(a){if(e(a))return""+a;if(i(a))return!!a;if(n(a))return new Date(a.getTime());if(r(a))return a;if(t(a)){for(var l=[],c=0;c<a.length;c++)l.push(o(a[c]));return l}if(s(a)){var h={};for(var u in a)h[u]=o(a[u]);return h}return a}function a(n,r,a,l){var c,h,u={},d={};for(a=a||[],l=l||[],h=0;h<a.length;h++)u[a[h]]=!0;for(h=0;h<l.length;h++)d[l[h]]=!0;var p=o(n);for(h in r)if(null==p[h]||d[h])p[h]=r[h];else if(e(r[h])||i(r[h]))u[h]?((c=[]).push.apply(c,t(p[h])?p[h]:[p[h]]),c.push.apply(c,i(r[h])?r[h]:[r[h]]),p[h]=c):p[h]=r[h];else if(t(r[h]))c=[],t(p[h])&&c.push.apply(c,p[h]),c.push.apply(c,r[h]),p[h]=c;else if(s(r[h]))for(var f in s(p[h])||(p[h]={}),r[h])p[h][f]=r[h][f];return p}function l(t,e){if(t)for(var i=0;i<t.length;i++)if(e(t[i]))return i;return-1}function c(t,e){var i=t.indexOf(e);return i>-1&&t.splice(i,1),-1!==i}function h(t,e,i,s){var n=t[e];return null==n&&(t[e]=n=[]),n[s?"unshift":"push"](i),n}function u(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return g[255&t]+g[t>>8&255]+g[t>>16&255]+g[t>>24&255]+"-"+g[255&e]+g[e>>8&255]+"-"+g[e>>16&15|64]+g[e>>24&255]+"-"+g[63&i|128]+g[i>>8&255]+"-"+g[i>>16&255]+g[i>>24&255]+g[255&s]+g[s>>8&255]+g[s>>16&255]+g[s>>24&255]}function d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(m.logEnabled&&"undefined"!=typeof console)try{var s=arguments[arguments.length-1];console.log(s)}catch(i){}}function p(t,e,i){var s=[t[0]-e[0],t[1]-e[1]],n=Math.cos(i/360*Math.PI*2),r=Math.sin(i/360*Math.PI*2);return[s[0]*n-s[1]*r+e[0],s[1]*n+s[0]*r+e[1],n,r]}var f=this;f.jsPlumbUtil=f.jsPlumbUtil||{};var m=f.jsPlumbUtil;"undefined"!=typeof exports&&(exports.jsPlumbUtil=m),m.isArray=t,m.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},m.isString=e,m.isBoolean=i,m.isNull=function(t){return null==t},m.isObject=s,m.isDate=n,m.isFunction=r,m.isNamedFunction=function(t){return r(t)&&null!=t.name&&t.name.length>0},m.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},m.clone=o,m.merge=a,m.replace=function(t,e,i){if(null!=t){var s=t;return e.replace(/([^\.])+/g,(function(t,e,n,r){var o=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),a=function(){return s[o[1]]||(s[o[1]]=[],s[o[1]])};if(n+t.length>=r.length)o?a()[o[3]]=i:s[t]=i;else if(o){var l=a();s=l[o[3]]||(l[o[3]]={},l[o[3]])}else s=s[t]||(s[t]={},s[t]);return""})),t}},m.functionChain=function(t,e,i){for(var s=0;s<i.length;s++){var n=i[s][0][i[s][1]].apply(i[s][0],i[s][2]);if(n===e)return n}return t},m.populate=function(i,n,o,a){var l=function(i){if(null!=i){if(e(i))return function(t){var e=t.match(/(\${.*?})/g);if(null!=e)for(var i=0;i<e.length;i++){var s=n[e[i].substring(2,e[i].length-1)]||"";null!=s&&(t=t.replace(e[i],s))}return t}(i);if(!r(i)||a||null!=o&&0!==(i.name||"").indexOf(o)){if(t(i)){for(var c=[],h=0;h<i.length;h++)c.push(l(i[h]));return c}if(s(i)){var u={};for(var d in i)u[d]=l(i[d]);return u}return i}return i(n)}};return l(i)},m.findWithFunction=l,m.removeWithFunction=function(t,e){var i=l(t,e);return i>-1&&t.splice(i,1),-1!==i},m.remove=c,m.addWithFunction=function(t,e,i){-1===l(t,i)&&t.push(e)},m.addToList=h,m.suggest=function(t,e,i){return-1===t.indexOf(e)&&(i?t.unshift(e):t.push(e),!0)},m.extend=function(e,i,s){var n;i=t(i)?i:[i];var r=function(t){for(var i=t.__proto__;null!=i;)if(null!=i.prototype){for(var s in i.prototype)i.prototype.hasOwnProperty(s)&&!e.prototype.hasOwnProperty(s)&&(e.prototype[s]=i.prototype[s]);i=i.prototype.__proto__}else i=null};for(n=0;n<i.length;n++){for(var o in i[n].prototype)i[n].prototype.hasOwnProperty(o)&&!e.prototype.hasOwnProperty(o)&&(e.prototype[o]=i[n].prototype[o]);r(i[n])}var a=function(t,e){return function(){for(n=0;n<i.length;n++)i[n].prototype[t]&&i[n].prototype[t].apply(this,arguments);return e.apply(this,arguments)}},l=function(t){for(var i in t)e.prototype[i]=a(i,t[i])};if(arguments.length>2)for(n=2;n<arguments.length;n++)l(arguments[n]);return e};for(var g=[],b=0;256>b;b++)g[b]=(16>b?"0":"")+b.toString(16);m.uuid=u,m.fastTrim=function(t){if(null==t)return null;for(var e=t.replace(/^\s\s*/,""),i=/\s/,s=e.length;i.test(e.charAt(--s)););return e.slice(0,s+1)},m.each=function(t,e){t=null==t.length||"string"==typeof t?[t]:t;for(var i=0;i<t.length;i++)e(t[i])},m.map=function(t,e){for(var i=[],s=0;s<t.length;s++)i.push(e(t[s]));return i},m.mergeWithParents=function(t,e,i){i=i||"parent";var s=function(t){return t?e[t]:null},n=function(t){return t?s(t[i]):null},r=function(t,e){if(null==t)return e;var i=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];"override"===e.mergeStrategy&&Array.prototype.push.apply(i,["events","overlays"]);var s=a(t,e,[],i);return r(n(t),s)},o=function(t){if(null==t)return{};if("string"==typeof t)return s(t);if(t.length){for(var e=!1,i=0,n=void 0;!e&&i<t.length;)(n=o(t[i]))?e=!0:i++;return n}},l=o(t);return l?r(n(l),l):{}},m.logEnabled=!0,m.log=d,m.wrap=function(t,e,i){return function(){var s=null;try{null!=e&&(s=e.apply(this,arguments))}catch(n){d("jsPlumb function failed : "+n)}if(null!=t&&(null==i||s!==i))try{s=t.apply(this,arguments)}catch(n){d("wrapped function failed : "+n)}return s}},m.EventGenerator=function(){var t=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(e,i,s){var n=function(e){h(t._listeners,e,i,s),i.__jsPlumb=i.__jsPlumb||{},i.__jsPlumb[u()]=e};if("string"==typeof e)n(e);else if(null!=e.length)for(var r=0;r<e.length;r++)n(e[r]);return t},this.fire=function(t,e,i){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[t]){var s=this._listeners[t].length,n=0,o=!1,a=null;if(!this.shouldFireEvent||this.shouldFireEvent(t,e,i))for(;!o&&s>n&&!1!==a;){if(this.eventsToDieOn[t])this._listeners[t][n].apply(this,[e,i]);else try{a=this._listeners[t][n].apply(this,[e,i])}catch(r){d("jsPlumb: fire failed for event "+t+" : "+r)}n++,(null==this._listeners||null==this._listeners[t])&&(o=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var e=t.queue.pop();e&&t.fire.apply(t,e)},this.unbind=function(t,e){if(0===arguments.length)this._listeners={};else if(1===arguments.length){if("string"==typeof t)delete this._listeners[t];else if(t.__jsPlumb)for(var i in t.__jsPlumb)c(this._listeners[t.__jsPlumb[i]]||[],t)}else 2===arguments.length&&c(this._listeners[t]||[],e);return this},this.getListener=function(e){return t._listeners[e]},this.setSuspendEvents=function(e){t.eventsSuspended=e},this.isSuspendEvents=function(){return t.eventsSuspended},this.silently=function(i){t.setSuspendEvents(!0);try{i()}catch(e){d("Cannot execute silent function "+e)}t.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var e in t._listeners)t._listeners[e]=null}},m.rotatePoint=p,m.rotateAnchorOrientation=function(t,e){var i=p(t,[0,0],e);return[Math.round(i[0]),Math.round(i[1])]}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this;t.jsPlumbUtil.matchesSelector=function(t,e,i){for(var s=(i=i||t.parentNode).querySelectorAll(e),n=0;n<s.length;n++)if(s[n]===t)return!0;return!1},t.jsPlumbUtil.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},t.jsPlumbUtil.sizeElement=function(t,e,i,s,n){t&&(t.style.height=n+"px",t.height=n,t.style.width=s+"px",t.width=s,t.style.left=e+"px",t.style.top=i+"px")}}).call("undefined"!=typeof window?window:this),(function(){var t={deriveAnchor:function(t,e,i,s){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[t][e]}},e=function(t,e){this.count=0,this.instance=t,this.lists={},this.options=e||{},this.instance.addList=function(t,e){return this.listManager.addList(t,e)},this.instance.removeList=function(t){this.listManager.removeList(t)},this.instance.bind("manageElement",(function(t){for(var e=this.instance.getSelector(t.el,"[jtk-scrollable-list]"),i=0;i<e.length;i++)this.addList(e[i])}).bind(this)),this.instance.bind("unmanageElement",(function(t){this.removeList(t.el)})),this.instance.bind("connection",(function(t,e){null==e&&(this._maybeUpdateParentList(t.source),this._maybeUpdateParentList(t.target))}).bind(this))};this.jsPlumbListManager=e,e.prototype={addList:function(e,s){var n=this.instance.extend({},t);this.instance.extend(n,this.options),s=this.instance.extend(n,s||{});var r=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[r]=new i(this.instance,e,s,r)},removeList:function(t){var e=this.lists[t._jsPlumbList];e&&(e.destroy(),delete this.lists[t._jsPlumbList])},_maybeUpdateParentList:function(t){for(var e=t.parentNode,i=this.instance.getContainer();null!=e&&e!==i;){if(null!=e._jsPlumbList&&null!=this.lists[e._jsPlumbList])return void e._jsPlumbScrollHandler();e=e.parentNode}}};var i=function(t,e,i,s){function n(t,e,s,n){return i.anchor?i.anchor:i.deriveAnchor(t,e,s,n)}function r(t,e,s,n){return i.deriveEndpoint?i.deriveEndpoint(t,e,s,n):i.endpoint?i.endpoint:s.type}e._jsPlumbList=s;var o=function(i){for(var s=t.getSelector(e,".jtk-managed"),o=t.getId(e),a=0;a<s.length;a++){if(s[a].offsetTop<e.scrollTop)s[a]._jsPlumbProxies||(s[a]._jsPlumbProxies=s[a]._jsPlumbProxies||[],t.select({source:s[a]}).each((function(i){t.proxyConnection(i,0,e,o,(function(){return r("top",0,i.endpoints[0],i)}),(function(){return n("top",0,i.endpoints[0],i)})),s[a]._jsPlumbProxies.push([i,0])})),t.select({target:s[a]}).each((function(i){t.proxyConnection(i,1,e,o,(function(){return r("top",1,i.endpoints[1],i)}),(function(){return n("top",1,i.endpoints[1],i)})),s[a]._jsPlumbProxies.push([i,1])})));else if(s[a].offsetTop+s[a].offsetHeight>e.scrollTop+e.offsetHeight)s[a]._jsPlumbProxies||(s[a]._jsPlumbProxies=s[a]._jsPlumbProxies||[],t.select({source:s[a]}).each((function(i){t.proxyConnection(i,0,e,o,(function(){return r("bottom",0,i.endpoints[0],i)}),(function(){return n("bottom",0,i.endpoints[0],i)})),s[a]._jsPlumbProxies.push([i,0])})),t.select({target:s[a]}).each((function(i){t.proxyConnection(i,1,e,o,(function(){return r("bottom",1,i.endpoints[1],i)}),(function(){return n("bottom",1,i.endpoints[1],i)})),s[a]._jsPlumbProxies.push([i,1])})));else if(s[a]._jsPlumbProxies){for(var l=0;l<s[a]._jsPlumbProxies.length;l++)t.unproxyConnection(s[a]._jsPlumbProxies[l][0],s[a]._jsPlumbProxies[l][1],o);delete s[a]._jsPlumbProxies}t.revalidate(s[a])}!function(e){for(var i=e.parentNode,s=t.getContainer();null!=i&&i!==s;){if(t.hasClass(i,"jtk-managed"))return void t.recalculateOffsets(i);i=i.parentNode}}(e)};t.setAttribute(e,"jtk-scrollable-list","true"),e._jsPlumbScrollHandler=o,t.on(e,"scroll",o),o(),this.destroy=function(){t.off(e,"scroll",o),delete e._jsPlumbScrollHandler;for(var i=t.getSelector(e,".jtk-managed"),s=t.getId(e),n=0;n<i.length;n++)if(i[n]._jsPlumbProxies){for(var r=0;r<i[n]._jsPlumbProxies.length;r++)t.unproxyConnection(i[n]._jsPlumbProxies[r][0],i[n]._jsPlumbProxies[r][1],s);delete i[n]._jsPlumbProxies}}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var e={};d.extend(e,t._jsPlumb.paintStyle),d.extend(e,t._jsPlumb.hoverPaintStyle),delete t._jsPlumb.hoverPaintStyle,e.gradient&&t._jsPlumb.paintStyle.fill&&delete e.gradient,t._jsPlumb.hoverPaintStyle=e}},s=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],n=function(t){return null==t?null:t.split(" ")},r=function(t,e,i){for(var s in e)t[s]=i},o=function(t,i,s){if(t.getDefaultType){var n=t.getTypeDescriptor(),o={},a=t.getDefaultType(),l=e.merge({},a);r(o,a,"__default");for(var c=0,h=t._jsPlumb.types.length;h>c;c++){var u=t._jsPlumb.types[c];if("__default"!==u){var d=t._jsPlumb.instance.getType(u,n);if(null!=d){var p=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],f=[];"override"===d.mergeStrategy?Array.prototype.push.apply(p,["events","overlays","cssClass"]):f.push("cssClass"),l=e.merge(l,d,f,p),r(o,d,u)}}}i&&(l=e.populate(l,i,"_")),t.applyType(l,s,o),s||t.repaint()}},a=t.jsPlumbUIComponent=function(t){e.EventGenerator.apply(this,arguments);var i=this,s=arguments,n=i.idPrefix,r=n+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(t,e,i){this._jsPlumb.typeCache[i]=this._jsPlumb.typeCache[i]||{},this._jsPlumb.typeCache[i][t]=e},this.getCachedTypeItem=function(t,e){return this._jsPlumb.typeCache[e]?this._jsPlumb.typeCache[e][t]:null},this.getId=function(){return r};var o=t.overlays||[],a={};if(this.defaultOverlayKeys){for(var l=0;l<this.defaultOverlayKeys.length;l++)Array.prototype.push.apply(o,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[l]]||[]);for(l=0;l<o.length;l++){var c=d.convertToFullOverlaySpec(o[l]);a[c[1].id]=c}}var h={overlays:a,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return h},this.appendToDefaultType=function(t){for(var e in t)h[e]=t[e]},t.events)for(var u in t.events)i.bind(u,t.events[u]);this.clone=(function(){var t=Object.create(this.constructor.prototype);return this.constructor.apply(t,s),t}).bind(this),this.isDetachAllowed=function(t){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(t)}catch(s){e.log("jsPlumb: beforeDetach callback failed",s)}return i},this.isDropAllowed=function(t,i,s,n,r,o,a){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:i,scope:s,connection:n,dropEndpoint:r,source:o,target:a});if(this._jsPlumb.beforeDrop)try{l=this._jsPlumb.beforeDrop({sourceId:t,targetId:i,scope:s,connection:n,dropEndpoint:r,source:o,target:a})}catch(c){e.log("jsPlumb: beforeDrop callback failed",c)}return l};var p=[];this.setListenerComponent=function(t){for(var e=0;e<p.length;e++)p[e][3]=t}},l=function(t,e){var i=t._jsPlumb.instance.getType(t._jsPlumb.types[e],t.getTypeDescriptor());null!=i&&i.cssClass&&t.canvas&&t._jsPlumb.instance.removeClass(t.canvas,i.cssClass)};e.extend(t.jsPlumbUIComponent,e.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,e){this._jsPlumb.parameters[t]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},getClass:function(){return d.getClass(this.canvas)},hasClass:function(t){return d.hasClass(this.canvas,t)},addClass:function(t){d.addClass(this.canvas,t)},removeClass:function(t){d.removeClass(this.canvas,t)},updateClasses:function(t,e){d.updateClasses(this.canvas,t,e)},setType:function(t,e,i){this.clearTypes(),this._jsPlumb.types=n(t)||[],o(this,e,i)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,e){o(this,t,e)},hasType:function(t){return-1!==this._jsPlumb.types.indexOf(t)},addType:function(t,e,i){var s=n(t),r=!1;if(null!=s){for(var a=0,l=s.length;l>a;a++)this.hasType(s[a])||(this._jsPlumb.types.push(s[a]),r=!0);r&&o(this,e,i)}},removeType:function(t,e,i){var s=n(t),r=!1,a=(function(t){var e=this._jsPlumb.types.indexOf(t);return-1!==e&&(l(this,e),this._jsPlumb.types.splice(e,1),!0)}).bind(this);if(null!=s){for(var c=0,h=s.length;h>c;c++)r=a(s[c])||r;r&&o(this,e,i)}},clearTypes:function(t,e){for(var i=this._jsPlumb.types.length,s=0;i>s;s++)l(this,0),this._jsPlumb.types.splice(0,1);o(this,t,e)},toggleType:function(t,e,i){var s=n(t);if(null!=s){for(var r=0,a=s.length;a>r;r++){var c=this._jsPlumb.types.indexOf(s[r]);-1!==c?(l(this,c),this._jsPlumb.types.splice(c,1)):this._jsPlumb.types.push(s[r])}o(this,e,i)}},applyType:function(t,e){if(this.setPaintStyle(t.paintStyle,e),this.setHoverPaintStyle(t.hoverPaintStyle,e),t.parameters)for(var i in t.parameters)this.setParameter(i,t.parameters[i]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(t,e){this._jsPlumb.paintStyle=t,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,i(this),e||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,e){this._jsPlumb.hoverPaintStyle=t,i(this),e||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(t){(t||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(t,e,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=t;var s=t?"addClass":"removeClass";null!=this.canvas&&(null!=this._jsPlumb.instance.hoverClass&&this._jsPlumb.instance[s](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[s](this.canvas,this._jsPlumb.hoverClass)),null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||jsPlumbUtil.uuid(),this.repaint({timestamp:i,recalc:!1}))),this.getAttachedElements&&!e&&function(t,e,i,s){var n=t.getAttachedElements();if(n)for(var r=0,o=n.length;o>r;r++)s&&s===n[r]||n[r].setHover(e,!0,i)}(this,t,jsPlumbUtil.uuid(),this)}}});var c=0,h=function(){var t=c+1;return c++,t},u=t.jsPlumbInstance=function(i){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},i&&d.extend(this.Defaults,i),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},e.EventGenerator.apply(this);var n=this,r=h(),o=n.bind,l={},c=1,u=function(t){if(null==t)return null;if(3===t.nodeType||8===t.nodeType)return{el:t,text:!0};var i=n.getElement(t);return{el:i,id:e.isString(t)&&null==i?t:Y(i)}};for(var p in this.getInstanceIndex=function(){return r},this.setZoom=function(t,e){return n.fire("zoom",c=t),e&&n.repaintEverything(),!0},this.getZoom=function(){return c},this.Defaults)l[p]=this.Defaults[p];var f,m=[];this.unbindContainer=function(){if(null!=f&&m.length>0)for(var t=0;t<m.length;t++)n.off(f,m[t][0],m[t][1])},this.setContainer=function(t){this.unbindContainer(),t=this.getElement(t),this.select().each((function(e){e.moveParent(t)})),this.selectEndpoints().each((function(e){e.moveParent(t)}));var e=f;f=t,m.length=0;for(var i={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},r=function(t,e,s){var r=e.srcElement||e.target,o=(r&&r.parentNode?r.parentNode._jsPlumb:null)||(r?r._jsPlumb:null)||(r&&r.parentNode&&r.parentNode.parentNode?r.parentNode.parentNode._jsPlumb:null);o&&(o.fire(t,o,e),n.fire(s&&i[s+t]||t,o.component||o,e))},o=function(t,e,i){m.push([t,i]),n.on(f,t,e,i)},a=function(t){o(t,".jtk-connector",(function(e){r(t,e)})),o(t,".jtk-endpoint",(function(e){r(t,e,"endpoint")})),o(t,".jtk-overlay",(function(e){r(t,e)}))},l=0;l<s.length;l++)a(s[l]);for(var c in C){var h=C[c].el;h.parentNode===e&&(e.removeChild(h),f.appendChild(h))}},this.getContainer=function(){return f},this.bind=function(t,e){"ready"===t&&b?e():o.apply(n,[t,e])},n.importDefaults=function(t){for(var e in t)n.Defaults[e]=t[e];return t.Container&&n.setContainer(t.Container),n},n.restoreDefaults=function(){return n.Defaults=d.extend({},l),n};var g=null,b=!1,y=[],v={},x={},C={},_={},w={},S=!1,P=[],k=!1,E=null,T=this.Defaults.Scope,A=1,O=function(){return""+A++},M=(function(t,e){f?f.appendChild(t):e?this.getElement(e).appendChild(t):this.appendToRoot(t)}).bind(this),N=function(t,e,i,s){var r={c:[],e:[]};if(!k&&null!=(t=n.getElement(t))){var o=Y(t),a=t.querySelectorAll(".jtk-managed");null==i&&(i=jsPlumbUtil.uuid());for(var l=(ot({elId:o,offset:e,recalc:!1,timestamp:i}),0);l<a.length;l++)ot({elId:a[l].getAttribute("id"),recalc:!0,timestamp:i});var c=n.router.redraw(o,e,i,null,s);if(Array.prototype.push.apply(r.c,c.c),Array.prototype.push.apply(r.e,c.e),a)for(var h=0;h<a.length;h++)c=n.router.redraw(a[h].getAttribute("id"),null,i,null,s,!0),Array.prototype.push.apply(r.c,c.c),Array.prototype.push.apply(r.e,c.e)}return r},L=function(t){return x[t]},D=(function(t,i){var s=d.extend({},t);if(i&&d.extend(s,i),s.source&&(s.source.endpoint?s.sourceEndpoint=s.source:s.source=n.getElement(s.source)),s.target&&(s.target.endpoint?s.targetEndpoint=s.target:s.target=n.getElement(s.target)),t.uuids&&(s.sourceEndpoint=L(t.uuids[0]),s.targetEndpoint=L(t.uuids[1])),s.sourceEndpoint&&s.sourceEndpoint.isFull())e.log(n,"could not add connection; source endpoint is full");else{if(!s.targetEndpoint||!s.targetEndpoint.isFull()){if(!s.type&&s.sourceEndpoint&&(s.type=s.sourceEndpoint.connectionType),s.sourceEndpoint&&s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var r=0,o=s.sourceEndpoint.connectorOverlays.length;o>r;r++)s.overlays.push(s.sourceEndpoint.connectorOverlays[r])}s.sourceEndpoint&&s.sourceEndpoint.scope&&(s.scope=s.sourceEndpoint.scope),!s["pointer-events"]&&s.sourceEndpoint&&s.sourceEndpoint.connectorPointerEvents&&(s["pointer-events"]=s.sourceEndpoint.connectorPointerEvents);var a=function(t,e,i){var r=function(t,e){var i=d.extend({},t);for(var s in e)e[s]&&(i[s]=e[s]);return i}(e,{anchor:s.anchors?s.anchors[i]:s.anchor,endpoint:s.endpoints?s.endpoints[i]:s.endpoint,paintStyle:s.endpointStyles?s.endpointStyles[i]:s.endpointStyle,hoverPaintStyle:s.endpointHoverStyles?s.endpointHoverStyles[i]:s.endpointHoverStyle});return n.addEndpoint(t,r)},l=function(t,e,i,n){if(s[t]&&!s[t].endpoint&&!s[t+"Endpoint"]&&!s.newConnection){var r=i[Y(s[t])];if(r=r?r[n]:null){if(!r.enabled)return!1;var o=d.extend({},r.def);delete o.label;var l=null!=r.endpoint&&r.endpoint._jsPlumb?r.endpoint:a(s[t],o,e);if(l.isFull())return!1;s[t+"Endpoint"]=l,!s.scope&&o.scope&&(s.scope=o.scope),r.uniqueEndpoint?r.endpoint?l.finalEndpoint=r.endpoint:(r.endpoint=l,l.setDeleteOnEmpty(!1)):l.setDeleteOnEmpty(!0),0===e&&r.def.connectorOverlays&&(s.overlays=s.overlays||[],Array.prototype.push.apply(s.overlays,r.def.connectorOverlays))}}};return!1!==l("source",0,this.sourceEndpointDefinitions,s.type||"default")&&!1!==l("target",1,this.targetEndpointDefinitions,s.type||"default")?(s.sourceEndpoint&&s.targetEndpoint&&(function(t,e){for(var i=t.scope.split(/\s/),s=e.scope.split(/\s/),n=0;n<i.length;n++)for(var r=0;r<s.length;r++)if(s[r]===i[n])return!0;return!1}(s.sourceEndpoint,s.targetEndpoint)||(s=null)),s):void 0}e.log(n,"could not add connection; target endpoint is full")}}).bind(n),j=function(t){var e=n.Defaults.ConnectionType||n.getDefaultConnectionType();t._jsPlumb=n,t.newConnection=j,t.newEndpoint=I,t.endpointsByUUID=x,t.endpointsByElement=v,t.finaliseConnection=R,t.id="con_"+O();var i=new e(t);return i.isDetachable()&&(i.endpoints[0].initDraggable("_jsPlumbSource"),i.endpoints[1].initDraggable("_jsPlumbTarget")),i},R=n.finaliseConnection=function(t,e,i,s){e=e||{},t.suspendedEndpoint||y.push(t),t.pending=null,t.endpoints[0].isTemporarySource=!1,!1!==s&&n.router.newConnection(t),N(t.source),e.doNotFireConnectionEvent||!1===e.fireEvent||n.fire("connection",{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]},i)},I=function(t,e){var i=n.Defaults.EndpointType||d.Endpoint,s=d.extend({},t);s._jsPlumb=n,s.newConnection=j,s.newEndpoint=I,s.endpointsByUUID=x,s.endpointsByElement=v,s.fireDetachEvent=X,s.elementId=e||Y(s.source);var r=new i(s);return r.id="ep_"+O(),rt(s.elementId,s.source),d.headless||n.getDragManager().endpointAdded(s.source,e),r},B=function(t,e,i){var s=v[t];if(s&&s.length)for(var n=0,r=s.length;r>n;n++){for(var o=0,a=s[n].connections.length;a>o;o++)if(e(s[n].connections[o]))return;i&&i(s[n])}},F=function(t,e,i){e="block"===e;var s=null;i&&(s=function(t){t.setVisible(e,!0,!0)});var n=u(t);B(n.id,(function(t){e&&i?t.endpoints[t.sourceId===n.id?1:0].isVisible()&&t.setVisible(!0):t.setVisible(e)}),s)},Y=function(t,i,s){if(e.isString(t))return t;if(null==t)return null;var o=n.getAttribute(t,"id");return o&&"undefined"!==o||(2===arguments.length&&void 0!==arguments[1]?o=i:(1===arguments.length||3===arguments.length&&!arguments[2])&&(o="jsPlumb_"+r+"_"+O()),s||n.setAttribute(t,"id",o)),o};this.setConnectionBeingDragged=function(t){S=t},this.isConnectionBeingDragged=function(){return S},this.getManagedElements=function(){return C},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(t,i,s){var r=d.extend({},s=s||{});d.extend(r,i),r.endpoint=r.endpoint||n.Defaults.Endpoint,r.paintStyle=r.paintStyle||n.Defaults.EndpointStyle;for(var o=[],a=e.isArray(t)||null!=t.length&&!e.isString(t)?t:[t],l=0,c=a.length;c>l;l++){r.source=n.getElement(a[l]),nt(r.source);var h=Y(r.source),u=I(r,h),p=rt(h,r.source,null,!k).info.o;e.addToList(v,h,u),k||u.paint({anchorLoc:u.anchor.compute({xy:[p.left,p.top],wh:P[h],element:u,timestamp:E,rotation:this.getRotation(h)}),timestamp:E}),o.push(u)}return 1===o.length?o[0]:o},this.addEndpoints=function(t,i,s){for(var r=[],o=0,a=i.length;a>o;o++){var l=n.addEndpoint(t,i[o],s);e.isArray(l)?Array.prototype.push.apply(r,l):r.push(l)}return r},this.animate=function(t,i,s){if(!this.animationSupported)return!1;s=s||{};var r=n.getElement(t),o=Y(r),a=d.animEvents.step,l=d.animEvents.complete;s[a]=e.wrap(s[a],(function(){n.revalidate(o)})),s[l]=e.wrap(s[l],(function(){n.revalidate(o)})),n.doAnimate(r,i,s)},this.checkCondition=function(t,i){var s=n.getListener(t),r=!0;if(s&&s.length>0){var o=Array.prototype.slice.call(arguments,1);try{for(var a=0,l=s.length;l>a;a++)r=r&&s[a].apply(s[a],o)}catch(c){e.log(n,"cannot check condition ["+t+"]"+c)}}return r},this.connect=function(t,i){var s,n=D(t,i);if(n){if(null==n.source&&null==n.sourceEndpoint)return void e.log("Cannot establish connection - source does not exist");if(null==n.target&&null==n.targetEndpoint)return void e.log("Cannot establish connection - target does not exist");nt(n.source),s=j(n),R(s,n)}return s};var z=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],q=(function(t,e,i,s){var n,r,o,a=z[i],l=t[a.elId],c=t.endpoints[i],h={index:i,originalSourceId:0===i?l:t.sourceId,newSourceId:t.sourceId,originalTargetId:1===i?l:t.targetId,newTargetId:t.targetId,connection:t};if(e.constructor===d.Endpoint)(n=e).addConnection(t),e=n.element;else if(r=Y(e),o=this[a.epDefs][r],r===t[a.elId])n=null;else if(o)for(var u in o){if(!o[u].enabled)return;n=null!=o[u].endpoint&&o[u].endpoint._jsPlumb?o[u].endpoint:this.addEndpoint(e,o[u].def),o[u].uniqueEndpoint&&(o[u].endpoint=n),n.addConnection(t)}else n=t.makeEndpoint(0===i,e,r);return null!=n&&(c.detachFromConnection(t),t.endpoints[i]=n,t[a.el]=n.element,t[a.elId]=n.elementId,h[0===i?"newSourceId":"newTargetId"]=n.elementId,U(h),s||t.repaint()),h.element=e,h}).bind(this);this.setSource=function(t,e,i){var s=q(t,e,0,i);this.router.sourceOrTargetChanged(s.originalSourceId,s.newSourceId,t,s.el,0)},this.setTarget=function(t,e,i){var s=q(t,e,1,i);this.router.sourceOrTargetChanged(s.originalTargetId,s.newTargetId,t,s.el,1)},this.deleteEndpoint=function(t,e,i){var s="string"==typeof t?x[t]:t;return s&&n.deleteObject({endpoint:s,dontUpdateHover:e,deleteAttachedObjects:i}),n},this.deleteEveryEndpoint=function(){var t=n.setSuspendDrawing(!0);for(var e in v){var i=v[e];if(i&&i.length)for(var s=0,r=i.length;r>s;s++)n.deleteEndpoint(i[s],!0)}v={},C={},x={},_={},w={},n.router.reset();var o=n.getDragManager();return o&&o.reset(),t||n.setSuspendDrawing(!1),n};var X=function(t,e,i){var s=n.Defaults.ConnectionType||n.getDefaultConnectionType(),r=t.constructor===s?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&n.fire("connectionDetached",r,i),n.fire("internal.connectionDetached",r,i),n.router.connectionDetached(r)},U=n.fireMoveEvent=function(t,e){n.fire("connectionMoved",t,e)};this.unregisterEndpoint=function(t){for(var e in t._jsPlumb.uuid&&(x[t._jsPlumb.uuid]=null),n.router.deleteEndpoint(t),v){var i=v[e];if(i){for(var s=[],r=0,o=i.length;o>r;r++)i[r]!==t&&s.push(i[r]);v[e]=s}v[e].length<1&&delete v[e]}};var G="isDetachAllowed";this.deleteConnection=function(t,i){return!(null==t||(i=i||{},!i.force&&!e.functionChain(!0,!1,[[t.endpoints[0],G,[t]],[t.endpoints[1],G,[t]],[t,G,[t]],[n,"checkCondition",["beforeDetach",t]]]))||(t.setHover(!1),X(t,!t.pending&&!1!==i.fireEvent,i.originalEvent),t.endpoints[0].detachFromConnection(t),t.endpoints[1].detachFromConnection(t),e.removeWithFunction(y,(function(e){return t.id===e.id})),t.cleanup(),t.destroy(),0))},this.deleteEveryConnection=function(t){t=t||{};var e=y.length,i=0;return n.batch((function(){for(var s=0;e>s;s++)i+=n.deleteConnection(y[0],t)?1:0})),i},this.deleteConnectionsForElement=function(t,e){e=e||{},t=n.getElement(t);var i=Y(t),s=v[i];if(s&&s.length)for(var r=0,o=s.length;o>r;r++)s[r].deleteEveryConnection(e);return n},this.deleteObject=function(t){var i={endpoints:{},connections:{},endpointCount:0,connectionCount:0},s=!1!==t.deleteAttachedObjects,r=function(e){null!=e&&null==i.connections[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),i.connections[e.id]=e,i.connectionCount++)};for(var o in t.connection?r(t.connection):function(e){if(null!=e&&null==i.endpoints[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),i.endpoints[e.id]=e,i.endpointCount++,s))for(var n=0;n<e.connections.length;n++)r(e.connections[n])}(t.endpoint),i.connections){var a=i.connections[o];if(a._jsPlumb){e.removeWithFunction(y,(function(t){return a.id===t.id})),X(a,!1!==t.fireEvent&&!a.pending,t.originalEvent);var l=null==t.deleteAttachedObjects?null:!t.deleteAttachedObjects;a.endpoints[0].detachFromConnection(a,null,l),a.endpoints[1].detachFromConnection(a,null,l),a.cleanup(!0),a.destroy(!0)}}for(var c in i.endpoints){var h=i.endpoints[c];h._jsPlumb&&(n.unregisterEndpoint(h),h.cleanup(!0),h.destroy(!0))}return i};var H=function(t,e,i,s){for(var n=0,r=t.length;r>n;n++)t[n][e].apply(t[n],i);return s(t)},J=function(t,e,i){for(var s=[],n=0,r=t.length;r>n;n++)s.push([t[n][e].apply(t[n],i),t[n]]);return s},$=function(t,e,i){return function(){return H(t,e,arguments,i)}},V=function(t,e){return function(){return J(t,e,arguments)}},W=function(t,e){var i=[];if(t)if("string"==typeof t){if("*"===t)return t;i.push(t)}else if(e)i=t;else if(t.length)for(var s=0,n=t.length;n>s;s++)i.push(u(t[s]).id);else i.push(u(t).id);return i},K=function(t,e,i){return"*"===t||(t.length>0?-1!==t.indexOf(e):!i)};this.getConnections=function(t,e){t?t.constructor===String&&(t={scope:t}):t={};for(var i=t.scope||n.getDefaultScope(),s=W(i,!0),r=W(t.source),o=W(t.target),a=!e&&s.length>1?{}:[],l=function(t,i){if(!e&&s.length>1){var n=a[t];null==n&&(n=a[t]=[]),n.push(i)}else a.push(i)},c=0,h=y.length;h>c;c++){var u=y[c],d=u.proxies&&u.proxies[0]?u.proxies[0].originalEp.elementId:u.sourceId,p=u.proxies&&u.proxies[1]?u.proxies[1].originalEp.elementId:u.targetId;K(s,u.scope)&&K(r,d)&&K(o,p)&&l(u.scope,u)}return a};var Q=function(t,e){return function(i){for(var s=0,n=t.length;n>s;s++)i(t[s]);return e(t)}},Z=function(t){return function(e){return t[e]}},tt=function(t,e){var i,s,n={length:t.length,each:Q(t,e),get:Z(t)},r=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],o=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(i=0,s=r.length;s>i;i++)n[r[i]]=$(t,r[i],e);for(i=0,s=o.length;s>i;i++)n[o[i]]=V(t,o[i]);return n},et=function(t){var e=tt(t,et);return d.extend(e,{setDetachable:$(t,"setDetachable",et),setReattach:$(t,"setReattach",et),setConnector:$(t,"setConnector",et),delete:function(){for(var e=0,i=t.length;i>e;e++)n.deleteConnection(t[e])},isDetachable:V(t,"isDetachable"),isReattach:V(t,"isReattach")})},it=function(t){var e=tt(t,it);return d.extend(e,{setEnabled:$(t,"setEnabled",it),setAnchor:$(t,"setAnchor",it),isEnabled:V(t,"isEnabled"),deleteEveryConnection:function(){for(var e=0,i=t.length;i>e;e++)t[e].deleteEveryConnection()},delete:function(){for(var e=0,i=t.length;i>e;e++)n.deleteEndpoint(t[e])}})};this.select=function(t){return(t=t||{}).scope=t.scope||"*",et(t.connections||n.getConnections(t,!0))},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,i=e?"*":W(t.element),s=e?"*":W(t.source),n=e?"*":W(t.target),r=W(t.scope,!0),o=[];for(var a in v){var l=K(i,a,!0),c=K(s,a,!0),h="*"!==s,u=K(n,a,!0),d="*"!==n;if(l||c||u)t:for(var p=0,f=v[a].length;f>p;p++){var m=v[a][p];if(K(r,m.scope,!0)){if(h&&s.length>0&&!m.isSource||d&&n.length>0&&!m.isTarget)continue t;o.push(m)}}}return it(o)},this.getAllConnections=function(){return y},this.getDefaultScope=function(){return T},this.getEndpoint=L,this.getEndpoints=function(t){return v[u(t).id]||[]},this.getDefaultEndpointType=function(){return d.Endpoint},this.getDefaultConnectionType=function(){return d.Connection},this.getId=Y,this.draw=N,this.info=u,this.appendElement=M;var st=!1;this.isHoverSuspended=function(){return st},this.setHoverSuspended=function(t){st=t},this.hide=function(t,e){return F(t,"none",e),n},this.idstamp=O;var nt=function(t){if(!f&&t){var e=n.getElement(t);e.offsetParent&&n.setContainer(e.offsetParent)}},rt=n.manage=function(t,e,i,s){return C[t]?s&&(C[t].info=ot({elId:t,timestamp:E,recalc:!0})):(C[t]={el:e,endpoints:[],connections:[],rotation:0},C[t].info=ot({elId:t,timestamp:E}),n.addClass(e,"jtk-managed"),i||n.fire("manageElement",{id:t,info:C[t].info,el:e})),C[t]};this.unmanage=function(t){if(C[t]){var e=C[t].el;n.removeClass(e,"jtk-managed"),delete C[t],n.fire("unmanageElement",{id:t,el:e})}},this.rotate=function(t,e,i){return C[t]&&(C[t].rotation=e,C[t].el.style.transform="rotate("+e+"deg)",C[t].el.style.transformOrigin="center center",!0!==i)?this.revalidate(t):{c:[],e:[]}},this.getRotation=function(t){return C[t]&&C[t].rotation||0};var ot=function(t){var e,i=t.timestamp,s=t.recalc,r=t.offset,o=t.elId;return k&&!i&&(i=E),!s&&i&&i===w[o]?{o:t.offset||_[o],s:P[o]}:(s||!r&&null==_[o]?null!=(e=C[o]?C[o].el:null)&&(P[o]=n.getSize(e),_[o]=n.getOffset(e),w[o]=i):(_[o]=r||_[o],null==P[o]&&null!=(e=C[o].el)&&(P[o]=n.getSize(e)),w[o]=i),_[o]&&!_[o].right&&(_[o].right=_[o].left+P[o][0],_[o].bottom=_[o].top+P[o][1],_[o].width=P[o][0],_[o].height=P[o][1],_[o].centerx=_[o].left+_[o].width/2,_[o].centery=_[o].top+_[o].height/2),{o:_[o],s:P[o]})};this.updateOffset=ot,this.init=(function(){b||(n.Defaults.Container&&n.setContainer(n.Defaults.Container),n.router=new t.jsPlumb.DefaultRouter(n),n.anchorManager=n.router.anchorManager,b=!0,n.fire("ready",n))}).bind(this),this.log=g,this.jsPlumbUIComponent=a,this.makeAnchor=function(){var i,s=function(e,i){if(t.jsPlumb.Anchors[e])return new t.jsPlumb.Anchors[e](i);if(!n.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}};if(0===arguments.length)return null;var r=arguments[0],o=arguments[1],a=null;if(r.compute&&r.getOrientation)return r;if("string"==typeof r)a=s(arguments[0],{elementId:o,jsPlumbInstance:n});else if(e.isArray(r))if(e.isArray(r[0])||e.isString(r[0]))2===r.length&&e.isObject(r[1])?e.isString(r[0])?(i=t.jsPlumb.extend({elementId:o,jsPlumbInstance:n},r[1]),a=s(r[0],i)):(i=t.jsPlumb.extend({elementId:o,jsPlumbInstance:n,anchors:r[0]},r[1]),a=new t.jsPlumb.DynamicAnchor(i)):a=new d.DynamicAnchor({anchors:r,selector:null,elementId:o,jsPlumbInstance:n});else{var l={x:r[0],y:r[1],orientation:r.length>=4?[r[2],r[3]]:[0,0],offsets:r.length>=6?[r[4],r[5]]:[0,0],elementId:o,jsPlumbInstance:n,cssClass:7===r.length?r[6]:null};(a=new t.jsPlumb.Anchor(l)).clone=function(){return new t.jsPlumb.Anchor(l)}}return a.id||(a.id="anchor_"+O()),a},this.makeAnchors=function(i,s,r){for(var o=[],a=0,l=i.length;l>a;a++)"string"==typeof i[a]?o.push(t.jsPlumb.Anchors[i[a]]({elementId:s,jsPlumbInstance:r})):e.isArray(i[a])&&o.push(n.makeAnchor(i[a],s,r));return o},this.makeDynamicAnchor=function(e,i){return new t.jsPlumb.DynamicAnchor({anchors:e,selector:i,elementId:null,jsPlumbInstance:n})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var at=function(i,s,r,o,l){var c=new a(s),h=s._jsPlumb.EndpointDropHandler({jsPlumb:n,enabled:function(){return i.def.enabled},isFull:function(){var t=n.select({target:i.id}).length;return i.def.maxConnections>0&&t>=i.def.maxConnections},element:i.el,elementId:i.id,isSource:o,isTarget:l,addClass:function(t){n.addClass(i.el,t)},removeClass:function(t){n.removeClass(i.el,t)},onDrop:function(t){t.endpoints[0].anchor.locked=!1},isDropAllowed:function(){return c.isDropAllowed.apply(c,arguments)},isRedrop:function(t){return null!=t.suspendedElement&&null!=t.suspendedEndpoint&&t.suspendedEndpoint.element===i.el},getEndpoint:function(e){var r=i.def.endpoint;if(null==r||null==r._jsPlumb){var o=n.deriveEndpointAndAnchorSpec(e.getType().join(" "),!0),a=o.endpoints?t.jsPlumb.extend(s,{endpoint:i.def.def.endpoint||o.endpoints[1]}):s;o.anchors&&(a=t.jsPlumb.extend(a,{anchor:i.def.def.anchor||o.anchors[1]})),(r=n.addEndpoint(i.el,a))._mtNew=!0}if(s.uniqueEndpoint&&(i.def.endpoint=r),r.setDeleteOnEmpty(!0),e.isDetachable()&&r.initDraggable(),null!=r.anchor.positionFinder){var l=n.getUIPosition(arguments,n.getZoom()),c=n.getOffset(i.el),h=n.getSize(i.el),u=null==l?[0,0]:r.anchor.positionFinder(l,c,h,r.anchor.constructorParams);r.anchor.x=u[0],r.anchor.y=u[1]}return r},maybeCleanup:function(t){t._mtNew&&0===t.connections.length?n.deleteObject({endpoint:t}):delete t._mtNew}}),u=t.jsPlumb.dragEvents.drop;return r.scope=r.scope||s.scope||n.Defaults.Scope,r[u]=e.wrap(r[u],h,!0),r.rank=s.rank||0,l&&(r[t.jsPlumb.dragEvents.over]=function(){return!0}),!1===s.allowLoopback&&(r.canDrop=function(t){return t.getDragElement()._jsPlumbRelatedElement!==i.el}),n.initDroppable(i.el,r,"internal"),h};this.makeTarget=function(e,i,s){var r=t.jsPlumb.extend({_jsPlumb:this},s);t.jsPlumb.extend(r,i);for(var o=r.maxConnections||-1,a=(function(e){var i=u(e),s=i.id,a=t.jsPlumb.extend({},r.dropOptions||{}),l=r.connectionType||"default";this.targetEndpointDefinitions[s]=this.targetEndpointDefinitions[s]||{},nt(s),i.el._isJsPlumbGroup&&null==a.rank&&(a.rank=-1);var c={def:t.jsPlumb.extend({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:o,enabled:!0};r.createEndpoint&&(c.uniqueEndpoint=!0,c.endpoint=n.addEndpoint(e,c.def),c.endpoint.setDeleteOnEmpty(!1)),i.def=c,this.targetEndpointDefinitions[s][l]=c,at(i,r,a,!0===r.isSource,!0),i.el._katavorioDrop[i.el._katavorioDrop.length-1].targetDef=c}).bind(this),l=e.length&&e.constructor!==String?e:[e],c=0,h=l.length;h>c;c++)a(l[c]);return this},this.unmakeTarget=function(t,e){var i=u(t);return n.destroyDroppable(i.el,"internal"),e||delete this.targetEndpointDefinitions[i.id],this},this.makeSource=function(i,s,r){var o=t.jsPlumb.extend({_jsPlumb:this},r);t.jsPlumb.extend(o,s);var a=o.connectionType||"default",l=n.deriveEndpointAndAnchorSpec(a);o.endpoint=o.endpoint||l.endpoints[0],o.anchor=o.anchor||l.anchors[0];for(var h=o.maxConnections||-1,d=o.onMaxConnections,p=(function(s){var r=s.id,l=this.getElement(s.el);this.sourceEndpointDefinitions[r]=this.sourceEndpointDefinitions[r]||{},nt(r);var u={def:t.jsPlumb.extend({},o),uniqueEndpoint:o.uniqueEndpoint,maxConnections:h,enabled:!0};o.createEndpoint&&(u.uniqueEndpoint=!0,u.endpoint=n.addEndpoint(i,u.def),u.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[r][a]=u,s.def=u;var p=t.jsPlumb.dragEvents.stop,f=t.jsPlumb.dragEvents.drag,m=t.jsPlumb.extend({},o.dragOptions||{}),g=m.drag,b=m.stop,y=null,v=!1;m.scope=m.scope||o.scope,m[f]=e.wrap(m[f],(function(){g&&g.apply(this,arguments),v=!1})),m[p]=e.wrap(m[p],(function(){if(b&&b.apply(this,arguments),this.currentlyDragging=!1,null!=y._jsPlumb){var t=o.anchor||this.Defaults.Anchor,e=y.anchor,i=y.connections[0],s=this.makeAnchor(t,r,this),a=y.element;if(null!=s.positionFinder){var l=n.getOffset(a),c=this.getSize(a),h={left:l.left+e.x*c[0],top:l.top+e.y*c[1]},u=s.positionFinder(h,l,c,s.constructorParams);s.x=u[0],s.y=u[1]}y.setAnchor(s,!0),y.repaint(),this.repaint(y.elementId),null!=i&&this.repaint(i.targetId)}}).bind(this));var x=(function(i){if(3!==i.which&&2!==i.button){r=this.getId(this.getElement(s.el));var u=this.sourceEndpointDefinitions[r][a];if(u.enabled){if(o.filter&&!1===(e.isString(o.filter)?function(t,e,i,s,n){for(var r=t.target||t.srcElement,o=!1,a=s.getSelector(e,i),l=0;l<a.length;l++)if(a[l]===r){o=!0;break}return n?!o:o}(i,s.el,o.filter,this,o.filterExclude):o.filter(i,s.el)))return;var p=this.select({source:r}).length;if(u.maxConnections>=0&&p>=u.maxConnections)return d&&d({element:s.el,maxConnections:h},i),!1;var f=t.jsPlumb.getPositionOnElement(i,l,c),g={};t.jsPlumb.extend(g,u.def),g.isTemporarySource=!0,g.anchor=[f[0],f[1],0,0],g.dragOptions=m,u.def.scope&&(g.scope=u.def.scope),y=this.addEndpoint(r,g),v=!0,y.setDeleteOnEmpty(!0),u.uniqueEndpoint&&(u.endpoint?y.finalEndpoint=u.endpoint:(u.endpoint=y,y.setDeleteOnEmpty(!1)));var b=function(){n.off(y.canvas,"mouseup",b),n.off(s.el,"mouseup",b),v&&(v=!1,n.deleteEndpoint(y))};n.on(y.canvas,"mouseup",b),n.on(s.el,"mouseup",b);var x={};if(u.def.extract)for(var C in u.def.extract){var _=(i.srcElement||i.target).getAttribute(C);_&&(x[u.def.extract[C]]=_)}n.trigger(y.canvas,"mousedown",i,x),e.consume(i)}}}).bind(this);this.on(s.el,"mousedown",x),u.trigger=x,o.filter&&(e.isString(o.filter)||e.isFunction(o.filter))&&n.setDragFilter(s.el,o.filter);var C=t.jsPlumb.extend({},o.dropOptions||{});at(s,o,C,!0,!0===o.isTarget)}).bind(this),f=i.length&&i.constructor!==String?i:[i],m=0,g=f.length;g>m;m++)p(u(f[m]));return this},this.unmakeSource=function(t,e,i){var s=u(t);n.destroyDroppable(s.el,"internal");var r=this.sourceEndpointDefinitions[s.id];if(r)for(var o in r)if(null==e||e===o){var a=r[o].trigger;a&&n.off(s.el,"mousedown",a),i||delete this.sourceEndpointDefinitions[s.id][o]}return this},this.unmakeEverySource=function(){for(var t in this.sourceEndpointDefinitions)n.unmakeSource(t,null,!0);return this.sourceEndpointDefinitions={},this};var lt=(function(t,i,s){i=e.isArray(i)?i:[i];var n=Y(t);s=s||"default";for(var r=0;r<i.length;r++){var o=this[i[r]][n];if(o&&o[s])return o[s].def.scope||this.Defaults.Scope}}).bind(this),ct=(function(t,i,s,n){s=e.isArray(s)?s:[s];var r=Y(t);n=n||"default";for(var o=0;o<s.length;o++){var a=this[s[o]][r];a&&a[n]&&(a[n].def.scope=i)}}).bind(this);this.getScope=function(t,e){return lt(t,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(t){return lt(t,"sourceEndpointDefinitions")},this.getTargetScope=function(t){return lt(t,"targetEndpointDefinitions")},this.setScope=function(t,e,i){this.setSourceScope(t,e,i),this.setTargetScope(t,e,i)},this.setSourceScope=function(t,e,i){ct(t,e,"sourceEndpointDefinitions",i),this.setDragScope(t,e)},this.setTargetScope=function(t,e,i){ct(t,e,"targetEndpointDefinitions",i),this.setDropScope(t,e)},this.unmakeEveryTarget=function(){for(var t in this.targetEndpointDefinitions)n.unmakeTarget(t,!0);return this.targetEndpointDefinitions={},this};var ht=(function(t,i,s,r,o){var a,l,c,h="source"===t?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(o=o||"default",i.length&&!e.isString(i)){a=[];for(var d=0,p=i.length;p>d;d++)h[(l=u(i[d])).id]&&h[l.id][o]&&(a[d]=h[l.id][o].enabled,h[l.id][o].enabled=c=r?!a[d]:s,n[c?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}else{var f=(l=u(i)).id;h[f]&&h[f][o]&&(a=h[f][o].enabled,h[f][o].enabled=c=r?!a:s,n[c?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}return a}).bind(this),ut=(function(t,i){if(null!=t){if(e.isString(t)||!t.length)return i.apply(this,[t]);if(t.length)return i.apply(this,[t[0]])}}).bind(this);this.toggleSourceEnabled=function(t,e){return ht("source",t,null,!0,e),this.isSourceEnabled(t,e)},this.setSourceEnabled=function(t,e,i){return ht("source",t,e,null,i)},this.isSource=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.sourceEndpointDefinitions[u(t).id];return null!=i&&null!=i[e]}).bind(this))},this.isSourceEnabled=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.sourceEndpointDefinitions[u(t).id];return i&&i[e]&&!0===i[e].enabled}).bind(this))},this.toggleTargetEnabled=function(t,e){return ht("target",t,null,!0,e),this.isTargetEnabled(t,e)},this.isTarget=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.targetEndpointDefinitions[u(t).id];return null!=i&&null!=i[e]}).bind(this))},this.isTargetEnabled=function(t,e){return e=e||"default",ut(t,(function(t){var i=this.targetEndpointDefinitions[u(t).id];return i&&i[e]&&!0===i[e].enabled}).bind(this))},this.setTargetEnabled=function(t,e,i){return ht("target",t,e,null,i)},this.ready=function(t){n.bind("ready",t)},this.repaint=function(t,e,i){return function(t,e){if("object"==typeof t&&t.length)for(var i=0,s=t.length;s>i;i++)e(t[i]);else e(t);return n}(t,(function(t){N(t,e,i)}))},this.revalidate=function(t,e,i){var s=i?t:n.getId(t);n.updateOffset({elId:s,recalc:!0,timestamp:e});var r=n.getDragManager();return r&&r.updateOffsets(s),N(t,null,e)},this.repaintEverything=function(){var t,e=jsPlumbUtil.uuid();for(t in v)n.updateOffset({elId:t,recalc:!0,timestamp:e});for(t in v)N(t,null,e);return this},this.removeAllEndpoints=function(t,e,i){i=i||[];var s=function(t){var r,o,a=u(t),l=v[a.id];if(l)for(i.push(a),r=0,o=l.length;o>r;r++)n.deleteEndpoint(l[r],!1);if(delete v[a.id],e&&a.el&&3!==a.el.nodeType&&8!==a.el.nodeType)for(r=0,o=a.el.childNodes.length;o>r;r++)s(a.el.childNodes[r])};return s(t),this};var dt=function(t,e){n.removeAllEndpoints(t.id,!0,e);for(var i=n.getDragManager(),s=function(t){i&&i.elementRemoved(t.id),n.router.elementRemoved(t.id),n.isSource(t.el)&&n.unmakeSource(t.el),n.isTarget(t.el)&&n.unmakeTarget(t.el),n.destroyDraggable(t.el),n.destroyDroppable(t.el),delete n.floatingConnections[t.id],delete C[t.id],delete _[t.id],t.el&&(n.removeElement(t.el),t.el._jsPlumb=null)},r=1;r<e.length;r++)s(e[r]);s(t)};this.remove=function(t,e){var i=u(t),s=[];return i.text&&i.el.parentNode?i.el.parentNode.removeChild(i.el):i.id&&n.batch((function(){dt(i,s)}),!0===e),n},this.empty=function(t,e){var i=[],s=function(t,e){var n=u(t);if(n.text)n.el.parentNode.removeChild(n.el);else if(n.el){for(;n.el.childNodes.length>0;)s(n.el.childNodes[0]);e||dt(n,i)}};return n.batch((function(){s(t,!0)}),!1===e),n},this.reset=function(t){n.silently((function(){st=!1,n.removeAllGroups(),n.removeGroupManager(),n.deleteEveryEndpoint(),t||n.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},y.length=0,this.doReset&&this.doReset()}).bind(this))},this.destroy=function(){this.reset(),f=null,m=null};var pt=function(t){t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),t.cleanup(),t.destroy()};this.clear=function(){n.select().each(pt),n.selectEndpoints().each(pt),v={},x={}},this.setDefaultScope=function(t){return T=t,n},this.deriveEndpointAndAnchorSpec=function(t,e){for(var i=((e?"":"default ")+t).split(/[\s]/),s=null,r=null,o=null,a=null,l=0;l<i.length;l++){var c=n.getType(i[l],"connection");c&&(c.endpoints&&(s=c.endpoints),c.endpoint&&(r=c.endpoint),c.anchors&&(a=c.anchors),c.anchor&&(o=c.anchor))}return{endpoints:s||[r,r],anchors:a||[o,o]}},this.setId=function(t,i,s){var n;e.isString(t)?n=t:(t=this.getElement(t),n=this.getId(t));var r=this.getConnections({source:n,scope:"*"},!0),o=this.getConnections({target:n,scope:"*"},!0);i=""+i,s?t=this.getElement(i):(t=this.getElement(n),this.setAttribute(t,"id",i)),v[i]=v[n]||[];for(var a=0,l=v[i].length;l>a;a++)v[i][a].setElementId(i),v[i][a].setReferenceElement(t);delete v[n],this.sourceEndpointDefinitions[i]=this.sourceEndpointDefinitions[n],delete this.sourceEndpointDefinitions[n],this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[n],delete this.targetEndpointDefinitions[n],this.router.changeId(n,i);var c=this.getDragManager();c&&c.changeId(n,i),C[i]=C[n],delete C[n];var h=function(e,s,n){for(var r=0,o=e.length;o>r;r++)e[r].endpoints[s].setElementId(i),e[r].endpoints[s].setReferenceElement(t),e[r][n+"Id"]=i,e[r][n]=t};h(r,0,"source"),h(o,1,"target"),this.repaint(i)},this.setDebugLog=function(t){g=t},this.setSuspendDrawing=function(t,e){var i=k;return k=t,E=t?(new Date).getTime():null,e&&this.repaintEverything(),i},this.isSuspendDrawing=function(){return k},this.getSuspendedAt=function(){return E},this.batch=function(t,i){var s=this.isSuspendDrawing();s||this.setSuspendDrawing(!0);try{t()}catch(n){e.log("Function run while suspended failed",n)}s||this.setSuspendDrawing(!1,!i)},this.doWhileSuspended=this.batch,this.getCachedData=function(t){var e=_[t];return e?{o:e,s:P[t]}:ot({elId:t})},this.show=function(t,e){return F(t,"block",e),n},this.toggleVisible=function(t,e){var i=null;e&&(i=function(t){var e=t.isVisible();t.setVisible(!e)}),B(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),i)},this.addListener=this.bind;var ft=[];this.registerFloatingConnection=function(t,i,s){ft[t.id]=i,e.addToList(v,t.id,s)},this.getFloatingConnectionFor=function(t){return ft[t]},this.listManager=new t.jsPlumbListManager(this,this.Defaults.ListStyle)};e.extend(t.jsPlumbInstance,e.EventGenerator,{setAttribute:function(t,e,i){this.setAttribute(t,e,i)},getAttribute:function(e,i){return this.getAttribute(t.jsPlumb.getElement(e),i)},convertToFullOverlaySpec:function(t){return e.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||e.uuid(),t},registerConnectionType:function(e,i){if(this._connectionTypes[e]=t.jsPlumb.extend({},i),i.overlays){for(var s={},n=0;n<i.overlays.length;n++){var r=this.convertToFullOverlaySpec(i.overlays[n]);s[r[1].id]=r}this._connectionTypes[e].overlays=s}},registerConnectionTypes:function(t){for(var e in t)this.registerConnectionType(e,t[e])},registerEndpointType:function(e,i){if(this._endpointTypes[e]=t.jsPlumb.extend({},i),i.overlays){for(var s={},n=0;n<i.overlays.length;n++){var r=this.convertToFullOverlaySpec(i.overlays[n]);s[r[1].id]=r}this._endpointTypes[e].overlays=s}},registerEndpointTypes:function(t){for(var e in t)this.registerEndpointType(e,t[e])},getType:function(t,e){return"connection"===e?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,e){this.setId(t,e,!0)},setParent:function(t,e){var i=this.getElement(t),s=this.getId(i),n=this.getElement(e),r=this.getId(n),o=this.getDragManager();i.parentNode.removeChild(i),n.appendChild(i),o&&o.setParent(i,s,n,r)},extend:function(t,e,i){var s;if(i)for(s=0;s<i.length;s++)t[i[s]]=e[i[s]];else for(s in e)t[s]=e[s];return t},floatingConnections:{},getFloatingAnchorIndex:function(t){return t.endpoints[0].isFloating()?0:t.endpoints[1].isFloating()?1:-1},proxyConnection:function(t,e,i,s,n,r){var o,a=t.endpoints[e].elementId,l=t.endpoints[e];t.proxies=t.proxies||[],(o=t.proxies[e]?t.proxies[e].ep:this.addEndpoint(i,{endpoint:n(t,e),anchor:r(t,e),parameters:{isProxyEndpoint:!0}})).setDeleteOnEmpty(!0),t.proxies[e]={ep:o,originalEp:l},this.router.sourceOrTargetChanged(a,s,t,i,0===e?0:1),l.detachFromConnection(t,null,!0),o.connections=[t],t.endpoints[e]=o,l.setVisible(!1),t.setVisible(!0),this.revalidate(i)},unproxyConnection:function(t,e,i){if(null!=t._jsPlumb&&null!=t.proxies&&null!=t.proxies[e]){var s=t.proxies[e].originalEp.element,n=t.proxies[e].originalEp.elementId;t.endpoints[e]=t.proxies[e].originalEp,this.router.sourceOrTargetChanged(i,n,t,s,0===e?0:1),t.proxies[e].ep.detachFromConnection(t,null),t.proxies[e].originalEp.addConnection(t),t.isVisible()&&t.proxies[e].originalEp.setVisible(!0),delete t.proxies[e]}}});var d=new u;t.jsPlumb=d,d.getInstance=function(t,e){var i=new u(t);if(e)for(var s in e)i[s]=e[s];return i.init(),i},d.each=function(t,e){if(null!=t)if("string"==typeof t)e(d.getElement(t));else if(null!=t.length)for(var i=0;i<t.length;i++)e(d.getElement(t[i]));else e(t)},"undefined"!=typeof exports&&(exports.jsPlumb=d)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s="__label",n=function(t,i){var n=e.extend({cssClass:i.cssClass,labelStyle:t.labelStyle,id:s,component:t,_jsPlumb:t._jsPlumb.instance},i);return new(e.Overlays[t._jsPlumb.instance.getRenderMode()].Label)(n)},r=function(t,s){var n=null;if(i.isArray(s)){var r=s[0],o=e.extend({component:t,_jsPlumb:t._jsPlumb.instance},s[1]);3===s.length&&e.extend(o,s[2]),n=new(e.Overlays[t._jsPlumb.instance.getRenderMode()][r])(o)}else n=s.constructor===String?new(e.Overlays[t._jsPlumb.instance.getRenderMode()][s])({component:t,_jsPlumb:t._jsPlumb.instance}):s;return n.id=n.id||i.uuid(),t.cacheTypeItem("overlay",n,n.id),t._jsPlumb.overlays[n.id]=n,n};e.OverlayCapableJsPlumbUIComponent=function(e){t.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},e.label&&(this.getDefaultType().overlays[s]=["Label",{label:e.label,location:e.labelLocation||this.defaultLabelLocation||.5,labelStyle:e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:s}]),this.setListenerComponent=function(t){if(this._jsPlumb)for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].setListenerComponent(t)}},e.OverlayCapableJsPlumbUIComponent.applyType=function(t,e){if(e.overlays){var i,s={};for(i in e.overlays){var n=t._jsPlumb.overlays[e.overlays[i][1].id];if(n)n.updateFrom(e.overlays[i][1]),s[e.overlays[i][1].id]=!0,n.reattach(t._jsPlumb.instance,t);else{var r=t.getCachedTypeItem("overlay",e.overlays[i][1].id);null!=r?(r.reattach(t._jsPlumb.instance,t),r.setVisible(!0),r.updateFrom(e.overlays[i][1]),t._jsPlumb.overlays[r.id]=r):r=t.addOverlay(e.overlays[i],!0),s[r.id]=!0}}for(i in t._jsPlumb.overlays)null==s[t._jsPlumb.overlays[i].id]&&t.removeOverlay(t._jsPlumb.overlays[i].id,!0)}},i.extend(e.OverlayCapableJsPlumbUIComponent,t.jsPlumbUIComponent,{setHover:function(t,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var i in this._jsPlumb.overlays)this._jsPlumb.overlays[i][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(t,e){var s=r(this,t);if(this.getData&&"Label"===s.type&&i.isArray(t)){var n=this.getData();if(n){var o=n?n[t[1].labelLocationAttribute||"labelLocation"]:null;o&&(s.loc=o)}}return e||this.repaint(),s},getOverlay:function(t){return this._jsPlumb.overlays[t]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var e=this.getOverlay(t);e&&e.hide()},hideOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].hide()},showOverlay:function(t){var e=this.getOverlay(t);e&&e.show()},showOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].show()},removeAllOverlays:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup&&this._jsPlumb.overlays[e].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},t||this.repaint()},removeOverlay:function(t,e){var i=this._jsPlumb.overlays[t];i&&(i.setVisible(!1),!e&&i.cleanup&&i.cleanup(),delete this._jsPlumb.overlays[t],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[t],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[t])},removeOverlays:function(){for(var t=0,e=arguments.length;e>t;t++)this.removeOverlay(arguments[t])},moveParent:function(t){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),t.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode)for(var e in this.canvas.parentNode.removeChild(this.canvas),t.appendChild(this.canvas),this._jsPlumb.overlays)if(this._jsPlumb.overlays[e].isAppendedAtTopLevel){var i=this._jsPlumb.overlays[e].getElement();i.parentNode.removeChild(i),t.appendChild(i)}},getLabel:function(){var t=this.getOverlay(s);return null!=t?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(s)},setLabel:function(t){var e=this.getOverlay(s);e?t.constructor===String||t.constructor===Function?e.setLabel(t):(t.label&&e.setLabel(t.label),t.location&&e.setLocation(t.location)):(e=n(this,t.constructor===String||t.constructor===Function?{label:t}:t),this._jsPlumb.overlays[s]=e),this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup(t),this._jsPlumb.overlays[e].destroy(t);t&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(t){this[t?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(t,e){this._jsPlumb.overlayPositions[t.id]=e},getAbsoluteOverlayPosition:function(t){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[t.id]:null},_clazzManip:function(t,e,i){if(!i)for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s][t+"Class"](e)},addClass:function(t,e){this._clazzManip("add",t,e)},removeClass:function(t,e){this._clazzManip("remove",t,e)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=function(t,e,i){var s=!1;return{drag:function(){if(s)return s=!1,!0;if(e.element){var n=i.getUIPosition(arguments,i.getZoom());null!=n&&i.setPosition(e.element,n),i.repaint(e.element,n),t.paint({anchorPoint:t.anchor.getCurrentLocation({element:t})})}},stopDrag:function(){s=!0}}},n=function(t,e,i,s){var n=e.createElement("div",{position:"absolute"});e.appendElement(n);var r=e.getId(n);e.setPosition(n,i),n.style.width=s[0]+"px",n.style.height=s[1]+"px",e.manage(r,n,!0),t.id=r,t.element=n},r=function(t,i,s,n,r,o,a,l){return a({paintStyle:t,endpoint:s,anchor:new e.FloatingAnchor({reference:i,referenceCanvas:n,jsPlumbInstance:o}),source:r,scope:l})},o=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],a=function(t,e){var i=0;if(null!=e)for(var s=0;s<t.connections.length;s++)if(t.connections[s].sourceId===e||t.connections[s].targetId===e){i=s;break}return t.connections[i]};e.Endpoint=function(t){var l=t._jsPlumb,c=t.newConnection,h=t.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:t.connectionType,maxConnections:null==t.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:t.maxConnections,paintStyle:t.endpointStyle||t.paintStyle||t.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:t.endpointHoverStyle||t.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:t.connectorStyle,connectorHoverStyle:t.connectorHoverStyle,connectorClass:t.connectorClass,connectorHoverClass:t.connectorHoverClass,connectorOverlays:t.connectorOverlays,connector:t.connector,connectorTooltip:t.connectorTooltip}),this._jsPlumb.enabled=!(!1===t.enabled),this._jsPlumb.visible=!0,this.element=e.getElement(t.source),this._jsPlumb.uuid=t.uuid,this._jsPlumb.floatingEndpoint=null;var u=null;this._jsPlumb.uuid&&(t.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=t.elementId,this.dragProxy=t.dragProxy,this._jsPlumb.connectionCost=t.connectionCost,this._jsPlumb.connectionsDirected=t.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var d=!0===t.deleteOnEmpty;this.setDeleteOnEmpty=function(t){d=t};var p=(function(){var t=l.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var i=l.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(t),this.addClass(i),e.updateClasses(this.element,i,t)}).bind(this);this.prepareAnchor=function(t){var e=this._jsPlumb.instance.makeAnchor(t,this.elementId,l);return e.bind("anchorChanged",(function(t){this.fire("anchorChanged",{endpoint:this,anchor:t}),p()}).bind(this)),e},this.setPreparedAnchor=function(t,e){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=t,p(),e||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(t,e){var i=this.prepareAnchor(t);return this.setPreparedAnchor(i,e),this};var f=(function(t){if(this.connections.length>0)for(var e=0;e<this.connections.length;e++)this.connections[e].setHover(t,!1);else this.setHover(t)}).bind(this);this.bind("mouseover",(function(){f(!0)})),this.bind("mouseout",(function(){f(!1)})),t._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(s,n){var r,o=function(t,i){var s=l.getRenderMode();if(e.Endpoints[s][t])return new e.Endpoints[s][t](i);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}},a={_jsPlumb:this._jsPlumb.instance,cssClass:t.cssClass,container:t.container,tooltip:t.tooltip,connectorTooltip:t.connectorTooltip,endpoint:this};return i.isString(s)?r=o(s,a):i.isArray(s)?(a=i.merge(s[1],a),r=o(s[0],a)):r=s.clone(),r.clone=(function(){return i.isString(s)?o(s,a):i.isArray(s)?(a=i.merge(s[1],a),o(s[0],a)):void 0}).bind(this),r.typeId=n,r},this.setEndpoint=function(t,e){var i=this.prepareEndpoint(t);this.setPreparedEndpoint(i,!0)},this.setPreparedEndpoint=function(t,e){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=t,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},e.extend(this,t,o),this.isSource=t.isSource||!1,this.isTemporarySource=t.isTemporarySource||!1,this.isTarget=t.isTarget||!1,this.connections=t.connections||[],this.connectorPointerEvents=t["connector-pointer-events"],this.scope=t.scope||l.getDefaultScope(),this.timestamp=null,this.reattachConnections=t.reattach||l.Defaults.ReattachConnections,this.connectionsDetachable=l.Defaults.ConnectionsDetachable,(!1===t.connectionsDetachable||!1===t.detachable)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=!1!==t.dragAllowedWhenFull,t.onMaxConnections&&this.bind("maxConnections",t.onMaxConnections),this.addConnection=function(t){this.connections.push(t),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)},this.detachFromConnection=function(t,e,i){(e=null==e?this.connections.indexOf(t):e)>=0&&(this.connections.splice(e,1),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)),!i&&d&&0===this.connections.length&&l.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!0!==i})},this.deleteEveryConnection=function(t){for(var e=this.connections.length,i=0;e>i;i++)l.deleteConnection(this.connections[0],t)},this.detachFrom=function(t,e,i){for(var s=[],n=0;n<this.connections.length;n++)(this.connections[n].endpoints[1]===t||this.connections[n].endpoints[0]===t)&&s.push(this.connections[n]);for(var r=0,o=s.length;o>r;r++)l.deleteConnection(s[0]);return this},this.getElement=function(){return this.element},this.setElement=function(s){var n=this._jsPlumb.instance.getId(s),r=this.elementId;return i.removeWithFunction(t.endpointsByElement[this.elementId],(function(t){return t.id===this.id}).bind(this)),this.element=e.getElement(s),this.elementId=l.getId(this.element),l.router.rehomeEndpoint(this,r,this.element),l.dragManager.endpointAdded(this.element),i.addToList(t.endpointsByElement,n,this),this},this.makeInPlaceCopy=function(){var e=this.anchor.getCurrentLocation({element:this}),i=this.anchor.getOrientation(this),s=this.anchor.getCssClass();return h({dropOptions:t.dropOptions,anchor:{bind:function(){},compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return i},getCssClass:function(){return s}},source:this.element,paintStyle:this.getPaintStyle(),endpoint:t.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(t){var e=(t=t||{}).timestamp,i=!(!1===t.recalc);if(!e||this.timestamp!==e){var s=l.updateOffset({elId:this.elementId,timestamp:e}),n=t.offset?t.offset.o:s.o;if(null!=n){var r=t.anchorPoint,o=t.connectorPaintStyle;if(null==r){var c={xy:[n.left,n.top],wh:t.dimensions||s.s,element:this,timestamp:e};if(i&&this.anchor.isDynamic&&this.connections.length>0){var h=a(this,t.elementWithPrecedence),u=h.endpoints[0]===this?1:0,d=0===u?h.sourceId:h.targetId,p=l.getCachedData(d),f=p.o,m=p.s;c.index=0===u?1:0,c.connection=h,c.txy=[f.left,f.top],c.twh=m,c.tElement=h.endpoints[u],c.tRotation=l.getRotation(d)}else this.connections.length>0&&(c.connection=this.connections[0]);c.rotation=l.getRotation(this.elementId),r=this.anchor.compute(c)}for(var g in this.endpoint.compute(r,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,o||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=e,this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(g)){var b=this._jsPlumb.overlays[g];b.isVisible()&&(this._jsPlumb.overlayPlacements[g]=b.draw(this.endpoint,this._jsPlumb.paintStyleInUse),b.paint(this._jsPlumb.overlayPlacements[g]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var m=!1;this.initDraggable=function(){if(!m&&e.isDragSupported(this.element)){var o,a={id:null,element:null},d=null,p=!1,f=null,g=s(this,a,l),b=t.dragOptions||{},y=e.dragEvents.start,v=e.dragEvents.stop,x=e.dragEvents.drag,C=e.dragEvents.beforeStart,_=(function(i){d=this.connectorSelector();var s=!0;this.isEnabled()||(s=!1),null!=d||this.isSource||this.isTemporarySource||(s=!1),!this.isSource||!this.isFull()||null!=d&&this.dragAllowedWhenFull||(s=!1),null==d||d.isDetachable(this)||(this.isFull()?s=!1:d=null);var u=l.checkCondition(null==d?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:d});if(!1===u?s=!1:"object"==typeof u?e.extend(u,o||{}):u=o||{},!1===s)return l.stopDrag&&l.stopDrag(this.canvas),g.stopDrag(),!1;for(var m=0;m<this.connections.length;m++)this.connections[m].setHover(!1);this.addClass("endpointDrag"),l.setConnectionBeingDragged(!0),d&&!this.isFull()&&this.isSource&&(d=null),l.updateOffset({elId:this.elementId});var b=this._jsPlumb.instance.getOffset(this.canvas),y=this.canvas,v=this._jsPlumb.instance.getSize(this.canvas);n(a,l,b,v),l.setAttributes(this.canvas,{dragId:a.id,elId:this.elementId});var x=this.dragProxy||this.endpoint;if(null==this.dragProxy&&null!=this.connectionType){var C=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);C.endpoints[1]&&(x=C.endpoints[1])}var _=this._jsPlumb.instance.makeAnchor("Center");_.isFloating=!0,this._jsPlumb.floatingEndpoint=r(this.getPaintStyle(),_,x,this.canvas,a.element,l,h,this.scope);var w=this._jsPlumb.floatingEndpoint.anchor;if(null==d)this.setHover(!1,!1),(d=c({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:a.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:t.connectorStyle,hoverPaintStyle:t.connectorHoverStyle,connector:t.connector,overlays:t.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:t.scope,data:u})).pending=!0,d.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.anchor=w,l.fire("connectionDrag",d),l.router.newConnection(d);else{p=!0,d.setHover(!1);var S=d.endpoints[0].id===this.id?0:1;this.detachFromConnection(d,null,!0);var P=l.getDragScope(y);l.setAttribute(this.canvas,"originalScope",P),l.fire("connectionDrag",d),0===S?(f=[d.source,d.sourceId,y,P],l.router.sourceOrTargetChanged(d.endpoints[S].elementId,a.id,d,a.element,0)):(f=[d.target,d.targetId,y,P],l.router.sourceOrTargetChanged(d.endpoints[S].elementId,a.id,d,a.element,1)),d.suspendedEndpoint=d.endpoints[S],d.suspendedElement=d.endpoints[S].getElement(),d.suspendedElementId=d.endpoints[S].elementId,d.suspendedElementType=0===S?"source":"target",d.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=d.suspendedEndpoint,d.endpoints[S]=this._jsPlumb.floatingEndpoint,d.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass)}l.registerFloatingConnection(a,d,this._jsPlumb.floatingEndpoint),l.currentlyDragging=!0}).bind(this),w=(function(){if(l.setConnectionBeingDragged(!1),d&&null!=d.endpoints){var t=l.getDropEvent(arguments),e=l.getFloatingAnchorIndex(d);if(d.endpoints[0===e?1:0].anchor.locked=!1,d.removeClass(l.draggingClass),this._jsPlumb&&(d.deleteConnectionNow||d.endpoints[e]===this._jsPlumb.floatingEndpoint)&&p&&d.suspendedEndpoint){0===e?(d.floatingElement=d.source,d.floatingId=d.sourceId,d.floatingEndpoint=d.endpoints[0],d.floatingIndex=0,d.source=f[0],d.sourceId=f[1]):(d.floatingElement=d.target,d.floatingId=d.targetId,d.floatingEndpoint=d.endpoints[1],d.floatingIndex=1,d.target=f[0],d.targetId=f[1]);var i=this._jsPlumb.floatingEndpoint;l.setDragScope(f[2],f[3]),d.endpoints[e]=d.suspendedEndpoint,d.isReattach()||d._forceReattach||d._forceDetach||!l.deleteConnection(d,{originalEvent:t})?(d.setHover(!1),d._forceDetach=null,d._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(d),d.suspendedEndpoint.addConnection(d),1===e?l.router.sourceOrTargetChanged(d.floatingId,d.targetId,d,d.target,e):l.router.sourceOrTargetChanged(d.floatingId,d.sourceId,d,d.source,e),l.repaint(f[1])):l.deleteObject({endpoint:i})}this.deleteAfterDragStop?l.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),l.fire("connectionDragStop",d,t),d.pending&&l.fire("connectionAborted",d,t),l.currentlyDragging=!1,d.suspendedElement=null,d.suspendedEndpoint=null,d=null}a&&a.element&&l.remove(a.element,!1,!1),u&&l.deleteObject({endpoint:u}),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}).bind(this);(b=e.extend({},b)).scope=this.scope||b.scope,b[C]=i.wrap(b[C],(function(t){o=t.e.payload||{}}),!1),b[y]=i.wrap(b[y],_,!1),b[x]=i.wrap(b[x],g.drag),b[v]=i.wrap(b[v],w),b.multipleDrop=!1,b.canDrag=(function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&!1!==this.connectionsDetachable}).bind(this),l.initDraggable(this.canvas,b,"internal"),this.canvas._jsPlumbRelatedElement=this.element,m=!0}};var g=t.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(g,!0);var b=t.anchor?t.anchor:t.anchors?t.anchors:l.Defaults.Anchor||"Top";this.setAnchor(b,!0);var y=["default",t.type||""].join(" ");this.addType(y,t.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var v=(function(s,n,r,o){if(e.isDropSupported(this.element)){var a=t.dropOptions||l.Defaults.DropOptions||e.Defaults.DropOptions;(a=e.extend({},a)).scope=a.scope||this.scope;var c=e.dragEvents.drop,h=e.dragEvents.over,u=e.dragEvents.out,d=this,p=l.EndpointDropHandler({getEndpoint:function(){return d},jsPlumb:l,enabled:function(){return null==r||r.isEnabled()},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(t){d.addClass(t)},removeClass:function(t){d.removeClass(t)},isDropAllowed:function(){return d.isDropAllowed.apply(d,arguments)},reference:o,isRedrop:function(t,e){return t.suspendedEndpoint&&e.reference&&t.suspendedEndpoint.id===e.reference.id}});a[c]=i.wrap(a[c],p,!0),a[h]=i.wrap(a[h],(function(){var t=e.getDragObject(arguments),i=l.getAttribute(e.getElement(t),"dragId"),s=l.getFloatingConnectionFor(i);if(null!=s){var n=l.getFloatingAnchorIndex(s),r=this.isTarget&&0!==n||s.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===s.suspendedEndpoint.id;if(r){var o=l.checkCondition("checkDropAllowed",{sourceEndpoint:s.endpoints[n],targetEndpoint:this,connection:s});this[(o?"add":"remove")+"Class"](l.endpointDropAllowedClass),this[(o?"remove":"add")+"Class"](l.endpointDropForbiddenClass),s.endpoints[n].anchor.over(this.anchor,this)}}}).bind(this)),a[u]=i.wrap(a[u],(function(){var t=e.getDragObject(arguments),i=null==t?null:l.getAttribute(e.getElement(t),"dragId"),s=i?l.getFloatingConnectionFor(i):null;if(null!=s){var n=l.getFloatingAnchorIndex(s),r=this.isTarget&&0!==n||s.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===s.suspendedEndpoint.id;r&&(this.removeClass(l.endpointDropAllowedClass),this.removeClass(l.endpointDropForbiddenClass),s.endpoints[n].anchor.out())}}).bind(this)),l.initDroppable(s,a,"internal",n)}}).bind(this);return this.anchor.isFloating||v(this.canvas,!(t._transient||this.anchor.isFloating),this,t.reference),this},i.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(t,e,i){if(this._jsPlumb.visible=t,this.canvas&&(this.canvas.style.display=t?"block":"none"),this[t?"showOverlays":"hideOverlays"](),!e)for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(t),!i){var n=this===this.connections[s].endpoints[0]?1:0;1===this.connections[s].endpoints[n].connections.length&&this.connections[s].endpoints[n].setVisible(t,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(t,i){this.setPaintStyle(t.endpointStyle||t.paintStyle,i),this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,i),null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections),t.scope&&(this.scope=t.scope),e.extend(this,t,o),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){e.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"")),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(t){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(t)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(t){var e=!1;if(t)for(var i=0;i<this.connections.length;i++)if(this.connections[i].endpoints[1]===t||this.connections[i].endpoints[0]===t){e=!0;break}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t,this.anchor.elementId=t},setReferenceElement:function(t){this.element=e.getElement(t)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}}),t.jsPlumbInstance.prototype.EndpointDropHandler=function(t){return function(e){var s=t.jsPlumb;t.removeClass(s.endpointDropAllowedClass),t.removeClass(s.endpointDropForbiddenClass);var n=s.getDropEvent(arguments),r=s.getDragObject(arguments),o=s.getAttribute(r,"dragId"),a=(s.getAttribute(r,"elId"),s.getAttribute(r,"originalScope")),l=s.getFloatingConnectionFor(o);if(null!=l){var c=null!=l.suspendedEndpoint;if(!c||null!=l.suspendedEndpoint._jsPlumb){var h=t.getEndpoint(l);if(null!=h){if(t.isRedrop(l,t))return l._forceReattach=!0,l.setHover(!1),void(t.maybeCleanup&&t.maybeCleanup(h));var u=s.getFloatingAnchorIndex(l);if(0===u&&!t.isSource||1===u&&!t.isTarget)return void(t.maybeCleanup&&t.maybeCleanup(h));t.onDrop&&t.onDrop(l),a&&s.setDragScope(r,a);var d=t.isFull(e);if(d&&h.fire("maxConnections",{endpoint:this,connection:l,maxConnections:h._jsPlumb.maxConnections},n),!d&&t.enabled()){var p=!0;0===u?(l.floatingElement=l.source,l.floatingId=l.sourceId,l.floatingEndpoint=l.endpoints[0],l.floatingIndex=0,l.source=t.element,l.sourceId=s.getId(t.element)):(l.floatingElement=l.target,l.floatingId=l.targetId,l.floatingEndpoint=l.endpoints[1],l.floatingIndex=1,l.target=t.element,l.targetId=s.getId(t.element)),c&&l.suspendedEndpoint.id!==h.id&&(l.isDetachAllowed(l)&&l.endpoints[u].isDetachAllowed(l)&&l.suspendedEndpoint.isDetachAllowed(l)&&s.checkCondition("beforeDetach",l)||(p=!1));var f=(function(e){l.endpoints[u].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),l.endpoints[u]=h,h.addConnection(l);var r=h.getParameters();for(var o in r)l.setParameter(o,r[o]);if(c){var a=l.suspendedEndpoint.elementId;s.fireMoveEvent({index:u,originalSourceId:0===u?a:l.sourceId,newSourceId:0===u?h.elementId:l.sourceId,originalTargetId:1===u?a:l.targetId,newTargetId:1===u?h.elementId:l.targetId,originalSourceEndpoint:0===u?l.suspendedEndpoint:l.endpoints[0],newSourceEndpoint:0===u?h:l.endpoints[0],originalTargetEndpoint:1===u?l.suspendedEndpoint:l.endpoints[1],newTargetEndpoint:1===u?h:l.endpoints[1],connection:l},n)}else r.draggable&&s.initDraggable(this.element,t.dragOptions,"internal",s);1===u?s.router.sourceOrTargetChanged(l.floatingId,l.targetId,l,l.target,1):s.router.sourceOrTargetChanged(l.floatingId,l.sourceId,l,l.source,0),l.endpoints[0].finalEndpoint&&(l.endpoints[0].detachFromConnection(l),l.endpoints[0]=l.endpoints[0].finalEndpoint,l.endpoints[0].addConnection(l)),i.isObject(e)&&l.mergeData(e),s.finaliseConnection(l,null,n,!1),l.setHover(!1),s.revalidate(l.endpoints[0].element)}).bind(this),m=function(){l.suspendedEndpoint&&(l.endpoints[u]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,0===u?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),1===u?s.router.sourceOrTargetChanged(l.floatingId,l.targetId,l,l.target,1):s.router.sourceOrTargetChanged(l.floatingId,l.sourceId,l,l.source,0),s.repaint(l.sourceId),l._forceDetach=!1)};if(p=p&&t.isDropAllowed(l.sourceId,l.targetId,l.scope,l,h))return f(p),!0;m()}t.maybeCleanup&&t.maybeCleanup(h),s.currentlyDragging=!1}}}}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=function(t,s,n,r,o){if(e.Connectors[s]=e.Connectors[s]||{},null==e.Connectors[s][n]){if(null==e.Connectors[n]){if(t.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+n+"'")}e.Connectors[s][n]=function(){e.Connectors[n].apply(this,arguments),e.ConnectorRenderers[s].apply(this,arguments)},i.extend(e.Connectors[s][n],[e.Connectors[n],e.ConnectorRenderers[s]])}return new e.Connectors[s][n](r,o)},n=function(t,e,i){return t?i.makeAnchor(t,e,i):null},r=function(t,e,s,n){null!=e&&(e._jsPlumbConnections=e._jsPlumbConnections||{},n?delete e._jsPlumbConnections[t.id]:e._jsPlumbConnections[t.id]=!0,i.isEmpty(e._jsPlumbConnections)?s.removeClass(e,s.connectedClass):s.addClass(e,s.connectedClass))};e.Connection=function(t){var s=t.newEndpoint;this.id=t.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=t.previousConnection,this.source=e.getElement(t.source),this.target=e.getElement(t.target),e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),t.sourceEndpoint?(this.source=t.sourceEndpoint.getElement(),this.sourceId=t.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),t.targetEndpoint?(this.target=t.targetEndpoint.getElement(),this.targetId=t.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var n=this._jsPlumb.instance;n.manage(this.sourceId,this.source),n.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams,overlays:t.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",(function(){this.setHover(!0)}).bind(this)),this.bind("mouseout",(function(){this.setHover(!1)}).bind(this)),this.makeEndpoint=function(e,i,r,o,a){return r=r||this._jsPlumb.instance.getId(i),this.prepareEndpoint(n,s,this,o,e?0:1,t,i,r,a)},t.type&&(t.endpoints=t.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(t.type).endpoints);var r=this.makeEndpoint(!0,this.source,this.sourceId,t.sourceEndpoint),o=this.makeEndpoint(!1,this.target,this.targetId,t.targetEndpoint);r&&i.addToList(t.endpointsByElement,this.sourceId,r),o&&i.addToList(t.endpointsByElement,this.targetId,o),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnEmpty&&(this.endpoints[0].setDeleteOnEmpty(t.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(t.deleteEndpointsOnEmpty));var a=n.Defaults.ConnectionsDetachable;!1===t.detachable&&(a=!1),!1===this.endpoints[0].connectionsDetachable&&(a=!1),!1===this.endpoints[1].connectionsDetachable&&(a=!1);var l=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||n.Defaults.ReattachConnections;this.appendToDefaultType({detachable:a,reattach:l,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||n.Defaults.PaintStyle||e.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||n.Defaults.HoverPaintStyle||e.Defaults.HoverPaintStyle});var c=n.getSuspendedAt();if(!n.isSuspendDrawing()){var h=n.getCachedData(this.sourceId),u=h.o,d=h.s,p=n.getCachedData(this.targetId),f=p.o,m=p.s,g=c||jsPlumbUtil.uuid(),b=this.endpoints[0].anchor.compute({xy:[u.left,u.top],wh:d,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[f.left,f.top],twh:m,tElement:this.endpoints[1],timestamp:g,rotation:n.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:b,timestamp:g}),b=this.endpoints[1].anchor.compute({xy:[f.left,f.top],wh:m,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[u.left,u.top],twh:d,tElement:this.endpoints[0],timestamp:g,rotation:n.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:b,timestamp:g})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(t){return!1!==this._jsPlumb.detachable&&(null!=t?!0===t.connectionsDetachable:!0===this._jsPlumb.detachable)},this.setDetachable=function(t){this._jsPlumb.detachable=!0===t},this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections},this.setReattach=function(t){this._jsPlumb.reattach=!0===t},this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var y=e.extend({},this.endpoints[1].getParameters());e.extend(y,this.endpoints[0].getParameters()),e.extend(y,this.getParameters()),this.setParameters(y),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||n.Defaults.Connector||e.Defaults.Connector,!0);var v=null!=t.data&&i.isObject(t.data)?t.data:{};this.getData=function(){return v},this.setData=function(t){v=t||{}},this.mergeData=function(t){v=e.extend(v,t)};var x=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,t.type].join(" ");/[^\s]/.test(x)&&this.addType(x,t.data,!0),this.updateConnectedClass()},i.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(t,i,s){var n=null;null!=t.connector&&(null==(n=this.getCachedTypeItem("connector",s.connector))&&(n=this.prepareConnector(t.connector,s.connector),this.cacheTypeItem("connector",n,s.connector)),this.setPreparedConnector(n)),null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var r=null;t.anchor?null==(r=this.getCachedTypeItem("anchors",s.anchor))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",r,s.anchor)):t.anchors&&null==(r=this.getCachedTypeItem("anchors",s.anchors))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",r,s.anchors)),null!=r&&(this.endpoints[0].anchor=r[0],this.endpoints[1].anchor=r[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(t,e){e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,e){e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this.connector&&this.connector.setVisible(t),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(t){this._jsPlumb&&(r(this,this.source,this._jsPlumb.instance,t),r(this,this.target,this._jsPlumb.instance,t))},setHover:function(e){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(e),t.jsPlumb[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),t.jsPlumb[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(t,e){var n,r={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},o=this._jsPlumb.instance.getRenderMode();return i.isString(t)?n=s(this._jsPlumb.instance,o,t,r,this):i.isArray(t)&&(n=s(this._jsPlumb.instance,o,t[0],1===t.length?r:i.merge(t[1],r),this)),null!=e&&(n.typeId=e),n},setPreparedConnector:function(t,e,i,s){if(this.connector!==t){var n,r="";if(null!=this.connector&&(r=(n=this.connector).getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=t,s&&this.cacheTypeItem("connector",t,s),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(r),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=n)for(var o=this.getOverlays(),a=0;a<o.length;a++)o[a].transfer&&o[a].transfer(this.connector);i||this.setListenerComponent(this.connector),e||this.repaint()}},setConnector:function(t,e,i,s){var n=this.prepareConnector(t,s);this.setPreparedConnector(n,e,i,s)},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){var e=(t=t||{}).timestamp,i=this.targetId;if(null==e||e!==this._jsPlumb.lastPaintedAt){var s=this._jsPlumb.instance.updateOffset({elId:this.sourceId}).o,n=this._jsPlumb.instance.updateOffset({elId:i}).o,r=this.endpoints[0],o=this.endpoints[1],a=r.anchor.getCurrentLocation({xy:[s.left,s.top],wh:[s.width,s.height],element:r,timestamp:e,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),l=o.anchor.getCurrentLocation({xy:[n.left,n.top],wh:[n.width,n.height],element:o,timestamp:e,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:a,targetPos:l,sourceOrientation:r.anchor.getOrientation(r),targetOrientation:o.anchor.getOrientation(o),sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:s,targetInfo:n});var c={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var h in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(h)){var u=this._jsPlumb.overlays[h];u.isVisible()&&(this._jsPlumb.overlayPlacements[h]=u.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(u)),c.minX=Math.min(c.minX,this._jsPlumb.overlayPlacements[h].minX),c.maxX=Math.max(c.maxX,this._jsPlumb.overlayPlacements[h].maxX),c.minY=Math.min(c.minY,this._jsPlumb.overlayPlacements[h].minY),c.maxY=Math.max(c.maxY,this._jsPlumb.overlayPlacements[h].maxY))}var d=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,p=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),f={xmin:Math.min(this.connector.bounds.minX-(d+p),c.minX),ymin:Math.min(this.connector.bounds.minY-(d+p),c.minY),xmax:Math.max(this.connector.bounds.maxX+(d+p),c.maxX),ymax:Math.max(this.connector.bounds.maxY+(d+p),c.maxY)};for(var m in this.connector.paintExtents=f,this.connector.paint(this._jsPlumb.paintStyleInUse,null,f),this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(m)){var g=this._jsPlumb.overlays[m];g.isVisible()&&g.paint(this._jsPlumb.overlayPlacements[m],f)}}this._jsPlumb.lastPaintedAt=e}},repaint:function(t){var e=jsPlumb.extend(t||{},{});e.elId=this.sourceId,this.paint(e)},prepareEndpoint:function(t,i,s,r,o,a,l,c,h){var u;if(r)s.endpoints[o]=r,r.addConnection(s);else{a.endpoints||(a.endpoints=[null,null]);var d=h||a.endpoints[o]||a.endpoint||t.Defaults.Endpoints[o]||e.Defaults.Endpoints[o]||t.Defaults.Endpoint||e.Defaults.Endpoint;a.endpointStyles||(a.endpointStyles=[null,null]),a.endpointHoverStyles||(a.endpointHoverStyles=[null,null]);var p=a.endpointStyles[o]||a.endpointStyle||t.Defaults.EndpointStyles[o]||e.Defaults.EndpointStyles[o]||t.Defaults.EndpointStyle||e.Defaults.EndpointStyle;null==p.fill&&null!=a.paintStyle&&(p.fill=a.paintStyle.stroke),null==p.outlineStroke&&null!=a.paintStyle&&(p.outlineStroke=a.paintStyle.outlineStroke),null==p.outlineWidth&&null!=a.paintStyle&&(p.outlineWidth=a.paintStyle.outlineWidth);var f=a.endpointHoverStyles[o]||a.endpointHoverStyle||t.Defaults.EndpointHoverStyles[o]||e.Defaults.EndpointHoverStyles[o]||t.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle;null!=a.hoverPaintStyle&&(null==f&&(f={}),null==f.fill&&(f.fill=a.hoverPaintStyle.stroke));var m=a.anchors?a.anchors[o]:a.anchor?a.anchor:n(t.Defaults.Anchors[o],c,t)||n(e.Defaults.Anchors[o],c,t)||n(t.Defaults.Anchor,c,t)||n(e.Defaults.Anchor,c,t);u=i({paintStyle:p,hoverPaintStyle:f,endpoint:d,connections:[s],uuid:a.uuids?a.uuids[o]:null,anchor:m,source:l,scope:a.scope,reattach:a.reattach||t.Defaults.ReattachConnections,detachable:a.detachable||t.Defaults.ConnectionsDetachable}),null==r&&u.setDeleteOnEmpty(!0),s.endpoints[o]=u,!1===a.drawEndpoints&&u.setVisible(!1,!0,!0)}return u},replaceEndpoint:function(t,e){var i=this.endpoints[t],s=i.elementId,n=this._jsPlumb.instance.getEndpoints(s),r=n.indexOf(i),o=this.makeEndpoint(0===t,i.element,s,null,e);this.endpoints[t]=o,n.splice(r,1,o),this._jsPlumb.instance.deleteObject({endpoint:i,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:i,current:o}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=t.jsPlumb;i.AnchorManager=function(t){var s={},n={},r={},o={},a=this,l={},c=t.jsPlumbInstance,h={},u=function(t,e){return e[0][0]-t[0][0]},d=function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])-(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])},p={top:d,right:u,bottom:u,left:d},f=function(t,e){var i=c.getCachedData(t),s=i.s,o=i.o,a=function(e,i,s,o,a,l,h){if(o.length>0)for(var u=function(t,e,i,s,n,r,o,a){for(var l=[],c=e[n?0:1]/(s.length+1),h=0;h<s.length;h++){var u=(h+1)*c,d=r*e[n?1:0];o&&(u=e[n?0:1]-u);var p=n?u:d,f=i.left+p,m=p/e[0],g=n?d:u,b=i.top+g,y=g/e[1];if(0!==a){var v=jsPlumbUtil.rotatePoint([f,b],[i.centerx,i.centery],a);f=v[0],b=v[1]}l.push([f,b,m,y,s[h][1],s[h][2]])}return l}(0,i,s,function(t,e){return t.sort(e)}(o,p[e]),a,l,"right"===e||"top"===e,c.getRotation(t)),d=function(t,e){n[t.id]=[e[0],e[1],e[2],e[3]],r[t.id]=h},f=0;f<u.length;f++){var m=u[f][4],g=m.endpoints[1].elementId===t;m.endpoints[0].elementId===t&&d(m.endpoints[0],u[f]),g&&d(m.endpoints[1],u[f])}};a("bottom",s,o,e.bottom,!0,1,[0,1]),a("top",s,o,e.top,!0,0,[0,-1]),a("left",s,o,e.left,!1,0,[-1,0]),a("right",s,o,e.right,!1,1,[1,0])};this.reset=function(){s={},o={},l={}},this.addFloatingConnection=function(t,e){h[t]=e},this.newConnection=function(t){var s=t.sourceId,n=t.targetId,r=t.endpoints,a=!0,l=function(l,c,h,u,d){s===n&&h.isContinuous&&(t._jsPlumb.instance.removeElement(r[1].canvas),a=!1),e.addToList(o,u,[d,c,h.constructor===i.DynamicAnchor])};l(0,r[0],r[0].anchor,n,t),a&&l(0,r[1],r[1].anchor,s,t)};var m=function(t){!function(t,i){if(t){var s=function(t){return t[4]===i};e.removeWithFunction(t.top,s),e.removeWithFunction(t.left,s),e.removeWithFunction(t.bottom,s),e.removeWithFunction(t.right,s)}}(l[t.elementId],t.id)};this.connectionDetached=function(t,i){var s=t.connection||t,n=t.targetId,r=function(t,i,s,n,r){e.removeWithFunction(o[n],(function(t){return t[0].id===r.id}))};r(0,0,0,t.sourceId,s),r(0,0,0,n,s),s.floatingId&&(r(0,0,0,s.floatingId,s),m(s.floatingEndpoint)),m(s.endpoints[0]),m(s.endpoints[1]),i||(a.redraw(s.sourceId),s.targetId!==s.sourceId&&a.redraw(s.targetId))},this.addEndpoint=function(t,i){e.addToList(s,i,t)},this.changeId=function(t,e){o[e]=o[t],s[e]=s[t],delete o[t],delete s[t]},this.getConnectionsFor=function(t){return o[t]||[]},this.getEndpointsFor=function(t){return s[t]||[]},this.deleteEndpoint=function(t){e.removeWithFunction(s[t.elementId],(function(e){return e.id===t.id})),m(t)},this.elementRemoved=function(t){delete h[t],delete s[t],s[t]=[]};var g=function(i,s,n,r,o,a,l,c,h,u,d,p){var f,m,g=-1,b=r.endpoints[l],y=b.id,v=[1,0][l],x=[[s,n],r,o,a,y],C=i[h],_=b._continuousAnchorEdge?i[b._continuousAnchorEdge]:null;if(_){var w=e.findWithFunction(_,(function(t){return t[4]===y}));if(-1!==w)for(_.splice(w,1),f=0;f<_.length;f++)e.addWithFunction(d,m=_[f][1],(function(t){return t.id===m.id})),e.addWithFunction(p,_[f][1].endpoints[l],(function(t){return t.id===m.endpoints[l].id})),e.addWithFunction(p,_[f][1].endpoints[v],(function(t){return t.id===m.endpoints[v].id}))}for(f=0;f<C.length;f++)1===t.idx&&C[f][3]===a&&-1===g&&(g=f),e.addWithFunction(d,m=C[f][1],(function(t){return t.id===m.id})),e.addWithFunction(p,C[f][1].endpoints[l],(function(t){return t.id===m.endpoints[l].id})),e.addWithFunction(p,C[f][1].endpoints[v],(function(t){return t.id===m.endpoints[v].id}));C.splice(c?-1!==g?g:0:C.length,0,x),b._continuousAnchorEdge=h};this.sourceOrTargetChanged=function(t,s,n,r,a){if(0===a){if(t!==s){n.sourceId=s,n.source=r,e.removeWithFunction(o[t],(function(t){return t[0].id===n.id}));var l=e.findWithFunction(o[n.targetId],(function(t){return t[0].id===n.id}));l>-1&&(o[n.targetId][l][0]=n,o[n.targetId][l][1]=n.endpoints[0],o[n.targetId][l][2]=n.endpoints[0].anchor.constructor===i.DynamicAnchor),e.addToList(o,s,[n,n.endpoints[1],n.endpoints[1].anchor.constructor===i.DynamicAnchor]),n.endpoints[1].anchor.isContinuous&&(n.source===n.target?n._jsPlumb.instance.removeElement(n.endpoints[1].canvas):null==n.endpoints[1].canvas.parentNode&&n._jsPlumb.instance.appendElement(n.endpoints[1].canvas)),n.updateConnectedClass()}}else if(1===a){var c=n.endpoints[0].elementId;n.target=r,n.targetId=s;var h=e.findWithFunction(o[c],(function(t){return t[0].id===n.id})),u=e.findWithFunction(o[t],(function(t){return t[0].id===n.id}));-1!==h&&(o[c][h][0]=n,o[c][h][1]=n.endpoints[1],o[c][h][2]=n.endpoints[1].anchor.constructor===i.DynamicAnchor),u>-1&&(o[t].splice(u,1),e.addToList(o,s,[n,n.endpoints[0],n.endpoints[0].anchor.constructor===i.DynamicAnchor])),n.updateConnectedClass()}},this.rehomeEndpoint=function(t,e,i){var n=s[e]||[],r=c.getId(i);if(r!==e){var o=n.indexOf(t);if(o>-1){var l=n.splice(o,1)[0];a.add(l,r)}}for(var h=0;h<t.connections.length;h++)t.connections[h].sourceId===e?a.sourceOrTargetChanged(e,t.elementId,t.connections[h],t.element,0):t.connections[h].targetId===e&&a.sourceOrTargetChanged(e,t.elementId,t.connections[h],t.element,1)},this.redraw=function(t,n,r,a,u,d){var p=[],m=[],b=[];if(!c.isSuspendDrawing()){var y=s[t]||[],v=o[t]||[];r=r||jsPlumbUtil.uuid(),a=a||{left:0,top:0},n&&(n={left:n.left+a.left,top:n.top+a.top});for(var x=c.updateOffset({elId:t,offset:n,recalc:!1,timestamp:r}),C={},_=0;_<v.length;_++){var w=v[_][0],S=w.sourceId,P=w.targetId,k=w.endpoints[0].anchor.isContinuous,E=w.endpoints[1].anchor.isContinuous;if(k||E){var T=S+"_"+P,A=C[T],O=w.sourceId===t?1:0,M=c.getRotation(P),N=c.getRotation(S);k&&!l[S]&&(l[S]={top:[],right:[],bottom:[],left:[]}),E&&!l[P]&&(l[P]={top:[],right:[],bottom:[],left:[]}),t!==P&&c.updateOffset({elId:P,timestamp:r}),t!==S&&c.updateOffset({elId:S,timestamp:r});var L=c.getCachedData(P),D=c.getCachedData(S);P===S&&(k||E)?(g(l[S],-Math.PI/2,0,w,!1,P,0,!1,"top",0,p,m),g(l[P],-Math.PI/2,0,w,!1,S,1,!1,"top",0,p,m)):(A||(A=this.calculateOrientation(S,P,D.o,L.o,w.endpoints[0].anchor,w.endpoints[1].anchor,w,N,M),C[T]=A),k&&g(l[S],A.theta,0,w,!1,P,0,!1,A.a[0],0,p,m),E&&g(l[P],A.theta2,-1,w,!0,S,1,!0,A.a[1],0,p,m)),k&&e.addWithFunction(b,S,(function(t){return t===S})),E&&e.addWithFunction(b,P,(function(t){return t===P})),e.addWithFunction(p,w,(function(t){return t.id===w.id})),(k&&0===O||E&&1===O)&&e.addWithFunction(m,w.endpoints[O],(function(t){return t.id===w.endpoints[O].id}))}}for(_=0;_<y.length;_++)0===y[_].connections.length&&y[_].anchor.isContinuous&&(l[t]||(l[t]={top:[],right:[],bottom:[],left:[]}),g(l[t],-Math.PI/2,0,{endpoints:[y[_],y[_]],paint:function(){}},!1,t,0,!1,y[_].anchor.getDefaultFace(),0,p,m),e.addWithFunction(b,t,(function(e){return e===t})));for(_=0;_<b.length;_++)f(b[_],l[b[_]]);for(_=0;_<y.length;_++)y[_].paint({timestamp:r,offset:x,dimensions:x.s,recalc:!0!==d});for(_=0;_<m.length;_++){var j=c.getCachedData(m[_].elementId);m[_].paint({timestamp:null,offset:j,dimensions:j.s})}for(_=0;_<v.length;_++){var R=v[_][1];if(R.anchor.constructor===i.DynamicAnchor){R.paint({elementWithPrecedence:t,timestamp:r}),e.addWithFunction(p,v[_][0],(function(t){return t.id===v[_][0].id}));for(var I=0;I<R.connections.length;I++)R.connections[I]!==v[_][0]&&e.addWithFunction(p,R.connections[I],(function(t){return t.id===R.connections[I].id}))}else e.addWithFunction(p,v[_][0],(function(t){return t.id===v[_][0].id}))}var B=h[t];for(B&&B.paint({timestamp:r,recalc:!1,elId:t}),_=0;_<p.length;_++)p[_].paint({elId:t,timestamp:null,recalc:!1,clearEdits:u})}return{c:p,e:m}};var b=function(t){e.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var i=t.faces||["top","right","bottom","left"],s=!(!1===t.clockwise),o={},a={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},c={top:"left",right:"top",left:"bottom",bottom:"right"},h=s?l:c,u=s?c:l,d=t.cssClass||"",p=null,f=null,m=["left","right"],g=["top","bottom"],b=null,y=0;y<i.length;y++)o[i[y]]=!0;this.getDefaultFace=function(){return 0===i.length?"top":i[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(t){return o[t]?t:o[a[t]]?a[t]:o[h[t]]?h[t]:o[u[t]]?u[t]:t},this.isEdgeSupported=function(t){return null==b?null==f?!0===o[t]:f===t:-1!==b.indexOf(t)},this.setCurrentFace=function(t,e){p=t,e&&null!=f&&(f=p)},this.getCurrentFace=function(){return p},this.getSupportedFaces=function(){var t=[];for(var e in o)o[e]&&t.push(e);return t},this.lock=function(){f=p},this.unlock=function(){f=null},this.isLocked=function(){return null!=f},this.lockCurrentAxis=function(){null!=p&&(b="left"===p||"right"===p?m:g)},this.unlockCurrentAxis=function(){b=null},this.compute=function(t){return n[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return n[t.element.id]||[0,0]},this.getOrientation=function(t){return r[t.id]||[0,0]},this.getCssClass=function(){return d}};c.continuousAnchorFactory={get:function(t){return new b(t)},clear:function(t){delete n[t]}}},i.AnchorManager.prototype.calculateOrientation=function(t,e,i,s,n,r,o,a,l){var c=["left","top","right","bottom"];if(t===e)return{orientation:"identity",a:["top","top"]};var h=Math.atan2(s.centery-i.centery,s.centerx-i.centerx),u=Math.atan2(i.centery-s.centery,i.centerx-s.centerx),d=[],p={};!function(t,e){for(var i=0;i<t.length;i++)if(p[t[i]]={left:[e[i][0].left,e[i][0].centery],right:[e[i][0].right,e[i][0].centery],top:[e[i][0].centerx,e[i][0].top],bottom:[e[i][0].centerx,e[i][0].bottom]},0!==e[i][1])for(var s in p[t[i]])p[t[i]][s]=jsPlumbUtil.rotatePoint(p[t[i]][s],[e[i][0].centerx,e[i][0].centery],e[i][1])}(["source","target"],[[i,a],[s,l]]);for(var f=0;f<c.length;f++)for(var m=0;m<c.length;m++)d.push({source:c[f],target:c[m],dist:Biltong.lineLength(p.source[c[f]],p.target[c[m]])});d.sort((function(t,e){return t.dist<e.dist?-1:t.dist>e.dist?1:0}));for(var g=d[0].source,b=d[0].target,y=0;y<d.length&&(g=n.isContinuous&&n.locked?n.getCurrentFace():!n.isContinuous||n.isEdgeSupported(d[y].source)?d[y].source:null,b=r.isContinuous&&r.locked?r.getCurrentFace():!r.isContinuous||r.isEdgeSupported(d[y].target)?d[y].target:null,null==g||null==b);y++);return n.isContinuous&&n.setCurrentFace(g),r.isContinuous&&r.setCurrentFace(b),{a:[g,b],theta:h,theta2:u}},i.Anchor=function(t){this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,this.cssClass=t.cssClass||"",this.orientation=t.orientation||[0,0],this.lastReturnValue=null,this.offsets=t.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=!1!==t.relocatable,this.snapOnRelocate=!1!==t.snapOnRelocate,this.locked=!1,e.EventGenerator.apply(this),this.compute=function(t){var e=t.xy,i=t.wh,s=t.timestamp;if(s&&s===this.timestamp)return this.lastReturnValue;var n=[e[0]+this.x*i[0]+this.offsets[0],e[1]+this.y*i[1]+this.offsets[1],this.x,this.y],r=t.rotation;if(null!=r&&0!==r){var o=jsPlumbUtil.rotatePoint(n,[e[0]+i[0]/2,e[1]+i[1]/2],r);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*o[2]-this._unrotatedOrientation[1]*o[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*o[2]+this._unrotatedOrientation[0]*o[3]),this.lastReturnValue=[o[0],o[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=n;return this.timestamp=s,this.lastReturnValue},this.getCurrentLocation=function(t){return t=t||{},null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!==t.timestamp?this.compute(t):this.lastReturnValue},this.setPosition=function(t,e,i,s,n){(!this.locked||n)&&(this.x=t,this.y=e,this.orientation=[i,s],this.lastReturnValue=null)}},e.extend(i.Anchor,e.EventGenerator,{equals:function(t){if(!t)return!1;var e=t.getOrientation(),i=this.getOrientation();return this.x===t.x&&this.y===t.y&&this.offsets[0]===t.offsets[0]&&this.offsets[1]===t.offsets[1]&&i[0]===e[0]&&i[1]===e[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),i.FloatingAnchor=function(t){i.Anchor.apply(this,arguments);var e=t.reference,s=t.referenceCanvas,n=i.getSize(s),r=0,o=0,a=null,l=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,i=[e[0]+n[0]/2,e[1]+n[1]/2];return l=i,i},this.getOrientation=function(t){if(a)return a;var i=e.getOrientation(t);return[Math.abs(i[0])*r*-1,Math.abs(i[1])*o*-1]},this.over=function(t,e){a=t.getOrientation(e)},this.out=function(){a=null},this.getCurrentLocation=function(t){return null==l?this.compute(t):l}},e.extend(i.FloatingAnchor,i.Anchor);var s=function(t,e,s){return t.constructor===i.Anchor?t:e.makeAnchor(t,s,e)};i.DynamicAnchor=function(t){i.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=t.elementId,this.jsPlumbInstance=t.jsPlumbInstance;for(var e=0;e<t.anchors.length;e++)this.anchors[e]=s(t.anchors[e],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var n=this.anchors.length>0?this.anchors[0]:null,r=n,o=function(t,e,i,s,n,r,o){var a=s[0]+t.x*n[0],l=s[1]+t.y*n[1],c=s[0]+n[0]/2,h=s[1]+n[1]/2;if(null!=r&&0!==r){var u=jsPlumbUtil.rotatePoint([a,l],[c,h],r);a=u[0],l=u[1]}return Math.sqrt(Math.pow(e-a,2)+Math.pow(i-l,2))+Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2))},a=t.selector||function(t,e,i,s,n,r,a){for(var l=i[0]+s[0]/2,c=i[1]+s[1]/2,h=-1,u=1/0,d=0;d<a.length;d++){var p=o(a[d],l,c,t,e,n,r);u>p&&(h=d+0,u=p)}return a[h]};this.compute=function(t){var e=t.xy,i=t.wh,s=t.txy,o=t.twh,l=t.rotation,c=t.tRotation;return this.timestamp=t.timestamp,this.locked||null==s||null==o?(this.lastReturnValue=n.compute(t),this.lastReturnValue):(t.timestamp=null,n=a(e,i,s,o,l,c,this.anchors),this.x=n.x,this.y=n.y,n!==r&&this.fire("anchorChanged",n),r=n,this.lastReturnValue=n.compute(t),this.lastReturnValue)},this.getCurrentLocation=function(t){return null!=n?n.getCurrentLocation(t):null},this.getOrientation=function(t){return null!=n?n.getOrientation(t):[0,0]},this.over=function(t,e){null!=n&&n.over(t,e)},this.out=function(){null!=n&&n.out()},this.setAnchor=function(t){n=t},this.getCssClass=function(){return n&&n.getCssClass()||""},this.setAnchorCoordinates=function(t){var e=jsPlumbUtil.findWithFunction(this.anchors,(function(e){return e.x===t[0]&&e.y===t[1]}));return-1!==e&&(this.setAnchor(this.anchors[e]),!0)}},e.extend(i.DynamicAnchor,i.Anchor);var n=function(t,e,s,n,r,o){i.Anchors[r]=function(i){var a=i.jsPlumbInstance.makeAnchor([t,e,s,n,0,0],i.elementId,i.jsPlumbInstance);return a.type=r,o&&o(a,i),a}};n(.5,0,0,-1,"TopCenter"),n(.5,1,0,1,"BottomCenter"),n(0,.5,-1,0,"LeftMiddle"),n(1,.5,1,0,"RightMiddle"),n(.5,0,0,-1,"Top"),n(.5,1,0,1,"Bottom"),n(0,.5,-1,0,"Left"),n(1,.5,1,0,"Right"),n(.5,.5,0,0,"Center"),n(1,0,0,-1,"TopRight"),n(1,1,0,1,"BottomRight"),n(0,0,0,-1,"TopLeft"),n(0,1,0,1,"BottomLeft"),i.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},i.Anchors.AutoDefault=function(t){var e=t.jsPlumbInstance.makeDynamicAnchor(i.Defaults.DynamicAnchors(t));return e.type="AutoDefault",e};var r=function(t,e){i.Anchors[t]=function(i){var s=i.jsPlumbInstance.makeAnchor(["Continuous",{faces:e}],i.elementId,i.jsPlumbInstance);return s.type=t,s}};i.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},r("ContinuousLeft",["left"]),r("ContinuousTop",["top"]),r("ContinuousBottom",["bottom"]),r("ContinuousRight",["right"]),n(0,0,0,0,"Assign",(function(t,e){var i=e.position||"Fixed";t.positionFinder=i.constructor===String?e.jsPlumbInstance.AnchorPositionFinders[i]:i,t.constructorParams=e})),t.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,e,i){return[(t.left-e.left)/i[0],(t.top-e.top)/i[1]]},Grid:function(t,e,i,s){var n=t.top-e.top,r=i[0]/s.grid[0],o=i[1]/s.grid[1],a=Math.floor((t.left-e.left)/r),l=Math.floor(n/o);return[(a*r+r/2)/i[0],(l*o+o/2)/i[1]]}},i.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,i=t.shape;if(!i)throw new Error("no shape supplied to Perimeter Anchor type");var s=function(){for(var t=.5,i=2*Math.PI/e,s=0,n=[],r=0;e>r;r++){var o=t+t*Math.sin(s),a=t+t*Math.cos(s);n.push([o,a,0,0]),s+=i}return n},n=function(t){for(var i=e/t.length,s=[],n=function(t,n,r,o,a,l,c){for(var h=(r-t)/(i=e*a),u=(o-n)/i,d=0;i>d;d++)s.push([t+h*d,n+u*d,null==l?0:l,null==c?0:c])},r=0;r<t.length;r++)n.apply(null,t[r]);return s},r=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i][0],t[i][1],t[i][2],t[i][3],1/t.length,t[i][4],t[i][5]]);return n(e)},o=function(){return r([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},a={Circle:s,Ellipse:s,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:o,Square:o,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var e=t.points,i=[],s=0,r=0;r<e.length-1;r++){var o=Math.sqrt(Math.pow(e[r][2]-e[r][0])+Math.pow(e[r][3]-e[r][1]));s+=o,i.push([e[r][0],e[r][1],e[r+1][0],e[r+1][1],o])}for(var a=0;a<i.length;a++)i[a][4]=i[a][4]/s;return n(i)}};if(!a[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");var l=a[i](t);t.rotation&&(l=function(t,e){for(var i=[],s=e/180*Math.PI,n=0;n<t.length;n++){var r=t[n][0]-.5,o=t[n][1]-.5;i.push([r*Math.cos(s)-o*Math.sin(s)+.5,r*Math.sin(s)+o*Math.cos(s)+.5,t[n][2],t[n][3]])}return i}(l,t.rotation));var c=t.jsPlumbInstance.makeDynamicAnchor(l);return c.type="Perimeter",c}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb;t.DefaultRouter=function(e){this.jsPlumbInstance=e,this.anchorManager=new t.AnchorManager({jsPlumbInstance:e}),this.sourceOrTargetChanged=function(t,e,i,s,n){this.anchorManager.sourceOrTargetChanged(t,e,i,s,n)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(t,e){this.anchorManager.changeId(t,e)},this.elementRemoved=function(t){this.anchorManager.elementRemoved(t)},this.newConnection=function(t){this.anchorManager.newConnection(t)},this.connectionDetached=function(t,e){this.anchorManager.connectionDetached(t,e)},this.redraw=function(t,e,i,s,n,r){return this.anchorManager.redraw(t,e,i,s,n,r)},this.deleteEndpoint=function(t){this.anchorManager.deleteEndpoint(t)},this.rehomeEndpoint=function(t,e,i){this.anchorManager.rehomeEndpoint(t,e,i)},this.addEndpoint=function(t,e){this.anchorManager.addEndpoint(t,e)}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=t.Biltong;e.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,e){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}},this.lineIntersection=function(t,e,i,s){return[]},this.boxIntersection=function(t,e,i,s){var n=[];return n.push.apply(n,this.lineIntersection(t,e,t+i,e)),n.push.apply(n,this.lineIntersection(t+i,e,t+i,e+s)),n.push.apply(n,this.lineIntersection(t+i,e+s,t,e+s)),n.push.apply(n,this.lineIntersection(t,e+s,t,e)),n},this.boundingBoxIntersection=function(t){return this.boxIntersection(t.x,t.y,t.w,t.y)}},Straight:function(t){var i,n,r,o,a,l,c,h=(e.Segments.AbstractSegment.apply(this,arguments),function(){i=Math.sqrt(Math.pow(a-o,2)+Math.pow(c-l,2)),n=s.gradient({x:o,y:l},{x:a,y:c}),r=-1/n});this.type="Straight",this.getLength=function(){return i},this.getGradient=function(){return n},this.getCoordinates=function(){return{x1:o,y1:l,x2:a,y2:c}},this.setCoordinates=function(t){o=t.x1,l=t.y1,a=t.x2,c=t.y2,h()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(o,a),minY:Math.min(l,c),maxX:Math.max(o,a),maxY:Math.max(l,c)}},this.pointOnPath=function(t,e){return 0!==t||e?1!==t||e?s.pointOnLine({x:o,y:l},{x:a,y:c},e?t>0?t:i+t:t*i):{x:a,y:c}:{x:o,y:l}},this.gradientAtPoint=function(t){return n},this.pointAlongPathFrom=function(t,e,i){var n=this.pointOnPath(t,i),r=0>=e?{x:o,y:l}:{x:a,y:c};return 0>=e&&Math.abs(e)>1&&(e*=-1),s.pointOnLine(n,r,e)};var u=function(t,e,i){return i>=Math.min(t,e)&&i<=Math.max(t,e)},d=function(t,e,i){return Math.abs(i-t)<Math.abs(i-e)?t:e};this.findClosestPointOnPath=function(t,e){var h={d:1/0,x:null,y:null,l:null,x1:o,x2:a,y1:l,y2:c};if(0===n)h.y=l,h.x=u(o,a,t)?t:d(o,a,t);else if(n===1/0||n===-1/0)h.x=o,h.y=u(l,c,e)?e:d(l,c,e);else{var p=l-n*o,f=(e-r*t-p)/(n-r),m=n*f+p;h.x=u(o,a,f)?f:d(o,a,f),h.y=u(l,c,m)?m:d(l,c,m)}var g=s.lineLength([h.x,h.y],[o,l]);return h.d=s.lineLength([t,e],[h.x,h.y]),h.l=g/i,h};var p=function(t,e,i){return i>e?t>=e&&i>=t:e>=t&&t>=i},f=p;this.lineIntersection=function(t,e,i,r){var h=Math.abs(s.gradient({x:t,y:e},{x:i,y:r})),u=Math.abs(n),d=u===1/0?o:l-u*o,p=[],m=h===1/0?t:e-h*t;if(h!==u)if(h===1/0&&0===u)f(t,o,a)&&f(l,e,r)&&(p=[t,l]);else if(0===h&&u===1/0)f(e,l,c)&&f(o,t,i)&&(p=[o,e]);else{var g,b;h===1/0?f(g=t,o,a)&&f(b=u*t+d,e,r)&&(p=[g,b]):0===h?f(b=e,l,c)&&f(g=(e-d)/u,t,i)&&(p=[g,b]):(b=u*(g=(m-d)/(u-h))+d,f(g,o,a)&&f(b,l,c)&&(p=[g,b]))}return p},this.boxIntersection=function(t,e,i,s){var n=[];return n.push.apply(n,this.lineIntersection(t,e,t+i,e)),n.push.apply(n,this.lineIntersection(t+i,e,t+i,e+s)),n.push.apply(n,this.lineIntersection(t+i,e+s,t,e+s)),n.push.apply(n,this.lineIntersection(t,e+s,t,e)),n},this.boundingBoxIntersection=function(t){return this.boxIntersection(t.x,t.y,t.w,t.h)}},Arc:function(t){var i=(e.Segments.AbstractSegment.apply(this,arguments),function(e,i){return s.theta([t.cx,t.cy],[e,i])}),n=function(t,e){if(t.anticlockwise){var i=t.startAngle<t.endAngle?t.startAngle+r:t.startAngle;return i-Math.abs(i-t.endAngle)*e}var s=Math.abs((t.endAngle<t.startAngle?t.endAngle+r:t.endAngle)-t.startAngle);return t.startAngle+s*e},r=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=i(t.x1,t.y1),this.endAngle=i(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=r),this.startAngle<0&&(this.startAngle+=r);var o=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(o-this.startAngle),this.anticlockwise&&(this.sweep=r-this.sweep);var a=2*Math.PI*this.radius,l=this.sweep/r,c=a*l;this.getLength=function(){return c},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var h=1e-10,u=function(t){var e=Math.floor(t),i=Math.ceil(t);return h>t-e?e:h>i-t?i:t};this.pointOnPath=function(e,i){if(0===e)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===e)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(e/=c);var s=n(this,e),r=t.cx+t.r*Math.cos(s),o=t.cy+t.r*Math.sin(s);return{x:u(r),y:u(o),theta:s}},this.gradientAtPoint=function(e,i){var n=this.pointOnPath(e,i),r=s.normal([t.cx,t.cy],[n.x,n.y]);return this.anticlockwise||r!==1/0&&r!==-1/0||(r*=-1),r},this.pointAlongPathFrom=function(e,i,s){var n=this.pointOnPath(e,s),r=i/a*2*Math.PI,o=n.theta+(this.anticlockwise?-1:1)*r;return{x:t.cx+this.radius*Math.cos(o),y:t.cy+this.radius*Math.sin(o)}}},Bezier:function(i){this.curve=[{x:i.x1,y:i.y1},{x:i.cp1x,y:i.cp1y},{x:i.cp2x,y:i.cp2y},{x:i.x2,y:i.y2}];var s=function(t){return t[0].x===t[1].x&&t[0].y===t[1].y},n=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},r=(function(t){var e={x:0,y:0};if(0===t)return this.curve[0];var i=this.curve.length-1;if(1===t)return this.curve[i];var s=this.curve,n=1-t;if(0===i)return this.curve[0];if(1===i)return{x:n*s[0].x+t*s[1].x,y:n*s[0].y+t*s[1].y};if(4>i){var r,o,a,l=n*n,c=t*t,h=0;return 2===i?(s=[s[0],s[1],s[2],e],r=l,o=n*t*2,a=c):3===i&&(r=l*n,o=l*t*3,a=n*c*3,h=t*c),{x:r*s[0].x+o*s[1].x+a*s[2].x+h*s[3].x,y:r*s[0].y+o*s[1].y+a*s[2].y+h*s[3].y}}return e}).bind(this),o=function(t){var e=[];t--;for(var i=0;t>=i;i++)e.push(r(i/t));return e},a=(function(){s(this.curve)&&(this.length=0);var t=o(16);this.length=0;for(var e=0;15>e;e++)this.length+=n(t[e],t[e+1])}).bind(this);e.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(i.x1,i.x2,i.cp1x,i.cp2x),minY:Math.min(i.y1,i.y2,i.cp1y,i.cp2y),maxX:Math.max(i.x1,i.x2,i.cp1x,i.cp2x),maxY:Math.max(i.y1,i.y2,i.cp1y,i.cp2y)},this.type="Bezier",a();var l=function(e,i,s){return s&&(i=t.jsBezier.locationAlongCurveFrom(e,i>0?0:1,i)),i};this.pointOnPath=function(e,i){return e=l(this.curve,e,i),t.jsBezier.pointOnCurve(this.curve,e)},this.gradientAtPoint=function(e,i){return e=l(this.curve,e,i),t.jsBezier.gradientAtPoint(this.curve,e)},this.pointAlongPathFrom=function(e,i,s){return e=l(this.curve,e,s),t.jsBezier.pointAlongCurveFrom(this.curve,e,i)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(e,i){var s=t.jsBezier.nearestPointOnCurve({x:e,y:i},this.curve);return{d:Math.sqrt(Math.pow(s.point.x-e,2)+Math.pow(s.point.y-i,2)),x:s.point.x,y:s.point.y,l:1-s.location,s:this}},this.lineIntersection=function(e,i,s,n){return t.jsBezier.lineIntersection(e,i,s,n,this.curve)}}},e.SegmentRenderer={getPath:function(t,e){return{Straight:function(e){var i=t.getCoordinates();return(e?"M "+i.x1+" "+i.y1+" ":"")+"L "+i.x2+" "+i.y2},Bezier:function(e){var i=t.params;return(e?"M "+i.x2+" "+i.y2+" ":"")+"C "+i.cp2x+" "+i.cp2y+" "+i.cp1x+" "+i.cp1y+" "+i.x1+" "+i.y1},Arc:function(e){var i=t.sweep>Math.PI?1:0;return(e?"M"+t.x1+" "+t.y1+" ":"")+"A "+t.radius+" "+t.params.r+" 0 "+i+","+(t.anticlockwise?0:1)+" "+t.x2+" "+t.y2}}[t.type](e)}};var n=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};e.Connectors.AbstractConnector=function(t){n.apply(this,arguments);var r=[],o=0,a=[],l=[],c=t.stub||0,h=i.isArray(c)?c[0]:c,u=i.isArray(c)?c[1]:c,d=t.gap||0,p=i.isArray(d)?d[0]:d,f=i.isArray(d)?d[1]:d,m=null,g=null;this.getPathData=function(){for(var t="",i=0;i<r.length;i++)t+=e.SegmentRenderer.getPath(r[i],0===i),t+=" ";return t},this.findSegmentForPoint=function(t,e){for(var i={d:1/0,s:null,x:null,y:null,l:null},s=0;s<r.length;s++){var n=r[s].findClosestPointOnPath(t,e);n.d<i.d&&(i.d=n.d,i.l=n.l,i.x=n.x,i.y=n.y,i.s=r[s],i.x1=n.x1,i.x2=n.x2,i.y1=n.y1,i.y2=n.y2,i.index=s,i.connectorLocation=a[s][0]+n.l*(a[s][1]-a[s][0]))}return i},this.lineIntersection=function(t,e,i,s){for(var n=[],o=0;o<r.length;o++)n.push.apply(n,r[o].lineIntersection(t,e,i,s));return n},this.boxIntersection=function(t,e,i,s){for(var n=[],o=0;o<r.length;o++)n.push.apply(n,r[o].boxIntersection(t,e,i,s));return n},this.boundingBoxIntersection=function(t){for(var e=[],i=0;i<r.length;i++)e.push.apply(e,r[i].boundingBoxIntersection(t));return e};var b=function(){for(var t=0,e=0;e<r.length;e++){var i=r[e].getLength();l[e]=i/o,a[e]=[t,t+=i/o]}},y=function(t,e){var i,s,n;if(e&&(t=t>0?t/o:(o+t)/o),1===t)i=r.length-1,n=1;else if(0===t)n=0,i=0;else if(t>=.5){for(i=0,n=0,s=a.length-1;s>-1;s--)if(a[s][1]>=t&&a[s][0]<=t){i=s,n=(t-a[s][0])/l[s];break}}else for(i=a.length-1,n=1,s=0;s<a.length;s++)if(a[s][1]>=t){i=s,n=(t-a[s][0])/l[s];break}return{segment:r[i],proportion:n,index:i}},v=function(t,i,s){if(s.x1!==s.x2||s.y1!==s.y2){var n=new e.Segments[i](s);r.push(n),o+=n.getLength(),t.updateBounds(n)}},x=function(){o=r.length=a.length=l.length=0};this.setSegments=function(t){m=[],o=0;for(var e=0;e<t.length;e++)m.push(t[e]),o+=t[e].getLength()},this.getLength=function(){return o};var C=function(t){this.strokeWidth=t.strokeWidth;var e=s.quadrant(t.sourcePos,t.targetPos),i=t.targetPos[0]<t.sourcePos[0],n=t.targetPos[1]<t.sourcePos[1],r=t.strokeWidth||1,o=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),a=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),l=i?t.targetPos[0]:t.sourcePos[0],c=n?t.targetPos[1]:t.sourcePos[1],d=Math.abs(t.targetPos[0]-t.sourcePos[0]),m=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===o[0]&&0===o[1]||0===a[0]&&0===a[1]){var g=d>m?0:1,b=[1,0][g];a=[],(o=[])[g]=t.sourcePos[g]>t.targetPos[g]?-1:1,a[g]=t.sourcePos[g]>t.targetPos[g]?1:-1,o[b]=0,a[b]=0}var y=i?d+p*o[0]:p*o[0],v=n?m+p*o[1]:p*o[1],x=i?f*a[0]:d+f*a[0],C=n?f*a[1]:m+f*a[1],_=o[0]*a[0]+o[1]*a[1],w={sx:y,sy:v,tx:x,ty:C,lw:r,xSpan:Math.abs(x-y),ySpan:Math.abs(C-v),mx:(y+x)/2,my:(v+C)/2,so:o,to:a,x:l,y:c,w:d,h:m,segment:e,startStubX:y+o[0]*h,startStubY:v+o[1]*h,endStubX:x+a[0]*u,endStubY:C+a[1]*u,isXGreaterThanStubTimes2:Math.abs(y-x)>h+u,isYGreaterThanStubTimes2:Math.abs(v-C)>h+u,opposite:-1===_,perpendicular:0===_,orthogonal:1===_,sourceAxis:0===o[0]?"y":"x",points:[l,c,d,m,y,v,x,C],stubs:[h,u]};return w.anchorOrientation=w.opposite?"opposite":w.orthogonal?"orthogonal":"perpendicular",w};return this.getSegments=function(){return r},this.updateBounds=function(t){var e=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,e.minX),this.bounds.maxX=Math.max(this.bounds.maxX,e.maxX),this.bounds.minY=Math.min(this.bounds.minY,e.minY),this.bounds.maxY=Math.max(this.bounds.maxY,e.maxY)},this.pointOnPath=function(t,e){var i=y(t,e);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(t,e){var i=y(t,e);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(t,e,i){var s=y(t,i);return s.segment&&s.segment.pointAlongPathFrom(s.proportion,e,!1)||[0,0]},this.compute=function(t){g=C.call(this,t),x(),this._compute(g,t),this.x=g.points[0],this.y=g.points[1],this.w=g.points[2],this.h=g.points[3],this.segment=g.segment,b()},{addSegment:v,prepareCompute:C,sourceStub:h,targetStub:u,maxStub:Math.max(h,u),sourceGap:p,targetGap:f,maxGap:Math.max(p,f)}},i.extend(e.Connectors.AbstractConnector,n),e.Endpoints.AbstractEndpoint=function(t){n.apply(this,arguments);var e=this.compute=function(t,e,i,s){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:e,cssClass:t.cssClass}},i.extend(e.Endpoints.AbstractEndpoint,n),e.Endpoints.Dot=function(t){this.type="Dot",e.Endpoints.AbstractEndpoint.apply(this,arguments),this.radius=(t=t||{}).radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,e,i,s){this.radius=i.radius||this.radius;var n=t[0]-this.radius,r=t[1]-this.radius,o=2*this.radius,a=2*this.radius;if(i.stroke){var l=i.strokeWidth||1;n-=l,r-=l,o+=2*l,a+=2*l}return[n,r,o,a,this.radius]}},i.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint),e.Endpoints.Rectangle=function(t){this.type="Rectangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),this.width=(t=t||{}).width||20,this.height=t.height||20,this._compute=function(t,e,i,s){var n=i.width||this.width,r=i.height||this.height;return[t[0]-n/2,t[1]-r/2,n,r]}},i.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var r=function(t){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};i.extend(r,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),e.Endpoints.Image=function(s){this.type="Image",r.apply(this,arguments),e.Endpoints.AbstractEndpoint.apply(this,arguments);var n=s.onload,o=s.src||s.url,a=s.cssClass?" "+s.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=s.width,this._jsPlumb.heightToUse=s.height,this._jsPlumb.endpoint=s.endpoint,this._jsPlumb.img.onload=(function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,n&&n(this))}).bind(this),this._jsPlumb.endpoint.setImage=(function(t,e){n=e,this._jsPlumb.img.src=t.constructor===String?t:t.src,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}).bind(this),this._jsPlumb.endpoint.setImage(o,n),this._compute=function(t,e,i,s){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=e.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+a),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(t,e,s){this._jsPlumb.deleted||(this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0),i.sizeElement(this.canvas,this.anchorPoint[0]-this._jsPlumb.widthToUse/2,this.anchorPoint[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse))},this.paint=function(e,i){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,i):t.setTimeout((function(){this.paint(e,i)}).bind(this),200))}},i.extend(e.Endpoints.Image,[r,e.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),e.Endpoints.Blank=function(t){e.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",r.apply(this,arguments),this._compute=function(t,e,i,s){return[t[0],t[1],10,0]};var s=t.cssClass?" "+t.cssClass:"";this.canvas=e.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+s),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(t,e){i.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},i.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,r],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),e.Endpoints.Triangle=function(t){this.type="Triangle",e.Endpoints.AbstractEndpoint.apply(this,arguments);var i=this;(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,e,s,n){var r=s.width||i.width,o=s.height||i.height;return[t[0]-r/2,t[1]-o/2,r,o]}};var o=e.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.visible=!1!==t.visible};o.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,e){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},e.Overlays.Arrow=function(t){this.type="Arrow",o.apply(this,arguments),this.isAppendedAtTopLevel=!1;var n=this;this.length=(t=t||{}).length||20,this.width=t.width||20,this.id=t.id,this.direction=(t.direction||1)<0?-1:1;var r=t.paintStyle||{"stroke-width":1},a=t.foldback||.623;this.computeMaxSize=function(){return 1.5*n.width},this.elementCreated=function(i,s){if(this.path=i,t.events)for(var n in t.events)e.on(i,n,t.events[n])},this.draw=function(t,e){var n,o,l,c;if(t.pointAlongPathFrom){if(i.isString(this.loc)||this.loc>1||this.loc<0){var h=parseInt(this.loc,10),u=this.loc<0?1:0;n=t.pointAlongPathFrom(u,h,!1),o=t.pointAlongPathFrom(u,h-this.direction*this.length/2,!1),l=s.pointOnLine(n,o,this.length)}else if(1===this.loc){if(n=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,-this.length),l=s.pointOnLine(n,o,this.length),-1===this.direction){var d=l;l=n,n=d}}else if(0===this.loc){if(l=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,this.length),n=s.pointOnLine(l,o,this.length),-1===this.direction){var p=l;l=n,n=p}}else n=t.pointAlongPathFrom(this.loc,this.direction*this.length/2),o=t.pointOnPath(this.loc),l=s.pointOnLine(n,o,this.length);return{component:t,d:{hxy:n,tail:c=s.perpendicularLineTo(n,l,this.width),cxy:s.pointOnLine(n,l,a*this.length)},"stroke-width":r.strokeWidth||e.strokeWidth,stroke:r.stroke||e.stroke,fill:r.fill||e.stroke,minX:Math.min(n.x,c[0].x,c[1].x),maxX:Math.max(n.x,c[0].x,c[1].x),minY:Math.min(n.y,c[0].y,c[1].y),maxY:Math.max(n.y,c[0].y,c[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},i.extend(e.Overlays.Arrow,o,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=null!=t.direction?t.direction:this.direction,this.foldback=t.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),e.Overlays.PlainArrow=function(t){var i=e.extend(t=t||{},{foldback:1});e.Overlays.Arrow.call(this,i),this.type="PlainArrow"},i.extend(e.Overlays.PlainArrow,e.Overlays.Arrow),e.Overlays.Diamond=function(t){var i=e.extend(t=t||{},{length:(t.length||40)/2,foldback:2});e.Overlays.Arrow.call(this,i),this.type="Diamond"},i.extend(e.Overlays.Diamond,e.Overlays.Arrow);var a=function(t,e){return(null==t._jsPlumb.cachedDimensions||e)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},l=function(t){e.jsPlumbUIComponent.apply(this,arguments),o.apply(this,arguments);var s=this.fire;this.fire=function(){s.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=!1===t.visible,this.getElement=function(){if(null==this._jsPlumb.div){var i=this._jsPlumb.div=e.getElement(this._jsPlumb.create(this._jsPlumb.component));i.style.position="absolute",jsPlumb.addClass(i,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"")),this._jsPlumb.instance.appendElement(i),this._jsPlumb.instance.getId(i),this.canvas=i;var s="translate(-50%, -50%)";i.style.webkitTransform=s,i.style.mozTransform=s,i.style.msTransform=s,i.style.oTransform=s,i.style.transform=s,i._jsPlumb=this,!1===t.visible&&(i.style.display="none")}return this._jsPlumb.div},this.draw=function(t,e,s){var n=a(this);if(null!=n&&2===n.length){var r={x:0,y:0};if(s)r={x:s[0],y:s[1]};else if(t.pointOnPath){var o=this.loc,l=!1;(i.isString(this.loc)||this.loc<0||this.loc>1)&&(o=parseInt(this.loc,10),l=!0),r=t.pointOnPath(o,l)}else{var c=this.loc.constructor===Array?this.loc:this.endpointLoc;r={x:c[0]*t.w,y:c[1]*t.h}}var h=r.x-n[0]/2,u=r.y-n[1]/2;return{component:t,d:{minx:h,miny:u,td:n,cxy:r},minX:h,maxX:h+n[0],minY:u,maxY:u+n[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};i.extend(l,[e.jsPlumbUIComponent,o],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(a(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,e){null!=this._jsPlumb.div&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var t=a(this);return Math.max(t[0],t[1])},paint:function(t,e){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),e.Overlays.Custom=function(t){this.type="Custom",l.apply(this,arguments)},i.extend(e.Overlays.Custom,l),e.Overlays.GuideLines=function(){var t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",o.apply(this,arguments),e.jsPlumbUIComponent.apply(this,arguments),this.draw=function(e,i){var n=e.pointAlongPathFrom(t.loc,t.length/2),r=e.pointOnPath(t.loc),o=s.pointOnLine(n,r,t.length),a=s.perpendicularLineTo(n,o,40),l=s.perpendicularLineTo(o,n,20);return{connector:e,head:n,tail:o,headLine:l,tailLine:a,minX:Math.min(n.x,o.x,l[0].x,l[1].x),minY:Math.min(n.y,o.y,l[0].y,l[1].y),maxX:Math.max(n.x,o.x,l[0].x,l[1].x),maxY:Math.max(n.y,o.y,l[0].y,l[1].y)}}},e.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var i=e.extend({create:function(){return e.createElement("div")}},t);if(e.Overlays.Custom.call(this,i),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var s=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif",s.style.font=this.labelStyle.font,s.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(s.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0&&(s.style.border=this.labelStyle.borderWidth+"px solid "+(this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black")),this.labelStyle.padding&&(s.style.padding=this.labelStyle.padding)}},i.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),l.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){null!=t.label&&this.setLabel(t.label)}})}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumbUtil,i=t.jsPlumbInstance,s="jtk-group-collapsed",n="jtk-group-expanded",r="stop",o="revert",a="_groupManager",l="_jsPlumbGroup",c=function(t){function i(e,i){for(var s=t.getContainer();;){if(null==e||e===s)return!1;if(e===i)return!0;e=e.parentNode}}function r(e,i){for(var s=e.getEl().querySelectorAll(".jtk-managed"),n=0;n<s.length;n++)t[i?"show":"hide"](s[n],!0)}function o(e){for(var i=e.getMembers().slice(),s=[],n=0;n<i.length;n++)Array.prototype.push.apply(s,i[n].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(i,s);var r=t.getConnections({source:i,scope:"*"},!0),o=t.getConnections({target:i,scope:"*"},!0),a={};e.connections.source.length=0,e.connections.target.length=0;var l=function(i){for(var s=0;s<i.length;s++)if(!a[i[s].id]){a[i[s].id]=!0;var n=t.getGroupFor(i[s].source),r=t.getGroupFor(i[s].target);n===e?(r!==e&&e.connections.source.push(i[s]),c[i[s].id]=e):r===e&&(e.connections.target.push(i[s]),h[i[s].id]=e)}};l(r),l(o)}var a={},c={},h={},u=this;t.bind("connection",(function(i){var s=t.getGroupFor(i.source),n=t.getGroupFor(i.target);null!=s&&null!=n&&s===n?(c[i.connection.id]=s,h[i.connection.id]=s):(null!=s&&(e.suggest(s.connections.source,i.connection),c[i.connection.id]=s),null!=n&&(e.suggest(n.connections.target,i.connection),h[i.connection.id]=n))})),t.bind("internal.connectionDetached",(function(t){!function(t){delete t.proxies;var i,s=c[t.id];null!=s&&(e.removeWithFunction(s.connections.source,i=function(e){return e.id===t.id}),e.removeWithFunction(s.connections.target,i),delete c[t.id]),null!=(s=h[t.id])&&(e.removeWithFunction(s.connections.source,i=function(e){return e.id===t.id}),e.removeWithFunction(s.connections.target,i),delete h[t.id])}(t.connection)})),t.bind("connectionMoved",(function(t){var e=(0===t.index?c:h)[t.connection.id];if(e){var i=e.connections[0===t.index?"source":"target"],s=i.indexOf(t.connection);-1!==s&&i.splice(s,1)}})),this.addGroup=function(e){t.addClass(e.getEl(),n),a[e.id]=e,e.manager=this,o(e),t.fire("group:add",{group:e})},this.addToGroup=function(e,i,s){if(e=this.getGroup(e)){var n=e.getEl();if(i._isJsPlumbGroup)return;var r=i._jsPlumbGroup;if(r!==e){t.removeFromDragSelection(i);var o=t.getOffset(i,!0),a=t.getOffset(e.collapsed?n:e.getDragArea(),!0);null!=r&&(r.remove(i,!1,s,!1,e),u.updateConnectionsForGroup(r)),e.add(i,s);var l=function(t,i){var s=0===i?1:0;t.each((function(t){t.setVisible(!1),t.endpoints[s].element._jsPlumbGroup===e?(t.endpoints[s].setVisible(!1),p(t,s,e)):(t.endpoints[i].setVisible(!1),d(t,i,e))}))};e.collapsed&&(l(t.select({source:i}),0),l(t.select({target:i}),1));var c=t.getId(i);t.dragManager.setParent(i,c,n,t.getId(n),o);var h={left:o.left-a.left,top:o.top-a.top};if(t.setPosition(i,h),t.dragManager.revalidateParent(i,c,o),u.updateConnectionsForGroup(e),t.revalidate(c),!s){var f={group:e,el:i,pos:h};r&&(f.sourceGroup=r),t.fire("group:addMember",f)}}}},this.removeFromGroup=function(t,e,s){if(t=this.getGroup(t)){if(t.collapsed){var n=function(s,n){for(var r=0;r<s.length;r++){var o=s[r];if(o.proxies)for(var a=0;a<o.proxies.length;a++)if(null!=o.proxies[a]){var l=o.proxies[a].originalEp.element;(l===e||i(l,e))&&p(o,n,t)}}};n(t.connections.source.slice(),0),n(t.connections.target.slice(),1)}t.remove(e,null,s)}},this.getGroup=function(t){var i=t;if(e.isString(t)&&null==(i=a[t]))throw new TypeError("No such group ["+t+"]");return i},this.getGroups=function(){var t=[];for(var e in a)t.push(a[e]);return t},this.removeGroup=function(e,i,s,n){e=this.getGroup(e),this.expandGroup(e,!0);var r=e[i?"removeAll":"orphanAll"](s,n);return t.remove(e.getEl()),delete a[e.id],delete t._groups[e.id],t.fire("group:remove",{group:e}),r},this.removeAllGroups=function(t,e,i){for(var s in a)this.removeGroup(a[s],t,e,i)};var d=function(e,i,s){var n=e.endpoints[0===i?1:0].element;if(!n[l]||n[l].shouldProxy()||!n[l].collapsed){var r=s.getEl(),o=t.getId(r);t.proxyConnection(e,i,r,o,(function(t,e){return s.getEndpoint(t,e)}),(function(t,e){return s.getAnchor(t,e)}))}};this.collapseGroup=function(e){if(null!=(e=this.getGroup(e))&&!e.collapsed){var i=e.getEl();if(r(e,!1),e.shouldProxy()){var o=function(t,i){for(var s=0;s<t.length;s++)d(t[s],i,e)};o(e.connections.source,0),o(e.connections.target,1)}e.collapsed=!0,t.removeClass(i,n),t.addClass(i,s),t.revalidate(i),t.fire("group:collapse",{group:e})}};var p=function(e,i,s){t.unproxyConnection(e,i,t.getId(s.getEl()))};this.expandGroup=function(e,i){if(null!=(e=this.getGroup(e))&&e.collapsed){var o=e.getEl();if(r(e,!0),e.shouldProxy()){var a=function(t,i){for(var s=0;s<t.length;s++)p(t[s],i,e)};a(e.connections.source,0),a(e.connections.target,1)}e.collapsed=!1,t.addClass(o,n),t.removeClass(o,s),t.revalidate(o),this.repaintGroup(e),i||t.fire("group:expand",{group:e})}},this.repaintGroup=function(e){for(var i=(e=this.getGroup(e)).getMembers(),s=0;s<i.length;s++)t.revalidate(i[s])},this.updateConnectionsForGroup=o,this.refreshAllGroups=function(){for(var e in a)o(a[e]),t.dragManager.updateOffsets(t.getId(a[e].getEl()))}},h=function(i,s){function n(t,e){var s=function(t){return t.offsetParent}(t),n=i.getSize(s),r=i.getSize(t),o=e[0],a=e[1];return o+r[0]>0&&o<n[0]&&a+r[1]>0&&a<n[1]}function a(t){var e=i.getId(t),s=i.getOffset(t);return t.parentNode.removeChild(t),i.getContainer().appendChild(t),i.setPosition(t,s),u(t),i.dragManager.clearParent(t,e),[e,s]}function c(t){function e(t,e,s){var r=null;if(!n(t,[e,s])){var o=t._jsPlumbGroup;x?i.remove(t):r=a(t),o.remove(t)}return r}for(var s=[],r=0;r<t.selection.length;r++)s.push(e(t.selection[r][0],t.selection[r][1].left,t.selection[r][1].top));return 1===s.length?s[0]:s}function h(t){var e=i.getId(t);i.revalidate(t),i.dragManager.revalidateParent(t,e)}function u(t){t._katavorioDrag&&((x||v)&&t._katavorioDrag.off(r,c),x||v||!y||(t._katavorioDrag.off(o,h),t._katavorioDrag.setRevert(null)))}function d(t){t._katavorioDrag&&((x||v)&&t._katavorioDrag.on(r,c),b&&t._katavorioDrag.setConstrain(!0),g&&t._katavorioDrag.setUseGhostProxy(!0),x||v||!y||(t._katavorioDrag.on(o,h),t._katavorioDrag.setRevert((function(t,e){return!n(t,e)}))))}var p=this,f=s.el;this.getEl=function(){return f},this.id=s.id||e.uuid(),f._isJsPlumbGroup=!0;var m=this.getDragArea=function(){var t=i.getSelector(f,"[jtk-group-content]");return t&&t.length>0?t[0]:f},g=!0===s.ghost,b=g||!0===s.constrain,y=!1!==s.revert,v=!0===s.orphan,x=!0===s.prune,C=!0===s.dropOverride,_=!1!==s.proxied,w=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(t,e){return s.anchor||"Continuous"},this.getEndpoint=function(t,e){return s.endpoint||["Dot",{radius:10}]},this.collapsed=!1,!1!==s.draggable){var S={drag:function(){for(var t=0;t<w.length;t++)i.draw(w[t])},stop:function(t){i.fire("groupDragStop",jsPlumb.extend(t,{group:p}))},scope:"_jsPlumbGroupDrag"};s.dragOptions&&t.jsPlumb.extend(S,s.dragOptions),i.draggable(s.el,S)}!1!==s.droppable&&i.droppable(s.el,{drop:function(t){var e=t.drag.el;if(!e._isJsPlumbGroup){var s=e._jsPlumbGroup;if(s!==p){if(null!=s&&s.overrideDrop(e,p))return;i.getGroupManager().addToGroup(p,e,!1)}}}});var P=function(t,e){for(var i=null==t.nodeType?t:[t],s=0;s<i.length;s++)e(i[s])};this.overrideDrop=function(t,e){return C&&(y||x||v)},this.add=function(t,e){var s=m();P(t,(function(t){if(null!=t._jsPlumbGroup){if(t._jsPlumbGroup===p)return;t._jsPlumbGroup.remove(t,!0,e,!1)}t._jsPlumbGroup=p,w.push(t),i.isAlreadyDraggable(t)&&d(t),t.parentNode!==s&&s.appendChild(t)})),i.getGroupManager().updateConnectionsForGroup(p)},this.remove=function(t,s,n,r,o){P(t,(function(t){if(t._jsPlumbGroup===p){if(delete t._jsPlumbGroup,e.removeWithFunction(w,(function(e){return e===t})),s)try{p.getDragArea().removeChild(t)}catch(r){jsPlumbUtil.log("Could not remove element from Group "+r)}if(u(t),!n){var a={group:p,el:t};o&&(a.targetGroup=o),i.fire("group:removeMember",a)}}})),r||i.getGroupManager().updateConnectionsForGroup(p)},this.removeAll=function(t,e){for(var s=0,n=w.length;n>s;s++){var r=w[0];p.remove(r,t,e,!0),i.remove(r,!0)}w.length=0,i.getGroupManager().updateConnectionsForGroup(p)},this.orphanAll=function(){for(var t={},e=0;e<w.length;e++){var i=a(w[e]);t[i[0]]=i[1]}return w.length=0,t},this.getMembers=function(){return w},f[l]=this,i.bind("elementDraggable",(function(t){t.el._jsPlumbGroup===this&&d(t.el)}).bind(this)),this.shouldProxy=function(){return _},i.getGroupManager().addGroup(this)};i.prototype.addGroup=function(t){var e=this;if(e._groups=e._groups||{},null!=e._groups[t.id])throw new TypeError("cannot create Group ["+t.id+"]; a Group with that ID exists");if(null!=t.el[l])throw new TypeError("cannot create Group ["+t.id+"]; the given element is already a Group");var i=new h(e,t);return e._groups[i.id]=i,t.collapsed&&this.collapseGroup(i),i},i.prototype.addToGroup=function(t,e,i){var s=(function(e){var s=this.getId(e);this.manage(s,e),this.getGroupManager().addToGroup(t,e,i)}).bind(this);if(Array.isArray(e))for(var n=0;n<e.length;n++)s(e[n]);else s(e)},i.prototype.removeFromGroup=function(t,e,i){this.getGroupManager().removeFromGroup(t,e,i),this.getContainer().appendChild(e)},i.prototype.removeGroup=function(t,e,i,s){return this.getGroupManager().removeGroup(t,e,i,s)},i.prototype.removeAllGroups=function(t,e,i){this.getGroupManager().removeAllGroups(t,e,i)},i.prototype.getGroup=function(t){return this.getGroupManager().getGroup(t)},i.prototype.getGroups=function(){return this.getGroupManager().getGroups()},i.prototype.expandGroup=function(t){this.getGroupManager().expandGroup(t)},i.prototype.collapseGroup=function(t){this.getGroupManager().collapseGroup(t)},i.prototype.repaintGroup=function(t){this.getGroupManager().repaintGroup(t)},i.prototype.toggleGroup=function(t){null!=(t=this.getGroupManager().getGroup(t))&&this.getGroupManager()[t.collapsed?"expandGroup":"collapseGroup"](t)},i.prototype.getGroupManager=function(){var t=this[a];return null==t&&(t=this[a]=new c(this)),t},i.prototype.removeGroupManager=function(){delete this[a]},i.prototype.getGroupFor=function(t){if(t=this.getElement(t)){for(var e=this.getContainer(),i=!1,s=null;!i;)null==t||t===e?i=!0:t[l]?(s=t[l],i=!0):t=t.parentNode;return s}}}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i="Straight";t.Connectors.Flowchart=function(e){this.type="Flowchart",(e=e||{}).stub=null==e.stub?30:e.stub;var s,n=t.Connectors.AbstractConnector.apply(this,arguments),r=null==e.midpoint||isNaN(e.midpoint)?.5:e.midpoint,o=!0===e.alwaysRespectStubs,a=null,l=null,c=null!=e.cornerRadius?e.cornerRadius:0,h=function(t){return 0>t?-1:0===t?0:1},u=function(t){return[h(t[2]-t[0]),h(t[3]-t[1])]},d=function(t,e,i,s){if(a!==e||l!==i){var n=null==a?s.sx:a,r=null==l?s.sy:l;a=e,l=i,t.push([n,r,e,i,n===e?"v":"h"])}},p=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},f=function(t){var e=[];return e.push.apply(e,t),e},m=function(t,e,s){for(var r,o,a,l=null,h=0;h<e.length-1;h++){if(l=l||f(e[h]),r=f(e[h+1]),o=u(l),a=u(r),c>0&&l[4]!==r[4]){var d=Math.min(p(l),p(r)),m=Math.min(c,d/2);l[2]-=o[0]*m,l[3]-=o[1]*m,r[0]+=a[0]*m,r[1]+=a[1]*m;var g=o[1]===a[0]&&1===a[0]||o[1]===a[0]&&0===a[0]&&o[0]!==a[1]||o[1]===a[0]&&-1===a[0],b=(r[1]>l[3]?1:-1)==(r[0]>l[2]?1:-1),y=b&&g||!b&&!g?r[0]:l[2],v=b&&g||!b&&!g?l[3]:r[1];n.addSegment(t,i,{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),n.addSegment(t,"Arc",{r:m,x1:l[2],y1:l[3],x2:r[0],y2:r[1],cx:y,cy:v,ac:g})}else{var x=l[2]===l[0]?0:l[2]>l[0]?s.lw/2:-s.lw/2,C=l[3]===l[1]?0:l[3]>l[1]?s.lw/2:-s.lw/2;n.addSegment(t,i,{x1:l[0]-x,y1:l[1]-C,x2:l[2]+x,y2:l[3]+C})}l=r}null!=r&&n.addSegment(t,i,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})};this.midpoint=r,this._compute=function(t,e){s=[],a=null,l=null;var i=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},c={perpendicular:i,orthogonal:i,opposite:function(e){var i=t,s="x"===e?0:1;return!o&&{x:function(){return 1===i.so[s]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1===i.so[s]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1===i.so[s]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1===i.so[s]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}}[t.anchorOrientation](t.sourceAxis),h="x"===t.sourceAxis?0:1,u="x"===t.sourceAxis?1:0,p=c[h],f=c[u],g=c[h+2],b=c[u+2];d(s,c[0],c[1],t);var y=t.startStubX+(t.endStubX-t.startStubX)*r,v=t.startStubY+(t.endStubY-t.startStubY)*r,x={x:[0,1],y:[1,0]},C={perpendicular:function(e){var i={x:[[t.startStubX,t.endStubX],null,[t.endStubX,t.startStubX]],y:[[t.startStubY,t.endStubY],null,[t.endStubY,t.startStubY]]},s={x:[t.startStubY,t.endStubY],y:[t.startStubX,t.endStubX]},n=x[e][1],r=t.so[x[e][0]]+1,o=-1===t.to[n]&&s[e][1]<s[e][0]||1===t.to[n]&&s[e][1]>s[e][0],a=i[e][r][0],l=i[e][r][1],c={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][r][t.to[n]+1];return t.segment===c[3]||t.segment===c[2]&&o?{x:[[y,t.startStubY],[y,t.endStubY]],y:[[t.startStubX,v],[t.endStubX,v]]}[e]:t.segment===c[2]&&a>l?{x:[[t.endStubX,t.startStubY]],y:[[t.startStubX,t.endStubY]]}[e]:t.segment===c[2]&&l>=a||t.segment===c[1]&&!o?{x:[[t.startStubX,v],[t.endStubX,v],[t.endStubX,t.endStubY]],y:[[y,t.startStubY],[y,t.endStubY],[t.endStubX,t.endStubY]]}[e]:t.segment===c[0]||t.segment===c[1]&&o?{x:[[t.startStubX,t.endStubY],[t.endStubX,t.endStubY]],y:[[t.endStubX,t.startStubY],[t.endStubX,t.endStubY]]}[e]:void 0},orthogonal:function(e,i,s,n,r){var o=t,a={x:-1===o.so[0]?Math.min(i,n):Math.max(i,n),y:-1===o.so[1]?Math.min(i,n):Math.max(i,n)}[e];return{x:[[a,s],[a,r],[n,r]],y:[[s,a],[r,a],[r,n]]}[e]},opposite:function(i,s,r,o){var a=t,l={x:"y",y:"x"}[i],c={x:"height",y:"width"}[i],u=a["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var d=r+(1-e.sourceEndpoint.anchor[l])*e.sourceInfo[c]+n.maxStub;return{x:[[s,d],[o,d]],y:[[d,s],[d,o]]}[i]}return!u||1===a.so[h]&&s>o||-1===a.so[h]&&o>s?{x:[[s,v],[o,v]],y:[[y,s],[y,o]]}[i]:1===a.so[h]&&o>s||-1===a.so[h]&&s>o?{x:[[y,a.sy],[y,a.ty]],y:[[a.sx,v],[a.tx,v]]}[i]:void 0}}[t.anchorOrientation](t.sourceAxis,p,f,g,b);if(C)for(var _=0;_<C.length;_++)d(s,C[_][0],C[_][1],t);d(s,c[2],c[3],t),d(s,t.tx,t.ty,t),m(this,s,t)}},e.extend(t.Connectors.Flowchart,t.Connectors.AbstractConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil;t.Connectors.AbstractBezierConnector=function(e){var i,s=!1!==(e=e||{}).showLoopback,n=e.margin||5,r=e.orientation&&"clockwise"===e.orientation,o=e.loopbackRadius||25;return this._compute=function(t,e){var a=e.sourcePos,l=e.targetPos,c=Math.abs(a[0]-l[0]),h=Math.abs(a[1]-l[1]);if(s&&e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var u=e.sourcePos[0],d=e.sourcePos[1]-n,p=u,f=d-o,m=p-o,g=f-o;c=2*o,h=2*o,t.points[0]=m,t.points[1]=g,t.points[2]=c,t.points[3]=h,i.addSegment(this,"Arc",{loopback:!0,x1:u-m+4,y1:d-g,startAngle:0,endAngle:2*Math.PI,r:o,ac:!r,x2:u-m-4,y2:d-g,cx:p-m,cy:f-g})}else this._computeBezier(t,e,a,l,c,h)},i=t.Connectors.AbstractConnector.apply(this,arguments)},e.extend(t.Connectors.AbstractBezierConnector,t.Connectors.AbstractConnector);var i=function(e){e=e||{},this.type="Bezier";var i=t.Connectors.AbstractBezierConnector.apply(this,arguments),s=e.curviness||150,n=10;this.getCurviness=function(){return s},this._findControlPoint=function(t,e,i,r,o,a,l){var c=[];return a[0]!==l[0]||a[1]===l[1]?(c.push(0===l[0]?i[0]<e[0]?t[0]+n:t[0]-n:t[0]+s*l[0]),c.push(0===l[1]?i[1]<e[1]?t[1]+n:t[1]-n:t[1]+s*a[1])):(c.push(0===a[0]?e[0]<i[0]?t[0]+n:t[0]-n:t[0]-s*a[0]),c.push(0===a[1]?e[1]<i[1]?t[1]+n:t[1]-n:t[1]+s*l[1])),c},this._computeBezier=function(t,e,s,n,r,o){var a,l,c=s[0]<n[0]?r:0,h=s[1]<n[1]?o:0,u=s[0]<n[0]?0:r,d=s[1]<n[1]?0:o;a=this._findControlPoint([c,h],s,n,e.sourceEndpoint,e.targetEndpoint,t.so,t.to),l=this._findControlPoint([u,d],n,s,e.targetEndpoint,e.sourceEndpoint,t.to,t.so),i.addSegment(this,"Bezier",{x1:c,y1:h,x2:u,y2:d,cp1x:a[0],cp1y:a[1],cp2x:l[0],cp2y:l[1]})}};t.Connectors.Bezier=i,e.extend(i,t.Connectors.AbstractBezierConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i=function(t,e,i,s){return i>=t&&e>=s?1:i>=t&&s>=e?2:t>=i&&s>=e?3:4},s=function(t,e,i,s,n,r,o,a,l){return l>=a?[t,e]:1===i?s[3]<=0&&n[3]>=1?[t+(s[2]<.5?-1*r:r),e]:s[2]>=1&&n[2]<=0?[t,e+(s[3]<.5?-1*o:o)]:[t+-1*r,e+-1*o]:2===i?s[3]>=1&&n[3]<=0?[t+(s[2]<.5?-1*r:r),e]:s[2]>=1&&n[2]<=0?[t,e+(s[3]<.5?-1*o:o)]:[t+r,e+-1*o]:3===i?s[3]>=1&&n[3]<=0?[t+(s[2]<.5?-1*r:r),e]:s[2]<=0&&n[2]>=1?[t,e+(s[3]<.5?-1*o:o)]:[t+-1*r,e+-1*o]:4===i?s[3]<=0&&n[3]>=1?[t+(s[2]<.5?-1*r:r),e]:s[2]<=0&&n[2]>=1?[t,e+(s[3]<.5?-1*o:o)]:[t+r,e+-1*o]:void 0},n=function(e){e=e||{},this.type="StateMachine";var n,r=t.Connectors.AbstractBezierConnector.apply(this,arguments),o=e.curviness||10,a=e.margin||5,l=e.proximityLimit||80;this._computeBezier=function(t,e,c,h,u,d){var p=e.sourcePos[0]<e.targetPos[0]?0:u,f=e.sourcePos[1]<e.targetPos[1]?0:d,m=e.sourcePos[0]<e.targetPos[0]?u:0,g=e.sourcePos[1]<e.targetPos[1]?d:0;0===e.sourcePos[2]&&(p-=a),1===e.sourcePos[2]&&(p+=a),0===e.sourcePos[3]&&(f-=a),1===e.sourcePos[3]&&(f+=a),0===e.targetPos[2]&&(m-=a),1===e.targetPos[2]&&(m+=a),0===e.targetPos[3]&&(g-=a),1===e.targetPos[3]&&(g+=a);var b=(p+m)/2,y=(f+g)/2,v=i(p,f,m,g),x=Math.sqrt(Math.pow(m-p,2)+Math.pow(g-f,2));n=s(b,y,v,e.sourcePos,e.targetPos,o,o,x,l),r.addSegment(this,"Bezier",{x1:m,y1:g,x2:p,y2:f,cp1x:n[0],cp1y:n[1],cp2x:n[0],cp2y:n[1]})}};t.Connectors.StateMachine=n,e.extend(n,t.Connectors.AbstractBezierConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i="Straight",s=function(e){this.type=i;var s=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,e){s.addSegment(this,i,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),s.addSegment(this,i,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),s.addSegment(this,i,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};t.Connectors.Straight=s,e.extend(s,t.Connectors.AbstractConnector)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,i={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},s="stroke-dasharray",n="dashstyle",r="fill",o="stroke",a="none",l="http://www.w3.org/2000/svg",c=function(t,e){for(var i in e)t.setAttribute(i,""+e[i])},h=function(e,i){return(i=i||{}).version="1.1",i.xmlns=l,t.createElementNS(l,e,null,null,i)},u=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},d=function(t){for(var e=t.querySelectorAll(" defs,linearGradient,radialGradient"),i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i])},p=function(t,e,l,c,u){if(e.setAttribute(r,l.fill?l.fill:a),e.setAttribute(o,l.stroke?l.stroke:a),l.gradient?function(t,e,i,s,n){var a,l="jsplumb_gradient_"+n._jsPlumb.instance.idstamp();d(t),a=i.gradient.offset?h("radialGradient",{id:l}):h("linearGradient",{id:l,gradientUnits:"userSpaceOnUse"});var c=h("defs");t.appendChild(c),c.appendChild(a);for(var u=0;u<i.gradient.stops.length;u++){var p=i.gradient.stops[1===n.segment||2===n.segment?u:i.gradient.stops.length-1-u][1],f=h("stop",{offset:Math.floor(100*i.gradient.stops[u][0])+"%","stop-color":p});a.appendChild(f)}e.setAttribute(i.stroke?o:r,"url(#"+l+")")}(t,e,l,0,u):(d(t),e.setAttribute("style","")),l.strokeWidth&&e.setAttribute("stroke-width",l.strokeWidth),l[n]&&l.strokeWidth&&!l[s]){var p=-1===l[n].indexOf(",")?" ":",",f=l[n].split(p),m="";f.forEach((function(t){m+=Math.floor(t*l.strokeWidth)+p})),e.setAttribute(s,m)}else l[s]&&e.setAttribute(s,l[s]);for(var g in i)l[g]&&e.setAttribute(i[g],l[g])},f=function(t,e,i){t.childNodes.length>i?t.insertBefore(e,t.childNodes[i]):t.appendChild(e)};e.svg={node:h,attr:c,pos:u};var m=function(i){var s=i.pointerEventsSpec||"all",n={};t.jsPlumbUIComponent.apply(this,i.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var r=i.cssClass+" "+(i.originalArgs[0].cssClass||"");this.svg=h("svg",{style:"",width:0,height:0,"pointer-events":s,position:"absolute"}),i.useDivWrapper?(this.canvas=t.createElement("div",{position:"absolute"}),e.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(c(this.svg,{class:r}),this.canvas=this.svg),i._jsPlumb.appendElement(this.canvas,i.originalArgs[0].parent),i.useDivWrapper&&this.canvas.appendChild(this.svg);var o=[this.canvas];return this.getDisplayElements=function(){return o},this.appendDisplayElement=function(t){o.push(t)},this.paint=function(t,s,r){if(null!=t){var o,a=[this.x,this.y],l=[this.w,this.h];null!=r&&(r.xmin<0&&(a[0]+=r.xmin),r.ymin<0&&(a[1]+=r.ymin),l[0]=r.xmax+(r.xmin<0?-r.xmin:0),l[1]=r.ymax+(r.ymin<0?-r.ymin:0)),i.useDivWrapper?(e.sizeElement(this.canvas,a[0],a[1],l[0]>0?l[0]:1,l[1]>0?l[1]:1),a[0]=0,a[1]=0,o=u([0,0])):o=u([a[0],a[1]]),n.paint.apply(this,arguments),c(this.svg,{style:o,width:l[0]||1,height:l[1]||1})}},{renderer:n}};e.extend(m,t.jsPlumbUIComponent,{cleanup:function(t){t||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(t){var e=t.getContainer();this.canvas&&null==this.canvas.parentNode&&e.appendChild(this.canvas),this.bgCanvas&&null==this.bgCanvas.parentNode&&e.appendChild(this.bgCanvas)},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none")}}),t.ConnectorRenderers.svg=function(e){var i=this,s=m.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);s.renderer.paint=function(s,n,r){var o=i.getSegments(),a=[0,0];if(r.xmin<0&&(a[0]=-r.xmin),r.ymin<0&&(a[1]=-r.ymin),o.length>0){var l={d:i.getPathData(),transform:"translate("+a[0]+","+a[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},u=null;if(s.outlineStroke){var d=s.strokeWidth+2*(s.outlineWidth||1);delete(u=t.extend({},s)).gradient,u.stroke=s.outlineStroke,u.strokeWidth=d,null==i.bgPath?(i.bgPath=h("path",l),t.addClass(i.bgPath,t.connectorOutlineClass),f(i.svg,i.bgPath,0)):c(i.bgPath,l),p(i.svg,i.bgPath,u,0,i)}null==i.path?(i.path=h("path",l),f(i.svg,i.path,s.outlineStroke?1:0)):c(i.path,l),p(i.svg,i.path,s,0,i)}}},e.extend(t.ConnectorRenderers.svg,m);var g=t.SvgEndpoint=function(e){var i=m.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]);i.renderer.paint=(function(e){var i=t.extend({},e);i.outlineStroke&&(i.stroke=i.outlineStroke),null==this.node?(this.node=this.makeNode(i),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),p(this.svg,this.node,i,0,this),u(this.node)}).bind(this)};e.extend(g,m),t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments),g.apply(this,arguments),this.makeNode=function(t){return h("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){c(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},e.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,g]),t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),g.apply(this,arguments),this.makeNode=function(t){return h("rect",{width:this.w,height:this.h})},this.updateNode=function(t){c(t,{width:this.w,height:this.h})}},e.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,g]),t.Endpoints.svg.Image=t.Endpoints.Image,t.Endpoints.svg.Blank=t.Endpoints.Blank,t.Overlays.svg.Label=t.Overlays.Label,t.Overlays.svg.Custom=t.Overlays.Custom;var b=function(e,i){e.apply(this,i),t.jsPlumbUIComponent.apply(this,i),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(t,e){if(t.component.svg&&e){null==this.path&&(this.path=h("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,t.component),this.canvas=t.component.svg);var n=i&&1===i.length&&i[0].cssClass||"",r=[0,0];e.xmin<0&&(r[0]=-e.xmin),e.ymin<0&&(r[1]=-e.ymin),c(this.path,{d:s(t.d),class:n,stroke:t.stroke?t.stroke:null,fill:t.fill?t.fill:null,transform:"translate("+r[0]+","+r[1]+")"})}};var s=function(t){return isNaN(t.cxy.x)||isNaN(t.cxy.y)?"":"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.transfer=function(t){t.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),t.canvas.appendChild(this.path))}},y={cleanup:function(t){null!=this.path&&(t?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(t,e){this.path&&e.canvas&&e.canvas.appendChild(this.path)},setVisible:function(t){null!=this.path&&(this.path.style.display=t?"block":"none")}};e.extend(b,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay]),t.Overlays.svg.Arrow=function(){b.apply(this,[t.Overlays.Arrow,arguments])},e.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,b],y),t.Overlays.svg.PlainArrow=function(){b.apply(this,[t.Overlays.PlainArrow,arguments])},e.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,b],y),t.Overlays.svg.Diamond=function(){b.apply(this,[t.Overlays.Diamond,arguments])},e.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,b],y),t.Overlays.svg.GuideLines=function(){var e,i,s=null,n=this;t.Overlays.GuideLines.apply(this,arguments),this.paint=function(t,o){null==s&&(s=h("path"),t.connector.svg.appendChild(s),n.attachListeners(s,t.connector),n.attachListeners(s,n),e=h("path"),t.connector.svg.appendChild(e),n.attachListeners(e,t.connector),n.attachListeners(e,n),i=h("path"),t.connector.svg.appendChild(i),n.attachListeners(i,t.connector),n.attachListeners(i,n));var a=[0,0];o.xmin<0&&(a[0]=-o.xmin),o.ymin<0&&(a[1]=-o.ymin),c(s,{d:r(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),c(e,{d:r(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),c(i,{d:r(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var r=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}},e.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}).call("undefined"!=typeof window?window:this),(function(){"use strict";var t=this,e=t.jsPlumb,i=t.jsPlumbUtil,s=t.Katavorio,n=t.Biltong,r=function(t,i){var r="_katavorio_"+(i=i||"main"),o=t[r],a=t.getEventManager();return o||((o=new s({bind:a.on,unbind:a.off,getSize:e.getSize,getConstrainingRectangle:function(t){return[t.parentNode.scrollWidth,t.parentNode.scrollHeight]},getPosition:function(e,i){var s=t.getOffset(e,i,e._katavorioDrag?e.offsetParent:null);return[s.left,s.top]},setPosition:function(t,e){t.style.left=e[0]+"px",t.style.top=e[1]+"px"},addClass:e.addClass,removeClass:e.removeClass,intersects:n.intersects,indexOf:function(t,e){return t.indexOf(e)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}})).setZoom(t.getZoom()),t[r]=o,t.bind("zoom",o.setZoom)),o},o=function(t){var e=t.el._jsPlumbDragOptions,i=!0;return e.canDrag&&(i=e.canDrag()),i&&(this.setHoverSuspended(!0),this.select({source:t.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:t.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),i},a=function(t){var e=this.getUIPosition(arguments,this.getZoom());if(null!=e){var i=t.el._jsPlumbDragOptions;this.draw(t.el,e,null,!0),i._dragging&&this.addClass(t.el,"jtk-dragged"),i._dragging=!0}},l=function(t){for(var e,i=t.selection,s=(function(i){var s;null!=i[1]&&(e=this.getUIPosition([{el:i[2].el,pos:[i[1].left,i[1].top]}]),s=this.draw(i[2].el,e)),null!=i[0]._jsPlumbDragOptions&&delete i[0]._jsPlumbDragOptions._dragging,this.removeClass(i[0],"jtk-dragged"),this.select({source:i[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:i[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),t.e._drawResult=t.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(t.e._drawResult.c,s.c),Array.prototype.push.apply(t.e._drawResult.e,s.e),Array.prototype.push.apply(t.e._drawResult.a,s.a),this.getDragManager().dragEnded(i[2].el)}).bind(this),n=0;n<i.length;n++)s(i[n]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},c=function(t,e){var s=function(s){if(null!=e[s]){if(i.isString(e[s])){var n=e[s].match(/-=/)?-1:1,r=e[s].substring(2);return t[s]+n*r}return e[s]}return t[s]};return[s("left"),s("top")]},h=function(t,e){if(null==e)return[0,0];var i=m(e),s=f(i,0);return[s[t+"X"],s[t+"Y"]]},u=h.bind(this,"page"),d=h.bind(this,"screen"),p=h.bind(this,"client"),f=function(t,e){return t.item?t.item(e):t[e]},m=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},g=function(t){var e={},i=[],s={},n={},r={};this.register=function(o){var a,l=t.getId(o);e[l]||(e[l]=o,i.push(o),s[l]={});var c=function(e){if(e)for(var i=0;i<e.childNodes.length;i++)if(3!==e.childNodes[i].nodeType&&8!==e.childNodes[i].nodeType){var h=jsPlumb.getElement(e.childNodes[i]),u=t.getId(e.childNodes[i],null,!0);if(u&&n[u]&&n[u]>0){a||(a=t.getOffset(o));var d=t.getOffset(h);s[l][u]={id:u,offset:{left:d.left-a.left,top:d.top-a.top}},r[u]=l}c(e.childNodes[i])}};c(o)},this.updateOffsets=function(e,i){if(null!=e){i=i||{};var n,o=jsPlumb.getElement(e),a=t.getId(o),l=s[a];if(l)for(var c in l)if(l.hasOwnProperty(c)){var h=jsPlumb.getElement(c),u=i[c]||t.getOffset(h);if(null==h.offsetParent&&null!=s[a][c])continue;n||(n=t.getOffset(o)),s[a][c]={id:c,offset:{left:u.left-n.left,top:u.top-n.top}},r[c]=a}}},this.endpointAdded=function(i,o){o=o||t.getId(i);var a=document.body,l=i.parentNode;for(n[o]=n[o]?n[o]+1:1;null!=l&&l!==a;){var c=t.getId(l,null,!0);if(c&&e[c]){var h=t.getOffset(l);if(null==s[c][o]){var u=t.getOffset(i);s[c][o]={id:o,offset:{left:u.left-h.left,top:u.top-h.top}},r[o]=c}break}l=l.parentNode}},this.endpointDeleted=function(t){if(n[t.elementId]&&(n[t.elementId]--,n[t.elementId]<=0))for(var e in s)s.hasOwnProperty(e)&&s[e]&&(delete s[e][t.elementId],delete r[t.elementId])},this.changeId=function(t,e){s[e]=s[t],s[t]={},r[e]=r[t],r[t]=null},this.getElementsForDraggable=function(t){return s[t]},this.elementRemoved=function(t){var e=r[t];e&&(s[e]&&delete s[e][t],delete r[t])},this.reset=function(){e={},i=[],s={},n={}},this.dragEnded=function(e){if(null!=e.offsetParent){var i=t.getId(e),s=r[i];s&&this.updateOffsets(s)}},this.setParent=function(e,i,n,o,a){var l=r[i];s[o]||(s[o]={});var c=t.getOffset(n),h=a||t.getOffset(e);l&&s[l]&&delete s[l][i],s[o][i]={id:i,offset:{left:h.left-c.left,top:h.top-c.top}},r[i]=o},this.clearParent=function(t,e){var i=r[e];i&&(delete s[i][e],delete r[e])},this.revalidateParent=function(e,i,s){var n=r[i];if(n){var o={};o[i]=s,this.updateOffsets(n,o),t.revalidate(n)}},this.getDragAncestor=function(e){var i=jsPlumb.getElement(e),s=t.getId(i),n=r[s];return n?jsPlumb.getElement(n):null}},b=function(t,e,s){e=i.fastTrim(e),void 0!==t.className.baseVal?t.className.baseVal=e:t.className=e;try{var n=t.classList;if(null!=n){for(;n.length>0;)n.remove(n.item(0));for(var o=0;o<s.length;o++)s[o]&&n.add(s[o])}}catch(r){i.log("JSPLUMB: cannot set class list",r)}},y=function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},v=function(t,e,s){e=null==e?[]:i.isArray(e)?e:e.split(/\s+/),s=null==s?[]:i.isArray(s)?s:s.split(/\s+/);var n=y(t).split(/\s+/),r=function(t,e){for(var i=0;i<e.length;i++)if(t)-1===n.indexOf(e[i])&&n.push(e[i]);else{var s=n.indexOf(e[i]);-1!==s&&n.splice(s,1)}};r(!0,e),r(!1,s),b(t,n.join(" "),n)};t.jsPlumb.extend(t.jsPlumbInstance.prototype,{headless:!1,pageLocation:u,screenLocation:d,clientLocation:p,getDragManager:function(){return null==this.dragManager&&(this.dragManager=new g(this)),this.dragManager},recalculateOffsets:function(t){this.getDragManager().updateOffsets(t)},createElement:function(t,e,i,s){return this.createElementNS(null,t,e,i,s)},createElementNS:function(t,e,i,s,n){var r,o=null==t?document.createElement(e):document.createElementNS(t,e);for(r in i=i||{})o.style[r]=i[r];for(r in s&&(o.className=s),n=n||{})o.setAttribute(r,""+n[r]);return o},getAttribute:function(t,e){return null!=t.getAttribute?t.getAttribute(e):null},setAttribute:function(t,e,i){null!=t.setAttribute&&t.setAttribute(e,i)},setAttributes:function(t,e){for(var i in e)e.hasOwnProperty(i)&&t.setAttribute(i,e[i])},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["svg"]},getClass:y,addClass:function(t,e){jsPlumb.each(t,(function(t){v(t,e)}))},hasClass:function(t,e){return(t=jsPlumb.getElement(t)).classList?t.classList.contains(e):-1!==y(t).indexOf(e)},removeClass:function(t,e){jsPlumb.each(t,(function(t){v(t,null,e)}))},toggleClass:function(t,e){jsPlumb.hasClass(t,e)?jsPlumb.removeClass(t,e):jsPlumb.addClass(t,e)},updateClasses:function(t,e,i){jsPlumb.each(t,(function(t){v(t,e,i)}))},setClass:function(t,e){null!=e&&jsPlumb.each(t,(function(t){b(t,e,e.split(/\s+/))}))},setPosition:function(t,e){t.style.left=e.left+"px",t.style.top=e.top+"px"},getPosition:function(t){var e=function(e){var i=t.style[e];return i?i.substring(0,i.length-2):0};return{left:e("left"),top:e("top")}},getStyle:function(t,e){return void 0!==window.getComputedStyle?getComputedStyle(t,null).getPropertyValue(e):t.currentStyle[e]},getSelector:function(t,e){return 1===arguments.length?null!=t.nodeType?t:document.querySelectorAll(t):t.querySelectorAll(e)},getOffset:function(t,e,i){t=jsPlumb.getElement(t),i=i||this.getContainer();for(var s={left:t.offsetLeft,top:t.offsetTop},n=e||null!=i&&t!==i&&t.offsetParent!==i?t.offsetParent:null,r=(function(t){null!=t&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(s.left-=t.scrollLeft,s.top-=t.scrollTop)}).bind(this);null!=n;)s.left+=n.offsetLeft,s.top+=n.offsetTop,r(n),n=e?n.offsetParent:n.offsetParent===i?null:n.offsetParent;if(null!=i&&!e&&(i.scrollTop>0||i.scrollLeft>0)){var o=null!=t.offsetParent?this.getStyle(t.offsetParent,"position"):"static",a=this.getStyle(t,"position");"absolute"!==a&&"fixed"!==a&&"absolute"!==o&&"fixed"!==o&&(s.left-=i.scrollLeft,s.top-=i.scrollTop)}return s},getPositionOnElement:function(t,e,i){var s=void 0!==e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},n=document.body,r=document.documentElement,o=window.pageYOffset||r.scrollTop||n.scrollTop,a=window.pageXOffset||r.scrollLeft||n.scrollLeft,l=s.top+o-(r.clientTop||n.clientTop||0)+0*i,c=s.left+a-(r.clientLeft||n.clientLeft||0)+0*i,h=jsPlumb.pageLocation(t);return[(h[0]-c)/(s.width||e.offsetWidth*i),(h[1]-l)/(s.height||e.offsetHeight*i)]},getAbsolutePosition:function(t){var e=function(e){var i=t.style[e];return i?parseFloat(i.substring(0,i.length-2)):void 0};return[e("left"),e("top")]},setAbsolutePosition:function(t,e,i,s){i?this.animate(t,{left:"+="+(e[0]-i[0]),top:"+="+(e[1]-i[1])},s):(t.style.left=e[0]+"px",t.style.top=e[1]+"px")},getSize:function(t){return[t.offsetWidth,t.offsetHeight]},getWidth:function(t){return t.offsetWidth},getHeight:function(t){return t.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(t,e){var s;return t=i.isArray(t)||null!=t.length&&!i.isString(t)?t:[t],Array.prototype.slice.call(t).forEach((function(t){(s=this.info(t)).el&&this._initDraggableIfNecessary(s.el,!0,e,s.id,!0)}).bind(this)),this},snapToGrid:function(t,e,i){var s=[],n=(function(t){var n=this.info(t);if(null!=n.el&&n.el._katavorioDrag){var r=n.el._katavorioDrag.snap(e,i);this.revalidate(n.el),s.push([n.el,r])}}).bind(this);if(1===arguments.length||3===arguments.length)n(t,e,i);else{var r=this.getManagedElements();for(var o in r)n(o,arguments[0],arguments[1])}return s},initDraggable:function(t,e,i){r(this,i).draggable(t,e),t._jsPlumbDragOptions=e},destroyDraggable:function(t,e){r(this,e).destroyDraggable(t),t._jsPlumbDragOptions=null,t._jsPlumbRelatedElement=null},unbindDraggable:function(t,e,i,s){r(this,s).destroyDraggable(t,e,i)},setDraggable:function(t,e){return jsPlumb.each(t,(function(t){this.isDragSupported(t)&&(this._draggableStates[this.getAttribute(t,"id")]=e,this.setElementDraggable(t,e))}).bind(this))},_draggableStates:{},toggleDraggable:function(t){var e;return jsPlumb.each(t,(function(t){var i=this.getAttribute(t,"id");return this._draggableStates[i]=e=!(e=null!=this._draggableStates[i]&&this._draggableStates[i]),this.setDraggable(t,e),e}).bind(this)),e},_initDraggableIfNecessary:function(t,e,s,n,r){if(!jsPlumb.headless&&null!=e&&e&&jsPlumb.isDragSupported(t,this)){var c=s||this.Defaults.DragOptions;if(c=jsPlumb.extend({},c),jsPlumb.isAlreadyDraggable(t,this))s.force&&this.initDraggable(t,c);else{var h=jsPlumb.dragEvents.drag,u=jsPlumb.dragEvents.stop,d=jsPlumb.dragEvents.start;this.manage(n,t),c[d]=i.wrap(c[d],o.bind(this)),c[h]=i.wrap(c[h],a.bind(this)),c[u]=i.wrap(c[u],l.bind(this));var p=this.getId(t);this._draggableStates[p]=!0;var f=this._draggableStates[p];c.disabled=null!=f&&!f,this.initDraggable(t,c),this.getDragManager().register(t),r&&this.fire("elementDraggable",{el:t,options:c})}}},animationSupported:!0,getElement:function(t){return null==t?null:"string"==typeof(t="string"==typeof t?t:null==t.tagName&&null!=t.length&&null==t.enctype?t[0]:t)?document.getElementById(t):t},removeElement:function(t){r(this).elementRemoved(t),this.getEventManager().remove(t)},doAnimate:function(t,i,s){s=s||{};var n=this.getOffset(t),r=c(n,i),o=s.duration||250,a=o/15,l=15/o*(r[0]-n.left),h=15/o*(r[1]-n.top),u=0,d=setInterval((function(){e.setPosition(t,{left:n.left+l*(u+1),top:n.top+h*(u+1)}),null!=s.step&&s.step(u,Math.ceil(a)),++u>=a&&(window.clearInterval(d),null!=s.complete&&s.complete())}),15)},destroyDroppable:function(t,e){r(this,e).destroyDroppable(t)},unbindDroppable:function(t,e,i,s){r(this,s).destroyDroppable(t,e,i)},droppable:function(t,e){var s;return t=i.isArray(t)||null!=t.length&&!i.isString(t)?t:[t],(e=e||{}).allowLoopback=!1,Array.prototype.slice.call(t).forEach((function(t){(s=this.info(t)).el&&this.initDroppable(s.el,e)}).bind(this)),this},initDroppable:function(t,e,i){r(this,i).droppable(t,e)},isAlreadyDraggable:function(t){return null!=t._katavorioDrag},isDragSupported:function(t,e){return!0},isDropSupported:function(t,e){return!0},isElementDraggable:function(t){return(t=e.getElement(t))._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(t){return t[0].drag.getDragElement()},getDragScope:function(t){return t._katavorioDrag&&t._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(t){return t[0].e},getUIPosition:function(t,e){var i=t[0].el;if(null==i.offsetParent)return null;var s=t[0].finalPos||t[0].pos,n={left:s[0],top:s[1]};if(i._katavorioDrag&&i.offsetParent!==this.getContainer()){var r=this.getOffset(i.offsetParent);n.left+=r.left,n.top+=r.top}return n},setDragFilter:function(t,e,i){t._katavorioDrag&&t._katavorioDrag.setFilter(e,i)},setElementDraggable:function(t,i){(t=e.getElement(t))._katavorioDrag&&t._katavorioDrag.setEnabled(i)},setDragScope:function(t,e){t._katavorioDrag&&t._katavorioDrag.k.setDragScope(t,e)},setDropScope:function(t,e){t._katavorioDrop&&t._katavorioDrop.length>0&&t._katavorioDrop[0].k.setDropScope(t,e)},addToPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.addToPosse.apply(n,t)}))},setPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.setPosse.apply(n,t)}))},removeFromPosse:function(t,i){var s=Array.prototype.slice.call(arguments,1),n=r(this);e.each(t,(function(t){(t=[e.getElement(t)]).push.apply(t,s),n.removeFromPosse.apply(n,t)}))},removeFromAllPosses:function(t){var i=r(this);e.each(t,(function(t){i.removeFromAllPosses(e.getElement(t))}))},setPosseState:function(t,i,s){var n=r(this);e.each(t,(function(t){n.setPosseState(e.getElement(t),i,s)}))},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(t){t._katavorioDrag&&t._katavorioDrag.abort()},addToDragSelection:function(t){var e=this.getElement(t);null==e||!e._isJsPlumbGroup&&null!=e._jsPlumbGroup||r(this).select(t)},removeFromDragSelection:function(t){r(this).deselect(t)},getDragSelection:function(){return r(this).getSelection()},clearDragSelection:function(){r(this).deselectAll()},trigger:function(t,e,i,s){this.getEventManager().trigger(t,e,i,s)},doReset:function(){for(var t in this)0===t.indexOf("_katavorio_")&&this[t].reset()},getEventManager:function(){return function(e){var i=e._mottle;return i||(i=e._mottle=new t.Mottle),i}(this)},on:function(t,e,i){return this.getEventManager().on.apply(this,arguments),this},off:function(t,e,i){return this.getEventManager().off.apply(this,arguments),this}}),function(t){var e=function(){/complete|loaded|interactive/.test(document.readyState)&&void 0!==document.body&&null!=document.body?t():setTimeout(e,9)};e()}(e.init)}).call("undefined"!=typeof window?window:this),function(t,e){"function"==typeof define&&define.amd?define("jsxgraphcore",[],e):"object"==typeof module&&module.exports?module.exports=e():t.returnExports=e()}(this,(function(){var requirejs,require,define;return function(t){function e(t,e){return b.call(t,e)}function i(t,e){var i,s,n,r,o,a,l,c,h,u,d,p=e&&e.split("/"),f=m.map,g=f&&f["*"]||{};if(t){for(o=(t=t.split("/")).length-1,m.nodeIdCompat&&v.test(t[o])&&(t[o]=t[o].replace(v,"")),"."===t[0].charAt(0)&&p&&(t=p.slice(0,p.length-1).concat(t)),h=0;h<t.length;h++)if("."===(d=t[h]))t.splice(h,1),h-=1;else if(".."===d){if(0===h||1===h&&".."===t[2]||".."===t[h-1])continue;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}if((p||g)&&f){for(h=(i=t.split("/")).length;h>0;h-=1){if(s=i.slice(0,h).join("/"),p)for(u=p.length;u>0;u-=1)if((n=f[p.slice(0,u).join("/")])&&(n=n[s])){r=n,a=h;break}if(r)break;!l&&g&&g[s]&&(l=g[s],c=h)}!r&&l&&(r=l,a=c),r&&(i.splice(0,a,r),t=i.join("/"))}return t}function s(e,i){return function(){var s=y.call(arguments,0);return"string"!=typeof s[0]&&1===s.length&&s.push(null),h.apply(t,s.concat([e,i]))}}function n(t){return function(e){p[t]=e}}function r(i){if(e(f,i)){var s=f[i];delete f[i],g[i]=!0,c.apply(t,s)}if(!e(p,i)&&!e(g,i))throw new Error("No "+i);return p[i]}function o(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function a(t){return t?o(t):[]}function l(t){return function(){return m&&m.config&&m.config[t]||{}}}var c,h,u,d,p={},f={},m={},g={},b=Object.prototype.hasOwnProperty,y=[].slice,v=/\.js$/;u=function(t,e){var s,n=o(t),a=n[0],l=e[1];return t=n[1],a&&(s=r(a=i(a,l))),a?t=s&&s.normalize?s.normalize(t,function(t){return function(e){return i(e,t)}}(l)):i(t,l):(t=(n=o(t=i(t,l)))[1],(a=n[0])&&(s=r(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:s}},d={require:function(t){return s(t)},exports:function(t){var e=p[t];return void 0!==e?e:p[t]={}},module:function(t){return{id:t,uri:"",exports:p[t],config:l(t)}}},c=function(i,o,l,c){var h,m,b,y,v,x,C,_=[],w=typeof l;if(x=a(c=c||i),"undefined"===w||"function"===w){for(o=!o.length&&l.length?["require","exports","module"]:o,v=0;v<o.length;v+=1)if("require"===(m=(y=u(o[v],x)).f))_[v]=d.require(i);else if("exports"===m)_[v]=d.exports(i),C=!0;else if("module"===m)h=_[v]=d.module(i);else if(e(p,m)||e(f,m)||e(g,m))_[v]=r(m);else{if(!y.p)throw new Error(i+" missing "+m);y.p.load(y.n,s(c,!0),n(m),{}),_[v]=p[m]}b=l?l.apply(p[i],_):void 0,i&&(h&&h.exports!==t&&h.exports!==p[i]?p[i]=h.exports:b===t&&C||(p[i]=b))}else i&&(p[i]=l)},requirejs=require=h=function(e,i,s,n,o){if("string"==typeof e)return d[e]?d[e](i):r(u(e,a(i)).f);if(!e.splice){if((m=e).deps&&h(m.deps,m.callback),!i)return;i.splice?(e=i,i=s,s=null):e=t}return i=i||function(){},"function"==typeof s&&(s=n,n=o),n?c(t,e,i,s):setTimeout((function(){c(t,e,i,s)}),4),h},h.config=function(t){return h(t)},requirejs._defined=p,(define=function(t,i,s){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");i.splice||(s=i,i=[]),e(p,t)||e(f,t)||(f[t]=[t,i,s])}).amd={jQuery:!0}}(),define("../node_modules/almond/almond",(function(){})),define("jxg",[],(function(){"use strict";var t={};return"object"!=typeof JXG||JXG.extend||(t=JXG),t.extend=function(t,e,i,s){var n;for(n in i=i||!1,s=s||!1,e)(!i||i&&e.hasOwnProperty(n))&&(t[s?n.toLowerCase():n]=e[n])},t.extend(t,{boards:{},readers:{},elements:{},registerElement:function(t,e){t=t.toLowerCase(),this.elements[t]=e},registerReader:function(t,e){var i,s;for(i=0;i<e.length;i++)s=e[i].toLowerCase(),"function"!=typeof this.readers[s]&&(this.readers[s]=t)},shortcut:function(t,e){return function(){return t[e].apply(this,arguments)}},getRef:function(e,i){return t.deprecated("JXG.getRef()","Board.select()"),e.select(i)},getReference:function(e,i){return t.deprecated("JXG.getReference()","Board.select()"),e.select(i)},getBoardByContainerId:function(t){var e;for(e in JXG.boards)if(JXG.boards.hasOwnProperty(e)&&JXG.boards[e].container===t)return JXG.boards[e];return null},deprecated:function(e,i){var s=e+" is deprecated.";i&&(s+=" Please use "+i+" instead."),t.warn(s)},warn:function(t){"object"==typeof window&&window.console&&console.warn?console.warn("WARNING:",t):"object"==typeof document&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+t+"<br />")},debugInt:function(t){var e,i;for(e=0;e<arguments.length;e++)i=arguments[e],"object"==typeof window&&window.console&&console.log?console.log(i):"object"==typeof document&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=i+"<br/>")},debugWST:function(e){var i=new Error;t.debugInt.apply(this,arguments),i&&i.stack&&(t.debugInt("stacktrace"),t.debugInt(i.stack.split("\n").slice(1).join("\n")))},debugLine:function(e){var i=new Error;t.debugInt.apply(this,arguments),i&&i.stack&&t.debugInt("Called from",i.stack.split("\n").slice(2,3).join("\n"))},debug:function(e){t.debugInt.apply(this,arguments)}}),t})),define("base/constants",["jxg"],(function(t){"use strict";var e;return t.extend(t,e={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82}),e})),define("utils/type",["jxg","base/constants"],(function(t,e){"use strict";return t.extend(t,{isId:function(t,e){return"string"==typeof e&&!!t.objects[e]},isName:function(t,e){return"string"==typeof e&&!!t.elementsByName[e]},isGroup:function(t,e){return"string"==typeof e&&!!t.groups[e]},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t||"[Object Number]"===Object.prototype.toString.call(t)},isFunction:function(t){return"function"==typeof t},isArray:function(t){return Array.isArray?Array.isArray(t):null!==t&&"object"==typeof t&&"function"==typeof t.splice&&"function"==typeof t.join},isObject:function(t){return"object"==typeof t&&!this.isArray(t)},isPoint:function(t){return null!==t&&"object"==typeof t&&t.elementClass===e.OBJECT_CLASS_POINT},isPointType:function(t,e){var i,s;return!!this.isArray(e)||!!(this.isFunction(e)&&(i=e(),this.isArray(i)&&i.length>1))||(s=t.select(e),this.isPoint(s))},isTransformationOrArray:function(t){if(null!==t){if(this.isArray(t)&&t.length>0)return this.isTransformationOrArray(t[0]);if("object"==typeof t)return t.type===e.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(t){return!(null==t)},def:function(t,e){return this.exists(t)?t:e},str2Bool:function(t){return!this.exists(t)||("boolean"==typeof t?t:!!this.isString(t)&&"true"===t.toLowerCase())},createEvalFunction:function(e,i,s){var n,r=[];for(n=0;n<s;n++)r[n]=t.createFunction(i[n],e,"",!0);return function(t){return r[t]()}},createFunction:function(t,e,i,s){var n=null;return this.exists(s)&&!s||!this.isString(t)?this.isFunction(t)?n=t:(this.isNumber(t)||this.isString(t))&&(n=function(){return t}):n=e.jc.snippet(t,!0,i,!0),null!==n&&(n.origin=t),n},providePoints:function(t,e,i,s,n){var r,o,a,l,c,h=0,u=[];for(this.isArray(e)||(e=[e]),a=e.length,this.exists(n)&&(h=n.length),0===h&&(l=this.copyAttributes(i,t.options,s)),r=0;r<a;++r)if(h>0&&(o=Math.min(r,h-1),l=this.copyAttributes(i,t.options,s,n[o])),this.isArray(e[r])&&e[r].length>1?u.push(t.create("point",e[r],l)):this.isFunction(e[r])?(c=e[r](),this.isArray(c)&&c.length>1&&u.push(t.create("point",[e[r]],l))):u.push(t.select(e[r])),!this.isPoint(u[r]))return!1;return u},bind:function(t,e){return function(){return t.apply(e,arguments)}},evaluate:function(t){return this.isFunction(t)?t():t},indexOf:function(t,e,i){var s,n=this.exists(i);if(Array.indexOf&&!n)return t.indexOf(e);for(s=0;s<t.length;s++)if(n&&t[s][i]===e||!n&&t[s]===e)return s;return-1},eliminateDuplicates:function(t){var e,i=t.length,s=[],n={};for(e=0;e<i;e++)n[t[e]]=0;for(e in n)n.hasOwnProperty(e)&&s.push(e);return s},swap:function(t,e,i){var s;return s=t[e],t[e]=t[i],t[i]=s,t},uniqueArray:function(e){var i,s,n,r=[];if(0===e.length)return[];for(i=0;i<e.length;i++)if(n=this.isArray(e[i]),this.exists(e[i]))for(s=i+1;s<e.length;s++)n&&t.cmpArrays(e[i],e[s])?e[i]=[]:n||e[i]!==e[s]||(e[i]="");else e[i]="";for(s=0,i=0;i<e.length;i++)(n=this.isArray(e[i]))||""===e[i]?n&&0!==e[i].length&&(r[s]=e[i].slice(0),s++):(r[s]=e[i],s++);return e=r,r},isInArray:function(e,i){return t.indexOf(e,i)>-1},coordsArrayToMatrix:function(t,e){var i,s=[],n=[];for(i=0;i<t.length;i++)e?(s.push(t[i].usrCoords[1]),n.push(t[i].usrCoords[2])):n.push([t[i].usrCoords[1],t[i].usrCoords[2]]);return e&&(n=[s,n]),n},cmpArrays:function(t,e){var i;if(t===e)return!0;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(this.isArray(t[i])&&this.isArray(e[i])){if(!this.cmpArrays(t[i],e[i]))return!1}else if(t[i]!==e[i])return!1;return!0},removeElementFromArray:function(t,e){var i;for(i=0;i<t.length;i++)if(t[i]===e)return t.splice(i,1),t;return t},trunc:function(e,i){return i=t.def(i,0),this.toFixed(e,i)},_decimalAdjust:function(t,e,i){return void 0===i||0==+i?Math[t](e):(e=+e,i=+i,isNaN(e)||"number"!=typeof i||i%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math[t](+(e[0]+"e"+(e[1]?+e[1]-i:-i)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+i:i))))},_round10:function(t,e){return this._decimalAdjust("round",t,e)},_floor10:function(t,e){return this._decimalAdjust("floor",t,e)},_ceil10:function(t,e){return this._decimalAdjust("ceil",t,e)},toFixed:function(t,e){return this._round10(t,-e).toFixed(e)},autoDigits:function(t){var e=Math.abs(t);return e>.1?this.toFixed(t,2):e>=.01?this.toFixed(t,4):e>=1e-4?this.toFixed(t,6):t},keys:function(t,e){var i,s=[];for(i in t)e?t.hasOwnProperty(i)&&s.push(i):s.push(i);return s},clone:function(t){var e={};return e.prototype=t,e},cloneAndCopy:function(t,e){var i,s=function(){};for(i in s.prototype=t,e)s[i]=e[i];return s},merge:function(t,e){var i,s;for(i in e)if(e.hasOwnProperty(i))if(this.isArray(e[i]))for(t[i]||(t[i]=[]),s=0;s<e[i].length;s++)t[i][s]="object"==typeof e[i][s]?this.merge(t[i][s],e[i][s]):e[i][s];else"object"==typeof e[i]?(t[i]||(t[i]={}),t[i]=this.merge(t[i],e[i])):t[i]=e[i];return t},deepCopy:function(t,e,i){var s,n,r,o;if(i=i||!1,"object"!=typeof t||null===t)return t;if(this.isArray(t))for(s=[],n=0;n<t.length;n++)s[n]="object"==typeof(r=t[n])?this.exists(r.board)?r.id:this.deepCopy(r):r;else{for(n in s={},t)t.hasOwnProperty(n)&&(s[o=i?n.toLowerCase():n]=null!==(r=t[n])&&"object"==typeof r?this.exists(r.board)?r.id:this.deepCopy(r):r);for(n in e)e.hasOwnProperty(n)&&(s[o=i?n.toLowerCase():n]="object"==typeof(r=e[n])?this.isArray(r)||!this.exists(s[o])?this.deepCopy(r):this.deepCopy(s[o],r,i):r)}return s},copyAttributes:function(e,i,s){var n,r,o,a,l,c={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(n=(o=arguments.length)<3||c[s]?t.deepCopy(i.elements,null,!0):{},o<4&&this.exists(s)&&this.exists(i.layer[s])&&(n.layer=i.layer[s]),a=i,l=!0,r=2;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}for(l&&(n=t.deepCopy(n,a,!0)),a=e,l=!0,r=3;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}for(l&&this.extend(n,a,null,!0),a=i,l=!0,r=2;r<o;r++){if(!this.exists(a[arguments[r]])){l=!1;break}a=a[arguments[r]]}return l&&this.exists(a.label)&&(n.label=t.deepCopy(a.label,n.label)),n.label=t.deepCopy(i.label,n.label),n},copyPrototypeMethods:function(t,e,i){var s;for(s in t.prototype[i]=e.prototype.constructor,e.prototype)e.prototype.hasOwnProperty(s)&&(t.prototype[s]=e.prototype[s])},toJSON:function(e,i){var s,n,r,o;if(i=t.def(i,!1),JSON.stringify&&!i)try{return JSON.stringify(e)}catch(t){}switch(typeof e){case"object":if(e){if(s=[],this.isArray(e)){for(r=0;r<e.length;r++)s.push(t.toJSON(e[r],i));return"["+s.join(",")+"]"}for(n in e)if(e.hasOwnProperty(n)){try{o=t.toJSON(e[n],i)}catch(t){o=""}s.push(i?n+":"+o:'"'+n+'":'+o)}return"{"+s.join(",")+"} "}return"null";case"string":return"'"+e.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return e.toString()}return"0"},clearVisPropOld:function(t){return t.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},t},isInObject:function(t,e){var i;for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1},escapeHTML:function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(t){return t.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()},trimNumber:function(t){return"."!==(t=(t=t.replace(/^0+/,"")).replace(/0+$/,""))[t.length-1]&&","!==t[t.length-1]||(t=t.slice(0,-1)),"."!==t[0]&&","!==t[0]||(t="0"+t),t},filterElements:function(t,e){var i,s,n,r,o,a,l,c=t.length,h=[];if("function"!=typeof e&&"object"!=typeof e)return h;for(i=0;i<c;i++){if(l=!0,n=t[i],"object"==typeof e){for(s in e)if(e.hasOwnProperty(s)&&(r=s.toLowerCase(),o="function"==typeof n[s]?n[s]():n[s],a=n.visProp&&"function"==typeof n.visProp[r]?n.visProp[r]():n.visProp&&n.visProp[r],!(l="function"==typeof e[s]?e[s](o)||e[s](a):o===e[s]||a===e[s])))break}else"function"==typeof e&&(l=e(n));l&&h.push(n)}return h},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(t,e){return"function"==typeof html_sanitize&&e?html_sanitize(t,(function(){}),(function(t){return t})):(t&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;")),t)},evalSlider:function(t){return t&&t.type===e.OBJECT_TYPE_GLIDER&&"function"==typeof t.Value?t.Value():t}}),t})),define("utils/env",["jxg","utils/type"],(function(t,e){"use strict";return t.extend(t,{touchProperty:"touches",isBrowser:"object"==typeof window&&"object"==typeof document,supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var e=!1;if(this.isNode())try{e=!!("object"==typeof module?module.require("canvas"):require("canvas"))}catch(t){}return e||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&("object"==typeof module&&!!module.exports||"object"==typeof global&&global.requirejsVars&&!global.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&"object"==typeof self&&"function"==typeof self.postMessage},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&void 0!==window.ontouchstart},isAndroid:function(){return e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return e.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return"object"==typeof window&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&-1===navigator.userAgent.toLowerCase().indexOf("apple")},isFirefoxOS:function(){return e.exists(navigator)&&-1===navigator.userAgent.toLowerCase().indexOf("android")&&-1===navigator.userAgent.toLowerCase().indexOf("apple")&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var t,e,i=3;if("object"!=typeof document)return 0;e=(t=document.createElement("div")).getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++i+"]><i></i><![endif]--\x3e"}while(e[0]);return i>4?i:void 0}(),getDimensions:function(t,i){var s,n,r,o,a,l,c,h,u,d=/\d+(\.\d*)?px/;if(!this.isBrowser||null===t)return{width:500,height:500};if(s=(i=i||document).getElementById(t),!e.exists(s))throw new Error("\nJSXGraph: HTML container element '"+t+"' not found.");return"none"!==(n=s.style.display)&&null!==n?s.clientWidth>0&&s.clientHeight>0?{width:s.clientWidth,height:s.clientHeight}:(u=window.getComputedStyle?window.getComputedStyle(s):s.style,{width:d.test(u.width)?parseFloat(u.width):0,height:d.test(u.height)?parseFloat(u.height):0}):(o=(r=s.style).visibility,a=r.position,l=r.display,r.visibility="hidden",r.position="absolute",r.display="block",c=s.clientWidth,h=s.clientHeight,r.display=l,r.position=a,r.visibility=o,{width:c,height:h})},addEvent:function(t,i,s,n){var r=function(){return s.apply(n,arguments)};r.origin=s,n["x_internal"+i]=n["x_internal"+i]||[],n["x_internal"+i].push(r),e.exists(t)&&e.exists(t.addEventListener)&&t.addEventListener(i,r,!1),e.exists(t)&&e.exists(t.attachEvent)&&t.attachEvent("on"+i,r)},removeEvent:function(i,s,n,r){var o;if(e.exists(r))if(e.exists(r["x_internal"+s]))if(e.isArray(r["x_internal"+s]))if(-1!==(o=e.indexOf(r["x_internal"+s],n,"origin"))){try{e.exists(i)&&e.exists(i.removeEventListener)&&i.removeEventListener(s,r["x_internal"+s][o],!1),e.exists(i)&&e.exists(i.detachEvent)&&i.detachEvent("on"+s,r["x_internal"+s][o])}catch(e){t.debug("event not registered in browser: ("+s+" -- "+n+")")}r["x_internal"+s].splice(o,1)}else t.debug("no such event function in internal list: "+n);else t.debug("owner[x_internal + "+s+"] is not an array");else t.debug("no such type: "+s);else t.debug("no such owner")},removeAllEvents:function(e,i,s){var n;if(s["x_internal"+i]){for(n=s["x_internal"+i].length-1;n>=0;n--)t.removeEvent(e,i,s["x_internal"+i][n].origin,s);s["x_internal"+i].length>0&&t.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(i,s,n){var r,o,a,l=0,c=0;if(i||(i=window.event),n=n||document,e.exists(a=i[t.touchProperty])&&0===a.length&&(a=i.changedTouches),e.exists(s)&&e.exists(a))if(-1===s){for(o=a.length,r=0;r<o;r++)if(a[r]){i=a[r];break}}else i=a[s];return i.clientX&&(l=i.clientX,c=i.clientY),[l,c]},getOffset:function(t){var e,i=t,s=t,n=i.offsetLeft-i.scrollLeft,r=i.offsetTop-i.scrollTop;for(n=(e=this.getCSSTransform([n,r],i))[0],r=e[1],i=i.offsetParent;i;){for(n+=i.offsetLeft,r+=i.offsetTop,i.offsetParent&&(n+=i.clientLeft-i.scrollLeft,r+=i.clientTop-i.scrollTop),n=(e=this.getCSSTransform([n,r],i))[0],r=e[1],s=s.parentNode;s!==i;)n=(e=this.getCSSTransform([n+=s.clientLeft-s.scrollLeft,r+=s.clientTop-s.scrollTop],s))[0],r=e[1],s=s.parentNode;i=i.offsetParent}return[n,r]},getStyle:function(e,i){var s,n=e.ownerDocument;return n.defaultView&&n.defaultView.getComputedStyle?s=n.defaultView.getComputedStyle(e,null).getPropertyValue(i):e.currentStyle&&t.ieVersion>=9?s=e.currentStyle[i]:e.style&&(i=i.replace(/-([a-z]|[0-9])/gi,(function(t,e){return e.toUpperCase()})),s=e.style[i]),s},getProp:function(t,e){var i=parseInt(this.getStyle(t,e),10);return isNaN(i)?0:i},getCSSTransform:function(t,i){var s,n,r,o,a,l,c,h=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(a=h.length,s=0,r="";s<a;s++)if(e.exists(i.style[h[s]])){r=i.style[h[s]];break}if(""!==r&&(o=r.indexOf("("))>0){for(n=0,l=(c=r.substring(o+1,(a=r.length)-1).split(",")).length;n<l;n++)c[n]=parseFloat(c[n]);0===r.indexOf("matrix")?(t[0]+=c[4],t[1]+=c[5]):0===r.indexOf("translateX")?t[0]+=c[0]:0===r.indexOf("translateY")?t[1]+=c[0]:0===r.indexOf("translate")&&(t[0]+=c[0],t[1]+=c[1])}return e.exists(i.style.zoom)&&""!==(r=i.style.zoom)&&(t[0]*=parseFloat(r),t[1]*=parseFloat(r)),t},getCSSTransformMatrix:function(t){var i,s,n,r,o,a,l,c,h=t.ownerDocument,u=["transform","webkitTransform","MozTransform","msTransform","oTransform"],d=[[1,0,0],[0,1,0],[0,0,1]];if(h.defaultView&&h.defaultView.getComputedStyle)n=(c=h.defaultView.getComputedStyle(t,null)).getPropertyValue("-webkit-transform")||c.getPropertyValue("-moz-transform")||c.getPropertyValue("-ms-transform")||c.getPropertyValue("-o-transform")||c.getPropertyValue("transform");else for(o=u.length,i=0,n="";i<o;i++)if(e.exists(t.style[u[i]])){n=t.style[u[i]];break}if(""!==n&&(r=n.indexOf("("))>0){for(s=0,a=(l=n.substring(r+1,(o=n.length)-1).split(",")).length;s<a;s++)l[s]=parseFloat(l[s]);0===n.indexOf("matrix")?d=[[1,0,0],[0,l[0],l[1]],[0,l[2],l[3]]]:0===n.indexOf("scaleX")?d[1][1]=l[0]:0===n.indexOf("scaleY")?d[2][2]=l[0]:0===n.indexOf("scale")&&(d[1][1]=l[0],d[2][2]=l[1])}return e.exists(t.style.zoom)&&""!==(n=t.style.zoom)&&(d[1][1]*=parseFloat(n),d[2][2]*=parseFloat(n)),d},timedChunk:function(t,e,i,s){var n=t.concat(),r=function(){var o=+new Date;do{e.call(i,n.shift())}while(n.length>0&&+new Date-o<300);n.length>0?window.setTimeout(r,1):s(t)};window.setTimeout(r,1)}}),t})),define("utils/xml",["jxg","utils/type"],(function(t,e){"use strict";return t.XML={cleanWhitespace:function(t){for(var i=t.firstChild;e.exists(i);)3!==i.nodeType||/\S/.test(i.nodeValue)?1===i.nodeType&&this.cleanWhitespace(i):t.removeChild(i),i=i.nextSibling},parse:function(t){var e;return e=(new("function"==typeof DOMParser||"object"==typeof DOMParser?DOMParser:function(){this.parseFromString=function(t){var e;return"function"==typeof ActiveXObject&&(e=new ActiveXObject("MSXML.DomDocument")).loadXML(t),e}})).parseFromString(t,"text/xml"),this.cleanWhitespace(e),e}},t.XML})),define("utils/event",["jxg","utils/type"],(function(t,e){"use strict";return t.EventEmitter={eventHandlers:{},suspended:{},trigger:function(t,e){var i,s,n,r,o,a;for(o=t.length,s=0;s<o;s++)if(r=this.eventHandlers[t[s]],!this.suspended[t[s]]){if(this.suspended[t[s]]=!0,r)for(a=r.length,i=0;i<a;i++)(n=r[i]).handler.apply(n.context,e);this.suspended[t[s]]=!1}return this},on:function(t,i,s){return e.isArray(this.eventHandlers[t])||(this.eventHandlers[t]=[]),s=e.def(s,this),this.eventHandlers[t].push({handler:i,context:s}),this},off:function(t,i){var s;return t&&e.isArray(this.eventHandlers[t])?(i?((s=e.indexOf(this.eventHandlers[t],i,"handler"))>-1&&this.eventHandlers[t].splice(s,1),0===this.eventHandlers[t].length&&delete this.eventHandlers[t]):delete this.eventHandlers[t],this):this},eventify:function(t){t.eventHandlers={},t.on=this.on,t.off=this.off,t.triggerEventHandlers=this.trigger,t.trigger=this.trigger,t.suspended={}}},t.EventEmitter})),define("math/math",["jxg","utils/type"],(function(t,e){"use strict";var i=function(t){var e,i;return t.memo||(e={},i=Array.prototype.join,t.memo=function(){var s=i.call(arguments);return void 0!==e[s]?e[s]:e[s]=t.apply(this,arguments)}),t.memo};return t.Math={eps:1e-6,relDif:function(t,e){var i=Math.abs(t),s=Math.abs(e);return 0===(s=Math.max(i,s))?0:Math.abs(t-e)/s},mod:function(t,e){return t-Math.floor(t/e)*e},vector:function(t,e){var i,s;for(e=e||0,i=[],s=0;s<t;s++)i[s]=e;return i},matrix:function(t,e,i){var s,n,r;for(i=i||0,e=e||t,s=[],n=0;n<t;n++)for(s[n]=[],r=0;r<e;r++)s[n][r]=i;return s},identity:function(t,e){var i,s;for(void 0===e&&"number"!=typeof e&&(e=t),i=this.matrix(t,e),s=0;s<Math.min(t,e);s++)i[s][s]=1;return i},frustum:function(t,e,i,s,n,r){var o=this.matrix(4,4);return o[0][0]=2*n/(e-t),o[0][1]=0,o[0][2]=(e+t)/(e-t),o[0][3]=0,o[1][0]=0,o[1][1]=2*n/(s-i),o[1][2]=(s+i)/(s-i),o[1][3]=0,o[2][0]=0,o[2][1]=0,o[2][2]=-(r+n)/(r-n),o[2][3]=-r*n*2/(r-n),o[3][0]=0,o[3][1]=0,o[3][2]=-1,o[3][3]=0,o},projection:function(t,e,i,s){var n=i*Math.tan(t/2),r=n*e;return this.frustum(-r,r,-n,n,i,s)},matVecMult:function(t,e){var i,s,n,r=t.length,o=e.length,a=[];if(3===o)for(i=0;i<r;i++)a[i]=t[i][0]*e[0]+t[i][1]*e[1]+t[i][2]*e[2];else for(i=0;i<r;i++){for(s=0,n=0;n<o;n++)s+=t[i][n]*e[n];a[i]=s}return a},matMatMult:function(t,e){var i,s,n,r,o=t.length,a=o>0?e[0].length:0,l=e.length,c=this.matrix(o,a);for(i=0;i<o;i++)for(s=0;s<a;s++){for(n=0,r=0;r<l;r++)n+=t[i][r]*e[r][s];c[i][s]=n}return c},transpose:function(t){var e,i,s,n,r;for(e=this.matrix(r=t.length>0?t[0].length:0,n=t.length),i=0;i<r;i++)for(s=0;s<n;s++)e[i][s]=t[s][i];return e},inverse:function(t){var e,i,s,n,r,o,a,l=t.length,c=[],h=[],u=[];for(e=0;e<l;e++){for(c[e]=[],i=0;i<l;i++)c[e][i]=t[e][i];h[e]=e}for(i=0;i<l;i++){for(r=Math.abs(c[i][i]),o=i,e=i+1;e<l;e++)Math.abs(c[e][i])>r&&(r=Math.abs(c[e][i]),o=e);if(r<=this.eps)return[];if(o>i){for(s=0;s<l;s++)a=c[i][s],c[i][s]=c[o][s],c[o][s]=a;a=h[i],h[i]=h[o],h[o]=a}for(n=1/c[i][i],e=0;e<l;e++)c[e][i]*=n;for(c[i][i]=n,s=0;s<l;s++)if(s!==i){for(e=0;e<l;e++)e!==i&&(c[e][s]-=c[e][i]*c[i][s]);c[i][s]=-n*c[i][s]}}for(e=0;e<l;e++){for(s=0;s<l;s++)u[h[s]]=c[e][s];for(s=0;s<l;s++)c[e][s]=u[s]}return c},innerProduct:function(t,i,s){var n,r=0;for(void 0!==s&&e.isNumber(s)||(s=t.length),n=0;n<s;n++)r+=t[n]*i[n];return r},crossProduct:function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},factorial:i((function(t){return t<0?NaN:0===(t=Math.floor(t))||1===t?1:t*this.factorial(t-1)})),binomial:i((function(t,e){var i,s;if(e>t||e<0)return NaN;if(e=Math.round(e),t=Math.round(t),0===e||e===t)return 1;for(i=1,s=0;s<e;s++)i*=t-s,i/=s+1;return i})),cosh:function(t){return.5*(Math.exp(t)+Math.exp(-t))},sinh:function(t){return.5*(Math.exp(t)-Math.exp(-t))},pow:function(t,e){return 0===t?0===e?1:0:Math.floor(e)===e?Math.pow(t,e):t>0?Math.exp(e*Math.log(Math.abs(t))):NaN},log10:function(t){return Math.log(t)/Math.log(10)},log2:function(t){return Math.log(t)/Math.log(2)},log:function(t,i){return void 0!==i&&e.isNumber(i)?Math.log(t)/Math.log(i):Math.log(t)},sign:Math.sign||function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1},squampow:function(t,e){var i;if(Math.floor(e)===e){for(i=1,e<0&&(t=1/t,e*=-1);0!==e;)1&e&&(i*=t),e>>=1,t*=t;return i}return this.pow(t,e)},gcd:function(t,i){if(t=Math.abs(t),i=Math.abs(i),!e.isNumber(t)||!e.isNumber(i))return NaN;if(i>t){var s=t;t=i,i=s}for(;;){if(0==(t%=i))return i;if(0==(i%=t))return t}},lcm:function(t,i){var s;return e.isNumber(t)&&e.isNumber(i)?0!=(s=t*i)?s/this.gcd(t,i):0:NaN},normalize:function(t){var e,i,s=2*t[3],n=t[4]/s;return t[5]=n,t[6]=-t[1]/s,t[7]=-t[2]/s,isFinite(n)?Math.abs(n)>=1?(t[0]=(t[6]*t[6]+t[7]*t[7]-n*n)/(2*n),t[1]=-t[6]/n,t[2]=-t[7]/n,t[3]=1/(2*n),t[4]=1):(t[0]=(i=n<=0?-1:1)*(t[6]*t[6]+t[7]*t[7]-n*n)*.5,t[1]=-i*t[6],t[2]=-i*t[7],t[3]=i/2,t[4]=i*n):(e=Math.sqrt(t[1]*t[1]+t[2]*t[2]),t[0]/=e,t[1]/=e,t[2]/=e,t[3]=0,t[4]=1),t},toGL:function(t){var e,i,s;if(e="function"==typeof Float32Array?new Float32Array(16):new Array(16),4!==t.length&&4!==t[0].length)return e;for(i=0;i<4;i++)for(s=0;s<4;s++)e[i+4*s]=t[i][s];return e}},t.Math})),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],(function(t,e,i,s,n){"use strict";return t.Coords=function(t,e,n,r){this.board=n,this.usrCoords=[],this.scrCoords=[],this.emitter=!s.exists(r)||r,this.emitter&&i.eventify(this),this.setCoordinates(t,e,!0,!0)},t.extend(t.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>n.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(t){var e=Math.round,i=this.board,s=this.usrCoords,n=i.origin.scrCoords;!0===t?(this.scrCoords[0]=e(s[0]),this.scrCoords[1]=e(s[0]*n[1]+s[1]*i.unitX),this.scrCoords[2]=e(s[0]*n[2]-s[2]*i.unitY)):(this.scrCoords[0]=s[0],this.scrCoords[1]=s[0]*n[1]+s[1]*i.unitX,this.scrCoords[2]=s[0]*n[2]-s[2]*i.unitY)},screen2usr:function(){var t=this.board.origin.scrCoords,e=this.scrCoords,i=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(e[1]-t[1])/i.unitX,this.usrCoords[2]=(t[2]-e[2])/i.unitY},distance:function(t,i){var s,r,o=0,a=this.usrCoords,l=this.scrCoords;if(t===e.COORDS_BY_USER){if((o=(r=a[0]-(s=i.usrCoords)[0])*r)>n.eps*n.eps)return Number.POSITIVE_INFINITY;o+=(r=a[1]-s[1])*r,o+=(r=a[2]-s[2])*r}else o+=(r=l[1]-(s=i.scrCoords)[1])*r,o+=(r=l[2]-s[2])*r;return Math.sqrt(o)},setCoordinates:function(t,i,s,n){var r=this.usrCoords,o=this.scrCoords,a=[r[0],r[1],r[2]],l=[o[0],o[1],o[2]];return t===e.COORDS_BY_USER?(2===i.length?(r[0]=1,r[1]=i[0],r[2]=i[1]):(r[0]=i[0],r[1]=i[1],r[2]=i[2],this.normalizeUsrCoords()),this.usr2screen(s)):(2===i.length?(o[1]=i[0],o[2]=i[1]):(o[1]=i[1],o[2]=i[2]),this.screen2usr()),!this.emitter||n||l[1]===o[1]&&l[2]===o[2]||this.triggerEventHandlers(["update"],[a,l]),this},copy:function(t,e){return void 0===e&&(e=0),this[t].slice(e)},__evt__update:function(t,e){},__evt:function(){}}),t.Coords})),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],(function(t,e,i,s){"use strict";var n={each:function(t,i,s){var n,r,o=[];if(e.exists(t.length))for(r=t.length,n=0;n<r;n++)o.push(i.call(this,t[n],s));return o},coords:function(t,e){var n=t;return t&&t.elementClass===i.OBJECT_CLASS_POINT?n=t.coords:t.usrCoords&&t.scrCoords&&t.usr2screen&&(n=t),e&&(n=new s(i.COORDS_BY_USER,n.usrCoords,n.board)),n},coordsArray:function(t,i){var s;return(s=e.isArray(t)?t:this.coords(t).usrCoords).length<3&&s.unshift(1),i&&(s=[s[0],s[1],s[2]]),s}};return t.Expect=n,n})),define("math/qdt",["math/math","utils/type"],(function(t,e){"use strict";var i=function(t){this.capacity=10,this.points=[],this.xlb=t[0],this.xub=t[2],this.ylb=t[3],this.yub=t[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return e.extend(i.prototype,{contains:function(t,e){return this.xlb<t&&t<=this.xub&&this.ylb<e&&e<=this.yub},insert:function(t){return!!this.contains(t.usrCoords[1],t.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(t),!0):(null===this.northWest&&this.subdivide(),!!(this.northWest.insert(t)||this.northEast.insert(t)||this.southEast.insert(t)||this.southWest.insert(t))))},subdivide:function(){var t,e=this.points.length,s=this.xlb+(this.xub-this.xlb)/2,n=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new i([this.xlb,this.yub,s,n]),this.northEast=new i([s,this.yub,this.xub,n]),this.southEast=new i([this.xlb,n,s,this.ylb]),this.southWest=new i([s,n,this.xub,this.ylb]),t=0;t<e;t+=1)this.northWest.insert(this.points[t]),this.northEast.insert(this.points[t]),this.southEast.insert(this.points[t]),this.southWest.insert(this.points[t])},_query:function(t,e){var i;if(this.contains(t,e)){if(null===this.northWest)return this;if(i=this.northWest._query(t,e))return i;if(i=this.northEast._query(t,e))return i;if(i=this.southEast._query(t,e))return i;if(i=this.southWest._query(t,e))return i}return!1},query:function(t,i){var s,n;return e.exists(i)?(s=t,n=i):(s=t.usrCoords[1],n=t.usrCoords[2]),this._query(s,n)}}),t.Quadtree=i,i})),define("math/numerics",["jxg","utils/type","math/math"],(function(t,e,i){"use strict";var s={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return i.Numerics={Gauss:function(t,s){var n,r,o,a,l,c=i.eps,h=t.length>0?t[0].length:0;if(h!==s.length||h!==t.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(a=[],l=s.slice(0,h),n=0;n<h;n++)a[n]=t[n].slice(0,h);for(r=0;r<h;r++){for(n=h-1;n>r;n--)if(Math.abs(a[n][r])>c)if(Math.abs(a[r][r])<c)e.swap(a,n,r),e.swap(l,n,r);else for(a[n][r]/=a[r][r],l[n]-=a[n][r]*l[r],o=r+1;o<h;o++)a[n][o]-=a[n][r]*a[r][o];if(Math.abs(a[r][r])<c)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(a,l,!0),l},backwardSolve:function(t,e,i){var s,n,r,o;for(s=i?e:e.slice(0,e.length),n=t.length>0?t[0].length:0,r=t.length-1;r>=0;r--){for(o=n-1;o>r;o--)s[r]-=t[r][o]*s[o];s[r]/=t[r][r]}return s},gaussBareiss:function(t){var e,s,n,r,o,a,l,c,h,u=i.eps;if((l=t.length)<=0)return 0;for(t[0].length<l&&(l=t[0].length),c=[],r=0;r<l;r++)c[r]=t[r].slice(0,l);for(s=1,n=1,e=0;e<l-1;e++){if(a=c[e][e],Math.abs(a)<u){for(r=e+1;r<l&&!(Math.abs(c[r][e])>=u);r++);if(r===l)return 0;for(o=e;o<l;o++)h=c[r][o],c[r][o]=c[e][o],c[e][o]=h;n=-n,a=c[e][e]}for(r=e+1;r<l;r++)for(o=e+1;o<l;o++)c[r][o]=(h=a*c[r][o]-c[r][e]*c[e][o])/s;s=a}return n*c[l-1][l-1]},det:function(t){return 2===t.length&&2===t[0].length?t[0][0]*t[1][1]-t[1][0]*t[0][1]:this.gaussBareiss(t)},Jacobi:function(t){var e,s,n,r,o,a,l,c,h,u=i.eps,d=0,p=t.length,f=[[0,0,0],[0,0,0],[0,0,0]],m=[[0,0,0],[0,0,0],[0,0,0]],g=0;for(e=0;e<p;e++){for(s=0;s<p;s++)f[e][s]=0,m[e][s]=t[e][s],d+=Math.abs(m[e][s]);f[e][e]=1}if(1===p)return[m,f];if(d<=0)return[m,f];d/=p*p;do{for(c=0,h=0,s=1;s<p;s++)for(e=0;e<s;e++)if((r=Math.abs(m[e][s]))>h&&(h=r),c+=r,r>=u){for(r=.5*Math.atan2(2*m[e][s],m[e][e]-m[s][s]),o=Math.sin(r),a=Math.cos(r),n=0;n<p;n++)m[n][e]=a*(l=m[n][e])+o*m[n][s],m[n][s]=-o*l+a*m[n][s],f[n][e]=a*(l=f[n][e])+o*f[n][s],f[n][s]=-o*l+a*f[n][s];for(m[e][e]=a*m[e][e]+o*m[s][e],m[s][s]=-o*m[e][s]+a*m[s][s],m[e][s]=0,n=0;n<p;n++)m[e][n]=m[n][e],m[s][n]=m[n][s]}g+=1}while(Math.abs(c)/d>u&&g<2e3);return[m,f]},NewtonCotes:function(t,i,s){var n,r,o,a=0,l=s&&e.isNumber(s.number_of_nodes)?s.number_of_nodes:28,c={trapez:!0,simpson:!0,milne:!0},h=s&&s.integration_type&&c.hasOwnProperty(s.integration_type)&&c[s.integration_type]?s.integration_type:"milne",u=(t[1]-t[0])/l;switch(h){case"trapez":for(a=.5*(i(t[0])+i(t[1])),n=t[0],r=0;r<l-1;r++)a+=i(n+=u);a*=u;break;case"simpson":if(l%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(o=l/2,a=i(t[0])+i(t[1]),n=t[0],r=0;r<o-1;r++)a+=2*i(n+=2*u);for(n=t[0]-u,r=0;r<o;r++)a+=4*i(n+=2*u);a*=u/3;break;default:if(l%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(o=.25*l,a=7*(i(t[0])+i(t[1])),n=t[0],r=0;r<o-1;r++)a+=14*i(n+=4*u);for(n=t[0]-3*u,r=0;r<o;r++)a+=32*(i(n+=4*u)+i(n+2*u));for(n=t[0]-2*u,r=0;r<o;r++)a+=12*i(n+=4*u);a*=2*u/45}return a},Romberg:function(t,i,s){var n,r,o,a,l,c,h,u,d=[],p=0,f=1/0,m=s&&e.isNumber(s.max_iterations)?s.max_iterations:20,g=s&&e.isNumber(s.eps)?s.eps:s.eps||1e-7;for(l=1,d[0]=.5*(o=(r=t[1])-(n=t[0]))*(i(n)+i(r)),c=0;c<m;++c){for(a=0,o*=.5,l*=2,u=1,h=1;h<l;h+=2)a+=i(n+h*o);for(d[c+1]=.5*d[c]+a*o,p=d[c+1],h=c-1;h>=0;--h)d[h]=d[h+1]+(d[h+1]-d[h])/((u*=4)-1),p=d[h];if(Math.abs(p-f)<g*Math.abs(p))break;f=p}return p},GaussLegendre:function(t,i,s){var n,r,o,a,l,c,h,u,d=0,p=[],f=[],m=s&&e.isNumber(s.n)?s.n:12;if(m>18&&(m=18),p[2]=[.5773502691896257],f[2]=[1],p[4]=[.33998104358485626,.8611363115940526],f[4]=[.6521451548625461,.34785484513745385],p[6]=[.2386191860831969,.6612093864662645,.932469514203152],f[6]=[.46791393457269104,.3607615730481386,.17132449237917036],p[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],f[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],p[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],f[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],p[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],f[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],p[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],f[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],p[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],f[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],p[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],f[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],p[3]=[0,.7745966692414834],f[3]=[.8888888888888888,.5555555555555556],p[5]=[0,.5384693101056831,.906179845938664],f[5]=[.5688888888888889,.47862867049936647,.23692688505618908],p[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],f[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],p[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],f[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],p[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],f[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],p[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],f[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],p[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],f[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],p[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],f[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],a=m+1>>1,h=p[m],u=f[m],c=.5*((r=t[1])-(n=t[0])),l=.5*(r+n),!0&m)for(d=u[0]*i(l),o=1;o<a;++o)d+=u[o]*(i(l+c*h[o])+i(l-c*h[o]));else for(d=0,o=0;o<a;++o)d+=u[o]*(i(l+c*h[o])+i(l-c*h[o]));return c*d},_rescale_error:function(t,e,i){var s,n;return t=Math.abs(t),0!==i&&0!==t&&(t=(s=Math.pow(200*t/i,1.5))<1?i*s:i),e>20041683600089728e-310&&(n=11102230246251565e-30*e)>t&&(t=n),t},_gaussKronrod:function(t,e,i,s,n,r,o){var a,l,c,h,u,d,p,f,m,g,b,y=t[0],v=t[1],x=.5*(y+v),C=.5*(v-y),_=Math.abs(C),w=e(x),S=0,P=w*r[i-1],k=Math.abs(P),E=0,T=[],A=[];for(i%2==0&&(S=w*n[i/2-1]),a=Math.floor((i-1)/2),c=0;c<a;c++)f=(d=e(x-(u=C*s[h=2*c+1])))+(p=e(x+u)),T[h]=d,A[h]=p,S+=n[c]*f,P+=r[h]*f,k+=r[h]*(Math.abs(d)+Math.abs(p));for(a=Math.floor(i/2),c=0;c<a;c++)d=e(x-(u=C*s[m=2*c])),p=e(x+u),T[m]=d,A[m]=p,P+=r[m]*(d+p),k+=r[m]*(Math.abs(d)+Math.abs(p));for(g=.5*P,E=r[i-1]*Math.abs(w-g),c=0;c<i-1;c++)E+=r[c]*(Math.abs(T[c]-g)+Math.abs(A[c]-g));return b=(P-S)*C,l=P*=C,o.abserr=this._rescale_error(b,k*=_,E*=_),o.resabs=k,o.resasc=E,l},GaussKronrod15:function(t,e,i){return this._gaussKronrod(t,e,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],i)},GaussKronrod21:function(t,e,i){return this._gaussKronrod(t,e,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],i)},GaussKronrod31:function(t,e,i){return this._gaussKronrod(t,e,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],i)},_workspace:function(t,e){return{limit:e,size:0,nrmax:0,i:0,alist:[t[0]],blist:[t[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var t,e,i,s,n,r=this.size-1,o=this.limit,a=this.nrmax,l=this.order[a];if(r<2)return this.order[0]=0,this.order[1]=1,void(this.i=l);for(t=this.elist[l];a>0&&t>this.elist[this.order[a-1]];)this.order[a]=this.order[a-1],a--;for(n=r<o/2+2?r:o-r+1,i=a+1;i<n&&t<this.elist[this.order[i]];)this.order[i-1]=this.order[i],i++;for(this.order[i-1]=l,e=this.elist[r],s=n-1;s>i-2&&e>=this.elist[this.order[s]];)this.order[s+1]=this.order[s],s--;this.order[s+1]=r,this.i=l=this.order[a],this.nrmax=a},set_initial_result:function(t,e){this.size=1,this.rlist[0]=t,this.elist[0]=e},update:function(t,e,i,s,n,r,o,a){var l=this.i,c=this.size,h=this.level[this.i]+1;a>s?(this.alist[l]=n,this.rlist[l]=o,this.elist[l]=a,this.level[l]=h,this.alist[c]=t,this.blist[c]=e,this.rlist[c]=i,this.elist[c]=s,this.level[c]=h):(this.blist[l]=e,this.rlist[l]=i,this.elist[l]=s,this.level[l]=h,this.alist[c]=n,this.blist[c]=r,this.rlist[c]=o,this.elist[c]=a,this.level[c]=h),this.size++,h>this.maximum_level&&(this.maximum_level=h),this.qpsrt()},retrieve:function(){var t=this.i;return{a:this.alist[t],b:this.blist[t],r:this.rlist[t],e:this.elist[t]}},sum_results:function(){var t,e=this.size,i=0;for(t=0;t<e;t++)i+=this.rlist[t];return i},subinterval_too_small:function(t,e,i){var s=1.0000000000000222*(Math.abs(e)+22250738585072014e-321);return Math.abs(t)<=s&&Math.abs(i)<=s}}},Qag:function(s,n,r){var o,a,l,c,h,u,d,p,f,m,g,b,y,v,x,C,_,w=this._workspace(s,1e3),S=r&&e.isNumber(r.limit)?r.limit:15,P=r&&e.isNumber(r.epsrel)?r.epsrel:1e-7,k=r&&e.isNumber(r.epsabs)?r.epsabs:1e-7,E=r&&e.isFunction(r.q)?r.q:this.GaussKronrod15,T={},A=0,O=0,M=0,N=0,L=0,D=0,j=0,R=0,I=0,B=0;if(S>w.limit&&t.warn("iteration limit exceeds available workspace"),k<=0&&(P<50*i.eps||P<5e-29)&&t.warn("tolerance cannot be acheived with given epsabs and epsrel"),l=E.apply(this,[s,n,T]),h=T.resabs,u=T.resasc,w.set_initial_result(l,c=T.abserr),d=Math.max(k,P*Math.abs(l)),c<=11102230246251565e-30*h&&c>d)return t.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(c<=d&&c!==u||0===c)return l;if(1===S)return t.warn("a maximum of one iteration was insufficient"),-1/0;o=l,a=c,A=1;do{L=0,D=0,j=0,R=0,I=0,B=0,v=(_=w.retrieve()).r,x=_.e,m=f=.5*((b=_.a)+(y=_.b)),g=y,L=E.apply(this,[[p=b,f],n,T]),R=T.abserr,C=T.resasc,D=E.apply(this,[[m,g],n,T]),a+=(B=R+(I=T.abserr))-x,o+=(j=L+D)-v,C!==R&&T.resasc!==I&&(Math.abs(v-j)<=1e-5*Math.abs(j)&&B>=.99*x&&O++,A>=10&&B>x&&M++),a>(d=Math.max(k,P*Math.abs(o)))&&((O>=6||M>=20)&&(N=2),w.subinterval_too_small(p,m,g)&&(N=3)),w.update(p,f,L,R,m,g,D,I),b=(_=w.retrieve()).a_i,y=_.b_i,v=_.r_i,x=_.e_i,A++}while(A<S&&!N&&a>d);return w.sum_results()},I:function(t,e){return this.Qag(t,e,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(t,s,n){var r,o=0,a=i.eps,l=t.apply(n,[s]);for(e.isArray(s)&&(s=s[0]);o<50&&Math.abs(l)>a;)r=this.D(t,n)(s),Math.abs(r)>a?s-=l/r:s+=.2*Math.random()-1,l=t.apply(n,[s]),o+=1;return s},root:function(t,e,i){return this.fzero(t,e,i)},generalizedNewton:function(t,e,s,n){var r,o,a,l,c,h,u,d,p,f,m,g,b,y,v=0;for(this.generalizedNewton.t1memo?(r=this.generalizedNewton.t1memo,o=this.generalizedNewton.t2memo):(r=s,o=n),f=(d=t.X(r)-e.X(o))*d+(p=t.Y(r)-e.Y(o))*p,m=this.D(t.X,t),g=this.D(e.X,e),b=this.D(t.Y,t),y=this.D(e.Y,e);f>i.eps&&v<10;)a=m(r),l=-g(o),o-=(a*p-(c=b(r))*d)/(u=a*(h=-y(o))-l*c),f=(d=t.X(r-=(h*d-l*p)/u)-e.X(o))*d+(p=t.Y(r)-e.Y(o))*p,v+=1;return this.generalizedNewton.t1memo=r,this.generalizedNewton.t2memo=o,Math.abs(r)<Math.abs(o)?[t.X(r),t.Y(r)]:[e.X(o),e.Y(o)]},Neville:function(t){var e=[],s=function(s){return function(n,r){var o,a,l,c=i.binomial,h=t.length,u=h-1,d=0,p=0;if(!r)for(l=1,o=0;o<h;o++)e[o]=c(u,o)*l,l*=-1;for(a=n,o=0;o<h;o++){if(0===a)return t[o][s]();l=e[o]/a,a-=1,d+=t[o][s]()*l,p+=l}return d/p}};return[s("X"),s("Y"),0,function(){return t.length-1}]},splineDef:function(t,e){var i,s,n=Math.min(t.length,e.length),r=[],o=[],a=[],l=[],c=[],h=[];if(2===n)return[0,0];for(i=0;i<n;i++)a.push({X:t[i],Y:e[i]});for(a.sort((function(t,e){return t.X-e.X})),i=0;i<n;i++)t[i]=a[i].X,e[i]=a[i].Y;for(i=0;i<n-1;i++)l.push(t[i+1]-t[i]);for(i=0;i<n-2;i++)c.push(6*(e[i+2]-e[i+1])/l[i+1]-6*(e[i+1]-e[i])/l[i]);for(r.push(2*(l[0]+l[1])),o.push(c[0]),i=0;i<n-3;i++)r.push(2*(l[i+1]+l[i+2])-(s=l[i+1]/r[i])*l[i+1]),o.push(c[i+1]-s*o[i]);for(h[n-3]=o[n-3]/r[n-3],i=n-4;i>=0;i--)h[i]=(o[i]-l[i+1]*h[i+1])/r[i];for(i=n-3;i>=0;i--)h[i+1]=h[i];return h[0]=0,h[n-1]=0,h},splineEval:function(t,i,s,n){var r,o,a,l=Math.min(i.length,s.length),c=1,h=!1,u=[];for(e.isArray(t)?(c=t.length,h=!0):t=[t],r=0;r<c;r++){if(t[r]<i[0]||i[r]>i[l-1])return NaN;for(o=1;o<l&&!(t[r]<=i[o]);o++);u.push(s[o-=1]+((s[o+1]-s[o])/(i[o+1]-i[o])-(i[o+1]-i[o])/6*(n[o+1]+2*n[o])+(n[o]/2+(n[o+1]-n[o])/(6*(i[o+1]-i[o]))*(a=t[r]-i[o]))*a)*a)}return h?u:u[0]},generatePolynomialTerm:function(t,e,i,s){var n,r=[];for(n=e;n>=0;n--)r=r.concat(["(",t[n].toPrecision(s),")"]),n>1?r=r.concat(["*",i,"<sup>",n,"<","/sup> + "]):1===n&&(r=r.concat(["*",i," + "]));return r.join("")},lagrangePolynomial:function(t){var e=[],i=function(i,s){var n,r,o,a,l=t.length,c=0,h=0;if(!s)for(n=0;n<l;n++){for(e[n]=1,o=t[n].X(),r=0;r<l;r++)r!==n&&(e[n]*=o-t[r].X());e[n]=1/e[n]}for(n=0;n<l;n++){if(i===(o=t[n].X()))return t[n].Y();h+=a=e[n]/(i-o),c+=a*t[n].Y()}return c/h};return i.getTerm=function(){return""},i},_initCubicPoly:function(t,e,i,s){return[t,i,-3*t+3*e-2*i-s,2*t-2*e+i+s]},CardinalSpline:function(t,s,n){var r,o,a,l,c=[],h=this;return l=e.isFunction(s)?s:function(){return s},void 0===n&&(n="uniform"),[(o=function(e){return function(s,o){var u,d,p,f,m,g,b,y,v;if(t.length<2)return NaN;if(!o)for(a=l(),p={X:function(){return 2*t[t.length-1].X()-t[t.length-2].X()},Y:function(){return 2*t[t.length-1].Y()-t[t.length-2].Y()},Dist:function(t){var e=this.X()-t.X(),i=this.Y()-t.Y();return Math.sqrt(e*e+i*i)}},v=(r=[{X:function(){return 2*t[0].X()-t[1].X()},Y:function(){return 2*t[0].Y()-t[1].Y()},Dist:function(t){var e=this.X()-t.X(),i=this.Y()-t.Y();return Math.sqrt(e*e+i*i)}}].concat(t,[p])).length,c[e]=[],u=0;u<v-3;u++)"centripetal"===n?(g=r[u].Dist(r[u+1]),b=r[u+2].Dist(r[u+1]),y=r[u+3].Dist(r[u+2]),g=Math.sqrt(g),b=Math.sqrt(b),y=Math.sqrt(y),b<i.eps&&(b=1),g<i.eps&&(g=b),y<i.eps&&(y=b),f=(r[u+1][e]()-r[u][e]())/g-(r[u+2][e]()-r[u][e]())/(b+g)+(r[u+2][e]()-r[u+1][e]())/b,m=(r[u+2][e]()-r[u+1][e]())/b-(r[u+3][e]()-r[u+1][e]())/(y+b)+(r[u+3][e]()-r[u+2][e]())/y,f*=b,m*=b,c[e][u]=h._initCubicPoly(r[u+1][e](),r[u+2][e](),a*f,a*m)):c[e][u]=h._initCubicPoly(r[u+1][e](),r[u+2][e](),a*(r[u+2][e]()-r[u][e]()),a*(r[u+3][e]()-r[u+1][e]()));return isNaN(s)?NaN:(v=t.length,s<=0?t[0][e]():s>=v?t[v-1][e]():(u=Math.floor(s))===s?t[u][e]():(s-=u,void 0===(d=c[e][u])?NaN:((d[3]*s+d[2])*s+d[1])*s+d[0]))}})("X"),o("Y"),0,function(){return t.length-1}]},CatmullRomSpline:function(t,e){return this.CardinalSpline(t,.5,e)},regressionPolynomial:function(t,s,n){var r,o,a,l,c,h,u="";if(e.isPoint(t)&&e.isFunction(t.Value))o=function(){return t.Value()};else if(e.isFunction(t))o=t;else{if(!e.isNumber(t))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof t+"'.");o=function(){return t}}if(3===arguments.length&&e.isArray(s)&&e.isArray(n))c=0;else if(2===arguments.length&&e.isArray(s)&&s.length>0&&e.isPoint(s[0]))c=1;else{if(!(2===arguments.length&&e.isArray(s)&&s.length>0&&s[0].usrCoords&&s[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");c=2}return(h=function(t,h){var d,p,f,m,g,b,y,v,x,C=s.length;if(x=Math.floor(o()),!h){if(1===c)for(a=[],l=[],d=0;d<C;d++)a[d]=s[d].X(),l[d]=s[d].Y();if(2===c)for(a=[],l=[],d=0;d<C;d++)a[d]=s[d].usrCoords[1],l[d]=s[d].usrCoords[2];if(0===c)for(a=[],l=[],d=0;d<C;d++)e.isFunction(s[d])?a.push(s[d]()):a.push(s[d]),e.isFunction(n[d])?l.push(n[d]()):l.push(n[d]);for(f=[],p=0;p<C;p++)f.push([1]);for(d=1;d<=x;d++)for(p=0;p<C;p++)f[p][d]=f[p][d-1]*a[p];g=l,m=i.transpose(f),b=i.matMatMult(m,f),y=i.matVecMult(m,g),r=i.Numerics.Gauss(b,y),u=i.Numerics.generatePolynomialTerm(r,x,"x",3)}for(v=r[x],d=x-1;d>=0;d--)v=v*t+r[d];return v}).getTerm=function(){return u},h},bezier:function(t){var e,i,s=function(s){return function(n,r){var o=3*Math.floor(n),a=n%1,l=1-a;return r||(i=3*Math.floor((t.length-1)/3),e=Math.floor(i/3)),n<0?t[0][s]():n>=e?t[i][s]():isNaN(n)?NaN:l*l*(l*t[o][s]()+3*a*t[o+1][s]())+(3*l*t[o+2][s]()+a*t[o+3][s]())*a*a}};return[s("X"),s("Y"),0,function(){return Math.floor(t.length/3)}]},bspline:function(t,e){var i,s=[],n=function(n){return function(r,o){var a,l,c,h=t.length,u=h-1,d=e;if(u<=0)return NaN;if(u+2<=d&&(d=u+1),r<=0)return t[0][n]();if(r>=u-d+2)return t[u][n]();for(c=Math.floor(r)+d-1,i=function(t,e){var i,s=[];for(i=0;i<t+e+1;i++)s[i]=i<e?0:i<=t?i-e+1:t-e+2;return s}(u,d),s=function(t,e,i,s,n){var r,o,a,l,c=[];for(c[n]=e[n]<=t&&t<e[n+1]?1:0,r=2;r<=s;r++)for(o=n-r+1;o<=n;o++)a=o>=n?0:c[o+1],c[o]=0==(l=e[o+r-1]-e[o])?0:(t-e[o])/l*(o<=n-r+1||o<0?0:c[o]),0!=(l=e[o+r]-e[o+1])&&(c[o]+=(e[o+r]-t)/l*a);return c}(r,i,0,d,c),a=0,l=c-d+1;l<=c;l++)l<h&&l>=0&&(a+=t[l][n]()*s[l]);return a}};return[n("X"),n("Y"),0,function(){return t.length-1}]},D:function(t,i){return e.exists(i)?function(e,s){var n=1e-5;return(t.apply(i,[e+n,s])-t.apply(i,[e-n,s]))/2e-5}:function(e,i){var s=1e-5;return(t(e+s,i)-t(e-s,i))/2e-5}},_riemannValue:function(t,e,i,s){var n,r,o,a;if(s<0&&("trapezoidal"!==i&&(t+=s),s*=-1,"lower"===i?i="upper":"upper"===i&&(i="lower")),a=.01*s,"right"===i)n=e(t+s);else if("middle"===i)n=e(t+.5*s);else if("left"===i||"trapezoidal"===i)n=e(t);else if("lower"===i){for(n=e(t),o=t+a;o<=t+s;o+=a)(r=e(o))<n&&(n=r);(r=e(t+s))<n&&(n=r)}else if("upper"===i){for(n=e(t),o=t+a;o<=t+s;o+=a)(r=e(o))>n&&(n=r);(r=e(t+s))>n&&(n=r)}else n="random"===i?e(t+s*Math.random()):"simpson"===i?(e(t)+4*e(t+.5*s)+e(t+s))/6:e(t);return n},riemann:function(t,i,s,n,r){var o,a,l,c,h,u,d,p=[],f=[],m=0,g=n,b=0;if(e.isArray(t)?(h=t[0],c=t[1]):c=t,(i=Math.floor(i))<=0)return[p,f,b];for(a=(r-n)/i,o=0;o<i;o++)l=this._riemannValue(g,c,s,a),p[m]=g,f[m]=l,m+=1,g+=a,"trapezoidal"===s&&(l=c(g)),p[m]=g,f[m]=l,m+=1;for(o=0;o<i;o++)l=h?this._riemannValue(g,h,s,-a):0,p[m]=g,f[m]=l,m+=1,g-=a,"trapezoidal"===s&&h&&(l=h(g)),p[m]=g,f[m]=l,"trapezoidal"!==s?(u=l,d=f[2*(i-1)-2*o]):(d=.5*(c(g+a)+c(g)),u=h?.5*(h(g+a)+h(g)):0),b+=(d-u)*a,p[m+=1]=g,f[m]=f[2*(i-1)-2*o],m+=1;return[p,f,b]},riemannsum:function(e,i,s,n,r){return t.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(e,i,s,n,r)[2]},rungeKutta:function(t,i,n,r,o){var a,l,c,h,u,d,p=[],f=[],m=(n[1]-n[0])/r,g=n[0],b=i.length,y=[],v=0;for(e.isString(t)&&(t=s[t]||s.euler),d=t.s,a=0;a<b;a++)p[a]=i[a];for(l=0;l<r;l++){for(y[v]=[],a=0;a<b;a++)y[v][a]=p[a];for(v+=1,h=[],c=0;c<d;c++){for(a=0;a<b;a++)f[a]=0;for(u=0;u<c;u++)for(a=0;a<b;a++)f[a]+=t.A[c][u]*m*h[u][a];for(a=0;a<b;a++)f[a]+=p[a];h.push(o(g+t.c[c]*m,f))}for(a=0;a<b;a++)f[a]=0;for(u=0;u<d;u++)for(a=0;a<b;a++)f[a]+=t.b[u]*h[u][a];for(a=0;a<b;a++)p[a]=p[a]+m*f[a];g+=m}return y},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(t,s,n){var r,o,a,l,c,h,u,d,p,f,m,g,b,y,v,x,C,_,w,S,P=i.eps,k=this.maxIterationsRoot,E=0;if(e.isArray(s)){if(s.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");l=t.call(n,r=s[0]),c=t.call(n,o=s[1])}else{for(l=t.call(n,r=s),f=(d=[.9*(u=0===r?1:r),1.1*u,u-1,u+1,.5*u,1.5*u,-u,2*u,-10*u,10*u]).length,p=0;p<f&&!(l*(c=t.call(n,o=d[p]))<=0);p++);o<r&&(m=r,r=o,o=m,g=l,l=c,c=g)}if(l*c>0)return e.isArray(s)?this.fminbr(t,[r,o],n):this.Newton(t,r,n);for(a=r,h=l;E<k;){if(b=o-r,Math.abs(h)<Math.abs(c)&&(r=o,o=a,a=r,l=c,c=h,h=l),C=2*P*Math.abs(o)+.5*P,S=.5*(a-o),Math.abs(S)<=C&&Math.abs(c)<=P)return o;Math.abs(b)>=C&&Math.abs(l)>Math.abs(c)&&(v=a-o,r===a?(_=v*(y=c/l),w=1-y):(_=(x=c/l)*(v*(w=l/h)*(w-(y=c/h))-(o-r)*(y-1)),w=(w-1)*(y-1)*(x-1)),_>0?w=-w:_=-_,_<.75*v*w-.5*Math.abs(C*w)&&_<Math.abs(b*w*.5)&&(S=_/w)),Math.abs(S)<C&&(S=S>0?C:-C),r=o,l=c,((c=t.call(n,o+=S))>0&&h>0||c<0&&h<0)&&(a=r,h=l),E++}return o},fminbr:function(t,s,n){var r,o,a,l,c,h,u,d,p,f,m,g,b,y,v,x,C=.5*(3-Math.sqrt(5)),_=i.eps,w=i.eps,S=this.maxIterationsMinimize,P=0;if(!e.isArray(s)||s.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(a=l=(r=s[0])+C*((o=s[1])-r),c=l,h=u=t.call(n,l),d=u;P<S;){if(p=o-r,f=.5*(r+o),m=w*Math.abs(a)+_/3,Math.abs(a-f)+.5*p<=2*m)return a;g=C*(a<f?o-a:r-a),Math.abs(a-c)>=m&&(b=(a-l)*(y=(a-l)*(h-d))-(a-c)*(v=(a-c)*(h-u)),(y=2*(y-v))>0?b=-b:y=-y,Math.abs(b)<Math.abs(g*y)&&b>y*(r-a+2*m)&&b<y*(o-a-2*m)&&(g=b/y)),Math.abs(g)<m&&(g=g>0?m:-m),(x=t.call(n,v=a+g))<=h?(v<a?o=a:r=a,l=c,c=a,a=v,u=d,d=h,h=x):(v<a?r=v:o=v,x<=d||c===a?(l=c,c=v,u=d,d=x):(x<=u||l===a||l===c)&&(l=v,u=x)),P+=1}return a},RamerDouglasPeucker:function(t,e){var s,n,r,o=[],a=function(t,e,s){var n,r,o,a,l,c,h,u,d,p,f,m=0,g=e;if(s-e<2)return[-1,0];if(o=t[e].scrCoords,a=t[s].scrCoords,isNaN(o[1]+o[2]))return[NaN,e];if(isNaN(a[1]+a[2]))return[NaN,s];for(r=e+1;r<s;r++){if(l=t[r].scrCoords,isNaN(l[1]+l[2]))return[NaN,r];c=l[1]-o[1],h=l[2]-o[2],(p=(u=a[1]-o[1])*u+(d=a[2]-o[2])*d)>=i.eps?((f=(c*u+h*d)/p)<0?f=0:f>1&&(f=1),n=(c-=f*u)*c+(h-=f*d)*h):(f=0,n=c*c+h*h),n>m&&(m=n,g=r)}return[Math.sqrt(m),g]},l=function(t,e,i,s,n){var r=a(t,e,i),o=r[1];if(isNaN(r[0])){l(t,e,o-1,s,n),n.push(t[o]);do{++o}while(o<=i&&isNaN(t[o].scrCoords[1]+t[o].scrCoords[2]));o<=i&&n.push(t[o]),l(t,o+1,i,s,n)}else r[0]>s?(l(t,e,o,s,n),l(t,o,i,s,n)):n.push(t[i])};for(r=t.length,s=0;s<r&&isNaN(t[s].scrCoords[1]+t[s].scrCoords[2]);)s+=1;for(n=r-1;n>s&&isNaN(t[n].scrCoords[1]+t[n].scrCoords[2]);)n-=1;return s>n||s===r||(o[0]=t[s],l(t,s,n,e,o)),o},RamerDouglasPeuker:function(e,i){return t.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(e,i)},Visvalingam:function(e,i){var s,n,r,o,a,l,c,h,u,d=[],p=[],f=[];if((n=e.length)<=2)return e;for(d[0]={used:!0,lft:null,node:null},a=0,s=1;s<n-1;s++)r=Math.abs(t.Math.Numerics.det([e[s-1].usrCoords,e[s].usrCoords,e[s+1].usrCoords])),isNaN(r)||(p.push(u={v:r,idx:s}),d[s]={used:!0,lft:a,node:u},d[a].rt=s,a=s);for(d[n-1]={used:!0,rt:null,lft:a,node:null},d[a].rt=n-1,o=-1/0;p.length>i;)p.sort((function(t,e){return e.v-t.v})),d[s=p.pop().idx].used=!1,o=d[s].node.v,d[a=d[s].lft].rt=l=d[s].rt,d[l].lft=a,null!==(c=d[a].lft)&&(r=Math.abs(t.Math.Numerics.det([e[c].usrCoords,e[a].usrCoords,e[l].usrCoords])),d[a].node.v=r>=o?r:o),null!==(h=d[l].rt)&&(r=Math.abs(t.Math.Numerics.det([e[a].usrCoords,e[l].usrCoords,e[h].usrCoords])),d[l].node.v=r>=o?r:o);f=[e[s=0]];do{f.push(e[s=d[s].rt])}while(null!==d[s].rt);return f}},i.Numerics})),define("math/statistics",["jxg","math/math","utils/type"],(function(t,e,i){"use strict";return e.Statistics={sum:function(t){var e,i=t.length,s=0;for(e=0;e<i;e++)s+=t[e];return s},prod:function(t){var e,i=t.length,s=1;for(e=0;e<i;e++)s*=t[e];return s},mean:function(t){return t.length>0?this.sum(t)/t.length:0},median:function(t){var e,i;return t.length>0?((e=t.slice(0)).sort((function(t,e){return t-e})),(i=e.length)%2==1?e[parseInt(.5*i,10)]:.5*(e[.5*i-1]+e[.5*i])):0},variance:function(t){var e,i,s,n=t.length;if(n>1){for(e=this.mean(t),i=0,s=0;s<n;s++)i+=(t[s]-e)*(t[s]-e);return i/(t.length-1)}return 0},sd:function(t){return Math.sqrt(this.variance(t))},weightedMean:function(t,e){if(t.length!==e.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return t.length>0?this.mean(this.multiply(t,e)):0},max:function(t){return Math.max.apply(this,t)},min:function(t){return Math.min.apply(this,t)},range:function(t){return[this.min(t),this.max(t)]},abs:function(t){var e,s,n;if(i.isArray(t))for(s=t.length,n=[],e=0;e<s;e++)n[e]=Math.abs(t[e]);else n=Math.abs(t);return n},add:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]+e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t+e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]+e[s];else r=t+e;return r},div:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]/e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t/e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]/e[s];else r=t/e;return r},divide:function(){t.deprecated("Statistics.divide()","Statistics.div()"),e.Statistics.div.apply(e.Statistics,arguments)},mod:function(t,s,n){var r,o,a=[],l=function(t,e){return t%e};if((n=i.def(n,!1))&&(l=e.mod),t=i.evalSlider(t),s=i.evalSlider(s),i.isArray(t)&&i.isNumber(s))for(o=t.length,r=0;r<o;r++)a[r]=l(t[r],s);else if(i.isNumber(t)&&i.isArray(s))for(o=s.length,r=0;r<o;r++)a[r]=l(t,s[r]);else if(i.isArray(t)&&i.isArray(s))for(o=Math.min(t.length,s.length),r=0;r<o;r++)a[r]=l(t[r],s[r]);else a=l(t,s);return a},multiply:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]*e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t*e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]*e[s];else r=t*e;return r},subtract:function(t,e){var s,n,r=[];if(t=i.evalSlider(t),e=i.evalSlider(e),i.isArray(t)&&i.isNumber(e))for(n=t.length,s=0;s<n;s++)r[s]=t[s]-e;else if(i.isNumber(t)&&i.isArray(e))for(n=e.length,s=0;s<n;s++)r[s]=t-e[s];else if(i.isArray(t)&&i.isArray(e))for(n=Math.min(t.length,e.length),s=0;s<n;s++)r[s]=t[s]-e[s];else r=t-e;return r},TheilSenRegression:function(t){var i,s,n=[],r=[],o=[];for(i=0;i<t.length;i++){for(r.length=0,s=0;s<t.length;s++)Math.abs(t[s].usrCoords[1]-t[i].usrCoords[1])>e.eps&&(r[s]=(t[s].usrCoords[2]-t[i].usrCoords[2])/(t[s].usrCoords[1]-t[i].usrCoords[1]));n[i]=this.median(r),o.push(t[i].usrCoords[2]-n[i]*t[i].usrCoords[1])}return[this.median(o),this.median(n),-1]}},e.Statistics})),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],(function(t,e,i,s,n,r,o){"use strict";return s.Geometry={},t.extend(s.Geometry,{angle:function(e,i,s){var n,r,o,a,l=[],c=[],h=[];return t.deprecated("Geometry.angle()","Geometry.rad()"),e.coords?(l[0]=e.coords.usrCoords[1],l[1]=e.coords.usrCoords[2]):(l[0]=e[0],l[1]=e[1]),i.coords?(c[0]=i.coords.usrCoords[1],c[1]=i.coords.usrCoords[2]):(c[0]=i[0],c[1]=i[1]),s.coords?(h[0]=s.coords.usrCoords[1],h[1]=s.coords.usrCoords[2]):(h[0]=s[0],h[1]=s[1]),n=l[0]-c[0],r=l[1]-c[1],o=h[0]-c[0],a=h[1]-c[1],Math.atan2(n*a-r*o,n*o+r*a)},trueAngle:function(t,e,i){return 57.29577951308232*this.rad(t,e,i)},rad:function(t,e,i){var s,n,r,o,a,l,c;return t.coords?(s=t.coords.usrCoords[1],n=t.coords.usrCoords[2]):(s=t[0],n=t[1]),e.coords?(r=e.coords.usrCoords[1],o=e.coords.usrCoords[2]):(r=e[0],o=e[1]),i.coords?(a=i.coords.usrCoords[1],l=i.coords.usrCoords[2]):(a=i[0],l=i[1]),(c=Math.atan2(l-o,a-r)-Math.atan2(n-o,s-r))<0&&(c+=6.283185307179586),c},angleBisector:function(t,s,n,o){var a,l,c,h,u,d=t.coords.usrCoords,p=s.coords.usrCoords,f=n.coords.usrCoords;return r.exists(o)||(o=t.board),0===p[0]?new i(e.COORDS_BY_USER,[1,.5*(d[1]+f[1]),.5*(d[2]+f[2])],o):(h=d[1]-p[1],u=d[2]-p[2],a=Math.atan2(u,h),h=f[1]-p[1],u=f[2]-p[2],c=.5*(a+(l=Math.atan2(u,h))),a>l&&(c+=Math.PI),h=Math.cos(c)+p[1],u=Math.sin(c)+p[2],new i(e.COORDS_BY_USER,[1,h,u],o))},reflection:function(t,s,n){var o,a,l,c=s.coords.usrCoords,h=t.point1.coords.usrCoords,u=t.point2.coords.usrCoords;return r.exists(n)||(n=s.board),new i(e.COORDS_BY_USER,[c[1]+2*(l=((o=u[1]-h[1])*(c[2]-h[2])-(a=u[2]-h[2])*(c[1]-h[1]))/(o*o+a*a))*a,c[2]-2*l*o],n)},rotation:function(t,s,n,o){var a,l,c,h,u=s.coords.usrCoords,d=t.coords.usrCoords;return r.exists(o)||(o=s.board),a=u[1]-d[1],l=u[2]-d[2],c=Math.cos(n),h=Math.sin(n),new i(e.COORDS_BY_USER,[a*c-l*h+d[1],a*h+l*c+d[2]],o)},perpendicular:function(t,n,o){var a,l,c,h,u,d=t.point1.coords.usrCoords,p=t.point2.coords.usrCoords,f=n.coords.usrCoords;return r.exists(o)||(o=n.board),n===t.point1?(a=d[1]+p[2]-d[2],l=d[2]-p[1]+d[1],u=d[0]*p[0],Math.abs(u)<s.eps&&(a=p[2],l=-p[1]),h=[u,a,l],c=!0):n===t.point2?(a=p[1]+d[2]-p[2],l=p[2]-d[1]+p[1],u=d[0]*p[0],Math.abs(u)<s.eps&&(a=d[2],l=-d[1]),h=[u,a,l],c=!1):Math.abs(s.innerProduct(f,t.stdform,3))<s.eps?(a=f[1]+p[2]-f[2],l=f[2]-p[1]+f[1],u=p[0],Math.abs(u)<s.eps&&(a=p[2],l=-p[1]),c=!0,Math.abs(u)>s.eps&&Math.abs(a-f[1])<s.eps&&Math.abs(l-f[2])<s.eps&&(a=f[1]+d[2]-f[2],l=f[2]-d[1]+f[1],c=!1),h=[u,a,l]):(h=s.crossProduct(h=[0,t.stdform[1],t.stdform[2]],f),h=s.crossProduct(h,t.stdform),c=!0),[new i(e.COORDS_BY_USER,h,o),c]},circumcenterMidpoint:function(){t.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(t,n,o,a){var l,c,h=t.coords.usrCoords,u=n.coords.usrCoords,d=o.coords.usrCoords;return r.exists(a)||(a=t.board),l=s.crossProduct([u[0]-h[0],-u[2]+h[2],u[1]-h[1]],[.5*(h[0]+u[0]),.5*(h[1]+u[1]),.5*(h[2]+u[2])]),c=s.crossProduct([d[0]-u[0],-d[2]+u[2],d[1]-u[1]],[.5*(u[0]+d[0]),.5*(u[1]+d[1]),.5*(u[2]+d[2])]),new i(e.COORDS_BY_USER,s.crossProduct(l,c),a)},distance:function(t,e,i){var s,n=0;for(i||(i=Math.min(t.length,e.length)),s=0;s<i;s++)n+=(t[s]-e[s])*(t[s]-e[s]);return Math.sqrt(n)},affineDistance:function(t,e,i){var n;return(n=this.distance(t,e,i))>s.eps&&(Math.abs(t[0])<s.eps||Math.abs(e[0])<s.eps)?1/0:n},sortVertices:function(t){var e,i,n=o.each(t,o.coordsArray),a=n.length;for(e=1;e<a;e++)(n[e][2]<n[0][2]||Math.abs(n[e][2]-n[0][2])<s.eps&&n[e][1]<n[0][1])&&(n=r.swap(n,e,0));return i=n.shift(),n.sort((function(t,e){return Math.atan2(t[2]-i[2],t[1]-i[1])-Math.atan2(e[2]-i[2],e[1]-i[1])})),n.unshift(i),n.unshift(n[n.length-1]),n},signedTriangle:function(t,e,i){var s=o.coordsArray(t),n=o.coordsArray(e),r=o.coordsArray(i);return.5*((n[1]-s[1])*(r[2]-s[2])-(n[2]-s[2])*(r[1]-s[1]))},signedPolygon:function(t,e){var i,s,n=0,r=o.each(t,o.coordsArray);for(void 0===e&&(e=!0),e?r.unshift(r[r.length-1]):r=this.sortVertices(r),s=r.length,i=1;i<s;i++)n+=r[i-1][1]*r[i][2]-r[i][1]*r[i-1][2];return.5*n},GrahamScan:function(t){var e,i,s=1,n=o.each(t,o.coordsArray);for(i=(n=this.sortVertices(n)).length,e=2;e<i;e++){for(;this.signedTriangle(n[s-1],n[s],n[e])<=0;)if(s>1)s-=1;else{if(e===i-1)break;e+=1}n=r.swap(n,s+=1,e)}return n.slice(0,s)},calcStraight:function(t,i,n,o){var a,l,c,h,u,d,p,f,m,g;if(r.exists(o)||(o=10),d=r.evaluate(t.visProp.straightfirst),p=r.evaluate(t.visProp.straightlast),Math.abs(i.scrCoords[0])<s.eps&&(d=!0),Math.abs(n.scrCoords[0])<s.eps&&(p=!0),(d||p)&&((f=[])[0]=t.stdform[0]-t.stdform[1]*t.board.origin.scrCoords[1]/t.board.unitX+t.stdform[2]*t.board.origin.scrCoords[2]/t.board.unitY,f[1]=t.stdform[1]/t.board.unitX,f[2]=-t.stdform[2]/t.board.unitY,!isNaN(f[0]+f[1]+f[2]))){if(a=!d&&Math.abs(i.usrCoords[0])>=s.eps&&i.scrCoords[1]>=0&&i.scrCoords[1]<=t.board.canvasWidth&&i.scrCoords[2]>=0&&i.scrCoords[2]<=t.board.canvasHeight,l=!p&&Math.abs(n.usrCoords[0])>=s.eps&&n.scrCoords[1]>=0&&n.scrCoords[1]<=t.board.canvasWidth&&n.scrCoords[2]>=0&&n.scrCoords[2]<=t.board.canvasHeight,h=(c=this.meetLineBoard(f,t.board,o))[0],u=c[1],!a&&!l){if(!d&&p&&!this.isSameDirection(i,n,h)&&!this.isSameDirection(i,n,u))return;if(d&&!p&&!this.isSameDirection(n,i,h)&&!this.isSameDirection(n,i,u))return}a?l||(g=this.isSameDir(i,n,h,u)?u:h):l?m=this.isSameDir(i,n,h,u)?h:u:this.isSameDir(i,n,h,u)?(m=h,g=u):(g=h,m=u),m&&i.setCoordinates(e.COORDS_BY_USER,m.usrCoords),g&&n.setCoordinates(e.COORDS_BY_USER,g.usrCoords)}},calcLineDelimitingPoints:function(t,i,n){var o,a,l,c,h,u,d,p,f,m=!1,g=!1;if(h=r.evaluate(t.visProp.straightfirst),u=r.evaluate(t.visProp.straightlast),Math.abs(i.scrCoords[0])<s.eps&&(h=!0),Math.abs(n.scrCoords[0])<s.eps&&(u=!0),(d=[])[0]=t.stdform[0]-t.stdform[1]*t.board.origin.scrCoords[1]/t.board.unitX+t.stdform[2]*t.board.origin.scrCoords[2]/t.board.unitY,d[1]=t.stdform[1]/t.board.unitX,d[2]=-t.stdform[2]/t.board.unitY,!isNaN(d[0]+d[1]+d[2])){if(m=!h,g=!u,a=t.board.getBoundingBox(),t.getSlope()>=0?(l=this.projectPointToLine({coords:{usrCoords:[1,a[2],a[1]]}},t,t.board),c=this.projectPointToLine({coords:{usrCoords:[1,a[0],a[3]]}},t,t.board)):(l=this.projectPointToLine({coords:{usrCoords:[1,a[0],a[1]]}},t,t.board),c=this.projectPointToLine({coords:{usrCoords:[1,a[2],a[3]]}},t,t.board)),!m&&!g){if(!h&&!u){if(o=i.distance(e.COORDS_BY_USER,n),Math.abs(i.distance(e.COORDS_BY_USER,l)+l.distance(e.COORDS_BY_USER,n)-o)>s.eps)return;if(Math.abs(i.distance(e.COORDS_BY_USER,c)+c.distance(e.COORDS_BY_USER,n)-o)>s.eps)return}if(!h&&u&&!this.isSameDirection(i,n,l)&&!this.isSameDirection(i,n,c))return;if(h&&!u&&!this.isSameDirection(n,i,l)&&!this.isSameDirection(n,i,c))return}m?g||(f=this.isSameDir(i,n,l,c)?c:l):g?p=this.isSameDir(i,n,l,c)?l:c:this.isSameDir(i,n,l,c)?(p=l,f=c):(f=l,p=c),p&&i.setCoordinates(e.COORDS_BY_USER,p.usrCoords),f&&n.setCoordinates(e.COORDS_BY_USER,f.usrCoords)}},calcLabelQuadrant:function(t){return t<0&&(t+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((t+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(t,e,i,n){var r=e.usrCoords[1]-t.usrCoords[1],o=e.usrCoords[2]-t.usrCoords[2],a=n.usrCoords[1]-i.usrCoords[1],l=n.usrCoords[2]-i.usrCoords[2];return Math.abs(e.usrCoords[0])<s.eps&&(r=e.usrCoords[1],o=e.usrCoords[2]),Math.abs(t.usrCoords[0])<s.eps&&(r=-t.usrCoords[1],o=-t.usrCoords[2]),r*a+o*l>=0},isSameDirection:function(t,e,i){var n,r,o,a,l=!1;return n=e.usrCoords[1]-t.usrCoords[1],r=e.usrCoords[2]-t.usrCoords[2],o=i.usrCoords[1]-t.usrCoords[1],a=i.usrCoords[2]-t.usrCoords[2],Math.abs(n)<s.eps&&(n=0),Math.abs(r)<s.eps&&(r=0),Math.abs(o)<s.eps&&(o=0),Math.abs(a)<s.eps&&(a=0),(n>=0&&o>=0||n<=0&&o<=0)&&(l=r>=0&&a>=0||r<=0&&a<=0),l},intersectionFunction:function(t,s,n,o,a,l){var c=this;return s.elementClass===e.OBJECT_CLASS_CURVE&&n.elementClass===e.OBJECT_CLASS_CURVE?function(){return c.meetCurveCurve(s,n,o,a,s.board)}:s.elementClass===e.OBJECT_CLASS_CURVE&&n.elementClass===e.OBJECT_CLASS_LINE||n.elementClass===e.OBJECT_CLASS_CURVE&&s.elementClass===e.OBJECT_CLASS_LINE?function(){return c.meetCurveLine(s,n,o,s.board,l)}:s.elementClass===e.OBJECT_CLASS_LINE&&n.elementClass===e.OBJECT_CLASS_LINE?function(){var t,a,h,u,d;return a=h=r.evaluate(s.visProp.straightfirst),u=d=r.evaluate(s.visProp.straightlast),r.evaluate(l)||a&&u&&h&&d?c.meet(s.stdform,n.stdform,o,s.board):(t=c.meetSegmentSegment(s.point1.coords.usrCoords,s.point2.coords.usrCoords,n.point1.coords.usrCoords,n.point2.coords.usrCoords,s.board),new i(e.COORDS_BY_USER,!a&&t[1]<0||!u&&t[1]>1||!h&&t[2]<0||!d&&t[2]>1?[0,NaN,NaN]:t[0],s.board))}:function(){return c.meet(s.stdform,n.stdform,o,s.board)}},meet:function(t,e,i,n){var r=s.eps;return Math.abs(t[3])<r&&Math.abs(e[3])<r?this.meetLineLine(t,e,i,n):Math.abs(t[3])>=r&&Math.abs(e[3])<r?this.meetLineCircle(e,t,i,n):Math.abs(t[3])<r&&Math.abs(e[3])>=r?this.meetLineCircle(t,e,i,n):this.meetCircleCircle(t,e,i,n)},meetLineBoard:function(t,n,o){var a,l,c,h,u=[];for(r.exists(o)||(o=0),u[0]=s.crossProduct(t,[o,0,1]),u[1]=s.crossProduct(t,[o,1,0]),u[2]=s.crossProduct(t,[-o-n.canvasHeight,0,1]),u[3]=s.crossProduct(t,[-o-n.canvasWidth,1,0]),c=0;c<4;c++)if(Math.abs(u[c][0])>s.eps){for(h=2;h>0;h--)u[c][h]/=u[c][0];u[c][0]=1}return Math.abs(u[1][0])<s.eps?(a=u[0],l=u[2]):Math.abs(u[0][0])<s.eps?(a=u[1],l=u[3]):u[1][2]<0?(a=u[0],l=u[3][2]>n.canvasHeight?u[2]:u[3]):u[1][2]>n.canvasHeight?(a=u[2],l=u[3][2]<0?u[0]:u[3]):(a=u[1],l=u[3][2]<0?u[0]:u[3][2]>n.canvasHeight?u[2]:u[3]),[a=new i(e.COORDS_BY_SCREEN,a.slice(1),n),l=new i(e.COORDS_BY_SCREEN,l.slice(1),n)]},meetLineLine:function(t,n,r,o){var a=isNaN(t[5]+n[5])?[0,0,0]:s.crossProduct(t,n);return new i(e.COORDS_BY_USER,a,o)},meetLineCircle:function(t,n,r,o){var a,l,c,h,u,d,p,f,m;return n[4]<s.eps?Math.abs(s.innerProduct([1,n[6],n[7]],t,3))<s.eps?new i(e.COORDS_BY_USER,n.slice(6,8),o):new i(e.COORDS_BY_USER,[NaN,NaN],o):(c=n[0],l=n.slice(1,3),a=n[3],h=t[0],u=t.slice(1,3),(f=(p=l[0]*u[1]-l[1]*u[0])*p-4*(d=a)*(a*h*h-(l[0]*u[0]+l[1]*u[1])*h+c))>-s.eps*s.eps?(m=[(-p+(f=Math.sqrt(Math.abs(f))))/(2*d),(-p-f)/(2*d)],new i(e.COORDS_BY_USER,0===r?[-m[0]*-u[1]-h*u[0],-m[0]*u[0]-h*u[1]]:[-m[1]*-u[1]-h*u[0],-m[1]*u[0]-h*u[1]],o)):new i(e.COORDS_BY_USER,[0,0,0],o))},meetCircleCircle:function(t,n,r,o){var a;return t[4]<s.eps?Math.abs(this.distance(t.slice(6,2),n.slice(6,8))-n[4])<s.eps?new i(e.COORDS_BY_USER,t.slice(6,8),o):new i(e.COORDS_BY_USER,[0,0,0],o):n[4]<s.eps?Math.abs(this.distance(n.slice(6,2),t.slice(6,8))-t[4])<s.eps?new i(e.COORDS_BY_USER,n.slice(6,8),o):new i(e.COORDS_BY_USER,[0,0,0],o):(a=s.normalize(a=[n[3]*t[0]-t[3]*n[0],n[3]*t[1]-t[3]*n[1],n[3]*t[2]-t[3]*n[2],0,1,1/0,1/0,1/0]),this.meetLineCircle(a,t,r,o))},meetCurveCurve:function(t,s,o,a,l,c){var h;return h=r.exists(c)&&"newton"===c?n.generalizedNewton(t,s,o,a):3===t.bezierDegree&&3===s.bezierDegree?this.meetBezierCurveRedBlueSegments(t,s,o):this.meetCurveRedBlueSegments(t,s,o),new i(e.COORDS_BY_USER,h,l)},meetCurveLine:function(t,i,s,n,o){var a,l;return r.exists(n)||(n=t.board),t.elementClass===e.OBJECT_CLASS_CURVE?(a=t,l=i):(a=i,l=t),this.meetCurveLineDiscrete(a,l,s,n,!o)},meetCurveLineContinuous:function(t,r,o,a,l){var c,h,u,d,p,f,m,g,b,y,v,x,C,_=s.eps,w=s.eps;for(d=this.meetCurveLineDiscrete(t,r,o,a,l),p=d.usrCoords[1],f=d.usrCoords[2],h=function(e){var i,s;return e>t.maxX()||e<t.minX()?1/0:(i=p-t.X(e))*i+(s=f-t.Y(e))*s},u=function(e){var i=r.stdform[0]+r.stdform[1]*t.X(e)+r.stdform[2]*t.Y(e);return i*i},g=(t.maxX()-t.minX())/50,b=t.minX(),x=1e-4,v=NaN,y=0;y<50&&(c=n.root(h,[Math.max(b,t.minX()),Math.min(b+g,t.maxX())]),!((C=Math.abs(h(c)))<=x&&(x=C,v=c,x<_)));y++)b+=g;return c=v,C=u(c=n.root(u,[Math.max(c-g,t.minX()),Math.min(c+g,t.maxX())])),m=isNaN(C)||Math.abs(C)>w?0:1,new i(e.COORDS_BY_USER,[m,t.X(c),t.Y(c)],a)},meetCurveLineContinuousOld:function(r,o,a,l){var c,h,u,d,p,f,m,g,b,y,v,x=10*s.eps;if(t.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),d=function(t){var e=o.stdform[0]+o.stdform[1]*r.X(t)+o.stdform[2]*r.Y(t);return e*e},this.meetCurveLineContinuous.t1memo?c=n.root(d,g=this.meetCurveLineContinuous.t1memo):(g=r.minX(),b=r.maxX(),c=n.root(d,[g,b])),this.meetCurveLineContinuous.t1memo=c,y=r.X(c),v=r.Y(c),1===a){if(this.meetCurveLineContinuous.t2memo&&(g=this.meetCurveLineContinuous.t2memo),h=n.root(d,g),!(Math.abs(h-c)>.1&&Math.abs(y-r.X(h))>.1&&Math.abs(v-r.Y(h))>.1))for(m=(r.maxX()-r.minX())/20,f=r.minX(),u=0;u<20&&(h=n.root(d,[f,f+m]),!(Math.abs(d(h))<=x&&Math.abs(h-c)>.1&&Math.abs(y-r.X(h))>.1&&Math.abs(v-r.Y(h))>.1));u++)f+=m;this.meetCurveLineContinuous.t2memo=c=h}return p=Math.abs(d(c))>x?NaN:1,new i(e.COORDS_BY_USER,[p,r.X(c),r.Y(c)],l)},meetCurveLineDiscrete:function(t,n,o,a,l){var c,h,u,d,p,f,m,g=n.point1.coords.usrCoords,b=n.point2.coords.usrCoords,y=0,v=t.numberPoints,x=r.evaluate(n.visProp.straightfirst),C=r.evaluate(n.visProp.straightlast);for(f=new i(e.COORDS_BY_USER,[0,NaN,NaN],a),0===g[0]?g=[1,b[1]+n.stdform[2],b[2]-n.stdform[1]]:0===b[0]&&(b=[1,g[1]+n.stdform[2],g[2]-n.stdform[1]]),d=t.points[0].usrCoords,c=1;c<v;c++)if(u=d.slice(0),this.distance(u,d=t.points[c].usrCoords)>s.eps)for(3===t.bezierDegree?(m=this.meetBeziersegmentBeziersegment([t.points[c-1].usrCoords.slice(1),t.points[c].usrCoords.slice(1),t.points[c+1].usrCoords.slice(1),t.points[c+2].usrCoords.slice(1)],[g.slice(1),b.slice(1)],l),c+=2):m=[this.meetSegmentSegment(u,d,g,b)],h=0;h<m.length;h++)if(0<=(p=m[h])[1]&&p[1]<=1){if(y===o)return l&&(!x&&p[2]<0||!C&&p[2]>1)?f:f=new i(e.COORDS_BY_USER,p[0],a);y+=1}return f},meetCurveRedBlueSegments:function(t,e,i){var s,n,r,o,a,l,c,h,u,d=0,p=e.numberPoints,f=t.numberPoints;if(p<=1||f<=1)return[0,NaN,NaN];for(s=1;s<f;s++)for(r=t.points[s-1].usrCoords,o=t.points[s].usrCoords,h=Math.min(r[1],o[1]),u=Math.max(r[1],o[1]),l=e.points[0].usrCoords,n=1;n<p;n++)if(a=l,l=e.points[n].usrCoords,Math.min(a[1],l[1])<u&&Math.max(a[1],l[1])>h&&(c=this.meetSegmentSegment(r,o,a,l))[1]>=0&&c[2]>=0&&(c[1]<1&&c[2]<1||s===f-1&&1===c[1]||n===p-1&&1===c[2])){if(d===i)return c[0];d++}return[0,NaN,NaN]},meetSegmentSegment:function(t,e,i,n){var r,o=s.crossProduct(t,e),a=s.crossProduct(i,n),l=s.crossProduct(o,a),c=l[0];return Math.abs(c)<s.eps?[l,1/0,1/0]:[l,((r=[i[1]-t[1],i[2]-t[2]])[0]*(n[2]-i[2])-r[1]*(n[1]-i[1]))/c,(r[0]*(e[2]-t[2])-r[1]*(e[1]-t[1]))/c]},_bezierSplit:function(t){var e,i,s,n,r,o;return[[t[0],e=[.5*(t[0][0]+t[1][0]),.5*(t[0][1]+t[1][1])],n=[.5*(e[0]+(i=[.5*(t[1][0]+t[2][0]),.5*(t[1][1]+t[2][1])])[0]),.5*(e[1]+i[1])],o=[.5*(n[0]+(r=[.5*(i[0]+(s=[.5*(t[2][0]+t[3][0]),.5*(t[2][1]+t[3][1])])[0]),.5*(i[1]+s[1])])[0]),.5*(n[1]+r[1])]],[o,r,s,t[3]]]},_bezierBbox:function(t){var e=[];return 4===t.length?(e[0]=Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),e[1]=Math.max(t[0][1],t[1][1],t[2][1],t[3][1]),e[2]=Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),e[3]=Math.min(t[0][1],t[1][1],t[2][1],t[3][1])):(e[0]=Math.min(t[0][0],t[1][0]),e[1]=Math.max(t[0][1],t[1][1]),e[2]=Math.max(t[0][0],t[1][0]),e[3]=Math.min(t[0][1],t[1][1])),e},_bezierOverlap:function(t,e){return t[2]>=e[0]&&t[0]<=e[2]&&t[1]>=e[3]&&t[3]<=e[1]},_bezierListConcat:function(t,e,i,s){var n,o=r.exists(s),a=0,l=e.length,c=t.length;for(c>0&&l>0&&(1===t[c-1][1]&&0===e[0][1]||o&&1===t[c-1][2]&&0===e[0][2])&&(a=1),n=a;n<l;n++)o&&(e[n][2]*=.5,e[n][2]+=s),e[n][1]*=.5,e[n][1]+=i,t.push(e[n])},_bezierMeetSubdivision:function(t,e,i){var s,n,r,o,a,l,c,h,u,d,p,f,m=[];return n=this._bezierBbox(e),s=this._bezierBbox(t),this._bezierOverlap(n,s)?i<5?(l=(r=this._bezierSplit(t))[0],c=r[1],a=(r=this._bezierSplit(e))[1],this._bezierListConcat(m,this._bezierMeetSubdivision(l,o=r[0],i+1),0,0),this._bezierListConcat(m,this._bezierMeetSubdivision(l,a,i+1),0,.5),this._bezierListConcat(m,this._bezierMeetSubdivision(c,o,i+1),.5,0),this._bezierListConcat(m,this._bezierMeetSubdivision(c,a,i+1),.5,.5),m):(p=[1].concat(t[0]),f=[1].concat(t[3]),u=[1].concat(e[0]),d=[1].concat(e[3]),(h=this.meetSegmentSegment(p,f,u,d))[1]>=0&&h[2]>=0&&h[1]<=1&&h[2]<=1?[h]:[]):[]},_bezierLineMeetSubdivision:function(t,e,i,s){var n,r,o,a,l,c,h,u,d,p=[];return n=this._bezierBbox(e),r=this._bezierBbox(t),s&&!this._bezierOverlap(r,n)?[]:i<5?(a=(o=this._bezierSplit(t))[1],this._bezierListConcat(p,this._bezierLineMeetSubdivision(o[0],e,i+1),0),this._bezierListConcat(p,this._bezierLineMeetSubdivision(a,e,i+1),.5),p):(u=[1].concat(t[0]),d=[1].concat(t[3]),c=[1].concat(e[0]),h=[1].concat(e[1]),(l=this.meetSegmentSegment(u,d,c,h))[1]>=0&&l[1]<=1&&(!s||l[2]>=0&&l[2]<=1)?[l]:[])},meetBeziersegmentBeziersegment:function(t,e,i){var s,n,r;for((s=4===t.length&&4===e.length?this._bezierMeetSubdivision(t,e,0):this._bezierLineMeetSubdivision(t,e,0,i)).sort((function(t,e){return 1e7*(t[1]-e[1])+(t[2]-e[2])})),n=[],r=0;r<s.length;r++)0!==r&&s[r][1]===s[r-1][1]&&s[r][2]===s[r-1][2]||n.push(s[r]);return n},meetBezierCurveRedBlueSegments:function(t,e,i){var s,n,r,o,a,l,c,h=e.numberPoints,u=t.numberPoints,d=[];if(h<4||u<4)return[0,NaN,NaN];for(n=0;n<u-3;n+=3)for(l=this._bezierBbox(o=[[(s=t.points)[n].usrCoords[1],s[n].usrCoords[2]],[s[n+1].usrCoords[1],s[n+1].usrCoords[2]],[s[n+2].usrCoords[1],s[n+2].usrCoords[2]],[s[n+3].usrCoords[1],s[n+3].usrCoords[2]]]),r=0;r<h-3;r+=3)if(c=this._bezierBbox(a=[[(s=e.points)[r].usrCoords[1],s[r].usrCoords[2]],[s[r+1].usrCoords[1],s[r+1].usrCoords[2]],[s[r+2].usrCoords[1],s[r+2].usrCoords[2]],[s[r+3].usrCoords[1],s[r+3].usrCoords[2]]]),this._bezierOverlap(l,c)&&(d=d.concat(this.meetBeziersegmentBeziersegment(o,a))).length>i)return d[i][0];return d.length>i?d[i][0]:[0,NaN,NaN]},bezierSegmentEval:function(t,e){var i,s,n,r=1-t;return s=0,n=0,s+=(i=r*r*r)*e[0][0],n+=i*e[0][1],s+=(i=3*t*r*r)*e[1][0],n+=i*e[1][1],s+=(i=3*t*t*r)*e[2][0],n+=i*e[2][1],[1,s+=(i=t*t*t)*e[3][0],n+=i*e[3][1]]},bezierArc:function(t,e,i,n,r){var o,a,l,c,h,u,d,p,f,m,g,b,y,v,x,C,_=.5*Math.PI,w=e[1],S=e[2],P=e[0],k=[],E=[];for(h=this.distance(e,t),w/=P,S/=P,u=this.rad(t.slice(1),e.slice(1),i.slice(1)),-1===r&&(u=2*Math.PI-u),(o=t)[1]/=o[0],o[2]/=o[0],o[0]/=o[0],c=o.slice(0),n?(k=[w,w+.333*(o[1]-w),w+.666*(o[1]-w),o[1]],E=[S,S+.333*(o[2]-S),S+.666*(o[2]-S),o[2]]):(k=[o[1]],E=[o[2]]);u>s.eps;)u>_?(d=_,u-=_):(d=u,u=0),p=Math.cos(r*d),f=Math.sin(r*d),x=s.matVecMult([[1,0,0],[w*(1-p)+S*f,p,-f],[S*(1-p)-w*f,f,p]],o),m=o[1]-w,g=o[2]-S,b=(c=[x[0]/x[0],x[1]/x[0],x[2]/x[0]])[1]-w,y=c[2]-S,C=Math.sqrt((m+b)*(m+b)+(g+y)*(g+y)),v=Math.abs(y-g)>s.eps?(m+b)*(h/C-.5)/(y-g)*8/3:(g+y)*(h/C-.5)/(m-b)*8/3,k=k.concat([(a=[1,o[1]-v*g,o[2]+v*m])[1],(l=[1,c[1]+v*y,c[2]-v*b])[1],c[1]]),E=E.concat([a[2],l[2],c[2]]),o=c.slice(0);return n&&(k=k.concat([c[1]+.333*(w-c[1]),c[1]+.666*(w-c[1]),w]),E=E.concat([c[2]+.333*(S-c[2]),c[2]+.666*(S-c[2]),S])),[k,E]},projectPointToCircle:function(t,n,o){var a,l,c,h=n.center.coords.usrCoords;return r.exists(o)||(o=t.board),r.isPoint(t)?(a=t.coords.distance(e.COORDS_BY_USER,n.center.coords),l=t.coords.usrCoords):(a=t.distance(e.COORDS_BY_USER,n.center.coords),l=t.usrCoords),Math.abs(a)<s.eps&&(a=s.eps),c=n.Radius()/a,new i(e.COORDS_BY_USER,[h[1]+c*(l[1]-h[1]),h[2]+c*(l[2]-h[2])],o)},projectPointToLine:function(t,n,o){var a=[0,n.stdform[1],n.stdform[2]];return r.exists(o)||(o=t.board),a=s.crossProduct(a,t.coords.usrCoords),new i(e.COORDS_BY_USER,s.crossProduct(a,n.stdform),o)},projectCoordsToSegment:function(t,e,i){var n,r=[i[1]-e[1],i[2]-e[2]],o=[t[1]-e[1],t[2]-e[2]];return Math.abs(r[0])<s.eps&&Math.abs(r[1])<s.eps?[e,0]:(n=s.innerProduct(o,r),[[1,(n/=s.innerProduct(r,r))*r[0]+e[1],n*r[1]+e[2]],n])},projectCoordsToBeziersegment:function(e,i,s){var n;return n=t.Math.Numerics.fminbr((function(t){var n=[1,i.X(s+t),i.Y(s+t)];return n[1]-=e[1],n[2]-=e[2],n[1]*n[1]+n[2]*n[2]}),[0,1]),[[1,i.X(n+s),i.Y(n+s)],n]},projectPointToCurve:function(t,e,i){r.exists(i)||(i=t.board);var s=t.X(),n=t.Y(),o=this.projectCoordsToCurve(s,n,t.position||0,e,i);return t.position=o[1],o[0]},projectCoordsToCurve:function(t,s,o,a,l){var c,h,u,d,p,f,m,g,b,y,v,x,C,_,w,S,P,k,E,T,A=Number.POSITIVE_INFINITY;if(r.exists(l)||(l=a.board),"plot"===r.evaluate(a.visProp.curvetype)){if(o=0,p=A,c=0===a.numberPoints?[0,1,1]:[a.Z(0),a.X(0),a.Y(0)],a.numberPoints>1)for(g=[1,t,s],3===a.bezierDegree?d=0:v=[a.Z(0),a.X(0),a.Y(0)],u=0;u<a.numberPoints-1;u++)3===a.bezierDegree?C=this.projectCoordsToBeziersegment(g,a,d):(x=[a.Z(u+1),a.X(u+1),a.Y(u+1)],C=this.projectCoordsToSegment(g,v,x)),b=C[0],0<=(m=C[1])&&m<=1?(f=this.distance(b,g),y=u+m):m<0?(b=v,f=this.distance(v,g),y=u):m>1&&u===a.numberPoints-2&&(f=this.distance(b=x,g),y=a.numberPoints-1),f<p&&(p=f,o=y,c=b),3===a.bezierDegree?(d++,u+=2):v=x;h=new i(e.COORDS_BY_USER,c,l)}else{for(P=(_=function(e){var i,n;return e<a.minX()||e>a.maxX()?NaN:(i=t-a.X(e))*i+(n=s-a.Y(e))*n})(o),k=(a.maxX()-a.minX())/50,w=a.minX(),u=0;u<50;u++)((S=_(w))<P||isNaN(P))&&(o=w,P=S),w+=k;o=n.fminbr(_,[o-k,o+k]),E=a.minX(),T=a.maxX(),h=new i(e.COORDS_BY_USER,[a.X(o=(o=o<E?E:o)>T?T:o),a.Y(o)],l)}return[a.updateTransform(h),o]},projectCoordsToPolygon:function(e,i){var s,n,r,o,a=i.vertices.length,l=1/0;for(s=0;s<a;s++)r=t.Math.Geometry.projectCoordsToSegment(e,i.vertices[s].coords.usrCoords,i.vertices[(s+1)%a].coords.usrCoords),n=t.Math.Geometry.distance(r[0],e,3),0<=r[1]&&r[1]<=1&&n<l&&(o=r[0].slice(0),l=n);return o},projectPointToTurtle:function(t,s,n){var o,a,l,c,h,u,d,p,f=0,m=0,g=Number.POSITIVE_INFINITY,b=s.objects.length;for(r.exists(n)||(n=t.board),h=0;h<b;h++)(d=s.objects[h]).elementClass===e.OBJECT_CLASS_CURVE&&(o=this.projectPointToCurve(t,d),(u=this.distance(o.usrCoords,t.coords.usrCoords))<g&&(l=o.usrCoords[1],c=o.usrCoords[2],a=t.position,g=u,p=d,m=f),f+=d.numberPoints);return o=new i(e.COORDS_BY_USER,[l,c],n),t.position=a+m,p.updateTransform(o)},projectPointToPoint:function(t,e){return e.coords},projectPointToBoard:function(t,e){var i,n,r,o=e||t.board,a=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],l=t.coords||t,c=o.getBoundingBox();for(i=0;i<4;i++)(r=a[i])[0]*l.usrCoords[r[1]]<r[0]*c[r[2]]&&((n=s.crossProduct([1,c[r[3]],c[r[4]]],[1,c[r[5]],c[r[6]]]))[3]=0,n=s.normalize(n),l=this.projectPointToLine({coords:l},{stdform:n},o));return l},distPointLine:function(t,e){var i,n=e[1],r=e[2],o=e[0];return Math.abs(n)+Math.abs(r)<s.eps?Number.POSITIVE_INFINITY:(i=n*t[1]+r*t[2]+o,n*=n,r*=r,Math.abs(i)/Math.sqrt(n+r))},reuleauxPolygon:function(t,e){var i,n=2*Math.PI,r=n/e,o=(e-1)/2,a=0,l=function(l,c){return function(h,u){var d=(h%n+n)%n,p=Math.floor(d/r)%e;return u||(a=t[0].Dist(t[o]),i=s.Geometry.rad([t[0].X()+1,t[0].Y()],t[0],t[o%e])),isNaN(p)?p:(d=.5*d+p*r*.5+i,t[p][l]()+a*Math[c](d))}};return[l("X","cos"),l("Y","sin"),0,n]}}),s.Geometry})),define("utils/zip",["jxg"],(function(t){"use strict";var e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];return t.Util=t.Util||{},t.Util.Unzip=function(a){function l(){return N<M?a[N++]:-1}function c(){L=1}function h(){var t;try{return t=1&L,0==(L>>=1)&&(t=1&(L=l()),L=L>>1|128),t}catch(t){throw t}}function u(t){var i=0,s=t;try{for(;s--;)i=i<<1|h();t&&(i=e[i]>>8-t)}catch(t){throw t}return i}function d(){A=0}function p(t){T[A++]=t,P.push(String.fromCharCode(t)),32768===A&&(A=0)}function f(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function m(){for(;;){if(F[B]>=w)return-1;if(_[F[B]]===B)return F[B]++;F[B]++}}function g(t,e,i,s){var n;for(I=t,R=0,_=i,w=e,n=0;n<17;n++)F[n]=0;return B=0,function t(){var e,i=I[R];if(17===B)return-1;if(R++,B++,(e=m())>=0)i.b0=e;else if(i.b0=32768,t())return-1;if((e=m())>=0)i.b1=e,i.jump=null;else if(i.b1=32768,i.jump=I[R],i.jumppos=R,t())return-1;return B--,0}()?-1:0}function b(t){for(var e,i,s=0,n=t[s];;)if(h()){if(!(32768&n.b1))return n.b1;for(n=n.jump,e=t.length,i=0;i<e;i++)if(t[i]===n){s=i;break}}else{if(!(32768&n.b0))return n.b0;n=t[++s]}}function y(){var a,m,y,v,x,C,_,w,S,P,k,E,O,M,N;do{if(a=h(),0===(m=u(2)))for(c(),S=l(),S|=l()<<8,k=l(),65535&(S^~(k|=l()<<8))&&t.debug("BlockLen checksum mismatch\n");S--;)p(l());else if(1===m)for(;;)if((v=e[u(7)]>>1)>23?(v=v<<1|h())>199?v=(v-=128)<<1|h():(v-=48)>143&&(v+=136):v+=256,v<256)p(v);else{if(256===v)break;for(w=u(s[v-=257])+i[v],v=e[u(5)]>>3,r[v]>8?(P=u(8),P|=u(r[v]-8)<<8):P=u(r[v]),P+=n[v],v=0;v<w;v++)p(T[A-P&32767])}else if(2===m){for(C=new Array(320),O=257+u(5),M=1+u(5),N=4+u(4),v=0;v<19;v++)C[v]=0;for(v=0;v<N;v++)C[o[v]]=u(3);for(w=j.length,y=0;y<w;y++)j[y]=new f;if(g(j,19,C))return d(),1;for(E=O+M,y=0;y<E;)if((v=b(j))<16)C[y++]=v;else if(16===v){if(y+(v=3+u(2))>E)return d(),1;for(x=y?C[y-1]:0;v--;)C[y++]=x}else{if(y+(v=17===v?3+u(3):11+u(7))>E)return d(),1;for(;v--;)C[y++]=0}for(w=D.length,y=0;y<w;y++)D[y]=new f;if(g(D,O,C))return d(),1;for(w=D.length,y=0;y<w;y++)j[y]=new f;for(_=[],y=O;y<C.length;y++)_[y-O]=C[y];if(g(j,M,_))return d(),1;for(;;)if((v=b(D))>=256){if(0==(v-=256))break;for(w=u(s[v-=1])+i[v],v=b(j),r[v]>8?(P=u(8),P|=u(r[v]-8)<<8):P=u(r[v]),P+=n[v];w--;)p(T[A-P&32767])}else p(v)}}while(!a);return d(),c(),0}function v(){var t,e,i,s,n,r=[];try{if(P=[],O=!1,r[0]=l(),r[1]=l(),120===r[0]&&218===r[1]&&(y(),E[k]=[P.join(""),"geonext.gxt"],k++),31===r[0]&&139===r[1]&&(S(),E[k]=[P.join(""),"file"],k++),80===r[0]&&75===r[1]&&(O=!0,r[2]=l(),r[3]=l(),3===r[2]&&4===r[3])){for(r[0]=l(),r[1]=l(),x=l(),x|=l()<<8,n=l(),n|=l()<<8,l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),l(),s=l(),s|=l()<<8,i=l(),i|=l()<<8,t=0,Y=[];s--;)"/"===(e=l())|":"===e?t=0:t<255&&(Y[t++]=String.fromCharCode(e));for(C||(C=Y),t=0;t<i;)e=l(),t++;8===n&&(y(),E[k]=new Array(2),E[k][0]=P.join(""),E[k][1]=Y.join(""),k++),S()}}catch(t){throw t}}var x,C,_,w,S,P=[],k=0,E=[],T=new Array(32768),A=0,O=!1,M=a.length,N=0,L=1,D=new Array(288),j=new Array(32),R=0,I=null,B=(new Array(64),new Array(64),0),F=new Array(17),Y=[];F[0]=0,S=function(){var t,e,i=[];if(8&x&&(i[0]=l(),i[1]=l(),i[2]=l(),i[3]=l(),80===i[0]&&75===i[1]&&7===i[2]&&8===i[3]&&(l(),l(),l(),l()),l(),l(),l(),l(),l(),l(),l(),l()),O&&v(),i[0]=l(),8===i[0]){if(x=l(),l(),l(),l(),l(),l(),l(),4&x)for(i[0]=l(),i[2]=l(),B=i[0]+256*i[1],t=0;t<B;t++)l();if(8&x)for(t=0,Y=[],e=l();e;)"7"!==e&&":"!==e||(t=0),t<255&&(Y[t++]=e),e=l();if(16&x)for(e=l();e;)e=l();2&x&&(l(),l()),y(),l(),l(),l(),l(),l(),l(),l(),l(),O&&v()}},t.Util.Unzip.prototype.unzipFile=function(t){var e;for(this.unzip(),e=0;e<E.length;e++)if(E[e][1]===t)return E[e][0];return""},t.Util.Unzip.prototype.unzip=function(){return v(),E}},t.Util})),define("utils/encoding",["jxg"],(function(t){"use strict";var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return t.Util=t.Util||{},t.Util.UTF8={encode:function(t){var e,i,s="",n=t.length;if(t=t.replace(/\r\n/g,"\n"),"function"==typeof unescape&&"function"==typeof encodeURIComponent)return unescape(encodeURIComponent(t));for(e=0;e<n;e++)(i=t.charCodeAt(e))<128?s+=String.fromCharCode(i):i>127&&i<2048?(s+=String.fromCharCode(i>>6|192),s+=String.fromCharCode(63&i|128)):(s+=String.fromCharCode(i>>12|224),s+=String.fromCharCode(i>>6&63|128),s+=String.fromCharCode(63&i|128));return s},decode:function(t){var i,s,n,r=0,o=0,a=0,l=[],c=t.length,h=[];for(i=0;i<c;i++)s=t.charCodeAt(i),n=e[s],o=0!==a?63&s|o<<6:255>>n&s,0===(a=e[256+a+n])&&(o>65535?l.push(55232+(o>>10),56320+(1023&o)):l.push(o),++r%1e4==0&&(h.push(String.fromCharCode.apply(null,l)),l=[]));return h.push(String.fromCharCode.apply(null,l)),h.join("")},asciiCharCodeAt:function(t,e){var i=t.charCodeAt(e);if(i>255)switch(i){case 8364:i=128;break;case 8218:i=130;break;case 402:i=131;break;case 8222:i=132;break;case 8230:i=133;break;case 8224:i=134;break;case 8225:i=135;break;case 710:i=136;break;case 8240:i=137;break;case 352:i=138;break;case 8249:i=139;break;case 338:i=140;break;case 381:i=142;break;case 8216:i=145;break;case 8217:i=146;break;case 8220:i=147;break;case 8221:i=148;break;case 8226:i=149;break;case 8211:i=150;break;case 8212:i=151;break;case 732:i=152;break;case 8482:i=153;break;case 353:i=154;break;case 8250:i=155;break;case 339:i=156;break;case 382:i=158;break;case 376:i=159}return i}},t.Util.UTF8})),define("utils/base64",["jxg","utils/encoding"],(function(t,e){"use strict";function i(t,e){return 255&t.charCodeAt(e)}function s(t,e){return n.indexOf(t.charAt(e))}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t.Util=t.Util||{},t.Util.Base64={encode:function(t){var s,r,o,a,l,c=[];for(a=(o=(l=e.encode(t)).length)%3,s=0;s<o-a;s+=3)r=i(l,s)<<16|i(l,s+1)<<8|i(l,s+2),c.push(n.charAt(r>>18),n.charAt(r>>12&63),n.charAt(r>>6&63),n.charAt(63&r));switch(a){case 1:r=i(l,o-1),c.push(n.charAt(r>>2),n.charAt(r<<4&63),"=","=");break;case 2:r=i(l,o-2)<<8|i(l,o-1),c.push(n.charAt(r>>10),n.charAt(r>>4&63),n.charAt(r<<2&63),"=")}return c.join("")},decode:function(t,i){var n,r,o,a,l,c,h=[],u=[];if((o=(n=t.replace(/[^A-Za-z0-9\+\/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for("="===n.charAt(o-1)&&(a=1,"="===n.charAt(o-2)&&(a=2),o-=4),r=0;r<o;r+=4)l=s(n,r)<<18|s(n,r+1)<<12|s(n,r+2)<<6|s(n,r+3),u.push(l>>16,l>>8&255,255&l),r%1e4==0&&(h.push(String.fromCharCode.apply(null,u)),u=[]);switch(a){case 1:l=s(n,o)<<12|s(n,o+1)<<6|s(n,o+2),u.push(l>>10,l>>2&255);break;case 2:l=s(n,r)<<6|s(n,r+1),u.push(l>>4)}return h.push(String.fromCharCode.apply(null,u)),c=h.join(""),i&&(c=e.decode(c)),c},decodeAsArray:function(t){var e,i=this.decode(t),s=[],n=i.length;for(e=0;e<n;e++)s[e]=i.charCodeAt(e);return s}},t.Util.Base64})),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],(function(t,e,i,s){"use strict";return t.Server={modules:{},runningCalls:{},handleError:function(e){t.debug("error occured, server says: "+e.message)},callServer:function(n,r,o,a){var l,c,h,u,d,p;for(p in a=a||!1,o)o.hasOwnProperty(p)&&(escape(p),escape(o[p]));d=s.toJSON(o);do{u=n+Math.floor(4096*Math.random())}while(s.exists(this.runningCalls[u]));return this.runningCalls[u]={action:n},s.exists(o.module)&&(this.runningCalls[u].module=o.module),l=t.serverBase+"JXGServer.py",c="action="+escape(n)+"&id="+u+"&dataJSON="+escape(i.encode(d)),this.cbp=function(t){var n,o,a,l,c,h,u,d;if(n=new e.Unzip(i.decodeAsArray(t)).unzip(),s.isArray(n)&&n.length>0&&(n=n[0][0]),s.exists(n))if("error"===(o=window.JSON&&window.JSON.parse?window.JSON.parse(n):new Function("return "+n)()).type)this.handleError(o);else if("response"===o.type){for(h=o.id,u=0;u<o.fields.length;u++)l=(a=o.fields[u]).namespace+("object"==typeof new Function("return "+a.namespace)()?".":".prototype.")+a.name+" = "+a.value,new Function(l)();for(u=0;u<o.handler.length;u++){for(a=o.handler[u],c=[],d=0;d<a.parameters.length;d++)c[d]='"'+a.parameters[d]+'": '+a.parameters[d];l="if(typeof JXG.Server.modules."+this.runningCalls[h].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[h].module+" = {};",l+="JXG.Server.modules."+this.runningCalls[h].module+"."+a.name+"_cb = "+a.callback+";",l+="JXG.Server.modules."+this.runningCalls[h].module+"."+a.name+" = function ("+a.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[h].module+"."+a.name+"_cb;var __JXGSERVER_PAR__ = {"+c.join(",")+', "module": "'+this.runningCalls[h].module+'", "handler": "'+a.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(l)()}delete this.runningCalls[h],r(o.data)}},this.cb=t.bind(this.cbp,this),window.XMLHttpRequest?(h=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):h=new ActiveXObject("Microsoft.XMLHTTP"),!(!h||(h.open("POST",l,!a),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a||(h.onreadystatechange=function(t){return function(){return 4===h.readyState&&200===h.status&&(t(h.responseText),!0)}}(this.cb)),h.send(c),!a)||(this.cb(h.responseText),0))},loadModule_cb:function(e){var i;for(i=0;i<e.length;i++)t.debug(e[i].name+": "+e[i].value)},loadModule:function(e){return t.Server.callServer("load",t.Server.loadModule_cb,{module:e},!0)}},t.Server.load=t.Server.loadModule,t.Server})),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],(function(t,e,i,s,n,r){"use strict";return i.Symbolic={generateSymbolicCoordinatesPartial:function(t,e,i,s){var n,o,a,l=e.ancestors,c=0,h=function(t){return"underscore"===s?i+"_{"+t+"}":"brace"===s?i+"["+t+"]":i+t};for(o in t.listOfFreePoints=[],t.listOfDependantPoints=[],l)if(l.hasOwnProperty(o)&&(n=0,r.isPoint(l[o]))){for(a in l[o].ancestors)l[o].ancestors.hasOwnProperty(a)&&n++;0===n?(l[o].symbolic.x=l[o].coords.usrCoords[1],l[o].symbolic.y=l[o].coords.usrCoords[2],t.listOfFreePoints.push(l[o])):(l[o].symbolic.x=h(c+=1),l[o].symbolic.y=h(c+=1),t.listOfDependantPoints.push(l[o]))}return r.isPoint(e)&&(e.symbolic.x="x",e.symbolic.y="y"),c},clearSymbolicCoordinates:function(t){var e=function(t){var e,i=t&&t.length||0;for(e=0;e<i;e++)r.isPoint(t[e])&&(t[e].symbolic.x="",t[e].symbolic.y="")};e(t.listOfFreePoints),e(t.listOfDependantPoints),delete t.listOfFreePoints,delete t.listOfDependantPoints},generatePolynomials:function(t,e,i){var s,n,o,a,l=e.ancestors,c=[],h=[];for(s in i&&this.generateSymbolicCoordinatesPartial(t,e,"u","brace"),l[e.id]=e,l)if(l.hasOwnProperty(s)&&(a=0,c=[],r.isPoint(l[s]))){for(n in l[s].ancestors)l[s].ancestors.hasOwnProperty(n)&&a++;if(a>0)for(c=l[s].generatePolynomial(),o=0;o<c.length;o++)h.push(c[o])}return i&&this.clearSymbolicCoordinates(t),h},geometricLocusByGroebnerBase:function(o,a){var l,c,h,u,d,p,f,m,g,b,y,v,x=o.options.locus,C={},_=this.generateSymbolicCoordinatesPartial(o,a,"u","brace"),w=new e(t.COORDS_BY_USR,[0,0],o),S=new e(t.COORDS_BY_USR,[o.canvasWidth,o.canvasHeight],o),P=1,k=0,E=0,T=0;if(void 0===n.modules.geoloci&&n.loadModule("geoloci"),void 0===n.modules.geoloci)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(p=w.usrCoords[1],f=S.usrCoords[1],m=S.usrCoords[2],g=w.usrCoords[2],x.translateToOrigin&&o.listOfFreePoints.length>0){for(k=(h=null!=x.toOrigin&&r.isInArray(o.listOfFreePoints,x.toOrigin.id)?x.toOrigin:o.listOfFreePoints[0]).symbolic.x,E=h.symbolic.y,d=0;d<o.listOfFreePoints.length;d++)o.listOfFreePoints[d].symbolic.x-=k,o.listOfFreePoints[d].symbolic.y-=E;if(p-=k,f-=k,m-=E,g-=E,x.translateTo10&&o.listOfFreePoints.length>1){for(u=null!=x.to10&&x.to10.id!==x.toOrigin.id&&r.isInArray(o.listOfFreePoints,x.to10.id)?x.to10:o.listOfFreePoints[0].id===h.id?o.listOfFreePoints[1]:o.listOfFreePoints[0],T=s.rad([1,0],[0,0],[u.symbolic.x,u.symbolic.y]),b=Math.cos(-T),y=Math.sin(-T),d=0;d<o.listOfFreePoints.length;d++)v=o.listOfFreePoints[d].symbolic.x,o.listOfFreePoints[d].symbolic.x=b*o.listOfFreePoints[d].symbolic.x-y*o.listOfFreePoints[d].symbolic.y,o.listOfFreePoints[d].symbolic.y=y*v+b*o.listOfFreePoints[d].symbolic.y;if(u.symbolic.y=0,v=p,p=b*p-y*m,m=y*v+b*m,v=f,f=b*f-y*g,g=y*v+b*g,x.stretch&&Math.abs(u.symbolic.x)>i.eps){for(P=u.symbolic.x,d=0;d<o.listOfFreePoints.length;d++)o.listOfFreePoints[d].symbolic.x/=P,o.listOfFreePoints[d].symbolic.y/=P;for(d=0;d<o.objectsList.length;d++)o.objectsList[d].elementClass===t.OBJECT_CLASS_CIRCLE&&"pointRadius"===o.objectsList[d].method&&(C[d]=o.objectsList[d].radius,o.objectsList[d].radius/=P);p/=P,f/=P,m/=P,g/=P,u.symbolic.x=1}}for(d=0;d<o.listOfFreePoints.length;d++)v=o.listOfFreePoints[d].symbolic.x,Math.abs(v)<i.eps&&(o.listOfFreePoints[d].symbolic.x=0),Math.abs(v-Math.round(v))<i.eps&&(o.listOfFreePoints[d].symbolic.x=Math.round(v)),v=o.listOfFreePoints[d].symbolic.y,Math.abs(v)<i.eps&&(o.listOfFreePoints[d].symbolic.y=0),Math.abs(v-Math.round(v))<i.eps&&(o.listOfFreePoints[d].symbolic.y=Math.round(v))}for(d in l=this.generatePolynomials(o,a).join(","),this.cbp=function(t){c=t},this.cb=r.bind(this.cbp,this),n.modules.geoloci.lociCoCoA(p,f,m,g,_,l,P,T,k,E,this.cb,!0),this.clearSymbolicCoordinates(o),C)C.hasOwnProperty(d)&&(o.objects[d].radius=C[d]);return c}},i.Symbolic})),define("math/poly",["jxg","math/math","utils/type"],(function(t,e,i){"use strict";return e.Poly={},e.Poly.Ring=function(t){this.vars=t},t.extend(e.Poly.Ring.prototype,{}),e.Poly.Monomial=function(t,e,s){var n;if(!i.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(i.isArray(s)||(s=[]),n=(s=s.slice(0,t.vars.length)).length;n<t.vars.length;n++)s.push(0);this.ring=t,this.coefficient=e||0,this.exponents=i.deepCopy(s)},t.extend(e.Poly.Monomial.prototype,{copy:function(){return new e.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var t,e=[];for(t=0;t<this.ring.vars.length;t++)e.push(this.ring.vars[t]+"^"+this.exponents[t]);return this.coefficient+"*"+e.join("*")}}),e.Poly.Polynomial=function(t,e){var s;if(!i.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");s=i.exists(e)&&i.isString(e)?void 0:[],this.ring=t,this.monomials=s},t.extend(e.Poly.Polynomial.prototype,{findSignature:function(t){var e;for(e=0;e<this.monomials.length;e++)if(i.cmpArrays(this.monomials[e].exponents,t))return e;return-1},addSubMonomial:function(t,e){var i;(i=this.findSignature(t.exponents))>-1?this.monomials[i].coefficient+=e*t.coefficient:(t.coefficient*=e,this.monomials.push(t))},add:function(t){var e;if(!i.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(i.isArray(t.exponents))this.addSubMonomial(t,1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],1)},sub:function(t){var e;if(!i.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(i.isArray(t.exponents))this.addSubMonomial(t,-1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],-1)},copy:function(){var t,i;for(i=new e.Poly.Polynomial(this.ring),t=0;t<this.monomials.length;t++)i.monomials.push(this.monomials[t].copy());return i},print:function(){var t,e=[];for(t=0;t<this.monomials.length;t++)e.push("("+this.monomials[t].print()+")");return e.join("+")}}),e.Poly})),define("math/complex",["jxg","utils/type"],(function(t,e){"use strict";return t.Complex=function(t,e){this.isComplex=!0,t&&t.isComplex&&(e=t.imaginary,t=t.real),this.real=t||0,this.imaginary=e||0,this.absval=0,this.angle=0},t.extend(t.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(t){return e.isNumber(t)?this.real+=t:(this.real+=t.real,this.imaginary+=t.imaginary),this},sub:function(t){return e.isNumber(t)?this.real-=t:(this.real-=t.real,this.imaginary-=t.imaginary),this},mult:function(t){var i,s;return e.isNumber(t)?(this.real*=t,this.imaginary*=t):(this.real=(i=this.real)*t.real-(s=this.imaginary)*t.imaginary,this.imaginary=i*t.imaginary+s*t.real),this},div:function(t){var i,s,n;if(e.isNumber(t)){if(Math.abs(t)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=t,this.imaginary/=t}else{if(Math.abs(t.real)<Math.eps&&Math.abs(t.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real=((n=this.real)*t.real+(s=this.imaginary)*t.imaginary)/(i=t.real*t.real+t.imaginary*t.imaginary),this.imaginary=(s*t.real-n*t.imaginary)/i}return this},conj:function(){return this.imaginary*=-1,this}}),t.C={},t.C.add=function(e,i){var s=new t.Complex(e);return s.add(i),s},t.C.sub=function(e,i){var s=new t.Complex(e);return s.sub(i),s},t.C.mult=function(e,i){var s=new t.Complex(e);return s.mult(i),s},t.C.div=function(e,i){var s=new t.Complex(e);return s.div(i),s},t.C.conj=function(e){var i=new t.Complex(e);return i.conj(),i},t.C.abs=function(e){var i=new t.Complex(e);return i.conj(),i.mult(e),Math.sqrt(i.real)},t.Complex.C=t.C,t.Complex})),define("utils/color",["jxg","utils/type","math/math"],(function(t,e,i){"use strict";var s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},n=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}];return t.rgbParser=function(t,i,r){var o,a,l,c,h,u,d,p,f,m=t;if(!e.exists(t))return[];if(e.exists(i)&&e.exists(r)&&(m=[t,i,r]),f=!1,e.isArray(o=m)){for(h=0;h<3;h++)f=f||/\./.test(m[h].toString());for(h=0;h<3;h++)f=f&&m[h]>=0&&m[h]<=1;return f?[Math.ceil(255*m[0]),Math.ceil(255*m[1]),Math.ceil(255*m[2])]:m}for("string"==typeof m&&(o=m),"#"===o.charAt(0)&&(o=o.substr(1,6)),o=o.replace(/ /g,"").toLowerCase(),o=s[o]||o,h=0;h<n.length;h++)l=n[h].process,(c=n[h].re.exec(o))&&(u=(a=l(c))[0],d=a[1],p=a[2]);return isNaN(u)||isNaN(d)||isNaN(p)?[]:[u=u<0||isNaN(u)?0:u>255?255:u,d=d<0||isNaN(d)?0:d>255?255:d,p=p<0||isNaN(p)?0:p>255?255:p]},t.rgb2css=function(e,i,s){var n;return"rgb("+(n=t.rgbParser(e,i,s))[0]+", "+n[1]+", "+n[2]+")"},t.rgb2hex=function(e,i,s){var n,r,o;return r=(n=t.rgbParser(e,i,s))[1],o=n[2],n=(n=n[0]).toString(16),r=r.toString(16),o=o.toString(16),1===n.length&&(n="0"+n),1===r.length&&(r="0"+r),1===o.length&&(o="0"+o),"#"+n+r+o},t.hex2rgb=function(e){return t.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),t.rgb2css(e)},t.hsv2rgb=function(t,e,s){var n,r,o,a,l,c,h,u,d;if(t=(t%360+360)%360,0===e){if(!(isNaN(t)||t<i.eps))return"#ffffff";n=s,r=s,o=s}else switch(c=t>=360?0:t,c/=60,l=Math.floor(c),a=c-l,h=s*(1-e),u=s*(1-e*a),d=s*(1-e*(1-a)),l){case 0:n=s,r=d,o=h;break;case 1:n=u,r=s,o=h;break;case 2:n=h,r=s,o=d;break;case 3:n=h,r=u,o=s;break;case 4:n=d,r=h,o=s;break;case 5:n=s,r=h,o=u}return["#",n=2===(n=Math.round(255*n).toString(16)).length?n:1===n.length?"0"+n:"00",r=2===(r=Math.round(255*r).toString(16)).length?r:1===r.length?"0"+r:"00",o=2===(o=Math.round(255*o).toString(16)).length?o:1===o.length?"0"+o:"00"].join("")},t.rgb2hsv=function(e,i,s){var n,r,o,a,l,c,h,u,d,p,f,m,g;return r=(n=t.rgbParser(e,i,s))[1],o=n[2],a=(n=n[0])/255,l=r/255,c=o/255,m=Math.max(n,r,o),u=(g=Math.min(n,r,o))/255,p=0,(f=h=m/255)>0&&(p=(f-u)/f),d=1/(h-u),p>0&&(m===n?d*=l-c:d=m===r?2+(c-a)*d:4+(a-l)*d),(d*=60)<0&&(d+=360),m===g&&(d=0),[d,p,f]},t.rgb2LMS=function(e,i,s){var n,r,o,a,l,c,h,u=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return r=(n=t.rgbParser(e,i,s))[1],o=n[2],n=n[0],n=Math.pow(n,.476190476),r=Math.pow(r,.476190476),o=Math.pow(o,.476190476),(h=[a=n*u[0][0]+r*u[0][1]+o*u[0][2],l=n*u[1][0]+r*u[1][1]+o*u[1][2],c=n*u[2][0]+r*u[2][1]+o*u[2][2]]).l=a,h.m=l,h.s=c,h},t.LMS2rgb=function(t,e,i){var s,n,r,o,a=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],l=function(t){for(var e=127,i=64;i>0;){if(Math.pow(e,.476190476)>t)e-=i;else{if(Math.pow(e+1,.476190476)>t)return e;e+=i}i/=2}return 254===e&&13.994955247<t?255:e};return n=t*a[1][0]+e*a[1][1]+i*a[1][2],r=t*a[2][0]+e*a[2][1]+i*a[2][2],(o=[s=l(s=t*a[0][0]+e*a[0][1]+i*a[0][2]),n=l(n),r=l(r)]).r=s,o.g=n,o.b=r,o},t.rgba2rgbo=function(t){var e;return 9===t.length&&"#"===t.charAt(0)?(e=parseInt(t.substr(7,2).toUpperCase(),16)/255,t=t.substr(0,7)):e=1,[t,e]},t.rgbo2rgba=function(t,e){var i;return"none"===t?t:(1===(i=Math.round(255*e).toString(16)).length&&(i="0"+i),t+i)},t.rgb2bw=function(e){var i,s,n,r="0123456789ABCDEF";return"none"===e?e:(n=t.rgbParser(e),i=Math.floor(.3*n[0]+.59*n[1]+.11*n[2]),e="#"+(s=r.charAt(i>>4&15)+r.charAt(15&i))+s+s)},t.rgb2cb=function(e,i){var s,n,r,o,a,l,c,h,u,d,p,f="0123456789ABCDEF";if("none"===e)return e;switch(n=(a=t.rgb2LMS(e))[0],r=a[1],o=a[2],i=i.toLowerCase()){case"protanopia":l=-.06150039994295001,c=.08277001656812001,h=-.013200141220000003,u=.05858939668799999,d=-.07934519995360001,p=.013289415272000003,n=o/r<.6903216543277437?-(c*r+h*o)/l:-(d*r+p*o)/u;break;case"tritanopia":l=-.00058973116217,c=.007690316482,h=-.01011703519052,u=.025495080838999994,d=-.0422740347,p=.017005316784,o=r/n<.8349489908460004?-(l*n+c*r)/h:-(u*n+d*r)/p;break;default:l=-.06150039994295001,c=.08277001656812001,h=-.013200141220000003,u=.05858939668799999,d=-.07934519995360001,p=.013289415272000003,r=o/n<.5763833686400911?-(l*n+h*o)/c:-(u*n+p*o)/d}return s=t.LMS2rgb(n,r,o),e="#"+(f.charAt(s[0]>>4&15)+f.charAt(15&s[0])),(e+=f.charAt(s[1]>>4&15)+f.charAt(15&s[1]))+(f.charAt(s[2]>>4&15)+f.charAt(15&s[2]))},t.autoHighlight=function(e){var i=t.rgba2rgbo(e),s=i[0],n=i[1];return"#"===e.charAt(0)?t.rgbo2rgba(s,n*=n<.3?1.8:.4):e},t})),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],(function(t,e,i,s,n){"use strict";return t.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"â",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},t.Validator=function(){var e,s=function(t){return n.isString(t)},r=function(t){return Math.abs(t-Math.round(t))<i.eps},o=function(t){return r(t)&&t>0},a=function(t){return t>0},l=function(t){return t>=0},c={},h={attractorDistance:l,color:s,defaultDistance:n.isNumber,display:function(t){return"html"===t||"internal"===t},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(e){return n.exists(t.normalizePointFace(e))},factor:n.isNumber,fillColor:s,fillOpacity:n.isNumber,firstArrow:!1,fontSize:r,dash:r,gridX:n.isNumber,gridY:n.isNumber,hasGrid:!1,highlightFillColor:s,highlightFillOpacity:n.isNumber,highlightStrokeColor:s,highlightStrokeOpacity:n.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:r,minorHeight:r,minorTicks:l,minTicksDistance:o,numberPointsHigh:o,numberPointsLow:o,opacity:n.isNumber,radius:n.isNumber,RDPsmoothing:!1,renderer:function(t){return"vml"===t||"svg"===t||"canvas"===t||"no"===t},right:function(t){return/^[0-9]+px$/.test(t)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:r,snapSizeX:a,snapSizeY:a,snapWidth:n.isNumber,snapToGrid:!1,snatchDistance:l,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:s,strokeOpacity:n.isNumber,strokeWidth:r,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(e in h)h.hasOwnProperty(e)&&(c[e.toLowerCase()]=h[e]);return c}(),t.normalizePointFace=function(t){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[t]},t.useStandardOptions=function(i){var s,n,r,o,a=t.Options,l=i.hasGrid;for(s in i.options.grid.hasGrid=a.grid.hasGrid,i.options.grid.gridX=a.grid.gridX,i.options.grid.gridY=a.grid.gridY,i.options.grid.gridColor=a.grid.gridColor,i.options.grid.gridOpacity=a.grid.gridOpacity,i.options.grid.gridDash=a.grid.gridDash,i.options.grid.snapToGrid=a.grid.snapToGrid,i.options.grid.snapSizeX=a.grid.SnapSizeX,i.options.grid.snapSizeY=a.grid.SnapSizeY,i.takeSizeFromFile=a.takeSizeFromFile,o=function(t,e){t.visProp.fillcolor=e.fillColor,t.visProp.highlightfillcolor=e.highlightFillColor,t.visProp.strokecolor=e.strokeColor,t.visProp.highlightstrokecolor=e.highlightStrokeColor},i.objects)if(i.objects.hasOwnProperty(s))if((r=i.objects[s]).elementClass===e.OBJECT_CLASS_POINT)o(r,a.point);else if(r.elementClass===e.OBJECT_CLASS_LINE)for(o(r,a.line),n=0;n<r.ticks.length;n++)r.ticks[n].majorTicks=a.line.ticks.majorTicks,r.ticks[n].minTicksDistance=a.line.ticks.minTicksDistance,r.ticks[n].visProp.minorheight=a.line.ticks.minorHeight,r.ticks[n].visProp.majorheight=a.line.ticks.majorHeight;else r.elementClass===e.OBJECT_CLASS_CIRCLE?o(r,a.circle):r.type===e.OBJECT_TYPE_ANGLE?o(r,a.angle):r.type===e.OBJECT_TYPE_ARC?o(r,a.arc):r.type===e.OBJECT_TYPE_POLYGON?o(r,a.polygon):r.type===e.OBJECT_TYPE_CONIC?o(r,a.conic):r.type===e.OBJECT_TYPE_CURVE?o(r,a.curve):r.type===e.OBJECT_TYPE_SECTOR&&(r.arc.visProp.fillcolor=a.sector.fillColor,r.arc.visProp.highlightfillcolor=a.sector.highlightFillColor,r.arc.visProp.fillopacity=a.sector.fillOpacity,r.arc.visProp.highlightfillopacity=a.sector.highlightFillOpacity);i.fullUpdate(),l&&!i.hasGrid?i.removeGrids(i):!l&&i.hasGrid&&i.create("grid",[])},t.useBlackWhiteOptions=function(e){var i=t.Options;i.point.fillColor=s.rgb2bw(i.point.fillColor),i.point.highlightFillColor=s.rgb2bw(i.point.highlightFillColor),i.point.strokeColor=s.rgb2bw(i.point.strokeColor),i.point.highlightStrokeColor=s.rgb2bw(i.point.highlightStrokeColor),i.line.fillColor=s.rgb2bw(i.line.fillColor),i.line.highlightFillColor=s.rgb2bw(i.line.highlightFillColor),i.line.strokeColor=s.rgb2bw(i.line.strokeColor),i.line.highlightStrokeColor=s.rgb2bw(i.line.highlightStrokeColor),i.circle.fillColor=s.rgb2bw(i.circle.fillColor),i.circle.highlightFillColor=s.rgb2bw(i.circle.highlightFillColor),i.circle.strokeColor=s.rgb2bw(i.circle.strokeColor),i.circle.highlightStrokeColor=s.rgb2bw(i.circle.highlightStrokeColor),i.arc.fillColor=s.rgb2bw(i.arc.fillColor),i.arc.highlightFillColor=s.rgb2bw(i.arc.highlightFillColor),i.arc.strokeColor=s.rgb2bw(i.arc.strokeColor),i.arc.highlightStrokeColor=s.rgb2bw(i.arc.highlightStrokeColor),i.polygon.fillColor=s.rgb2bw(i.polygon.fillColor),i.polygon.highlightFillColor=s.rgb2bw(i.polygon.highlightFillColor),i.sector.fillColor=s.rgb2bw(i.sector.fillColor),i.sector.highlightFillColor=s.rgb2bw(i.sector.highlightFillColor),i.curve.strokeColor=s.rgb2bw(i.curve.strokeColor),i.grid.gridColor=s.rgb2bw(i.grid.gridColor),t.useStandardOptions(e)},t.Options.normalizePointFace=t.normalizePointFace,t.Options})),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],(function(t,e,i,s,n,r,o,a){"use strict";return t.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},t.extend(t.AbstractRenderer.prototype,{_updateVisual:function(t,e,i){(i||this.enhancedRendering)&&(e=e||{},this.setObjectTransition(t),o.evaluate(t.visProp.draft)?this.setDraft(t):(e.stroke||(t.highlighted?(this.setObjectStrokeColor(t,t.visProp.highlightstrokecolor,t.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(t,t.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))),e.fill||(t.highlighted?this.setObjectFillColor(t,t.visProp.highlightfillcolor,t.visProp.highlightfillopacity):this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity)),e.dash||this.setDashStyle(t,t.visProp),e.shadow||this.setShadow(t),e.gradient||this.setShadow(t)))},drawPoint:function(t){var i,s=e.normalizePointFace(o.evaluate(t.visProp.face));t.rendNode=this.appendChildPrim(this.createPrim(i="o"===s?"ellipse":"[]"===s?"rect":"path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,i),this._updateVisual(t,{dash:!0,shadow:!0},!0),this.updatePoint(t)},updatePoint:function(t){var i,s=o.evaluate(t.visProp.size),n=e.normalizePointFace(o.evaluate(t.visProp.face)),r=o.evaluate(t.visProp.sizeunit),a=o.evaluate(t.visProp.zoom);isNaN(t.coords.scrCoords[2]+t.coords.scrCoords[1])||("user"===r&&(s*=Math.sqrt(t.board.unitX*t.board.unitY)),i=0==(s*=t.board&&a?Math.sqrt(t.board.zoomX*t.board.zoomY):1)?0:s+1,"o"===n?this.updateEllipsePrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2],i,i):"[]"===n?this.updateRectPrim(t.rendNode,t.coords.scrCoords[1]-s,t.coords.scrCoords[2]-s,2*s,2*s):this.updatePathPrim(t.rendNode,this.updatePathStringPoint(t,s,n),t.board),this._updateVisual(t,{dash:!1,shadow:!1}),this.setShadow(t))},changePointStyle:function(t){var e=this.getElementById(t.id);o.exists(e)&&this.remove(e),this.drawPoint(t),o.clearVisPropOld(t),t.visPropCalc.visible||this.hide(t),o.evaluate(t.visProp.draft)&&this.setDraft(t)},drawLine:function(t){t.rendNode=this.appendChildPrim(this.createPrim("line",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"lines"),this.updateLine(t)},updateLineEndings:function(t,e){var n,a,l=new i(s.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),c=new i(s.COORDS_BY_USER,t.point2.coords.usrCoords,t.board);return a=o.evaluate(t.visProp.margin),r.calcStraight(t,l,c,a),n=this.getPositionArrowHead(t,l,c,e),this.updateLinePrim(t.rendNode,n.c1.scrCoords[1]+n.d1x,n.c1.scrCoords[2]+n.d1y,n.c2.scrCoords[1]-n.d2x,n.c2.scrCoords[2]-n.d2y,t.board),n},updateArrowSize:function(t,e){var i,s,n;return(s=o.evaluate(t.visProp.firstarrow))&&(i=o.exists(s.size)?o.evaluate(s.size):3,this._setArrowWidth(t.rendNodeTriangleStart,e.sFirst,t.rendNode,i)),(n=o.evaluate(t.visProp.lastarrow))&&(i=o.exists(n.size)?o.evaluate(n.size):3,this._setArrowWidth(t.rendNodeTriangleEnd,e.sLast,t.rendNode,i)),this},updateLine:function(t){var e;e=this.updateLineEndings(t,o.evaluate(t.visProp.strokewidth)),this.makeArrows(t),this._updateVisual(t),this.updateArrowSize(t,e),this.setLineCap(t)},getPositionArrowHead:function(t,e,r,a){var l,c,h,u,d,p,f,m,g,b,y,v=n.eps,x=0,C=0,_=o.evaluate(t.visProp.firstarrow),w=o.evaluate(t.visProp.lastarrow);return d=p=f=m=0,(_||w)&&(l=(c=o.evaluate(t.point1.visProp.size)+o.evaluate(t.point1.visProp.strokewidth))+(h=o.evaluate(t.point2.visProp.size)+o.evaluate(t.point2.visProp.strokewidth)),w&&o.evaluate(t.visProp.touchlastpoint)&&(u=e.distance(s.COORDS_BY_SCREEN,r))>l&&(r=new i(s.COORDS_BY_SCREEN,[r.scrCoords[1]-(f=(r.scrCoords[1]-e.scrCoords[1])*h/u),r.scrCoords[2]-(m=(r.scrCoords[2]-e.scrCoords[2])*h/u)],t.board)),_&&o.evaluate(t.visProp.touchfirstpoint)&&(u=e.distance(s.COORDS_BY_SCREEN,r))>l&&(e=new i(s.COORDS_BY_SCREEN,[e.scrCoords[1]+(d=(r.scrCoords[1]-e.scrCoords[1])*c/u),e.scrCoords[2]+(p=(r.scrCoords[2]-e.scrCoords[2])*c/u)],t.board)),d=p=f=m=0,u=e.distance(s.COORDS_BY_SCREEN,r),o.exists(_.type)&&(g=o.evaluate(_.type)),o.exists(w.type)&&(b=o.evaluate(w.type)),_&&(x=a*(y=o.exists(_.size)?o.evaluate(_.size):3),2===g?(x*=.5,v+=a*y):3===g?(x=a,v+=a):v+=a*y),w&&(C=a*(y=o.exists(w.size)?o.evaluate(w.size):3),2===b?(C*=.5,v+=a*y):3===b?(C=a,v+=a):v+=a*y),_&&"vml"!==t.board.renderer.type&&(u>=v?(d=(r.scrCoords[1]-e.scrCoords[1])*x/u,p=(r.scrCoords[2]-e.scrCoords[2])*x/u):x=0),w&&"vml"!==t.board.renderer.type&&(u>=v?(f=(r.scrCoords[1]-e.scrCoords[1])*C/u,m=(r.scrCoords[2]-e.scrCoords[2])*C/u):C=0)),{c1:e,c2:r,d1x:d,d1y:p,d2x:f,d2y:m,sFirst:x,sLast:C}},setLineCap:function(t){},drawTicks:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path")},updateTicks:function(t){},drawCurve:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path"),t.numberPoints>1&&this.makeArrows(t),this._updateVisual(t,{shadow:!0},!0),this.updateCurve(t)},updateCurve:function(t){var e,i,s,n=o.evaluate(t.visProp.strokewidth);o.evaluate(t.visProp.handdrawing)?this.updatePathPrim(t.rendNode,this.updatePathStringBezierPrim(t),t.board):this.updatePathPrim(t.rendNode,this.updatePathStringPrim(t),t.board),t.numberPoints>1&&(this.makeArrows(t),(i=o.evaluate(t.visProp.firstarrow))&&(e=o.exists(i.size)?o.evaluate(i.size):3,this._setArrowWidth(t.rendNodeTriangleStart,n,t.rendNode,e)),(s=o.evaluate(t.visProp.lastarrow))&&(e=o.exists(s.size)?o.evaluate(s.size):3,this._setArrowWidth(t.rendNodeTriangleEnd,n,t.rendNode,e))),this._updateVisual(t)},drawEllipse:function(t){t.rendNode=this.appendChildPrim(this.createPrim("ellipse",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"ellipse"),this.updateEllipse(t)},updateEllipse:function(t){this._updateVisual(t);var e=t.Radius();e>0&&Math.abs(t.center.coords.usrCoords[0])>n.eps&&!isNaN(e+t.center.coords.scrCoords[1]+t.center.coords.scrCoords[2])&&e*t.board.unitX<2e6&&this.updateEllipsePrim(t.rendNode,t.center.coords.scrCoords[1],t.center.coords.scrCoords[2],e*t.board.unitX,e*t.board.unitY)},drawPolygon:function(t){t.rendNode=this.appendChildPrim(this.createPrim("polygon",t.id),o.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"polygon"),this.updatePolygon(t)},updatePolygon:function(t){this._updateVisual(t,{stroke:!0,dash:!0}),this.updatePolygonPrim(t.rendNode,t)},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){var e,i,s;"html"===o.evaluate(t.visProp.display)&&a.isBrowser&&"no"!==this.type?((e=this.container.ownerDocument.createElement("div")).style.position="absolute",e.className=o.evaluate(t.visProp.cssclass),s=o.evaluate(t.visProp.layer),o.exists(s)||(s=0),i=""===this.container.style.zIndex?0:parseInt(this.container.style.zIndex,10),e.style.zIndex=i+s,this.container.appendChild(e),e.setAttribute("id",this.container.id+"_"+t.id)):e=this.drawInternalText(t),t.rendNode=e,t.htmlStr="",this.updateText(t)},updateText:function(e){var i,s,n,r,a,l=e.plaintext;if(e.visPropCalc.visible)if(this.updateTextStyle(e,!1),"html"===o.evaluate(e.visProp.display)&&"no"!==this.type){if(isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(s=e.coords.scrCoords[1],s=Math.abs(s)<1e6?s:1e6,i="right"===(r=e.getAnchorX())?Math.floor(e.board.canvasWidth-s):"middle"===r?Math.floor(s-.5*e.size[0]):Math.floor(s),e.visPropOld.left!==r+i&&("right"===r?(e.rendNode.style.right=i+"px",e.rendNode.style.left="auto"):(e.rendNode.style.left=i+"px",e.rendNode.style.right="auto"),e.visPropOld.left=r+i),s=e.coords.scrCoords[2]+this.vOffsetText,s=Math.abs(s)<1e6?s:1e6,i="bottom"===(a=e.getAnchorY())?Math.floor(e.board.canvasHeight-s):"middle"===a?Math.floor(s-.5*e.size[1]):Math.floor(s),e.visPropOld.top!==a+i&&("bottom"===a?(e.rendNode.style.top="auto",e.rendNode.style.bottom=i+"px"):(e.rendNode.style.bottom="auto",e.rendNode.style.top=i+"px"),e.visPropOld.top=a+i)),e.htmlStr!==l){try{e.rendNode.innerHTML=l}catch(t){n=e.rendNode.parentNode,e.rendNode.parentNode.removeChild(e.rendNode),e.rendNode.innerHTML=l,n.appendChild(e.rendNode)}if(e.htmlStr=l,o.evaluate(e.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,e.rendNode])}catch(e){t.debug("MathJax (not yet) loaded")}else if(o.evaluate(e.visProp.useasciimathml))try{AMprocessNode(e.rendNode,!1)}catch(e){t.debug("AsciiMathML (not yet) loaded")}}this.transformImage(e,e.transformations)}else this.updateInternalText(e)},_css2js:function(t){var e,i,s,n,r,a=[],l=o.trim(t).replace(/;$/,"").split(";");for(i=l.length,e=0;e<i;++e)""!==o.trim(l[e])&&(r=l[e].split(":"),s=o.trim(r[0].replace(/-([a-z])/gi,(function(t,e){return e.toUpperCase()}))),n=o.trim(r[1]),a.push({key:s,val:n}));return a},updateTextStyle:function(t,e){var i,s,n,r,l,c,h,u,d,p=t.visProp,f=a.isBrowser?p.display:"internal",m=["rendNode","rendNodeTag","rendNodeLabel"],g=m.length,b=["cssdefaultstyle","cssstyle"],y=b.length;if(e?(n=p.highlightstrokecolor,s=p.highlightstrokeopacity,r=p.highlightcssclass):(n=p.strokecolor,s=p.strokeopacity,r=p.cssclass),"no"!==this.type&&("html"===f||"canvas"!==this.type)){for(u=0;u<y;u++)if(""!==(d=o.evaluate(p[(e?"highlight":"")+b[u]]))&&t.visPropOld[b[u]]!==d){for(c=this._css2js(d),l=0;l<g;l++)if(o.exists(t[m[l]]))for(h in c)c.hasOwnProperty(h)&&(t[m[l]].style[c[h].key]=c[h].val);t.visPropOld[b[u]]=d}if(i=o.evaluate(p.fontsize),t.visPropOld.fontsize!==i){t.needsSizeUpdate=!0;try{for(l=0;l<g;l++)o.exists(t[m[l]])&&(t[m[l]].style.fontSize=i+"px")}catch(e){for(l=0;l<g;l++)o.exists(t[m[l]])&&(t[m[l]].style.fontSize=i)}t.visPropOld.fontsize=i}}return this.setObjectTransition(t),"html"===f&&"no"!==this.type?(t.visPropOld.cssclass!==r&&(t.rendNode.className=r,t.visPropOld.cssclass=r,t.needsSizeUpdate=!0),this.setObjectStrokeColor(t,n,s)):this.updateInternalTextStyle(t,n,s),this},updateInternalTextStyle:function(t,e,i){this.setObjectStrokeColor(t,e,i)},drawImage:function(t){},updateImage:function(t){this.updateRectPrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),this.updateImageURL(t),this.transformImage(t,t.transformations),this._updateVisual(t,{stroke:!0,dash:!0},!0)},joinTransforms:function(t,e){var i,s=t.board.origin.scrCoords[1],r=t.board.origin.scrCoords[2],o=t.board.unitX,a=t.board.unitY,l=e.length,c=[[1,0,0],[-s/o,1/o,0],[r/a,0,-1/a]];for(i=0;i<l;i++)c=n.matMatMult(e[i].matrix,c);return n.matMatMult([[1,0,0],[s,o,0],[r,0,-a]],c)},transformImage:function(t,e){},updateImageURL:function(t){},updateImageStyle:function(t,e){t.rendNode.className=o.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass)},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t){},_setArrowWidth:function(t,e,i){},updateEllipsePrim:function(t,e,i,s,n){},updateLinePrim:function(t,e,i,s,n,r){},updatePathPrim:function(t,e,i){},updatePathStringPoint:function(t,e,i){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,i,s,n){},setPropertyPrim:function(t,e,i){},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){if(o.evaluate(t.visProp.draft)){var e=t.board.options.elements.draft.color,i=t.board.options.elements.draft.opacity;this.setObjectTransition(t),t.type===s.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,e,i):(t.elementClass===s.OBJECT_CLASS_POINT?this.setObjectFillColor(t,e,i):this.setObjectFillColor(t,"none",0),this.setObjectStrokeColor(t,e,i),this.setObjectStrokeWidth(t,t.board.options.elements.draft.strokeWidth))}},removeDraft:function(t){this.setObjectTransition(t),t.type===s.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity):(t.type===s.OBJECT_CLASS_POINT&&this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity),this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,i){},setObjectStrokeColor:function(t,e,i){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){var e,i,n,r=t.visProp;if(this.setObjectTransition(t),!r.draft){if(t.type===s.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.highlightstrokecolor,t.borders[e].visProp.highlightstrokeopacity);else t.elementClass===s.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!0):t.type===s.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!0),this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity)):(this.setObjectStrokeColor(t,r.highlightstrokecolor,r.highlightstrokeopacity),this.setObjectFillColor(t,r.highlightfillcolor,r.highlightfillopacity));r.highlightstrokewidth&&(i=Math.max(o.evaluate(r.highlightstrokewidth),o.evaluate(r.strokewidth)),this.setObjectStrokeWidth(t,i),t.elementClass===s.OBJECT_CLASS_LINE&&(n=this.updateLineEndings(t,i),this.makeArrows(t),this.updateArrowSize(t,n)))}return this},noHighlight:function(t){var e,i,n,r=t.visProp;if(this.setObjectTransition(t),!o.evaluate(t.visProp.draft)){if(t.type===s.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,r.fillcolor,r.fillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.strokecolor,t.borders[e].visProp.strokeopacity);else t.elementClass===s.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!1):t.type===s.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!1),this.setObjectFillColor(t,r.fillcolor,r.fillopacity)):(this.setObjectStrokeColor(t,r.strokecolor,r.strokeopacity),this.setObjectFillColor(t,r.fillcolor,r.fillopacity));n=o.evaluate(r.strokewidth),this.setObjectStrokeWidth(t,n),t.elementClass===s.OBJECT_CLASS_LINE&&(i=this.updateLineEndings(t,n),this.makeArrows(t),this.updateArrowSize(t,i))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t,e){var i,s,n=function(t){t||(t=window.event),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},r=function(r,l){var c;c=i.createElement("span"),s.appendChild(c),c.appendChild(i.createTextNode(r)),c.style.paddingLeft="7px",c.style.paddingRight="7px",a.addEvent(c,"mouseover",(function(){this.style.backgroundColor=e.highlightfillcolor}),c),a.addEvent(c,"mouseover",(function(){this.style.backgroundColor=e.highlightfillcolor}),c),a.addEvent(c,"mouseout",(function(){this.style.backgroundColor=e.fillcolor}),c),a.addEvent(c,"click",(function(e){return o.bind(l,t)(),!1}),t),a.addEvent(c,"mouseup",n,t),a.addEvent(c,"mousedown",n,t),a.addEvent(c,"touchend",n,t),a.addEvent(c,"touchstart",n,t)};a.isBrowser&&"no"!==this.type&&((s=(i=t.containerObj.ownerDocument).createElement("div")).setAttribute("id",t.containerObj.id+"_navigationbar"),s.style.color=e.strokecolor,s.style.backgroundColor=e.fillcolor,s.style.padding=e.padding,s.style.position=e.position,s.style.fontSize=e.fontsize,s.style.cursor=e.cursor,s.style.zIndex=e.zindex,t.containerObj.appendChild(s),s.style.right=e.right,s.style.bottom=e.bottom,t.attr.showscreenshot&&r(t.attr.screenshot.symbol,(function(){setTimeout((function(){t.renderer.screenshot(t,"",!1)}),330)})),t.attr.showreload&&r("â»",(function(){t.reload()})),t.attr.showcleartraces&&r("â",(function(){t.clearTraces()})),t.attr.shownavigation&&(t.attr.showzoom&&(r("â",t.zoomOut),r("o",t.zoom100),r("+",t.zoomIn)),r("â",t.clickLeftArrow),r("â",t.clickUpArrow),r("â",t.clickDownArrow),r("â",t.clickRightArrow)))},getElementById:function(t){return o.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+t):""},removeToInsertLater:function(t){var e=t.parentNode,i=t.nextSibling;return e.removeChild(t),function(){i?e.insertBefore(t,i):e.appendChild(t)}},resize:function(t,e){},createTouchpoints:function(t){},showTouchpoint:function(t){},hideTouchpoint:function(t){},updateTouchpoint:function(t,e){},dumpToCanvas:function(t){},screenshot:function(t){}}),t.AbstractRenderer})),define("renderer/no",["jxg","renderer/abstract"],(function(t,e){"use strict";return t.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},t.extend(t.NoRenderer.prototype,{drawPoint:function(t){},updatePoint:function(t){},changePointStyle:function(t){},drawLine:function(t){},updateLine:function(t){},drawTicks:function(t){},updateTicks:function(t){},drawCurve:function(t){},updateCurve:function(t){},drawEllipse:function(t){},updateEllipse:function(t){},drawPolygon:function(t){},updatePolygon:function(t){},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){},updateText:function(t){},updateTextStyle:function(t,e){},updateInternalTextStyle:function(t,e,i){},drawImage:function(t){},updateImage:function(t){},transformImage:function(t,e){},updateImageURL:function(t){},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t){},updateEllipsePrim:function(t,e,i,s,n){},updateLinePrim:function(t,e,i,s,n,r){},updatePathPrim:function(t,e,i){},updatePathStringPoint:function(t,e,i){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,i,s,n){},setPropertyPrim:function(t,e,i){},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){},removeDraft:function(t){},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,i){},setObjectStrokeColor:function(t,e,i){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){},noHighlight:function(t){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t){},getElementById:function(t){return null},resize:function(t,e){},removeToInsertLater:function(){return function(){}}}),t.NoRenderer.prototype=new e,t.NoRenderer})),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],(function(t,e,i,s,n){"use strict";return t.FileReader={parseFileContent:function(e,r,o,a,l){var c=!1;i.exists(a)||(a=!0);try{c=new XMLHttpRequest,"raw"===o.toLowerCase()?c.overrideMimeType("text/plain; charset=iso-8859-1"):c.overrideMimeType("text/xml; charset=iso-8859-1")}catch(t){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){c=!1}}}if(c){c.open("GET",e,a),this.cbp="raw"===o.toLowerCase()?function(){4===c.readyState&&r(c.responseText)}:function(){var t=c,e="";4===t.readyState&&(e=!i.exists(t.responseStream)||"PK"!==t.responseText.slice(0,2)&&31!==s.asciiCharCodeAt(t.responseText.slice(0,1),0)?t.responseText:n.decode(jxgBinFileReader(t)),this.parseString(e,r,o,l))},this.cb=i.bind(this.cbp,this),c.onreadystatechange=this.cb;try{c.send(null)}catch(t){throw new Error("JSXGraph: A problem occurred while trying to read '"+e+"'.")}}else t.debug("AJAX not activated!")},parseString:function(e,s,n,r){var o;if(n=n.toLowerCase(),!i.exists(o=t.readers[n]))throw new Error("JSXGraph: There is no reader available for '"+n+"'.");new o(s,e).read(),i.isFunction(r)&&r(s)}},!e.isMetroApp()&&e.isBrowser&&"object"==typeof navigator&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction jxgBinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    jxgBinFileReader = b64String\nEnd Function\n<\/script>\n'),t.FileReader})),define("parser/geonext",["jxg","base/constants","utils/type"],(function(t,e,i){"use strict";return t.GeonextParser={replacePow:function(t){var e,i,s,n,r,o,a,l,c,h,u,d;for(h=(t=t.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),n=-1;h>=0&&h<t.length-1;){if(n===h)throw new Error("JSXGraph: Error while parsing expression '"+t+"'");if(n=h,c=t.slice(0,h),u=t.slice(h+1),")"===c.charAt(c.length-1)){for(e=1,i=c.length-2;i>=0&&e>0;)")"===(s=c.charAt(i))?e++:"("===s&&(e-=1),i-=1;if(0!==e)throw new Error("JSXGraph: Missing '(' in expression");for(r="",a=c.substring(0,i+1),l=i;l>=0&&a.substr(l,1).match(/([\w\.]+)/);)r=RegExp.$1+r,l-=1;r=(r+=c.substring(i+1,c.length)).replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else r="[\\w\\.]+";if(u.match(/^([\w\.]*\()/)){for(e=1,i=RegExp.$1.length;i<u.length&&e>0;)")"===(s=u.charAt(i))?e-=1:"("===s&&(e+=1),i+=1;if(0!==e)throw new Error("JSXGraph: Missing ')' in expression");o=(o=u.substring(0,i)).replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else o="[\\w\\.]+";d=new RegExp("("+r+")\\^("+o+")"),h=(t=t.replace(d,"pow($1,$2)")).indexOf("^")}return t},replaceIf:function(t){var e,i,s,n,r,o,a,l,c,h="",u=null,d=null,p=null;if((s=t.indexOf("If("))<0)return t;for(t=t.replace(/""/g,"0");s>=0;){for(e=t.slice(0,s),i=t.slice(s+3),r=1,n=0,o=-1,a=-1;n<i.length&&r>0;)")"===(l=i.charAt(n))?r-=1:"("===l?r+=1:","===l&&1===r&&(o<0?o=n:a=n),n+=1;if(c=i.slice(0,n-1),i=i.slice(n),o<0)return"";if(a<0)return"";u=c.slice(0,o),d=c.slice(o+1,a),p=c.slice(a+1),h+=e+"(("+(u=this.replaceIf(u))+")?("+(d=this.replaceIf(d))+"):("+(p=this.replaceIf(p))+"))",u=null,d=null,s=(t=i).indexOf("If(")}return h+i},replaceNameById:function(t,e,i){var s,n,r,o,a=0,l=["X","Y","L","V"],c=function(t){return i?"$('"+t+"')":t};for(o=0;o<l.length;o++)for(a=t.indexOf(l[o]+"(");a>=0;)a>=0&&(s=t.indexOf(")",a+2))>=0&&(n=(n=t.slice(a+2,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+2)+(i?"$('":"")+c(r.id)+t.slice(s))),s=t.indexOf(")",a+2),a=t.indexOf(l[o]+"(",s);for(a=t.indexOf("Dist(");a>=0;)a>=0&&(s=t.indexOf(",",a+5))>=0&&(n=(n=t.slice(a+5,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+5)+c(r.id)+t.slice(s))),s=t.indexOf(",",a+5),a=t.indexOf(",",s),(s=t.indexOf(")",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+c(r.id)+t.slice(s))),s=t.indexOf(")",a+1),a=t.indexOf("Dist(",s);for(l=["Deg","Rad"],o=0;o<l.length;o++)for(a=t.indexOf(l[o]+"(");a>=0;)a>=0&&(s=t.indexOf(",",a+4))>=0&&(n=(n=t.slice(a+4,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+4)+c(r.id)+t.slice(s))),s=t.indexOf(",",a+4),a=t.indexOf(",",s),(s=t.indexOf(",",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+c(r.id)+t.slice(s))),s=t.indexOf(",",a+1),a=t.indexOf(",",s),(s=t.indexOf(")",a+1))>=0&&(n=(n=t.slice(a+1,s)).replace(/\\(['"])?/g,"$1"),(r=e.elementsByName[n])&&(t=t.slice(0,a+1)+c(r.id)+t.slice(s))),s=t.indexOf(")",a+1),a=t.indexOf(l[o]+"(",s);return t},replaceIdByObj:function(t){var e;return(t=(t=(t=(t=(t=t.replace(e,"$('$2').$1()")).replace(e=/(V)\(([\w_]+)\)/g,"$('$2').Value()")).replace(/(Dist)\(([\w_]+),([\w_]+)\)/g,"dist($('$2'), $('$3'))")).replace(/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,"deg($('$2'),$('$3'),$('$4'))")).replace(/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,"rad($('$1'),$('$2'),$('$3'))")).replace(/N\((.+)\)/g,"($1)")},geonext2JS:function(t,e){var i,s,n,r=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],o=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),s=this.replaceNameById(s=t,e),s=this.replaceIf(s),s=this.replacePow(s),s=this.replaceIdByObj(s),n=0;n<r.length;n++)i=new RegExp(["(\\W|^)(",r[n],")"].join(""),"ig"),s=s.replace(i,["$1",o[n]].join(""));return(s=(s=(s=(s=s.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(t,s,n){var r,o,a,l;for(o in i.exists(n)||(n=t.board),r=n.elementsByName)r.hasOwnProperty(o)&&o!==t.name&&(r[o].elementClass===e.OBJECT_CLASS_TEXT&&i.evaluate(r[o].visProp.islabel)||(l=(l=o.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),a=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+l+")(,[\\w\\[\\]'_ ]+)*\\)","g"),s.search(a)>=0&&r[o].addChild(t)))},gxt2jc:function(t,e){return t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),this.replaceNameById(t,e,!0).replace(/True/g,"true").replace(/False/g,"false").replace(/fasle/g,"false")}},t.GeonextParser})),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],(function(t,e,i,s,n,r,o,a,l,c){"use strict";return t.GeometryElement=function(t,i,s,n){var r,o,l;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},a.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(o in this.board=t,this.type=s,this._org_type=s,this.elementClass=n||e.OBJECT_CLASS_OTHER,this.id=i.id,c.exists(r=i.name)||(r=this.board.generateName(this)),""!==r&&(this.board.elementsByName[r]=this),this.name=r,this.needsRegularUpdate=i.needsregularupdate,c.clearVisPropOld(this),l=this.resolveShortcuts(i))l.hasOwnProperty(o)&&this._set(o,l[o]);this.visProp.draft=l.draft&&l.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=c.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},t.extend(t.GeometryElement.prototype,{addChild:function(t){var e,i;for(e in this.childElements[t.id]=t,this.addDescendants(t),t.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(e))for(i in this.descendants[e].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(i)&&(this.descendants[e].ancestors[this.ancestors[i].id]=this.ancestors[i]);for(e in this.ancestors)if(this.ancestors.hasOwnProperty(e))for(i in this.descendants)this.descendants.hasOwnProperty(i)&&(this.ancestors[e].descendants[this.descendants[i].id]=this.descendants[i]);return this},addDescendants:function(t){var e;for(e in this.descendants[t.id]=t,t.childElements)t.childElements.hasOwnProperty(e)&&this.addDescendants(t.childElements[e]);return this},addParents:function(t){var e,i,s;for(i=(s=c.isArray(t)?t:arguments).length,e=0;e<i;++e)c.exists(s[e])&&(c.isId(this.board,s[e])?this.parents.push(s[e]):c.exists(s[e].id)&&this.parents.push(s[e].id));this.parents=c.uniqueArray(this.parents)},setParents:function(t){this.parents=[],this.addParents(t)},removeChild:function(t){return delete this.childElements[t.id],this.removeDescendants(t),delete t.ancestors[this.id],this},removeDescendants:function(t){var e;for(e in delete this.descendants[t.id],t.childElements)t.childElements.hasOwnProperty(e)&&this.removeDescendants(t.childElements[e]);return this},countChildren:function(){var t,e,i=0;for(t in e=this.childElements)e.hasOwnProperty(t)&&t.indexOf("Label")<0&&i++;return i},getName:function(){return this.name},addTransform:function(t){return this},draggable:function(){return this.isDraggable&&!c.evaluate(this.visProp.fixed)&&this.type!==e.OBJECT_TYPE_GLIDER},setPosition:function(t,i){var s,n,r,o,a=[];if(!c.exists(this.parents))return this;for(r=this.parents.length,n=0;n<r;++n)if(s=this.board.select(this.parents[n]),c.isPoint(s)){if(!s.draggable())return this;a.push(s)}for(3===i.length&&(i=i.slice(1)),o=this.board.create("transform",i,{type:"translate"}),(r=a.length)>0?o.applyOnce(a):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(o):this.addTransform(o),n=0;n<r;++n)a[n].type===e.OBJECT_TYPE_GLIDER&&a[n].updateGlider();return this},setPositionDirectly:function(t,s,r){var o=new i(t,s,this.board,!1),a=new i(t,r,this.board,!1),l=n.subtract(o.usrCoords,a.usrCoords);return this.setPosition(e.COORDS_BY_USER,l),this},generatePolynomial:function(){return[]},animate:function(t,e,i){i=i||{};var s,n,r,o=Math.ceil(e/this.board.attr.animationdelay),a=this,h=function(t,e,i,s){var n,l;if(t=parseFloat(t),e=parseFloat(e),!isNaN(t)&&!isNaN(e))for(l=(e-t)/o,a.animationData[i]=[],r=0;r<o;r++)n=t+(r+1)*l,a.animationData[i][o-r-1]=s?Math.floor(n):n};for(s in this.animationData={},t)if(t.hasOwnProperty(s))switch(n=s.toLowerCase()){case"strokecolor":case"fillcolor":!function(t,e,i){var s,n,c,h,u;for(s=l.rgb2hsv(t),c=((n=l.rgb2hsv(e))[0]-s[0])/o,h=(n[1]-s[1])/o,u=(n[2]-s[2])/o,a.animationData[i]=[],r=0;r<o;r++)a.animationData[i][o-r-1]=l.hsv2rgb(s[0]+(r+1)*c,s[1]+(r+1)*h,s[2]+(r+1)*u)}(this.visProp[n],t[s],n);break;case"size":if(!c.isPoint(this))break;h(this.visProp[n],t[s],n,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":h(this.visProp[n],t[s],n,!1)}return this.animationCallback=i.callback,this.board.addAnimation(this),this},update:function(){return c.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(t){return this.prepareUpdate().update().updateVisibility(t).updateRenderer()},setDisplayRendNode:function(t){var e,i,s,n,r;if(void 0===t&&(t=this.visPropCalc.visible),t===this.visPropOld.visible)return this;for(this.board.renderer.display(this,t),i=this.inherits.length,s=0;s<i;s++)if(c.isArray(r=this.inherits[s]))for(n=r.length,e=0;e<n;e++)c.exists(r[e])&&c.exists(r[e].rendNode)&&"inherit"===c.evaluate(r[e].visProp.visible)&&r[e].setDisplayRendNode(t);else c.exists(r)&&c.exists(r.rendNode)&&"inherit"===c.evaluate(r.visProp.visible)&&r.setDisplayRendNode(t);return this.hasLabel&&c.exists(this.label)&&c.exists(this.label.rendNode)&&"inherit"===c.evaluate(this.label.visProp.visible)&&this.label.setDisplayRendNode(t),this},hideElement:function(){return t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),c.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),c.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(t){var e,i,s,n,r,o;if(this.needsUpdate){for(void 0!==t?this.visPropCalc.visible=t:(o=c.evaluate(this.visProp.visible),c.exists(this.hiddenByParent)&&this.hiddenByParent&&(o=!1),"inherit"!==o&&(this.visPropCalc.visible=o)),i=this.inherits.length,s=0;s<i;s++)if(c.isArray(r=this.inherits[s]))for(n=r.length,e=0;e<n;e++)c.exists(r[e])&&"inherit"===c.evaluate(r[e].visProp.visible)&&r[e].prepareUpdate().updateVisibility(this.visPropCalc.visible);else c.exists(r)&&"inherit"===c.evaluate(r.visProp.visible)&&r.prepareUpdate().updateVisibility(this.visPropCalc.visible);c.exists(this.label)&&c.exists(this.label.visProp)&&c.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(t,e){t=t.toLocaleLowerCase(),this.visProp.hasOwnProperty(t)&&t.indexOf("color")>=0&&c.isString(e)&&9===e.length&&"#"===e.charAt(0)?(e=l.rgba2rgbo(e),this.visProp[t]=e[0],this.visProp[t.replace("color","opacity")]=e[1]):this.visProp[t]=e},resolveShortcuts:function(t){var e,i;for(e in r.shortcuts)if(r.shortcuts.hasOwnProperty(e)&&c.exists(t[e]))for(i=0;i<r.shortcuts[e].length;i++)c.exists(t[r.shortcuts[e][i]])||(t[r.shortcuts[e][i]]=t[e]);return t},setLabel:function(t){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(t)},setLabelText:function(t){return c.exists(this.label)&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(t)),this},setName:function(t){t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"slider"!==this.elType&&this.setLabelText(t),this.setAttribute({name:t})},setProperty:function(){t.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(i){var s,n,r,o,a,h,u,d,p,f={};for(s=0;s<arguments.length;s++)c.isString(h=arguments[s])?(d=h.split(":"),f[c.trim(d[0])]=c.trim(d[1])):c.isArray(h)?f[h[0]]=h[1]:t.extend(f,h);for(s in f=this.resolveShortcuts(f))if(f.hasOwnProperty(s)){if(o=s.replace(/\s+/g,"").toLowerCase(),p=this.visProp[o],c.isObject(a=f[s])&&c.exists(this.visProp[o])){if(this.visProp[o]=c.merge(this.visProp[o],a),this.type===e.OBJECT_TYPE_TICKS&&c.exists(this.labels))for(r=this.labels.length,n=0;n<r;n++)this.labels[n].setAttribute(a);continue}switch(o){case"name":p=this.name,delete this.board.elementsByName[this.name],this.name=a,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"===a||!1===a),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":u=(a=l.rgba2rgbo(a))[1],a=a[0],0===u&&c.exists(this.label)&&this.hasLabel&&this.label.hideElement(),c.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=a,this.board.renderer.setObjectStrokeColor(this.label,a,u)),this.elementClass===e.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=a,this.visProp.strokeopacity=u,this.board.renderer.setObjectStrokeColor(this,a,u));break;case"infoboxtext":this.infoboxText=!!c.isString(a)&&a;break;case"visible":this.visProp.visible="false"!==a&&("true"===a||a),this.setDisplayRendNode(c.evaluate(this.visProp.visible));break;case"face":c.isPoint(this)&&(this.visProp.face=a,this.board.renderer.changePointStyle(this));break;case"trace":"false"===a||!1===a?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=a,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":a=l.rgba2rgbo(a),this.visProp.gradientsecondcolor=a[0],this.visProp.gradientsecondopacity=a[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=a,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=a,c.evaluate(a)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=a;break;case"radius":this.type!==e.OBJECT_TYPE_ANGLE&&this.type!==e.OBJECT_TYPE_SECTOR||this.setRadius(a);break;case"rotate":(this.elementClass===e.OBJECT_CLASS_TEXT&&"internal"===c.evaluate(this.visProp.display)||this.type===e.OBJECT_TYPE_IMAGE)&&this.addRotation(a);break;case"ticksdistance":this.type===e.OBJECT_TYPE_TICKS&&c.isNumber(a)&&(this.ticksFunction=this.makeTicksFunction(a));break;case"generatelabelvalue":this.type===e.OBJECT_TYPE_TICKS&&c.isFunction(a)&&(this.generateLabelValue=a);break;case"onpolygon":this.type===e.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!a);break;case"disabled":c.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!a);break;case"checked":c.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!a);break;case"maxlength":c.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!a);break;default:c.exists(this.visProp[o])&&(!t.Validator[o]||t.Validator[o]&&t.Validator[o](a)||t.Validator[o]&&c.isFunction(a)&&t.Validator[o](a()))&&(a=(!a.toLowerCase||"false"!==a.toLowerCase())&&a,this._set(o,a))}this.triggerEventHandlers(["attribute:"+o],[p,a,this])}return this.triggerEventHandlers(["attribute"],[f,this]),c.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){t.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(t){var e;switch(t=t.toLowerCase()){case"needsregularupdate":e=this.needsRegularUpdate;break;case"labelcolor":e=this.label.visProp.strokecolor;break;case"infoboxtext":e=this.infoboxText;break;case"withlabel":e=this.hasLabel;break;default:e=this.visProp[t]}return e},setDash:function(t){return this.setAttribute({dash:t}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new i(e.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new i(e.COORDS_BY_USER,[0,0],this.board)},setArrow:function(t,i){return this.visProp.firstarrow=t,this.visProp.lastarrow=i,i&&(this.type=e.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var t=c.evaluate(this.visProp.gradient);"linear"!==t&&"radial"!==t||this.board.renderer.setGradient(this)},createLabel:function(){var e,i=this;return t.elements.text?((e=c.deepCopy(this.visProp.label,null)).id=this.id+"Label",e.isLabel=!0,e.anchor=this,e.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=t.elements.text(this.board,[0,0,function(){return c.isFunction(i.name)?i.name():i.name}],e),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):t.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(t){return t=c.def(t,!1),!c.evaluate(this.visProp.highlight)||this.highlighted&&!t||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var t;for(t in this.traces)this.traces.hasOwnProperty(t)&&this.board.renderer.remove(this.traces[t]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=s.normalize(this.stdform),this},toJSON:function(){var t,e,i=['{"name":',this.name];for(e in i.push(', "id":'+this.id),t=[],this.visProp)this.visProp.hasOwnProperty(e)&&c.exists(this.visProp[e])&&t.push('"'+e+'":'+this.visProp[e]);return i.push(', "visProp":{'+t.toString()+"}"),i.push("}"),i.join("")},addRotation:function(t){var i,s,n,r,o,a=this;return(this.elementClass===e.OBJECT_CLASS_TEXT&&"internal"===c.evaluate(this.visProp.display)||this.type===e.OBJECT_TYPE_IMAGE)&&0!==t&&(i=this.board.create("transform",[function(){return-a.X()},function(){return-a.Y()}],{type:"translate"}),s=this.board.create("transform",[function(){return a.X()},function(){return a.Y()}],{type:"translate"}),n=this.board.create("transform",[function(){return a.board.unitX/a.board.unitY},function(){return 1}],{type:"scale"}),r=this.board.create("transform",[function(){return a.board.unitY/a.board.unitX},function(){return 1}],{type:"scale"}),o=this.board.create("transform",[t*Math.PI/180],{type:"rotate"}),i.bindTo(this),n.bindTo(this),o.bindTo(this),r.bindTo(this),s.bindTo(this)),this},highlightStrokeColor:function(e){return t.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:e}),this},strokeColor:function(e){return t.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:e}),this},strokeWidth:function(e){return t.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:e}),this},fillColor:function(e){return t.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:e}),this},highlightFillColor:function(e){return t.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:e}),this},labelColor:function(e){return t.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:e}),this},dash:function(e){return t.deprecated("dash()","setAttribute()"),this.setAttribute({dash:e}),this},visible:function(e){return t.deprecated("visible()","setAttribute()"),this.setAttribute({visible:e}),this},shadow:function(e){return t.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:e}),this},getType:function(){return this.elType},getParents:function(){return c.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var t,e=c.deepCopy(this.visProp),i=[],s=i.length;for(e.id=this.id,e.name=this.name,t=0;t<s;t++)delete e[i[t]];return e},hasPoint:function(t,e){return!1},handleSnapToGrid:function(t,i){var s,n,r,o,a=c.evaluate(this.visProp.snapsizex),l=c.evaluate(this.visProp.snapsizey);return c.exists(this.coords)?((c.evaluate(this.visProp.snaptogrid)||!0===t)&&(s=this.coords.usrCoords[1],n=this.coords.usrCoords[2],a<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(a=(r=this.board.defaultAxes.x.defaultTicks).ticksDelta*(c.evaluate(r.visProp.minorticks)+1)),l<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(l=(r=this.board.defaultAxes.y.defaultTicks).ticksDelta*(c.evaluate(r.visProp.minorticks)+1)),a>0&&l>0&&(o=this.board.getBoundingBox(),s=Math.round(s/a)*a,n=Math.round(n/l)*l,i||(s<o[0]?s+=a:s>o[2]&&(s-=a),n<o[3]?n+=l:n>o[1]&&(n-=l)),this.coords.setCoordinates(e.COORDS_BY_USER,[s,n]))),this):this},addEvent:t.shortcut(t.GeometryElement.prototype,"on"),removeEvent:t.shortcut(t.GeometryElement.prototype,"off"),__evt__over:function(t){},__evt__mouseover:function(t){},__evt__out:function(t){},__evt__mouseout:function(t){},__evt__move:function(t){},__evt__mousemove:function(t){},__evt__drag:function(t){},__evt__mousedrag:function(t){},__evt__touchdrag:function(t){},__evt__down:function(t){},__evt__mousedown:function(t){},__evt__touchdown:function(t){},__evt__up:function(t){},__evt__mouseup:function(t){},__evt__touchup:function(t){},__evt__attribute:function(t,e){},__evt__attribute_:function(t,e,i){},__evt:function(){}}),t.GeometryElement})),define("base/transformation",["jxg","base/constants","math/math","utils/type"],(function(t,e,i,s){"use strict";return t.Transformation=function(t,i,s){this.elementClass=e.OBJECT_CLASS_OTHER,this.type=e.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=t,this.isNumericMatrix=!1,this.setMatrix(t,i,s),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},t.Transformation.prototype={},t.extend(t.Transformation.prototype,{update:function(){return this},setMatrix:function(t,e,n){var r;for(this.isNumericMatrix=!0,r=0;r<n.length;r++)if("number"!=typeof n[r]){this.isNumericMatrix=!1;break}if("translate"===e){if(2!==n.length)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if("scale"===e){if(2!==n.length)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===e)n.length<4&&(n[0]=t.select(n[0])),2===n.length&&(n[1]=t.select(n[1])),4===n.length&&(this.evalParam=s.createEvalFunction(t,n,4)),this.update=function(){var t,e,s,r,o,a,l,c;1===n.length?l=n[0].stdform:2===n.length?l=i.crossProduct(n[1].coords.usrCoords,n[0].coords.usrCoords):4===n.length&&(l=i.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),r=(c=[-(s=l[0])*(t=l[1]),-s*(e=l[2]),t*t+e*e])[0]/c[2],o=c[1]/c[2],this.matrix[1][1]=((t=-l[2])*t-(e=l[1])*e)/(a=c[2]),this.matrix[1][2]=2*t*e/a,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=r*(1-this.matrix[1][1])-o*this.matrix[1][2],this.matrix[2][0]=o*(1-this.matrix[2][2])-r*this.matrix[2][1]};else if("rotate"===e)3===n.length?this.evalParam=s.createEvalFunction(t,n,3):n.length>0&&n.length<=2&&(this.evalParam=s.createEvalFunction(t,n,1),2!==n.length||s.isArray(n[1])||(n[1]=t.select(n[1]))),this.update=function(){var t,e,i=this.evalParam(0),r=Math.cos(i),o=Math.sin(i);this.matrix[1][1]=r,this.matrix[1][2]=-o,this.matrix[2][1]=o,this.matrix[2][2]=r,n.length>1&&(3===n.length?(t=this.evalParam(1),e=this.evalParam(2)):s.isArray(n[1])?(t=n[1][0],e=n[1][1]):(t=n[1].X(),e=n[1].Y()),this.matrix[1][0]=t*(1-r)+e*o,this.matrix[2][0]=e*(1-r)-t*o)};else if("shear"===e){if(2!==n.length)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=s.createEvalFunction(t,n,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if("generic"===e){if(9!==n.length)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=s.createEvalFunction(t,n,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(t,e){return this.update(),s.exists(e)?i.matVecMult(this.matrix,t.initialCoords.usrCoords):i.matVecMult(this.matrix,t.coords.usrCoords)},applyOnce:function(t){var n,r,o;for(s.isArray(t)||(t=[t]),r=t.length,o=0;o<r;o++)this.update(),n=i.matVecMult(this.matrix,t[o].coords.usrCoords),t[o].coords.setCoordinates(e.COORDS_BY_USER,n)},bindTo:function(t){var e,i;if(s.isArray(t))for(i=t.length,e=0;e<i;e++)t[e].transformations.push(this);else t.transformations.push(this)},setProperty:function(e){t.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(t){},melt:function(t){var e,i,s,n,r,o,a=[];for(i=t.matrix.length,s=this.matrix[0].length,e=0;e<i;e++)a[e]=[];for(this.update(),t.update(),e=0;e<i;e++)for(o=0;o<s;o++){for(r=0,n=0;n<i;n++)r+=t.matrix[e][n]*this.matrix[n][o];a[e][o]=r}return this.update=function(){var t=this.matrix.length,i=this.matrix[0].length;for(e=0;e<t;e++)for(o=0;o<i;o++)this.matrix[e][o]=a[e][o]},this},getParents:function(){var t=[[].concat.apply([],this.matrix)];return 0!==this.parents.length&&(t=this.parents),t}}),t.createTransform=function(e,i,s){return new t.Transformation(e,s.type,i)},t.registerElement("transform",t.createTransform),{Transformation:t.Transformation,createTransform:t.createTransform}})),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],(function(t,e,i,s,n,r,o,a,l,c,h,u){"use strict";return t.CoordsElement=function(t,e){var i;for(h.exists(t)||(t=[1,0,0]),i=0;i<t.length;++i)t[i]=parseFloat(t[i]);this.coords=new o(a.COORDS_BY_USER,t,this.board),this.initialCoords=new o(a.COORDS_BY_USER,t,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=h.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),h.exists(this.element)&&this.addAnchor(t,e),this.isDraggable=!0},t.extend(t.CoordsElement.prototype,{updateCoords:function(t){return this.needsUpdate?(h.exists(t)||(t=!1),this.type===a.OBJECT_TYPE_GLIDER&&(t?this.updateGliderFromParent():this.updateGlider()),h.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var t,e,n,r,l,c,u,d,p,f,m,g,b,y,v,x,C,_=2*Math.PI,w=!1,S=this.slideObject;if(this.needsUpdateFromParent=!1,S.elementClass===a.OBJECT_CLASS_CIRCLE)h.evaluate(this.visProp.isgeonext)&&(_=1),v=s.projectPointToCircle(this,S,this.board),x=s.rad([S.center.X()+1,S.center.Y()],S.center,this)/_;else if(S.elementClass===a.OBJECT_CLASS_LINE){if(this.onPolygon){if(r=(n=S.point2.coords.usrCoords)[t=1]-(e=S.point1.coords.usrCoords)[t],Math.abs(r)<i.eps&&(r=n[t=2]-e[t]),u=s.projectPointToLine(this,S,this.board),c=S.parentPolygon,(d=(u.usrCoords[t]-e[t])/r)<0){for(t=0;t<c.borders.length;t++)if(S===c.borders[t]){S=c.borders[(t-1+c.borders.length)%c.borders.length];break}}else if(d>1)for(t=0;t<c.borders.length;t++)if(S===c.borders[t]){S=c.borders[(t+1+c.borders.length)%c.borders.length];break}S.id!==this.slideObject.id&&(this.slideObject=S)}(r=(e=S.point1.coords).distance(a.COORDS_BY_USER,n=S.point2.coords))<i.eps?(v=e,w=!0,x=0):(v=s.projectPointToLine(this,S,this.board),e=e.usrCoords.slice(0),n=n.usrCoords.slice(0),Math.abs(n[0])<i.eps?(r=n[t=1],Math.abs(r)<i.eps&&(r=n[t=2]),x=((r=(v.usrCoords[t]-e[t])/r)>=0?1:-1)*(r=Math.abs(r))/(r+1)):Math.abs(e[0])<i.eps?(r=e[t=1],Math.abs(r)<i.eps&&(r=e[t=2]),x=(r=(v.usrCoords[t]-n[t])/r)<0?(1-2*r)/(1-r):1/(r+1)):(r=n[t=1]-e[t],Math.abs(r)<i.eps&&(r=n[t=2]-e[t]),x=(v.usrCoords[t]-e[t])/r)),C=h.evaluate(this.visProp.snapwidth),h.evaluate(C)>0&&Math.abs(this._smax-this._smin)>=i.eps&&(l=(x=Math.max(Math.min(x,1),0))*(this._smax-this._smin)+this._smin,x=((l=Math.round(l/C)*C)-this._smin)/(this._smax-this._smin),this.update(!0)),e=S.point1.coords,!h.evaluate(S.visProp.straightfirst)&&Math.abs(e.usrCoords[0])>i.eps&&x<0&&(v=e,w=!0,x=0),n=S.point2.coords,!h.evaluate(S.visProp.straightlast)&&Math.abs(n.usrCoords[0])>i.eps&&x>1&&(v=n,w=!0,x=1)}else S.type===a.OBJECT_TYPE_TURTLE?(this.updateConstraint(),v=s.projectPointToTurtle(this,S,this.board),x=this.position):S.elementClass===a.OBJECT_CLASS_CURVE?S.type===a.OBJECT_TYPE_ARC||S.type===a.OBJECT_TYPE_SECTOR?(v=s.projectPointToCircle(this,S,this.board),m=s.rad(S.radiuspoint,S.center,this),p=0,f=s.rad(S.radiuspoint,S.center,S.anglepoint),x=m,("minor"===(C=h.evaluate(S.visProp.selection))&&f>Math.PI||"major"===C&&f<Math.PI)&&(p=f,f=2*Math.PI),(m<p||m>f)&&(x=f,(m<p&&m>.5*p||m>f&&m>.5*f+Math.PI)&&(x=p),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),_=f-p,this.visProp.isgeonext&&(_=1),Math.abs(_)>i.eps&&(x/=_)):(this.updateConstraint(),S.transformations.length>0?(S.updateTransformMatrix(),y=i.inverse(S.transformMat),b=i.matVecMult(y,this.coords.usrCoords),g=new o(a.COORDS_BY_USER,b,this.board).usrCoords,v=(b=s.projectCoordsToCurve(g[1],g[2],this.position||0,S,this.board))[0],x=b[1]):(v=s.projectPointToCurve(this,S,this.board),x=this.position)):h.isPoint(S)&&(v=s.projectPointToPoint(this,S,this.board),x=this.position);this.coords.setCoordinates(a.COORDS_BY_USER,v.usrCoords,w),this.position=x},updateGliderFromParent:function(){var t,e,n,r,o,l,c,u,d,p=this.slideObject,f=2*Math.PI;this.needsUpdateFromParent?(p.elementClass===a.OBJECT_CLASS_CIRCLE?(n=p.Radius(),h.evaluate(this.visProp.isgeonext)&&(f=1),o=[p.center.X()+n*Math.cos(this.position*f),p.center.Y()+n*Math.sin(this.position*f)]):p.elementClass===a.OBJECT_CLASS_LINE?(e=p.point2.coords.usrCoords,0===(t=p.point1.coords.usrCoords)[0]&&0===t[1]&&0===t[2]||0===e[0]&&0===e[1]&&0===e[2]?o=[0,0,0]:Math.abs(e[0])<i.eps?(r=Math.min(Math.abs(this.position),1-i.eps),r/=1-r,this.position<0&&(r=-r),o=[t[0]+r*e[0],t[1]+r*e[1],t[2]+r*e[2]]):Math.abs(t[0])<i.eps?(r=Math.max(this.position,i.eps),r=Math.min(r,2-i.eps),o=[e[0]+(r=r>1?(r-1)/(r-2):(1-r)/r)*t[0],e[1]+r*t[1],e[2]+r*t[2]]):o=[t[0]+(r=this.position)*(e[0]-t[0]),t[1]+r*(e[1]-t[1]),t[2]+r*(e[2]-t[2])]):p.type===a.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(a.COORDS_BY_USER,[p.Z(this.position),p.X(this.position),p.Y(this.position)]),this.updateConstraint(),o=s.projectPointToTurtle(this,p,this.board).usrCoords):p.elementClass===a.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(a.COORDS_BY_USER,[p.Z(this.position),p.X(this.position),p.Y(this.position)]),p.type===a.OBJECT_TYPE_ARC||p.type===a.OBJECT_TYPE_SECTOR?(l=s.rad([p.center.X()+1,p.center.Y()],p.center,p.radiuspoint),c=0,d=s.rad(p.radiuspoint,p.center,p.anglepoint),("minor"===p.visProp.selection&&d>Math.PI||"major"===p.visProp.selection&&d<Math.PI)&&(c=d,d=2*Math.PI),f=d-c,h.evaluate(this.visProp.isgeonext)&&(f=1),((u=this.position*f)<c||u>d)&&(((u=d)<c&&u>.5*c||u>d&&u>.5*d+Math.PI)&&(u=c),this.position=u,Math.abs(f)>i.eps&&(this.position/=f)),n=p.Radius(),o=[p.center.X()+n*Math.cos(this.position*f+l),p.center.Y()+n*Math.sin(this.position*f+l)]):(this.updateConstraint(),o=s.projectPointToCurve(this,p,this.board).usrCoords)):h.isPoint(p)&&(o=s.projectPointToPoint(this,p,this.board).usrCoords),this.coords.setCoordinates(a.COORDS_BY_USER,o,!1)):this.needsUpdateFromParent=!0},updateRendererGeneric:function(t){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>i.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[t](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(t){return this.isReal&&t.isReal?this.coords.distance(a.COORDS_BY_USER,t.coords):NaN},snapToGrid:function(t){return this.handleSnapToGrid(t)},handleSnapToPoints:function(t){var e,i,n,r,o,l,c,u,d=0,p=1/0,f=null,m=h.evaluate(this.visProp.ignoredsnaptopoints),g=!1;if(r=this.board.objectsList.length,m&&(c=m.length),h.evaluate(this.visProp.snaptopoints)||t){for(o=h.evaluate(this.visProp.attractorunit),l=h.evaluate(this.visProp.attractordistance),e=0;e<r;e++){if(i=this.board.objectsList[e],m){for(g=!1,u=0;u<c;u++)if(i==this.board.select(m[u])){g=!0;break}if(g)continue}h.isPoint(i)&&i!==this&&i.visPropCalc.visible&&(d=(n=s.projectPointToPoint(this,i,this.board)).distance("screen"===o?a.COORDS_BY_SCREEN:a.COORDS_BY_USER,this.coords))<l&&d<p&&(p=d,f=n)}null!==f&&this.coords.setCoordinates(a.COORDS_BY_USER,f.usrCoords)}return this},snapToPoints:function(t){return this.handleSnapToPoints(t)},handleAttractors:function(){var t,e,i,n,r=0,l=h.evaluate(this.visProp.attractorunit),c=h.evaluate(this.visProp.attractordistance),u=h.evaluate(this.visProp.snatchdistance),d=h.evaluate(this.visProp.attractors),p=d.length;if(0!==c){for(t=0;t<p;t++)if(e=this.board.select(d[t]),h.exists(e)&&e!==this){if(h.isPoint(e)?i=s.projectPointToPoint(this,e,this.board):e.elementClass===a.OBJECT_CLASS_LINE?(n=s.projectCoordsToSegment(this.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords),i=!h.evaluate(e.visProp.straightfirst)&&n[1]<0?e.point1.coords:!h.evaluate(e.visProp.straightlast)&&n[1]>1?e.point2.coords:new o(a.COORDS_BY_USER,n[0],this.board)):e.elementClass===a.OBJECT_CLASS_CIRCLE?i=s.projectPointToCircle(this,e,this.board):e.elementClass===a.OBJECT_CLASS_CURVE?i=s.projectPointToCurve(this,e,this.board):e.type===a.OBJECT_TYPE_TURTLE&&(i=s.projectPointToTurtle(this,e,this.board)),(r=i.distance("screen"===l?a.COORDS_BY_SCREEN:a.COORDS_BY_USER,this.coords))<c){this.type===a.OBJECT_TYPE_GLIDER&&this.slideObject===e||this.makeGlider(e);break}e===this.slideObject&&r>=u&&this.popSlideObject()}return this}},setPositionDirectly:function(t,e){var s,n,l,c,u=this.coords;if(this.relativeCoords)return n=new o(t,e,this.board),h.evaluate(this.visProp.islabel)?(l=r.subtract(n.scrCoords,u.scrCoords),this.relativeCoords.scrCoords[1]+=l[1],this.relativeCoords.scrCoords[2]+=l[2]):(l=r.subtract(n.usrCoords,u.usrCoords),this.relativeCoords.usrCoords[1]+=l[1],this.relativeCoords.usrCoords[2]+=l[2]),this;for(this.coords.setCoordinates(t,e),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),s=this.transformations.length-1;s>=0;s--)t===a.COORDS_BY_SCREEN?c=new o(t,e,this.board).usrCoords:(2===e.length&&(e=[1].concat(e)),c=e),this.initialCoords.setCoordinates(a.COORDS_BY_USER,i.matVecMult(i.inverse(this.transformations[s].matrix),c));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===a.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(t,e){var i;return e=new o(t,e,this.board),i=this.board.create("transform",e.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(i):this.addTransform(this,i),this.prepareUpdate().update(),this},setPosition:function(t,e){return this.setPositionDirectly(t,e)},setGliderPosition:function(t){return this.type===a.OBJECT_TYPE_GLIDER&&(this.position=t,this.board.update()),this},makeGlider:function(e){var i,s,n,r=this.board.select(e),o=!1;if(r.type===a.OBJECT_TYPE_POLYGON){for(i=Number.MAX_VALUE,s=0;s<r.borders.length;s++)(n=t.Math.Geometry.distPointLine(this.coords.usrCoords,r.borders[s].stdform))<i&&(i=n,e=r.borders[s]);r=this.board.select(e),o=!0}if(!h.exists(r))throw new Error("JSXGraph: slide object undefined.");if(r.type===a.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(e),this.slideObjects.push(this.slideObject),this.addParents(e),this.type=a.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=o,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),0===this.slideObjects.length?(this.type=this._org_type,this.type===a.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===a.OBJECT_CLASS_TEXT?this.elType="text":this.type===a.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var t,e;if(this.type!==a.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===a.OBJECT_CLASS_POINT&&(this.type=a.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(t in this.board.objects)this.board.objects.hasOwnProperty(t)&&(e=this.board.objects[t]).descendants&&(delete e.descendants[this.id],delete e.childElements[this.id],this.hasLabel&&(delete e.descendants[this.label.id],delete e.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===a.OBJECT_CLASS_POINT?(this.type=a.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===a.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===a.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(t){var e,i,s=[],n=["X","Y"];for(this.elementClass===a.OBJECT_CLASS_POINT&&(this.type=a.OBJECT_TYPE_CAS),this.isDraggable=!1,e=0;e<t.length;e++)h.isString(i=t[e])?(s[e]=this.board.jc.snippet(i,!0,null,!0),2===t.length&&(this[n[e]+"jc"]=t[e])):h.isFunction(i)?s[e]=i:h.isNumber(i)?s[e]=function(t){return function(){return t}}(i):h.isObject(i)&&h.isFunction(i.Value)&&(s[e]=function(t){return function(){return t.Value()}}(i)),s[e].origin=i;return 1===t.length?this.updateConstraint=function(){var t=s[0]();h.isArray(t)?this.coords.setCoordinates(a.COORDS_BY_USER,t):this.coords=t}:2===t.length?(this.XEval=s[0],this.YEval=s[1],this.setParents([s[0].origin,s[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=s[0],this.XEval=s[1],this.YEval=s[2],this.setParents([s[0].origin,s[1].origin,s[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(t,e){this.relativeCoords=e?new o(a.COORDS_BY_SCREEN,t.slice(0,2),this.board):new o(a.COORDS_BY_USER,t,this.board),this.element.addChild(this),e&&this.addParents(this.element),this.XEval=function(){var t,e,i=h.evaluate(this.visProp.offset);return h.evaluate(this.visProp.islabel)?(t=parseFloat(i[0]),e=this.element.getLabelAnchor(),new o(a.COORDS_BY_SCREEN,[t+this.relativeCoords.scrCoords[1]+e.scrCoords[1],0],this.board).usrCoords[1]):(e=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+e.usrCoords[1])},this.YEval=function(){var t,e,i=h.evaluate(this.visProp.offset);return h.evaluate(this.visProp.islabel)?(t=-parseFloat(i[1]),e=this.element.getLabelAnchor(),new o(a.COORDS_BY_SCREEN,[0,t+this.relativeCoords.scrCoords[2]+e.scrCoords[2]],this.board).usrCoords[2]):(e=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+e.usrCoords[2])},this.ZEval=h.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(a.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new o(a.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var t;if(0===this.transformations.length)return this;for(t=0;t<this.transformations.length;t++)this.transformations[t].update();return this},addTransform:function(t,e){var i,s=h.isArray(e)?e:[e],n=s.length;for(0===this.transformations.length&&(this.baseElement=t),i=0;i<n;i++)this.transformations.push(s[i]);return this},startAnimation:function(t,e){var i=this;return this.type!==a.OBJECT_TYPE_GLIDER||h.exists(this.intervalCode)||(this.intervalCode=window.setInterval((function(){i._anim(t,e)}),250),h.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return h.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(t,e,i){i=i||{};var s,r,o,l,c,u=[],d=[],p=e/this.board.attr.animationdelay,f=function(e,i){return function(){return t[e][i]}};if(h.isArray(t)){for(o=t.length,s=0;s<o;s++)d[s]=h.isPoint(t[s])?t[s]:{elementClass:a.OBJECT_CLASS_POINT,X:f(s,0),Y:f(s,1)};if(0===(e=e||0))return this.setPosition(a.COORDS_BY_USER,[d[d.length-1].X(),d[d.length-1].Y()]),this.board.update(this);if(!h.exists(i.interpolate)||i.interpolate)for(r=n.Neville(d),s=0;s<p;s++)u[s]=[],u[s][0]=r[0]((p-s)/p*r[3]()),u[s][1]=r[1]((p-s)/p*r[3]());else{for(o=t.length-1,s=0;s<p;++s)c=s/p*o-(l=Math.floor(s/p*o)),u[s]=[],u[s][0]=(1-c)*d[l].X()+c*d[l+1].X(),u[s][1]=(1-c)*d[l].Y()+c*d[l+1].Y();u.push([d[o].X(),d[o].Y()]),u.reverse()}this.animationPath=u}else h.isFunction(t)&&(this.animationPath=t,this.animationStart=(new Date).getTime());return this.animationCallback=i.callback,this.board.addAnimation(this),this},moveTo:function(t,e,s){s=s||{},t=new o(a.COORDS_BY_USER,t,this.board);var n,r=Math.ceil(e/this.board.attr.animationdelay),l=[],c=this.coords.usrCoords[1],u=this.coords.usrCoords[2],d=t.usrCoords[1]-c,p=t.usrCoords[2]-u,f=function(t){return s.effect&&"<>"===s.effect?Math.pow(Math.sin(t/r*Math.PI/2),2):t/r};if(!h.exists(e)||0===e||Math.abs(t.usrCoords[0]-this.coords.usrCoords[0])>i.eps)return this.setPosition(a.COORDS_BY_USER,t.usrCoords),this.board.update(this);if(!h.exists(s.callback)&&Math.abs(d)<i.eps&&Math.abs(p)<i.eps)return this;for(n=r;n>=0;n--)l[r-n]=[t.usrCoords[0],c+d*f(n),u+p*f(n)];return this.animationPath=l,this.animationCallback=s.callback,this.board.addAnimation(this),this},visit:function(t,e,i){t=new o(a.COORDS_BY_USER,t,this.board);var s,n,r,l=this.board.attr.animationdelay,c=[],u=this.coords.usrCoords[1],d=this.coords.usrCoords[2],p=t.usrCoords[1]-u,f=t.usrCoords[2]-d,m=function(t){var e=t<r/2?2*t/r:2*(r-t)/r;return i.effect&&"<>"===i.effect?Math.pow(Math.sin(e*Math.PI/2),2):e};for(h.isNumber(i)?i={repeat:i}:h.exists((i=i||{}).repeat)||(i.repeat=1),r=Math.ceil(e/(l*i.repeat)),n=0;n<i.repeat;n++)for(s=r;s>=0;s--)c[n*(r+1)+r-s]=[t.usrCoords[0],u+p*m(s),d+f*m(s)];return this.animationPath=c,this.animationCallback=i.callback,this.board.addAnimation(this),this},_anim:function(t,e){var i,n,r,o,l,c,h,u,d=1;return this.intervalCount+=1,this.intervalCount>e&&(this.intervalCount=0),this.slideObject.elementClass===a.OBJECT_CLASS_LINE?(i=this.slideObject.point1.coords.distance(a.COORDS_BY_SCREEN,this.slideObject.point2.coords),(n=this.slideObject.getSlope())!==1/0?(l=Math.atan(n),r=Math.round(this.intervalCount/e*i*Math.cos(l)),o=Math.round(this.intervalCount/e*i*Math.sin(l))):(r=0,o=Math.round(this.intervalCount/e*i)),t<0?(c=this.slideObject.point2,(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0||this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0)&&(d=-1)):(c=this.slideObject.point1,(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0||this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0)&&(d=-1)),this.coords.setCoordinates(a.COORDS_BY_SCREEN,[c.coords.scrCoords[1]+d*r,c.coords.scrCoords[2]+d*o])):this.slideObject.elementClass===a.OBJECT_CLASS_CURVE?(h=t>0?Math.round(this.intervalCount/e*this.board.canvasWidth):Math.round((e-this.intervalCount)/e*this.board.canvasWidth),this.coords.setCoordinates(a.COORDS_BY_SCREEN,[h,0]),this.coords=s.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===a.OBJECT_CLASS_CIRCLE&&(l=t<0?this.intervalCount/e*2*Math.PI:(e-this.intervalCount)/e*2*Math.PI,u=this.slideObject.Radius(),this.coords.setCoordinates(a.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+u*Math.cos(l),this.slideObject.center.coords.usrCoords[2]+u*Math.sin(l)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var t=[this.Z(),this.X(),this.Y()];return 0!==this.parents.length&&(t=this.parents),this.type===a.OBJECT_TYPE_GLIDER&&(t=[this.X(),this.Y(),this.slideObject.id]),t}}),t.CoordsElement.create=function(t,e,i,s,n,r){var o,a,l=!1;for(a=0;a<i.length;a++)(h.isFunction(i[a])||h.isString(i[a]))&&(l=!0);if(l)(o=new t(e,[0,0],s,n,r)).addConstraint(i);else if(h.isNumber(i[0])&&h.isNumber(i[1]))o=new t(e,i,s,n,r),h.exists(s.slideobject)?o.makeGlider(s.slideobject):o.baseElement=o,o.isDraggable=!0;else{if(!h.isObject(i[0])||!h.isTransformationOrArray(i[1]))return!1;(o=new t(e,[0,0],s,n,r)).addTransform(i[0],i[1]),o.isDraggable=!1}return o.handleSnapToGrid(),o.handleSnapToPoints(),o.handleAttractors(),o.addParents(i),o},t.CoordsElement})),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],(function(t,e,i,s,n,r,o,a,l,c){"use strict";var h=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};return t.Text=function(t,i,s,n){this.constructor(t,s,e.OBJECT_TYPE_TEXT,e.OBJECT_CLASS_TEXT),this.element=this.board.select(s.anchor),this.coordsConstructor(i,a.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(n),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),a.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=a.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},t.Text.prototype=new s,a.copyPrototypeMethods(t.Text,c,"coordsConstructor"),t.extend(t.Text.prototype,{hasPoint:function(t,e){var i,s,n,r,o,c,h=this.board.options.precision.hasPoint;return this.transformations.length>0&&(t=(i=l.matVecMult(l.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,t,e]))[1],e=i[2]),s=(i="right"===(o=this.getAnchorX())?this.coords.scrCoords[1]-this.size[0]:"middle"===o?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],n=(r="top"===(c=this.getAnchorY())?this.coords.scrCoords[2]+this.size[1]:"middle"===c?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],"all"===a.evaluate(this.visProp.dragarea)?t>=i-h&&t<s+h&&e>=n-h&&e<=r+h:e>=n-h&&e<=r+h&&(t>=i-h&&t<=i+2*h||t>=s-2*h&&t<=s+h)},_setUpdateText:function(t){var e,i,s=a.evaluate(this.visProp.parse),n=a.evaluate(this.visProp.usemathjax);this.orgText=t,a.isFunction(t)?this.updateText=function(){i=t().toString(),this.plaintext=s&&!n?this.replaceSub(this.replaceSup(this.convertGeonext2CSS(i))):i}:a.isString(t)&&!s?this.updateText=function(){this.plaintext=t}:(this.content=a.isNumber(t)?a.toFixed(t,a.evaluate(this.visProp.digits)):a.evaluate(this.visProp.useasciimathml)?"'`"+t+"`'":n?"'"+t+"'":this.generateTerm(t,!0,!0),e=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=e()})},_setText:function(t){return this._setUpdateText(t),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(t){var e;return this.visProp.castext=t,e=a.isFunction(t)?function(){return a.sanitizeHTML(t())}:a.isNumber(t)?t:a.sanitizeHTML(t),this._setText(e)},setText:function(t){return this._setText(t)},updateSize:function(){var t,e,i,s,n=a.evaluate(this.visProp.display);if(!o.isBrowser||"no"===this.board.renderer.type)return this;if(s=this.rendNode,"html"===n||"vml"===this.board.renderer.type)a.exists(s.offsetWidth)?0===(e=[s.offsetWidth,s.offsetHeight])[0]&&0===e[1]?(i=this,window.setTimeout((function(){i.size=[s.offsetWidth,s.offsetHeight],i.needsUpdate=!0,i.updateRenderer()}),0)):this.size=e:this.size=this.crudeSizeEstimate();else if("internal"===n)if("svg"===this.board.renderer.type)try{t=s.getBBox(),this.size=[t.width,t.height]}catch(t){}else"canvas"===this.board.renderer.type&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var t=parseFloat(a.evaluate(this.visProp.fontsize));return[t*this.plaintext.length*.45,.9*t]},utf8_decode:function(t){return t.replace(/&#x(\w+);/g,(function(t,e){return String.fromCharCode(parseInt(e,16))}))},replaceSub:function(t){if(!t.indexOf)return t;for(var e,i=t.indexOf("_{");i>=0;)(e=(t=t.substr(0,i)+t.substr(i).replace(/_\{/,"<sub>")).substr(i).indexOf("}"))>=0&&(t=t.substr(0,e)+t.substr(e).replace(/\}/,"</sub>")),i=t.indexOf("_{");for(i=t.indexOf("_");i>=0;)i=(t=t.substr(0,i)+t.substr(i).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return t},replaceSup:function(t){if(!t.indexOf)return t;for(var e,i=t.indexOf("^{");i>=0;)(e=(t=t.substr(0,i)+t.substr(i).replace(/\^\{/,"<sup>")).substr(i).indexOf("}"))>=0&&(t=t.substr(0,e)+t.substr(e).replace(/\}/,"</sup>")),i=t.indexOf("^{");for(i=t.indexOf("^");i>=0;)i=(t=t.substr(0,i)+t.substr(i).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return t},getSize:function(){return this.size},setCoords:function(t,i){var s;return a.isArray(t)&&t.length>1&&(i=t[1],t=t[0]),a.evaluate(this.visProp.islabel)&&a.exists(this.element)?(s=this.element.getLabelAnchor(),this.relativeCoords.setCoordinates(e.COORDS_BY_SCREEN,[(t-s.usrCoords[1])*this.board.unitX,-(i-s.usrCoords[2])*this.board.unitY])):this.coords.setCoordinates(e.COORDS_BY_USER,[t,i]),this.fullUpdate(),this},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateText(),"internal"===a.evaluate(this.visProp.display)&&a.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(t){return t.replace(/([\)0-9\.])\s*([\(a-zA-Z_])/g,"$1*$2")},generateTerm:function(t,e,i){var s,r,o,l,c='""';if(o=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),l=t.indexOf("</value>"),o>=0)for(;o>=0;)c+=' + "'+this.replaceSub(this.replaceSup(t.slice(0,o)))+'"',r=(r=t.slice(o+7,l)).replace(/\s+/g,""),!0===e&&(r=this.expandShortMath(r)),(s=(s=(s=i?r:n.geonext2JS(r,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&a.isNumber(a.bind(this.board.jc.snippet(s,!0,"",!1),this)())?c+="+("+s+").toFixed("+a.evaluate(this.visProp.digits)+")":c+="+("+s+")",o=(t=t.slice(l+8)).indexOf("<value>"),l=t.indexOf("</value>");return c+=' + "'+this.replaceSub(this.replaceSup(t))+'"',(c=(c=this.convertGeonext2CSS(c)).replace(/&amp;/g,"&")).replace(/"/g,"'")},convertGeonext2CSS:function(t){return a.isString(t)&&(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<overline>/g,"<span style=text-decoration:overline>")).replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>")).replace(/<\/overline>/g,"</span>")).replace(/&lt;\/overline&gt;/g,"</span>")).replace(/<arrow>/g,"<span style=text-decoration:overline>")).replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>")).replace(/<\/arrow>/g,"</span>")).replace(/&lt;\/arrow&gt;/g,"</span>")),t},notifyParents:function(t){var e,i=null;t=(t=t.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do{null!==(i=(e=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/).exec(t))&&(n.findDependencies(this,i[1],this.board),t=(t=t.substr(i.index)).replace(e,""))}while(null!==i);return this},getParents:function(){var t;return t=void 0!==this.relativeCoords?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],0!==this.parents.length&&(t=this.parents),t},bounds:function(){var t=this.coords.usrCoords;return a.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX?[0,0,0,0]:[t[1],t[2]+this.size[1]/this.board.unitY,t[1]+this.size[0]/this.board.unitX,t[2]]},getAnchorX:function(){var t=a.evaluate(this.visProp.anchorx);if("auto"==t)switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return t},getAnchorY:function(){var t=a.evaluate(this.visProp.anchory);if("auto"==t)switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return t}}),t.createText=function(e,i,s){var n,r=a.copyAttributes(s,e.options,"text"),o=i.slice(0,-1),l=i[i.length-1];if(r.anchor=r.parent||r.anchor,!(n=c.create(t.Text,e,o,r,l)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==a.evaluate(r.rotate)&&"internal"===r.display&&n.addRotation(a.evaluate(r.rotate)),n},t.registerElement("text",t.createText),t.createHTMLSlider=function(e,i,s){var n,r=a.copyAttributes(s,e.options,"htmlslider");if(2!==i.length||2!==i[0].length||3!==i[1].length)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parents are: [[x,y], [min, start, max]]");r.anchor=r.parent||r.anchor,r.fixed=r.fixed||!0,(n=t.createText(e,[i[0][0],i[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],r)).type=a.OBJECT_TYPE_HTMLSLIDER,n.rendNodeForm=n.rendNode.childNodes[0],n.rendNodeRange=n.rendNodeForm.childNodes[0],n.rendNodeRange.min=i[1][0],n.rendNodeRange.max=i[1][2],n.rendNodeRange.step=r.step,n.rendNodeRange.value=i[1][1],n.rendNodeLabel=n.rendNodeForm.childNodes[1],n.rendNodeLabel.id=n.rendNode.id+"_label",r.withlabel&&(n.rendNodeLabel.innerHTML=n.name+"="),n.rendNodeOut=n.rendNodeForm.childNodes[2],n.rendNodeOut.value=i[1][1];try{n.rendNodeForm.id=n.rendNode.id+"_form",n.rendNodeRange.id=n.rendNode.id+"_range",n.rendNodeOut.id=n.rendNode.id+"_out"}catch(e){t.debug(e)}return n.rendNodeRange.style.width=r.widthrange+"px",n.rendNodeRange.style.verticalAlign="middle",n.rendNodeOut.style.width=r.widthout+"px",n._val=i[1][1],t.supportsVML()?o.addEvent(n.rendNodeForm,"change",h,n):o.addEvent(n.rendNodeForm,"input",h,n),n.Value=function(){return this._val},n},t.registerElement("htmlslider",t.createHTMLSlider),{Text:t.Text,createText:t.createText,createHTMLSlider:t.createHTMLSlider}})),define("utils/uuid",["jxg"],(function(t){"use strict";var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return t.Util=t.Util||{},t.Util.genUUID=function(){var t,i,s=[],n=0;for(i=0;i<36;i++)8===i||13===i||18===i||23===i?s[i]="-":14===i?s[i]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,s[i]=e[19===i?3&t|8:t]);return s.join("")},t.Util})),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],(function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(t,e){function i(){}if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object: "+t);if(null===t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return i.prototype=t,new i});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}},t,e;JXG.JessieCode=function(t,e){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="","string"==typeof t&&this.parse(t,e)},JXG.extend(JXG.JessieCode.prototype,{node:function(t,e,i){return{type:t,value:e,children:i}},createNode:function(t,e,i){var s,n=this.node(t,e,[]);for(s=2;s<arguments.length;s++)n.children.push(arguments[s]);return"node_const"==n.type&&Type.isNumber(n.value)&&(n.isMath=!0),n.line=this.parCurLine,n.col=this.parCurColumn,n},pushScope:function(t){var e={args:t,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=e,e.id=this.scopes.push(e)-1,e},popScope:function(){var t=this.scope.previous;return this.scope=null!==t?t:this.scope,this.scope},getElementById:function(t){return this.board.objects[t]},log:function(){this.$log.push(arguments),"object"==typeof console&&console.log&&console.log.apply(console,arguments)},creator:(e={},(t=function(t){var i;return"function"==typeof e[this.board.id+t]?i=e[this.board.id+t]:((i=function(e){return function(i,s){var n;return n=Type.exists(s)?s:{name:0!==e.lhs[e.scope]?e.lhs[e.scope]:""},e.board.create(t,i,n)}}(this)).creator=!0,e[this.board.id+t]=i),i}).clearCache=function(){e={}},t),letvar:function(t,e){this.builtIn[t]&&this._warn('"'+t+'" is a predefined value.'),this.scope.locals[t]=e},isLocalVariable:function(t){for(var e=this.scope;null!==e;){if(Type.exists(e.locals[t]))return e;e=e.previous}return null},isParameter:function(t){for(var e=this.scope;null!==e;){if(Type.indexOf(e.args,t)>-1)return e;e=e.previous}return null},isCreator:function(t){return!!JXG.elements[t]},isMathMethod:function(t){return"E"!==t&&!!Math[t]},isBuiltIn:function(t){return!!this.builtIn[t]},getvar:function(t,e){var i;return e=Type.def(e,!1),null!==(i=this.isLocalVariable(t))?i.locals[t]:this.isCreator(t)?this.creator(t):this.isBuiltIn(t)?this.builtIn[t]:this.isMathMethod(t)?Math[t]:e||(i=this.board.select(t))===t?void 0:i},resolve:function(t){for(var e=this.scope;null!==e;){if(Type.exists(e.locals[t]))return e.locals[t];e=e.previous}},getvarJS:function(t,e,i){var s="";return e=Type.def(e,!1),i=Type.def(i,!1),null!==this.isParameter(t)?t:null===this.isLocalVariable(t)||i?this.isCreator(t)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(i?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+t+"'].concat([a, props])); })":(i&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(t)?this.builtIn[t].src||this.builtIn[t]:this.isMathMethod(t)?"Math."+t:e?"":(Type.isId(this.board,t)?s="$jc$.board.objects['"+t+"']":Type.isName(this.board,t)?s="$jc$.board.elementsByName['"+t+"']":Type.isGroup(this.board,t)&&(s="$jc$.board.groups['"+t+"']"),s)):"$jc$.resolve('"+t+"')"},makeMap:function(t){return t.isMap=!0,t},functionCodeJS:function(t){var e=t.children[0].join(", "),i="",s="";return"op_map"===t.value&&(i="{ return  ",s=" }"),"function ("+e+") {\nvar $oldscope$ = $jc$.scope;\n$jc$.scope = $jc$.scopes["+this.scope.id+"];\nvar r = (function () "+i+this.compile(t.children[1],!0)+s+")();\n$jc$.scope = $oldscope$;\nreturn r;\n}"},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return eval(str)}catch(t){return $jc$._warn("error compiling function\n\n"+str+"\n\n"+t.toString()),function(){}}}(this),this.popScope()}else fun=function(t,e,i){return function(){var s,n;for(n=e.scope,e.scope=e.scopes[i],s=0;s<t.length;s++)e.scope.locals[t[s]]=arguments[s];return s=e.execute(node.children[1]),e.scope=n,s}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(t){return function(){return t.compile(t.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(t){var e,i={};for(e=0;e<arguments.length;e++)i=Type.deepCopy(i,arguments[e],!0);return i},setProp:function(t,e,i){var s,n,r={};t.elementClass!==Const.OBJECT_CLASS_POINT||"X"!==e&&"Y"!==e?t.elementClass!==Const.OBJECT_CLASS_TEXT||"X"!==e&&"Y"!==e?t.type&&t.elementClass&&t.visProp?Type.exists(t[t.methodMap[e]])&&"function"!=typeof t[t.methodMap[e]]?t[t.methodMap[e]]=i:(r[e]=i,t.setAttribute(r)):t[e]=i:("number"==typeof i?t[e]=function(){return i}:"function"==typeof i?(t.isDraggable=!1,t[e]=i):"string"==typeof i&&(t.isDraggable=!1,t[e]=Type.createFunction(i,this.board,null,!0),t[e+"jc"]=i),t[e].origin=i,this.board.update()):(e=e.toLowerCase(),t.isDraggable&&"number"==typeof i?(s="x"===e?i:t.X(),n="y"===e?i:t.Y(),t.setPosition(Const.COORDS_BY_USER,[s,n])):!t.isDraggable||"function"!=typeof i&&"string"!=typeof i?t.isDraggable||t.addConstraint([s="x"===e?i:t.XEval.origin,n="y"===e?i:t.YEval.origin]):t.addConstraint([s="x"===e?i:t.coords.usrCoords[1],n="y"===e?i:t.coords.usrCoords[2]]),this.board.update())},_genericParse:function(t,e,i,s){var n,r,o,a,l=t.replace(/\r\n/g,"\n").split("\n"),c=[];s||(this.code+=t+"\n"),Text&&(r=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(i)||(i=!1),n=0;n<l.length;n++)i&&(l[n]=JXG.GeonextParser.geonext2JS(l[n],this.board)),c.push(l[n]);switch(t=c.join("\n"),o=parser.parse(t),this.CA&&(o=this.CA.expandDerivatives(o,null,o),o=this.CA.removeTrivialNodes(o)),e){case"parse":a=this.execute(o);break;case"manipulate":a=this.compile(o);break;case"getAst":a=o;break;default:a=!1}}catch(t){console.log(t)}finally{Text&&(Text.Text.prototype.setText=r)}return a},parse:function(t,e,i){return this._genericParse(t,"parse",e,i)},manipulate:function(t,e,i){return this._genericParse(t,"manipulate",e,i)},getAST:function(t,e,i){return this._genericParse(t,"getAst",e,i)},snippet:function(t,e,i,s){return e=Type.def(e,!0),i=Type.def(i,""),s=Type.def(s,!1),this.parse((e?" function ("+i+") { return ":"")+t+(e?"; }":"")+";",s,!0)},replaceIDs:function(t){var e,i;if(t.replaced&&Type.exists(i=this.board.objects[t.children[1][0].value])&&""!==i.name&&(t.type="node_var",t.value=i.name,t.children.length=0,delete t.replaced),t.children)for(e=t.children.length;e>0;e--)Type.exists(t.children[e-1])&&(t.children[e-1]=this.replaceIDs(t.children[e-1]));return t},replaceNames:function(t){var e,i;if(i=t.value,"node_op"===t.type&&"op_lhs"===i&&1===t.children.length?this.isLHS=!0:"node_var"===t.type&&(this.isLHS?this.letvar(i,!0):!Type.exists(this.getvar(i,!0))&&Type.exists(this.board.elementsByName[i])&&(t=this.createReplacementNode(t))),t.children)for(e=t.children.length;e>0;e--)Type.exists(t.children[e-1])&&(t.children[e-1]=this.replaceNames(t.children[e-1]));return"node_op"===t.type&&"op_lhs"===t.value&&1===t.children.length&&(this.isLHS=!1),t},createReplacementNode:function(t){var e=this.board.elementsByName[t.value];return(t=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",e.id)])).replaced=!0,t},collectDependencies:function(t,e){var i,s,n;if(Type.isArray(t))for(n=t.length,i=0;i<n;i++)this.collectDependencies(t[i],e);else if("node_var"===t.type&&(s=this.getvar(t.value))&&s.visProp&&s.type&&s.elementClass&&s.id&&(e[s.id]=s),"node_op"===t.type&&"op_execfun"===t.value&&t.children.length>1&&"$"===t.children[0].value&&t.children[1].length>0&&(e[s=t.children[1][0].value]=this.board.objects[s]),t.children)for(i=t.children.length;i>0;i--)Type.exists(t.children[i-1])&&this.collectDependencies(t.children[i-1],e)},resolveProperty:function(t,e,i){return i=Type.def(i,!1),t&&t.methodMap&&(Type.exists(t.subs)&&Type.exists(t.subs[e])?t=t.subs:Type.exists(t.methodMap[e])?e=t.methodMap[e]:(t=t.visProp,e=e.toLowerCase())),Type.isFunction(t)&&this._error("Accessing function properties is not allowed."),Type.exists(t)||this._error(t+" is not an object"),Type.exists(t[e])||this._error("unknown property "+e),i&&"function"==typeof t[e]?function(){return t[e].apply(t,arguments)}:t[e]},getLHS:function(t){var e;if("node_var"===t.type)e={o:this.scope.locals,what:t.value};else if("node_op"===t.type&&"op_property"===t.value)e={o:this.execute(t.children[0]),what:t.children[1]};else{if("node_op"!==t.type||"op_extvalue"!==t.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");e={o:this.execute(t.children[0]),what:this.execute(t.children[1])}}return e},getLHSCompiler:function(t,e){var i;if("node_var"===t.type)i=t.value;else if("node_op"===t.type&&"op_property"===t.value)i=[this.compile(t.children[0],e),"'"+t.children[1]+"'"];else{if("node_op"!==t.type||"op_extvalue"!==t.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");i=[this.compile(t.children[0],e),"node_const"===t.children[1].type?t.children[1].value:this.compile(t.children[1],e)]}return i},execute:function(t){var e,i,s,n,r,o,a,l,c,h,u=[];if(e=0,!t)return e;switch(this.line=t.line,this.col=t.col,t.type){case"node_op":switch(t.value){case"op_none":t.children[0]&&this.execute(t.children[0]),t.children[1]&&(e=this.execute(t.children[1]));break;case"op_assign":i=this.getLHS(t.children[0]),this.lhs[this.scope.id]=i[1],i.o.type&&i.o.elementClass&&i.o.methodMap&&"label"===i.what&&this._error("Left-hand side of assignment is read-only."),e=this.execute(t.children[1]),i.o!==this.scope.locals||Type.isArray(i.o)&&"number"==typeof i.what?this.setProp(i.o,i.what,e):this.letvar(i.what,e),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(t.children[0])&&(e=this.execute(t.children[1]));break;case"op_conditional":case"op_if_else":e=this.execute(t.children[0])?this.execute(t.children[1]):this.execute(t.children[2]);break;case"op_while":for(;this.execute(t.children[0]);)this.execute(t.children[1]);break;case"op_do":do{this.execute(t.children[0])}while(this.execute(t.children[1]));break;case"op_for":for(this.execute(t.children[0]);this.execute(t.children[1]);this.execute(t.children[2]))this.execute(t.children[3]);break;case"op_proplst":t.children[0]&&this.execute(t.children[0]),t.children[1]&&this.execute(t.children[1]);break;case"op_emptyobject":e={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(t.children[0]),e=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][t.children[0]]=this.execute(t.children[1]);break;case"op_array":for(e=[],r=t.children[0].length,s=0;s<r;s++)e.push(this.execute(t.children[0][s]));break;case"op_extvalue":e=this.execute(t.children[0]),e="number"==typeof(s=this.execute(t.children[1]))&&Math.abs(Math.round(s)-s)<Mat.eps?e[s]:void 0;break;case"op_return":if(0!==this.scope)return this.execute(t.children[0]);this._error("Unexpected return.");break;case"op_map":t.children[1].isMath||"node_var"===t.children[1].type||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(l=this.defineFunction(t)).isMap=!0,e=l;break;case"op_function":(l=this.defineFunction(t)).isMap=!1,e=l;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,o=t.children[1],Type.exists(t.children[2]))if(t.children[3])for(a=t.children[2],c={},s=0;s<a.length;s++)c=Type.deepCopy(c,this.execute(a[s]),!0);else c=this.execute(t.children[2]);for(h=(l=this.execute(t.children[0]))&&l.sc?l.sc:this,!l.creator&&Type.exists(t.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),s=0;s<o.length;s++)u[s]=this.execute(o[s]),this.dpstack[this.pscope].push({line:t.children[1][s].line,col:t.children[1][s].ecol});if("function"!=typeof l||l.creator)if("function"==typeof l&&l.creator){n=this.line;try{for((e=l(u,c)).jcLineStart=n,e.jcLineEnd=t.eline,s=n;s<=t.line;s++)this.lineToElement[s]=e;e.debugParents=this.dpstack[this.pscope]}catch(t){this._error(t.toString())}}else this._error("Function '"+l+"' is undefined.");else e=l.apply(h,u);this.dpstack.pop(),this.pscope--;break;case"op_property":n=this.execute(t.children[0]),e=this.resolveProperty(n,i=t.children[1],!1),Type.exists(e)&&(e.sc=n);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(t.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),i=this.getvar(t.children[0]),e=this.del(i);break;case"op_equ":e=this.execute(t.children[0])==this.execute(t.children[1]);break;case"op_neq":e=this.execute(t.children[0])!=this.execute(t.children[1]);break;case"op_approx":e=Math.abs(this.execute(t.children[0])-this.execute(t.children[1]))<Mat.eps;break;case"op_grt":e=this.execute(t.children[0])>this.execute(t.children[1]);break;case"op_lot":e=this.execute(t.children[0])<this.execute(t.children[1]);break;case"op_gre":e=this.execute(t.children[0])>=this.execute(t.children[1]);break;case"op_loe":e=this.execute(t.children[0])<=this.execute(t.children[1]);break;case"op_or":e=this.execute(t.children[0])||this.execute(t.children[1]);break;case"op_and":e=this.execute(t.children[0])&&this.execute(t.children[1]);break;case"op_not":e=!this.execute(t.children[0]);break;case"op_add":e=this.add(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_sub":e=this.sub(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_div":e=this.div(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_mod":e=this.mod(this.execute(t.children[0]),this.execute(t.children[1]),!0);break;case"op_mul":e=this.mul(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_exp":e=this.pow(this.execute(t.children[0]),this.execute(t.children[1]));break;case"op_neg":e=this.neg(this.execute(t.children[0]))}break;case"node_var":e=this.getvar(t.value);break;case"node_const":e=Number(t.value);break;case"node_const_bool":e=t.value;break;case"node_str":e=t.value.replace(/\\(.)/,"$1")}return e},compile:function(t,e){var i,s,n,r="";if(Type.exists(e)||(e=!1),!t)return r;switch(t.type){case"node_op":switch(t.value){case"op_none":t.children[0]&&(r=this.compile(t.children[0],e)),t.children[1]&&(r+=this.compile(t.children[1],e));break;case"op_assign":e?(i=this.getLHSCompiler(t.children[0],e),Type.isArray(i)?r="$jc$.setProp("+i[0]+", "+i[1]+", "+this.compile(t.children[1],e)+");\n":(this.isLocalVariable(i)!==this.scope&&(this.scope.locals[i]=!0),r="$jc$.scopes["+this.scope.id+"].locals['"+i+"'] = "+this.compile(t.children[1],e)+";\n")):r=(i=this.compile(t.children[0]))+" = "+this.compile(t.children[1],e)+";\n";break;case"op_if":r=" if ("+this.compile(t.children[0],e)+") "+this.compile(t.children[1],e);break;case"op_if_else":r=" if ("+this.compile(t.children[0],e)+")"+this.compile(t.children[1],e),r+=" else "+this.compile(t.children[2],e);break;case"op_conditional":r="(("+this.compile(t.children[0],e)+")?("+this.compile(t.children[1],e),r+="):("+this.compile(t.children[2],e)+"))";break;case"op_while":r=" while ("+this.compile(t.children[0],e)+") {\n"+this.compile(t.children[1],e)+"}\n";break;case"op_do":r=" do {\n"+this.compile(t.children[0],e)+"} while ("+this.compile(t.children[1],e)+");\n";break;case"op_for":r=" for ("+this.compile(t.children[0],e)+"; "+this.compile(t.children[1],e)+"; "+this.compile(t.children[2],e)+") {\n"+this.compile(t.children[3],e)+"\n}\n";break;case"op_proplst":t.children[0]&&(r=this.compile(t.children[0],e)+", "),r+=this.compile(t.children[1],e);break;case"op_prop":r=t.children[0]+": "+this.compile(t.children[1],e);break;case"op_emptyobject":r=e?"{}":"<< >>";break;case"op_proplst_val":r=this.compile(t.children[0],e);break;case"op_array":for(n=[],s=0;s<t.children[0].length;s++)n.push(this.compile(t.children[0][s],e));r="["+n.join(", ")+"]";break;case"op_extvalue":r=this.compile(t.children[0],e)+"["+this.compile(t.children[1],e)+"]";break;case"op_return":r=" return "+this.compile(t.children[0],e)+";\n";break;case"op_map":t.children[1].isMath||"node_var"===t.children[1].type||this._error("compile: In a map only function calls and mathematical expressions are allowed."),n=t.children[0],r=e?" $jc$.makeMap(function ("+n.join(", ")+") { return "+this.compile(t.children[1],e)+"; })":"map ("+n.join(", ")+") -> "+this.compile(t.children[1],e);break;case"op_function":this.pushScope(n=t.children[0]),r=e?this.functionCodeJS(t):" function ("+n.join(", ")+") "+this.compile(t.children[1],e),this.popScope();break;case"op_execfunmath":console.log("TODO"),r="-1";break;case"op_execfun":if(t.children[2]){for(n=[],s=0;s<t.children[2].length;s++)n.push(this.compile(t.children[2][s],e));e&&(i="$jc$.mergeAttributes("+n.join(", ")+")")}for(t.children[0].withProps=!!t.children[2],n=[],s=0;s<t.children[1].length;s++)n.push(this.compile(t.children[1][s],e));r=this.compile(t.children[0],e)+"("+n.join(", ")+(t.children[2]&&e?", "+i:"")+")"+(t.children[2]&&!e?i:""),e&&"$"===t.children[0].value&&(r="$jc$.board.objects["+this.compile(t.children[1][0],e)+"]");break;case"op_property":r=e&&"X"!==t.children[1]&&"Y"!==t.children[1]?"$jc$.resolveProperty("+this.compile(t.children[0],e)+", '"+t.children[1]+"', true)":this.compile(t.children[0],e)+"."+t.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),r=e?"$jc$.use('":"use('",r+=t.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),r=e?"$jc$.del(":"remove(",r+=this.compile(t.children[0],e)+")";break;case"op_equ":r="("+this.compile(t.children[0],e)+" == "+this.compile(t.children[1],e)+")";break;case"op_neq":r="("+this.compile(t.children[0],e)+" != "+this.compile(t.children[1],e)+")";break;case"op_approx":r="("+this.compile(t.children[0],e)+" ~= "+this.compile(t.children[1],e)+")";break;case"op_grt":r="("+this.compile(t.children[0],e)+" > "+this.compile(t.children[1],e)+")";break;case"op_lot":r="("+this.compile(t.children[0],e)+" < "+this.compile(t.children[1],e)+")";break;case"op_gre":r="("+this.compile(t.children[0],e)+" >= "+this.compile(t.children[1],e)+")";break;case"op_loe":r="("+this.compile(t.children[0],e)+" <= "+this.compile(t.children[1],e)+")";break;case"op_or":r="("+this.compile(t.children[0],e)+" || "+this.compile(t.children[1],e)+")";break;case"op_and":r="("+this.compile(t.children[0],e)+" && "+this.compile(t.children[1],e)+")";break;case"op_not":r="!("+this.compile(t.children[0],e)+")";break;case"op_add":r=e?"$jc$.add("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" + "+this.compile(t.children[1],e)+")";break;case"op_sub":r=e?"$jc$.sub("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" - "+this.compile(t.children[1],e)+")";break;case"op_div":r=e?"$jc$.div("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" / "+this.compile(t.children[1],e)+")";break;case"op_mod":r=e?"$jc$.mod("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+", true)":"("+this.compile(t.children[0],e)+" % "+this.compile(t.children[1],e)+")";break;case"op_mul":r=e?"$jc$.mul("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+" * "+this.compile(t.children[1],e)+")";break;case"op_exp":r=e?"$jc$.pow("+this.compile(t.children[0],e)+", "+this.compile(t.children[1],e)+")":"("+this.compile(t.children[0],e)+"^"+this.compile(t.children[1],e)+")";break;case"op_neg":r=e?"$jc$.neg("+this.compile(t.children[0],e)+")":"(-"+this.compile(t.children[0],e)+")"}break;case"node_var":r=e?this.getvarJS(t.value,!1,t.withProps):t.value;break;case"node_const":case"node_const_bool":r=t.value;break;case"node_str":r="'"+t.value+"'"}return t.needsBrackets&&(r="{\n"+r+"}\n"),r},X:function(t){return t.X()},Y:function(t){return t.Y()},V:function(t){return t.Value()},L:function(t){return t.L()},dist:function(t,e){return Type.exists(t)&&Type.exists(t.Dist)||this._error("Error: Can't calculate distance."),t.Dist(e)},add:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isArray(e))for(s=Math.min(t.length,e.length),n=[],i=0;i<s;i++)n[i]=t[i]+e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t+e:Type.isString(t)||Type.isString(e)?n=t.toString()+e.toString():this._error("Operation + not defined on operands "+typeof t+" and "+typeof e);return n},sub:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isArray(e))for(s=Math.min(t.length,e.length),n=[],i=0;i<s;i++)n[i]=t[i]-e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t-e:this._error("Operation - not defined on operands "+typeof t+" and "+typeof e);return n},neg:function(t){var e,i,s;if(t=Type.evalSlider(t),Type.isArray(t))for(i=t.length,s=[],e=0;e<i;e++)s[e]=-t[e];else Type.isNumber(t)?s=-t:this._error("Unary operation - not defined on operand "+typeof t);return s},mul:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e)&&(i=t,e=t=e),Type.isArray(t)&&Type.isArray(e))s=Math.min(t.length,e.length),n=Mat.innerProduct(t,e,s);else if(Type.isNumber(t)&&Type.isArray(e))for(s=e.length,n=[],i=0;i<s;i++)n[i]=t*e[i];else Type.isNumber(t)&&Type.isNumber(e)?n=t*e:this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},div:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e))for(s=t.length,n=[],i=0;i<s;i++)n[i]=t[i]/e;else Type.isNumber(t)&&Type.isNumber(e)?n=t/e:this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},mod:function(t,e){var i,s,n;if(t=Type.evalSlider(t),e=Type.evalSlider(e),Type.isArray(t)&&Type.isNumber(e))for(s=t.length,n=[],i=0;i<s;i++)n[i]=Mat.mod(t[i],e,!0);else Type.isNumber(t)&&Type.isNumber(e)?n=Mat.mod(t,e,!0):this._error("Operation * not defined on operands "+typeof t+" and "+typeof e);return n},pow:function(t,e){return t=Type.evalSlider(t),e=Type.evalSlider(e),Math.pow(t,e)},DDD:function(t){console.log("Dummy derivative function. This should never appear!")},ifthen:function(t,e,i){return t?e:i},del:function(t){"object"==typeof t&&JXG.exists(t.type)&&JXG.exists(t.elementClass)&&this.board.removeObject(t)},use:function(t){var e,i,s=!1;if("string"==typeof t){for(e in JXG.boards)if(JXG.boards.hasOwnProperty(e)&&JXG.boards[e].container===t){i=JXG.boards[e],s=!0;break}}else i=t,s=!0;s?(this.board=i,this.builtIn.$board=i,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+t+"' not found!")},findSymbol:function(t,e){var i,s;for(s=-1===(e=Type.def(e,-1))?this.scope:this.scopes[e];null!==s;){for(i in s.locals)if(s.locals.hasOwnProperty(i)&&s.locals[i]===t)return[i,s];s=s.previous}return[]},importModule:function(t){return priv.modules[t.toLowerCase()]},defineBuiltIn:function(){var t=this,e={PI:Math.PI,EULER:Math.E,X:t.X,Y:t.Y,V:t.V,L:t.L,dist:t.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:t.ifthen,import:t.importModule,use:t.use,remove:t.del,$:t.getElementById,$board:t.board,$log:t.log,D:t.DDD};return e.rad.sc=Geometry,e.deg.sc=Geometry,e.factorial.sc=Mat,e.X.src="$jc$.X",e.Y.src="$jc$.Y",e.V.src="$jc$.V",e.L.src="$jc$.L",e.dist.src="$jc$.dist",e.rad.src="JXG.Math.Geometry.rad",e.deg.src="JXG.Math.Geometry.trueAngle",e.factorial.src="JXG.Math.factorial",e.trunc.src="JXG.trunc",e.ln.src="Math.log",e.log10.src="JXG.Math.log10",e.lg.src="JXG.Math.log10",e.log2.src="JXG.Math.log2",e.lb.src="JXG.Math.log2",e.ld.src="JXG.Math.log2",e.cosh.src="JXG.Math.cosh",e.sinh.src="JXG.Math.sinh",e.import.src="$jc$.importModule",e.use.src="$jc$.use",e.remove.src="$jc$.del",e.IfThen.src="$jc$.ifthen",e.$.src="(function (n) { return $jc$.board.select(n); })",e.$board&&(e.$board.src="$jc$.board"),e.$log.src="$jc$.log",e},_debug:function(t){"object"==typeof console?console.log(t):Env.isBrowser&&document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=t+"<br />")},_error:function(t){var e=new Error("Error("+this.line+"): "+t);throw e.line=this.line,e},_warn:function(t){"object"==typeof console?console.log("Warning("+this.line+"): "+t):Env.isBrowser&&document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+t+"<br />")},_log:function(t){"object"!=typeof window&&"object"==typeof self&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+t.toString()}):console.log("Log: ",arguments)}});var parser=function(){function t(){this.yy={}}var e=function(t,e,i,s){for(i=i||{},s=t.length;s--;i[t[s]]=e);return i},i=[2,14],s=[1,13],n=[1,37],r=[1,14],o=[1,15],a=[1,21],l=[1,16],c=[1,17],h=[1,33],u=[1,18],d=[1,19],p=[1,12],f=[1,59],m=[1,60],g=[1,58],b=[1,46],y=[1,48],v=[1,49],x=[1,50],C=[1,51],_=[1,52],w=[1,53],S=[1,54],P=[1,45],k=[1,38],E=[1,39],T=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],A=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],O=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],M=[2,48],N=[1,72],L=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],D=[1,78],j=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],R=[1,82],I=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],B=[1,83],F=[1,84],Y=[1,85],z=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],q=[1,89],X=[1,90],U=[1,91],G=[1,92],H=[1,97],J=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],$=[1,103],V=[1,104],W=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],K=[1,105],Q=[1,106],Z=[1,107],tt=[1,126],et=[1,139],it=[83,86],st=[1,149],nt=[10,66,86],rt=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ot=[1,166],at=[10,86],lt={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(t,e,i,s,n,r,o){var a=r.length-1;switch(n){case 1:return r[a-1];case 2:this.$=ct.createNode(ht(o[a-4]),"node_op","op_if",r[a-2],r[a]);break;case 3:this.$=ct.createNode(ht(o[a-6]),"node_op","op_if_else",r[a-4],r[a-2],r[a]);break;case 4:this.$=ct.createNode(ht(o[a-4]),"node_op","op_while",r[a-2],r[a]);break;case 5:this.$=ct.createNode(ht(o[a-8]),"node_op","op_for",r[a-6],r[a-4],r[a-2],r[a]);break;case 6:this.$=ct.createNode(ht(o[a-6]),"node_op","op_do",r[a-5],r[a-2]);break;case 7:this.$=ct.createNode(ht(o[a-1]),"node_op","op_use",r[a]);break;case 8:this.$=ct.createNode(ht(o[a-1]),"node_op","op_delete",r[a]);break;case 9:this.$=ct.createNode(ht(o[a-1]),"node_op","op_return",void 0);break;case 10:this.$=ct.createNode(ht(o[a-2]),"node_op","op_return",r[a-1]);break;case 11:case 14:this.$=ct.createNode(ht(o[a]),"node_op","op_none");break;case 12:this.$=r[a-1],this.$.needsBrackets=!0;break;case 13:this.$=ct.createNode(ht(o[a-1]),"node_op","op_none",r[a-1],r[a]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=r[a];break;case 22:case 65:case 93:this.$=r[a-1];break;case 25:this.$=ct.createNode(ht(o[a-2]),"node_op","op_assign",r[a-2],r[a]),this.$.isMath=!1;break;case 27:this.$=ct.createNode(ht(o[a-4]),"node_op","op_conditional",r[a-4],r[a-2],r[a]),this.$.isMath=!1;break;case 29:this.$=ct.createNode(ht(o[a-2]),"node_op","op_or",r[a-2],r[a]),this.$.isMath=!1;break;case 31:this.$=ct.createNode(ht(o[a-2]),"node_op","op_and",r[a-2],r[a]),this.$.isMath=!1;break;case 33:this.$=ct.createNode(ht(o[a-2]),"node_op","op_equ",r[a-2],r[a]),this.$.isMath=!1;break;case 34:this.$=ct.createNode(ht(o[a-2]),"node_op","op_neq",r[a-2],r[a]),this.$.isMath=!1;break;case 35:this.$=ct.createNode(ht(o[a-2]),"node_op","op_approx",r[a-2],r[a]),this.$.isMath=!1;break;case 37:this.$=ct.createNode(ht(o[a-2]),"node_op","op_lot",r[a-2],r[a]),this.$.isMath=!1;break;case 38:this.$=ct.createNode(ht(o[a-2]),"node_op","op_grt",r[a-2],r[a]),this.$.isMath=!1;break;case 39:this.$=ct.createNode(ht(o[a-2]),"node_op","op_loe",r[a-2],r[a]),this.$.isMath=!1;break;case 40:this.$=ct.createNode(ht(o[a-2]),"node_op","op_gre",r[a-2],r[a]),this.$.isMath=!1;break;case 42:this.$=ct.createNode(ht(o[a-2]),"node_op","op_add",r[a-2],r[a]),this.$.isMath=!0;break;case 43:this.$=ct.createNode(ht(o[a-2]),"node_op","op_sub",r[a-2],r[a]),this.$.isMath=!0;break;case 45:this.$=ct.createNode(ht(o[a-2]),"node_op","op_mul",r[a-2],r[a]),this.$.isMath=!0;break;case 46:this.$=ct.createNode(ht(o[a-2]),"node_op","op_div",r[a-2],r[a]),this.$.isMath=!0;break;case 47:this.$=ct.createNode(ht(o[a-2]),"node_op","op_mod",r[a-2],r[a]),this.$.isMath=!0;break;case 49:this.$=ct.createNode(ht(o[a-2]),"node_op","op_exp",r[a-2],r[a]),this.$.isMath=!0;break;case 51:this.$=ct.createNode(ht(o[a-1]),"node_op","op_not",r[a]),this.$.isMath=!1;break;case 53:this.$=ct.createNode(ht(o[a-1]),"node_op","op_neg",r[a]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=r[a],this.$.isMath=!1;break;case 59:case 91:this.$=ct.createNode(ht(o[a-2]),"node_op","op_property",r[a-2],r[a]),this.$.isMath=!0;break;case 60:case 90:this.$=ct.createNode(ht(o[a-3]),"node_op","op_extvalue",r[a-3],r[a-1]),this.$.isMath=!0;break;case 61:this.$=ct.createNode(ht(o[a]),"node_var",r[a]);break;case 69:this.$=r[a],this.$.isMath=!0;break;case 70:this.$=ct.createNode(ht(o[a]),"node_const",null);break;case 71:this.$=ct.createNode(ht(o[a]),"node_const_bool",!0);break;case 72:this.$=ct.createNode(ht(o[a]),"node_const_bool",!1);break;case 73:this.$=ct.createNode(ht(o[a]),"node_str",r[a].substring(1,r[a].length-1));break;case 74:this.$=ct.createNode(ht(o[a]),"node_const",parseFloat(r[a]));break;case 75:this.$=ct.createNode(ht(o[a]),"node_const",NaN);break;case 76:this.$=ct.createNode(ht(o[a]),"node_const",1/0);break;case 77:this.$=ct.createNode(ht(o[a-1]),"node_op","op_array",[]);break;case 78:this.$=ct.createNode(ht(o[a-2]),"node_op","op_array",r[a-1]);break;case 79:this.$=ct.createNode(ht(o[a-1]),"node_op","op_emptyobject",{});break;case 80:this.$=ct.createNode(ht(o[a-2]),"node_op","op_proplst_val",r[a-1]);break;case 82:this.$=ct.createNode(ht(o[a-2]),"node_op","op_proplst",r[a-2],r[a]);break;case 83:this.$=ct.createNode(ht(o[a-2]),"node_op","op_prop",r[a-2],r[a]);break;case 87:case 89:this.$=ct.createNode(ht(o[a-1]),"node_op","op_execfun",r[a-1],r[a]),this.$.isMath=!0;break;case 88:this.$=ct.createNode(ht(o[a-2]),"node_op","op_execfun",r[a-2],r[a-1],r[a],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[r[a]];break;case 95:case 99:case 104:this.$=r[a-2].concat(r[a]);break;case 96:this.$=ct.createNode(ht(o[a]),"node_var",r[a]),this.$.isMath=!0;break;case 100:this.$=ct.createNode(ht(o[a-3]),"node_op","op_function",[],r[a]),this.$.isMath=!1;break;case 101:this.$=ct.createNode(ht(o[a-4]),"node_op","op_function",r[a-2],r[a]),this.$.isMath=!1;break;case 102:this.$=ct.createNode(ht(o[a-5]),"node_op","op_map",r[a-3],r[a])}},table:[e([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],i,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:s,8:n,9:20,11:4,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{1:[2,1]},e(T,[2,13]),e(A,[2,15]),e(A,[2,16]),e(A,[2,17]),e(A,[2,18]),e(A,[2,19]),e(A,[2,20]),e(A,[2,21]),e([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],i,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:s,8:n,9:20,11:65,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{20:[1,66]},{20:[1,67]},{8:n,9:69,16:[1,68],20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{16:[1,70]},e(A,[2,11]),e(O,[2,23]),e(O,[2,24]),e([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],M,{32:[1,71],57:N}),e([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),e(L,[2,54],{88:77,8:D,64:[1,75],65:[1,76]}),e(L,[2,55],{88:79,8:D,64:[1,81],65:[1,80]}),e(j,[2,28],{39:R}),e(O,[2,56]),e(O,[2,57]),e(O,[2,58]),e(I,[2,30],{41:B,42:F,43:Y}),e(O,[2,61]),e(O,[2,62]),e(O,[2,63]),e(O,[2,64]),{8:n,9:86,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:[1,87]},{8:[1,88]},e(z,[2,32],{45:q,46:X,47:U,48:G}),e(O,[2,66]),e(O,[2,67]),e(O,[2,68]),e(O,[2,69]),{20:H,72:98,73:99,77:C,78:_,79:w,80:S,83:[1,93],84:94,85:95,87:96},{8:n,20:h,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,81:101,82:P,91:k,93:E},e(J,[2,36],{50:$,51:V}),e(O,[2,70]),e(O,[2,71]),e(O,[2,72]),e(O,[2,73]),e(O,[2,74]),e(O,[2,75]),e(O,[2,76]),e(W,[2,41],{53:K,54:Q,55:Z}),e(O,[2,44]),e(O,[2,50]),{8:n,20:h,31:109,50:f,51:m,52:108,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:110,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:111,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{6:6,7:s,8:n,9:20,11:4,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:113,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:114,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:115,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{14:[1,116]},e(A,[2,7]),e(A,[2,8]),e(A,[2,9]),{16:[1,117]},e(A,[2,22]),{8:n,20:h,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:119,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,36:121,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{20:[1,122]},{8:n,9:123,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(O,[2,87],{89:124,90:125,68:127,20:tt,82:P}),{8:n,10:[1,128],20:h,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,81:129,82:P,91:k,93:E},e(O,[2,89]),{8:n,9:130,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{20:[1,131]},{8:n,20:h,31:109,38:132,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,40:133,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,40:134,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,40:135,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{10:[1,136]},{10:[1,137],20:et,92:138},{20:et,92:140},{8:n,20:h,31:109,44:141,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,44:142,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,44:143,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,44:144,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(O,[2,79]),{83:[1,145],86:[1,146]},e(it,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},e(O,[2,77]),{66:[1,148],86:st},e(nt,[2,98]),{8:n,20:h,31:109,49:150,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,49:151,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:152,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:153,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,31:109,50:f,51:m,52:154,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(O,[2,51]),e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],M,{57:N}),e(O,[2,52]),e(O,[2,53]),e([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},e(A,[2,10]),e(O,[2,25]),e(O,[2,49]),{35:[1,159]},e(j,[2,29],{39:R}),e(O,[2,59]),{66:[1,160]},e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),e(O,[2,94]),e(O,[2,96]),e(O,[2,97]),e(rt,[2,92]),{10:[1,162],86:st},{66:[1,163]},e(O,[2,91]),e(I,[2,31],{41:B,42:F,43:Y}),e(z,[2,33],{45:q,46:X,47:U,48:G}),e(z,[2,34],{45:q,46:X,47:U,48:G}),e(z,[2,35],{45:q,46:X,47:U,48:G}),e(O,[2,65]),{25:164,26:p},{10:[1,165],86:ot},e(at,[2,103]),{10:[1,167],86:ot},e(J,[2,37],{50:$,51:V}),e(J,[2,38],{50:$,51:V}),e(J,[2,39],{50:$,51:V}),e(J,[2,40],{50:$,51:V}),e(O,[2,80]),{20:H,72:98,73:99,77:C,78:_,79:w,80:S,85:168,87:96},{8:n,20:h,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(O,[2,78]),{8:n,20:h,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(W,[2,42],{53:K,54:Q,55:Z}),e(W,[2,43],{53:K,54:Q,55:Z}),e(O,[2,45]),e(O,[2,46]),e(O,[2,47]),{6:6,7:s,8:n,9:20,11:171,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{6:6,7:s,8:n,9:20,11:172,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:173,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:174,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,20:h,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(O,[2,60]),{20:tt,68:127,82:P,90:176},e(rt,[2,93]),e(O,[2,90]),e(O,[2,100]),{25:177,26:p},{20:[1,178]},{94:[1,179]},e(it,[2,82]),e(it,[2,83]),e(nt,[2,99]),e(T,[2,2],{12:[1,180]}),e(A,[2,4]),{16:[1,181]},{10:[1,182]},e(O,[2,27]),e(O,[2,95]),e(O,[2,101]),e(at,[2,104]),{8:n,9:183,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{6:6,7:s,8:n,9:20,11:184,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{8:n,9:185,20:h,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},{16:[1,186]},e(O,[2,102]),e(A,[2,3]),{10:[1,187]},e(A,[2,6]),{6:6,7:s,8:n,9:20,11:188,13:7,14:r,15:o,16:a,17:l,18:8,19:c,20:h,21:u,22:9,23:d,24:11,25:5,26:p,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:m,52:56,56:57,58:g,59:26,60:27,61:29,62:30,63:31,65:b,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:y,75:v,76:x,77:C,78:_,79:w,80:S,82:P,91:k,93:E},e(A,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(t,e){if(!e.recoverable){var i=new Error(t);throw i.hash=e,i}this.trace(t)},parse:function(t){var e=this,i=[0],s=[null],n=[],r=this.table,o="",a=0,l=0,c=0,h=n.slice.call(arguments,1),u=Object.create(this.lexer),d={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(d.yy[p]=this.yy[p]);u.setInput(t,d.yy),d.yy.lexer=u,d.yy.parser=this,void 0===u.yylloc&&(u.yylloc={});var f=u.yylloc;n.push(f);var m=u.options&&u.options.ranges;this.parseError="function"==typeof d.yy.parseError?d.yy.parseError:Object.getPrototypeOf(this).parseError;for(var g,b,y,v,x,C,_,w,S=function(){var t;return"number"!=typeof(t=u.lex()||1)&&(t=e.symbols_[t]||t),t},P={};;){if(this.defaultActions[y=i[i.length-1]]?v=this.defaultActions[y]:(null!=g||(g=S()),v=r[y]&&r[y][g]),void 0===v||!v.length||!v[0]){var k="";for(C in w=[],r[y])this.terminals_[C]&&C>2&&w.push("'"+this.terminals_[C]+"'");k=u.showPosition?"Parse error on line "+(a+1)+":\n"+u.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(k,{text:u.match,token:this.terminals_[g]||g,line:u.yylineno,loc:f,expected:w})}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+g);switch(v[0]){case 1:i.push(g),s.push(u.yytext),n.push(u.yylloc),i.push(v[1]),g=null,b?(g=b,b=null):(l=u.yyleng,o=u.yytext,a=u.yylineno,f=u.yylloc,c>0&&c--);break;case 2:if(P.$=s[s.length-(_=this.productions_[v[1]][1])],P._$={first_line:n[n.length-(_||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(_||1)].first_column,last_column:n[n.length-1].last_column},m&&(P._$.range=[n[n.length-(_||1)].range[0],n[n.length-1].range[1]]),void 0!==(x=this.performAction.apply(P,[o,l,a,d.yy,v[1],s,n].concat(h))))return x;_&&(i=i.slice(0,-1*_*2),s=s.slice(0,-1*_),n=n.slice(0,-1*_)),i.push(this.productions_[v[1]][0]),s.push(P.$),n.push(P._$),i.push(r[i[i.length-2]][i[i.length-1]]);break;case 3:return!0}}return!0}},ct={node:function(t,e,i){return{type:t,value:e,children:i}},createNode:function(t,e,i,s){var n,r=this.node(e,i,[]);for(n=3;n<arguments.length;n++)r.children.push(arguments[n]);return r.line=t[0],r.col=t[1],r.eline=t[2],r.ecol=t[3],r}},ht=function(t){return[t.first_line,t.first_column,t.last_line,t.last_column]};return lt.lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===s.length?this.yylloc.first_column:0)+s[s.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var i,s,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),(s=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],i=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return i;if(this._backtrack){for(var r in n)this[r]=n[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,i,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),r=0;r<n.length;r++)if((i=this._input.match(this.rules[n[r]]))&&(!e||i[0].length>e[0].length)){if(e=i,s=r,this.options.backtrack_lexer){if(!1!==(t=this.test_match(i,n[r])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,n[s]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,i,s){switch(i){case 0:break;case 1:case 2:return 78;case 3:case 4:return 77;case 5:case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}},t.prototype=lt,lt.Parser=t,new t}();return void 0!==require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode})),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],(function(t,e,i,s,n,r,o,a,l,c,h,u){"use strict";return t.Point=function(t,e,i){this.constructor(t,i,o.OBJECT_TYPE_POINT,o.OBJECT_CLASS_POINT),this.element=this.board.select(i.anchor),this.coordsConstructor(e),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},t.Point.prototype=new a,c.copyPrototypeMethods(t.Point,u,"coordsConstructor"),t.extend(t.Point.prototype,{hasPoint:function(t,e){var i,s=this.coords.scrCoords,n=c.evaluate(this.visProp.sizeunit);return i=parseFloat(c.evaluate(this.visProp.size)),"user"===n&&(i*=Math.sqrt(this.board.unitX*this.board.unitY)),(i+=.5*parseFloat(c.evaluate(this.visProp.strokewidth)))<this.board.options.precision.hasPoint&&(i=this.board.options.precision.hasPoint),Math.abs(s[1]-t)<i+2&&Math.abs(s[2]-e)<i+2},update:function(t){return this.needsUpdate?(this.updateCoords(t),c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var t,e;if(0===this.transformations.length||null===this.baseElement)return this;for(t=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(o.COORDS_BY_USER,t),e=1;e<this.transformations.length;e++)this.coords.setCoordinates(o.COORDS_BY_USER,this.transformations[e].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(t,e,i,n){var r;t=this.board.select(t),e=this.board.select(e),r=s.intersectionFunction(this.board,t,e,i,n,c.evaluate(this.visProp.alwaysintersect)),this.addConstraint([r]);try{t.addChild(this),e.addChild(this)}catch(i){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof t+"' and '"+typeof e+"'.")}this.type=o.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[t.id,e.id,i,n],this.generatePolynomial=function(){var i=t.generatePolynomial(this),s=e.generatePolynomial(this);return 0===i.length||0===s.length?[]:[i[0],s[0]]},this.prepareUpdate().update()},setStyle:function(t){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][t],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][t],this.board.renderer.changePointStyle(this),this},normalizeFace:function(i){return t.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),e.normalizePointFace(i)},face:function(e){t.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:e})},size:function(e){t.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:e})},cloneToBackground:function(){var t={};return t.id=this.id+"T"+this.numTraces,this.numTraces+=1,t.coords=this.coords,t.visProp=c.deepCopy(this.visProp,this.visProp.traceattributes,!0),t.visProp.layer=this.board.options.layer.trace,t.elementClass=o.OBJECT_CLASS_POINT,t.board=this.board,c.clearVisPropOld(t),t.visPropCalc={visible:c.evaluate(t.visProp.visible)},this.board.renderer.drawPoint(t),this.traces[t.id]=t.rendNode,this}}),t.createPoint=function(e,i,s){var n,r;if(r=c.copyAttributes(s,e.options,"point"),!(n=u.create(t.Point,e,i,r)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return n},t.createGlider=function(t,e,i){var s,n,r=c.copyAttributes(i,t.options,"glider");return n=1===e.length?[0,0]:e.slice(0,2),(s=t.create("point",n,r)).makeGlider(e[e.length-1]),s},t.createIntersectionPoint=function(t,e,i){var n,r,a,l,h,u,d=c.copyAttributes(i,t.options,"intersection");e.push(0,0),r=t.select(e[0]),a=t.select(e[1]),h=e[2]||0,u=e[3]||0,n=t.create("point",[0,0,0],d),l=s.intersectionFunction(t,r,a,h,u,n.visProp.alwaysintersect),n.addConstraint([l]);try{r.addChild(n),a.addChild(n)}catch(t){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.")}return n.type=o.OBJECT_TYPE_INTERSECTION,n.elType="intersection",n.setParents([r.id,a.id]),n.intersectionNumbers=[h,u],n.getParents=function(){return this.parents.concat(this.intersectionNumbers)},n.generatePolynomial=function(){var t=r.generatePolynomial(n),e=a.generatePolynomial(n);return 0===t.length||0===e.length?[]:[t[0],e[0]]},n},t.createOtherIntersectionPoint=function(t,e,n){var r,a,l,h;if(3!==e.length||!c.isPoint(e[2])||e[0].elementClass!==o.OBJECT_CLASS_LINE&&e[0].elementClass!==o.OBJECT_CLASS_CIRCLE||e[1].elementClass!==o.OBJECT_CLASS_LINE&&e[1].elementClass!==o.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof e[0]+"',  '"+typeof e[1]+"'and  '"+typeof e[2]+"'.\nPossible parent types: [circle|line,circle|line,point]");return a=t.select(e[0]),l=t.select(e[1]),h=t.select(e[2]),(r=t.create("point",[function(){var t=s.meet(a.stdform,l.stdform,0,a.board);return Math.abs(h.X()-t.usrCoords[1])>i.eps||Math.abs(h.Y()-t.usrCoords[2])>i.eps||Math.abs(h.Z()-t.usrCoords[0])>i.eps?t:s.meet(a.stdform,l.stdform,1,a.board)}],n)).type=o.OBJECT_TYPE_INTERSECTION,r.elType="otherintersection",r.setParents([a.id,l.id,h]),a.addChild(r),l.addChild(r),r.generatePolynomial=function(){var t=a.generatePolynomial(r),e=l.generatePolynomial(r);return 0===t.length||0===e.length?[]:[t[0],e[0]]},r},t.createPolePoint=function(e,i,s){var n,r,a,l,c,h,u;if(i.length>1&&(l=i[0].type===o.OBJECT_TYPE_CONIC||i[0].elementClass===o.OBJECT_CLASS_CIRCLE,c=i[1].type===o.OBJECT_TYPE_CONIC||i[1].elementClass===o.OBJECT_CLASS_CIRCLE,h=i[0].elementClass===o.OBJECT_CLASS_LINE,u=i[1].elementClass===o.OBJECT_CLASS_LINE),2!==i.length||!(l&&u||h&&c))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent type: [conic|circle,line], [line,conic|circle]");return u?(r=e.select(i[0]),a=e.select(i[1])):(r=e.select(i[1]),a=e.select(i[0])),(n=e.create("point",[function(){var e=r.quadraticform,i=a.stdform.slice(0,3);return[t.Math.Numerics.det([i,e[1],e[2]]),t.Math.Numerics.det([e[0],i,e[2]]),t.Math.Numerics.det([e[0],e[1],i])]}],s)).elType="polepoint",n.setParents([r.id,a.id]),r.addChild(n),a.addChild(n),n},t.registerElement("point",t.createPoint),t.registerElement("glider",t.createGlider),t.registerElement("intersection",t.createIntersectionPoint),t.registerElement("otherintersection",t.createOtherIntersectionPoint),t.registerElement("polepoint",t.createPolePoint),{Point:t.Point,createPoint:t.createPoint,createGlider:t.createGlider,createIntersection:t.createIntersectionPoint,createOtherIntersection:t.createOtherIntersectionPoint,createPolePoint:t.createPolePoint}})),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],(function(t,e,i,s,n,r,o,a,l,c){"use strict";return t.Line=function(e,i,s,n){this.constructor(e,n,r.OBJECT_TYPE_LINE,r.OBJECT_CLASS_LINE),this.point1=this.board.select(i),this.point2=this.board.select(s),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=t.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},t.Line.prototype=new a,t.extend(t.Line.prototype,{hasPoint:function(t,s){var n,a,c,h,u,d,p,f,m=[],g=[1,t,s],b=l.evaluate(this.visProp.strokewidth);return f=this.board.options.precision.hasPoint+.5*b,m[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,m[1]=this.stdform[1]/this.board.unitX,m[2]=this.stdform[2]/-this.board.unitY,n=i.distPointLine(g,m),!(isNaN(n)||n>f||(!l.evaluate(this.visProp.straightfirst)||!l.evaluate(this.visProp.straightlast))&&(c=this.point1.coords,h=this.point2.coords,a=[0,m[1],m[2]],a=e.crossProduct(a,g),a=e.crossProduct(a,m),a[1]/=a[0],a[2]/=a[0],a[0]=1,a=new o(r.COORDS_BY_SCREEN,a.slice(1),this.board).usrCoords,u=c.distance(r.COORDS_BY_USER,h),c=c.usrCoords.slice(0),h=h.usrCoords.slice(0),u<e.eps?d=0:(u===Number.POSITIVE_INFINITY&&(u=1/e.eps,Math.abs(h[0])<e.eps?(u/=i.distance([0,0,0],h),h=[1,c[1]+h[1]*u,c[2]+h[2]*u]):(u/=i.distance([0,0,0],c),c=[1,h[1]+c[1]*u,h[2]+c[2]*u])),p=1,u=h[p]-c[p],Math.abs(u)<e.eps&&(p=2,u=h[p]-c[p]),d=(a[p]-c[p])/u),!l.evaluate(this.visProp.straightfirst)&&d<0||!l.evaluate(this.visProp.straightlast)&&d>1))},update:function(){var t;return this.needsUpdate?(this.constrained&&(l.isFunction(this.funps)?(t=this.funps())&&t.length&&2===t.length&&(this.point1=t[0],this.point2=t[1]):(l.isFunction(this.funp1)&&(t=this.funp1(),l.isPoint(t)?this.point1=t:t&&t.length&&2===t.length&&this.point1.setPositionDirectly(r.COORDS_BY_USER,t)),l.isFunction(this.funp2)&&(t=this.funp2(),l.isPoint(t)?this.point2=t:t&&t.length&&2===t.length&&this.point2.setPositionDirectly(r.COORDS_BY_USER,t)))),this.updateSegmentFixedLength(),this.updateStdform(),l.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var t,i,s,n,o,a,c,h;return this.hasFixedLength?(t=this.point1.Dist(this.point2),i=this.fixedLength(),s=this.fixedLengthOldCoords[0].distance(r.COORDS_BY_USER,this.point1.coords),n=this.fixedLengthOldCoords[1].distance(r.COORDS_BY_USER,this.point2.coords),(s>e.eps||n>e.eps||t!==i)&&(o=this.point1.isDraggable&&this.point1.type!==r.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point1.visProp.fixed),a=this.point2.isDraggable&&this.point2.type!==r.OBJECT_TYPE_GLIDER&&!l.evaluate(this.point2.visProp.fixed),t>e.eps?s>n&&a||s<=n&&a&&!o?(this.point2.setPositionDirectly(r.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*i/t,this.point1.Y()+(this.point2.Y()-this.point1.Y())*i/t]),this.point2.fullUpdate()):(s<=n&&o||s>n&&o&&!a)&&(this.point1.setPositionDirectly(r.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*i/t,this.point2.Y()+(this.point1.Y()-this.point2.Y())*i/t]),this.point1.fullUpdate()):(c=Math.random()-.5,h=Math.random()-.5,t=Math.sqrt(c*c+h*h),a?(this.point2.setPositionDirectly(r.COORDS_BY_USER,[this.point1.X()+c*i/t,this.point1.Y()+h*i/t]),this.point2.fullUpdate()):o&&(this.point1.setPositionDirectly(r.COORDS_BY_USER,[this.point2.X()+c*i/t,this.point2.Y()+h*i/t]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(r.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(r.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var t=e.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=t[0],this.stdform[1]=t[1],this.stdform[2]=t[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&e.innerProduct(this.stdform,this.stdform,3)>=e.eps*e.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(t){var e=this.point1.symbolic.x,i=this.point1.symbolic.y,s=this.point2.symbolic.x,n=this.point2.symbolic.y,r=t.symbolic.x,o=t.symbolic.y;return[["(",i,")*(",r,")-(",i,")*(",s,")+(",o,")*(",s,")-(",e,")*(",o,")+(",e,")*(",n,")-(",r,")*(",n,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=e.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=e.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(t,e){return this.visProp.straightfirst=t,this.visProp.straightlast=e,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new o(r.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(t){l.exists(this.label)&&(this.label.relativeCoords=new o(r.COORDS_BY_SCREEN,[t[0],-t[1]],this.board))},getLabelAnchor:function(){var t,s,n=0,a=new o(r.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),c=new o(r.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),h=l.evaluate(this.visProp.straightfirst),u=l.evaluate(this.visProp.straightlast);if((h||u)&&i.calcStraight(this,a,c,0),a=a.scrCoords,c=c.scrCoords,!l.exists(this.label))return new o(r.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(l.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":a[1]<=c[1]?(t=a[1],s=a[2]):(t=c[1],s=c[2]);break;case"rt":case"lrt":case"urt":a[1]>c[1]?(t=a[1],s=a[2]):(t=c[1],s=c[2]);break;default:t=.5*(a[1]+c[1]),s=.5*(a[2]+c[2])}return(h||u)&&(l.exists(this.label)&&(n=l.evaluate(this.label.visProp.fontsize)),Math.abs(t)<e.eps?t=n+0:this.board.canvasWidth+e.eps>t&&t>this.board.canvasWidth-n-e.eps&&(t=this.board.canvasWidth-n),e.eps+n>s&&s>-e.eps?s=n:this.board.canvasHeight+e.eps>s&&s>this.board.canvasHeight-n-e.eps&&(s=this.board.canvasHeight-n)),new o(r.COORDS_BY_SCREEN,[t,s],this.board)},cloneToBackground:function(){var t,e,i,s={};return s.id=this.id+"T"+this.numTraces,s.elementClass=r.OBJECT_CLASS_LINE,this.numTraces++,s.point1=this.point1,s.point2=this.point2,s.stdform=this.stdform,s.board=this.board,s.visProp=l.deepCopy(this.visProp,this.visProp.traceattributes,!0),s.visProp.layer=this.board.options.layer.trace,l.clearVisPropOld(s),s.visPropCalc={visible:l.evaluate(s.visProp.visible)},e=this.getSlope(),t=this.getRise(),s.getSlope=function(){return e},s.getRise=function(){return t},i=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(s),this.board.renderer.enhancedRendering=i,this.traces[s.id]=s.rendNode,this},addTransform:function(t){var e,i=l.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.point1.transformations.push(i[e]),this.point2.transformations.push(i[e]);return this},snapToGrid:function(t){var e,s,a,c,h,u,d,p;return l.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):l.exists(t)&&(d=l.evaluate(this.visProp.snapsizex),p=l.evaluate(this.visProp.snapsizey),h=(e=new o(r.COORDS_BY_SCREEN,[t.Xprev,t.Yprev],this.board)).usrCoords[1],u=e.usrCoords[2],d<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(d=(c=this.board.defaultAxes.x.defaultTicks).ticksDelta*(l.evaluate(c.visProp.minorticks)+1)),p<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(p=(c=this.board.defaultAxes.y.defaultTicks).ticksDelta*(l.evaluate(c.visProp.minorticks)+1)),d>0&&p>0&&(s=i.projectPointToLine({coords:e},this,this.board),a=n.subtract([1,Math.round(h/d)*d,Math.round(u/p)*p],s.usrCoords),this.board.create("transform",a.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var t=l.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(t),this.point2.handleSnapToPoints(t)),this},X:function(t){var i,s=this.stdform[2];return i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],t=2*(t-.5),(1-Math.abs(t))*i-t*s},Y:function(t){var i,s=this.stdform[1];return i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],t=2*(t-.5),(1-Math.abs(t))*i+t*s},Z:function(t){var i=Math.abs(this.point1.coords.usrCoords[0])>e.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return t=2*(t-.5),(1-Math.abs(t))*i},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var t=this.point1.coords.usrCoords,e=this.point2.coords.usrCoords;return[Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[1],e[1]),Math.min(t[2],e[2])]},addTicks:function(t){return""!==t.id&&l.exists(t.id)||(t.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(t),this.ticks.push(t),t.id},remove:function(){this.removeAllTicks(),a.prototype.remove.call(this)},removeAllTicks:function(){var t;for(t=this.ticks.length;t>0;t--)this.removeTicks(this.ticks[t-1]);this.ticks=[],this.board.update()},removeTicks:function(t){var e,i;for(l.exists(this.defaultTicks)&&this.defaultTicks===t&&(this.defaultTicks=null),e=this.ticks.length;e>0;e--)if(this.ticks[e-1]===t){if(this.board.removeObject(this.ticks[e-1]),this.ticks[e-1].ticks)for(i=0;i<this.ticks[e-1].ticks.length;i++)l.exists(this.ticks[e-1].labels[i])&&this.board.removeObject(this.ticks[e-1].labels[i]);delete this.ticks[e-1];break}}}),t.createLine=function(e,i,s){var n,r,o,a,h,u,d,p=[],f=!1,m=!1;if(2===i.length){if(l.isArray(i[0])&&i[0].length>1)u=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",i[0],u);else if(l.isString(i[0])||l.isPoint(i[0]))o=e.select(i[0]);else if(l.isFunction(i[0])&&l.isPoint(i[0]()))o=i[0](),m=!0;else if(l.isFunction(i[0])&&i[0]().length&&i[0]().length>=2)u=l.copyAttributes(s,e.options,"line","point1"),o=c.createPoint(e,i[0](),u),m=!0;else{if(!l.isObject(i[0])||!l.isTransformationOrArray(i[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");f=!0,u=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",[i[0].point1,i[1]],u)}if(f)u=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",[i[0].point2,i[1]],u);else if(l.isArray(i[1])&&i[1].length>1)u=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",i[1],u);else if(l.isString(i[1])||l.isPoint(i[1]))a=e.select(i[1]);else if(l.isFunction(i[1])&&l.isPoint(i[1]()))a=i[1](),m=!0;else{if(!(l.isFunction(i[1])&&i[1]().length&&i[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");u=l.copyAttributes(s,e.options,"line","point2"),a=c.createPoint(e,i[1](),u),m=!0}u=l.copyAttributes(s,e.options,"line"),r=new t.Line(e,o,a,u),m?(r.constrained=!0,r.funp1=i[0],r.funp2=i[1]):f||(r.isDraggable=!0),r.setParents([o.id,a.id])}else if(3===i.length){for(d=!0,h=0;h<3;h++)if(l.isNumber(i[h]))p[h]=l.createFunction(i[h]);else{if(!l.isFunction(i[h]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");p[h]=i[h],d=!1}u=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",d?[p[2]()*p[2]()+p[1]()*p[1](),p[2]()-p[1]()*p[0]()+p[2](),-p[1]()-p[2]()*p[0]()-p[1]()]:[function(){return.5*(p[2]()*p[2]()+p[1]()*p[1]())},function(){return.5*(p[2]()-p[1]()*p[0]()+p[2]())},function(){return.5*(-p[1]()-p[2]()*p[0]()-p[1]())}],u),u=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",d?[p[2]()*p[2]()+p[1]()*p[1](),-p[1]()*p[0]()+p[2](),-p[2]()*p[0]()-p[1]()]:[function(){return p[2]()*p[2]()+p[1]()*p[1]()},function(){return-p[1]()*p[0]()+p[2]()},function(){return-p[2]()*p[0]()-p[1]()}],u),o.prepareUpdate().update(),a.prepareUpdate().update(),u=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,o,a,u)).isDraggable=d,r.setParents([o,a])}else if(1===i.length&&l.isFunction(i[0])&&2===i[0]().length&&l.isPoint(i[0]()[0])&&l.isPoint(i[0]()[1]))n=i[0](),u=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,n[0],n[1],u)).constrained=!0,r.funps=i[0],r.setParents(n);else{if(!(1===i.length&&l.isFunction(i[0])&&3===i[0]().length&&l.isNumber(i[0]()[0])&&l.isNumber(i[0]()[1])&&l.isNumber(i[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");n=i[0],u=l.copyAttributes(s,e.options,"line","point1"),o=e.create("point",[function(){var t=n();return[.5*(t[2]*t[2]+t[1]*t[1]),.5*(t[2]-t[1]*t[0]+t[2]),.5*(-t[1]-t[2]*t[0]-t[1])]}],u),u=l.copyAttributes(s,e.options,"line","point2"),a=e.create("point",[function(){var t=n();return[t[2]*t[2]+t[1]*t[1],-t[1]*t[0]+t[2],-t[2]*t[0]-t[1]]}],u),u=l.copyAttributes(s,e.options,"line"),(r=new t.Line(e,o,a,u)).constrained=!0,r.funps=i[0],r.setParents([o,a])}return r},t.registerElement("line",t.createLine),t.createSegment=function(t,e,i){var s,n;if(i.straightFirst=!1,i.straightLast=!1,n=l.copyAttributes(i,t.options,"segment"),s=t.create("line",e.slice(0,2),n),3===e.length){if(s.hasFixedLength=!0,l.isNumber(e[2]))s.fixedLength=function(){return e[2]};else{if(!l.isFunction(e[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof e[2]+"'.\nPossible third parent types: number or function");s.fixedLength=e[2]}s.getParents=function(){return this.parents.concat(this.fixedLength())},s.fixedLengthOldCoords=[],s.fixedLengthOldCoords[0]=new o(r.COORDS_BY_USER,s.point1.coords.usrCoords.slice(1,3),t),s.fixedLengthOldCoords[1]=new o(r.COORDS_BY_USER,s.point2.coords.usrCoords.slice(1,3),t)}return s.elType="segment",s},t.registerElement("segment",t.createSegment),t.createArrow=function(t,e,i){var s;return i.firstArrow=!1,i.lastArrow=!0,(s=t.create("line",e,i).setStraight(!1,!1)).type=r.OBJECT_TYPE_VECTOR,s.elType="arrow",s},t.registerElement("arrow",t.createArrow),t.createAxis=function(t,e,i){var s,n,o,a,c;if(!l.isArray(e[0])&&!l.isPoint(e[0])||!l.isArray(e[1])&&!l.isPoint(e[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");for(a in s=l.copyAttributes(i,t.options,"axis"),(o=t.create("line",e,s)).type=r.OBJECT_TYPE_AXIS,o.isDraggable=!1,o.point1.isDraggable=!1,o.point2.isDraggable=!1,o.ancestors)o.ancestors.hasOwnProperty(a)&&(o.ancestors[a].type=r.OBJECT_TYPE_AXISPOINT);return n=l.copyAttributes(i,t.options,"axis","ticks"),c=l.exists(n.ticksdistance)?n.ticksdistance:l.isArray(n.ticks)?n.ticks:1,o.defaultTicks=t.create("ticks",[o,c],n),o.defaultTicks.dump=!1,o.elType="axis",o.subs={ticks:o.defaultTicks},o.inherits.push(o.defaultTicks),o},t.registerElement("axis",t.createAxis),t.createTangent=function(t,i,n){var o,a,c,h,u,d,p;if(1===i.length)a=(o=i[0]).slideObject;else{if(2!==i.length)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(l.isPoint(i[0]))o=i[0],a=i[1];else{if(!l.isPoint(i[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");a=i[0],o=i[1]}}if(a.elementClass===r.OBJECT_CLASS_LINE?(p=t.create("line",[a.point1,a.point2],n)).glider=o:a.elementClass===r.OBJECT_CLASS_CURVE&&a.type!==r.OBJECT_TYPE_CONIC?"plot"!==l.evaluate(a.visProp.curvetype)?(c=a.X,h=a.Y,p=t.create("line",[function(){return-o.X()*s.D(h)(o.position)+o.Y()*s.D(c)(o.position)},function(){return s.D(h)(o.position)},function(){return-s.D(c)(o.position)}],n),o.addChild(p),p.glider=o):(p=t.create("line",[function(){var t,e,i=Math.floor(o.position);return i===a.numberPoints-1&&i--,i<0?1:(t=a.points[i].usrCoords)[2]*(e=a.points[i+1].usrCoords)[1]-t[1]*e[2]},function(){var t=Math.floor(o.position);return t===a.numberPoints-1&&t--,t<0?0:a.points[t+1].usrCoords[2]-a.points[t].usrCoords[2]},function(){var t=Math.floor(o.position);return t===a.numberPoints-1&&t--,t<0?0:a.points[t].usrCoords[1]-a.points[t+1].usrCoords[1]}],n),o.addChild(p),p.glider=o):a.type===r.OBJECT_TYPE_TURTLE?(p=t.create("line",[function(){var t=Math.floor(o.position);for(u=0;u<a.objects.length;u++)if((d=a.objects[u]).type===r.OBJECT_TYPE_CURVE){if(t<d.numberPoints)break;t-=d.numberPoints}return t===d.numberPoints-1&&t--,t<0?1:d.Y(t)*d.X(t+1)-d.X(t)*d.Y(t+1)},function(){var t=Math.floor(o.position);for(u=0;u<a.objects.length;u++)if((d=a.objects[u]).type===r.OBJECT_TYPE_CURVE){if(t<d.numberPoints)break;t-=d.numberPoints}return t===d.numberPoints-1&&t--,t<0?0:d.Y(t+1)-d.Y(t)},function(){var t=Math.floor(o.position);for(u=0;u<a.objects.length;u++)if((d=a.objects[u]).type===r.OBJECT_TYPE_CURVE){if(t<d.numberPoints)break;t-=d.numberPoints}return t===d.numberPoints-1&&t--,t<0?0:d.X(t)-d.X(t+1)}],n),o.addChild(p),p.glider=o):a.elementClass!==r.OBJECT_CLASS_CIRCLE&&a.type!==r.OBJECT_TYPE_CONIC||(p=t.create("line",[function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[0]},function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[1]},function(){return e.matVecMult(a.quadraticform,o.coords.usrCoords)[2]}],n),o.addChild(p),p.glider=o),!l.exists(p))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return p.elType="tangent",p.type=r.OBJECT_TYPE_TANGENT,p.setParents(i),p},t.createRadicalAxis=function(t,i,s){var n,o,a;if(2!==i.length||i[0].elementClass!==r.OBJECT_CLASS_CIRCLE||i[1].elementClass!==r.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent type: [circle,circle]");return o=t.select(i[0]),a=t.select(i[1]),(n=t.create("line",[function(){var t=o.stdform,i=a.stdform;return e.matVecMult(e.transpose([t.slice(0,3),i.slice(0,3)]),[i[3],-t[3]])}],s)).elType="radicalaxis",n.setParents([o.id,a.id]),o.addChild(n),a.addChild(n),n},t.createPolarLine=function(t,e,i){var s,n,o,a,c,h,u;if(e.length>1&&(a=e[0].type===r.OBJECT_TYPE_CONIC||e[0].elementClass===r.OBJECT_CLASS_CIRCLE,c=e[1].type===r.OBJECT_TYPE_CONIC||e[1].elementClass===r.OBJECT_CLASS_CIRCLE,h=l.isPoint(e[0]),u=l.isPoint(e[1])),2!==e.length||!(a&&u||h&&c))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent type: [conic|circle,point], [point,conic|circle]");return u?(n=t.select(e[0]),o=t.select(e[1])):(n=t.select(e[1]),o=t.select(e[0])),(s=t.create("tangent",[n,o],i)).elType="polarline",s},t.registerElement("tangent",t.createTangent),t.registerElement("polar",t.createTangent),t.registerElement("radicalaxis",t.createRadicalAxis),t.registerElement("polarline",t.createPolarLine),{Line:t.Line,createLine:t.createLine,createTangent:t.createTangent,createPolar:t.createTangent,createSegment:t.createSegment,createAxis:t.createAxis,createArrow:t.createArrow,createRadicalAxis:t.createRadicalAxis,createPolarLine:t.createPolarLine}})),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],(function(t,e,i,s,n,r,o,a,l,c,h,u){"use strict";return t.Curve=function(t,i,s){this.constructor(t,s,e.OBJECT_TYPE_CURVE,e.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=c.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,this.varname=c.exists(i[0])?i[0]:"x",this.xterm=i[1],this.yterm=i[2],this.generateTerm(this.varname,this.xterm,this.yterm,i[3],i[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),c.isString(this.xterm)&&this.notifyParents(this.xterm),c.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=c.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},t.Curve.prototype=new s,t.extend(t.Curve.prototype,{minX:function(){return"polar"===c.evaluate(this.visProp.curvetype)?0:new i(e.COORDS_BY_SCREEN,[0,0],this.board,!1).usrCoords[1]},maxX:function(){return"polar"===c.evaluate(this.visProp.curvetype)?2*Math.PI:new i(e.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(t){return NaN},Y:function(t){return NaN},Z:function(t){return 1},hasPoint:function(t,s,r){var o,l,h,u,d,p,f,m,g,b,y,v,x,C=[],_=c.evaluate(this.visProp.numberpointslow),w=(this.maxX()-this.minX())/_,S=this.board.options.precision.hasPoint,P=1/0;if(t=(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board,!1)).usrCoords[1],s=l.usrCoords[2],S+=.5*c.evaluate(this.visProp.strokewidth),S*=S,y=this.board.unitX*this.board.unitX,v=this.board.unitY*this.board.unitY,"parameter"===(x=c.evaluate(this.visProp.curvetype))||"polar"===x)for(this.transformations.length>0&&(this.updateTransformMatrix(),u=n.inverse(this.transformMat),t=(d=n.matVecMult(u,[1,t,s]))[1],s=d[2]),p=0,o=this.minX();p<_;p++){if((P=(t-(f=this.X(o,!0)))*(t-f)*y+(s-(m=this.Y(o,!0)))*(s-m)*v)<=S)return!0;o+=w}else if("plot"===x||"functiongraph"===x){for((!c.exists(r)||r<0)&&(r=0),c.exists(this.qdt)&&c.evaluate(this.visProp.useqdt)&&3!==this.bezierDegree?h=(g=(b=this.qdt.query(new i(e.COORDS_BY_USER,[t,s],this.board))).points).length:(g=this.points,h=this.numberPoints-1),p=r;p<h;p++)if(3===this.bezierDegree?C.push(a.projectCoordsToBeziersegment([1,t,s],this,p)):b?(g[p].prev&&(C=a.projectCoordsToSegment([1,t,s],g[p].prev.usrCoords,g[p].usrCoords)),g[p].next&&g[p+1]!==g[p].next&&(C=a.projectCoordsToSegment([1,t,s],g[p].usrCoords,g[p].next.usrCoords))):C=a.projectCoordsToSegment([1,t,s],g[p].usrCoords,g[p+1].usrCoords),C[1]>=0&&C[1]<=1&&(t-C[0][1])*(t-C[0][1])*y+(s-C[0][2])*(s-C[0][2])*v<=S)return!0;return!1}return P<S},allocatePoints:function(){var t,s;if(s=this.numberPoints,this.points.length<this.numberPoints)for(t=this.points.length;t<s;t++)this.points[t]=new i(e.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(c.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var t,i,s,n,r,a,l=!1;if(this.updateTransformMatrix(),this.updateDataArray(),i=this.minX(),s=this.maxX(),c.exists(this.dataX))for(this.numberPoints=this.dataX.length,t=this.numberPoints,this.allocatePoints(),a=0;a<t;a++)n=a,c.exists(this.dataY)?(r=a,this.points[a].setCoordinates(e.COORDS_BY_USER,[this.dataX[a],this.dataY[a]],!1)):(r=this.X(n),this.points[a].setCoordinates(e.COORDS_BY_USER,[this.dataX[a],this.Y(r,l)],!1)),this.points[a]._t=a,this.updateTransform(this.points[a]),l=!0;else{if(c.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(i,s):c.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(i,s):(this.numberPoints=c.evaluate(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.visProp.numberpointshigh:this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(i,s,this.numberPoints)),t=this.numberPoints,c.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new u(this.board.getBoundingBox()),a=0;a<this.points.length;a++)this.qdt.insert(this.points[a]),a>0&&(this.points[a].prev=this.points[a-1]),a<t-1&&(this.points[a].next=this.points[a+1]);for(a=0;a<t;a++)this.updateTransform(this.points[a])}return"plot"!==c.evaluate(this.visProp.curvetype)&&c.evaluate(this.visProp.rdpsmoothing)&&(this.points=o.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var t,e,i=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],e=0;e<i;e++)(t=this.transformations[e]).update(),this.transformMat=n.matMatMult(t.matrix,this.transformMat);return this},checkReal:function(){var t,e,i=!1,s=this.numberPoints;for(t=0;t<s;t++)if(e=this.points[t].usrCoords,!isNaN(e[1])&&!isNaN(e[2])&&Math.abs(e[0])>n.eps){i=!0;break}this.isReal=i},updateParametricCurveNaive:function(t,i,s){var n,r,o=!1,a=(i-t)/s;for(n=0;n<s;n++)this.points[n].setCoordinates(e.COORDS_BY_USER,[this.X(r=t+n*a,o),this.Y(r,o)],!1),this.points[n]._t=r,o=!0;return this},updateParametricCurveOld:function(s,r){var o,a,l,c,h,u,d,p,f,m,g,b=!1,y=new i(e.COORDS_BY_USER,[0,0],this.board,!1),v=[],x=[],C=[],_=[],w=!1,S=0;for(t.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(f=15,m=10,g=10):(f=21,m=.7,g=.7),_[0]=r-s,o=1;o<f;o++)_[o]=.5*_[o-1];o=1,v[0]=1,x[0]=0,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=s,b),this.Y(a,b)],!1),b=!0,h=y.scrCoords[1],u=y.scrCoords[2],t0=a,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=r,b),this.Y(a,b)],!1),C[0]=[l=y.scrCoords[1],c=y.scrCoords[2]],d=1,p=0,this.points=[],this.points[S++]=new i(e.COORDS_BY_SCREEN,[h,u],this.board,!1);do{for(w=this.isDistOK(l-h,c-u,m,g)||this.isSegmentOutside(h,u,l,c);p<f&&(!w||p<6)&&(p<=7||this.isSegmentDefined(h,u,l,c));)v[d]=o,x[d]=p,C[d]=[l,c],d+=1,p++,y.setCoordinates(e.COORDS_BY_USER,[this.X(a=s+(o=2*o-1)*_[p],b),this.Y(a,b)],!1,!0),w=this.isDistOK((l=y.scrCoords[1])-h,(c=y.scrCoords[2])-u,m,g)||this.isSegmentOutside(h,u,l,c);S>1&&function(t,e,i){var s,r=i[1]-t[1],o=i[2]-t[2],a=e[0]-t[1],l=e[1]-t[2],c=a*a+l*l;return c>=n.eps&&(s=(r*a+o*l)/c)>0&&(s<=1?(r-=s*a,o-=s*l):(r-=a,o-=l)),Math.sqrt(r*r+o*o)}(this.points[S-2].scrCoords,[l,c],this.points[S-1].scrCoords)<.015&&(S-=1),this.points[S]=new i(e.COORDS_BY_SCREEN,[l,c],this.board,!1),this.points[S]._t=a,S+=1,h=l,u=c,t0=a,l=C[d-=1][0],c=C[d][1],p=x[d]+1,o=2*v[d]}while(d>0&&S<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(t,e,i,s){return e<0&&s<0||e>this.board.canvasHeight&&s>this.board.canvasHeight||t<0&&i<0||t>this.board.canvasWidth&&i>this.board.canvasWidth},isDistOK:function(t,e,i,s){return Math.abs(t)<i&&Math.abs(e)<s&&!isNaN(t+e)},isSegmentDefined:function(t,e,i,s){return!(isNaN(t+e)&&isNaN(i+s))},_insertPoint:function(t,e){var i=!isNaN(this._lastCrds[1]+this._lastCrds[2]),s=!isNaN(t.scrCoords[1]+t.scrCoords[2]);(!(s=s&&t.scrCoords[1]>-500&&t.scrCoords[2]>-500&&t.scrCoords[1]<this.board.canvasWidth+500&&t.scrCoords[2]<this.board.canvasHeight+500)&&i||s&&(!i||Math.abs(t.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(t.scrCoords[2]-this._lastCrds[2])>.7))&&(t._t=e,this.points.push(t),this._lastCrds=t.copy("scrCoords"))},_intersectWithBorder:function(t,e,i){var s,r,o;return i<=0?(0!==(s=n.crossProduct([-e[0],1,0],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):o=1/0,o<e[3]?0!==(s=n.crossProduct([-e[3],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0:o>e[1]&&(0!==(s=n.crossProduct([-e[1],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0)):(0!==(s=n.crossProduct([-e[2],1,0],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):o=1/0,o<e[3]?0!==(s=n.crossProduct([-e[3],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0:o>e[1]&&(0!==(s=n.crossProduct([-e[1],0,1],t))[0]?(r=s[1]/s[0],o=s[2]/s[0]):r=1/0)),[1,r,o]},_borderCase:function(t,s,n,r,o,a,l){var c,h,u,d,p,f,m,g,b,y,v,x,C,_=null,w=!1;if(l<=1){h=new i(e.COORDS_BY_USER,[0,0],this.board,!1),d=0;do{if(isNaN(t[1]+t[2])&&!isNaN(n[1]+n[2]))p=r,f=a,m=o;else if(isNaN(s[1]+s[2])&&!isNaN(n[1]+n[2]))p=o,f=a,m=r;else if(isNaN(n[1]+n[2])&&!isNaN(s[1]+s[2]))p=a,f=o,m=o+(o-a);else{if(!isNaN(n[1]+n[2])||isNaN(t[1]+t[2]))return!1;p=a,f=r,m=r-(a-r)}h.setCoordinates(e.COORDS_BY_USER,[this.X(c=.5*(p+f),!0),this.Y(c,!0)],!1),u=h.usrCoords,(w=isNaN(u[1]+u[2]))?p=c:(m=f,f=c),++d}while(w&&d<30);if(d<30&&(_=u.slice(),n=u.slice(),f=c),x=((b=this.X(f,!0))-(v=this.X(m,!0)))/(f-m),C=((y=this.Y(f,!0))-this.Y(m,!0))/(f-m),g=this.board.getBoundingBox(),Math.sqrt(x*x+C*C)>500&&(_=this._intersectWithBorder([x*y-C*b,C,-x],g,b-v)),null!==_)return this._insertPoint(new i(e.COORDS_BY_USER,_,this.board,!1)),!0}return!1},_triangleDists:function(t,e,i){var s;return s=[t[0]*e[0],.5*(t[1]+e[1]),.5*(t[2]+e[2])],[a.distance(t,e,3),a.distance(t,i,3),a.distance(i,e,3),a.distance(i,s,3)]},_isUndefined:function(t,s,n,r){var o,a,l;if(!isNaN(t[1]+t[2])||!isNaN(n[1]+n[2]))return!1;for(l=new i(e.COORDS_BY_USER,[0,0],this.board,!1),a=0;a<20;++a)if(o=s+Math.random()*(r-s),l.setCoordinates(e.COORDS_BY_USER,[this.X(o,!0),this.Y(o,!0)],!1),!isNaN(l.scrCoords[0]+l.scrCoords[1]+l.scrCoords[2]))return!1;return!0},_isOutside:function(t,e,i,s){var n=this.board.canvasWidth,r=this.board.canvasHeight;return!!(t[1]<-500&&i[1]<-500||t[2]<-500&&i[2]<-500||t[1]>n+500&&i[1]>n+500||t[2]>r+500&&i[2]>r+500)},_plotRecursive:function(t,s,n,r,o,a){var l,c,h,u,d,p=0,f=new i(e.COORDS_BY_USER,[0,0],this.board,!1);if(!(this.numberPoints>65536))return o<this.nanLevel&&this._isUndefined(t,s,n,r)||o<this.nanLevel&&this._isOutside(t,s,n,r)||(f.setCoordinates(e.COORDS_BY_USER,[this.X(l=.5*(s+r),!0),this.Y(l,!0)],!1),this._borderCase(t,n,c=f.scrCoords,s,r,l,o)||(h=this._triangleDists(t,n,c),u=o<this.smoothLevel&&h[3]<a,d=o<this.jumpLevel&&(h[2]>.99*h[0]||h[1]>.99*h[0]||h[0]===1/0||h[1]===1/0||h[2]===1/0),o<this.smoothLevel+2&&h[0]<.5*(h[1]+h[2])&&(p=0,u=!1),--o,d?this._insertPoint(new i(e.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),l):o<=p||u?this._insertPoint(f,l):(this._plotRecursive(t,s,c,l,o,a),this._insertPoint(f,l),this._plotRecursive(c,l,n,r,o,a)))),this},updateParametricCurve:function(t,s){var n,r,o,a,l,h,u=!1,d=new i(e.COORDS_BY_USER,[0,0],this.board,!1),p=new i(e.COORDS_BY_USER,[0,0],this.board,!1);return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(l=c.evaluate(this.visProp.recursiondepthlow)||13,h=2,this.smoothLevel=5,this.jumpLevel=5):(l=c.evaluate(this.visProp.recursiondepthhigh)||17,h=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=l-4,this.points=[],d.setCoordinates(e.COORDS_BY_USER,[this.X(n=t,u),this.Y(n,u)],!1),o=d.copy("scrCoords"),p.setCoordinates(e.COORDS_BY_USER,[this.X(r=s,u=!0),this.Y(r,u)],!1),a=p.copy("scrCoords"),d._t=n,this.points.push(d),this._lastCrds=d.copy("scrCoords"),this._plotRecursive(o,n,a,r,l,h),p._t=r,this.points.push(p),this.numberPoints=this.points.length,this},updateTransform:function(t){var i;return this.transformations.length>0&&(i=n.matVecMult(this.transformMat,t.usrCoords),t.setCoordinates(e.COORDS_BY_USER,[i[1],i[2]],!1,!0)),t},addTransform:function(t){var e,i=c.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.transformations.push(i[e]);return this},interpolationFunctionFromArray:function(t){var e="data"+t;return function(t,i){var s,n,r,o,a=this[e],l=a.length,h=[];if(isNaN(t))return NaN;if(t<0)return c.isFunction(a[0])?a[0]():a[0];if(3===this.bezierDegree){if(t>=(l/=3))return c.isFunction(a[a.length-1])?a[a.length-1]():a[a.length-1];for(s=3*Math.floor(t),o=1-(r=t%1),n=0;n<4;n++)h[n]=c.isFunction(a[s+n])?a[s+n]():a[s+n];return o*o*(o*h[0]+3*r*h[1])+(3*o*h[2]+r*h[3])*r*r}if((s=t>l-2?l-2:parseInt(Math.floor(t),10))===t)return c.isFunction(a[s])?a[s]():a[s];for(n=0;n<2;n++)h[n]=c.isFunction(a[s+n])?a[s+n]():a[s+n];return h[0]+(h[1]-h[0])*(t-s)}},generateTerm:function(t,e,i,s,n){var r,o;c.isArray(e)?(this.dataX=e,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=c.createFunction(e,this.board,t),c.isString(e)?this.visProp.curvetype="functiongraph":(c.isFunction(e)||c.isNumber(e))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),c.isArray(i)?(this.dataY=i,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=c.createFunction(i,this.board,t),c.isFunction(e)&&c.isArray(i)&&(r=c.createFunction(i[0],this.board,""),o=c.createFunction(i[1],this.board,""),this.X=function(t){return e(t)*Math.cos(t)+r()},this.Y=function(t){return e(t)*Math.sin(t)+o()},this.visProp.curvetype="polar"),c.exists(s)&&(this.minX=c.createFunction(s,this.board,"")),c.exists(n)&&(this.maxX=c.createFunction(n,this.board,""))},notifyParents:function(t){var e,i,s,n=!1;for(e in s={xterm:1,yterm:1})if(s.hasOwnProperty(e)&&this.hasOwnProperty(e)&&this[e].origin)for(i in n=!0,this[e].origin.deps)this[e].origin.deps.hasOwnProperty(i)&&this[e].origin.deps[i].addChild(this);n||l.findDependencies(this,t,this.board)},getLabelAnchor:function(){var t,s,n,r=.05*this.board.canvasWidth,o=.05*this.board.canvasHeight,l=.95*this.board.canvasWidth,h=.95*this.board.canvasHeight;switch(c.evaluate(this.visProp.label.position)){case"ulft":s=r,n=o;break;case"llft":s=r,n=h;break;case"rt":s=l,n=.5*h;break;case"lrt":s=l,n=h;break;case"urt":s=l,n=o;break;case"top":s=.5*l,n=o;break;case"bot":s=.5*l,n=h;break;default:s=r,n=.5*h}return t=new i(e.COORDS_BY_SCREEN,[s,n],this.board,!1),a.projectCoordsToCurve(t.usrCoords[1],t.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var t,i={id:this.id+"T"+this.numTraces,elementClass:e.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:c.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return i.visProp.layer=this.board.options.layer.trace,i.visProp.curvetype=this.visProp.curvetype,this.numTraces++,c.clearVisPropOld(i),i.visPropCalc={visible:c.evaluate(i.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(i),this.board.renderer.enhancedRendering=t,this.traces[i.id]=i.rendNode,this},bounds:function(){var t,e,i,s=1/0,n=-1/0,r=1/0,a=-1/0,l=this.points.length;if(3===this.bezierDegree){for(t=0;t<l;t++)this.points[t].X=c.bind((function(){return this.usrCoords[1]}),this.points[t]),this.points[t].Y=c.bind((function(){return this.usrCoords[2]}),this.points[t]);return i=(e=o.bezier(this.points))[3](),s=o.fminbr((function(t){return e[0](t)}),[0,i]),n=o.fminbr((function(t){return-e[0](t)}),[0,i]),r=o.fminbr((function(t){return e[1](t)}),[0,i]),a=o.fminbr((function(t){return-e[1](t)}),[0,i]),s=e[0](s),n=e[0](n),r=e[1](r),[s,a=e[1](a),n,r]}for(t=0;t<l;t++)s>this.points[t].usrCoords[1]&&(s=this.points[t].usrCoords[1]),n<this.points[t].usrCoords[1]&&(n=this.points[t].usrCoords[1]),r>this.points[t].usrCoords[2]&&(r=this.points[t].usrCoords[2]),a<this.points[t].usrCoords[2]&&(a=this.points[t].usrCoords[2]);return[s,a,n,r]},getParents:function(){var t=[this.xterm,this.yterm,this.minX(),this.maxX()];return 0!==this.parents.length&&(t=this.parents),t},moveTo:function(t){var i;return this.points.length>0&&!c.evaluate(this.visProp.fixed)&&(i=this.points[0],this.setPosition(e.COORDS_BY_USER,3===t.length?[t[0]-i.usrCoords[0],t[1]-i.usrCoords[1],t[2]-i.usrCoords[2]]:[t[0]-i.usrCoords[1],t[1]-i.usrCoords[2]])),this}}),t.createCurve=function(i,s,n){var r,o,a=c.copyAttributes(n,i.options,"curve");return r=i.select(s[0]),c.isObject(r)&&(r.type===e.OBJECT_TYPE_CURVE||r.type===e.OBJECT_TYPE_ANGLE||r.type===e.OBJECT_TYPE_ARC||r.type===e.OBJECT_TYPE_CONIC||r.type===e.OBJECT_TYPE_SECTOR)&&c.isTransformationOrArray(s[1])?(r.type===e.OBJECT_TYPE_SECTOR?a=c.copyAttributes(n,i.options,"sector"):r.type===e.OBJECT_TYPE_ARC?a=c.copyAttributes(n,i.options,"arc"):r.type===e.OBJECT_TYPE_ANGLE?(c.exists(n.withLabel)||(n.withLabel=!1),a=c.copyAttributes(n,i.options,"angle")):a=c.copyAttributes(n,i.options,"curve"),a=c.copyAttributes(a,i.options,"curve"),(o=new t.Curve(i,["x",[],[]],a)).updateDataArray=function(){var t,e=r.numberPoints;for(this.bezierDegree=r.bezierDegree,this.dataX=[],this.dataY=[],t=0;t<e;t++)this.dataX.push(r.points[t].usrCoords[1]),this.dataY.push(r.points[t].usrCoords[2]);return this},o.addTransform(s[1]),o):(a=c.copyAttributes(n,i.options,"curve"),new t.Curve(i,["x"].concat(s),a))},t.registerElement("curve",t.createCurve),t.createFunctiongraph=function(e,i,s){var n,r=["x","x"].concat(i);return(n=c.copyAttributes(s,e.options,"curve")).curvetype="functiongraph",new t.Curve(e,r,n)},t.registerElement("functiongraph",t.createFunctiongraph),t.registerElement("plot",t.createFunctiongraph),t.createSpline=function(e,i,s){var n,r;return r=function(){var t,e=[],s=[];return function(n,r){var a,l,h;if(!r){if(e=[],s=[],2===i.length&&c.isArray(i[0])&&c.isArray(i[1])&&i[0].length===i[1].length)for(a=0;a<i[0].length;a++)c.isFunction(i[0][a])?e.push(i[0][a]()):e.push(i[0][a]),c.isFunction(i[1][a])?s.push(i[1][a]()):s.push(i[1][a]);else for(a=0;a<i.length;a++)if(c.isPoint(i[a]))e.push(i[a].X()),s.push(i[a].Y());else if(c.isArray(i[a])&&2===i[a].length)for(l=0;l<i.length;l++)c.isFunction(i[l][0])?e.push(i[l][0]()):e.push(i[l][0]),c.isFunction(i[l][1])?s.push(i[l][1]()):s.push(i[l][1]);else c.isFunction(i[a])&&2===i[a]().length&&(h=i[a](),e.push(h[0]),s.push(h[1]));t=o.splineDef(e,s)}return o.splineEval(n,e,s,t)}},(s=c.copyAttributes(s,e.options,"curve")).curvetype="functiongraph",(n=new t.Curve(e,["x","x",r()],s)).setParents(i),n.elType="spline",n},t.registerElement("spline",t.createSpline),t.createCardinalSpline=function(e,i,s){var n,r,a,l,h,u,d,p="\nPossible parent types: [points:array, tau:number|function, type:string]";if(!c.exists(i[0])||!c.isArray(i[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+p);if(!c.exists(i[1])||!c.isNumber(i[1])&&!c.isFunction(i[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+p);if(!c.exists(i[2])||!c.isString(i[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+p);if(s=c.copyAttributes(s,e.options,"curve"),(s=c.copyAttributes(s,e.options,"cardinalspline")).curvetype="parameter",a=i[0],l=[],!s.isarrayofcoordinates&&2===a.length&&c.isArray(a[0])&&c.isArray(a[1])&&a[0].length===a[1].length)for(h=0;h<a[0].length;h++)l[h]=[],c.isFunction(a[0][h])?l[h].push(a[0][h]()):l[h].push(a[0][h]),c.isFunction(a[1][h])?l[h].push(a[1][h]()):l[h].push(a[1][h]);else for(h=0;h<a.length;h++)c.isString(a[h])?l.push(e.select(a[h])):c.isPoint(a[h])?l.push(a[h]):c.isArray(a[h])&&2===a[h].length?(l[h]=[],c.isFunction(a[h][0])?l[h].push(a[h][0]()):l[h].push(a[h][0]),c.isFunction(a[h][1])?l[h].push(a[h][1]()):l[h].push(a[h][1])):c.isFunction(a[h])&&2===a[h]().length&&l.push(i[h]());if(!0===s.createpoints)r=c.providePoints(e,l,s,"cardinalspline",["points"]);else for(r=[],h=0;h<l.length;h++)c.isPoint(l[h])?r.push(l[h]):r.push(function(t){return{X:function(){return l[t][0]},Y:function(){return l[t][1]}}}(h));for(d=["x"].concat(o.CardinalSpline(r,i[1])),n=new t.Curve(e,d,s),u=r.length,n.setParents(r),h=0;h<u;h++)c.isPoint(r[h])&&r[h].addChild(n);return n.elType="cardinalspline",n},t.registerElement("cardinalspline",t.createCardinalSpline),t.createRiemannsum=function(t,e,i){var s,n,r,a,l,h;if((h=c.copyAttributes(i,t.options,"riemannsum")).curvetype="plot",r=e[0],s=c.createFunction(e[1],t,""),!c.exists(s))throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(n=c.createFunction(e[2],t,"",!1),!c.exists(n))throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return a=[[0],[0]].concat(e.slice(3)),(l=t.create("curve",a,h)).sum=0,l.Value=function(){return this.sum},l.updateDataArray=function(){var t=o.riemann(r,s(),n(),this.minX(),this.maxX());this.dataX=t[0],this.dataY=t[1],this.sum=t[2]},l},t.registerElement("riemannsum",t.createRiemannsum),t.createTracecurve=function(t,i,s){var n,r,o,a;if(2!==i.length)throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(r=t.select(i[0]),o=t.select(i[1]),r.type!==e.OBJECT_TYPE_GLIDER||!c.isPoint(o))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [glider, point]");return(a=c.copyAttributes(s,t.options,"tracecurve")).curvetype="plot",(n=t.create("curve",[[0],[0]],a)).updateDataArray=function(){var t,i,s,n,l,c,h,u,d,p=a.numberpoints,f=r.position,m=r.slideObject,g=m.minX();for(i=(m.maxX()-g)/p,this.dataX=[],this.dataY=[],m.elementClass!==e.OBJECT_CLASS_CURVE&&p++,t=0;t<p;t++){for(n in c=m.X(s=g+t*i)/m.Z(s),h=m.Y(s)/m.Z(s),r.setPositionDirectly(e.COORDS_BY_USER,[c,h]),u=!1,this.board.objects)if(this.board.objects.hasOwnProperty(n)&&((l=this.board.objects[n])===r&&(u=!0),u&&l.needsRegularUpdate&&(d=l.visProp.trace,l.visProp.trace=!1,l.needsUpdate=!0,l.update(!0),l.visProp.trace=d,l===o)))break;this.dataX[t]=o.X(),this.dataY[t]=o.Y()}for(n in r.position=f,u=!1,this.board.objects)if(this.board.objects.hasOwnProperty(n)&&((l=this.board.objects[n])===r&&(u=!0),u&&l.needsRegularUpdate&&(d=l.visProp.trace,l.visProp.trace=!1,l.needsUpdate=!0,l.update(!0),l.visProp.trace=d,l===o)))break},n},t.registerElement("tracecurve",t.createTracecurve),t.createStepfunction=function(t,e,i){var s,n;if(2!==e.length)throw new Error("JSXGraph: Can't create step function with given parent'\nPossible parent types: [array, array|function]");return n=c.copyAttributes(i,t.options,"stepfunction"),(s=t.create("curve",e,n)).updateDataArray=function(){var t,e=0,i=this.xterm.length;if(this.dataX=[],this.dataY=[],0!==i)for(this.dataX[e]=this.xterm[0],this.dataY[e]=this.yterm[0],++e,t=1;t<i;++t)this.dataX[e]=this.xterm[t],this.dataY[e]=this.dataY[e-1],++e,this.dataX[e]=this.xterm[t],this.dataY[e]=this.yterm[t],++e},s},t.registerElement("stepfunction",t.createStepfunction),t.createDerivative=function(t,i,s){var n,r,a,l,h;if(1!==i.length&&i[0].class!==e.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create derivative curve with given parent'\nPossible parent types: [curve]");return h=c.copyAttributes(s,t.options,"curve"),a=o.D((r=i[0]).X),l=o.D(r.Y),(n=t.create("curve",[function(t){return r.X(t)},function(t){return l(t)/a(t)},r.minX(),r.maxX()],h)).setParents(r),n},t.registerElement("derivative",t.createDerivative),{Curve:t.Curve,createCurve:t.createCurve,createFunctiongraph:t.createFunctiongraph,createPlot:t.createPlot,createSpline:t.createSpline,createRiemannsum:t.createRiemannsum,createTracecurve:t.createTracecurve,createStepfunction:t.createStepfunction}})),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.createEllipse=function(t,s,n){var r,a,l,c,h,u,d,p=[],f=o.copyAttributes(n,t.options,"conic","foci"),m=o.copyAttributes(n,t.options,"conic","center"),g=o.copyAttributes(n,t.options,"conic");for(u=0;u<2;u++)if(s[u].length>1)p[u]=t.create("point",s[u],f);else if(o.isPoint(s[u]))p[u]=t.select(s[u]);else if(o.isFunction(s[u])&&o.isPoint(s[u]()))p[u]=s[u]();else{if(!o.isString(s[u]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");p[u]=t.select(s[u])}if(o.isNumber(s[2]))h=o.createFunction(s[2],t);else if(o.isFunction(s[2])&&o.isNumber(s[2]()))h=s[2];else{if(o.isPoint(s[2]))c=t.select(s[2]);else if(s[2].length>1)c=t.create("point",s[2],f);else if(o.isFunction(s[2])&&o.isPoint(s[2]()))c=s[2]();else{if(!o.isString(s[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"' and '"+typeof s[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");c=t.select(s[2])}h=function(){return c.Dist(p[0])+c.Dist(p[1])}}for(o.exists(s[4])||(s[4]=2*Math.PI),o.exists(s[3])||(s[3]=0),l=t.create("point",[function(){return.5*(p[0].X()+p[1].X())},function(){return.5*(p[0].Y()+p[1].Y())}],m),(a=t.create("curve",[function(t){return 0},function(t){return 0},s[3],s[4]],g)).majorAxis=h,d=a.hasPoint,r=function(t,e){var i,s,n,r,o,l,c,u,d;e||(s=(i=h())*i,n=p[0].X(),r=p[0].Y(),o=p[1].X(),l=p[1].Y(),a.quadraticform=[[(d=(s-n*n-r*r+o*o+l*l)/(2*i))*d-o*o-l*l,d*(c=n-o)/i+o,d*(u=r-l)/i+l],[d*c/i+o,c*c/s-1,c*u/s],[d*u/i+l,c*u/s,u*u/s-1]])},a.X=function(t,e){var i=h(),s=p[1].Dist(p[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)-i),o=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return e||r(0,e),p[0].X()+Math.cos(o+t)*n},a.Y=function(t,e){var i=h(),s=p[1].Dist(p[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)-i),r=Math.atan2(p[1].Y()-p[0].Y(),p[1].X()-p[0].X());return p[0].Y()+Math.sin(r+t)*n},a.midpoint=a.center=l,a.type=e.OBJECT_TYPE_CONIC,a.subs={center:a.center},a.inherits.push(a.center,p[0],p[1]),o.isPoint(c)&&a.inherits.push(c),a.hasPoint=function(t,s){var n,r,a,l;return o.evaluate(this.visProp.hasinnerpoints)?(n=p[0].coords,r=p[1].coords,a=this.majorAxis(),(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board)).distance(e.COORDS_BY_USER,n)+l.distance(e.COORDS_BY_USER,r)<=a):d.apply(this,arguments)},l.addChild(a),u=0;u<2;u++)o.isPoint(p[u])&&p[u].addChild(a);return o.isPoint(c)&&c.addChild(a),a.setParents(s),a},t.createHyperbola=function(t,i,s){var n,r,a,l,c,h,u=[],d=o.copyAttributes(s,t.options,"conic","foci"),p=o.copyAttributes(s,t.options,"conic","center"),f=o.copyAttributes(s,t.options,"conic");for(h=0;h<2;h++)if(i[h].length>1)u[h]=t.create("point",i[h],d);else if(o.isPoint(i[h]))u[h]=t.select(i[h]);else if(o.isFunction(i[h])&&o.isPoint(i[h]()))u[h]=i[h]();else{if(!o.isString(i[h]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");u[h]=t.select(i[h])}if(o.isNumber(i[2]))c=o.createFunction(i[2],t);else if(o.isFunction(i[2])&&o.isNumber(i[2]()))c=i[2];else{if(o.isPoint(i[2]))l=t.select(i[2]);else if(i[2].length>1)l=t.create("point",i[2],d);else if(o.isFunction(i[2])&&o.isPoint(i[2]()))l=i[2]();else{if(!o.isString(i[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");l=t.select(i[2])}c=function(){return l.Dist(u[0])-l.Dist(u[1])}}for(o.exists(i[4])||(i[4]=1.0001*Math.PI),o.exists(i[3])||(i[3]=-1.0001*Math.PI),a=t.create("point",[function(){return.5*(u[0].X()+u[1].X())},function(){return.5*(u[0].Y()+u[1].Y())}],p),(r=t.create("curve",[function(t){return 0},function(t){return 0},i[3],i[4]],f)).majorAxis=c,n=function(t,e){var i,s,n,o,a,l,h,d,p;e||(s=(i=c())*i,n=u[0].X(),o=u[0].Y(),a=u[1].X(),l=u[1].Y(),r.quadraticform=[[(p=(s-n*n-o*o+a*a+l*l)/(2*i))*p-a*a-l*l,p*(h=n-a)/i+a,p*(d=o-l)/i+l],[p*h/i+a,h*h/s-1,h*d/s],[p*d/i+l,h*d/s,d*d/s-1]])},r.X=function(t,e){var i=c(),s=u[1].Dist(u[0]),r=.5*(s*s-i*i)/(s*Math.cos(t)+i),o=Math.atan2(u[1].Y()-u[0].Y(),u[1].X()-u[0].X());return e||n(0,e),u[0].X()+Math.cos(o+t)*r},r.Y=function(t,e){var i=c(),s=u[1].Dist(u[0]),n=.5*(s*s-i*i)/(s*Math.cos(t)+i),r=Math.atan2(u[1].Y()-u[0].Y(),u[1].X()-u[0].X());return u[0].Y()+Math.sin(r+t)*n},r.midpoint=r.center=a,r.subs={center:r.center},r.inherits.push(r.center,u[0],u[1]),o.isPoint(l)&&r.inherits.push(l),r.type=e.OBJECT_TYPE_CONIC,a.addChild(r),h=0;h<2;h++)o.isPoint(u[h])&&u[h].addChild(r);return o.isPoint(l)&&l.addChild(r),r.setParents(i),r},t.createParabola=function(t,i,s){var n,a,l,c=i[0],h=i[1],u=o.copyAttributes(s,t.options,"conic","foci"),d=o.copyAttributes(s,t.options,"conic","center"),p=o.copyAttributes(s,t.options,"conic");if(i[0].length>1)c=t.create("point",i[0],u);else if(o.isPoint(i[0]))c=t.select(i[0]);else if(o.isFunction(i[0])&&o.isPoint(i[0]()))c=i[0]();else{if(!o.isString(i[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line]");c=t.select(i[0])}return o.exists(i[3])||(i[3]=10),o.exists(i[2])||(i[2]=-10),l=t.create("point",[function(){return r.projectPointToLine(c,h,t).usrCoords}],d),(a=t.create("curve",[function(t){return 0},function(t){return 0},i[2],i[3]],p)).midpoint=a.center=l,a.subs={center:a.center},a.inherits.push(a.center),n=function(t,e){var i,s,n,r,o,l;e||(n=h.stdform[0],r=(i=h.stdform[1])*i+(s=h.stdform[2])*s,o=c.X(),l=c.Y(),a.quadraticform=[[n*n-r*(o*o+l*l),n*i+r*o,n*s+r*l],[n*i+r*o,-s*s,i*s],[n*s+r*l,i*s,-i*i]])},a.X=function(t,e){var i,s=h.getAngle(),o=r.distPointLine(c.coords.usrCoords,h.stdform),a=h.point1.coords.usrCoords,l=h.point2.coords.usrCoords,u=c.coords.usrCoords;return 0===a[0]?a=[1,l[1]+h.stdform[2],l[2]-h.stdform[1]]:0===l[0]&&(l=[1,a[1]+h.stdform[2],a[2]-h.stdform[1]]),i=((l[1]-a[1])*(u[2]-a[2])-(l[2]-a[2])*(u[1]-a[1])>=0?1:-1)*o/(1-Math.sin(t)),e||n(0,e),c.X()+Math.cos(t+s)*i},a.Y=function(t,e){var i,s=h.getAngle(),n=r.distPointLine(c.coords.usrCoords,h.stdform),o=h.point1.coords.usrCoords,a=h.point2.coords.usrCoords,l=c.coords.usrCoords;return 0===o[0]?o=[1,a[1]+h.stdform[2],a[2]-h.stdform[1]]:0===a[0]&&(a=[1,o[1]+h.stdform[2],o[2]-h.stdform[1]]),i=((a[1]-o[1])*(l[2]-o[2])-(a[2]-o[2])*(l[1]-o[1])>=0?1:-1)*n/(1-Math.sin(t)),c.Y()+Math.sin(t+s)*i},a.type=e.OBJECT_TYPE_CONIC,l.addChild(a),o.isPoint(c)&&(c.addChild(a),a.inherits.push(c)),h.addChild(a),a.setParents(i),a},t.createConic=function(t,i,r){var a,l,c,h,u,d,p,f,m,g,b,y,v,x,C=[[1,0,0],[0,1,0],[0,0,1]],_=[[1,0,0],[0,1,0],[0,0,1]],w=[],S=[],P=o.copyAttributes(r,t.options,"conic","point"),k=o.copyAttributes(r,t.options,"conic","center"),E=o.copyAttributes(r,t.options,"conic");if(5===i.length)x=!0;else{if(6!==i.length)throw new Error("JSXGraph: Can't create generic Conic with "+i.length+" parameters.");x=!1}if(x)for(y=0;y<5;y++)if(i[y].length>1)w[y]=t.create("point",i[y],P);else if(o.isPoint(i[y]))w[y]=t.select(i[y]);else if(o.isFunction(i[y])&&o.isPoint(i[y]()))w[y]=i[y]();else{if(!o.isString(i[y]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof i[y]+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");w[y]=t.select(i[y])}else(v=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=o.isFunction(i[2])?function(){return i[2]()}:function(){return i[2]},v[0][1]=o.isFunction(i[4])?function(){return i[4]()}:function(){return i[4]},v[0][2]=o.isFunction(i[5])?function(){return i[5]()}:function(){return i[5]},v[1][1]=o.isFunction(i[0])?function(){return i[0]()}:function(){return i[0]},v[1][2]=o.isFunction(i[3])?function(){return i[3]()}:function(){return i[3]},v[2][2]=o.isFunction(i[1])?function(){return i[1]()}:function(){return i[1]};if(u=function(t){var e,i;for(e=0;e<3;e++)for(i=e;i<3;i++)t[e][i]+=t[i][e];for(e=0;e<3;e++)for(i=0;i<e;i++)t[e][i]=t[i][e];return t},h=function(t,e){var i,s,n=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i++)for(s=0;s<3;s++)n[i][s]=t[i]*e[s];return u(n)},c=function(t,e,i){var n,r,o,a,l,c=[[0,0,0],[0,0,0],[0,0,0]];for(l=s.matVecMult(e,i),o=s.innerProduct(i,l),l=s.matVecMult(t,i),a=s.innerProduct(i,l),n=0;n<3;n++)for(r=0;r<3;r++)c[n][r]=o*t[n][r]-a*e[n][r];return c},l=t.create("curve",[function(t){return 0},function(t){return 0},0,2*Math.PI],E),a=function(t,e){var i,r,a,u;if(!e){if(x){for(i=0;i<5;i++)S[i]=w[i].coords.usrCoords;g=h(s.crossProduct(S[0],S[1]),s.crossProduct(S[2],S[3])),b=h(s.crossProduct(S[0],S[2]),s.crossProduct(S[1],S[3])),_=c(g,b,S[4])}else for(i=0;i<3;i++)for(r=i;r<3;r++)_[i][r]=v[i][r](),r>i&&(_[r][i]=_[i][r]);for(l.quadraticform=_,(d=n.Jacobi(_))[0][0][0]<0&&(d[0][0][0]*=-1,d[0][1][1]*=-1,d[0][2][2]*=-1),i=0;i<3;i++){for(a=0,r=0;r<3;r++)a+=d[1][r][i]*d[1][r][i];a=Math.sqrt(a)}C=d[1],m=Math.sqrt(Math.abs(d[0][0][0])),p=Math.sqrt(Math.abs(d[0][1][1])),f=Math.sqrt(Math.abs(d[0][2][2]))}return d[0][1][1]<=0&&d[0][2][2]<=0?u=s.matVecMult(C,[1/m,Math.cos(t)/p,Math.sin(t)/f]):d[0][1][1]<=0&&d[0][2][2]>0?u=s.matVecMult(C,[Math.cos(t)/m,1/p,Math.sin(t)/f]):d[0][2][2]<0&&(u=s.matVecMult(C,[Math.sin(t)/m,Math.cos(t)/p,1/f])),o.exists(u)?(u[1]/=u[0],u[2]/=u[0],u[0]=1):u=[1,NaN,NaN],u},l.X=function(t,e){return a(t,e)[1]},l.Y=function(t,e){return a(t,e)[2]},l.midpoint=t.create("point",[function(){var t=l.quadraticform;return[t[1][1]*t[2][2]-t[1][2]*t[1][2],t[1][2]*t[0][2]-t[2][2]*t[0][1],t[0][1]*t[1][2]-t[1][1]*t[0][2]]}],k),l.type=e.OBJECT_TYPE_CONIC,l.center=l.midpoint,l.subs={center:l.center},l.inherits.push(l.center),l.inherits=l.inherits.concat(w),x){for(y=0;y<5;y++)o.isPoint(w[y])&&w[y].addChild(l);l.setParents(i)}return l.addChild(l.center),l},t.registerElement("ellipse",t.createEllipse),t.registerElement("hyperbola",t.createHyperbola),t.registerElement("parabola",t.createParabola),t.registerElement("conic",t.createConic),{createEllipse:t.createEllipse,createHyperbola:t.createHyperbola,createParabola:t.createParabola,createConic:t.createConic}})),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],(function(t,e,i,s,n,r,o){"use strict";return t.Circle=function(t,e,i,n,r){this.constructor(t,r,s.OBJECT_TYPE_CIRCLE,s.OBJECT_CLASS_CIRCLE),this.method=e,this.midpoint=this.board.select(i),this.center=this.board.select(i),this.point2=null,this.radius=0,this.line=null,this.circle=null,"twoPoints"===e?(this.point2=t.select(n),this.radius=this.Radius()):"pointRadius"===e?(this.gxtterm=n,this.updateRadius=o.createFunction(n,this.board,null,!0),this.updateRadius()):"pointLine"===e?(this.line=t.select(n),this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"===e&&(this.circle=t.select(n),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),"pointRadius"===e?this.notifyParents(n):"pointLine"===e?this.line.addChild(this):"pointCircle"===e?this.circle.addChild(this):"twoPoints"===e&&this.point2.addChild(this),this.methodMap=o.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},t.Circle.prototype=new e,t.extend(t.Circle.prototype,{hasPoint:function(t,e){var n,r,a,l=this.board.options.precision.hasPoint,c=this.center.coords.usrCoords,h=new i(s.COORDS_BY_SCREEN,[t,e],this.board),u=this.Radius();return n=c[1]-h.usrCoords[1],r=c[2]-h.usrCoords[2],a=Math.sqrt(n*n+r*r),l+=.5*o.evaluate(this.visProp.strokewidth),l/=Math.sqrt(this.board.unitX*this.board.unitY),o.evaluate(this.visProp.hasinnerpoints)?a<u+l:Math.abs(a-u)<l},generatePolynomial:function(t){var e=this.center.symbolic.x,i=this.center.symbolic.y,s=t.symbolic.x,n=t.symbolic.y,r=this.generateRadiusSquared();return""===r?[]:["(("+s+")-("+e+"))^2 + (("+n+")-("+i+"))^2 - ("+r+")"]},generateRadiusSquared:function(){var t="";return"twoPoints"===this.method?t="(("+this.point2.symbolic.x+")-("+this.center.symbolic.x+"))^2 + (("+this.point2.symbolic.y+")-("+this.center.symbolic.y+"))^2":"pointRadius"===this.method?o.isNumber(this.radius)&&(t=(this.radius*this.radius).toString()):"pointLine"===this.method?t="(("+this.line.point1.symbolic.x+")-("+this.line.point2.symbolic.x+"))^2 + (("+this.line.point1.symbolic.y+")-("+this.line.point2.symbolic.y+"))^2":"pointCircle"===this.method&&(t=this.circle.Radius()),t},update:function(){return this.needsUpdate&&(o.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),"pointLine"===this.method?this.radius=this.line.point1.coords.distance(s.COORDS_BY_USER,this.line.point2.coords):"pointCircle"===this.method?this.radius=this.circle.Radius():"pointRadius"===this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var t=this.center,e=t.X(),i=t.Y(),s=this.Radius();this.quadraticform=[[e*e+i*i-s*s,-e,-i],[-e,1,0],[-i,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=o.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(t){o.isString(t)&&r.findDependencies(this,t,this.board)},setRadius:function(t){return this.updateRadius=o.createFunction(t,this.board,null,!0),this.board.update(),this},Radius:function(t){return o.exists(t)?(this.setRadius(t),this.Radius()):"twoPoints"===this.method?o.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||o.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):"pointLine"===this.method||"pointCircle"===this.method?this.radius:"pointRadius"===this.method?this.updateRadius():NaN},getRadius:function(){return t.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var t,e,n=this.Radius(),r=this.center.coords.usrCoords;switch(o.evaluate(this.visProp.label.position)){case"lft":t=r[1]-n,e=r[2];break;case"llft":t=r[1]-Math.sqrt(.5)*n,e=r[2]-Math.sqrt(.5)*n;break;case"rt":t=r[1]+n,e=r[2];break;case"lrt":t=r[1]+Math.sqrt(.5)*n,e=r[2]-Math.sqrt(.5)*n;break;case"urt":t=r[1]+Math.sqrt(.5)*n,e=r[2]+Math.sqrt(.5)*n;break;case"top":t=r[1],e=r[2]+n;break;case"bot":t=r[1],e=r[2]-n;break;default:t=r[1]-Math.sqrt(.5)*n,e=r[2]+Math.sqrt(.5)*n}return new i(s.COORDS_BY_USER,[t,e],this.board)},cloneToBackground:function(){var t,e=this.Radius(),i={id:this.id+"T"+this.numTraces,elementClass:s.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return e},getRadius:function(){return e},board:this.board,visProp:o.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return i.visProp.layer=this.board.options.layer.trace,this.numTraces++,o.clearVisPropOld(i),i.visPropCalc={visible:o.evaluate(i.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(i),this.board.renderer.enhancedRendering=t,this.traces[i.id]=i.rendNode,this},addTransform:function(t){var e,i=o.isArray(t)?t:[t],s=i.length;for(e=0;e<s;e++)this.center.transformations.push(i[e]),"twoPoints"===this.method&&this.point2.transformations.push(i[e]);return this},snapToGrid:function(){var t=o.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(t,!0),"twoPoints"===this.method&&this.point2.handleSnapToGrid(t,!0),this},snapToPoints:function(){var t=o.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(t),"twoPoints"===this.method&&this.point2.handleSnapToPoints(t),this},X:function(t){return this.Radius()*Math.cos(2*t*Math.PI)+this.center.coords.usrCoords[1]},Y:function(t){return this.Radius()*Math.sin(2*t*Math.PI)+this.center.coords.usrCoords[2]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var t=this.Radius();return t*t*Math.PI},bounds:function(){var t=this.center.coords.usrCoords,e=this.Radius();return[t[1]-e,t[2]+e,t[1]+e,t[2]-e]},getParents:function(){return 1===this.parents.length?this.parents.concat(this.radius):this.parents}}),t.createCircle=function(e,i,r){var a,l,c,h,u;if(l=[],u=e.select(i[0]),o.isObject(u)&&u.elementClass===s.OBJECT_CLASS_CIRCLE&&o.isTransformationOrArray(i[1]))return h=o.copyAttributes(r,e.options,"circle"),(a=n.createEllipse(e,[u.center,u.center,function(){return 2*u.Radius()}],h)).addTransform(i[1]),a;for(c=0;c<i.length;c++)if(o.isPointType(e,i[c])){if(!1===(l=l.concat(o.providePoints(e,[i[c]],r,"circle",["center"])))[l.length-1])throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else l.push(i[c]);if(h=o.copyAttributes(r,e.options,"circle"),2===l.length&&o.isPoint(l[0])&&o.isPoint(l[1]))a=new t.Circle(e,"twoPoints",l[0],l[1],h);else if((o.isNumber(l[0])||o.isFunction(l[0])||o.isString(l[0]))&&o.isPoint(l[1]))a=new t.Circle(e,"pointRadius",l[1],l[0],h);else if((o.isNumber(l[1])||o.isFunction(l[1])||o.isString(l[1]))&&o.isPoint(l[0]))a=new t.Circle(e,"pointRadius",l[0],l[1],h);else if(l[0].elementClass===s.OBJECT_CLASS_CIRCLE&&o.isPoint(l[1]))a=new t.Circle(e,"pointCircle",l[1],l[0],h);else if(l[1].elementClass===s.OBJECT_CLASS_CIRCLE&&o.isPoint(l[0]))a=new t.Circle(e,"pointCircle",l[0],l[1],h);else if(l[0].elementClass===s.OBJECT_CLASS_LINE&&o.isPoint(l[1]))a=new t.Circle(e,"pointLine",l[1],l[0],h);else if(l[1].elementClass===s.OBJECT_CLASS_LINE&&o.isPoint(l[0]))a=new t.Circle(e,"pointLine",l[0],l[1],h);else{if(!(3===i.length&&o.isPoint(l[0])&&o.isPoint(l[1])&&o.isPoint(l[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]");if(!t.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");a=t.elements.circumcircle(e,l,h)}for(a.isDraggable=!0,a.setParents(l),a.elType="circle",c=0;c<l.length;c++)o.isPoint(l[c])&&a.inherits.push(l[c]);return a},t.registerElement("circle",t.createCircle),{Circle:t.Circle,createCircle:t.createCircle}})),define("base/composition",["jxg","utils/type"],(function(t,e){"use strict";return t.Composition=function(t){var i,s=this,n=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"];for(i=0;i<n.length;i++)this[n[i]]=function(t){return function(){var i;for(i in s.elements)s.elements.hasOwnProperty(i)&&e.exists(s.elements[i][t])&&s.elements[i][t].apply(s.elements[i],arguments);return s}}(n[i]);for(i in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},t)t.hasOwnProperty(i)&&this.add(i,t[i]);this.dump=!0,this.subs={}},t.extend(t.Composition.prototype,{add:function(t,i){return!(e.exists(this[t])||!e.exists(i)||(e.exists(i.id)?this.elements[i.id]=i:this.elements[t]=i,e.exists(i.name)&&(this.elementsByName[i.name]=i),i.on("attribute:name",this.nameListener,this),this.objectsList.push(i),this[t]=i,this.methodMap[t]=i,0))},remove:function(t){var e,i=!1;for(e in this.elements)if(this.elements.hasOwnProperty(e)&&this.elements[e].id===this[t].id){i=!0;break}return i&&(delete this.elements[this[t].id],delete this[t]),i},nameListener:function(t,e,i){delete this.elementsByName[t],this.elementsByName[e]=i},select:function(i){return e.exists(t.Board)?t.Board.prototype.select.call(this,i):new t.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var t,e={};for(t in this.subs)this.subs.hasOwnProperty(t)&&(e[t]=this.subs[t].visProp);return this.attr}}),t.Composition})),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.Polygon=function(i,s,n){this.constructor(i,n,e.OBJECT_TYPE_POLYGON,e.OBJECT_CLASS_AREA);var o,a,l,c,h=r.copyAttributes(n,i.options,"polygon","borders");for(this.withLines=n.withlines,this.attr_line=h,this.vertices=[],o=0;o<s.length;o++)this.vertices[o]=this.board.select(s[o]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(l=this.vertices.length-1,c=0;c<l;c++)o=(c+1)%l,h.id=h.ids&&h.ids[o],h.name=h.names&&h.names[o],h.strokecolor=r.isArray(h.colors)&&h.colors[o%h.colors.length]||h.strokecolor,h.visible=r.exists(n.borders.visible)?n.borders.visible:n.visible,!1===h.strokecolor&&(h.strokecolor="none"),(a=i.create("segment",[this.vertices[o],this.vertices[o+1]],h)).dump=!1,this.borders[o]=a,a.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),o=0;o<this.vertices.length-1;o++)this.board.select(this.vertices[o]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=t.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},t.Polygon.prototype=new o,t.extend(t.Polygon.prototype,{hasPoint:function(t,e){var i,s,n,o=!1;if(r.evaluate(this.visProp.hasinnerpoints)){for(i=0,s=(n=this.vertices.length)-2;i<n-1;s=i++)this.vertices[i].coords.scrCoords[2]>e!=this.vertices[s].coords.scrCoords[2]>e&&t<(this.vertices[s].coords.scrCoords[1]-this.vertices[i].coords.scrCoords[1])*(e-this.vertices[i].coords.scrCoords[2])/(this.vertices[s].coords.scrCoords[2]-this.vertices[i].coords.scrCoords[2])+this.vertices[i].coords.scrCoords[1]&&(o=!o);if(o)return!0}for(n=this.borders.length,i=0;i<n;i++)if(this.borders[i].hasPoint(t,e)){o=!0;break}return o},updateRenderer:function(){var t,e;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(e=this.vertices.length,this.isReal=!0,t=0;t<e;++t)if(!this.vertices[t].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var t,s,n,r,o;if(0===this.vertices.length)return new i(e.COORDS_BY_USER,[1,0,0],this.board);for(n=t=this.vertices[0].X(),r=s=this.vertices[0].Y(),o=0;o<this.vertices.length;o++)this.vertices[o].X()<t&&(t=this.vertices[o].X()),this.vertices[o].X()>n&&(n=this.vertices[o].X()),this.vertices[o].Y()>s&&(s=this.vertices[o].Y()),this.vertices[o].Y()<r&&(r=this.vertices[o].Y());return new i(e.COORDS_BY_USER,[.5*(t+n),.5*(s+r)],this.board)},getLabelAnchor:t.shortcut(t.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var t,e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.vertices=this.vertices,e.visProp=r.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.board=this.board,r.clearVisPropOld(e),e.visPropCalc={visible:r.evaluate(e.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(e),this.board.renderer.enhancedRendering=t,this.traces[e.id]=e.rendNode,this},hideElement:function(e){var i;if(t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!e)for(i=0;i<this.borders.length;i++)this.borders[i].hideElement();this.hasLabel&&r.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(e){var i;if(t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!e)for(i=0;i<this.borders.length;i++)this.borders[i].showElement().updateRenderer();return r.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(n.signedPolygon(this.vertices,!0))},Perimeter:function(){var t,e=this.vertices.length,i=0;for(t=1;t<e;++t)i+=this.vertices[t].Dist(this.vertices[t-1]);return i},boundingBox:function(){var t,e,i=[0,0,0,0],s=this.vertices.length-1;if(0===s)return i;for(i[0]=this.vertices[0].X(),i[2]=i[0],i[1]=this.vertices[0].Y(),i[3]=i[1],t=1;t<s;++t)(e=this.vertices[t].X())<i[0]?i[0]=e:e>i[2]&&(i[2]=e),(e=this.vertices[t].Y())>i[1]?i[1]=e:e<i[3]&&(i[3]=e);return i},bounds:function(){return this.boundingBox()},remove:function(){var t;for(t=0;t<this.borders.length;t++)this.board.removeObject(this.borders[t]);o.prototype.remove.call(this)},findPoint:function(t){var e;if(!r.isPoint(t))return-1;for(e=0;e<this.vertices.length;e++)if(this.vertices[e].id===t.id)return e;return-1},addPoints:function(t){var e=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(e))},insertPoints:function(t,e){var i,s,n=[];if(0===arguments.length)return this;if(t<0||t>this.vertices.length-2)return this;for(i=1;i<arguments.length;i++)r.isPoint(arguments[i])&&n.push(arguments[i]);if(s=this.vertices.slice(0,t+1).concat(n),this.vertices=s.concat(this.vertices.slice(t+1)),this.withLines){for(s=this.borders.slice(0,t),this.board.removeObject(this.borders[t]),i=0;i<n.length;i++)s.push(this.board.create("segment",[this.vertices[t+i],this.vertices[t+i+1]],this.attr_line));s.push(this.board.create("segment",[this.vertices[t+n.length],this.vertices[t+n.length+1]],this.attr_line)),this.borders=s.concat(this.borders.slice(t+1))}return this.board.update(),this},removePoints:function(t){var e,i,s,n=[],o=[],a=[],l=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),e=0;e<arguments.length;e++)r.isPoint(s=arguments[e])&&(s=this.findPoint(s)),r.isNumber(s)&&s>-1&&s<this.vertices.length&&-1===r.indexOf(a,s)&&a.push(s);for(e=0;e<a.length;e++)this.vertices[a[e]].removeChild(this);for(a=a.sort(),n=this.vertices.slice(),o=this.borders.slice(),this.withLines&&l.push([a[a.length-1]]),e=a.length-1;e>-1;e--)n[a[e]]=-1,this.withLines&&a[e]-1>a[e-1]&&(l[l.length-1][1]=a[e],l.push([a[e-1]]));for(this.withLines&&(l[l.length-1][1]=a[0]),this.vertices=[],e=0;e<n.length;e++)r.isPoint(n[e])&&this.vertices.push(n[e]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;e<l.length;e++){for(i=l[e][1]-1;i<l[e][0]+1;i++)i<0?(i=0,this.board.removeObject(this.borders[o.length-1]),o[o.length-1]=-1):i>o.length-1&&(i=o.length-1),this.board.removeObject(this.borders[i]),o[i]=-1;0!==l[e][1]&&l[e][0]!==n.length-1&&(o[l[e][0]-1]=this.board.create("segment",[n[Math.max(l[e][1]-1,0)],n[Math.min(l[e][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],e=0;e<o.length;e++)-1!==o[e]&&this.borders.push(o[e]);l[0][1]!==this.vertices.length-1&&0!==l[l.length-1][1]||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var t,e=o.prototype.getAttributes.call(this);if(this.withLines)for(e.lines=e.lines||{},e.lines.ids=[],e.lines.colors=[],t=0;t<this.borders.length;t++)e.lines.ids.push(this.borders[t].id),e.lines.colors.push(this.borders[t].visProp.strokecolor);return e},snapToGrid:function(){var t,e;for(e=!!r.evaluate(this.visProp.snaptogrid),t=0;t<this.vertices.length;t++)this.vertices[t].handleSnapToGrid(e,!0)},setPositionDirectly:function(t,e,n){var r,o,a,l=new i(t,e,this.board),c=new i(t,n,this.board);for(a=this.vertices.length-1,o=0;o<a;o++)if(!this.vertices[o].draggable())return this;return r=s.subtract(l.usrCoords,c.usrCoords),this.board.create("transform",r.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(e){var i,s,n,r,o,a,l,c=t.Math.Geometry.sortVertices(this.vertices),h=t.Math.Geometry.sortVertices(e.vertices),u=c.length-1,d=h.length-1,p=[],f=function(t,e,i){return(e[1]-t[1])*(i[2]-t[2])-(e[2]-t[2])*(i[1]-t[1])>=0};for(n=0;n<d;n++)p.push(h[n]);for(n=0;n<u;n++)for(s=p.slice(0),p=[],o=s[(i=s.length)-1],r=0;r<i;r++)f(c[n],c[n+1],a=s[r])?(f(c[n],c[n+1],o)||((l=t.Math.Geometry.meetSegmentSegment(o,a,c[n],c[n+1]))[0][1]/=l[0][0],l[0][2]/=l[0][0],l[0][0]=1,p.push(l[0])),p.push(a)):f(c[n],c[n+1],o)&&((l=t.Math.Geometry.meetSegmentSegment(o,a,c[n],c[n+1]))[0][1]/=l[0][0],l[0][2]/=l[0][0],l[0][0]=1,p.push(l[0])),o=a;return p},intersect:function(t){return this.sutherlandHodgman(t)}}),t.createPolygon=function(i,s,n){var o,a,l,c,h,u,d=[],p=!1;if(r.copyAttributes(n,i.options,"polygon"),c=i.select(s[0]),r.isObject(c)&&c.type===e.OBJECT_TYPE_POLYGON&&r.isTransformationOrArray(s[1]))for(p=!0,l=c.vertices.length-1,u=r.copyAttributes(n,i.options,"polygon","vertices"),a=0;a<l;a++)u.withlabel&&(u.name=""===c.vertices[a].name?"":c.vertices[a].name+"'"),d.push(i.create("point",[c.vertices[a],s[1]],u));else if(!1===(d=r.providePoints(i,s,n,"polygon",["vertices"])))throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(h=r.copyAttributes(n,i.options,"polygon"),(o=new t.Polygon(i,d,h)).isDraggable=!0,p)for(l=c.vertices.length-1,a=0;a<l;a++)d[a].prepareUpdate().update().updateVisibility(r.evaluate(o.visProp.visible)).updateRenderer();return o},t.createRegularPolygon=function(t,i,s){var n,o,a,l,c,h,u,d=[];if(r.isNumber(a=i[(c=i.length)-1])&&(3!==i.length||a<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(r.isNumber(t.select(a))?(c--,h=!1):(a=c,h=!0),!1===(d=r.providePoints(t,i.slice(0,c),s,"regularpolygon",["vertices"])))throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(u=r.copyAttributes(s,t.options,"regularpolygon","vertices"),o=2;o<a;o++)l=t.create("transform",[Math.PI*(2-(a-2)/a),d[o-1]],{type:"rotate"}),h?(d[o].addTransform(d[o-2],l),d[o].fullUpdate()):(r.isArray(u.ids)&&u.ids.length>=a-2&&(u.id=u.ids[o-2]),d[o]=t.create("point",[d[o-2],l],u),d[o].type=e.OBJECT_TYPE_CAS,d[o].isDraggable=!0,d[o].visProp.fixed=!1);return u=r.copyAttributes(s,t.options,"regularpolygon"),(n=t.create("polygon",d,u)).elType="regularpolygon",n},t.registerElement("polygon",t.createPolygon),t.registerElement("regularpolygon",t.createRegularPolygon),{Polygon:t.Polygon,createPolygon:t.createPolygon,createRegularPolygon:t.createRegularPolygon}})),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.createArc=function(a,l,c){var h,u,d;if(!1===(d=r.providePoints(a,l,c,"arc",["center","radiuspoint","anglepoint"]))||d.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof l[0]+"' and '"+typeof l[1]+"' and '"+typeof l[2]+"'.\nPossible parent types: [point,point,point], [arc, transformation]");return u=r.copyAttributes(c,a.options,"arc"),(h=a.create("curve",[[0],[0]],u)).elType="arc",h.setParents(d),h.type=o.OBJECT_TYPE_ARC,h.center=d[0],h.radiuspoint=d[1],h.point2=h.radiuspoint,h.anglepoint=d[2],h.point3=h.anglepoint,h.center.addChild(h),h.radiuspoint.addChild(h),h.anglepoint.addChild(h),h.useDirection=u.usedirection,h.updateDataArray=function(){var t,i,s,n,o,a=1,l=this.radiuspoint,c=this.center,h=this.anglepoint,u=r.evaluate(this.visProp.selection);i=e.rad(l,c,h),("minor"===u&&i>Math.PI||"major"===u&&i<Math.PI)&&(a=-1),this.useDirection&&(((s=d[1].coords.usrCoords)[1]-(o=d[2].coords.usrCoords)[1])*(s[2]-(n=d[3].coords.usrCoords)[2])-(s[2]-o[2])*(s[1]-n[1])<0?(this.radiuspoint=d[1],this.anglepoint=d[2]):(this.radiuspoint=d[2],this.anglepoint=d[1])),t=e.bezierArc(l=l.coords.usrCoords,c=c.coords.usrCoords,h=h.coords.usrCoords,!1,a),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},h.Radius=function(){return this.radiuspoint.Dist(this.center)},h.getRadius=function(){return t.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},h.Value=function(){return this.Radius()*e.rad(this.radiuspoint,this.center,this.anglepoint)},h.hasPoint=function(t,n){var a,l,c,h,u,d,p,f,m,g=this.Radius(),b=r.evaluate(this.visProp.selection);return r.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(t,n):(m=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),l=new s(o.COORDS_BY_SCREEN,[t,n],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),p=i.inverse(this.transformMat),f=i.matVecMult(p,l.usrCoords),l=new s(o.COORDS_BY_USER,f,this.board)),a=this.center.coords.distance(o.COORDS_BY_USER,l),(c=Math.abs(a-g)<m)&&(h=e.rad(this.radiuspoint,this.center,l.usrCoords.slice(1)),u=0,d=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===b&&d>Math.PI||"major"===b&&d<Math.PI)&&(u=d,d=2*Math.PI),(h<u||h>d)&&(c=!1)),c)},h.hasPointSector=function(t,i){var n,a,l,c=new s(o.COORDS_BY_SCREEN,[t,i],this.board),h=this.Radius(),u=this.center.coords.distance(o.COORDS_BY_USER,c)<h,d=r.evaluate(this.visProp.selection);return u&&(n=e.rad(this.radiuspoint,this.center,c.usrCoords.slice(1)),a=0,l=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===d&&l>Math.PI||"major"===d&&l<Math.PI)&&(a=l,l=2*Math.PI),(n<a||n>l)&&(u=!1)),u},h.getTextAnchor=function(){return this.center.coords},h.getLabelAnchor=function(){var t,i,n,a,l,c=e.rad(this.radiuspoint,this.center,this.anglepoint),h=10/this.board.unitX,u=10/this.board.unitY,d=this.point2.coords.usrCoords,p=this.center.coords.usrCoords,f=d[1]-p[1],m=d[2]-p[2],g=r.evaluate(this.visProp.selection),b=this.label?this.label.visProp:this.visProp.label;return("minor"===g&&c>Math.PI||"major"===g&&c<Math.PI)&&(c=-(2*Math.PI-c)),n=(t=new s(o.COORDS_BY_USER,[p[1]+Math.cos(.5*c)*f-Math.sin(.5*c)*m,p[2]+Math.sin(.5*c)*f+Math.cos(.5*c)*m],this.board)).usrCoords[1]-p[1],a=t.usrCoords[2]-p[2],l=Math.sqrt(n*n+a*a),b.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],i=[p[1]+(n=n*(l+h)/l),p[2]+(a=a*(l+u)/l)])),new s(o.COORDS_BY_USER,i,this.board)},h.updateQuadraticform=n.Circle.prototype.updateQuadraticform,h.updateStdform=n.Circle.prototype.updateStdform,h.methodMap=t.deepCopy(h.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),h.prepareUpdate().update(),h},t.registerElement("arc",t.createArc),t.createSemicircle=function(t,e,i){var s,n,o,a;if(!1===(a=r.providePoints(t,e,i,"point"))||2!==a.length)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point]");return o=r.copyAttributes(i,t.options,"semicircle","center"),(n=t.create("midpoint",a,o)).dump=!1,o=r.copyAttributes(i,t.options,"semicircle"),(s=t.create("arc",[n,a[1],a[0]],o)).elType="semicircle",s.setParents([a[0].id,a[1].id]),s.subs={midpoint:n},s.inherits.push(n),s.midpoint=s.center=n,s},t.registerElement("semicircle",t.createSemicircle),t.createCircumcircleArc=function(t,e,i){var s,n,o,a;if(!1===(a=r.providePoints(t,e,i,"point"))||3!==a.length)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]");return o=r.copyAttributes(i,t.options,"circumcirclearc","center"),(n=t.create("circumcenter",a,o)).dump=!1,(o=r.copyAttributes(i,t.options,"circumcirclearc")).usedirection=!0,(s=t.create("arc",[n,a[0],a[2],a[1]],o)).elType="circumcirclearc",s.setParents([a[0].id,a[1].id,a[2].id]),s.subs={center:n},s.inherits.push(n),s.center=n,s},t.registerElement("circumcirclearc",t.createCircumcircleArc),t.createMinorArc=function(e,i,s){return s.selection="minor",t.createArc(e,i,s)},t.registerElement("minorarc",t.createMinorArc),t.createMajorArc=function(e,i,s){return s.selection="major",t.createArc(e,i,s)},t.registerElement("majorarc",t.createMajorArc),{createArc:t.createArc,createSemicircle:t.createSemicircle,createCircumcircleArc:t.createCircumcircleArc,createMinorArc:t.createMinorArc,createMajorArc:t.createMajorArc}})),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],(function(t,e,i,s,n,r,o,a,l,c,h){"use strict";return t.createSector=function(a,l,c){var h,u,d,p,f,m="invalid";if(l[0].elementClass===r.OBJECT_CLASS_LINE&&l[1].elementClass===r.OBJECT_CLASS_LINE&&(o.isArray(l[2])||o.isNumber(l[2]))&&(o.isArray(l[3])||o.isNumber(l[3]))&&(o.isNumber(l[4])||o.isFunction(l[4])))m="2lines";else{if(!1===(f=o.providePoints(a,l,c,"sector",["center","radiuspoint","anglepoint"])))throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof l[0]+"' and '"+typeof l[1]+"' and '"+typeof l[2]+"'.");m="3points"}return u=o.copyAttributes(c,a.options,"sector"),(h=a.create("curve",[[0],[0]],u)).type=r.OBJECT_TYPE_SECTOR,h.elType="sector","2lines"===m?(h.Radius=function(){return o.evaluate(l[4])},h.line1=a.select(l[0]),h.line2=a.select(l[1]),h.line1.addChild(h),h.line2.addChild(h),h.setParents(l),h.point1={visProp:{}},h.point2={visProp:{}},h.point3={visProp:{}},d=e.meetLineLine(h.line1.stdform,h.line2.stdform,0,a),o.isArray(l[2])?(2===l[2].length&&(l[2]=[1].concat(l[2])),p=e.projectPointToLine({coords:{usrCoords:l[2]}},h.line1,a),p=s.subtract(p.usrCoords,d.usrCoords),h.direction1=i.innerProduct(p,[0,h.line1.stdform[2],-h.line1.stdform[1]],3)>=0?1:-1):h.direction1=l[2]>=0?1:-1,o.isArray(l[3])?(2===l[3].length&&(l[3]=[1].concat(l[3])),p=e.projectPointToLine({coords:{usrCoords:l[3]}},h.line2,a),p=s.subtract(p.usrCoords,d.usrCoords),h.direction2=i.innerProduct(p,[0,h.line2.stdform[2],-h.line2.stdform[1]],3)>=0?1:-1):h.direction2=l[3]>=0?1:-1,h.updateDataArray=function(){var t,o,a,l,c,u,d=[0,0,0];if(d=i.crossProduct((o=this.line1).stdform,(a=this.line2).stdform),Math.abs(d[0])>i.eps*i.eps&&(d[1]/=d[0],d[2]/=d[0],d[0]/=d[0]),t=this.direction1*this.Radius(),c=s.add(d,[0,t*o.stdform[2],-t*o.stdform[1]]),t=this.direction2*this.Radius(),u=s.add(d,[0,t*a.stdform[2],-t*a.stdform[1]]),this.point2.coords=new n(r.COORDS_BY_USER,c,h.board),this.point1.coords=new n(r.COORDS_BY_USER,d,h.board),this.point3.coords=new n(r.COORDS_BY_USER,u,h.board),Math.abs(c[0])<i.eps||Math.abs(d[0])<i.eps||Math.abs(u[0])<i.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);l=e.bezierArc(c,d,u,!0,1),this.dataX=l[0],this.dataY=l[1],this.bezierDegree=3},h.methodMap=t.deepCopy(h.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),h.prepareUpdate().update()):"3points"===m&&(h.point1=f[0],h.point2=f[1],h.point3=f[2],h.point1.addChild(h),h.point2.addChild(h),h.point3.addChild(h),h.useDirection=c.usedirection,h.setParents(f),o.exists(f[3])&&(h.point4=f[3],h.point4.addChild(h)),h.methodMap=t.deepCopy(h.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),h.updateDataArray=function(){var t,i,s,n,r,a=this.point2,l=this.point1,c=this.point3,h=1,u=o.evaluate(this.visProp.selection);if(!a.isReal||!l.isReal||!c.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);r=e.rad(a,l,c),("minor"===u&&r>Math.PI||"major"===u&&r<Math.PI)&&(h=-1),this.useDirection&&o.exists(this.point4)&&((i=this.point2.coords.usrCoords)[1]-(n=this.point3.coords.usrCoords)[1])*(i[2]-(s=this.point4.coords.usrCoords)[2])-(i[2]-n[2])*(i[1]-s[1])>=0&&(c=this.point2,a=this.point3),t=e.bezierArc(a=a.coords.usrCoords,l=l.coords.usrCoords,c=c.coords.usrCoords,!0,h),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3},h.Radius=function(){return this.point2.Dist(this.point1)},(u=o.copyAttributes(c,a.options,"sector","arc")).withLabel=!1,u.name+="_arc",h.arc=a.create("arc",[h.point1,h.point2,h.point3],u),h.addChild(h.arc)),h.center=h.point1,h.radiuspoint=h.point2,h.anglepoint=h.point3,h.hasPointCurve=function(t,i){var s,a,l,c,h,u=new n(r.COORDS_BY_SCREEN,[t,i],this.board),d=this.Radius(),p=this.center.coords.distance(r.COORDS_BY_USER,u),f=o.evaluate(this.visProp.selection);return c=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),(h=Math.abs(p-d)<c)&&(s=e.rad(this.point2,this.center,u.usrCoords.slice(1)),a=0,l=e.rad(this.point2,this.center,this.point3),("minor"===f&&l>Math.PI||"major"===f&&l<Math.PI)&&(a=l,l=2*Math.PI),(s<a||s>l)&&(h=!1)),h},h.hasPointSector=function(t,i){var s,a,l,c=new n(r.COORDS_BY_SCREEN,[t,i],this.board),h=this.Radius(),u=this.point1.coords.distance(r.COORDS_BY_USER,c)<h,d=o.evaluate(this.visProp.selection);return u&&(s=e.rad(this.radiuspoint,this.center,c.usrCoords.slice(1)),a=0,l=e.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===d&&l>Math.PI||"major"===d&&l<Math.PI)&&(a=l,l=2*Math.PI),(s<a||s>l)&&(u=!1)),u},h.hasPoint=function(t,e){return o.evaluate(this.visProp.highlightonsector)||o.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(t,e):this.hasPointCurve(t,e)},h.getTextAnchor=function(){return this.point1.coords},h.getLabelAnchor=function(){var t,i,s,a,l,c=e.rad(this.point2,this.point1,this.point3),h=13/this.board.unitX,u=13/this.board.unitY,d=this.point2.coords.usrCoords,p=this.point1.coords.usrCoords,f=d[1]-p[1],m=d[2]-p[2],g=o.evaluate(this.visProp.selection),b=this.label?this.label.visProp:this.visProp.label;return("minor"===g&&c>Math.PI||"major"===g&&c<Math.PI)&&(c=-(2*Math.PI-c)),s=(t=new n(r.COORDS_BY_USER,[p[1]+Math.cos(.5*c)*f-Math.sin(.5*c)*m,p[2]+Math.sin(.5*c)*f+Math.cos(.5*c)*m],this.board)).usrCoords[1]-p[1],a=t.usrCoords[2]-p[2],l=Math.sqrt(s*s+a*a),b.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],i=[p[1]+(s=s*(l+h)/l),p[2]+(a=a*(l+u)/l)])),new n(r.COORDS_BY_USER,i,this.board)},h.setRadius=function(t){h.Radius=function(){return o.evaluate(t)}},h.getRadius=function(){return t.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},"3points"===m&&(h.setPositionDirectly=function(t,e,i){var r,o=new n(t,e,this.board),a=new n(t,i,this.board);return h.point1.draggable()&&h.point2.draggable()&&h.point3.draggable()?(r=s.subtract(o.usrCoords,a.usrCoords),this.board.create("transform",r.slice(1),{type:"translate"}).applyOnce([h.point1,h.point2,h.point3]),this):this}),h.prepareUpdate().update(),h},t.registerElement("sector",t.createSector),t.createCircumcircleSector=function(t,e,i){var s,n,r,a;if(!1===(a=o.providePoints(t,e,i,"point")))throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");return(n=t.create("circumcenter",a.slice(0,3),r)).dump=!1,r=o.copyAttributes(i,t.options,"circumcirclesector"),(s=t.create("sector",[n,a[0],a[2],a[1]],r)).elType="circumcirclesector",s.setParents(a),s.center=n,s.subs={center:n},s},t.registerElement("circumcirclesector",t.createCircumcircleSector),t.createMinorSector=function(e,i,s){return s.selection="minor",t.createSector(e,i,s)},t.registerElement("minorsector",t.createMinorSector),t.createMajorSector=function(e,i,s){return s.selection="major",t.createSector(e,i,s)},t.registerElement("majorsector",t.createMajorSector),t.createAngle=function(t,s,a){var l,c,h,u,d,p,f="invalid";if(s[0].elementClass===r.OBJECT_CLASS_LINE&&s[1].elementClass===r.OBJECT_CLASS_LINE&&(o.isArray(s[2])||o.isNumber(s[2]))&&(o.isArray(s[3])||o.isNumber(s[3])))f="2lines";else{if(!1===(p=o.providePoints(t,s,a,"point")))throw new Error("JSXGraph: Can't create angle with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"' and '"+typeof s[2]+"'.");f="3points"}if(h=o.copyAttributes(a,t.options,"angle"),o.exists(h.name)&&""!==h.name||(h.name=t.generateName({type:r.OBJECT_TYPE_ANGLE})),c=o.exists(h.radius)?h.radius:0,"2lines"===f?(s.push(c),(l=t.create("sector",s,h)).updateDataArraySector=l.updateDataArray,l.setAngle=function(t){},l.free=function(t){}):((l=t.create("sector",[p[1],p[0],p[2]],h)).arc.visProp.priv=!0,l.point=l.point2=l.radiuspoint=p[0],l.pointsquare=l.point3=l.anglepoint=p[2],l.Radius=function(){return o.evaluate(c)},l.updateDataArraySector=function(){var t,i,s=this.point2,n=this.point1,r=this.point3,a=this.Radius(),l=n.Dist(s),c=1,h=o.evaluate(this.visProp.selection);i=e.rad(s,n,r),("minor"===h&&i>Math.PI||"major"===h&&i<Math.PI)&&(c=-1),t=e.bezierArc(s=[1,(n=n.coords.usrCoords)[1]+((s=s.coords.usrCoords)[1]-n[1])*a/l,n[2]+(s[2]-n[2])*a/l],n,r=[1,n[1]+((r=r.coords.usrCoords)[1]-n[1])*a/l,n[2]+(r[2]-n[2])*a/l],!0,c),this.dataX=t[0],this.dataY=t[1],this.bezierDegree=3},l.setAngle=function(t){var e,i=this.anglepoint,s=this.radiuspoint;return i.draggable()&&(e=this.board.create("transform",[t,this.center],{type:"rotate"}),i.addTransform(s,e),i.isDraggable=!1,i.setParents(s)),this},l.free=function(){var t=this.anglepoint;return t.transformations.length>0&&(t.transformations.pop(),t.isDraggable=!0,t.parents=[]),this},l.setParents(p)),o.exists(l.visProp.text)&&l.label.setText(o.evaluate(l.visProp.text)),l.elType="angle",l.type=r.OBJECT_TYPE_ANGLE,l.subs={},l.updateDataArraySquare=function(){var t,s,n,r,o,a,l,c=this.Radius();"2lines"===f&&this.updateDataArraySector(),n=(n=this.point3).coords.usrCoords,r=e.distance(t=(t=this.point2).coords.usrCoords,s=(s=this.point1).coords.usrCoords,3),o=e.distance(n,s,3),t=[1,s[1]+(t[1]-s[1])*c/r,s[2]+(t[2]-s[2])*c/r],a=i.crossProduct(n=[1,s[1]+(n[1]-s[1])*c/o,s[2]+(n[2]-s[2])*c/o],s),l=[-t[1]*a[1]-t[2]*a[2],t[0]*a[1],t[0]*a[2]],a=i.crossProduct(t,s),(a=i.crossProduct(l,[-n[1]*a[1]-n[2]*a[2],n[0]*a[1],n[0]*a[2]]))[1]/=a[0],a[2]/=a[0],this.dataX=[s[1],t[1],a[1],n[1],s[1]],this.dataY=[s[2],t[2],a[2],n[2],s[2]],this.bezierDegree=1},l.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},l.updateDataArray=function(){var t=o.evaluate(this.visProp.type),s=e.trueAngle(this.point2,this.point1,this.point3),n=o.evaluate(this.visProp.selection);("minor"===n&&s>180||"major"===n&&s<180)&&(s=360-s),Math.abs(s-90)<o.evaluate(this.visProp.orthosensitivity)+i.eps&&(t=o.evaluate(this.visProp.orthotype)),"none"===t?this.updateDataArrayNone():"square"===t?this.updateDataArraySquare():"sector"===t?this.updateDataArraySector():"sectordot"===t&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||"sectordot"!==t&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},u=o.copyAttributes(a,t.options,"angle","dot"),l.dot=t.create("point",[function(){var t,s,n,r,a,c,h,u;return o.exists(l.dot)&&!l.dot.visProp.visible?[0,0]:(t=l.point2.coords.usrCoords,s=l.point1.coords.usrCoords,n=l.Radius(),r=e.distance(t,s,3),a=e.rad(l.point2,l.point1,l.point3),("minor"===(u=o.evaluate(l.visProp.selection))&&a>Math.PI||"major"===u&&a<Math.PI)&&(a=-(2*Math.PI-a)),a*=.5,c=Math.cos(a),h=Math.sin(a),i.matVecMult([[1,0,0],[s[1]-.5*s[1]*c+.5*s[2]*h,.5*c,.5*-h],[s[2]-.5*s[1]*h-.5*s[2]*c,.5*h,.5*c]],t=[1,s[1]+(t[1]-s[1])*n/r,s[2]+(t[2]-s[2])*n/r]))}],u),l.dot.dump=!1,l.subs.dot=l.dot,"2lines"===f)for(d=0;d<2;d++)t.select(s[d]).addChild(l.dot);else for(d=0;d<3;d++)t.select(p[d]).addChild(l.dot);return l.getLabelAnchor=function(){var t,s,a,c,h,u,d,p,f=12,m=o.evaluate(l.visProp.selection),g=this.label?this.label.visProp:this.visProp.label;return o.exists(this.label.visProp.fontSize)&&(f=dy=o.evaluate(this.label.visProp.fontSize)),f/=this.board.unitX,s=l.point2.coords.usrCoords,a=l.point1.coords.usrCoords,c=l.Radius(),h=e.distance(s,a,3),u=e.rad(l.point2,l.point1,l.point3),("minor"===m&&u>Math.PI||"major"===m&&u<Math.PI)&&(u=-(2*Math.PI-u)),u*=.5,d=Math.cos(u),p=Math.sin(u),(t=i.matVecMult([[1,0,0],[a[1]-.5*a[1]*d+.5*a[2]*p,.5*d,.5*-p],[a[2]-.5*a[1]*p-.5*a[2]*d,.5*p,.5*d]],s=[1,a[1]+(s[1]-a[1])*c/h,a[2]+(s[2]-a[2])*c/h]))[1]/=t[0],t[2]/=t[0],t[0]/=t[0],h=e.distance(t,a,3),g.position=e.calcLabelQuadrant(e.rad([1,0],[0,0],t=[t[0],a[1]+(t[1]-a[1])*(c+f)/h,a[2]+(t[2]-a[2])*(c+f)/h])),new n(r.COORDS_BY_USER,t,this.board)},l.Value=function(){return e.rad(this.point2,this.point1,this.point3)},l.methodMap=o.deepCopy(l.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),l},t.registerElement("angle",t.createAngle),t.createNonreflexAngle=function(i,s,n){var r;return n.selection="minor",(r=t.createAngle(i,s,n)).Value=function(){var t=e.rad(this.point2,this.point1,this.point3);return t<Math.PI?t:2*Math.PI-t},r},t.registerElement("nonreflexangle",t.createNonreflexAngle),t.createReflexAngle=function(i,s,n){var r;return n.selection="major",(r=t.createAngle(i,s,n)).Value=function(){var t=e.rad(this.point2,this.point1,this.point3);return t>=Math.PI?t:2*Math.PI-t},r},t.registerElement("reflexangle",t.createReflexAngle),{createSector:t.createSector,createCircumcircleSector:t.createCircumcircleSector,createMinorSector:t.createMinorSector,createMajorSector:t.createMajorSector,createAngle:t.createAngle,createReflexAngle:t.createReflexAngle,createNonreflexAngle:t.createNonreflexAngle}})),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],(function(t,e,i,s,n,r,o,a,l,c,h,u,d,p,f,m,g,b){"use strict";return t.createOrthogonalProjection=function(t,e,s){var n,r,l,c;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],s,"point")[0],n=e[1];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,line]");r=o.providePoints(t,[e[1]],s,"point")[0],n=e[0]}return c=o.copyAttributes(s,t.options,"orthogonalprojection"),l=t.create("point",[function(){return i.projectPointToLine(r,n,t)}],c),r.addChild(l),n.addChild(l),l.elType="orthogonalprojection",l.setParents([r.id,l.id]),l.update(),l.generatePolynomial=function(){var t=n.point1.symbolic.x,e=n.point1.symbolic.y,i=n.point2.symbolic.x,s=n.point2.symbolic.y,o=r.symbolic.x,a=r.symbolic.y,c=l.symbolic.x,h=l.symbolic.y;return["("+e+")*("+c+")-("+e+")*("+i+")+("+h+")*("+i+")-("+t+")*("+h+")+("+t+")*("+s+")-("+c+")*("+s+")","("+a+")*("+e+")-("+a+")*("+s+")-("+h+")*("+e+")+("+h+")*("+s+")+("+o+")*("+t+")-("+o+")*("+i+")-("+c+")*("+t+")+("+c+")*("+i+")"]},l},t.createPerpendicular=function(t,e,i){var s,n,r,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)n=e[1],s=o.providePoints(t,[e[0]],i,"point")[0];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [line,point]");n=e[0],s=o.providePoints(t,[e[1]],i,"point")[0]}return l=o.copyAttributes(i,t.options,"perpendicular"),(r=c.createLine(t,[function(){return n.stdform[2]*s.X()-n.stdform[1]*s.Y()},function(){return-n.stdform[2]*s.Z()},function(){return n.stdform[1]*s.Z()}],l)).elType="perpendicular",r.setParents([n.id,s.id]),r},t.createPerpendicularPoint=function(t,e,s){var n,r,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],s,"point")[0],n=e[1];else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,line]");r=o.providePoints(t,[e[1]],s,"point")[0],n=e[0]}return l=t.create("point",[function(){return i.perpendicular(n,r,t)[0]}],s),r.addChild(l),n.addChild(l),l.elType="perpendicularpoint",l.setParents([r.id,n.id]),l.update(),l.generatePolynomial=function(){var t=n.point1.symbolic.x,e=n.point1.symbolic.y,i=n.point2.symbolic.x,s=n.point2.symbolic.y,o=r.symbolic.x,a=r.symbolic.y,c=l.symbolic.x,h=l.symbolic.y;return["("+e+")*("+c+")-("+e+")*("+i+")+("+h+")*("+i+")-("+t+")*("+h+")+("+t+")*("+s+")-("+c+")*("+s+")","("+a+")*("+e+")-("+a+")*("+s+")-("+h+")*("+e+")+("+h+")*("+s+")+("+o+")*("+t+")-("+o+")*("+i+")-("+c+")*("+t+")+("+c+")*("+i+")"]},l},t.createPerpendicularSegment=function(e,s,n){var r,l,h,u,d;if(s[0]=e.select(s[0]),s[1]=e.select(s[1]),o.isPointType(e,s[0])&&s[1].elementClass===a.OBJECT_CLASS_LINE)l=s[1],r=o.providePoints(e,[s[0]],n,"point")[0];else{if(!o.isPointType(e,s[1])||s[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof s[0]+"' and '"+typeof s[1]+"'.\nPossible parent types: [line,point]");l=s[0],r=o.providePoints(e,[s[1]],n,"point")[0]}return d=o.copyAttributes(n,e.options,"perpendicularsegment","point"),(u=t.createPerpendicularPoint(e,[l,r],d)).dump=!1,o.exists(n.layer)||(n.layer=e.options.layer.line),d=o.copyAttributes(n,e.options,"perpendicularsegment"),(h=c.createLine(e,[function(){return i.perpendicular(l,r,e)[1]?[u,r]:[r,u]}],d)).point=u,h.elType="perpendicularsegment",h.setParents([r.id,l.id]),h.subs={point:u},h.inherits.push(u),h},t.createMidpoint=function(t,i,s){var n,r,l,c,h;for(c=0;c<i.length;++c)i[c]=t.select(i[c]);if(2===i.length&&o.isPointType(t,i[0])&&o.isPointType(t,i[1]))i=o.providePoints(t,i,s,"point"),n=i[0],r=i[1];else{if(1!==i.length||i[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");n=i[0].point1,r=i[0].point2}return h=o.copyAttributes(s,t.options,"midpoint"),l=t.create("point",[function(){var t=n.coords.usrCoords[1]+r.coords.usrCoords[1];return isNaN(t)||Math.abs(n.coords.usrCoords[0])<e.eps||Math.abs(r.coords.usrCoords[0])<e.eps?NaN:.5*t},function(){var t=n.coords.usrCoords[2]+r.coords.usrCoords[2];return isNaN(t)||Math.abs(n.coords.usrCoords[0])<e.eps||Math.abs(r.coords.usrCoords[0])<e.eps?NaN:.5*t}],h),n.addChild(l),r.addChild(l),l.elType="midpoint",l.setParents([n.id,r.id]),l.prepareUpdate().update(),l.generatePolynomial=function(){var t=n.symbolic.x,e=n.symbolic.y,i=r.symbolic.x,s=r.symbolic.y,o=l.symbolic.x,a=l.symbolic.y;return["("+e+")*("+o+")-("+e+")*("+i+")+("+a+")*("+i+")-("+t+")*("+a+")+("+t+")*("+s+")-("+o+")*("+s+")","("+t+")^2 - 2*("+t+")*("+o+")+("+e+")^2-2*("+e+")*("+a+")-("+i+")^2+2*("+i+")*("+o+")-("+s+")^2+2*("+s+")*("+a+")"]},l},t.createParallelPoint=function(t,e,i){var s,n,r,l,c;for(c=0;c<e.length;++c)e[c]=t.select(e[c]);if(3===e.length&&o.isPointType(t,e[0])&&o.isPointType(t,e[1])&&o.isPointType(t,e[2]))e=o.providePoints(t,e,i,"point"),s=e[0],n=e[1],r=e[2];else if(o.isPointType(t,e[0])&&e[1].elementClass===a.OBJECT_CLASS_LINE)r=o.providePoints(t,[e[0]],i,"point")[0],s=e[1].point1,n=e[1].point2;else{if(!o.isPointType(t,e[1])||e[0].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [line,point], [point,point,point]");r=o.providePoints(t,[e[1]],i,"point")[0],s=e[0].point1,n=e[0].point2}return l=t.create("point",[function(){return r.coords.usrCoords[1]+n.coords.usrCoords[1]-s.coords.usrCoords[1]},function(){return r.coords.usrCoords[2]+n.coords.usrCoords[2]-s.coords.usrCoords[2]}],i),s.addChild(l),n.addChild(l),r.addChild(l),l.elType="parallelpoint",l.setParents([s.id,n.id,r.id]),l.prepareUpdate().update(),l.generatePolynomial=function(){var t=s.symbolic.x,e=s.symbolic.y,i=n.symbolic.x,o=n.symbolic.y,a=r.symbolic.x,c=r.symbolic.y,h=l.symbolic.x,u=l.symbolic.y;return["("+o+")*("+h+")-("+o+")*("+a+")-("+e+")*("+h+")+("+e+")*("+a+")-("+u+")*("+i+")+("+u+")*("+t+")+("+c+")*("+i+")-("+c+")*("+t+")","("+u+")*("+t+")-("+u+")*("+a+")-("+o+")*("+t+")+("+o+")*("+a+")-("+h+")*("+e+")+("+h+")*("+c+")+("+i+")*("+e+")-("+i+")*("+c+")"]},l},t.createParallel=function(t,i,s){var n,r,a,l,c,h;for(c=0;c<i.length;++c)i[c]=t.select(i[c]);return n=null,3===i.length?(n=(i=o.providePoints(t,i,s,"point"))[2],l=function(){return e.crossProduct(i[0].coords.usrCoords,i[1].coords.usrCoords)}):o.isPointType(t,i[0])?(n=o.providePoints(t,[i[0]],s,"point")[0],l=function(){return i[1].stdform}):o.isPointType(t,i[1])&&(n=o.providePoints(t,[i[1]],s,"point")[0],l=function(){return i[0].stdform}),o.exists(s.layer)||(s.layer=t.options.layer.line),h=o.copyAttributes(s,t.options,"parallel","point"),(r=t.create("point",[function(){return e.crossProduct([1,0,0],l())}],h)).isDraggable=!0,h=o.copyAttributes(s,t.options,"parallel"),(a=t.create("line",[n,r],h)).elType="parallel",a.subs={point:r},a.inherits.push(r),a.setParents([i[0].id,i[1].id]),3===i.length&&a.addParents(i[2].id),a.point=r,a},t.createArrowParallel=function(e,i,s){var n;try{return s.firstArrow=!1,s.lastArrow=!0,(n=t.createParallel(e,i,s).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",n}catch(t){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [line,point], [point,point,point]")}},t.createNormal=function(t,i,n){var r,l,c,h,u,d,p,f,m;for(h=0;h<i.length;++h)i[h]=t.select(i[h]);if(1===i.length)l=(r=i[0]).slideObject;else{if(2!==i.length)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");if(o.isPointType(t,i[0]))r=o.providePoints(t,[i[0]],n,"point")[0],l=i[1];else{if(!o.isPointType(t,i[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");l=i[0],r=o.providePoints(t,[i[1]],n,"point")[0]}}if(p=o.copyAttributes(n,t.options,"normal"),l.elementClass===a.OBJECT_CLASS_LINE)m=o.copyAttributes(n,t.options,"normal","point"),(f=t.create("point",[function(){var t=e.crossProduct([1,0,0],l.stdform);return[t[0],-t[2],t[1]]}],m)).isDraggable=!0,(c=t.create("line",[r,f],p)).point=f,c.subs={point:f},c.inherits.push(f);else if(l.elementClass===a.OBJECT_CLASS_CIRCLE)c=t.create("line",[l.midpoint,r],p);else if(l.elementClass===a.OBJECT_CLASS_CURVE)"plot"!==o.evaluate(l.visProp.curvetype)?(u=l.X,d=l.Y,c=t.create("line",[function(){return-r.X()*s.D(u)(r.position)-r.Y()*s.D(d)(r.position)},function(){return s.D(u)(r.position)},function(){return s.D(d)(r.position)}],p)):c=t.create("line",[function(){var t=Math.floor(r.position),e=r.position-t;return t===l.numberPoints-1&&(t-=1,e=1),t<0?1:(l.Y(t)+e*(l.Y(t+1)-l.Y(t)))*(l.Y(t)-l.Y(t+1))-(l.X(t)+e*(l.X(t+1)-l.X(t)))*(l.X(t+1)-l.X(t))},function(){var t=Math.floor(r.position);return t===l.numberPoints-1&&(t-=1),t<0?0:l.X(t+1)-l.X(t)},function(){var t=Math.floor(r.position);return t===l.numberPoints-1&&(t-=1),t<0?0:l.Y(t+1)-l.Y(t)}],p);else{if(l.type!==a.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");c=t.create("line",[function(){var t,e,i=Math.floor(r.position),s=r.position-i;for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1,s=1),i<0?1:(t.Y(i)+s*(t.Y(i+1)-t.Y(i)))*(t.Y(i)-t.Y(i+1))-(t.X(i)+s*(t.X(i+1)-t.X(i)))*(t.X(i+1)-t.X(i))},function(){var t,e,i=Math.floor(r.position);for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1),i<0?0:t.X(i+1)-t.X(i)},function(){var t,e,i=Math.floor(r.position);for(e=0;e<l.objects.length;e++)if((t=l.objects[e]).type===a.OBJECT_TYPE_CURVE){if(i<t.numberPoints)break;i-=t.numberPoints}return i===t.numberPoints-1&&(i-=1),i<0?0:t.Y(i+1)-t.Y(i)}],p)}return c.elType="normal",c.setParents(i),c},t.createBisector=function(t,e,s){var n,r,a,l;if(e=o.providePoints(t,e,s,"point"),o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])){for((l=o.copyAttributes(s,t.options,"bisector","point")).snapToGrid=!1,(n=t.create("point",[function(){return i.angleBisector(e[0],e[1],e[2],t)}],l)).dump=!1,a=0;a<3;a++)e[a].addChild(n);return o.exists(s.layer)||(s.layer=t.options.layer.line),l=o.copyAttributes(s,t.options,"bisector"),(r=c.createLine(t,[e[1],n],l)).point=n,r.elType="bisector",r.setParents(e),r.subs={point:n},r.inherits.push(n),r}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point,point]")},t.createAngularBisectorsOfTwoLines=function(t,e,i){var s,n,r,l,c=t.select(e[0]),h=t.select(e[1]);if(c.elementClass!==a.OBJECT_CLASS_LINE||h.elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [line,line]");return o.exists(i.layer)||(i.layer=t.options.layer.line),r=o.copyAttributes(i,t.options,"bisectorlines","line1"),s=t.create("line",[function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[0]/t-h.stdform[0]/e},function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[1]/t-h.stdform[1]/e},function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[2]/t-h.stdform[2]/e}],r),o.exists(i.layer)||(i.layer=t.options.layer.line),r=o.copyAttributes(i,t.options,"bisectorlines","line2"),n=t.create("line",[function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[0]/t+h.stdform[0]/e},function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[1]/t+h.stdform[1]/e},function(){var t=Math.sqrt(c.stdform[1]*c.stdform[1]+c.stdform[2]*c.stdform[2]),e=Math.sqrt(h.stdform[1]*h.stdform[1]+h.stdform[2]*h.stdform[2]);return c.stdform[2]/t+h.stdform[2]/e}],r),l=new d({line1:s,line2:n}),s.dump=!1,n.dump=!1,l.elType="bisectorlines",l.setParents([c.id,h.id]),l.subs={line1:s,line2:n},l},t.createCircumcenter=function(t,e,s){var n,r,a,c,h;if(e=o.providePoints(t,e,s,"point"),o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])){for(a=e[0],c=e[1],h=e[2],n=l.createPoint(t,[function(){return i.circumcenter(a,c,h,t)}],s),r=0;r<3;r++)e[r].addChild(n);return n.elType="circumcenter",n.setParents(e),n.generatePolynomial=function(){var t=a.symbolic.x,e=a.symbolic.y,i=h.symbolic.x,s=h.symbolic.y,r=n.symbolic.x,o=n.symbolic.y;return[["((",r,")-(",t,"))^2+((",o,")-(",e,"))^2-((",r,")-(",c.symbolic.x,"))^2-((",o,")-(",c.symbolic.y,"))^2"].join(""),["((",r,")-(",t,"))^2+((",o,")-(",e,"))^2-((",r,")-(",i,"))^2-((",o,")-(",s,"))^2"].join("")]},n}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]")},t.createIncenter=function(t,e,i){var s,n,l,c;if(!((e=o.providePoints(t,e,i,"point")).length>=3&&o.isPoint(e[0])&&o.isPoint(e[1])&&o.isPoint(e[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+"'.\nPossible parent types: [point,point,point]");return n=e[0],l=e[1],c=e[2],(s=t.create("point",[function(){var e,i,s;return e=Math.sqrt((l.X()-c.X())*(l.X()-c.X())+(l.Y()-c.Y())*(l.Y()-c.Y())),i=Math.sqrt((n.X()-c.X())*(n.X()-c.X())+(n.Y()-c.Y())*(n.Y()-c.Y())),s=Math.sqrt((l.X()-n.X())*(l.X()-n.X())+(l.Y()-n.Y())*(l.Y()-n.Y())),new r(a.COORDS_BY_USER,[(e*n.X()+i*l.X()+s*c.X())/(e+i+s),(e*n.Y()+i*l.Y()+s*c.Y())/(e+i+s)],t)}],i)).elType="incenter",s.setParents(e),s},t.createCircumcircle=function(e,i,s){var n,r,a;if(!1===(i=o.providePoints(e,i,s,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]");try{a=o.copyAttributes(s,e.options,"circumcircle","center"),(n=t.createCircumcenter(e,i,a)).dump=!1,o.exists(s.layer)||(s.layer=e.options.layer.circle),a=o.copyAttributes(s,e.options,"circumcircle"),(r=h.createCircle(e,[n,i[0]],a)).elType="circumcircle",r.setParents(i),r.subs={center:n},r.inherits.push(r)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]")}return r},t.createIncircle=function(e,i,s){var n,r,a;if(!1===(i=o.providePoints(e,i,s,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]");try{a=o.copyAttributes(s,e.options,"incircle","center"),(n=t.createIncenter(e,i,a)).dump=!1,o.exists(s.layer)||(s.layer=e.options.layer.circle),a=o.copyAttributes(s,e.options,"incircle"),(r=h.createCircle(e,[n,function(){var t=Math.sqrt((i[1].X()-i[2].X())*(i[1].X()-i[2].X())+(i[1].Y()-i[2].Y())*(i[1].Y()-i[2].Y())),e=Math.sqrt((i[0].X()-i[2].X())*(i[0].X()-i[2].X())+(i[0].Y()-i[2].Y())*(i[0].Y()-i[2].Y())),s=Math.sqrt((i[1].X()-i[0].X())*(i[1].X()-i[0].X())+(i[1].Y()-i[0].Y())*(i[1].Y()-i[0].Y())),n=(t+e+s)/2;return Math.sqrt((n-t)*(n-e)*(n-s)/n)}],a)).elType="incircle",r.setParents(i),r.center=n,r.subs={center:r.center},r.inherits.push(n)}catch(t){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof i[0]+"', '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point]")}return r},t.createReflection=function(t,e,i){var s,n,r,d,f,g="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]";for(f=0;f<e.length;++f)e[f]=t.select(e[f]);if(o.isPoint(e[0]))n=o.providePoints(t,[e[0]],i,"point")[0];else{if(e[0].elementClass!==a.OBJECT_CLASS_CURVE&&e[0].elementClass!==a.OBJECT_CLASS_LINE&&e[0].type!==a.OBJECT_TYPE_POLYGON&&e[0].elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);n=e[0]}if(e[1].elementClass!==a.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);if(d=u.createTransform(t,[s=e[1]],{type:"reflect"}),o.isPoint(n))r=l.createPoint(t,[n,d],i);else if(n.elementClass===a.OBJECT_CLASS_CURVE)r=p.createCurve(t,[n,d],i);else if(n.elementClass===a.OBJECT_CLASS_LINE)r=c.createLine(t,[n,d],i);else if(n.type===a.OBJECT_TYPE_POLYGON)r=m.createPolygon(t,[n,d],i);else{if(n.elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+g);r=h.createCircle(t,[n,d],i)}return n.addChild(r),s.addChild(r),r.elType="reflection",r.setParents([n,s]),r.prepareUpdate().update(),o.isPoint(r)&&(r.generatePolynomial=function(){var t=s.point1.symbolic.x,e=s.point1.symbolic.y,i=n.symbolic.x,o=n.symbolic.y,a=r.symbolic.x,l=r.symbolic.y;return[["((",l,")-(",o,"))*((",e,")-(",s.point2.symbolic.y,"))+((",t,")-(",s.point2.symbolic.x,"))*((",a,")-(",i,"))"].join(""),["((",a,")-(",t,"))^2+((",l,")-(",e,"))^2-((",i,")-(",t,"))^2-((",o,")-(",e,"))^2"].join("")]}),r},t.createMirrorElement=function(t,e,i){var s,n,r,d,f="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]";if(o.isPoint(e[0]))s=o.providePoints(t,[e[0]],i,"point")[0];else{if(e[0].elementClass!==a.OBJECT_CLASS_CURVE&&e[0].elementClass!==a.OBJECT_CLASS_LINE&&e[0].type!==a.OBJECT_TYPE_POLYGON&&e[0].elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);s=e[0]}if(!o.isPoint(e[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);if(n=o.providePoints(t,[e[1]],i,"point")[0],d=u.createTransform(t,[Math.PI,n],{type:"rotate"}),o.isPoint(s))r=l.createPoint(t,[s,d],i);else if(s.elementClass===a.OBJECT_CLASS_CURVE)r=p.createCurve(t,[s,d],i);else if(s.elementClass===a.OBJECT_CLASS_LINE)r=c.createLine(t,[s,d],i);else if(s.type===a.OBJECT_TYPE_POLYGON)r=m.createPolygon(t,[s,d],i);else{if(s.elementClass!==a.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+f);r=h.createCircle(t,[s,d],i)}return s.addChild(r),n.addChild(r),r.elType="mirrorpoint",r.setParents([s,n]),r.prepareUpdate().update(),r},t.createMirrorPoint=function(e,i,s){return t.createMirrorElement(e,i,s)},t.createIntegral=function(e,i,n){var l,c,h,u,d,p,f,m,g,b,y,v,x,C,_=null;if(o.isArray(i[0])&&i[1].elementClass===a.OBJECT_CLASS_CURVE)l=i[0],c=i[1];else{if(!o.isArray(i[1])||i[0].elementClass!==a.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [[number|function,number|function],curve]");l=i[1],c=i[0]}return(h=o.copyAttributes(n,e.options,"integral")).withLabel=!1,C=e.create("curve",[[0],[0]],h),d=l[1],o.isFunction(u=l[0])?(f=function(){return c.Y(p())},u=(p=u)()):(p=u,f=c.Y(u)),o.isFunction(d)?(g=function(){return c.Y(m())},d=(m=d)()):(m=d,g=c.Y(d)),h=o.copyAttributes(n,e.options,"integral","curveLeft"),b=e.create("glider",[p,f,c],h),o.isFunction(p)&&b.hideElement(),h=o.copyAttributes(n,e.options,"integral","baseLeft"),y=e.create("point",[function(){return"y"===o.evaluate(C.visProp.axis)?0:b.X()},function(){return"y"===o.evaluate(C.visProp.axis)?b.Y():0}],h),h=o.copyAttributes(n,e.options,"integral","curveRight"),v=e.create("glider",[m,g,c],h),o.isFunction(m)&&v.hideElement(),h=o.copyAttributes(n,e.options,"integral","baseRight"),x=e.create("point",[function(){return"y"===o.evaluate(C.visProp.axis)?0:v.X()},function(){return"y"===o.evaluate(C.visProp.axis)?v.Y():0}],h),!1!==(h=o.copyAttributes(n,e.options,"integral")).withlabel&&"y"!==h.axis&&(h=o.copyAttributes(n,e.options,"integral","label"),h=o.copyAttributes(h,e.options,"label"),(_=e.create("text",[function(){var t=new r(a.COORDS_BY_SCREEN,[o.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),e=this.board.getBoundingBox(),i=.1*(e[2]-e[0]),s=v.X();return s<e[0]?s=e[0]+i:s>e[2]&&(s=e[2]-i),s+t.usrCoords[1]},function(){var t=new r(a.COORDS_BY_SCREEN,[0,o.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),e=this.board.getBoundingBox(),i=.1*(e[1]-e[3]),s=v.Y();return s>e[1]?s=e[1]-i:s<e[3]&&(s=e[3]+i),s+t.usrCoords[2]},function(){var t=s.NewtonCotes([y.X(),x.X()],c.Y);return"&int; = "+o.toFixed(t,4)}],h)).dump=!1,b.addChild(_),v.addChild(_)),b.dump=!1,y.dump=!1,v.dump=!1,x.dump=!1,C.elType="integral",C.setParents([c.id,l]),C.subs={curveLeft:b,baseLeft:y,curveRight:v,baseRight:x},C.inherits.push(b,y,v,x),h.withLabel&&(C.subs.label=_,C.inherits.push(_)),C.Value=function(){return s.I([y.X(),x.X()],c.Y)},C.updateDataArray=function(){var t,e,i,s,n,r,a,l,h;if("y"===o.evaluate(this.visProp.axis)){for(b.Y()<v.Y()?(r=b.X(),l=b.Y(),a=v.X(),h=v.Y()):(r=v.X(),l=v.Y(),a=b.X(),h=b.Y()),s=Math.min(r,a),n=Math.max(r,a),t=[0,r],e=[l,l],i=0;i<c.numberPoints;i++)l<=c.points[i].usrCoords[2]&&s<=c.points[i].usrCoords[1]&&c.points[i].usrCoords[2]<=h&&c.points[i].usrCoords[1]<=n&&(t.push(c.points[i].usrCoords[1]),e.push(c.points[i].usrCoords[2]));t.push(a),e.push(h),t.push(0),e.push(h),t.push(0),e.push(l)}else{for(y.X()<x.X()?(s=y.X(),n=x.X()):(s=x.X(),n=y.X()),t=[s,s],e=[0,c.Y(s)],i=0;i<c.numberPoints;i++)s<=c.points[i].usrCoords[1]&&c.points[i].usrCoords[1]<=n&&(t.push(c.points[i].usrCoords[1]),e.push(c.points[i].usrCoords[2]));t.push(n),e.push(c.Y(n)),t.push(n),e.push(0),t.push(s),e.push(0)}this.dataX=t,this.dataY=e},b.addChild(C),v.addChild(C),y.addChild(C),x.addChild(C),C.baseLeft=y,C.baseRight=x,C.curveLeft=b,C.curveRight=v,C.methodMap=t.deepCopy(C.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),C.label=_,C},t.createGrid=function(t,e,i){var s,n;return n=o.copyAttributes(i,t.options,"grid"),(s=t.create("curve",[[null],[null]],n)).elType="grid",s.type=a.OBJECT_TYPE_GRID,s.updateDataArray=function(){var e,i,n,l,c,h=o.evaluate(this.visProp.gridx),u=o.evaluate(this.visProp.gridy);for(l=o.isArray(this.visProp.topleft)?new r(o.evaluate(this.visProp.tltype)||a.COORDS_BY_USER,this.visProp.topleft,t):new r(a.COORDS_BY_SCREEN,[0,0],t),c=o.isArray(this.visProp.bottomright)?new r(o.evaluate(this.visProp.brtype)||a.COORDS_BY_USER,this.visProp.bottomright,t):new r(a.COORDS_BY_SCREEN,[t.canvasWidth,t.canvasHeight],t),t.options.grid.hasGrid=!0,s.dataX=[],s.dataY=[],e=Math.floor(l.usrCoords[2]/u)*u,i=Math.ceil(c.usrCoords[2]/u)*u,l.usrCoords[2]<c.usrCoords[2]&&(e=Math.ceil(c.usrCoords[2]/u)*u,i=Math.floor(l.usrCoords[2]/u)*u),n=e;n>i-u;n-=u)s.dataX.push(l.usrCoords[1],c.usrCoords[1],NaN),s.dataY.push(n,n,NaN);for(e=Math.ceil(l.usrCoords[1]/h)*h,i=Math.floor(c.usrCoords[1]/h)*h,l.usrCoords[1]>c.usrCoords[1]&&(e=Math.floor(c.usrCoords[1]/h)*h,i=Math.ceil(l.usrCoords[1]/h)*h),n=e;n<i+h;n+=h)s.dataX.push(n,n,NaN),s.dataY.push(l.usrCoords[2],c.usrCoords[2],NaN)},s.hasPoint=function(){return!1},t.grids.push(s),s},t.createInequality=function(t,s,n){var r,l,c;if(c=o.copyAttributes(n,t.options,"inequality"),s[0].elementClass===a.OBJECT_CLASS_LINE)(l=t.create("curve",[[],[]],c)).hasPoint=function(){return!1},l.updateDataArray=function(){var n,r,o,l=t.getBoundingBox(),h=c.inverse?-1:1,u=1.5*Math.max(l[2]-l[0],l[1]-l[3]),d={coords:{usrCoords:[1,(l[0]+l[2])/2,c.inverse?l[1]:l[3]]}},p=s[0].stdform.slice(1),f=p;o=1.5*Math.max(i.perpendicular(s[0],d,t)[0].distance(a.COORDS_BY_USER,d.coords),u),o*=h,d={coords:{usrCoords:[1,(l[0]+l[2])/2,(l[1]+l[3])/2]}},d=Math.abs(e.innerProduct(d.coords.usrCoords,s[0].stdform,3))>=e.eps?i.perpendicular(s[0],d,t)[0].usrCoords:d.coords.usrCoords,this.dataX=[(n=[1,d[1]+p[1]*u,d[2]-p[0]*u])[1],n[1]+p[0]*o,(r=[1,d[1]-f[1]*u,d[2]+f[0]*u])[1]+f[0]*o,r[1],n[1]],this.dataY=[n[2],n[2]+p[1]*o,r[2]+f[1]*o,r[2],n[2]]};else if(s[0].elementClass===a.OBJECT_CLASS_CURVE&&"functiongraph"===s[0].visProp.curvetype)(l=t.create("curve",[[],[]],c)).hasPoint=function(){return!1},l.updateDataArray=function(){var t,e,i=this.board.getBoundingBox(),n=1.5*(c.inverse?i[1]:i[3]);if(this.dataX=[],this.dataY=[],!((e=s[0].points.length)<=0)){for(this.dataX.push(s[0].points[0].usrCoords[1]),this.dataY.push(n),t=0;t<e;t++)this.dataX.push(s[0].points[t].usrCoords[1]),this.dataY.push(s[0].points[t].usrCoords[2]);this.dataX.push(s[0].points[e-1].usrCoords[1]),this.dataY.push(n)}};else if(r=o.createFunction(s[0]),!o.exists(r))throw new Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]");return l.addParents(s[0]),l},t.registerElement("arrowparallel",t.createArrowParallel),t.registerElement("bisector",t.createBisector),t.registerElement("bisectorlines",t.createAngularBisectorsOfTwoLines),t.registerElement("msector",t.createMsector),t.registerElement("circumcircle",t.createCircumcircle),t.registerElement("circumcirclemidpoint",t.createCircumcenter),t.registerElement("circumcenter",t.createCircumcenter),t.registerElement("incenter",t.createIncenter),t.registerElement("incircle",t.createIncircle),t.registerElement("integral",t.createIntegral),t.registerElement("midpoint",t.createMidpoint),t.registerElement("mirrorelement",t.createMirrorElement),t.registerElement("mirrorpoint",t.createMirrorPoint),t.registerElement("normal",t.createNormal),t.registerElement("orthogonalprojection",t.createOrthogonalProjection),t.registerElement("parallel",t.createParallel),t.registerElement("parallelpoint",t.createParallelPoint),t.registerElement("perpendicular",t.createPerpendicular),t.registerElement("perpendicularpoint",t.createPerpendicularPoint),t.registerElement("perpendicularsegment",t.createPerpendicularSegment),t.registerElement("reflection",t.createReflection),t.registerElement("grid",t.createGrid),t.registerElement("inequality",t.createInequality),{createArrowParallel:t.createArrowParallel,createBisector:t.createBisector,createAngularBisectorOfTwoLines:t.createAngularBisectorsOfTwoLines,createCircumcircle:t.createCircumcircle,createCircumcenter:t.createCircumcenter,createIncenter:t.createIncenter,createIncircle:t.createIncircle,createIntegral:t.createIntegral,createMidpoint:t.createMidpoint,createMirrorElement:t.createMirrorElement,createMirrorPoint:t.createMirrorPoint,createNormal:t.createNormal,createOrthogonalProjection:t.createOrthogonalProjection,createParallel:t.createParallel,createParallelPoint:t.createParallelPoint,createPerpendicular:t.createPerpendicular,createPerpendicularPoint:t.createPerpendicularPoint,createPerpendicularSegmen:t.createPerpendicularSegment,createReflection:t.createReflection,createGrid:t.createGrid,createInequality:t.createInequality}})),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],(function(t,e,i,s,n,r,o,a,l,c,h,u,d,p,f,m,g,b,y,v,x){"use strict";return t.Board=function(t,i,n,r,o,a,l,h,u,m,g){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,d.exists(g.document)&&!1!==g.document?this.document=g.document:void 0!==document&&d.isObject(document)&&(this.document=document),this.container=t,this.containerObj=f.isBrowser?this.document.getElementById(this.container):null,f.isBrowser&&"no"!==i.type&&null===this.containerObj)throw new Error("\nJSXGraph: HTML container element '"+t+"' not found.");this.renderer=i,this.grids=[],this.options=d.deepCopy(s),this.attr=g,this.dimension=2,this.jc=new c,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,r[0],r[1]],this.zoomX=o,this.zoomY=a,this.unitX=l*this.zoomX,this.unitY=h*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=u,this.canvasHeight=m,this.id=d.exists(n)&&""!==n&&f.isBrowser&&!d.exists(this.document.getElementById(n))?n:this.generateId(),p.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(e.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},t.extend(t.Board.prototype,{generateName:function(t){var i,s,n=this.attr.maxnamelength,r="",o="",a=[],l="";if(t.type===e.OBJECT_TYPE_TICKS)return"";for(i=d.isPoint(t)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:t.type===e.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],d.isPoint(t)||t.elementClass===e.OBJECT_CLASS_LINE||t.type===e.OBJECT_TYPE_ANGLE||(r=t.type===e.OBJECT_TYPE_POLYGON?"P_{":t.elementClass===e.OBJECT_CLASS_CIRCLE?"k_{":t.elementClass===e.OBJECT_CLASS_TEXT?"t_{":"s_{",o="}"),s=0;s<n;s++)a[s]=0;for(;a[n-1]<i.length;){for(a[0]=1;a[0]<i.length;a[0]++){for(l=r,s=n;s>0;s--)l+=i[a[s-1]];if(!d.exists(this.elementsByName[l+o]))return l+o}for(a[0]=i.length,s=1;s<n;s++)a[s-1]===i.length&&(a[s-1]=1,a[s]+=1)}return""},generateId:function(){for(var e=1;d.exists(t.boards["jxgBoard"+e]);)e=Math.round(65535*Math.random());return"jxgBoard"+e},setId:function(t,e){var i,s=this.numObjects,n=t.id;if(this.numObjects+=1,""===n||!d.exists(n))for(n=this.id+e+s;d.exists(this.objects[n]);)i=Math.round(65535*Math.random()),n=this.id+e+s+"-"+i;return t.id=n,this.objects[n]=t,t._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=t,n},finalizeAdding:function(t){!1===d.evaluate(t.visProp.visible)&&this.renderer.display(t,!1)},finalizeLabel:function(t){t.hasLabel&&!d.evaluate(t.label.visProp.islabel)&&!1===d.evaluate(t.label.visProp.visible)&&this.renderer.display(t.label,!1)},getCoordsTopLeftCorner:function(){var t,e,i,s,n=this.document.documentElement||this.document.body.parentNode,r=this.document.body,o=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||(new Date).getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=(new Date).getTime(),o.getBoundingClientRect){for(e=o.getBoundingClientRect(),i=1,s=o;s&&d.exists(s.parentNode);)d.exists(s.style)&&d.exists(s.style.zoom)&&""!==s.style.zoom&&(i*=parseFloat(s.style.zoom)),s=s.parentNode;return(t=[e.left*i,e.top*i])[0]+=f.getProp(o,"border-left-width"),t[1]+=f.getProp(o,"border-top-width"),"vml"!==this.renderer.type&&(t[0]+=f.getProp(o,"padding-left"),t[1]+=f.getProp(o,"padding-top")),this.cPos=t.slice(),this.cPos}return t=f.getOffset(o),!this.containerObj.currentStyle&&this.document.documentElement.ownerDocument.defaultView&&(t[0]+=f.getProp(n,"margin-left"),t[1]+=f.getProp(n,"margin-top"),t[0]+=f.getProp(n,"border-left-width"),t[1]+=f.getProp(n,"border-top-width"),t[0]+=f.getProp(n,"padding-left"),t[1]+=f.getProp(n,"padding-top")),r&&(t[0]+=f.getProp(r,"left"),t[1]+=f.getProp(r,"top")),"object"==typeof google&&google.translate&&(t[0]+=10,t[1]+=25),t[0]+=f.getProp(o,"border-left-width"),t[1]+=f.getProp(o,"border-top-width"),"vml"!==this.renderer.type&&(t[0]+=f.getProp(o,"padding-left"),t[1]+=f.getProp(o,"padding-top")),t[0]+=this.attr.offsetx,t[1]+=this.attr.offsety,this.cPos=t.slice(),this.cPos},getMousePosition:function(t,e){var i,s,n=this.getCoordsTopLeftCorner();return i=f.getPosition(t,e,this.document),d.exists(this.cssTransMat)||this.updateCSSTransforms(),(s=r.matVecMult(this.cssTransMat,s=[1,i[0]-n[0],i[1]-n[1]]))[1]/=s[0],s[2]/=s[0],[s[1],s[2]]},initMoveOrigin:function(t,e){this.drag_dx=t-this.origin.scrCoords[1],this.drag_dy=e-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(t,i,s,n){var r,o,a,c=[],h=[],u=this.objectsList.length,p={visProp:{layer:-1e4}};for(o=0;o<u;o++)a=(r=this.objectsList[o]).hasPoint&&r.hasPoint(t,i),r.visPropCalc.visible&&a&&(r.triggerEventHandlers([n+"down","down"],[s]),this.downObjects.push(r)),(this.geonextCompatibilityMode&&(d.isPoint(r)||r.elementClass===e.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&r.isDraggable&&r.visPropCalc.visible&&!d.evaluate(r.visProp.fixed)&&a&&(r.visProp.layer>p.visProp.layer||r.visProp.layer===p.visProp.layer&&r.lastDragTime.getTime()>=p.lastDragTime.getTime())&&(this.attr.ignorelabels&&d.exists(p.label)&&r===p.label||(c.push(p=r),d.exists(p.coords)?h.push(l.subtract(p.coords.scrCoords.slice(1),[t,i])):h.push([0,0])));return c.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(c.length=1,this._drag_offset=h[0]):(c=c.slice(-1),this._drag_offset=h[h.length-1]),this._drag_offset||(this._drag_offset=[0,0]),"svg"===this.renderer.type&&d.exists(c[0])&&d.evaluate(c[0].visProp.dragtotopoflayer)&&1===c.length&&d.exists(c[0].rendNode)&&c[0].rendNode.parentNode.appendChild(c[0].rendNode),c},moveObject:function(t,s,n,r,o){var a,c,h,u=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t,s),this);n&&n.obj&&((a=n.obj).coords&&(c=a.coords.scrCoords.slice()),this.drag_position=[u.scrCoords[1],u.scrCoords[2]],this.drag_position=l.add(this.drag_position,this._drag_offset),d.exists(a.coords)?a.setPositionDirectly(e.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(n.targets[0].Xprev+n.targets[0].Yprev)||a.setPositionDirectly(e.COORDS_BY_SCREEN,[u.scrCoords[1],u.scrCoords[2]],[n.targets[0].Xprev,n.targets[0].Yprev]),n.targets[0].Xprev=u.scrCoords[1],n.targets[0].Yprev=u.scrCoords[2]),a.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(a),a.prepareUpdate().update(!0).updateRenderer(),a.coords&&(h=a.coords.scrCoords),a.coords&&c[1]===h[1]&&c[2]===h[2]||(a.triggerEventHandlers([o+"drag","drag"],[r]),this.update()),a.highlight(!0),a.lastDragTime=new Date)},twoFingerMove:function(t,s,n,r){var o,a,l;d.exists(n)&&d.exists(n.obj)&&(l=n.obj,o=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t[0],t[1]),this),a=new i(e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(s[0],s[1]),this),l.elementClass===e.OBJECT_CLASS_LINE||l.type===e.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(o,a,n,l):l.elementClass===e.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(o,a,n,l),l.triggerEventHandlers(["touchdrag","drag"],[r]),n.targets[0].Xprev=o.scrCoords[1],n.targets[0].Yprev=o.scrCoords[2],n.targets[1].Xprev=a.scrCoords[1],n.targets[1].Yprev=a.scrCoords[2])},twoFingerTouchObject:function(t,s,n,a){var l,c,h,u,p,f,m,g,b,y,v,x,C,_,w,S,P,k,E;if(d.exists(n.targets[0])&&d.exists(n.targets[1])&&!isNaN(n.targets[0].Xprev+n.targets[0].Yprev+n.targets[1].Xprev+n.targets[1].Yprev)){if(l=t.usrCoords,c=s.usrCoords,h=new i(e.COORDS_BY_SCREEN,[n.targets[0].Xprev,n.targets[0].Yprev],this).usrCoords,u=new i(e.COORDS_BY_SCREEN,[n.targets[1].Xprev,n.targets[1].Yprev],this).usrCoords,f=[1,.5*(h[1]+u[1]),.5*(h[2]+u[2])],p=[1,.5*(l[1]+c[1]),.5*(l[2]+c[2])],g=r.crossProduct(h,u),m=r.crossProduct(l,c),y=r.crossProduct(g,m),Math.abs(y[0])<r.eps)return;if(y[1]/=y[0],y[2]/=y[0],v=o.rad(f.slice(1),y.slice(1),p.slice(1)),(x=this.create("transform",[v,y[1],y[2]],{type:"rotate"})).update(),(f=r.matVecMult(x.matrix,f))[1]/=f[0],f[2]/=f[0],(C=this.create("transform",[p[1]-f[1],p[2]-f[2]],{type:"translate"})).update(),x.melt(C),d.evaluate(a.visProp.scalable)&&(b=o.distance(l,c)/o.distance(h,u),_=this.create("transform",[-p[1],-p[2]],{type:"translate"}),w=this.create("transform",[b,b],{type:"scale"}),S=this.create("transform",[p[1],p[2]],{type:"translate"}),x.melt(_).melt(w).melt(S)),a.elementClass===e.OBJECT_CLASS_LINE)P=[],a.point1.draggable()&&P.push(a.point1),a.point2.draggable()&&P.push(a.point2),x.applyOnce(P);else if(a.type===e.OBJECT_TYPE_POLYGON){for(P=[],E=a.vertices.length-1,k=0;k<E;++k)a.vertices[k].draggable()&&P.push(a.vertices[k]);x.applyOnce(P)}this.update(),a.highlight(!0)}},twoFingerTouchCircle:function(t,s,n,r){var a,l,c,h,u,p,f,m,g,b,y;"pointCircle"!==r.method&&"pointLine"!==r.method&&d.exists(n.targets[0])&&d.exists(n.targets[1])&&!isNaN(n.targets[0].Xprev+n.targets[0].Yprev+n.targets[1].Xprev+n.targets[1].Yprev)&&(a=t.usrCoords,l=s.usrCoords,c=new i(e.COORDS_BY_SCREEN,[n.targets[0].Xprev,n.targets[0].Yprev],this).usrCoords,h=new i(e.COORDS_BY_SCREEN,[n.targets[1].Xprev,n.targets[1].Yprev],this).usrCoords,f=this.create("transform",[a[1]-c[1],a[2]-c[2]],{type:"translate"}),p=o.rad(h.slice(1),a.slice(1),l.slice(1)),m=this.create("transform",[-a[1],-a[2]],{type:"translate"}),g=this.create("transform",[p],{type:"rotate"}),f.melt(m).melt(g),d.evaluate(r.visProp.scalable)&&(u=o.distance(a,l)/o.distance(c,h),b=this.create("transform",[u,u],{type:"scale"}),f.melt(b)),y=this.create("transform",[a[1],a[2]],{type:"translate"}),f.melt(y),r.center.draggable()&&f.applyOnce([r.center]),"twoPoints"===r.method?r.point2.draggable()&&f.applyOnce([r.point2]):"pointRadius"===r.method&&d.isNumber(r.updateRadius.origin)&&r.setRadius(r.radius*u),this.update(r.center),r.highlight(!0))},highlightElements:function(t,e,i,s){var n,r,o,a={},l=this.objectsList.length;for(n=0;n<l;n++)o=(r=this.objectsList[n]).id,d.exists(r.hasPoint)&&r.visPropCalc.visible&&r.hasPoint(t,e)&&(this.updateInfobox(r),d.exists(this.highlightedObjects[o])||(a[o]=r,r.highlight(),r.triggerEventHandlers(["mousehit","hit"],[i,r,s])),r.mouseover?r.triggerEventHandlers(["mousemove","move"],[i]):(r.triggerEventHandlers(["mouseover","over"],[i]),r.mouseover=!0));for(n=0;n<l;n++)o=(r=this.objectsList[n]).id,r.mouseover&&(a[o]||(r.triggerEventHandlers(["mouseout","out"],[i]),r.mouseover=!1))},saveStartPos:function(i,s){var n,r,o=[];if(i.type===e.OBJECT_TYPE_TICKS)o.push([1,NaN,NaN]);else if(i.elementClass===e.OBJECT_CLASS_LINE)o.push(i.point1.coords.usrCoords),o.push(i.point2.coords.usrCoords);else if(i.elementClass===e.OBJECT_CLASS_CIRCLE)o.push(i.center.coords.usrCoords),"twoPoints"===i.method&&o.push(i.point2.coords.usrCoords);else if(i.type===e.OBJECT_TYPE_POLYGON)for(r=i.vertices.length-1,n=0;n<r;n++)o.push(i.vertices[n].coords.usrCoords);else if(i.type===e.OBJECT_TYPE_SECTOR)o.push(i.point1.coords.usrCoords),o.push(i.point2.coords.usrCoords),o.push(i.point3.coords.usrCoords);else if(d.isPoint(i)||i.type===e.OBJECT_TYPE_GLIDER)o.push(i.coords.usrCoords);else if(i.elementClass===e.OBJECT_CLASS_CURVE)i.points.length>0&&o.push(i.points[0].usrCoords);else try{o.push(i.coords.usrCoords)}catch(e){t.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+e)}for(r=o.length,n=0;n<r;n++)s.Zstart.push(o[n][0]),s.Xstart.push(o[n][1]),s.Ystart.push(o[n][2])},mouseOriginMoveStart:function(t){var e,i;return(e=this._isRequiredKeyPressed(t,"pan"))&&(i=this.getMousePosition(t),this.initMoveOrigin(i[0],i[1])),e},mouseOriginMove:function(t){var e,i=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return i&&(e=this.getMousePosition(t),this.moveOrigin(e[0],e[1],!0)),i},touchOriginMoveStart:function(e){var i,s;return(i=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&1==e[t.touchProperty].length)&&(s=this.getMousePosition(e,0),this.initMoveOrigin(s[0],s[1])),i},touchOriginMove:function(t){var e,i=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return i&&(e=this.getMousePosition(t,0),this.moveOrigin(e[0],e[1],!0)),i},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){f.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),null!==this.containerObj&&(this.containerObj.oncontextmenu=function(t){return d.exists(t)&&t.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&f.isBrowser&&(window.navigator.msPointerEnabled?(f.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),f.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(f.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),f.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),null!==this.containerObj&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&f.isBrowser&&(f.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),f.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),f.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(t){!this.hasTouchHandlers&&f.isBrowser&&(f.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),f.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&f.isBrowser&&(window.navigator.msPointerEnabled?(f.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),f.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(f.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),f.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&f.isBrowser&&(f.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),f.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(f.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),f.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),f.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&f.isBrowser&&(f.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),f.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(f.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(t){var s,n,r,a,l,c,h,u,d,p=this.attr.zoom.factorx,f=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(t.preventDefault(),s=new i(e.COORDS_BY_SCREEN,this.getMousePosition(t,0),this),r=o.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),void 0===t.scale&&(t.scale=r/this.prevDist),n=t.scale/this.prevScale,this.prevScale=t.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(t.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(s.scrCoords[1],s.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(n-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(a=Math.abs(t.touches[0].clientX-t.touches[1].clientX),l=Math.abs(t.touches[0].clientY-t.touches[1].clientY),c=Math.abs(Math.atan2(l,a)),d=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&c<d?(this.attr.zoom.factorx=n,this.attr.zoom.factory=1,h=0,u=0):this.attr.zoom.pinchvertical&&Math.abs(c-.5*Math.PI)<d?(this.attr.zoom.factorx=1,this.attr.zoom.factory=n,h=0,u=0):(this.attr.zoom.factorx=n,this.attr.zoom.factory=n,h=s.usrCoords[1],u=s.usrCoords[2]),this.zoomIn(h,u),this.attr.zoom.factorx=p,this.attr.zoom.factory=f),!1)},gestureStartListener:function(t){var e;return t.preventDefault(),this.prevScale=1,this.prevDist=o.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),e=this.getMousePosition(t,0),this.initMoveOrigin(e[0],e[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(t,e){var i=this.attr[e];return!!i.enabled&&!(!(i.needshift&&t.shiftKey||!i.needshift&&!t.shiftKey)||!(i.needctrl&&t.ctrlKey||!i.needctrl&&!t.ctrlKey))},_pointerAddBoardTouches:function(t){var e,i;for(e=0,i=!1;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches[e].clientX=t.clientX,this._board_touches[e].clientY=t.clientY,i=!0;break}return i||this._board_touches.push({pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY}),this},_pointerRemoveBoardTouches:function(t){var e;for(e=0;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches.splice(e,1);break}return this},pointerDownListener:function(t,e){var i,s,n,r,o,a,l,c,h=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?f.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&d.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(a=window.getSelection()).removeAllRanges)try{a.removeAllRanges()}catch(t){}if(f.isBrowser&&("touch"===t.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=h),r=this.getMousePosition(t),this._testForSelection(t),this.selectingMode)return this._startSelecting(r),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[t]);if(e?(o=[e],this.mode=this.BOARD_MODE_DRAG):o=this.initMoveObject(r[0],r[1],t,"mouse"),o.length>0){for(c=o[o.length-1],l=!1,i=0;i<this.touches.length;i++)if(this.touches[i].obj===c){s=i,n=this.touches[i].targets.push({num:t.pointerId,X:r[0],Y:r[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,l=!0;break}l||(n=0,s=this.touches.push({obj:c,targets:[{num:t.pointerId,X:r[0],Y:r[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),c.highlight(!0),this.saveStartPos(c,this.touches[s].targets[n]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(t.preventDefault(),t.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,f.isBrowser&&"touch"!==t.pointerType?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(t):(this._pointerAddBoardTouches(t),t.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(t)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||2!=t.touches.length||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(t))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[t]),!1},pointerMoveListener:function(t){var e,i,s;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(t.preventDefault(),t.stopPropagation()),f.isBrowser&&("touch"===t.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)s=this.getMousePosition(t),this._moveSelecting(s),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[t,this.mode]);else if(!this.mouseOriginMove(t))if(this.mode===this.BOARD_MODE_DRAG){for(e=0;e<this.touches.length;e++)for(i=0;i<this.touches[e].targets.length;i++)if(this.touches[e].targets[i].num===t.pointerId){1===this.touches[e].targets.length?(this.touches[e].targets[i].X=t.pageX,this.touches[e].targets[i].Y=t.pageY,s=this.getMousePosition(t),this.moveObject(s[0],s[1],this.touches[e],t,"touch")):2===this.touches[e].targets.length&&this.touches[e].targets[0].num>-1&&this.touches[e].targets[1].num>-1&&(this.touches[e].targets[i].X=t.pageX,this.touches[e].targets[i].Y=t.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[e].targets[0].X,clientY:this.touches[e].targets[0].Y}),this.getMousePosition({clientX:this.touches[e].targets[1].X,clientY:this.touches[e].targets[1].Y}),this.touches[e],t));break}}else"touch"==t.pointerType?(this._pointerAddBoardTouches(t),2==this._board_touches.length&&(t.touches=this._board_touches,this.gestureChangeListener(t))):(s=this.getMousePosition(t),this.highlightElements(s[0],s[1],t,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[t,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(t){var e,i,s;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),this.showInfobox(!1),t)for(e=0;e<this.touches.length;e++)for(i=0;i<this.touches[e].targets.length;i++)if(this.touches[e].targets[i].num===t.pointerId){this.touches[e].targets.splice(i,1),0===this.touches[e].targets.length&&this.touches.splice(e,1);break}if(this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[t]);else for(e=this.downObjects.length-1;e>-1;e--){for(s=!1,i=0;i<this.touches.length;i++)this.touches[i].obj.id===this.downObjects[e].id&&(s=!0);s||(this.downObjects[e].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),this.downObjects[e].snapToGrid(),this.downObjects[e].snapToPoints(),this.downObjects.splice(e,1))}return this._pointerRemoveBoardTouches(t),0===this._board_touches.length&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?f.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):f.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(i){var n,r,o,a,l,c,h,u,p,m=this.options.precision.touch,g=i[t.touchProperty];for(this.hasTouchEnd||(f.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&d.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,n=0;n<g.length;n++)g[n].jxg_isused=!1;for(n=0;n<this.touches.length;n++)for(a=0;a<this.touches[n].targets.length;a++){this.touches[n].targets[a].num=-1,m=this.options.precision.touch;do{for(l=0;l<g.length;l++)if(Math.abs(Math.pow(g[l].screenX-this.touches[n].targets[a].X,2)+Math.pow(g[l].screenY-this.touches[n].targets[a].Y,2))<m*m){this.touches[n].targets[a].num=l,this.touches[n].targets[a].X=g[l].screenX,this.touches[n].targets[a].Y=g[l].screenY,g[l].jxg_isused=!0;break}m*=2}while(-1===this.touches[n].targets[a].num&&m<this.options.precision.touchMax);-1===this.touches[n].targets[a].num&&(t.debug("i couldn't find a targettouches for target no "+a+" on "+this.touches[n].obj.name+" ("+this.touches[n].obj.id+"). Removed the target."),t.debug("eps = "+m+", touchMax = "+s.precision.touchMax),this.touches[n].targets.splice(n,1))}for(n=0;n<g.length;n++)if(!g[n].jxg_isused){if(r=this.getMousePosition(i,n),this.selectingMode)return this._startSelecting(r),this.triggerEventHandlers(["touchstartselecting","startselecting"],[i]),i.preventDefault(),i.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(0!==(o=this.initMoveObject(r[0],r[1],i,"touch")).length)if(d.isPoint(c=o[o.length-1])||c.elementClass===e.OBJECT_CLASS_TEXT||c.type===e.OBJECT_TYPE_TICKS||c.type===e.OBJECT_TYPE_IMAGE)this.saveStartPos(c,(u=[{num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}])[0]),this.touches.push({obj:c,targets:u}),c.highlight(!0);else if(c.elementClass===e.OBJECT_CLASS_LINE||c.elementClass===e.OBJECT_CLASS_CIRCLE||c.elementClass===e.OBJECT_CLASS_CURVE||c.type===e.OBJECT_TYPE_POLYGON){for(h=!1,a=0;a<this.touches.length;a++)c.id===this.touches[a].obj.id&&(h=!0,1===this.touches[a].targets.length&&(this.saveStartPos(c,p={num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}),this.touches[a].targets.push(p)),g[n].jxg_isused=!0);h||(this.saveStartPos(c,(u=[{num:n,X:g[n].screenX,Y:g[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}])[0]),this.touches.push({obj:c,targets:u}),c.highlight(!0))}g[n].jxg_isused=!0}return this.touches.length>0&&(i.preventDefault(),i.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(i)||2!=g.length||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(i)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[i]),!1},touchMoveListener:function(e){var i,s,n,r=e[t.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(e.preventDefault(),e.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(i=0;i<r.length;i++)if(!r[i].jxg_isused){s=this.getMousePosition(e,i),this._moveSelecting(s),this.triggerEventHandlers(["touchmoves","moveselecting"],[e,this.mode]);break}}else if(!this.touchOriginMove(e))if(this.mode===this.BOARD_MODE_DRAG){for(i=0;i<this.touches.length;i++)if(1===this.touches[i].targets.length){if(r[this.touches[i].targets[0].num]){if((s=this.getMousePosition(e,this.touches[i].targets[0].num))[0]<0||s[0]>this.canvasWidth||s[1]<0||s[1]>this.canvasHeight)return;this.touches[i].targets[0].X=r[this.touches[i].targets[0].num].screenX,this.touches[i].targets[0].Y=r[this.touches[i].targets[0].num].screenY,this.moveObject(s[0],s[1],this.touches[i],e,"touch")}}else if(2===this.touches[i].targets.length&&this.touches[i].targets[0].num>-1&&this.touches[i].targets[1].num>-1&&r[this.touches[i].targets[0].num]&&r[this.touches[i].targets[1].num]){if(s=this.getMousePosition(e,this.touches[i].targets[0].num),n=this.getMousePosition(e,this.touches[i].targets[1].num),s[0]<0||s[0]>this.canvasWidth||s[1]<0||s[1]>this.canvasHeight||n[0]<0||n[0]>this.canvasWidth||n[1]<0||n[1]>this.canvasHeight)return;this.touches[i].targets[0].X=r[this.touches[i].targets[0].num].screenX,this.touches[i].targets[0].Y=r[this.touches[i].targets[0].num].screenY,this.touches[i].targets[1].X=r[this.touches[i].targets[1].num].screenX,this.touches[i].targets[1].Y=r[this.touches[i].targets[1].num].screenY,this.twoFingerMove(s,n,this.touches[i],e)}}else 2==r.length&&this.gestureChangeListener(e);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[e,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(i){var s,n,r,o,a,l=this.options.precision.touch,c=[],h=i&&i[t.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[i]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(i),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[i]);else if(h&&h.length>0){for(s=0;s<this.touches.length;s++)c[s]=this.touches[s];for(this.touches.length=0,s=0;s<h.length;s++)h[s].jxg_isused=!1;for(s=0;s<c.length;s++){for(o=!1,a=0,n=0;n<c[s].targets.length;n++)for(c[s].targets[n].found=!1,r=0;r<h.length;r++)if(Math.abs(Math.pow(h[r].screenX-c[s].targets[n].X,2)+Math.pow(h[r].screenY-c[s].targets[n].Y,2))<l*l){c[s].targets[n].found=!0,c[s].targets[n].num=r,c[s].targets[n].X=h[r].screenX,c[s].targets[n].Y=h[r].screenY,a+=1;break}if(d.isPoint(c[s].obj)?o=c[s].targets[0]&&c[s].targets[0].found:c[s].obj.elementClass===e.OBJECT_CLASS_LINE?o=c[s].targets[0]&&c[s].targets[0].found||c[s].targets[1]&&c[s].targets[1].found:c[s].obj.elementClass===e.OBJECT_CLASS_CIRCLE&&(o=1===a||3===a),o)for(this.touches.push({obj:c[s].obj,targets:[]}),n=0;n<c[s].targets.length;n++)c[s].targets[n].found&&this.touches[this.touches.length-1].targets.push({num:c[s].targets[n].num,X:c[s].targets[n].screenX,Y:c[s].targets[n].screenY,Xprev:NaN,Yprev:NaN,Xstart:c[s].targets[n].Xstart,Ystart:c[s].targets[n].Ystart,Zstart:c[s].targets[n].Zstart});else c[s].obj.noHighlight()}}else this.touches.length=0;for(s=this.downObjects.length-1;s>-1;s--){for(o=!1,n=0;n<this.touches.length;n++)this.touches[n].obj.id===this.downObjects[s].id&&(o=!0);o||(this.downObjects[s].triggerEventHandlers(["touchup","up"],[i]),this.downObjects[s].snapToGrid(),this.downObjects[s].snapToPoints(),this.downObjects.splice(s,1))}return h&&0!==h.length||(this.hasTouchEnd&&(f.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(t){var e,i,s;if(this.document.selection&&d.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return f.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,e=this.getMousePosition(t),this._testForSelection(t),this.selectingMode?(this._startSelecting(e),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[t])):(0===(i=this.initMoveObject(e[0],e[1],t,"mouse")).length?(this.mode=this.BOARD_MODE_NONE,s=!0):(this.mouse={obj:null,targets:[{X:e[0],Y:e[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=i[i.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(s=this.mouseOriginMoveStart(t)),this.triggerEventHandlers(["mousedown","down"],[t]),s)},mouseMoveListener:function(t){var e;e=this.getMousePosition(t),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(e),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[t,this.mode])):this.mouseOriginMove(t)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(e[0],e[1],this.mouse,t,"mouse"):this.highlightElements(e[0],e[1],t,-1),this.triggerEventHandlers(["mousemove","move"],[t,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(t){var e;if(!1===this.selectingMode&&this.triggerEventHandlers(["mouseup","up"],[t]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[t]);else for(e=0;e<this.downObjects.length;e++)this.downObjects[e].triggerEventHandlers(["mouseup","up"],[t]);this.downObjects.length=0,this.hasMouseUp&&(f.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(t){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(t,"zoom"))return!0;var s=(t=t||window.event).detail?-t.detail:t.wheelDelta/40,n=new i(e.COORDS_BY_SCREEN,this.getMousePosition(t),this);return s>0?this.zoomIn(n.usrCoords[1],n.usrCoords[2]):this.zoomOut(n.usrCoords[1],n.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[t]),t.preventDefault(),!1},initInfobox:function(){var t=d.copyAttributes({},this.options,"infobox");return t.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],t),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(t){var e,i,s,n,r;return d.evaluate(t.visProp.showinfobox)?(d.isPoint(t)&&(s=t.coords.usrCoords[1],n=t.coords.usrCoords[2],r=d.evaluate(t.visProp.infoboxdigits),this.infobox.setCoords(s+this.infobox.distanceX/this.unitX,n+this.infobox.distanceY/this.unitY),"string"!=typeof t.infoboxText?("auto"===r?(e=d.autoDigits(s),i=d.autoDigits(n)):d.isNumber(r)?(e=d.toFixed(s,r),i=d.toFixed(n,r)):(e=s,i=n),this.highlightInfobox(e,i,t)):this.highlightCustomInfobox(t.infoboxText,t),this.showInfobox(!0)),this):this},showInfobox:function(t){return this.infobox.hiddenByParent==t&&(this.infobox.hiddenByParent=!t,this.infobox.prepareUpdate().updateVisibility(t).updateRenderer()),this},highlightInfobox:function(t,e,i){return this.highlightCustomInfobox("("+t+", "+e+")",i),this},highlightCustomInfobox:function(t,e){return this.infobox.setText(t),this},dehighlightAll:function(){var t,e=!1;for(t in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(t)&&((this.hasMouseHandlers||this.hasPointerHandlers)&&this.highlightedObjects[t].noHighlight(),e=!0);return this.highlightedObjects={},"canvas"===this.renderer.type&&e&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(t,e){return[t,e]},getUsrCoordsOfMouse:function(t){var s=this.getCoordsTopLeftCorner(),n=f.getPosition(t,null,this.document);return new i(e.COORDS_BY_SCREEN,[n[0]-s[0],n[1]-s[1]],this).usrCoords.slice(1)},getAllUnderMouse:function(t){var e=this.getAllObjectsUnderMouse(t);return e.push(this.getUsrCoordsOfMouse(t)),e},getAllObjectsUnderMouse:function(t){var e,i,s=this.getCoordsTopLeftCorner(),n=f.getPosition(t,null,this.document),r=n[0]-s[0],o=n[1]-s[1],a=[],l=this.objectsList.length;for(e=0;e<l;e++)(i=this.objectsList[e]).visPropCalc.visible&&i.hasPoint&&i.hasPoint(r,o)&&(a[a.length]=i);return a},updateCoords:function(){var t,e,i=this.objectsList.length;for(e=0;e<i;e++)d.exists((t=this.objectsList[e]).coords)&&(d.evaluate(t.visProp.frozen)?t.coords.screen2usr():t.coords.usr2screen());return this},moveOrigin:function(t,e,i){return d.exists(t)&&d.exists(e)&&(this.origin.scrCoords[1]=t,this.origin.scrCoords[2]=e,i&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(i){var s,n,r,o,a,l,c,h=[],p=i.indexOf("<data>"),f=i.indexOf("</data>"),m=function(t,i,s,n){return function(){var r,o;o=(r=t.select(i.id)).coords.usrCoords[n],r.setPositionDirectly(e.COORDS_BY_USER,2===n?[s(),o]:[o,s()]),r.prepareUpdate().update()}},g=function(t,e,i,s){return function(){var n,r;n=t.select(e.id),r=i(),"strokewidth"===s?n.visProp.strokewidth=r:(r=u.rgba2rgbo(r),n.visProp[s+"color"]=r[0],n.visProp[s+"opacity"]=r[1])}};if(!(p<0)){for(;p>=0;){if(n=(s=i.slice(p+6,f)).indexOf("="),r=s.slice(0,n),o=s.slice(n+1),n=r.indexOf("."),a=r.slice(0,n),l=this.elementsByName[d.unescapeHTML(a)],c=r.slice(n+1).replace(/\s+/g,"").toLowerCase(),o=d.createFunction(o,this,"",!0),d.exists(this.elementsByName[a]))switch(c){case"x":h.push(m(this,l,o,2));break;case"y":h.push(m(this,l,o,1));break;case"visible":h.push(function(t,e,i){return function(){var s,n;s=t.select(e.id),n=i(),s.setAttribute({visible:n})}}(this,l,o));break;case"position":h.push(function(t,e,i){return function(){t.select(e.id).position=i()}}(this,l,o));break;case"stroke":h.push(g(this,l,o,"stroke"));break;case"style":h.push(function(t,e,i){return function(){t.select(e.id).setStyle(i())}}(this,l,o));break;case"strokewidth":h.push(g(this,l,o,"strokewidth"));break;case"fill":h.push(g(this,l,o,"fill"));break;case"label":break;default:t.debug("property '"+c+"' in conditions not yet implemented:"+o)}else t.debug("debug conditions: |"+a+"| undefined");p=(i=i.slice(f+7)).indexOf("<data>"),f=i.indexOf("</data>")}this.updateConditions=function(){var t;for(t=0;t<h.length;t++)h[t]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var t=new i(e.COORDS_BY_USER,[0,0],this),s=new i(e.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),n=t.scrCoords[1]-s.scrCoords[1],r=t.scrCoords[2]-s.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(n)>25;)this.options.grid.snapSizeX*=2,n/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(r)>25;)this.options.grid.snapSizeY*=2,r/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(t,e){var i=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,r=(i[2]-i[0])*(1-1/s),o=(i[1]-i[3])*(1-1/n),a=.5,l=.5,c=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&s>1||this.zoomY>this.attr.zoom.max&&n>1||this.zoomX<c&&s<1||this.zoomY<c&&n<1?this:(d.isNumber(t)&&d.isNumber(e)&&(a=(t-i[0])/(i[2]-i[0]),l=(i[1]-e)/(i[1]-i[3])),this.setBoundingBox([i[0]+r*a,i[1]-o*l,i[2]-r*(1-a),i[3]+o*(1-l)],!1),this.zoomX*=s,this.zoomY*=n,this.applyZoom())},zoomOut:function(t,e){var i=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,r=(i[2]-i[0])*(1-s),o=(i[1]-i[3])*(1-n),a=.5,l=.5,c=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<c||this.zoomY<c?this:(d.isNumber(t)&&d.isNumber(e)&&(a=(t-i[0])/(i[2]-i[0]),l=(i[1]-e)/(i[1]-i[3])),this.setBoundingBox([i[0]+r*a,i[1]-o*l,i[2]-r*(1-a),i[3]+o*(1-l)],!1),this.zoomX/=s,this.zoomY/=n,this.applyZoom())},zoom100:function(){var t=this.getBoundingBox(),e=(t[2]-t[0])*(1-this.zoomX)*.5,i=(t[1]-t[3])*(1-this.zoomY)*.5;return this.setBoundingBox([t[0]+e,t[1]-i,t[2]-e,t[3]+i],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var t,e,i,s,n=0,r=0,o=0,a=0,l=this.objectsList.length;for(t=0;t<l;t++)d.isPoint(s=this.objectsList[t])&&s.visPropCalc.visible&&(s.coords.usrCoords[1]<n?n=s.coords.usrCoords[1]:s.coords.usrCoords[1]>r&&(r=s.coords.usrCoords[1]),s.coords.usrCoords[2]>a?a=s.coords.usrCoords[2]:s.coords.usrCoords[2]<o&&(o=s.coords.usrCoords[2]));return e=50/this.unitX,i=50/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([n-e,a+i,r+e,o-i],!0),this.applyZoom()},zoomElements:function(t){var e,i,s,n=[0,0,0,0],r=[1,-1,-1,1];if(!d.isArray(t)||0===t.length)return this;for(e=0;e<t.length;e++)if(s=this.select(t[e]).bounds(),d.isArray(s))if(d.isArray(n))for(i=0;i<4;i++)r[i]*s[i]<r[i]*n[i]&&(n[i]=s[i]);else n=s;if(d.isArray(n)){for(i=0;i<4;i++)n[i]-=r[i];this.zoomX=1,this.zoomY=1,this.setBoundingBox(n,!0)}return this},setZoom:function(t,e){var i=this.attr.zoom.factorx,s=this.attr.zoom.factory;return this.attr.zoom.factorx=t/this.zoomX,this.attr.zoom.factory=e/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=i,this.attr.zoom.factory=s,this},removeObject:function(i){var s,n;if(d.isArray(i)){for(n=0;n<i.length;n++)this.removeObject(i[n]);return this}if(i=this.select(i),!d.exists(i)||d.isString(i))return this;try{for(s in i.childElements)i.childElements.hasOwnProperty(s)&&i.childElements[s].board.removeObject(i.childElements[s]);for(s in i.objects)i.objects.hasOwnProperty(s)&&i.objects[s].board.removeObject(i.objects[s]);for(s in this.objects)this.objects.hasOwnProperty(s)&&d.exists(this.objects[s].childElements)&&(delete this.objects[s].childElements[i.id],delete this.objects[s].descendants[i.id]);if(i._pos>-1)for(this.objectsList.splice(i._pos,1),s=i._pos;s<this.objectsList.length;s++)this.objectsList[s]._pos--;else i.type!==e.OBJECT_TYPE_TURTLE&&t.debug("Board.removeObject: object "+i.id+" not found in list.");delete this.objects[i.id],delete this.elementsByName[i.name],i.visProp&&d.evaluate(i.visProp.trace)&&i.clearTrace(),d.exists(i.remove)&&i.remove()}catch(e){t.debug(i.id+": Could not be removed: "+e)}return this.update(),this},removeAncestors:function(t){var e;for(e in t.ancestors)t.ancestors.hasOwnProperty(e)&&this.removeAncestors(t.ancestors[e]);return this.removeObject(t),this},initGeonextBoard:function(){var t,e,i;return t=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),e=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),i=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[t,e],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[t,i],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(t,e,i,s){var n;return s||(n=this.getBoundingBox()),this.canvasWidth=parseInt(t,10),this.canvasHeight=parseInt(e,10),i||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),s||this.setBoundingBox(n,this.keepaspectratio),this},showDependencies:function(){var t,e,i,s,n;for(t in e="<p>\n",this.objects)if(this.objects.hasOwnProperty(t)){for(i in n=0,this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(i)&&(n+=1);for(i in n>=0&&(e+="<strong>"+this.objects[t].id+":</strong> "),this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(i)&&(e+=this.objects[t].childElements[i].id+"("+this.objects[t].childElements[i].name+"), ");e+="<p>\n"}return e+="</p>\n",(s=window.open()).document.open(),s.document.write(e),s.document.close(),this},showXML:function(){var t=window.open("");return t.document.open(),t.document.write("<pre>"+d.escapeHTML(this.xmlString)+"</pre>"),t.document.close(),this},prepareUpdate:function(){var t,e,i=this.objectsList.length;for(t=0;t<i;t++)(e=this.objectsList[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate;for(t in this.groups)this.groups.hasOwnProperty(t)&&((e=this.groups[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(t){var e,i;for(t=this.select(t),e=0;e<this.objectsList.length;e++)(i=this.objectsList[e]).update(!d.exists(t)||i.id!==t.id).updateVisibility();for(e in this.groups)this.groups.hasOwnProperty(e)&&this.groups[e].update(t);return this},updateRenderer:function(){var t,e=this.objectsList.length;if("canvas"===this.renderer.type)this.updateRendererCanvas();else for(t=0;t<e;t++)this.objectsList[t].updateRenderer();return this},updateRendererCanvas:function(){var t,e,i,s,n,r=this.objectsList.length,o=this.options.layer,a=this.options.layer.numlayers,l=Number.NEGATIVE_INFINITY;for(i=0;i<a;i++){for(n in s=Number.POSITIVE_INFINITY,o)o.hasOwnProperty(n)&&o[n]>l&&o[n]<s&&(s=o[n]);for(l=s,t=0;t<r;t++)(e=this.objectsList[t]).visProp.layer===s&&e.prepareUpdate().updateRenderer()}return this},addHook:function(e,i,s){return t.deprecated("Board.addHook()","Board.on()"),i=d.def(i,"update"),s=d.def(s,this),this.hooks.push([i,e]),this.on(i,e,s),this.hooks.length-1},addEvent:t.shortcut(t.Board.prototype,"on"),removeHook:function(e){return t.deprecated("Board.removeHook()","Board.off()"),this.hooks[e]&&(this.off(this.hooks[e][0],this.hooks[e][1]),this.hooks[e]=null),this},removeEvent:t.shortcut(t.Board.prototype,"off"),updateHooks:function(e){var i=Array.prototype.slice.call(arguments,0);return t.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),i[0]=d.def(i[0],"update"),this.triggerEventHandlers([i[0]],arguments),this},addChild:function(t){return d.exists(t)&&d.exists(t.containerObj)&&(this.dependentBoards.push(t),this.update()),this},removeChild:function(t){var e;for(e=this.dependentBoards.length-1;e>=0;e--)this.dependentBoards[e]===t&&this.dependentBoards.splice(e,1);return this},update:function(t){var e,i,s,n;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,"all"===this.attr.minimizereflow&&this.containerObj&&"vml"!==this.renderer.type&&(n=this.renderer.removeToInsertLater(this.containerObj)),"svg"===this.attr.minimizereflow&&"svg"===this.renderer.type&&(n=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(t).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),n&&n(),i=this.dependentBoards.length,e=0;e<i;e++)d.exists(s=this.dependentBoards[e])&&s!==this&&(s.updateQuality=this.updateQuality,s.prepareUpdate().updateElements().updateConditions(),s.renderer.suspendRedraw(),s.updateRenderer(),s.renderer.unsuspendRedraw(),s.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var t;for(t=0;t<this.grids.length;t++)this.removeObject(this.grids[t]);return this.grids.length=0,this.update(),this},create:function(e,i,s){var n,r;for(e=e.toLowerCase(),d.exists(i)||(i=[]),d.exists(s)||(s={}),r=0;r<i.length;r++)d.isString(i[r])&&("text"!==e||2!==r)&&("input"!==e&&"checkbox"!==e&&"button"!==e||2!==r&&3!==r)&&(i[r]=this.select(i[r]));if(!d.isFunction(t.elements[e]))throw new Error("JSXGraph: create: Unknown element type given: "+e);return n=t.elements[e](this,i,s),d.exists(n)?(n.prepareUpdate&&n.update&&n.updateRenderer&&n.fullUpdate(),n):(t.debug("JSXGraph: create: failure creating "+e),n)},createElement:function(){return t.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var t;for(t=0;t<this.objectsList.length;t++)this.objectsList[t].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(t,e){var i,s,n=f.getDimensions(this.container,this.document);return d.isArray(t)?(this.plainBB=t,this.canvasWidth=parseInt(n.width,10),this.canvasHeight=parseInt(n.height,10),s=this.canvasWidth,i=this.canvasHeight,e?(this.unitX=s/(t[2]-t[0]),this.unitY=i/(t[1]-t[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=s/(t[2]-t[0]),this.unitY=i/(t[1]-t[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*t[0],this.unitY*t[1]),this):this},getBoundingBox:function(){var t=new i(e.COORDS_BY_SCREEN,[0,0],this),s=new i(e.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[t.usrCoords[1],t.usrCoords[2],s.usrCoords[1],s.usrCoords[2]]},addAnimation:function(t){var e=this;return this.animationObjects[t.id]=t,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval((function(){e.animate()}),t.board.attr.animationdelay)),this},stopAllAnimation:function(){var t;for(t in this.animationObjects)this.animationObjects.hasOwnProperty(t)&&d.exists(this.animationObjects[t])&&(this.animationObjects[t]=null,delete this.animationObjects[t]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var t,i,s,n,r,o,a,l,c=0,h=null;for(i in this.animationObjects)if(this.animationObjects.hasOwnProperty(i)&&d.exists(this.animationObjects[i])){if(c+=1,(s=this.animationObjects[i]).animationPath&&(n=d.isFunction(s.animationPath)?s.animationPath((new Date).getTime()-s.animationStart):s.animationPath.pop(),!d.exists(n)||!d.isArray(n)&&isNaN(n)?delete s.animationPath:(s.setPositionDirectly(e.COORDS_BY_USER,n),s.fullUpdate(),h=s)),s.animationData){for(r in a=0,s.animationData)s.animationData.hasOwnProperty(r)&&(o=s.animationData[r].pop(),d.exists(o)?(a+=1,(t={})[r]=o,s.setAttribute(t)):delete s.animationData[o]);0===a&&delete s.animationData}d.exists(s.animationData)||d.exists(s.animationPath)||(this.animationObjects[i]=null,delete this.animationObjects[i],d.exists(s.animationCallback)&&(l=s.animationCallback,s.animationCallback=null,l()))}return 0===c?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(h),this},migratePoint:function(t,e,i){var s,n,r,o,a,l,c=!1;for(n in t=this.select(t),e=this.select(e),d.exists(t.label)&&(l=t.label.id,c=!0,this.removeObject(t.label)),t.childElements)if(t.childElements.hasOwnProperty(n)){for(r in o=!1,s=t.childElements[n])s.hasOwnProperty(r)&&s[r]===t&&(s[r]=e,o=!0);for(o&&delete t.childElements[n],a=0;a<s.parents.length;a++)s.parents[a]===t.id&&(s.parents[a]=e.id);e.addChild(s)}return i&&(c&&(delete e.childElements[l],delete e.descendants[l]),e.label&&this.removeObject(e.label),delete this.elementsByName[e.name],e.name=t.name,c&&e.createLabel()),this.removeObject(t),d.exists(e.name)&&""!==e.name&&(this.elementsByName[e.name]=e),this.fullUpdate(),this},emulateColorblindness:function(e){var i,s;if(d.exists(e)||(e="none"),this.currentCBDef===e)return this;for(i in this.objects)this.objects.hasOwnProperty(i)&&(s=this.objects[i],"none"!==e?("none"===this.currentCBDef&&(s.visPropOriginal={strokecolor:s.visProp.strokecolor,fillcolor:s.visProp.fillcolor,highlightstrokecolor:s.visProp.highlightstrokecolor,highlightfillcolor:s.visProp.highlightfillcolor}),s.setAttribute({strokecolor:u.rgb2cb(d.evaluate(s.visPropOriginal.strokecolor),e),fillcolor:u.rgb2cb(d.evaluate(s.visPropOriginal.fillcolor),e),highlightstrokecolor:u.rgb2cb(d.evaluate(s.visPropOriginal.highlightstrokecolor),e),highlightfillcolor:u.rgb2cb(d.evaluate(s.visPropOriginal.highlightfillcolor),e)})):d.exists(s.visPropOriginal)&&t.extend(s.visProp,s.visPropOriginal));return this.currentCBDef=e,this.update(),this},select:function(t){var e,i,s,n,r=t;if(null===r)return r;if(d.isString(r)&&""!==r)d.exists(this.objects[r])?r=this.objects[r]:d.exists(this.elementsByName[r])?r=this.elementsByName[r]:d.exists(this.groups[r])&&(r=this.groups[r]);else if(d.isFunction(r)||d.isObject(r)&&!d.isFunction(r.setAttribute)){for(i={},n=(e=d.filterElements(this.objectsList,r)).length,s=0;s<n;s++)i[e[s].id]=e[s];r=new x(i)}else d.isObject(r)&&d.exists(r.id)&&!d.exists(this.objects[r.id])&&(r=null);return r},hasPoint:function(t,e){var i=t,s=e,n=this.getBoundingBox();return d.exists(t)&&d.isArray(t.usrCoords)&&(i=t.usrCoords[1],s=t.usrCoords[2]),!!(d.isNumber(i)&&d.isNumber(s)&&n[0]<i&&i<n[2]&&n[1]>s&&s>n[3])},updateCSSTransforms:function(){var t=this.containerObj,e=t,i=t;for(this.cssTransMat=f.getCSSTransformMatrix(e),e=e.offsetParent;e;){for(this.cssTransMat=r.matMatMult(f.getCSSTransformMatrix(e),this.cssTransMat),i=i.parentNode;i!==e;)this.cssTransMat=r.matMatMult(f.getCSSTransformMatrix(e),this.cssTransMat),i=i.parentNode;e=e.offsetParent}return this.cssTransMat=r.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(t){this.isSelecting=!0,this.selectingBox=[[t[0],t[1]],[t[0],t[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(t){this.isSelecting&&(this.selectingBox[1]=[t[0],t[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(t){var e=this.getMousePosition(t);this.isSelecting=!1,this.selectingBox[1]=[e[0],e[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var e=this.selectingBox[0],i=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],e[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(t.COORDS_BY_SCREEN,[e[0],i[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(t.COORDS_BY_SCREEN,[i[0],i[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(t.COORDS_BY_SCREEN,[i[0],e[1]])},_testForSelection:function(t){this._isRequiredKeyPressed(t,"selection")&&(d.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(t){var e;return d.exists(this.selectionPolygon)||!0===(e=d.copyAttributes(t,s,"board","selection")).enabled&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],e)),this},__evt__down:function(t){},__evt__mousedown:function(t){},__evt__pointerdown:function(t){},__evt__touchstart:function(t){},__evt__up:function(t){},__evt__mouseup:function(t){},__evt__pointerup:function(t){},__evt__touchend:function(t){},__evt__move:function(t,e){},__evt__mousemove:function(t,e){},__evt__pointermove:function(t,e){},__evt__touchmove:function(t,e){},__evt__hit:function(t,e,i){},__evt__mousehit:function(t,e,i){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(t,e,i,s,r,o,l){var c=this;return new function(){var h,u=0,d=0,p=0,f=i,m=n.root((function(i){var s=t.X(f),n=t.Y(f),r=e.X(i),o=e.Y(i);return(s-r)*(s-r)+(n-o)*(n-o)}),[0,2*Math.PI]),g=0,b=0,y=c.create("transform",[function(){return u}],{type:"rotate"}),v=c.create("transform",[function(){return u},function(){return t.X(f)},function(){return t.Y(f)}],{type:"rotate"}),x=c.create("transform",[function(){return d},function(){return p}],{type:"translate"}),C=function(t,e,i){var s=n.D(t.X)(e),r=n.D(t.Y)(e),o=n.D(t.X)(i),a=n.D(t.Y)(i),l=n.D(t.X)(.5*(e+i)),c=n.D(t.Y)(.5*(e+i)),h=Math.sqrt(s*s+r*r),u=Math.sqrt(o*o+a*a);return(h+4*Math.sqrt(l*l+c*c)+u)*(i-e)/6},_=function(t){return h-C(e,m,t)},w=Math.PI/18,S=9*w,P=null;return this.rolling=function(){var i,o,P,k,E;h=C(t,f,g=f+r*s),b=n.root(_,m),i=new a(t.X(g),t.Y(g)),o=new a(e.X(b),e.Y(b)),P=new a(n.D(t.X)(g),n.D(t.Y)(g)),k=new a(n.D(e.X)(b),n.D(e.Y)(b)),E=a.C.div(P,k),u=Math.atan2(E.imaginary,E.real),E.div(a.C.abs(E)),E.mult(o),d=i.real-E.real,p=i.imaginary-E.imaginary,u<-w&&u>-S?(u=-w,v.applyOnce(l)):u>w&&u<S?(u=w,v.applyOnce(l)):(y.applyOnce(l),x.applyOnce(l),f=g,m=b),c.update()},this.start=function(){return o>0&&(P=window.setInterval(this.rolling,o)),this},this.stop=function(){return window.clearInterval(P),this},this}}}),t.Board})),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],(function(t,e,i,s,n,r,o,a,l){"use strict";return t.SVGRenderer=function(t,i){var s;for(this.type="svg",this.isIE=-1!==navigator.appVersion.indexOf("MSIE")||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(i.width,i.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],s=0;s<e.layer.numlayers;s++)this.layer[s]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[s]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},t.SVGRenderer.prototype=new i,t.extend(t.SVGRenderer.prototype,{_createArrowHead:function(e,i){var s,r,o=e.id+"Triangle",a=null,l=n.evaluate(e.visProp.firstarrow),c=n.evaluate(e.visProp.lastarrow);return n.exists(i)&&(o+=i),(s=this.createPrim("marker",o)).setAttributeNS(null,"stroke",n.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",n.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"fill",n.evaluate(e.visProp.strokecolor)),s.setAttributeNS(null,"fill-opacity",n.evaluate(e.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",0),s.setAttributeNS(null,"orient","auto"),s.setAttributeNS(null,"markerUnits","strokeWidth"),r=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),"End"===i?(t.exists(l.type)&&(a=n.evaluate(l.type)),s.setAttributeNS(null,"refY",5),2===a?(s.setAttributeNS(null,"refX",4.9),r.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):3===a?(s.setAttributeNS(null,"refX",3.33),r.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(s.setAttributeNS(null,"refX",9.9),r.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(t.exists(c.type)&&(a=n.evaluate(c.type)),s.setAttributeNS(null,"refY",5),2===a?(s.setAttributeNS(null,"refX",5.1),r.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):3===a?(s.setAttributeNS(null,"refX",.1),r.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(s.setAttributeNS(null,"refX",.1),r.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),s.appendChild(r),s},_setArrowColor:function(t,e,i,s){t&&(n.isString(e)&&this._setAttribute((function(){t.setAttributeNS(null,"stroke",e),t.setAttributeNS(null,"fill",e),t.setAttributeNS(null,"stroke-opacity",i),t.setAttributeNS(null,"fill-opacity",i)}),s.visPropOld.fillcolor),this.isIE&&s.rendNode.parentNode.insertBefore(s.rendNode,s.rendNode))},_setArrowWidth:function(t,e,i,s){var n,r;t&&(0===e?t.setAttributeNS(null,"display","none"):(r=(n=e)*s,t.setAttributeNS(null,"viewBox","0 0 "+10*n+" "+10*n),t.setAttributeNS(null,"markerHeight",r),t.setAttributeNS(null,"markerWidth",r),t.setAttributeNS(null,"display","inherit")),this.isIE&&i.parentNode.insertBefore(i,i))},updateTicks:function(t){var e,i,s,r,o,a="",l=t.ticks.length;for(e=0;e<l;e++)o=(i=t.ticks[e])[1],n.isNumber((r=i[0])[0])&&n.isNumber(r[1])&&(a+="M "+r[0]+" "+o[0]+" L "+r[1]+" "+o[1]+" ");n.exists(s=t.rendNode)||(s=this.createPrim("path",t.id),this.appendChildPrim(s,n.evaluate(t.visProp.layer)),t.rendNode=s),s.setAttributeNS(null,"stroke",n.evaluate(t.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",n.evaluate(t.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",n.evaluate(t.visProp.strokewidth)),this.updatePathPrim(s,a,t.board)},displayCopyright:function(t,e){var i,s=this.createPrim("text","licenseText");s.setAttributeNS(null,"x","20px"),s.setAttributeNS(null,"y",2+e+"px"),s.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+e+"px; fill:#356AA0;  opacity:0.3;"),i=this.container.ownerDocument.createTextNode(t),s.appendChild(i),this.appendChildPrim(s,0)},drawInternalText:function(t){var e=this.createPrim("text",t.id);return e.style.whiteSpace="nowrap",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,n.evaluate(t.visProp.layer)),e},updateInternalText:function(t){var e,i=t.plaintext,s=t.getAnchorX(),r=t.getAnchorY();t.rendNode.getAttributeNS(null,"class")!==t.visProp.cssclass&&(t.rendNode.setAttributeNS(null,"class",n.evaluate(t.visProp.cssclass)),t.needsSizeUpdate=!0),isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])||(t.visPropOld.left!==s+(e=t.coords.scrCoords[1])&&(t.rendNode.setAttributeNS(null,"x",e+"px"),"left"===s?t.rendNode.setAttributeNS(null,"text-anchor","start"):"right"===s?t.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===s&&t.rendNode.setAttributeNS(null,"text-anchor","middle"),t.visPropOld.left=s+e),t.visPropOld.top!==r+(e=t.coords.scrCoords[2])&&(t.rendNode.setAttributeNS(null,"y",e+.5*this.vOffsetText+"px"),"bottom"===r?t.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):"top"===r?t.rendNode.setAttributeNS(null,"dy","1.6ex"):"middle"===r&&t.rendNode.setAttributeNS(null,"dy","0.6ex"),t.visPropOld.top=r+e)),t.htmlStr!==i&&(t.rendNodeText.data=i,t.htmlStr=i),this.transformImage(t,t.transformations)},updateInternalTextStyle:function(t,e,i,s){this.setObjectFillColor(t,e,i)},drawImage:function(t){var e=this.createPrim("image",t.id);e.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(e,n.evaluate(t.visProp.layer)),t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var i,s,n=t.rendNode,r="";e.length>0&&(i=[(s=this.joinTransforms(t,e))[1][1],s[2][1],s[1][2],s[2][2],s[1][0],s[2][0]].join(","),n.setAttributeNS(null,"transform",r+=" matrix("+i+") "))},updateImageURL:function(t){var e=n.evaluate(t.url);t.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",e)},updateImageStyle:function(t,e){var i=n.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass);t.rendNode.setAttributeNS(null,"class",i)},appendChildPrim:function(t,i){return n.exists(i)?i>=e.layer.numlayers&&(i=e.layer.numlayers-1):i=0,this.layer[i].appendChild(t),t},createPrim:function(t,e){var i=this.container.ownerDocument.createElementNS(this.svgNamespace,t);return i.setAttributeNS(null,"id",this.container.id+"_"+e),i.style.position="absolute","path"===t&&(i.setAttributeNS(null,"stroke-linecap","round"),i.setAttributeNS(null,"stroke-linejoin","round")),i},remove:function(t){n.exists(t)&&n.exists(t.parentNode)&&t.parentNode.removeChild(t)},makeArrows:function(t){var e,i=n.evaluate(t.visProp.firstarrow),s=n.evaluate(t.visProp.lastarrow);t.visPropOld.firstarrow!==i||t.visPropOld.lastarrow!==s?(i?n.exists(e=t.rendNodeTriangleStart)?this.defs.appendChild(e):(e=this._createArrowHead(t,"End"),this.defs.appendChild(e),t.rendNodeTriangleStart=e,t.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+t.id+"TriangleEnd)")):n.exists(e=t.rendNodeTriangleStart)&&this.remove(e),s?n.exists(e=t.rendNodeTriangleEnd)?this.defs.appendChild(e):(e=this._createArrowHead(t,"Start"),this.defs.appendChild(e),t.rendNodeTriangleEnd=e,t.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+t.id+"TriangleStart)")):n.exists(e=t.rendNodeTriangleEnd)&&this.remove(e),t.visPropOld.firstarrow=i,t.visPropOld.lastarrow=s):this.isIE&&t.visPropCalc.visible&&(i||s)&&t.rendNode.parentNode.insertBefore(t.rendNode,t.rendNode)},updateEllipsePrim:function(t,e,i,s,n){var r;r=2e5,e=Math.abs(e)<r?e:r*e/Math.abs(e),i=Math.abs(i)<r?i:r*i/Math.abs(i),s=Math.abs(s)<r?s:r*s/Math.abs(s),n=Math.abs(n)<r?n:r*n/Math.abs(n),t.setAttributeNS(null,"cx",e),t.setAttributeNS(null,"cy",i),t.setAttributeNS(null,"rx",Math.abs(s)),t.setAttributeNS(null,"ry",Math.abs(n))},updateLinePrim:function(t,e,i,s,n){var r;r=2e5,isNaN(e+i+s+n)||(e=Math.abs(e)<r?e:r*e/Math.abs(e),i=Math.abs(i)<r?i:r*i/Math.abs(i),s=Math.abs(s)<r?s:r*s/Math.abs(s),n=Math.abs(n)<r?n:r*n/Math.abs(n),t.setAttributeNS(null,"x1",e),t.setAttributeNS(null,"y1",i),t.setAttributeNS(null,"x2",s),t.setAttributeNS(null,"y2",n))},updatePathPrim:function(t,e){""===e&&(e="M 0 0"),t.setAttributeNS(null,"d",e)},updatePathStringPoint:function(t,e,i){var s="",n=t.coords.scrCoords,r=e*Math.sqrt(3)*.5,o=.5*e;return"x"===i?s=" M "+(n[1]-e)+" "+(n[2]-e)+" L "+(n[1]+e)+" "+(n[2]+e)+" M "+(n[1]+e)+" "+(n[2]-e)+" L "+(n[1]-e)+" "+(n[2]+e):"+"===i?s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+e)+" "+n[2]+" M "+n[1]+" "+(n[2]-e)+" L "+n[1]+" "+(n[2]+e):"<>"===i?s=" M "+(n[1]-e)+" "+n[2]+" L "+n[1]+" "+(n[2]+e)+" L "+(n[1]+e)+" "+n[2]+" L "+n[1]+" "+(n[2]-e)+" Z ":"^"===i?s=" M "+n[1]+" "+(n[2]-e)+" L "+(n[1]-r)+" "+(n[2]+o)+" L "+(n[1]+r)+" "+(n[2]+o)+" Z ":"v"===i?s=" M "+n[1]+" "+(n[2]+e)+" L "+(n[1]-r)+" "+(n[2]-o)+" L "+(n[1]+r)+" "+(n[2]-o)+" Z ":">"===i?s=" M "+(n[1]+e)+" "+n[2]+" L "+(n[1]-o)+" "+(n[2]-r)+" L "+(n[1]-o)+" "+(n[2]+r)+" Z ":"<"===i&&(s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+o)+" "+(n[2]-r)+" L "+(n[1]+o)+" "+(n[2]+r)+" Z "),s},updatePathStringPrim:function(t){var e,i,s,n=" M ",r="";if(t.numberPoints<=0)return"";if(s=Math.min(t.points.length,t.numberPoints),1===t.bezierDegree)for(e=0;e<s;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?n=" M ":(i[1]=Math.max(Math.min(i[1],5e3),-5e3),i[2]=Math.max(Math.min(i[2],5e3),-5e3),r+=n+i[1]+" "+i[2],n=" L ");else if(3===t.bezierDegree)for(e=0;e<s;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?n=" M ":(r+=n+i[1]+" "+i[2]," C "===n&&(r+=" "+(i=t.points[e+=1].scrCoords)[1]+" "+i[2],r+=" "+(i=t.points[e+=1].scrCoords)[1]+" "+i[2]),n=" C "),e+=1;return r},updatePathStringBezierPrim:function(t){var e,i,s,r,o,a,c,h=" M ",u="",d=n.evaluate(t.visProp.strokewidth),p="plot"!==n.evaluate(t.visProp.curvetype);if(t.numberPoints<=0)return"";for(p&&t.board.options.curve.RDPsmoothing&&(t.points=l.RamerDouglasPeucker(t.points,.5)),c=Math.min(t.points.length,t.numberPoints),i=1;i<3;i++)for(h=" M ",e=0;e<c;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?h=" M ":(r[1]=Math.max(Math.min(r[1],5e3),-5e3),r[2]=Math.max(Math.min(r[2],5e3),-5e3),u+=" M "===h?h+r[1]+" "+r[2]:[h,o+.333*(r[1]-o)+d*((s=2*i)*Math.random()-i)," ",a+.333*(r[2]-a)+d*(s*Math.random()-i)," ",o+.666*(r[1]-o)+d*(s*Math.random()-i)," ",a+.666*(r[2]-a)+d*(s*Math.random()-i)," ",r[1]," ",r[2]].join(""),h=" C ",o=r[1],a=r[2]);return u},updatePolygonPrim:function(t,e){var i,s,n="",r=e.vertices.length;for(t.setAttributeNS(null,"stroke","none"),i=0;i<r-1;i++){if(!e.vertices[i].isReal)return void t.setAttributeNS(null,"points","");n=n+(s=e.vertices[i].coords.scrCoords)[1]+","+s[2],i<r-2&&(n+=" ")}-1===n.indexOf("NaN")&&t.setAttributeNS(null,"points",n)},updateRectPrim:function(t,e,i,s,n){t.setAttributeNS(null,"x",e),t.setAttributeNS(null,"y",i),t.setAttributeNS(null,"width",s),t.setAttributeNS(null,"height",n)},setPropertyPrim:function(t,e,i){"stroked"!==e&&t.setAttributeNS(null,e,i)},display:function(t,e){var i;t&&t.rendNode&&(t.visPropOld.visible=e,i=t.rendNode,e?(i.setAttributeNS(null,"display","inline"),i.style.visibility="inherit"):(i.setAttributeNS(null,"display","none"),i.style.visibility="hidden"))},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(e,!0)},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(e,!1)},setBuffering:function(t,e){t.rendNode.setAttribute("buffered-rendering",e)},setDashStyle:function(t){var e=n.evaluate(t.visProp.dash),i=t.rendNode;e>0?i.setAttributeNS(null,"stroke-dasharray",this.dashArray[e-1]):i.hasAttributeNS(null,"stroke-dasharray")&&i.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(t){var e,i,s,r,o,a=t.rendNode,l=n.evaluate(t.visProp.gradient);i=(i=n.evaluate(t.visProp.fillopacity))>0?i:0,e=n.evaluate(t.visProp.fillcolor),"linear"===l?((s=this.createPrim("linearGradient",t.id+"_gradient")).setAttributeNS(null,"x1","0%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y1","0%"),s.setAttributeNS(null,"y2","0%"),(r=this.createPrim("stop",t.id+"_gradient1")).setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),(o=this.createPrim("stop",t.id+"_gradient2")).setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),s.appendChild(r),s.appendChild(o),this.defs.appendChild(s),a.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+t.id+"_gradient)"),t.gradNode1=r,t.gradNode2=o):"radial"===l?((s=this.createPrim("radialGradient",t.id+"_gradient")).setAttributeNS(null,"cx","50%"),s.setAttributeNS(null,"cy","50%"),s.setAttributeNS(null,"r","50%"),s.setAttributeNS(null,"fx",100*n.evaluate(t.visProp.gradientpositionx)+"%"),s.setAttributeNS(null,"fy",100*n.evaluate(t.visProp.gradientpositiony)+"%"),(r=this.createPrim("stop",t.id+"_gradient1")).setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),(o=this.createPrim("stop",t.id+"_gradient2")).setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),s.appendChild(r),s.appendChild(o),this.defs.appendChild(s),a.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+t.id+"_gradient)"),t.gradNode1=r,t.gradNode2=o):a.removeAttributeNS(null,"style")},updateGradient:function(t){var e,i,s=t.gradNode1,r=t.gradNode2,o=n.evaluate(t.visProp.gradient);n.exists(s)&&n.exists(r)&&(i=(i=n.evaluate(t.visProp.fillopacity))>0?i:0,e=n.evaluate(t.visProp.fillcolor),"linear"===o?(s.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i),r.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity))):"radial"===o&&(s.setAttributeNS(null,"style","stop-color:"+n.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+n.evaluate(t.visProp.gradientsecondopacity)),r.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+i)))},setObjectTransition:function(t,e){var i,r,o,a=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(void 0===e&&(e=n.evaluate(t.visProp.transitionduration)),e!==t.visPropOld.transitionduration){for(i=t.elementClass===s.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?" color "+e+"ms, opacity "+e+"ms":" fill "+e+"ms, fill-opacity "+e+"ms, stroke "+e+"ms, stroke-opacity "+e+"ms",o=a.length,r=0;r<o;++r)t[a[r]]&&(t[a[r]].style.transition=i);t.visPropOld.transitionduration=e}},_setAttribute:function(t,e){""===e?t():setTimeout(t,1)},setObjectFillColor:function(e,i,s,r){var a,l,c,h,u=n.evaluate(i),d=n.evaluate(s);d=d>0?d:0,e.visPropOld.fillcolor===u&&e.visPropOld.fillopacity===d||(n.exists(u)&&!1!==u&&(9!==u.length?(l=u,h=d):(c=o.rgba2rgbo(u),l=c[0],h=d*c[1]),a=void 0===r?e.rendNode:r,"none"!==l&&this._setAttribute((function(){a.setAttributeNS(null,"fill",l)}),e.visPropOld.fillcolor),e.type===t.OBJECT_TYPE_IMAGE?this._setAttribute((function(){a.setAttributeNS(null,"opacity",h)}),e.visPropOld.fillopacity):("none"===l&&(h=0),this._setAttribute((function(){a.setAttributeNS(null,"fill-opacity",h)}),e.visPropOld.fillopacity)),n.exists(e.visProp.gradient)&&this.updateGradient(e)),e.visPropOld.fillcolor=u,e.visPropOld.fillopacity=d)},setObjectStrokeColor:function(t,e,i){var r,a,l,c,h=n.evaluate(e),u=n.evaluate(i);u=u>0?u:0,t.visPropOld.strokecolor===h&&t.visPropOld.strokeopacity===u||(n.exists(h)&&!1!==h&&(9!==h.length?(r=h,l=u):(a=o.rgba2rgbo(h),r=a[0],l=u*a[1]),c=t.rendNode,t.elementClass===s.OBJECT_CLASS_TEXT?"html"===n.evaluate(t.visProp.display)?this._setAttribute((function(){c.style.color=r,c.style.opacity=l}),t.visPropOld.strokecolor):this._setAttribute((function(){c.setAttributeNS(null,"style","fill:"+r),c.setAttributeNS(null,"style","fill-opacity:"+l)}),t.visPropOld.strokecolor):this._setAttribute((function(){c.setAttributeNS(null,"stroke",r),c.setAttributeNS(null,"stroke-opacity",l)}),t.visPropOld.strokecolor),t.elementClass!==s.OBJECT_CLASS_CURVE&&t.elementClass!==s.OBJECT_CLASS_LINE||(n.evaluate(t.visProp.firstarrow)&&this._setArrowColor(t.rendNodeTriangleStart,r,l,t),n.evaluate(t.visProp.lastarrow)&&this._setArrowColor(t.rendNodeTriangleEnd,r,l,t))),t.visPropOld.strokecolor=h,t.visPropOld.strokeopacity=u)},setObjectStrokeWidth:function(t,e){var i,s=n.evaluate(e);isNaN(s)||t.visPropOld.strokewidth===s||(this.setPropertyPrim(i=t.rendNode,"stroked","true"),n.exists(s)&&this.setPropertyPrim(i,"stroke-width",s+"px"),t.visPropOld.strokewidth=s)},setLineCap:function(t){var e=n.evaluate(t.visProp.linecap);void 0!==e&&""!==e&&t.visPropOld.linecap!==e&&n.exists(t.rendNode)&&(this.setPropertyPrim(t.rendNode,"stroke-linecap",e),t.visPropOld.linecap=e)},setShadow:function(t){var e=n.evaluate(t.visProp.shadow);t.visPropOld.shadow!==e&&(n.exists(t.rendNode)&&(e?t.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):t.rendNode.removeAttributeNS(null,"filter")),t.visPropOld.shadow=e)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(t,e){this.svgRoot.style.width=parseFloat(t)+"px",this.svgRoot.style.height=parseFloat(e)+"px",this.svgRoot.setAttribute("width",parseFloat(t)),this.svgRoot.setAttribute("height",parseFloat(e))},createTouchpoints:function(t){var e,i;for(this.touchpoints=[],e=0;e<t;e++)i=this.createPrim("path","touchpoint1_"+e),this.appendChildPrim(i,19),i.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(i),this.setPropertyPrim(i,"stroked","true"),this.setPropertyPrim(i,"stroke-width","1px"),i.setAttributeNS(null,"stroke","#000000"),i.setAttributeNS(null,"stroke-opacity",1),i.setAttributeNS(null,"display","none"),i=this.createPrim("ellipse","touchpoint2_"+e),this.appendChildPrim(i,19),this.updateEllipsePrim(i,0,0,0,0),this.touchpoints.push(i),this.setPropertyPrim(i,"stroked","true"),this.setPropertyPrim(i,"stroke-width","1px"),i.setAttributeNS(null,"stroke","#000000"),i.setAttributeNS(null,"stroke-opacity",1),i.setAttributeNS(null,"fill","#ffffff"),i.setAttributeNS(null,"fill-opacity",0),i.setAttributeNS(null,"display","none")},showTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","inline"),this.touchpoints[2*t+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","none"),this.touchpoints[2*t+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(t,e){var i,s;this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"d","M "+((i=e[0])-37)+" "+(s=e[1])+" L "+(i+37)+" "+s+" M "+i+" "+(s-37)+" L "+i+" "+(s+37)),this.updateEllipsePrim(this.touchpoints[2*t+1],e[0],e[1],25,25))},dumpToCanvas:function(t,e,i,s){var r,o,l,c,h,u,d=this.svgRoot,p=window.btoa||a.encode;if(this.container.hasChildNodes()&&n.exists(this.foreignObjLayer)){for(;d.nextSibling;)this.foreignObjLayer.appendChild(d.nextSibling);!0===s&&this.container.ownerDocument.createElement("div").appendChild(this.foreignObjLayer)}if(d.setAttribute("xmlns","http://www.w3.org/2000/svg"),h=d.getAttribute("width"),u=d.getAttribute("height"),((r=(new XMLSerializer).serializeToString(d)).match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(r=r.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),r=r.replace(/&nbsp;/g," "),(l=document.getElementById(t)).width=l.width,c=l.getContext("2d"),void 0!==e&&void 0!==i&&(l.style.width=parseFloat(e)+"px",l.style.height=parseFloat(i)+"px",l.setAttribute("width",2*parseFloat(h)),l.setAttribute("height",2*parseFloat(u)),c.scale(2*h/e,2*u/i)),(o=new Image).src="data:image/svg+xml;base64,"+p(unescape(encodeURIComponent(r))),o.onload=function(){setTimeout((function(){c.drawImage(o,0,0,e,i)}),200)},n.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(!0===s&&d.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(t,e,i){var s,r,o,a,l,c,h,u,d,p,f,m=this.container.ownerDocument,g=this.container.parentNode,b=t.attr.screenshot,y=!1;return"no"===this.type||(u=b.scale*parseFloat(this.container.style.width),d=b.scale*parseFloat(this.container.style.height),void 0===e||""===e?(y=!0,(l=new Image).style.width=u+"px",l.style.height=d+"px"):(y=!1,l=m.getElementById(e)),y&&((s=m.createElement("div")).style.cssText=b.css,s.style.width=u+"px",s.style.height=d+"px",s.style.zIndex=this.container.style.zIndex+120,r=t.getCoordsTopLeftCorner(),s.style.position="absolute",s.style.left=r[0]+"px",s.style.top=r[1]+"px"),o=m.createElement("canvas"),a=Math.random().toString(36).substr(2,5),o.setAttribute("id",a),o.setAttribute("width",u),o.setAttribute("height",d),o.style.width=u+"px",o.style.height=u+"px",o.style.display="none",g.append(o),y&&(c=m.createElement("span"),h=m.createTextNode("â"),c.style.cssText=b.cssButton,c.appendChild(h),c.onclick=function(){s.parentNode.removeChild(s)},s.appendChild(l),s.appendChild(c),g.appendChild(s)),p=document.getElementById(this.container.id+"_navigationbar"),n.exists(p)&&(f=p.style.display,p.style.display="none"),this.dumpToCanvas(a,u,d,i),setTimeout((function(){l.src=o.toDataURL("image/png"),g.removeChild(o)}),400),n.exists(p)&&(p.style.display=f)),this}}),t.SVGRenderer})),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],(function(t,e,i,s,n,r,o){"use strict";return t.VMLRenderer=function(e){this.type="vml",this.container=e,this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,s.exists(t.vmlStylesheet)||(e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),t.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),t.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{e.ownerDocument.namespaces.jxgvml||e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(t){return e.ownerDocument.createElement("<jxgvml:"+t+' class="jxgvml">')}}catch(t){this.createNode=function(t){return e.ownerDocument.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},t.VMLRenderer.prototype=new e,t.extend(t.VMLRenderer.prototype,{_setAttr:function(e,i,s,n){try{8===this.container.ownerDocument.documentMode?e[i]=s:e.setAttribute(i,s,n)}catch(e){t.debug("_setAttr: "+i+" "+s+"<br>\n")}},updateTicks:function(t){var e,i,n,r,o,a=this.resolution,l=[];for(i=t.ticks.length,e=0;e<i;e++)o=(n=t.ticks[e])[1],s.isNumber((r=n[0])[0])&&s.isNumber(r[1])&&l.push(" m "+Math.round(a*r[0])+", "+Math.round(a*o[0])+" l "+Math.round(a*r[1])+", "+Math.round(a*o[1])+" ");s.exists(t.rendNode)||(t.rendNode=this.createPrim("path",t.id),this.appendChildPrim(t.rendNode,s.evaluate(t.visProp.layer))),this._setAttr(t.rendNode,"stroked","true"),this._setAttr(t.rendNode,"strokecolor",s.evaluate(t.visProp.strokecolor),1),this._setAttr(t.rendNode,"strokeweight",s.evaluate(t.visProp.strokewidth)),this._setAttr(t.rendNodeStroke,"opacity",100*s.evaluate(t.visProp.strokeopacity)+"%"),this.updatePathPrim(t.rendNode,l,t.board)},displayCopyright:function(t,e){var i,s;(i=this.createNode("textbox")).style.position="absolute",this._setAttr(i,"id",this.container.id+"_licenseText"),i.style.left=20,i.style.top=2,i.style.fontSize=e,i.style.color="#356AA0",i.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(i,"opacity","30%"),i.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",s=this.container.ownerDocument.createTextNode(t),i.appendChild(s),this.appendChildPrim(i,0)},drawInternalText:function(t){var e;return(e=this.createNode("textbox")).style.position="absolute",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,9),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",e},updateInternalText:function(t){var e,i,s,n,o,a,l=t.plaintext,c=this.joinTransforms(t,t.transformations),h=[0,0],u=t.rendNode,d=[],p=t.getAnchorX(),f=t.getAnchorY();if(!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])){for("right"===p?h[0]=1:"middle"===p&&(h[0]=.5),"bottom"===f?h[1]=1:"middle"===f&&(h[1]=.5),d[0]=r.matVecMult(c,[1,t.coords.scrCoords[1]-h[0]*t.size[0],t.coords.scrCoords[2]+(1-h[1])*t.size[1]+this.vOffsetText]),d[0][1]/=d[0][0],d[0][2]/=d[0][0],d[1]=r.matVecMult(c,[1,t.coords.scrCoords[1]+(1-h[0])*t.size[0],t.coords.scrCoords[2]+(1-h[1])*t.size[1]+this.vOffsetText]),d[1][1]/=d[1][0],d[1][2]/=d[1][0],d[2]=r.matVecMult(c,[1,t.coords.scrCoords[1]+(1-h[0])*t.size[0],t.coords.scrCoords[2]-h[1]*t.size[1]+this.vOffsetText]),d[2][1]/=d[2][0],d[2][2]/=d[2][0],d[3]=r.matVecMult(c,[1,t.coords.scrCoords[1]-h[0]*t.size[0],t.coords.scrCoords[2]-h[1]*t.size[1]+this.vOffsetText]),d[3][1]/=d[3][0],d[3][2]/=d[3][0],i=d[0][1],n=d[0][1],s=d[0][2],o=d[0][2],a=1;a<4;a++)i=Math.max(i,d[a][1]),n=Math.min(n,d[a][1]),s=Math.max(s,d[a][2]),o=Math.min(o,d[a][2]);e=1===h[0]?Math.floor(t.board.canvasWidth-i):Math.floor(n),t.visPropOld.left!==p+e&&(1===h[0]?(t.rendNode.style.right=e+"px",t.rendNode.style.left="auto"):(t.rendNode.style.left=e+"px",t.rendNode.style.right="auto"),t.visPropOld.left=p+e),e=1===h[1]?Math.floor(t.board.canvasHeight-s):Math.floor(o),t.visPropOld.top!==f+e&&(1===h[1]?(t.rendNode.style.bottom=e+"px",t.rendNode.style.top="auto"):(t.rendNode.style.top=e+"px",t.rendNode.style.bottom="auto"),t.visPropOld.top=f+e)}t.htmlStr!==l&&(t.rendNodeText.data=l,t.htmlStr=l),u.filters.item(0).M11=c[1][1],u.filters.item(0).M12=c[1][2],u.filters.item(0).M21=c[2][1],u.filters.item(0).M22=c[2][2],u.filters.item(0).enabled=!0},drawImage:function(t){var e;(e=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(e,"id",this.container.id+"_"+t.id),this.container.appendChild(e),this.appendChildPrim(e,s.evaluate(t.visProp.layer)),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var i,s,n,o,a,l,c=t.rendNode,h=[];if(e.length>0){for(i=this.joinTransforms(t,e),h[0]=r.matVecMult(i,t.coords.scrCoords),h[0][1]/=h[0][0],h[0][2]/=h[0][0],h[1]=r.matVecMult(i,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]]),h[1][1]/=h[1][0],h[1][2]/=h[1][0],h[2]=r.matVecMult(i,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]-t.size[1]]),h[2][1]/=h[2][0],h[2][2]/=h[2][0],h[3]=r.matVecMult(i,[1,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1]]),h[3][1]/=h[3][0],h[3][2]/=h[3][0],s=h[0][1],o=h[0][1],n=h[0][2],a=h[0][2],l=1;l<4;l++)s=Math.max(s,h[l][1]),o=Math.min(o,h[l][1]),n=Math.max(n,h[l][2]),a=Math.min(a,h[l][2]);c.style.left=Math.floor(o)+"px",c.style.top=Math.floor(a)+"px",c.filters.item(0).M11=i[1][1],c.filters.item(0).M12=i[1][2],c.filters.item(0).M21=i[2][1],c.filters.item(0).M22=i[2][2],c.filters.item(0).enabled=!0}},updateImageURL:function(t){var e=s.evaluate(t.url);this._setAttr(t.rendNode,"src",e)},appendChildPrim:function(t,e){return s.exists(e)||(e=0),t.style.zIndex=e,this.container.appendChild(t),t},appendNodesToElement:function(t,e){"shape"!==e&&"path"!==e&&"polygon"!==e||(t.rendNodePath=this.getElementById(t.id+"_path")),t.rendNodeFill=this.getElementById(t.id+"_fill"),t.rendNodeStroke=this.getElementById(t.id+"_stroke"),t.rendNodeShadow=this.getElementById(t.id+"_shadow"),t.rendNode=this.getElementById(t.id)},createPrim:function(t,e){var i,s,n=this.createNode("fill"),r=this.createNode("stroke"),o=this.createNode("shadow");return this._setAttr(n,"id",this.container.id+"_"+e+"_fill"),this._setAttr(r,"id",this.container.id+"_"+e+"_stroke"),this._setAttr(o,"id",this.container.id+"_"+e+"_shadow"),"circle"===t||"ellipse"===t?((i=this.createNode("oval")).appendChild(n),i.appendChild(r),i.appendChild(o)):"polygon"===t||"path"===t||"shape"===t||"line"===t?((i=this.createNode("shape")).appendChild(n),i.appendChild(r),i.appendChild(o),s=this.createNode("path"),this._setAttr(s,"id",this.container.id+"_"+e+"_path"),i.appendChild(s)):((i=this.createNode(t)).appendChild(n),i.appendChild(r),i.appendChild(o)),i.style.position="absolute",i.style.left="0px",i.style.top="0px",this._setAttr(i,"id",this.container.id+"_"+e),i},remove:function(t){s.exists(t)&&t.removeNode(!0)},makeArrows:function(t){var e,i=s.evaluate(t.visProp.firstarrow),n=s.evaluate(t.visProp.lastarrow);t.visPropOld.firstarrow===i&&t.visPropOld.lastarrow===n||(i?(this._setAttr(e=t.rendNodeStroke,"startarrow","block"),this._setAttr(e,"startarrowlength","long")):s.exists(e=t.rendNodeStroke)&&this._setAttr(e,"startarrow","none"),n?(this._setAttr(e=t.rendNodeStroke,"id",this.container.id+"_"+t.id+"stroke"),this._setAttr(e,"endarrow","block"),this._setAttr(e,"endarrowlength","long")):s.exists(e=t.rendNodeStroke)&&this._setAttr(e,"endarrow","none"),t.visPropOld.firstarrow=i,t.visPropOld.lastarrow=n)},updateEllipsePrim:function(t,e,i,s,n){t.style.left=Math.floor(e-s)+"px",t.style.top=Math.floor(i-n)+"px",t.style.width=Math.floor(2*Math.abs(s))+"px",t.style.height=Math.floor(2*Math.abs(n))+"px"},updateLinePrim:function(t,e,i,s,n,r){var o,a=this.resolution;isNaN(e+i+s+n)||(o=["m ",Math.floor(a*e),", ",Math.floor(a*i)," l ",Math.floor(a*s),", ",Math.floor(a*n)],this.updatePathPrim(t,o,r))},updatePathPrim:function(t,e,i){var s=i.canvasWidth,n=i.canvasHeight;e.length<=0&&(e=["m 0,0"]),t.style.width=s,t.style.height=n,this._setAttr(t,"coordsize",[Math.floor(this.resolution*s),Math.floor(this.resolution*n)].join(",")),this._setAttr(t,"path",e.join(""))},updatePathStringPoint:function(t,e,i){var s=[],n=Math.round,r=t.coords.scrCoords,o=e*Math.sqrt(3)*.5,a=.5*e,l=this.resolution;return"x"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*(r[2]-e))," l ",n(l*(r[1]+e)),", ",n(l*(r[2]+e))," m ",n(l*(r[1]+e)),", ",n(l*(r[2]-e))," l ",n(l*(r[1]-e)),", ",n(l*(r[2]+e))].join("")):"+"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*(r[1]+e)),", ",n(l*r[2])," m ",n(l*r[1]),", ",n(l*(r[2]-e))," l ",n(l*r[1]),", ",n(l*(r[2]+e))].join("")):"<>"===i?s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*r[1]),", ",n(l*(r[2]+e))," l ",n(l*(r[1]+e)),", ",n(l*r[2])," l ",n(l*r[1]),", ",n(l*(r[2]-e))," x e "].join("")):"^"===i?s.push([" m ",n(l*r[1]),", ",n(l*(r[2]-e))," l ",n(l*(r[1]-o)),", ",n(l*(r[2]+a))," l ",n(l*(r[1]+o)),", ",n(l*(r[2]+a))," x e "].join("")):"v"===i?s.push([" m ",n(l*r[1]),", ",n(l*(r[2]+e))," l ",n(l*(r[1]-o)),", ",n(l*(r[2]-a))," l ",n(l*(r[1]+o)),", ",n(l*(r[2]-a))," x e "].join("")):">"===i?s.push([" m ",n(l*(r[1]+e)),", ",n(l*r[2])," l ",n(l*(r[1]-a)),", ",n(l*(r[2]-o))," l ",n(l*(r[1]-a)),", ",n(l*(r[2]+o))," l ",n(l*(r[1]+e)),", ",n(l*r[2])].join("")):"<"===i&&s.push([" m ",n(l*(r[1]-e)),", ",n(l*r[2])," l ",n(l*(r[1]+a)),", ",n(l*(r[2]-o))," l ",n(l*(r[1]+a)),", ",n(l*(r[2]+o))," x e "].join("")),s},updatePathStringPrim:function(t){var e,i,s=[],n=this.resolution,r=Math.round,o=" m ",a=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";if(a=Math.min(a,t.points.length),1===t.bezierDegree)for(e=0;e<a;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o=" m ":(i[1]>2e4?i[1]=2e4:i[1]<-2e4&&(i[1]=-2e4),i[2]>2e4?i[2]=2e4:i[2]<-2e4&&(i[2]=-2e4),s.push([o,r(n*i[1]),", ",r(n*i[2])].join("")),o=" l ");else if(3===t.bezierDegree)for(e=0;e<a;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o=" m ":(s.push([o,r(n*i[1]),", ",r(n*i[2])].join(""))," c "===o&&(s.push([" ",r(n*(i=t.points[e+=1].scrCoords)[1]),", ",r(n*i[2])].join("")),s.push([" ",r(n*(i=t.points[e+=1].scrCoords)[1]),", ",r(n*i[2])].join(""))),o=" c "),e+=1;return s.push(" e"),s},updatePathStringBezierPrim:function(t){var e,i,n,r,a,l,c=[],h=s.evaluate(t.visProp.strokewidth),u=this.resolution,d=Math.round,p=" m ",f="plot"!==s.evaluate(t.visProp.curvetype),m=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";for(f&&t.board.options.curve.RDPsmoothing&&(t.points=o.RamerDouglasPeucker(t.points,1)),m=Math.min(m,t.points.length),i=1;i<3;i++)for(p=" m ",e=0;e<m;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?p=" m ":(r[1]>2e4?r[1]=2e4:r[1]<-2e4&&(r[1]=-2e4),r[2]>2e4?r[2]=2e4:r[2]<-2e4&&(r[2]=-2e4),c.push(" m "===p?[p,d(u*r[1])," ",d(u*r[2])].join(""):[p,d(u*(a+.333*(r[1]-a)+h*((n=2*i)*Math.random()-i)))," ",d(u*(l+.333*(r[2]-l)+h*(n*Math.random()-i)))," ",d(u*(a+.666*(r[1]-a)+h*(n*Math.random()-i)))," ",d(u*(l+.666*(r[2]-l)+h*(n*Math.random()-i)))," ",d(u*r[1])," ",d(u*r[2])].join("")),p=" c ",a=r[1],l=r[2]);return c.push(" e"),c},updatePolygonPrim:function(t,e){var i,s,n=e.vertices.length,r=this.resolution,o=[];if(this._setAttr(t,"stroked","false"),s=e.vertices[0].coords.scrCoords,!isNaN(s[1]+s[2])){for(o.push(["m ",Math.floor(r*s[1]),",",Math.floor(r*s[2])," l "].join("")),i=1;i<n-1;i++){if(!e.vertices[i].isReal)return void this.updatePathPrim(t,"",e.board);if(s=e.vertices[i].coords.scrCoords,isNaN(s[1]+s[2]))return;o.push(Math.floor(r*s[1])+","+Math.floor(r*s[2])),i<n-2&&o.push(", ")}o.push(" x e"),this.updatePathPrim(t,o,e.board)}},updateRectPrim:function(t,e,i,s,n){t.style.left=Math.floor(e)+"px",t.style.top=Math.floor(i)+"px",s>=0&&(t.style.width=s+"px"),n>=0&&(t.style.height=n+"px")},setPropertyPrim:function(t,e,i){var n,r="";switch(e){case"stroke":r="strokecolor";break;case"stroke-width":r="strokeweight";break;case"stroke-dasharray":r="dashstyle"}""!==r&&(n=s.evaluate(i),this._setAttr(t,r,n))},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),e&&e.rendNode&&(e.rendNode.style.visibility="inherit")},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),e&&e.rendNode&&(e.rendNode.style.visibility="hidden")},setDashStyle:function(t,e){e.dash>=0&&this._setAttr(t.rendNodeStroke,"dashstyle",this.dashArray[e.dash])},setGradient:function(t){var e=t.rendNodeFill,i=s.evaluate(t.visProp.gradient);"linear"===i?(this._setAttr(e,"type","gradient"),this._setAttr(e,"color2",s.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",s.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"angle",s.evaluate(t.visProp.gradientangle))):"radial"===i?(this._setAttr(e,"type","gradientradial"),this._setAttr(e,"color2",s.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",s.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"focusposition",100*s.evaluate(t.visProp.gradientpositionx)+"%,"+100*s.evaluate(t.visProp.gradientpositiony)+"%"),this._setAttr(e,"focussize","0,0")):this._setAttr(e,"type","solid")},setObjectFillColor:function(t,e,r){var o,a,l,c=s.evaluate(e),h=s.evaluate(r),u=t.rendNode;h=h>0?h:0,t.visPropOld.fillcolor===c&&t.visPropOld.fillopacity===h||(s.exists(c)&&!1!==c&&(9!==c.length?(o=c,l=h):(o=(a=n.rgba2rgbo(c))[0],l=h*a[1]),"none"===o||!1===o?this._setAttr(t.rendNode,"filled","false"):(this._setAttr(t.rendNode,"filled","true"),this._setAttr(t.rendNode,"fillcolor",o),s.exists(l)&&t.rendNodeFill&&this._setAttr(t.rendNodeFill,"opacity",100*l+"%")),t.type===i.OBJECT_TYPE_IMAGE&&u.filters.length>1&&(u.filters.item(1).opacity=Math.round(100*l),u.filters.item(1).enabled=!0)),t.visPropOld.fillcolor=c,t.visPropOld.fillopacity=h)},setObjectStrokeColor:function(t,e,n){var r,o,a,l,c=s.evaluate(e),h=s.evaluate(n),u=t.rendNode;h=h>0?h:0,t.visPropOld.strokecolor===c&&t.visPropOld.strokeopacity===h||(s.exists(c)&&!1!==c&&(9!==c.length?(r=c,a=h):(r=(o=e.rgba2rgbo(c))[0],a=h*o[1]),t.elementClass===i.OBJECT_CLASS_TEXT?(u.filters.length>1&&(u.filters.item(1).opacity=Math.round(100*a),u.filters.item(1).enabled=!0),u.style.color=r):(!1!==r&&(this._setAttr(u,"stroked","true"),this._setAttr(u,"strokecolor",r)),l=t.rendNodeStroke,s.exists(a)&&t.type!==i.OBJECT_TYPE_IMAGE&&this._setAttr(l,"opacity",100*a+"%"))),t.visPropOld.strokecolor=c,t.visPropOld.strokeopacity=h)},setObjectStrokeWidth:function(t,e){var i,n=s.evaluate(e);isNaN(n)||t.visPropOld.strokewidth===n||(this.setPropertyPrim(i=t.rendNode,"stroked","true"),s.exists(n)&&(this.setPropertyPrim(i,"stroke-width",n),0===n&&s.exists(t.rendNodeStroke)&&this._setAttr(i,"stroked","false")),t.visPropOld.strokewidth=n)},setShadow:function(t){var e=t.rendNodeShadow,i=s.evaluate(t.visProp.shadow);e&&t.visPropOld.shadow!==i&&(i?(this._setAttr(e,"On","True"),this._setAttr(e,"Offset","3pt,3pt"),this._setAttr(e,"Opacity","60%"),this._setAttr(e,"Color","#aaaaaa")):this._setAttr(e,"On","False"),t.visPropOld.shadow=i)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),t.VMLRenderer})),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],(function(t,e,i,s,n,r,o,a,l,c,h){"use strict";return t.CanvasRenderer=function(t,e){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=r.genUUID(),this.canvasNamespace=null,s.isBrowser?(this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',e.width,'px" height="',e.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):s.isNode()&&(this.canvasId="object"==typeof module?module.require("canvas"):require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},t.CanvasRenderer.prototype=new e,t.extend(t.CanvasRenderer.prototype,{_drawFilledPolygon:function(t){var e,i=t.length,s=this.context;if(i>0){for(s.beginPath(),s.moveTo(t[0][0],t[0][1]),e=0;e<i;e++)e>0&&s.lineTo(t[e][0],t[e][1]);s.lineTo(t[0][0],t[0][1]),s.fill()}},_fill:function(t){var e=this.context;e.save(),this._setColor(t,"fill")&&e.fill(),e.restore()},_rotatePoint:function(t,e,i){return[e*Math.cos(t)-i*Math.sin(t),e*Math.sin(t)+i*Math.cos(t)]},_rotateShape:function(t,e){var i,s=[],n=t.length;if(n<=0)return t;for(i=0;i<n;i++)s.push(this._rotatePoint(e,t[i][0],t[i][1]));return s},_setColor:function(t,e,i){var s,r,a,l,c,h,u,d=!0,p=!1,f=t.visProp;return e=e||"stroke",i=i||e,n.exists(t.board)&&n.exists(t.board.highlightedObjects)||(p=!0),s=!p&&n.exists(t.board.highlightedObjects[t.id])?"highlight":"","none"!==(a=n.evaluate(f[s+e+"color"]))&&!1!==a?(h=(h=n.evaluate(f[s+e+"opacity"]))>0?h:0,9!==a.length?(c=a,u=h):(c=(l=o.rgba2rgbo(a))[0],u=h*l[1]),this.context.globalAlpha=u,this.context[i+"Style"]=c):d=!1,r=parseFloat(n.evaluate(f.strokewidth)),"stroke"!==e||isNaN(r)||(0===r?this.context.globalAlpha=0:this.context.lineWidth=r),"stroke"===e&&void 0!==f.linecap&&""!==f.linecap&&(this.context.lineCap=f.linecap),d},_stroke:function(t){var e=this.context,i=n.evaluate(t.visProp.dash);e.save(),i>0?e.setLineDash&&e.setLineDash(this.dashArray[i]):this.context.lineDashArray=[],this._setColor(t,"stroke")&&e.stroke(),e.restore()},_translateShape:function(t,e,i){var s,n=[],r=t.length;if(r<=0)return t;for(s=0;s<r;s++)n.push([t[s][0]+e,t[s][1]+i]);return n},drawPoint:function(t){var e=n.evaluate(t.visProp.face),i=n.evaluate(t.visProp.size),s=t.coords.scrCoords,r=i*Math.sqrt(3)*.5,o=.5*i,a=parseFloat(n.evaluate(t.visProp.strokewidth))/2,l=this.context;if(t.visPropCalc.visible)switch(e){case"cross":case"x":l.beginPath(),l.moveTo(s[1]-i,s[2]-i),l.lineTo(s[1]+i,s[2]+i),l.moveTo(s[1]+i,s[2]-i),l.lineTo(s[1]-i,s[2]+i),l.lineCap="round",l.lineJoin="round",l.closePath(),this._stroke(t);break;case"circle":case"o":l.beginPath(),l.arc(s[1],s[2],i+1+a,0,2*Math.PI,!1),l.closePath(),this._fill(t),this._stroke(t);break;case"square":case"[]":if(i<=0)break;l.save(),this._setColor(t,"stroke","fill")&&l.fillRect(s[1]-i-a,s[2]-i-a,2*i+3*a,2*i+3*a),l.restore(),l.save(),this._setColor(t,"fill"),l.fillRect(s[1]-i+a,s[2]-i+a,2*i-a,2*i-a),l.restore();break;case"plus":case"+":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1]+i,s[2]),l.moveTo(s[1],s[2]-i),l.lineTo(s[1],s[2]+i),l.lineCap="round",l.lineJoin="round",l.closePath(),this._stroke(t);break;case"diamond":case"<>":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1],s[2]+i),l.lineTo(s[1]+i,s[2]),l.lineTo(s[1],s[2]-i),l.closePath(),this._fill(t),this._stroke(t);break;case"triangleup":case"a":case"^":l.beginPath(),l.moveTo(s[1],s[2]-i),l.lineTo(s[1]-r,s[2]+o),l.lineTo(s[1]+r,s[2]+o),l.closePath(),this._fill(t),this._stroke(t);break;case"triangledown":case"v":l.beginPath(),l.moveTo(s[1],s[2]+i),l.lineTo(s[1]-r,s[2]-o),l.lineTo(s[1]+r,s[2]-o),l.closePath(),this._fill(t),this._stroke(t);break;case"triangleleft":case"<":l.beginPath(),l.moveTo(s[1]-i,s[2]),l.lineTo(s[1]+o,s[2]-r),l.lineTo(s[1]+o,s[2]+r),l.closePath(),this.fill(t),this._stroke(t);break;case"triangleright":case">":l.beginPath(),l.moveTo(s[1]+i,s[2]),l.lineTo(s[1]-o,s[2]-r),l.lineTo(s[1]-o,s[2]+r),l.closePath(),this._fill(t),this._stroke(t)}},updatePoint:function(t){this.drawPoint(t)},drawLine:function(t){var e,s=new a(i.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),r=new a(i.COORDS_BY_USER,t.point2.coords.usrCoords,t.board),o=null,l=n.evaluate(t.visProp.firstarrow),h=n.evaluate(t.visProp.lastarrow);t.visPropCalc.visible&&((l||h)&&(o=-4),c.calcStraight(t,s,r,o),e=this.getPositionArrowHead(t,s,r),this.context.beginPath(),this.context.moveTo(e.c1.scrCoords[1]+e.d1x,e.c1.scrCoords[2]+e.d1y),this.context.lineTo(e.c2.scrCoords[1]-e.d2x,e.c2.scrCoords[2]-e.d2y),this._stroke(t),(l&&e.sFirst>0||h&&e.sLast>0)&&this.makeArrows(t,e.c1,e.c2))},updateLine:function(t){this.drawLine(t)},drawTicks:function(){},updateTicks:function(t){var e,i,s,n,r=t.ticks.length,o=this.context;for(o.beginPath(),e=0;e<r;e++)o.moveTo((s=(i=t.ticks[e])[0])[0],(n=i[1])[0]),o.lineTo(s[1],n[1]);for(e=0;e<r;e++)i=t.ticks[e].scrCoords,t.ticks[e].major&&(t.board.needsFullUpdate||t.needsRegularUpdate)&&t.labels[e]&&t.labels[e].visPropCalc.visible&&this.updateText(t.labels[e]);o.lineCap="round",this._stroke(t)},drawCurve:function(t){n.evaluate(t.visProp.handdrawing)?this.updatePathStringBezierPrim(t):this.updatePathStringPrim(t),t.numberPoints>1&&this.makeArrows(t)},updateCurve:function(t){this.drawCurve(t)},drawEllipse:function(t){var e=t.center.coords.scrCoords[1],i=t.center.coords.scrCoords[2],s=t.board.unitX,n=t.board.unitY,r=2*t.Radius(),o=2*t.Radius(),a=r*s,l=o*n,c=e-a/2,h=i-l/2,u=a/2*.5522848,d=l/2*.5522848,p=c+a,f=h+l,m=c+a/2,g=h+l/2,b=this.context;r>0&&o>0&&!isNaN(e+i)&&(b.beginPath(),b.moveTo(c,g),b.bezierCurveTo(c,g-d,m-u,h,m,h),b.bezierCurveTo(m+u,h,p,g-d,p,g),b.bezierCurveTo(p,g+d,m+u,f,m,f),b.bezierCurveTo(m-u,f,c,g+d,c,g),b.closePath(),this._fill(t),this._stroke(t))},updateEllipse:function(t){return this.drawEllipse(t)},displayCopyright:function(t,e){var i=this.context;i.save(),i.font=e+"px Arial",i.fillStyle="#aaa",i.lineWidth=.5,i.fillText(t,10,2+e),i.restore()},drawInternalText:function(t){var e=n.evaluate(t.visProp.fontsize),i=t.getAnchorX(),s=t.getAnchorY(),r=this.context;return r.save(),this._setColor(t,"stroke","fill")&&!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])&&(r.font=(e>0?e:0)+"px Arial",this.transformImage(t,t.transformations),"left"===i?r.textAlign="left":"right"===i?r.textAlign="right":"middle"===i&&(r.textAlign="center"),"bottom"===s?r.textBaseline="bottom":"top"===s?r.textBaseline="top":"middle"===s&&(r.textBaseline="middle"),r.fillText(t.plaintext,t.coords.scrCoords[1],t.coords.scrCoords[2])),r.restore(),null},updateInternalText:function(t){this.drawInternalText(t)},setObjectStrokeColor:function(t,e,s){var r,a,l,c,h=n.evaluate(e),u=n.evaluate(s);u=u>0?u:0,t.visPropOld.strokecolor===h&&t.visPropOld.strokeopacity===u||(n.exists(h)&&!1!==h&&(9!==h.length?(r=h,l=u):(r=(a=o.rgba2rgbo(h))[0],l=u*a[1]),c=t.rendNode,t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)&&(c.style.color=r,c.style.opacity=l)),t.visPropOld.strokecolor=h,t.visPropOld.strokeopacity=u)},drawImage:function(t){t.rendNode=new Image,t._src="",this.updateImage(t)},updateImage:function(t){var e=this.context,i=n.evaluate(t.visProp.fillopacity),s=n.bind((function(){t.imgIsLoaded=!0,t.size[0]<=0||t.size[1]<=0||(e.save(),e.globalAlpha=i,this.transformImage(t,t.transformations),e.drawImage(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),e.restore())}),this);this.updateImageURL(t)?t.rendNode.onload=s:t.imgIsLoaded&&s()},transformImage:function(t,e){var i,s=this.context;e.length>0&&(i=this.joinTransforms(t,e),Math.abs(h.det(i))>=l.eps&&s.transform(i[1][1],i[2][1],i[1][2],i[2][2],i[1][0],i[2][0]))},updateImageURL:function(t){var e;return e=n.evaluate(t.url),t._src!==e&&(t.imgIsLoaded=!1,t.rendNode.src=e,t._src=e,!0)},remove:function(t){n.exists(t)&&n.exists(t.parentNode)&&t.parentNode.removeChild(t)},makeArrows:function(t,e,s){var r,o,a,l,c,h,u,d,p=n.evaluate(t.visProp.strokewidth),f=this.context,m=n.evaluate(t.visProp.firstarrow),g=n.evaluate(t.visProp.lastarrow);if("none"!==n.evaluate(t.visProp.strokecolor)&&(m||g)){if(t.elementClass!==i.OBJECT_CLASS_LINE)return r=t.points[0].scrCoords[1],o=t.points[0].scrCoords[2],a=t.points[t.points.length-1].scrCoords[1],void(l=t.points[t.points.length-1].scrCoords[2]);r=e.scrCoords[1],o=e.scrCoords[2],a=s.scrCoords[1],l=s.scrCoords[2],m&&n.exists(m.type)&&(p*=n.exists(m.size)?n.evaluate(m.size):3,u=2===(d=n.evaluate(m.type))?[[p,.5*-p],[0,0],[p,.5*p],[.5*p,0]]:3===d?[[p/3,.5*-p],[0,.5*-p],[0,.5*p],[p/3,.5*p]]:[[p,.5*-p],[0,0],[p,.5*p]]),g&&n.exists(g.type)&&(p*=n.exists(g.size)?n.evaluate(g.size):3,h=2===(d=n.evaluate(g.type))?[[-p,.5*-p],[0,0],[-p,.5*p],[.5*-p,0]]:3===d?[[-p/3,.5*-p],[0,.5*-p],[0,.5*p],[-p/3,.5*p]]:[[-p,.5*-p],[0,0],[-p,.5*p]]),f.save(),this._setColor(t,"stroke","fill")&&(c=Math.atan2(l-o,a-r),g&&this._drawFilledPolygon(this._translateShape(this._rotateShape(h,c),a,l)),m&&this._drawFilledPolygon(this._translateShape(this._rotateShape(u,c),r,o))),f.restore()}},updatePathStringPrim:function(t){var e,i,s,n,r,o="M",a=this.context;if(!(t.numberPoints<=0)){if(r=Math.min(t.points.length,t.numberPoints),a.beginPath(),1===t.bezierDegree)for(e=0;e<r;e++)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o="M":(i[1]>5e3?i[1]=5e3:i[1]<-5e3&&(i[1]=-5e3),i[2]>5e3?i[2]=5e3:i[2]<-5e3&&(i[2]=-5e3),"M"===o?a.moveTo(i[1],i[2]):a.lineTo(i[1],i[2]),o="L");else if(3===t.bezierDegree)for(e=0;e<r;)i=t.points[e].scrCoords,isNaN(i[1])||isNaN(i[2])?o="M":("M"===o?a.moveTo(i[1],i[2]):a.bezierCurveTo(i[1],i[2],(s=t.points[e+=1].scrCoords)[1],s[2],(n=t.points[e+=1].scrCoords)[1],n[2]),o="C"),e+=1;a.lineCap="round",this._fill(t),this._stroke(t)}},updatePathStringBezierPrim:function(t){var e,i,s,r,o,a,l,c="M",u=n.evaluate(t.visProp.strokewidth),d="plot"!==n.evaluate(t.visProp.curvetype),p=this.context;if(!(t.numberPoints<=0)){for(d&&t.board.options.curve.RDPsmoothing&&(t.points=h.RamerDouglasPeucker(t.points,.5)),l=Math.min(t.points.length,t.numberPoints),p.beginPath(),i=1;i<3;i++)for(c="M",e=0;e<l;e++)r=t.points[e].scrCoords,isNaN(r[1])||isNaN(r[2])?c="M":(r[1]>5e3?r[1]=5e3:r[1]<-5e3&&(r[1]=-5e3),r[2]>5e3?r[2]=5e3:r[2]<-5e3&&(r[2]=-5e3),"M"===c?p.moveTo(r[1],r[2]):p.bezierCurveTo(o+.333*(r[1]-o)+u*((s=2*i)*Math.random()-i),a+.333*(r[2]-a)+u*(s*Math.random()-i),o+.666*(r[1]-o)+u*(s*Math.random()-i),a+.666*(r[2]-a)+u*(s*Math.random()-i),r[1],r[2]),c="C",o=r[1],a=r[2]);p.lineCap="round",this._fill(t),this._stroke(t)}},updatePolygonPrim:function(t,e){var i,s,n,r=e.vertices.length,o=this.context,a=!0;if(!(r<=0)&&e.visPropCalc.visible){for(o.beginPath(),s=0;!e.vertices[s].isReal&&s<r-1;)s++,a=!1;for(o.moveTo((i=e.vertices[s].coords.scrCoords)[1],i[2]),n=s;n<r-1;n++)e.vertices[n].isReal||(a=!1),o.lineTo((i=e.vertices[n].coords.scrCoords)[1],i[2]);o.closePath(),a&&this._fill(e)}},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(e){t.deprecated("Board.renderer.show()","Board.renderer.display()"),n.exists(e.rendNode)&&(e.rendNode.style.visibility="inherit")},hide:function(e){t.deprecated("Board.renderer.hide()","Board.renderer.display()"),n.exists(e.rendNode)&&(e.rendNode.style.visibility="hidden")},setGradient:function(t){var e;e=(e=n.evaluate(t.visProp.fillopacity))>0?e:0,n.evaluate(t.visProp.fillcolor)},setShadow:function(t){t.visPropOld.shadow!==t.visProp.shadow&&(t.visPropOld.shadow=t.visProp.shadow)},highlight:function(t){return t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?this.updateTextStyle(t,!0):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},noHighlight:function(t){return t.elementClass===i.OBJECT_CLASS_TEXT&&"html"===n.evaluate(t.visProp.display)?this.updateTextStyle(t,!1):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(e){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),e&&e.attr.showcopyright&&this.displayCopyright(t.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(t,e){this.container?(this.canvasRoot.style.width=parseFloat(t)+"px",this.canvasRoot.style.height=parseFloat(e)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(t)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(e)+"px")):(this.canvasRoot.width=2*parseFloat(t),this.canvasRoot.height=2*parseFloat(e)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),t.CanvasRenderer})),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],(function(t,e,i,s,n,r,o,a,l,c){"use strict";return t.JSXGraph={rendererType:(r.board.renderer="no",e.supportsVML()&&(r.board.renderer="vml",document.onmousemove=function(){var t;return document.body&&(t=document.body.scrollLeft,t+=document.body.scrollTop),t}),e.supportsCanvas()&&(r.board.renderer="canvas"),e.supportsSVG()&&(r.board.renderer="svg"),e.isNode()&&e.supportsCanvas()&&(r.board.renderer="canvas"),(e.isNode()||"no"===r.renderer)&&(r.text.display="internal",r.infobox.display="internal"),r.board.renderer),initRenderer:function(t,e,s,n){var r;if(i.exists(s)&&!1!==s||"object"!=typeof document||(s=document),"object"==typeof s&&null!==t)for(r=s.getElementById(t);r.firstChild;)r.removeChild(r.firstChild);else r=t;return void 0!==n&&"auto"!==n||(n=this.rendererType),"svg"===n?new o(r,e):"vml"===n?new a(r):"canvas"===n?new l(r,e):new c},initBoard:function(n,o){var a,l,c,h,u,d,p,f,m,g,b,y,v,x;return(g=i.copyAttributes(o=o||{},r,"board")).zoom=i.copyAttributes(g,r,"board","zoom"),g.pan=i.copyAttributes(g,r,"board","pan"),g.selection=i.copyAttributes(g,r,"board","selection"),g.navbar=i.copyAttributes(g.navbar,r,"navbar"),f=e.getDimensions(n,g.document),g.unitx||g.unity?(a=i.def(g.originx,150),l=i.def(g.originy,150),c=i.def(g.unitx,50),h=i.def(g.unity,50)):(m=g.boundingbox,d=parseInt(f.width,10),p=parseInt(f.height,10),i.exists(m)&&g.keepaspectratio?(c=d/(m[2]-m[0]),h=p/(m[1]-m[3]),Math.abs(c)<Math.abs(h)?h=Math.abs(c)*h/Math.abs(h):c=Math.abs(h)*c/Math.abs(c)):(c=d/(m[2]-m[0]),h=p/(m[1]-m[3])),a=-c*m[0],l=h*m[1]),u=this.initRenderer(n,f,g.document,g.renderer),x=new s(n,u,g.id,[a,l],g.zoomfactor*g.zoomx,g.zoomfactor*g.zoomy,c,h,f.width,f.height,g),t.boards[x.id]=x,x.keepaspectratio=g.keepaspectratio,x.resizeContainer(f.width,f.height,!0,!0),x.suspendUpdate(),x.initInfobox(),g.axis&&(y=i.deepCopy(r.board.defaultAxes.x,b="object"==typeof g.axis?g.axis:{}),v=i.deepCopy(r.board.defaultAxes.y,b),g.defaultaxes.x&&(y=i.deepCopy(y,g.defaultaxes.x)),g.defaultaxes.y&&(v=i.deepCopy(v,g.defaultaxes.y)),x.defaultAxes={},x.defaultAxes.x=x.create("axis",[[0,0],[1,0]],y),x.defaultAxes.y=x.create("axis",[[0,0],[0,1]],v)),g.grid&&x.create("grid",[],"object"==typeof g.grid?g.grid:{}),x._createSelectionPolygon(g),x.renderer.drawZoomBar(x,g.navbar),x.unsuspendUpdate(),x},loadBoardFromFile:function(o,a,l,c,h){var u,d,p,f,m;return(u=i.copyAttributes(c=c||{},r,"board")).zoom=i.copyAttributes(c,r,"board","zoom"),u.pan=i.copyAttributes(c,r,"board","pan"),u.selection=i.copyAttributes(u,r,"board","selection"),u.navbar=i.copyAttributes(u.navbar,r,"navbar"),f=e.getDimensions(o,u.document),d=this.initRenderer(o,f,u.document,u.renderer),(p=new s(o,d,"",[150,150],1,1,50,50,f.width,f.height,u)).initInfobox(),p.resizeContainer(f.width,f.height,!0,!0),n.parseFileContent(a,p,l,!0,h),m=i.copyAttributes(u,r,"board","selection"),p.selectionPolygon=p.create("polygon",[[0,0],[0,0],[0,0],[0,0]],m),p.renderer.drawZoomBar(p,u.navbar),t.boards[p.id]=p,p},loadBoardFromString:function(o,a,l,c,h){var u,d,p,f,m;return(u=i.copyAttributes(c=c||{},r,"board")).zoom=i.copyAttributes(c,r,"board","zoom"),u.pan=i.copyAttributes(c,r,"board","pan"),u.selection=i.copyAttributes(u,r,"board","selection"),u.navbar=i.copyAttributes(u.navbar,r,"navbar"),p=e.getDimensions(o,u.document),d=this.initRenderer(o,p,u.document),(f=new s(o,d,"",[150,150],1,1,50,50,p.width,p.height,u)).initInfobox(),f.resizeContainer(p.width,p.height,!0,!0),n.parseString(a,f,l,!0,h),m=i.copyAttributes(u,r,"board","selection"),f.selectionPolygon=f.create("polygon",[[0,0],[0,0],[0,0],[0,0]],m),f.renderer.drawZoomBar(f,u.navbar),t.boards[f.id]=f,f},freeBoard:function(e){var i;for(i in"string"==typeof e&&(e=t.boards[e]),e.removeEventHandlers(),e.suspendUpdate(),e.objects)e.objects.hasOwnProperty(i)&&e.objects[i].remove();for(;e.containerObj.firstChild;)e.containerObj.removeChild(e.containerObj.firstChild);for(i in e.objects)e.objects.hasOwnProperty(i)&&delete e.objects[i];delete e.renderer,e.jc.creator.clearCache(),delete e.jc,delete t.boards[e.id]},registerElement:function(e,i){t.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),t.registerElement(e,i)}},e.isBrowser&&"object"==typeof window&&"object"==typeof document&&e.addEvent(window,"load",(function(){var e,s,n,r,o,a,l,c,h,u,d,p,f=document.getElementsByTagName("script"),m=function(e,i,s){var n=t.JSXGraph.initBoard(o,{boundingbox:s,keepaspectratio:!0,grid:d,axis:u,showReload:!0});if(i.toLowerCase().indexOf("script")>-1)n.construct(e);else try{n.jc.parse(e)}catch(e){t.debug(e)}return n},g=function(e,i,s,n){return function(){var r;t.JSXGraph.freeBoard(e),(r=m(i,s,n)).reload=g(r,i,s,n)}};for(s=0;s<f.length;s++)if(e=f[s].getAttribute("type",!1),i.exists(e)&&("text/jessiescript"===e.toLowerCase()||"jessiescript"===e.toLowerCase()||"text/jessiecode"===e.toLowerCase()||"jessiecode"===e.toLowerCase())){if(l=f[s].getAttribute("width",!1)||"500px",c=f[s].getAttribute("height",!1)||"500px",h=f[s].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",o=f[s].getAttribute("container",!1),4!==(h=h.split(",")).length)h=[-5,5,5,-5];else for(n=0;n<h.length;n++)h[n]=parseFloat(h[n]);if(u=i.str2Bool(f[s].getAttribute("axis",!1)||"false"),d=i.str2Bool(f[s].getAttribute("grid",!1)||"false"),i.exists(o))r=document.getElementById(o);else{o="jessiescript_autgen_jxg_"+s,(r=document.createElement("div")).setAttribute("id",o),r.setAttribute("style","width:"+l+"; height:"+c+"; float:left"),r.setAttribute("class","jxgbox");try{document.body.insertBefore(r,f[s])}catch(t){"object"==typeof jQuery&&jQuery(r).insertBefore(f[s])}}document.getElementById(o)?(p=(p=f[s].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),f[s].innerHTML=p,(a=m(p,e,h)).reload=g(a,p,e,h)):t.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}}),window),t.JSXGraph})),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],(function(t,e,i,s,n){"use strict";return t.Group=function(t,i,s,r,o){var a,l,c,h;for(this.board=t,this.objects={},a=this.board.numObjects,this.board.numObjects+=1,this.id=""!==i&&n.exists(i)?i:this.board.id+"Group"+a,this.board.groups[this.id]=this,this.type=e.OBJECT_TYPE_POINT,this.elementClass=e.OBJECT_CLASS_POINT,this.name=""!==s&&n.exists(s)?s:"group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=o.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],l=n.isArray(r)?r:Array.prototype.slice.call(arguments,3),c=0;c<l.length;c++)h=this.board.select(l[c]),!n.evaluate(h.visProp.fixed)&&n.exists(h.coords)&&this.addPoint(h);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},t.extend(t.Group.prototype,{ungroup:function(){var t,e,i;for(t in this.objects)this.objects.hasOwnProperty(t)&&n.isArray((e=this.objects[t].point).groups)&&(i=n.indexOf(e.groups,this.id))>=0&&delete e.groups[i];return this.objects={},this},addParents:function(t){var e,i,s;for(i=(s=n.isArray(t)?t:arguments).length,e=0;e<i;++e)n.isId(this.board,s[e])?this.parents.push(s[e]):n.exists(s[e].id)&&this.parents.push(s[e].id);this.parents=n.uniqueArray(this.parents)},setParents:function(t){this.parents=[],this.addParents(t)},getParents:function(){return n.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(t){var e;""!==t&&n.exists(this.objects[t])&&(this.coords[(e=this.objects[t].point).id]={usrCoords:e.coords.usrCoords.slice(0)})},update:function(t){var e,r,o,a,l,c,h,u,d,p=null;if(!this.needsUpdate)return this;if("nothing"===(t=this._update_find_drag_type()).action)return this._updateCoordsCache(t.id),this;if(p=this.objects[t.id].point,"translation"===t.action)u=[p.coords.usrCoords[1]-this.coords[t.id].usrCoords[1],p.coords.usrCoords[2]-this.coords[t.id].usrCoords[2]];else if("rotation"===t.action||"scaling"===t.action){if(n.isPoint(this[r="rotation"===t.action?"rotationCenter":"scaleCenter"]))d=this[r].coords.usrCoords.slice(1);else if("centroid"===this[r])d=this._update_centroid_center();else if(n.isArray(this[r]))d=this[r];else{if(!n.isFunction(this[r]))return this;d=this[r]()}if("rotation"===t.action)h=s.rad(this.coords[t.id].usrCoords.slice(1),d,this.objects[t.id].point),(u=this.board.create("transform",[h,d[0],d[1]],{type:"rotate"})).update();else{if("scaling"!==t.action)return this;if(a=s.distance(this.coords[t.id].usrCoords.slice(1),d),Math.abs(a)<i.eps)return this;a=s.distance(p.coords.usrCoords.slice(1),d)/a,l=this.scaleDirections[t.id].indexOf("x")>=0?a:1,c=this.scaleDirections[t.id].indexOf("y")>=0?a:1,(u=this.board.create("transform",[1,0,0,d[0]*(1-l),l,0,d[1]*(1-c),0,c],{type:"generic"})).update()}}for(e in this._update_apply_transformation(t,u),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(e))for(o in this.objects[e].descendants)this.objects[e].descendants.hasOwnProperty(o)&&(this.objects[e].descendants.needsUpdate=this.objects[e].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(e in this.board.updateElements(t),this.objects)this.objects.hasOwnProperty(e)&&this._updateCoordsCache(e);return this},_update_find_drag_type:function(){var t,s,r,o="nothing",a=[];for(t in this.objects)this.objects.hasOwnProperty(t)&&(s=this.objects[t].point).coords.distance(e.COORDS_BY_USER,this.coords[t])>i.eps&&a.push(s.id);return 0===a.length?{action:o,id:"",changed:a}:(s=this.objects[r=a[0]].point,a.length>1?o="translation":n.isInArray(this.rotationPoints,s)&&n.exists(this.rotationCenter)?o="rotation":n.isInArray(this.scalePoints,s)&&n.exists(this.scaleCenter)?o="scaling":n.isInArray(this.translationPoints,s)&&(o="translation"),{action:o,id:r,changed:a})},_update_centroid_center:function(){var t,e,i;for(i in t=[0,0],e=0,this.coords)this.coords.hasOwnProperty(i)&&(t[0]+=this.coords[i].usrCoords[1],t[1]+=this.coords[i].usrCoords[2],++e);return e>0&&(t[0]/=e,t[1]/=e),t},_update_apply_transformation:function(t,s){var r,o;for(r in this.objects)this.objects.hasOwnProperty(r)&&(n.exists(this.board.objects[r])?(o=this.objects[r].point).id!==t.id?"translation"===t.action?n.isInArray(t.changed,o.id)||o.coords.setCoordinates(e.COORDS_BY_USER,[this.coords[r].usrCoords[1]+s[0],this.coords[r].usrCoords[2]+s[1]]):"rotation"!==t.action&&"scaling"!==t.action||s.applyOnce([o]):"rotation"!==t.action&&"scaling"!==t.action||o.coords.setCoordinates(e.COORDS_BY_USER,i.matVecMult(s.matrix,this.coords[o.id].usrCoords)):delete this.objects[r])},addPoint:function(t){return this.objects[t.id]={point:this.board.select(t)},this._updateCoordsCache(t.id),this.translationPoints.push(t),t.groups.push(this.id),t.groups=n.uniqueArray(t.groups),this},addPoints:function(t){var e;for(e=0;e<t.length;e++)this.addPoint(t[e]);return this},addGroup:function(t){var e;for(e in t.objects)t.objects.hasOwnProperty(e)&&this.addPoint(t.objects[e].point);return this},removePoint:function(t){return delete this.objects[t.id],this},setRotationCenter:function(t){return this.rotationCenter=t,this},setRotationPoints:function(t){return this._setActionPoints("rotation",t)},addRotationPoint:function(t){return this._addActionPoint("rotation",t)},removeRotationPoint:function(t){return this._removeActionPoint("rotation",t)},setTranslationPoints:function(t){return this._setActionPoints("translation",t)},addTranslationPoint:function(t){return this._addActionPoint("translation",t)},removeTranslationPoint:function(t){return this._removeActionPoint("translation",t)},setScaleCenter:function(t){return this.scaleCenter=t,this},setScalePoints:function(t,e){var i,s,r;for(r=(i=n.isArray(t)?t:arguments).length,s=0;s<r;++s)this.scaleDirections[this.board.select(i[s]).id]=e||"xy";return this._setActionPoints("scale",t)},addScalePoint:function(t,e){return this._addActionPoint("scale",t),this.scaleDirections[this.board.select(t).id]=e||"xy",this},removeScalePoint:function(t){return this._removeActionPoint("scale",t)},_setActionPoints:function(t,e){var i,s,r;for(r=(i=n.isArray(e)?e:arguments).length,this[t+"Points"]=[],s=0;s<r;++s)this._addActionPoint(t,i[s]);return this},_addActionPoint:function(t,e){return this[t+"Points"].push(this.board.select(e)),this},_removeActionPoint:function(t,e){var i=this[t+"Points"].indexOf(this.board.select(e));return i>-1&&this[t+"Points"].splice(i,1),this},setProperty:function(){t.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var t;for(t in this.objects)this.objects.hasOwnProperty(t)&&this.objects[t].point.setAttribute.apply(this.objects[t].point,arguments);return this}}),t.createGroup=function(e,i,s){var r=n.copyAttributes(s,e.options,"group"),o=new t.Group(e,r.id,r.name,i,r);return o.elType="group",o.setParents(i),o},t.registerElement("group",t.createGroup),{Group:t.Group,createGroup:t.createGroup}})),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],(function(t,e,i,s,n){"use strict";return t.createLocus=function(t,s,n){var r,o;if(!i.isArray(s)||1!==s.length||!i.isPoint(s[0]))throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return o=s[0],(r=t.create("curve",[[null],[null]],n)).dontCallServer=!1,r.elType="locus",r.setParents([o.id]),r.updateDataArray=function(){var i,s,n;r.board.mode>0||(i=e.generatePolynomials(t,o,!0).join("|"))!==r.spe&&(r.spe=i,(s=function(t,e,i,s){r.dataX=t,r.dataY=e,r.eq=i,r.ctime=s,r.generatePolynomial=function(t){return function(e){var i,s="("+e.symbolic.x+")",n="("+e.symbolic.y+")",r=[];for(i=0;i<t.length;i++)r[i]=t[i].replace(/\*\*/g,"^").replace(/x/g,s).replace(/y/g,n);return r}}(i)})((n=e.geometricLocusByGroebnerBase(t,o,s)).datax,n.datay,n.polynomial,n.exectime))},r},t.registerElement("locus",t.createLocus),{createLocus:t.createLocus}})),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Image=function(i,s,n,r,a){this.constructor(i,n,e.OBJECT_TYPE_IMAGE,e.OBJECT_CLASS_OTHER),this.element=this.board.select(n.anchor),this.coordsConstructor(s),this.W=o.createFunction(a[0],this.board,""),this.H=o.createFunction(a[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*i.unitX),Math.abs(this.usrSize[1]*i.unitY)],this.url=r,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=t.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},t.Image.prototype=new s,o.copyPrototypeMethods(t.Image,a,"coordsConstructor"),t.extend(t.Image.prototype,{hasPoint:function(t,s){var r,o,a,l,c,h,u;return 0===this.transformations.length?(o=this.coords.scrCoords[2]-s,(r=t-this.coords.scrCoords[1])>=-(a=this.board.options.precision.hasPoint)&&r-this.size[0]<=a&&o>=-a&&o-this.size[1]<=a):(l=new i(e.COORDS_BY_SCREEN,[t,s],this.board),0<=(h=(u=n.innerProduct)(c=[(l=l.usrCoords)[0]-this.span[0][0],l[1]-this.span[0][1],l[2]-this.span[0][2]],this.span[1]))&&h<=u(this.span[1],this.span[1])&&0<=(h=u(c,this.span[2]))&&h<=u(this.span[2],this.span[2]))},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var t,e,i=this.transformations.length,s=[];if(0===i)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],t=0;t<i;t++)for(e=0;e<3;e++)s[e]=n.matVecMult(this.transformations[t].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(t){var e;if(o.isArray(t))for(e=0;e<t.length;e++)this.transformations.push(t[e]);else this.transformations.push(t);return this},getParents:function(){var t=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return 0!==this.parents.length&&(t=this.parents),t},setSize:function(t,e){return this.W=o.createFunction(t,this.board,""),this.H=o.createFunction(e,this.board,""),this},W:function(){},H:function(){}}),t.createImage=function(e,i,s){var n,r,l=i[0],c=i[1],h=i[2];if(n=o.copyAttributes(s,e.options,"image"),!(r=a.create(t.Image,e,c,n,l,h)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==o.evaluate(n.rotate)&&r.addRotation(o.evaluate(n.rotate)),r},t.registerElement("image",t.createImage),{Image:t.Image,createImage:t.createImage}})),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Ticks=function(t,i,n){if(this.constructor(t.board,n,s.OBJECT_TYPE_TICKS,s.OBJECT_CLASS_OTHER),this.line=t,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],o.isFunction(i))throw this.ticksFunction=i,new Error("Function arguments are no longer supported.");o.isArray(i)?this.fixedTicks=i:((Math.abs(i)<e.eps||i<0)&&(i=n.defaultdistance),this.ticksFunction=this.makeTicksFunction(i),this.equidistant=!0),this.minTicksDistance=n.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},t.Ticks.prototype=new n,t.extend(t.Ticks.prototype,{makeTicksFunction:function(t){return function(){var e,i,s;return o.evaluate(this.visProp.insertticks)?((s=(i=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-i.lower)<=6*(e=Math.pow(10,Math.floor(Math.log(.6*s)/Math.LN10)))&&(e*=.5),e):t}},hasPoint:function(t,i){var n,r,a=this.ticks&&this.ticks.length||0,l=this.board.options.precision.hasPoint+.5*o.evaluate(this.visProp.strokewidth);if(!o.evaluate(this.line.visProp.scalable))return!1;if(0!==this.line.stdform[1]&&0!==this.line.stdform[2]&&this.line.type!==s.OBJECT_TYPE_AXIS)return!1;for(n=0;n<a;n++)if((r=this.ticks[n])[2]&&!(0===this.line.stdform[1]&&Math.abs(r[0][0]-this.line.point1.coords.scrCoords[1])<e.eps||0===this.line.stdform[2]&&Math.abs(r[1][0]-this.line.point1.coords.scrCoords[2])<e.eps)&&(Math.abs(r[0][0]-r[0][1])>=1||Math.abs(r[1][0]-r[1][1])>=1))if(0===this.line.stdform[1]){if(Math.abs(i-.5*(r[1][0]+r[1][1]))<2*l&&r[0][0]-l<t&&t<r[0][1]+l)return!0}else if(0===this.line.stdform[2]&&Math.abs(t-.5*(r[0][0]+r[0][1]))<2*l&&r[1][0]-l<i&&i<r[1][1]+l)return!0;return!1},setPositionDirectly:function(t,i,s){var n,a,l=new r(t,i,this.board),c=new r(t,s,this.board),h=this.board.getBoundingBox();return o.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<e.eps&&Math.abs(l.usrCoords[1]*c.usrCoords[1])>e.eps?(h[0]*=n=c.usrCoords[1]/l.usrCoords[1],h[2]*=n,this.board.setBoundingBox(h,!1)):Math.abs(this.line.stdform[2])<e.eps&&Math.abs(l.usrCoords[2]*c.usrCoords[2])>e.eps&&(h[3]*=a=c.usrCoords[2]/l.usrCoords[2],h[1]*=a,this.board.setBoundingBox(h,!1)),this):this},calculateTicksCoordinates:function(){var t,i;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<e.eps&&Math.abs(this.dy)<e.eps))return t=this.getZeroCoordinates(),i=this.getLowerAndUpperBounds(t),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(t,i):this.generateFixedTicks(t,i),this},setTicksSizeVariables:function(){var t,e=.5*o.evaluate(this.visProp.majorheight),i=.5*o.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,t=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=e/t*this.board.unitX,this.dyMaj*=e/t*this.board.unitY,this.dxMin*=i/t*this.board.unitX,this.dyMin*=i/t*this.board.unitY,this.minStyle=o.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=o.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var t,e,n,a,l,c,h=o.evaluate(this.visProp.anchor);return this.line.type===s.OBJECT_TYPE_AXIS?i.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(n=this.line.point1.coords.usrCoords[0],t=this.line.point1.coords.usrCoords[1],e=this.line.point1.coords.usrCoords[2],c=this.line.point2.coords.usrCoords[0],a=this.line.point2.coords.usrCoords[1],l=this.line.point2.coords.usrCoords[2],"right"===h?this.line.point2.coords:"middle"===h?new r(s.COORDS_BY_USER,[.5*(n+c),.5*(t+a),.5*(e+l)],this.board):o.isNumber(h)?new r(s.COORDS_BY_USER,[n+(c-n)*h,t+(a-t)*h,e+(l-e)*h],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(t,n){var a,l,c,h,u,d=new r(s.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),p=new r(s.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),f=Math.abs(d.usrCoords[0])>=e.eps&&d.scrCoords[1]>=0&&d.scrCoords[1]<=this.board.canvasWidth&&d.scrCoords[2]>=0&&d.scrCoords[2]<=this.board.canvasHeight,m=Math.abs(p.usrCoords[0])>=e.eps&&p.scrCoords[1]>=0&&p.scrCoords[1]<=this.board.canvasWidth&&p.scrCoords[2]>=0&&p.scrCoords[2]<=this.board.canvasHeight,g=o.evaluate(this.line.visProp.straightfirst),b=o.evaluate(this.line.visProp.straightlast),y=o.evaluate(this.visProp.includeboundaries);return o.exists(n)||"tickdistance"===n?i.calcStraight(this.line,d,p,o.evaluate(this.line.visProp.margin)):i.calcLineDelimitingPoints(this.line,d,p),u=this.board.renderer.getPositionArrowHead(this.line,d,p,o.evaluate(this.line.visProp.strokewidth)),d.setCoordinates(s.COORDS_BY_SCREEN,[d.scrCoords[1]-u.d1x,d.scrCoords[2]-u.d1y]),p.setCoordinates(s.COORDS_BY_SCREEN,[p.scrCoords[1]-u.d2x,p.scrCoords[2]-u.d2y]),(c=this.getDistanceFromZero(t,d))<(h=this.getDistanceFromZero(t,p))?(a=c,g||!f||y||(a+=e.eps),l=h,b||!m||y||(l-=e.eps)):h<c?(a=h,b||!m||y||(a+=e.eps),l=c,g||!f||y||(l-=e.eps)):(a=0,l=0),{lower:a,upper:l}},getDistanceFromZero:function(t,n){var r=e.eps,a=t.distance(s.COORDS_BY_USER,n);return this.line.type===s.OBJECT_TYPE_AXIS?(e.relDif(t.usrCoords[1],n.usrCoords[1])>r&&t.usrCoords[1]-n.usrCoords[1]>r||e.relDif(t.usrCoords[2],n.usrCoords[2])>r&&t.usrCoords[2]-n.usrCoords[2]>r)&&(a*=-1):"right"===o.evaluate(this.visProp.anchor)?i.isSameDirection(t,this.line.point1.coords,n)&&(a*=-1):i.isSameDirection(t,this.line.point2.coords,n)||(a*=-1),a},generateEquidistantTicks:function(t,i){var s,n=this.getXandYdeltas(),r=this.equidistant?this.ticksFunction(1):this.ticksDelta,a=o.evaluate(this.visProp.insertticks),l=o.evaluate(this.visProp.minorticks);if(r*=o.evaluate(this.visProp.scale),a&&this.minTicksDistance>e.eps?(r=this.adjustTickDistance(r,t,n),r/=l+1):a||(r/=l+1),this.ticksDelta=r,!(r<e.eps)){for(s=0,o.evaluate(this.visProp.drawzero)||(s=r);s<=i.upper;)s>=i.lower&&this.processTickPosition(t,s,r,n),s+=r;for(s=-r;s>=i.lower;)s<=i.upper&&this.processTickPosition(t,s,r,n),s-=r}},adjustTickDistance:function(t,e,i){var n,a=1,l=o.evaluate(this.visProp.minorticks);for(this.getLowerAndUpperBounds(e,"ticksdistance"),n=e.distance(s.COORDS_BY_SCREEN,new r(s.COORDS_BY_USER,[e.usrCoords[1]+i.x*t,e.usrCoords[2]+i.y*t],this.board));n/(l+1)<this.minTicksDistance;)t*=1===a?2:5,a*=-1,n=e.distance(s.COORDS_BY_SCREEN,new r(s.COORDS_BY_USER,[e.usrCoords[1]+i.x*t,e.usrCoords[2]+i.y*t],this.board));return t},processTickPosition:function(t,e,i,n){var a,l;(a=new r(s.COORDS_BY_USER,[t.usrCoords[1]+e*n.x,t.usrCoords[2]+e*n.y],this.board)).major=Math.round(e/i)%(o.evaluate(this.visProp.minorticks)+1)==0,3===(l=this.tickEndings(a,a.major)).length&&(this.ticks.push(l),a.major&&o.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(a,t),a,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(t,e){var i,n,a,l,c=o.isArray(this.visProp.labels),h=this.getXandYdeltas(),u=o.evaluate(this.visProp.drawlabels);for(a=0;a<this.fixedTicks.length;a++)i=new r(s.COORDS_BY_USER,[t.usrCoords[1]+this.fixedTicks[a]*h.x,t.usrCoords[2]+this.fixedTicks[a]*h.y],this.board),3===(l=this.tickEndings(i,!0)).length&&this.fixedTicks[a]>=e.lower&&this.fixedTicks[a]<=e.upper&&(this.ticks.push(l),u&&(c||o.exists(this.visProp.labels[a]))?(n=c?o.evaluate(this.visProp.labels[a]):this.fixedTicks[a],this.labelsData.push(this.generateLabelData(this.generateLabelText(i,t,n),i,a))):this.labelsData.push(null))},getXandYdeltas:function(){var t,i,n=this.line.point1.Dist(this.line.point2);return this.line.type===s.OBJECT_TYPE_AXIS?((t=this.line.point1.coords.usrCoords)[1]>(i=this.line.point2.coords.usrCoords)[1]||Math.abs(t[1]-i[1])<e.eps&&t[2]>i[2])&&(t=this.line.point2.coords.usrCoords,i=this.line.point1.coords.usrCoords):(t=this.line.point1.coords.usrCoords,i=this.line.point2.coords.usrCoords),{x:(i[1]-t[1])/n,y:(i[2]-t[2])/n}},_isInsideCanvas:function(t,e,i){var s=this.board.canvasWidth,n=this.board.canvasHeight;return void 0===i&&(i=0),t[0]>=i&&t[0]<=s-i&&e[0]>=i&&e[0]<=n-i||t[1]>=i&&t[1]<=s-i&&e[1]>=i&&e[1]<=n-i},tickEndings:function(t,e){var s,n,r,a,l,c=[-2e6,-2e6],h=[-2e6,-2e6];return s=t.scrCoords,e?(r=this.dxMaj,a=this.dyMaj,l=this.majStyle):(r=this.dxMin,a=this.dyMin,l=this.minStyle),"infinite"===l?(n=i.meetLineBoard([-a*s[1]-r*s[2],a,r],this.board),c[0]=n[0].scrCoords[1],c[1]=n[1].scrCoords[1],h[0]=n[0].scrCoords[2],h[1]=n[1].scrCoords[2]):(c[0]=s[1]+r*o.evaluate(this.visProp.tickendings[0]),h[0]=s[2]-a*o.evaluate(this.visProp.tickendings[0]),c[1]=s[1]-r*o.evaluate(this.visProp.tickendings[1]),h[1]=s[2]+a*o.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(c,h)?[c,h,e]:[]},formatLabelText:function(t){var e=t.toString(),i=o.evaluate(this.visProp.scalesymbol);return o.isNumber(t)&&((e.length>o.evaluate(this.visProp.maxlabellength)||-1!==e.indexOf("e"))&&(e=t.toPrecision(o.evaluate(this.visProp.precision)).toString()),e.indexOf(".")>-1&&-1===e.indexOf("e")&&(e=(e=e.replace(/0+$/,"")).replace(/\.$/,""))),i.length>0&&("1"===e?e=i:"-1"===e?e="-"+i:"0"!==e&&(e+=i)),o.evaluate(this.visProp.useunicodeminus)&&(e=e.replace(/-/g,"â")),e},generateLabelText:function(t,i,s){var n,r=this.getDistanceFromZero(i,t);return Math.abs(r)<e.eps?n="0":(o.exists(s)||(s=r/o.evaluate(this.visProp.scale)),n=this.formatLabelText(s)),n},generateLabelData:function(t,e,i){var s,n,r,a;return r=void 0===(a=o.evaluate(this.visProp.label.fontsize))?12:a,this._isInsideCanvas(s=[e.scrCoords[1],e.scrCoords[1]],n=[e.scrCoords[2],e.scrCoords[2]],r*=1.5)?(s=o.evaluate(this.visProp.label.offset[0]),n=o.evaluate(this.visProp.label.offset[1]),{x:e.usrCoords[1]+s/this.board.unitX,y:e.usrCoords[2]+n/this.board.unitY,t:t,i:i}):null},update:function(){return this.needsUpdate&&0!==this.board.canvasWidth&&0!==this.board.canvasHeight&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var t,e,i,s,n,r,l,c;for(i=this.labelsData.length,s=this.labels.length,t=0,e=0;t<i;t++)null!==this.labelsData[t]&&(l=this.labelsData[t],e<s?((r=this.labels[e]).setText(l.t),r.setCoords(l.x,l.y),e++):(this.labelCounter+=1,(n=o.deepCopy(n={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},this.visProp.label)).id=this.id+l.i+"Label"+this.labelCounter,(r=a.createText(this.board,[l.x,l.y,l.t],n)).isDraggable=!1,r.dump=!1,this.labels.push(r)),"inherit"===(c=o.evaluate(this.visProp.label.visible))&&(c=this.visPropCalc.visible),r.prepareUpdate().updateVisibility(c).updateRenderer(),r.distanceX=o.evaluate(this.visProp.label.offset[0]),r.distanceY=o.evaluate(this.visProp.label.offset[1]));for(e=i=e;e<s;e++)this.board.renderer.display(this.labels[e],!1),this.labels[e].visProp.visible=!1;return this},hideElement:function(){var e;for(t.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),e=0;e<this.labels.length;e++)o.exists(this.labels[e])&&this.labels[e].hideElement();return this},showElement:function(){var e;for(t.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),e=0;e<this.labels.length;e++)o.exists(this.labels[e])&&this.labels[e].showElement();return this}}),t.createTicks=function(e,i,n){var r,a,l=o.copyAttributes(n,e.options,"ticks");if(a=i.length<2?l.ticksdistance:i[1],i[0].elementClass!==s.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof i[0]+"'.");return r=new t.Ticks(i[0],a,l),o.isFunction(l.generatelabelvalue)&&(r.generateLabelText=l.generatelabelvalue),o.isFunction(l.generatelabeltext)&&(r.generateLabelText=l.generatelabeltext),r.setParents(i[0]),r.isDraggable=!0,r.fullUpdate(i[0].visPropCalc.visible),r},t.createHatchmark=function(t,e,i){var n,r,a,l,c,h=[],u=o.copyAttributes(i,t.options,"hatch");if(e[0].elementClass!==s.OBJECT_CLASS_LINE||"number"!=typeof e[1])throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof e[0]+"' and '"+typeof e[1]+" and ''"+typeof e[2]+"'.");for(a=-((n=e[1])-1)*(l=u.ticksdistance)*.5,r=0;r<n;r++)h[r]=a+r*l;return(c=t.create("ticks",[e[0],h],u)).elType="hatch",c},t.registerElement("ticks",t.createTicks),t.registerElement("hash",t.createHatchmark),t.registerElement("hatch",t.createHatchmark),{Ticks:t.Ticks,createTicks:t.createTicks,createHashmark:t.createHatchmark,createHatchmark:t.createHatchmark}})),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],(function(t,e,i,s,n,r,o,a,l,c){"use strict";return t.createSlider=function(t,r,o){var a,l,c,h,u,d,p,f,m,g,b,y,v,x,C,_,w,S,P,k;return w=(P=s.copyAttributes(o,t.options,"slider")).withticks,_=P.withlabel,S=P.snapwidth,k=P.precision,P=s.copyAttributes(o,t.options,"slider","point1"),p=t.create("point",r[0],P),P=s.copyAttributes(o,t.options,"slider","point2"),f=t.create("point",r[1],P),P=s.copyAttributes(o,t.options,"slider","baseline"),(m=t.create("segment",[p,f],P)).updateStdform(),a=p.coords.usrCoords.slice(1),l=f.coords.usrCoords.slice(1),d=(u=r[2][2])-(c=r[2][0]),b=a[0]+(l[0]-a[0])*((h=r[2][1])-c)/(u-c),y=a[1]+(l[1]-a[1])*(h-c)/(u-c),(P=s.copyAttributes(o,t.options,"slider")).withLabel=!1,(v=t.create("glider",[b,y,m],P)).setAttribute({snapwidth:S}),P=s.copyAttributes(o,t.options,"slider","highline"),x=t.create("segment",[p,v],P),v.Value=function(){var t=this._smax-this._smin,e=s.evaluate(this.visProp.snapwidth);return-1===e?this.position*t+this._smin:Math.round((this.position*t+this._smin)/e)*e},v.methodMap=s.deepCopy(v.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),v._smax=u,v._smin=c,v.setMax=function(t){return this._smax=t,this},v.setValue=function(t){var i=this._smax-this._smin;return this.position=Math.abs(i)>e.eps?(t-this._smin)/i:0,this.position=Math.max(0,Math.min(1,this.position)),this},v.setMin=function(t){return this._smin=t,this},_&&(P=s.copyAttributes(o,t.options,"slider","label"),C=t.create("text",[function(){return.05*(f.X()-p.X())+f.X()},function(){return.05*(f.Y()-p.Y())+f.Y()},function(){var t,e=s.evaluate(v.visProp.suffixlabel),i=s.evaluate(v.visProp.unitlabel),n=s.evaluate(v.visProp.postlabel);return t=null!==e?e:v.name&&""!==v.name?v.name+" = ":"",t+=s.toFixed(v.Value(),k),null!==i&&(t+=i),null!==n&&(t+=n),t}],P),v.label=C,v.visProp.withlabel=!0,v.hasLabel=!0),v.point1=p,v.point2=f,v.baseline=m,v.highline=x,w&&(P=s.copyAttributes(o,t.options,"slider","ticks"),s.exists(P.generatelabeltext)||(P.generateLabelText=function(t,i,s){var n=v.point1.Dist(v.point2),r=v._smin,o=v._smax,a=this.getDistanceFromZero(i,t)*(o-r)/n+r;return n<e.eps||Math.abs(a)<e.eps?"0":this.formatLabelText(a)}),g=t.create("ticks",[v.baseline,v.point1.Dist(p)/2,function(t){var s=v.point1.Dist(v.point2),n=v.point1.coords.distance(i.COORDS_BY_USER,t);return s<e.eps?0:n/s*d+c}],P),v.ticks=g),v.remove=function(){_&&t.removeObject(C),t.removeObject(x),t.removeObject(m),t.removeObject(f),t.removeObject(p),n.Point.prototype.remove.call(v)},p.dump=!1,f.dump=!1,m.dump=!1,x.dump=!1,v.elType="slider",v.parents=r,v.subs={point1:p,point2:f,baseLine:m,highLine:x},v.inherits.push(p,f,m,x),w&&(g.dump=!1,v.subs.ticks=g,v.inherits.push(g)),v},t.registerElement("slider",t.createSlider),{createSlider:t.createSlider}})),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],(function(t,e,i,s,n,r){"use strict";return t.createTapemeasure=function(s,n,r){var o,a,l,c,h,u,d,p,f,m,g;return o=n[0],a=n[1],l=e.copyAttributes(r,s.options,"tapemeasure","point1"),p=s.create("point",o,l),l=e.copyAttributes(r,s.options,"tapemeasure","point2"),f=s.create("point",a,l),p.setAttribute({ignoredSnapToPoints:[f]}),f.setAttribute({ignoredSnapToPoints:[p]}),l=e.copyAttributes(r,s.options,"tapemeasure"),c=l.withticks,u=l.precision,(h=l.withlabel)&&(l.withlabel=!0),d=s.create("segment",[p,f],l),h&&(m=r.name&&""!==r.name?r.name+" = ":"",d.label.setText((function(){return m+e.toFixed(p.Dist(f),u)}))),c&&(l=e.copyAttributes(r,s.options,"tapemeasure","ticks"),g=s.create("ticks",[d,.1],l),d.inherits.push(g)),d.remove=function(){c&&d.removeTicks(g),s.removeObject(f),s.removeObject(p),i.prototype.remove.call(this)},d.Value=function(){return p.Dist(f)},p.dump=!1,f.dump=!1,d.elType="tapemeasure",d.getParents=function(){return[[p.X(),p.Y()],[f.X(),f.Y()]]},d.subs={point1:p,point2:f},c&&(g.dump=!1),d.methodMap=t.deepCopy(d.methodMap,{Value:"Value"}),d.prepareUpdate().update(),s.isSuspendedUpdate||(d.updateVisibility().updateRenderer(),d.point1.updateVisibility().updateRenderer(),d.point2.updateVisibility().updateRenderer()),d},t.registerElement("tapemeasure",t.createTapemeasure),{createTapemeasure:t.createTapemeasure}})),define("parser/datasource",["jxg","utils/type"],(function(t,e){"use strict";return t.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},t.extend(t.DataSource.prototype,{loadFromArray:function(t,i,s){var n,r,o;if(e.isArray(i)&&(this.columnHeaders=i,i=!1),e.isArray(s)&&(this.rowHeaders=s,s=!1),this.data=[],i&&(this.columnHeaders=[]),s&&(this.rowHeaders=[]),e.exists(t)){for(this.data=[],n=0;n<t.length;n++)for(this.data[n]=[],r=0;r<t[n].length;r++)o=t[n][r],this.data[n][r]=parseFloat(o).toString()===o?parseFloat(o):"-"!==o?o:NaN;if(i&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),s)for(this.rowHeaders=[],n=0;n<this.data.length;n++)this.rowHeaders.push(this.data[n][0]),this.data[n]=this.data[n].slice(1)}return this},loadFromTable:function(t,i,s){var n,r,o,a,l;if(e.isArray(i)&&(this.columnHeaders=i,i=!1),e.isArray(s)&&(this.rowHeaders=s,s=!1),this.data=[],i&&(this.columnHeaders=[]),s&&(this.rowHeaders=[]),t=document.getElementById(t),e.exists(t)){for(n=t.getElementsByTagName("tr"),this.data=[],r=0;r<n.length;r++)for(a=n[r].getElementsByTagName("td"),this.data[r]=[],o=0;o<a.length;o++)l=a[o].innerHTML,this.data[r][o]=parseFloat(l).toString()===l?parseFloat(l):"-"!==l?l:NaN;if(i&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),s)for(this.rowHeaders=[],r=0;r<this.data.length;r++)this.rowHeaders.push(this.data[r][0]),this.data[r]=this.data[r].slice(1)}return this},addColumn:function(t,e,i){throw new Error("not implemented")},addRow:function(t,e,i){throw new Error("not implemented")},getColumn:function(t){var i,s=[];if(e.isString(t))for(i=0;i<this.columnHeaders.length;i++)if(t===this.columnHeaders[i]){t=i;break}for(i=0;i<this.data.length;i++)this.data[i].length>t&&(s[i]=parseFloat(this.data[i][t]));return s},getRow:function(t){var i,s;if(e.isString(t))for(s=0;s<this.rowHeaders.length;s++)if(t===this.rowHeaders[s]){t=s;break}for(i=[],s=0;s<this.data[t].length;s++)i[s]=this.data[t][s];return i}}),t.DataSource})),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],(function(t,e,i,s,n,r,o,a,l,c,h,u,d,p,f,m,g,b){"use strict";return t.Chart=function(t,e,i){var s,n,r,o,a,c;if(this.constructor(t,i),!l.isArray(e)||0===e.length)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],l.isNumber(e[0]))for(n=e,s=[],r=0;r<n.length;r++)s[r]=r+1;else if(1===e.length&&l.isArray(e[0]))for(s=[],c=l.evaluate(n=e[0]).length,r=0;r<c;r++)s[r]=r+1;else 2===e.length&&(c=Math.min(e[0].length,e[1].length),s=e[0].slice(0,c),n=e[1].slice(0,c));if(l.isArray(n)&&0===n.length)throw new Error("JSXGraph: Can't create charts without data.");for(a=i.chartstyle.replace(/ /g,"").split(","),r=0;r<a.length;r++){switch(a[r]){case"bar":o=this.drawBar(t,s,n,i);break;case"line":o=this.drawLine(t,s,n,i);break;case"fit":o=this.drawFit(t,s,n,i);break;case"spline":o=this.drawSpline(t,s,n,i);break;case"pie":o=this.drawPie(t,n,i);break;case"point":o=this.drawPoints(t,s,n,i);break;case"radar":o=this.drawRadar(t,e,i)}this.elements.push(o)}return this.id=this.board.setId(this,"Chart"),this.elements},t.Chart.prototype=new r,t.extend(t.Chart.prototype,{drawLine:function(t,e,i,s){return s.fillcolor="none",s.highlightfillcolor="none",t.create("curve",[e,i],s)},drawSpline:function(t,e,i,s){return s.fillColor="none",s.highlightfillcolor="none",t.create("spline",[e,i],s)},drawFit:function(t,i,s,n){var r=n.degree;return r=Math.max(parseInt(r,10),1)||1,n.fillcolor="none",n.highlightfillcolor="none",t.create("functiongraph",[e.regressionPolynomial(r,i,s)],n)},drawBar:function(t,e,i,s){var n,r,o,a,c,h,u,d,p,f,m=[],g=[],b=function(t,i){return function(){return e[t]()-i*o}},y={fixed:!0,withLabel:!1,visible:!1,name:""};if((p=l.copyAttributes(s,t.options,"chart"))&&p.width)o=p.width;else{if(e.length<=1)o=1;else for(o=e[1]-e[0],n=1;n<e.length-1;n++)o=e[n+1]-e[n]<o?e[n+1]-e[n]:o;o*=.8}for(f=l.copyAttributes(s,t.options,"chart","label"),n=0;n<e.length;n++)l.isFunction(e[n])?(a=b(n,-.5),c=b(n,0),h=b(n,.5)):(a=e[n]-.5*o,c=e[n],h=e[n]+.5*o),l.isFunction(i[n])&&i[n](),u=i[n],"horizontal"===p.dir?(g[0]=t.create("point",[0,a],y),g[1]=t.create("point",[u,a],y),g[2]=t.create("point",[u,h],y),g[3]=t.create("point",[0,h],y),l.exists(p.labels)&&l.exists(p.labels[n])&&(f.anchorY="middle",(r=t.create("text",[u,c,p.labels[n]],f)).visProp.anchorx=function(t){return function(){return t.X()>=0?"left":"right"}}(r))):(g[0]=t.create("point",[a,0],y),g[1]=t.create("point",[a,u],y),g[2]=t.create("point",[h,u],y),g[3]=t.create("point",[h,0],y),l.exists(p.labels)&&l.exists(p.labels[n])&&(f.anchorX="middle",(r=t.create("text",[c,u,p.labels[n]],f)).visProp.anchory=function(t){return function(){return t.Y()>=0?"bottom":"top"}}(r))),l.isArray(p.colors)&&(p.fillcolor=(d=p.colors)[n%d.length]),m[n]=t.create("polygon",g,p),l.exists(p.labels)&&l.exists(p.labels[n])&&(m[n].text=r);return m},drawPoints:function(t,e,i,s){var n,r=[],o=s.infoboxarray;for(s.fixed=!0,s.name="",n=0;n<e.length;n++)s.infoboxtext=!!o&&o[n%o.length],r[n]=t.create("point",[e[n],i[n]],s);return r},drawPie:function(t,e,r){var o,a,c=[],h=[],u=(i.sum(e),r.colors),d=r.highlightcolors,p=r.labels,f=r.radius||4,m=f,g=r.center||[0,0],b=g[0],y=g[1],v=function(t,i,s){return function(){var n,r,o,a=0;for(r=0;r<=t;r++)a+=parseFloat(l.evaluate(e[r]));for(n=a,r=t+1;r<e.length;r++)n+=parseFloat(l.evaluate(e[r]));return o=0!==n?2*Math.PI*a/n:0,m()*Math[i](o)+s}},x=function(t,e){var i=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],r=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];l.exists(this.label)&&(this.label.rendNode.style.fontSize=e*l.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new n(s.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+i*t,this.point1.coords.usrCoords[2]+r*t],this.board),this.fullUpdate()},C=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),x.call(this,1.1,2))},_=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),x.call(this,.9090909,1))},w={fixed:!0,withLabel:!1,visible:!1,name:""};if(!l.isArray(p))for(p=[],o=0;o<e.length;o++)p[o]="";for(l.isFunction(f)||(m=function(){return f}),r.highlightonsector=r.highlightonsector||!1,r.straightfirst=!1,r.straightlast=!1,a=t.create("point",[b,y],w),c[0]=t.create("point",[function(){return m()+b},function(){return y}],w),o=0;o<e.length;o++)c[o+1]=t.create("point",[v(o,"cos",b),v(o,"sin",y)],w),r.name=p[o],r.withlabel=""!==r.name,r.fillcolor=u&&u[o%u.length],r.labelcolor=u&&u[o%u.length],r.highlightfillcolor=d&&d[o%d.length],h[o]=t.create("sector",[a,c[o],c[o+1]],r),r.highlightonsector&&(h[o].hasPoint=h[o].hasPointSector),r.highlightbysize&&(h[o].highlight=C,h[o].noHighlight=_);return{sectors:h,points:c,midpoint:a}},drawRadar:function(e,i,r){var o,a,c,h,u,d,p,f,m,g,b,y,v,x,C,_,w,S,P,k,E,T,A,O,M,N,L,D,j,R,I,B,F,Y,z,q,X,U,G,H=i.length,J=function(){var t,e,i,r,o=l.evaluate(this.visProp.label.offset).slice(0);return t=this.point1.X(),e=this.point2.X(),i=this.point1.Y(),r=this.point2.Y(),e<t&&(o[0]=-o[0]),r<i&&(o[1]=-o[1]),this.setLabelRelativeCoords(o),new n(s.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},$=function(t,i){var s,n,r;return s=e.create("transform",[-(C[i]-v[i]),0],{type:"translate"}),n=e.create("transform",[P/(_[i]+x[i]-(C[i]-v[i])),1],{type:"scale"}),s.melt(n),r=e.create("transform",[t],{type:"rotate"}),s.melt(r),s};if(H<=0)t.debug("No data");else if(l.exists(c=r.paramarray))if((h=c.length)<=1)t.debug("Need more than 1 param");else{for(o=0;o<H;o++)if(h!==i[o].length)return void t.debug("Use data length equal to number of params ("+i[o].length+" != "+h+")");for(u=[],d=[],a=0;a<h;a++)u[a]=i[0][a],d[a]=u[a];for(o=1;o<H;o++)for(a=0;a<h;a++)i[o][a]>u[a]&&(u[a]=i[o][a]),i[o][a]<d[a]&&(d[a]=i[o][a]);for(p=[],f=[],o=0;o<H;o++)p[o]="",f[o]=[];for(m=[],g=[],b=r.startshiftratio||0,y=r.endshiftratio||0,o=0;o<h;o++)m[o]=(u[o]-d[o])*b,g[o]=(u[o]-d[o])*y;if(v=r.startshiftarray||m,x=r.endshiftarray||g,C=r.startarray||d,l.exists(r.start))for(o=0;o<h;o++)C[o]=r.start;if(_=r.endarray||u,l.exists(r.end))for(o=0;o<h;o++)_[o]=r.end;if(v.length===h)if(x.length===h)if(C.length===h){if(_.length===h){for(w=r.labelarray||p,S=r.colors,P=r.radius||10,G=r.strokewidth||1,l.exists(r.highlightonsector)||(r.highlightonsector=!1),k={name:r.name,id:r.id,strokewidth:G,polystrokewidth:r.polystrokewidth||G,strokecolor:r.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:r.fillColor||"#FFFF88",fillopacity:r.fillOpacity||.4,highlightfillcolor:r.highlightFillColor||"#FF7400",highlightstrokecolor:r.highlightStrokeColor||"black",gradient:r.gradient||"none"},O=e.create("point",[T=(E=r.center||[0,0])[0],A=E[1]],{name:"",fixed:!0,withlabel:!1,visible:!1}),Math,Math,N=M=r.startangle||0,L=[],D=[],o=0;o<h;o++)for(N+=2*Math.PI/h,R=P*Math.cos(N)+T,I=P*Math.sin(N)+A,L[o]=e.create("point",[R,I],{name:"",fixed:!0,withlabel:!1,visible:!1}),D[o]=e.create("line",[O,L[o]],{name:c[o],strokeColor:k.strokecolor,strokeWidth:k.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:k.highlightstrokecolor}),D[o].getLabelAnchor=J,j=$(N,o),a=0;a<i.length;a++)f[a][o]=e.create("point",[i[a][o],0],{name:"",fixed:!0,withlabel:!1,visible:!1}),f[a][o].addTransform(f[a][o],j);for(B=[],o=0;o<H;o++)for(k.labelcolor=S&&S[o%S.length],k.strokecolor=S&&S[o%S.length],k.fillcolor=S&&S[o%S.length],B[o]=e.create("polygon",f[o],{withLines:!0,withLabel:!1,fillColor:k.fillcolor,fillOpacity:k.fillopacity,highlightFillColor:k.highlightfillcolor}),a=0;a<h;a++)B[o].borders[a].setAttribute("strokecolor:"+S[o%S.length]),B[o].borders[a].setAttribute("strokewidth:"+k.polystrokewidth);switch(r.legendposition||"none"){case"right":this.legend=e.create("legend",[T+P+(r.legendleftoffset||2),A+P-(r.legendtopoffset||1)],{labels:w,colors:S});break;case"none":break;default:t.debug("Unknown legend position")}if(F=[],r.showcircles){for(Y=[],o=0;o<6;o++)Y[o]=20*o;if(Y[0]="0",(q=(z=r.circlelabelarray||Y).length)<2)return void t.debug("Too less circles");for(X=[],j=$(M+Math.PI/h,0),k.fillcolor="none",k.highlightfillcolor="none",k.strokecolor=r.strokecolor||"black",k.strokewidth=r.circlestrokewidth||.5,k.layer=0,U=(_[0]-C[0])/(q-1),o=0;o<q;o++)X[o]=e.create("point",[C[0]+o*U,0],{name:z[o],size:0,fixed:!0,withLabel:!0,visible:!0}),X[o].addTransform(X[o],j),F[o]=e.create("circle",[O,X[o]],k)}return this.rendNode=B[0].rendNode,{circles:F,lines:D,points:f,midpoint:O,polygons:B}}t.debug("Ends length is not equal to number of parameters")}else t.debug("Starts length is not equal to number of parameters");else t.debug("End shifts length is not equal to number of parameters");else t.debug("Start shifts length is not equal to number of parameters")}else t.debug("Need paramArray attribute")},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),t.createChart=function(e,i,s){var n,r,h,u,d,p,f,m,g,b,y,v,x,C,_,w,S=[],P=c.isBrowser?e.document.getElementById(i[0]):null;if(1===i.length&&l.isString(i[0])){if(l.exists(P)){if(g=l.copyAttributes(s,e.options,"chart"),n=(P=(new o).loadFromTable(i[0],g.withheaders,g.withheaders)).data,d=P.columnHeaders,r=P.rowHeaders,b=g.width,y=g.name,v=g.strokecolor,x=g.fillcolor,C=g.highlightstrokecolor,_=g.highlightfillcolor,e.suspendUpdate(),w=n.length,m=[],g.rows&&l.isArray(g.rows)){for(h=0;h<w;h++)for(u=0;u<g.rows.length;u++)if(g.rows[u]===h||g.withheaders&&g.rows[u]===r[h]){m.push(n[h]);break}}else m=n;for(w=m.length,h=0;h<w;h++){if(f=[],g.chartstyle&&-1!==g.chartstyle.indexOf("bar")){for(f.push(1-(p=b||.8)/2+(h+.5)*p/w),u=1;u<m[h].length;u++)f.push(f[u-1]+1);g.width=p/w}y&&y.length===w?g.name=y[h]:g.withheaders&&(g.name=d[h]),g.strokecolor=v&&v.length===w?v[h]:a.hsv2rgb((h+1)/w*360,.9,.6),g.fillcolor=x&&x.length===w?x[h]:a.hsv2rgb((h+1)/w*360,.9,1),g.highlightstrokecolor=C&&C.length===w?C[h]:a.hsv2rgb((h+1)/w*360,.9,1),g.highlightfillcolor=_&&_.length===w?_[h]:a.hsv2rgb((h+1)/w*360,.9,.6),g.chartstyle&&-1!==g.chartstyle.indexOf("bar")?S.push(new t.Chart(e,[f,m[h]],g)):S.push(new t.Chart(e,[m[h]],g))}e.unsuspendUpdate()}return S}return g=l.copyAttributes(s,e.options,"chart"),new t.Chart(e,i,g)},t.registerElement("chart",t.createChart),t.Legend=function(t,e,i){var r;if(this.constructor(),r=l.copyAttributes(i,t.options,"legend"),this.board=t,this.coords=new n(s.COORDS_BY_USER,e,this.board),this.myAtts={},this.label_array=r.labelarray||r.labels,this.color_array=r.colorarray||r.colors,this.lines=[],this.myAtts.strokewidth=r.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=r.legendstyle||r.style,"vertical"!==this.style)throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(t,r)},t.Legend.prototype=new r,t.Legend.prototype.drawVerticalLegend=function(t,e){var i,r=e.linelength||1,o=(e.rowheight||20)/this.board.unitY,a=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new n(s.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(i=0;i<this.label_array.length;i++)this.myAtts.strokecolor=this.color_array[i],this.myAtts.highlightstrokecolor=this.color_array[i],this.myAtts.name=this.label_array[i],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[i],strokeWidth:this.myAtts.strokewidth},this.lines[i]=t.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-i*o],[this.coords.usrCoords[1]+r,this.coords.usrCoords[2]-i*o]],this.myAtts),this.lines[i].getLabelAnchor=a},t.createLegend=function(e,i,s){var n=[0,0];return l.exists(i)&&2===i.length&&(n=i),new t.Legend(e,n,s)},t.registerElement("legend",t.createLegend),{Chart:t.Chart,Legend:t.Legend,createChart:t.createChart,createLegend:t.createLegend}})),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],(function(t,e,i,s,n,r,o,a){"use strict";return t.Turtle=function(t,i,n){var r,o,a;return this.constructor(t,n,e.OBJECT_TYPE_TURTLE,e.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=t,this.visProp.curveType="plot",this._attributes=s.copyAttributes(this.visProp,t.options,"turtle"),delete this._attributes.id,r=0,o=0,a=90,0!==i.length&&(3===i.length?(r=i[0],o=i[1],a=i[2]):2===i.length?s.isArray(i[0])?(r=i[0][0],o=i[0][1],a=i[1]):(r=i[0],o=i[1]):(r=i[0][0],o=i[0][1])),this.init(r,o,a),this.methodMap=s.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},t.Turtle.prototype=new i,t.extend(t.Turtle.prototype,{init:function(t,e,i){var s={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[t,e],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,s),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],s),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-i),this.board.update()},forward:function(t){if(0===t)return this;var e,i=t*Math.cos(this.dir*Math.PI/180),s=t*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((e=this.board.create("transform",[i,s],{type:"translate"})).applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=i,this.pos[1]+=s,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(t){return this.forward(-t)},right:function(t){return this.dir-=t,this.dir%=360,this.turtleIsHidden||this.board.create("transform",[-t*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(t){return this.right(-t)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var t,i;for(t=0;t<this.objects.length;t++)(i=this.objects[t]).type===e.OBJECT_TYPE_CURVE&&(this.board.removeObject(i),this.objects.splice(t,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var t,e=this.objects.length;for(t=0;t<e;t++)this.board.removeObject(this.objects[t]);return this.init(0,0,90),this},setPos:function(t,i){return this.pos=s.isArray(t)?t:[t,i],this.turtleIsHidden||(this.turtle.setPositionDirectly(e.COORDS_BY_USER,[t,i]),this.turtle2.setPositionDirectly(e.COORDS_BY_USER,[t,i+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",t)),this.objects.push(this.curve),this},setPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",t)),this.objects.push(this.curve),this},setHighlightPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",t)),this.objects.push(this.curve),this},setAttribute:function(t){var i,n,r,o=this.objects.length;for(i=0;i<o;i++)(n=this.objects[i]).type===e.OBJECT_TYPE_CURVE&&n.setAttribute(t);return r=this.visProp.id,this.visProp=s.deepCopy(this.curve.visProp),this.visProp.id=r,this._attributes=s.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(t,e){return this._attributes[t.toLowerCase()]=e,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var t=this.stack.pop();return this.pos[0]=t[0],this.pos[1]=t[1],this.dir=t[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(t){var e;return s.isArray(t)?(e=Math.atan2(t[1]-this.pos[1],t[0]-this.pos[0]),this.right(this.dir-180*e/Math.PI)):s.isNumber(t)&&this.right(this.dir-t),this},moveTo:function(t){var e;return s.isArray(t)&&(this.turtleIsHidden||((e=this.board.create("transform",[t[0]-this.pos[0],t[1]-this.pos[1]],{type:"translate"})).applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=t[0],this.pos[1]=t[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(t){return this.forward(t)},bk:function(t){return this.back(t)},lt:function(t){return this.left(t)},rt:function(t){return this.right(t)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(t,i){var s,n,r,o=this.objects.length;for(s=0,n=0;s<o;s++)if((r=this.objects[s]).elementClass===e.OBJECT_CLASS_CURVE){if(n<=t&&t<n+r.numberPoints)return r[i](t-n);n+=r.numberPoints}return this[i]()},X:function(t){return s.exists(t)?this.evalAt(t,"X"):this.pos[0]},Y:function(t){return s.exists(t)?this.evalAt(t,"Y"):this.pos[1]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){var t,i=this.objects.length,s=0;for(t=0;t<i;t++)this.objects[t].elementClass===e.OBJECT_CLASS_CURVE&&(s+=this.objects[t].numberPoints);return s},hasPoint:function(t,i){var s,n;for(s=0;s<this.objects.length;s++)if((n=this.objects[s]).type===e.OBJECT_TYPE_CURVE&&n.hasPoint(t,i))return!0;return!1}}),t.createTurtle=function(e,i,n){var r;return i=i||[],r=s.copyAttributes(n,e.options,"turtle"),new t.Turtle(e,i,r)},t.registerElement("turtle",t.createTurtle),{Turtle:t.Turtle,createTurtle:t.createTurtle}})),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],(function(t,e,i,s,n,r,o,a){"use strict";return t.CA=function(t,e,i){this.node=t,this.createNode=e,this.parser=i},t.extend(t.CA.prototype,{findMapNode:function(t,e){var i,s,n;if("op_assign"===e.value&&e.children[0].value===t)return e.children[1];if(e.children)for(s=e.children.length,i=0;i<s;++i)if(null!==(n=this.findMapNode(t,e.children[i])))return n;return null},setMath:function(t){var e,i;if(("node_op"!=t.type||"op_add"!=t.value&&"op_sub"!=t.value&&"op_mul"!=t.value&&"op_div"!=t.value&&"op_neg"!=t.value&&"op_execfun"!=t.value&&"op_exp"!=t.value)&&"node_var"!=t.type&&"node_const"!=t.type||(t.isMath=!0),t.children)for(i=t.children.length,e=0;e<i;++e)this.setMath(t.children[e])},deriveElementary:function(t,e){var i,s=t.children[0].value,n=t.children[1];switch(s){case"abs":i=this.createNode("node_op","op_div",n[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))]));break;case"sqrt":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(t.type,t.value,o.deepCopy(t.children[0]),o.deepCopy(t.children[1]))));break;case"sin":i=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),o.deepCopy(n));break;case"cos":i=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),o.deepCopy(n)));break;case"tan":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),o.deepCopy(n)),this.createNode("node_const",2)));break;case"exp":i=this.createNode(t.type,t.value,o.deepCopy(t.children[0]),o.deepCopy(t.children[1]));break;case"pow":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",o.deepCopy(t.children[0]),o.deepCopy(t.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[1][0],e),this.createNode("node_op","op_div",o.deepCopy(t.children[1][1]),o.deepCopy(t.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1][1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[o.deepCopy(t.children[1][0])]))));break;case"log":case"ln":i=this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0]));break;case"log2":case"lb":case"ld":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":i=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),o.deepCopy(n[0])),this.createNode("node_const",.43429448190325176));break;case"asin":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])))]));break;case"acos":i=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])))])));break;case"atan":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))));break;case"sinh":i=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[o.deepCopy(n[0])]);break;case"cosh":i=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[o.deepCopy(n[0])]);break;case"tanh":i=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[o.deepCopy(n[0])]),this.createNode("node_const",2)));break;case"asinh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"acosh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"atanh":i=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",o.deepCopy(n[0]),o.deepCopy(n[0]))));break;default:i=this.createNode("node_const",0),this._error('Derivative of "'+s+'" not yet implemented')}return i},derivative:function(t,e){var i;switch(t.type){case"node_op":switch(t.value){case"op_execfun":i="pow"==t.children[0].value?this.deriveElementary(t,e):this.createNode("node_op","op_mul",this.deriveElementary(t,e),this.derivative(t.children[1][0],e));break;case"op_div":i=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),o.deepCopy(t.children[1])),this.createNode("node_op","op_mul",o.deepCopy(t.children[0]),this.derivative(t.children[1],e))),this.createNode("node_op","op_mul",o.deepCopy(t.children[1]),o.deepCopy(t.children[1])));break;case"op_mul":i=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",o.deepCopy(t.children[0]),this.derivative(t.children[1],e)),this.createNode("node_op","op_mul",this.derivative(t.children[0],e),o.deepCopy(t.children[1])));break;case"op_neg":i=this.createNode("node_op","op_neg",this.derivative(t.children[0],e));break;case"op_add":case"op_sub":i=this.createNode("node_op",t.value,this.derivative(t.children[0],e),this.derivative(t.children[1],e));break;case"op_exp":i=this.createNode("node_op","op_mul",o.deepCopy(t),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),this.createNode("node_op","op_div",o.deepCopy(t.children[1]),o.deepCopy(t.children[0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[o.deepCopy(t.children[0])]))))}break;case"node_var":i=this.createNode("node_const",t.value===e?1:0);break;case"node_const":i=this.createNode("node_const",0)}return i},expandDerivatives:function(t,e,i){var s,n,r,a,l,c,h,u,d,p;if(!t)return 0;for(this.line=t.line,this.col=t.col,s=t.children.length,n=0;n<s;++n)if(t.children[n]&&t.children[n].type)t.children[n]=this.expandDerivatives(t.children[n],t,i);else if(o.isArray(t.children[n]))for(r=0;r<t.children[n].length;++r)t.children[n][r]&&t.children[n][r].type&&(t.children[n][r]=this.expandDerivatives(t.children[n][r],t,i));switch(t.type){case"node_op":switch(t.value){case"op_execfun":if(t.children[0]&&"D"===t.children[0].value){if("node_var"==t.children[1][0].type?(d=(a=this.findMapNode(t.children[1][0].value,i)).children[0],u=t.children[1].length>=2?t.children[1][1].value:a.children[0][0],l=a.children[1]):(l=t.children[1][0],d=["x"],u=t.children[1].length>=2?t.children[1][1].value:"x"),h=l,(p=t.children[1].length>=3?t.children[1][2].value:1)>=1)for(;p>=1;)h=this.derivative(h,u),h=this.removeTrivialNodes(h),p--;c="node_op"==e.type&&"op_assign"==e.value?this.createNode("node_op","op_map",d,h):h,this.setMath(c),t.type=c.type,t.value=c.value,t.children[0]=c.children[0],t.children[1]=c.children[1]}}}return t},removeTrivialNodes:function(t){var e,i,s,n,r;if(o.isArray(t))for(i=t.length,e=0;e<i;++e)t[e]=this.removeTrivialNodes(t[e]);if("node_op"!=t.type||!t.children)return t;for(i=t.children.length,e=0;e<i;++e){this.mayNotBeSimplified=!1;do{t.children[e]=this.removeTrivialNodes(t.children[e])}while(this.mayNotBeSimplified)}switch(t.value){case"op_map":if(s=t.children[0],"node_var"==(n=t.children[1]).type)for(e=0;e<s.length;++e)if(s[e]==n.value){n.isMath=!0;break}break;case"op_add":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&0===s.value)return n;if("node_const"==n.type&&0===n.value)return s;if("node_const"==s.type&&"node_const"==n.type)return s.value+=n.value,s;break;case"op_mul":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&1==s.value)return n;if("node_const"==n.type&&1==n.value)return s;if("node_const"==s.type&&0===s.value)return s;if("node_const"==n.type&&0===n.value)return n;if("node_const"==n.type&&0===n.value)return n;if("node_op"==s.type&&"op_neg"==s.value&&"node_op"==n.type&&"op_neg"==n.value)return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if("op_neg"==s.value&&"op_neg"!=n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s.children[0],n)],this.mayNotBeSimplified=!0,t;if("op_neg"!=s.value&&"op_neg"==n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s,n.children[0])],this.mayNotBeSimplified=!0,t;if("op_div"==s.value&&"node_const"==s.children[0].type&&1==s.children[0].value)return t.type="node_op",t.value="op_div",t.children=[n,s.children[1]],this.mayNotBeSimplified=!0,t;if("op_div"==n.value&&"node_const"==n.children[0].type&&1==n.children[0].value)return t.type="node_op",t.value="op_div",t.children=[s,n.children[1]],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_const"==n.type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_op"==n.type&&"op_neg"==n.value&&"node_const"==n.children[0].type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_execfun"!=s.value&&("node_var"==n.type||"node_op"==n.type&&"op_execfun"==n.value))return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_op"!=s.type&&"node_op"==n.type&&"op_neg"==n.value&&"node_var"==n.children[0].type)return t.children=[n,s],this.mayNotBeSimplified=!0,t;if("node_const"!=s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return r=n.children[0],n.children[0]=s,t.children=[r,n],this.mayNotBeSimplified=!0,t;if("node_const"!=n.type&&"node_op"==s.type&&"op_mul"==s.value&&"node_const"==s.children[0].type)return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],this.mayNotBeSimplified=!0,t;if("node_const"==s.type&&"node_const"==n.type)return s.value*=n.value,s;if("node_const"==s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return n.children[0].value*=s.value,n;if(s.hash=this.parser.compile(s),n.hash=this.parser.compile(n),s.hash===n.hash)return t.value="op_exp",t.children[1]=this.createNode("node_const",2),t;if("node_const"==s.type&&"node_op"==n.type&&("op_mul"==n.value||"op_div"==n.value)&&"node_const"==n.children[0].type)return n.children[0].value*=s.value,n;if("node_op"==n.type&&"op_exp"==n.value&&(s.hash||(s.hash=this.parser.compile(s)),n.children[0].hash||(n.children[0].hash=this.parser.compile(n.children[0])),s.hash===n.children[0].hash))return n.children[1]=this.createNode("node_op","op_add",n.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,n;if("node_op"==s.type&&"op_exp"==s.value&&"node_op"==n.type&&"op_exp"==n.value&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_add",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_sub":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&0===s.value)return t.value="op_neg",t.children[0]=n,t;if("node_const"==n.type&&0===n.value)return s;if("node_const"==s.type&&"node_const"==n.type&&s.value==n.value)return this.createNode("node_const",0);if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return this.createNode("node_const",0);if("node_const"==s.type&&"node_const"==n.type)return s.value-=n.value,s;if("node_op"==s.type&&"op_mul"==s.value&&"node_op"==n.type&&"op_mul"==n.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_mul"==n.value&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_neg":if("node_const"==(s=t.children[0]).type&&0===s.value)return s;if("node_op"==s.type&&"op_neg"==s.value)return s.children[0];break;case"op_div":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&"node_const"==n.type&&s.value==n.value&&0!==s.value)return s.value=1,s;if("node_const"==s.type&&0===s.value&&"node_const"==n.type&&0!==n.value)return s.value=0,s;if("node_const"==s.type&&0===s.value&&("node_op"==n.type||"node_var"==n.type))return t.type="node_const",t.value=0,t;if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return this.createNode("node_const",1);if("node_const"==s.type&&0!==s.value&&"node_const"==n.type&&0===n.value)return s.value=s.value>0?1/0:-1/0,s;if("node_op"==s.type&&"op_neg"==s.value&&"node_op"==n.type&&"op_neg"==n.value)return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if("op_neg"==s.value&&"op_neg"!=n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s.children[0],n)],this.mayNotBeSimplified=!0,t;if("op_neg"!=s.value&&"op_neg"==n.value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s,n.children[0])],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_exp"==s.value&&(n.hash||(n.hash=this.parser.compile(n)),s.children[0].hash||(s.children[0].hash=this.parser.compile(s.children[0])),n.hash===s.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,s;if("node_const"!=n.type&&"node_op"==s.type&&"op_mul"==s.value&&"node_const"==s.children[0].type)return t.value="op_mul",t.children=[s.children[0],this.createNode("node_op","op_div",s.children[1],n)],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_exp"==s.value&&"node_op"==n.type&&"op_exp"==n.value&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_exp":if(s=t.children[0],"node_const"==(n=t.children[1]).type&&0===n.value)return n.value=1,n;if("node_const"==n.type&&1==n.value)return s;if("node_const"==s.type&&1==s.value)return s;if("node_const"==s.type&&0===s.value&&"node_const"==n.type&&0!==n.value)return s;if("node_op"==s.type&&"op_exp"==s.value)return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],t}switch(t.value){case"op_add":if(n=t.children[1],"node_const"==(s=t.children[0]).type&&"node_const"==n.type&&s.value==n.value)return s.value+=n.value,s;if("node_var"==s.type&&"node_var"==n.type&&s.value==n.value)return t.children[0]=this.createNode("node_const",2),t.value="op_mul",t;if("node_op"==s.type&&"op_neg"==s.value)return t.value="op_sub",t.children[0]=n,t.children[1]=s.children[0],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_neg"==n.value)return t.value="op_sub",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&"node_op"==n.type&&"op_mul"==n.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if("node_op"==s.type&&"op_mul"==s.value&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if("node_op"==n.type&&"op_mul"==n.value&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_sub":if(s=t.children[0],"node_op"==(n=t.children[1]).type&&"op_neg"==n.value)return t.value="op_add",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;break;case"op_execfun":return this.simplifyElementary(t)}return t},simplifyElementary:function(t){var e=t.children[1];if(0==e.length)return t;switch(t.children[0].value){case"sin":case"tan":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=0,t;if("node_var"==e[0].type&&"PI"==e[0].value)return t.type="node_const",t.value=0,t;if("node_op"==e[0].type&&"op_mul"==e[0].value&&"node_const"==e[0].children[0].type&&e[0].children[0].value%1==0&&"node_var"==e[0].children[1].type&&"PI"==e[0].children[1].value)return t.type="node_const",t.value=0,t;break;case"cos":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=1,t;if("node_var"==e[0].type&&"PI"==e[0].value)return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_const",1)],t;break;case"exp":if("node_const"==e[0].type&&0===e[0].value)return t.type="node_const",t.value=1,t;break;case"pow":if("node_const"==e[1].type&&0===e[1].value)return t.type="node_const",t.value=1,t}return t}}),t.CA})),define("utils/dump",["jxg","utils/type"],(function(t,e){"use strict";return t.Dump={addMarkers:function(t,i,s){var n,r,o;for(n in e.isArray(i)||(i=[i]),e.isArray(s)||(s=[s]),r=Math.min(i.length,s.length),i.length=r,s.length=r,t.objects)if(t.objects.hasOwnProperty(n))for(o=0;o<r;o++)t.objects[n][i[o]]=s[o]},deleteMarkers:function(t,i){var s,n,r;for(s in e.isArray(i)||(i=[i]),i.length=n=i.length,t.objects)if(t.objects.hasOwnProperty(s))for(r=0;r<n;r++)delete t.objects[s][i[r]]},str:function(t){return"string"==typeof t&&"function"!==t.substr(0,7)&&(t='"'+t+'"'),t},minimizeObject:function(i,s){var n,r,o,a={},l=e.deepCopy(i),c=[];for(o=1;o<arguments.length;o++)c.push(arguments[o]);for(a=e.deepCopy(a,t.Options.elements,!0),o=c.length;o>0;o--)a=e.deepCopy(a,c[o-1],!0);for(n in a)a.hasOwnProperty(n)&&(r=n.toLowerCase(),"object"!=typeof a[n]&&a[n]===l[r]&&(console.log("delete",n),delete l[r]));return l},prepareAttributes:function(e,i){var s,n;for(n in s=this.minimizeObject(i.getAttributes(),t.Options[i.elType]),i.subs)i.subs.hasOwnProperty(n)&&(s[n]=this.minimizeObject(i.subs[n].getAttributes(),t.Options[i.elType][n],t.Options[i.subs[n].elType]),s[n].id=i.subs[n].id,s[n].name=i.subs[n].name);return s.id=i.id,s.name=i.name,s},setBoundingBox:function(t,e,i){return t.push({obj:i,method:"setBoundingBox",params:[e.getBoundingBox(),!0]}),t},dump:function(t){var i,s,n,r,o=[],a=[],l=t.objectsList.length;for(this.addMarkers(t,"dumped",!1),i=0;i<l;i++)if(n={},!(s=t.objectsList[i]).dumped&&s.dump){for(n.type=s.getType(),n.parents=s.getParents().slice(),"point"===n.type&&1===n.parents[0]&&(n.parents=n.parents.slice(1)),r=0;r<n.parents.length;r++)e.isString(n.parents[r])&&"'"!==n.parents[r][0]&&'"'!==n.parents[r][0]?n.parents[r]='"'+n.parents[r]+'"':e.isArray(n.parents[r])&&(n.parents[r]="["+n.parents[r].toString()+"]");n.attributes=this.prepareAttributes(t,s),"glider"===n.type&&s.onPolygon&&o.push({obj:s.id,prop:"onPolygon",val:!0}),a.push(n)}return this.deleteMarkers(t,"dumped"),{elements:a,props:o,methods:[]}},arrayToParamStr:function(t,e){var i,s=[];for(i=0;i<t.length;i++)s.push(e.call(this,t[i]));return s.join(", ")},toJCAN:function(t){var i,s,n;switch(typeof t){case"object":if(t){if(s=[],e.isArray(t)){for(i=0;i<t.length;i++)s.push(this.toJCAN(t[i]));return"["+s.join(",")+"]"}for(n in t)t.hasOwnProperty(n)&&s.push(n+": "+this.toJCAN(t[n]));return"<<"+s.join(", ")+">> "}return"null";case"string":return"'"+t.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return t.toString();case"null":return"null"}},toJessie:function(t){var e,i,s=this.dump(t),n=[];for(s.methods=this.setBoundingBox(s.methods,t,"$board"),i=s.elements,e=0;e<i.length;e++)i[e].attributes.name.length>0&&n.push("// "+i[e].attributes.name),n.push("s"+e+" = "+i[e].type+"("+i[e].parents.join(", ")+") "+this.toJCAN(i[e].attributes).replace(/\n/,"\\n")+";"),n.push("");for(e=0;e<s.methods.length;e++)n.push(s.methods[e].obj+"."+s.methods[e].method+"("+this.arrayToParamStr(s.methods[e].params,this.toJCAN)+");"),n.push("");for(e=0;e<s.props.length;e++)n.push(s.props[e].obj+"."+s.props[e].prop+" = "+this.toJCAN(s.props[e].val)+";"),n.push("");return n.join("\n")},toJavaScript:function(t){var i,s,n=this.dump(t),r=[];for(n.methods=this.setBoundingBox(n.methods,t,"board"),s=n.elements,i=0;i<s.length;i++)r.push('board.create("'+s[i].type+'", ['+s[i].parents.join(", ")+"], "+e.toJSON(s[i].attributes)+");");for(i=0;i<n.methods.length;i++)r.push(n.methods[i].obj+"."+n.methods[i].method+"("+this.arrayToParamStr(n.methods[i].params,e.toJSON)+");"),r.push("");for(i=0;i<n.props.length;i++)r.push(n.props[i].obj+"."+n.props[i].prop+" = "+e.toJSON(n.props[i].val)+";"),r.push("");return r.join("\n")}},t.Dump})),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],(function(t,e,i,s,n,r,o){"use strict";return t.createComb=function(t,e,s){var n,r,a,l,c,h,u,d,p;if(2!==e.length)throw c=e.map((function(t){return"'"+typeof t+"'"})),new Error("JSXGraph: Can't create comb with parent types "+c.join(", ")+".\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");if(i.isArray(e[0])&&e[0].length>1)l=i.copyAttributes(s,t.options,"comb","point1"),n=t.create("point",e[0],l);else if(i.isString(e[0])||i.isPoint(e[0]))n=t.select(e[0]);else if(i.isFunction(e[0])&&i.isPoint(e[0]()))n=e[0]();else{if(!(i.isFunction(e[0])&&e[0]().length&&e[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");l=i.copyAttributes(s,t.options,"comb","point1"),n=o.createPoint(t,e[0](),l)}if(i.isArray(e[1])&&e[1].length>1)l=i.copyAttributes(s,t.options,"comb","point2"),r=t.create("point",e[1],l);else if(i.isString(e[1])||i.isPoint(e[1]))r=t.select(e[1]);else if(i.isFunction(e[1])&&i.isPoint(e[1]()))r=e[1]();else{if(!(i.isFunction(e[1])&&e[1]().length&&e[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");l=i.copyAttributes(s,t.options,"comb","point2"),r=o.createPoint(t,e[1](),l)}return l=i.copyAttributes(s,t.options,"comb","curve"),a=t.create("curve",[[0],[0]],l),l=i.copyAttributes(s,t.options,"comb"),h=l.frequency,u=-l.angle,d=l.width,l.reverse&&(p=n,n=r,r=p,u=-u),a.updateDataArray=function(){var t,e,i,s=0,o=n.Dist(r),a=Math.cos(u),l=Math.sin(u),c=(r.X()-n.X())/o,p=(r.Y()-n.Y())/o;for(a*=d/Math.abs(l),l*=d/Math.abs(l),this.dataX=[],this.dataY=[];s<o;)t=n.X()+c*s,e=n.Y()+p*s,l*=i=Math.min(a,o-s)/Math.abs(a),a*=i,this.dataX.push(t),this.dataY.push(e),this.dataX.push(t+c*a+p*l),this.dataY.push(e-c*l+p*a),this.dataX.push(NaN),this.dataY.push(NaN),s+=h},a},t.registerElement("comb",t.createComb),{createComb:t.createComb}})),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],(function(t,e,i,s,n,r,o,a){"use strict";var l={removeSlopeTriangle:function(){r.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return t.createSlopeTriangle=function(e,n,r){var o,a,c,h,u,d,p,f,m,g=!1;if(1===n.length&&n[0].type===s.OBJECT_TYPE_TANGENT)c=(a=n[0]).glider;else if(1===n.length&&n[0].type===s.OBJECT_TYPE_GLIDER)c=n[0],m=i.copyAttributes(r,e.options,"slopetriangle","tangent"),a=e.create("tangent",[c],m),g=!0;else{if(2!==n.length||n[0].elementClass!==s.OBJECT_CLASS_LINE||!i.isPoint(n[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof n[0]+"'.");a=n[0],c=n[1]}return m=i.copyAttributes(r,e.options,"slopetriangle","basepoint"),p=e.create("point",[function(){return[c.X()+1,c.Y()]}],m),m=i.copyAttributes(r,e.options,"slopetriangle","baseline"),d=e.create("line",[c,p],m),m=i.copyAttributes(r,e.options,"slopetriangle","glider"),h=e.create("glider",[c.X()+1,c.Y(),d],m),m=i.copyAttributes(r,e.options,"slopetriangle","toppoint"),u=e.create("point",[function(){return[h.X(),h.Y()+(h.X()-c.X())*a.getSlope()]}],m),(m=i.copyAttributes(r,e.options,"slopetriangle")).borders=i.copyAttributes(m.borders,e.options,"slopetriangle","borders"),(o=e.create("polygon",[c,h,u],m)).Value=l.Value,o.tangent=a,o._isPrivateTangent=g,o.borders[2].setArrow(!1,!1),m=i.copyAttributes(r,e.options,"slopetriangle","label"),(f=e.create("text",[function(){return h.X()+.1},function(){return.5*(h.Y()+u.Y())},function(){return""}],m))._setText((function(){return i.toFixed(o.Value(),i.evaluate(f.visProp.digits))})),f.fullUpdate(),o.glider=h,o.basepoint=p,o.baseline=d,o.toppoint=u,o.label=f,o.subs={glider:h,basePoint:p,baseLine:d,topPoint:u,label:f},o.inherits.push(h,p,d,u,f),o.methodMap=t.deepCopy(o.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),o.remove=l.removeSlopeTriangle,o},t.registerElement("slopetriangle",t.createSlopeTriangle),{createSlopeTriangle:t.createSlopeTriangle}})),define("element/checkbox",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};return t.createCheckbox=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"checkbox");return(a=n.create("text",[r[0],r[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],l)).type=i.OBJECT_TYPE_CHECKBOX,a.rendNodeCheckbox=a.rendNode.childNodes[0].childNodes[0],a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[1],a.rendNodeTag=a.rendNodeCheckbox,a.rendNodeTag.disabled=!!l.disabled,a.rendNodeLabel.innerHTML=r[2],a.rendNodeCheckbox.id=a.rendNode.id+"_checkbox",a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeLabel.setAttribute("for",a.rendNodeCheckbox.id),a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),a.rendNodeCheckbox.checked=l.checked,a._value=l.checked,a.Value=function(){return this._value},a.update=function(){return this.needsUpdate&&(t.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},e.addEvent(a.rendNodeCheckbox,"change",s,a),a},t.registerElement("checkbox",t.createCheckbox),{createCheckbox:t.createCheckbox}})),define("element/input",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(t){this._value=this.rendNodeInput.value,this.board.update()};return t.createInput=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"input");return(a=n.create("text",[r[0],r[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+l.maxlength+'" style="width:100%"/></span>'],l)).type=i.OBJECT_TYPE_INPUT,a.rendNodeLabel=a.rendNode.childNodes[0].childNodes[0],a.rendNodeInput=a.rendNode.childNodes[0].childNodes[1],a.rendNodeLabel.innerHTML=r[3],a.rendNodeInput.value=r[2],a.rendNodeTag=a.rendNodeInput,a.rendNodeTag.disabled=!!l.disabled,a.rendNodeLabel.id=a.rendNode.id+"_label",a.rendNodeInput.id=a.rendNode.id+"_input",a._value=r[2],a.update=function(){return this.needsUpdate&&(t.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},a.Value=function(){return this._value},e.addEvent(a.rendNodeInput,"input",s,a),e.addEvent(a.rendNodeInput,"mousedown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeInput,"touchstart",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeInput,"pointerdown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),a},t.registerElement("input",t.createInput),{createInput:t.createInput}})),define("element/button",["jxg","utils/env","utils/type"],(function(t,e,i){"use strict";var s=function(){this._handler&&this._handler(),this.board.update()};return t.createButton=function(n,r,o){var a,l=i.copyAttributes(o,n.options,"button");return(a=n.create("text",[r[0],r[1],'<button type="button" style="width:100%;"></button>'],l)).type=i.OBJECT_TYPE_BUTTON,a.rendNodeButton=a.rendNode.childNodes[0],a.rendNodeButton.id=a.rendNode.id+"_button",a.rendNodeButton.innerHTML=r[2],a.rendNodeTag=a.rendNodeButton,a.rendNodeTag.disabled=!!l.disabled,a.visPropOld.fontsize="0px",n.renderer.updateTextStyle(a,!1),r[3]&&(i.isString(r[3])?(a._jc=new t.JessieCode,a._jc.use(n),a._handler=function(){a._jc.parse(r[3])}):a._handler=r[3]),e.addEvent(a.rendNodeButton,"click",s,a),e.addEvent(a.rendNodeButton,"mousedown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeButton,"touchstart",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),e.addEvent(a.rendNodeButton,"pointerdown",(function(t){i.exists(t.stopPropagation)&&t.stopPropagation()}),a),a},t.registerElement("button",t.createButton),{createButton:t.createButton}})),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],(function(t,e){"use strict";return e.isBrowser?window.JXG=t:e.isNode()&&"object"==typeof module?module.exports=t:e.isWebWorker()&&(self.JXG=t),t})),require("../build/core.deps.js")})),global=this,factory=function(){function t(t,e){const i=t.charCodeAt(e=e||0);if(55296<=i&&i<=56319&&e<t.length-1){const s=i,n=t.charCodeAt(e+1);return 56320<=n&&n<=57343?1024*(s-55296)+(n-56320)+65536:s}if(56320<=i&&i<=57343&&e>=1){const s=t.charCodeAt(e-1),n=i;return 55296<=s&&s<=56319?1024*(s-55296)+(n-56320)+65536:n}return i}function e(e,s){if((s=s||0)<0)return 0;if(s>=e.length-1)return e.length;let n=i(t(e,s));for(let a=s+1;a<e.length;a++){if(55296<=e.charCodeAt(a-1)&&e.charCodeAt(a-1)<=56319&&56320<=e.charCodeAt(a)&&e.charCodeAt(a)<=57343)continue;const s=i(t(e,a));if(o=s,!(11===(r=n)&&12===o||3===r&&11===o||11===r&&3===o||0===r&&1===o||2!==r&&0!==r&&1!==r&&2!==o&&0!==o&&1!==o&&(6===r&&(6===o||7===o||9===o||10===o)||!(9!==r&&7!==r||7!==o&&8!==o)||(10===r||8===r)&&8===o||4===r&&4===o||3===o||5===o)))return a;n=s}var r,o;return e.length}function i(t){return 13===t?0:10===t?1:0<=t&&t<=9||11<=t&&t<=12||14<=t&&t<=31||127<=t&&t<=159||173===t||1536<=t&&t<=1541||1564===t||1757===t||1807===t||6158===t||8203===t||8206<=t&&t<=8207||8232===t||8233===t||8234<=t&&t<=8238||8288<=t&&t<=8292||8293===t||8294<=t&&t<=8303||55296<=t&&t<=57343||65279===t||65520<=t&&t<=65528||65529<=t&&t<=65531||69821===t||113824<=t&&t<=113827||119155<=t&&t<=119162||917504===t||917505===t||917506<=t&&t<=917535||917536<=t&&t<=917631||917632<=t&&t<=917759||918e3<=t&&t<=921599?2:768<=t&&t<=879||1155<=t&&t<=1159||1160<=t&&t<=1161||1425<=t&&t<=1469||1471===t||1473<=t&&t<=1474||1476<=t&&t<=1477||1479===t||1552<=t&&t<=1562||1611<=t&&t<=1631||1648===t||1750<=t&&t<=1756||1759<=t&&t<=1764||1767<=t&&t<=1768||1770<=t&&t<=1773||1809===t||1840<=t&&t<=1866||1958<=t&&t<=1968||2027<=t&&t<=2035||2070<=t&&t<=2073||2075<=t&&t<=2083||2085<=t&&t<=2087||2089<=t&&t<=2093||2137<=t&&t<=2139||2275<=t&&t<=2306||2362===t||2364===t||2369<=t&&t<=2376||2381===t||2385<=t&&t<=2391||2402<=t&&t<=2403||2433===t||2492===t||2494===t||2497<=t&&t<=2500||2509===t||2519===t||2530<=t&&t<=2531||2561<=t&&t<=2562||2620===t||2625<=t&&t<=2626||2631<=t&&t<=2632||2635<=t&&t<=2637||2641===t||2672<=t&&t<=2673||2677===t||2689<=t&&t<=2690||2748===t||2753<=t&&t<=2757||2759<=t&&t<=2760||2765===t||2786<=t&&t<=2787||2817===t||2876===t||2878===t||2879===t||2881<=t&&t<=2884||2893===t||2902===t||2903===t||2914<=t&&t<=2915||2946===t||3006===t||3008===t||3021===t||3031===t||3072===t||3134<=t&&t<=3136||3142<=t&&t<=3144||3146<=t&&t<=3149||3157<=t&&t<=3158||3170<=t&&t<=3171||3201===t||3260===t||3263===t||3266===t||3270===t||3276<=t&&t<=3277||3285<=t&&t<=3286||3298<=t&&t<=3299||3329===t||3390===t||3393<=t&&t<=3396||3405===t||3415===t||3426<=t&&t<=3427||3530===t||3535===t||3538<=t&&t<=3540||3542===t||3551===t||3633===t||3636<=t&&t<=3642||3655<=t&&t<=3662||3761===t||3764<=t&&t<=3769||3771<=t&&t<=3772||3784<=t&&t<=3789||3864<=t&&t<=3865||3893===t||3895===t||3897===t||3953<=t&&t<=3966||3968<=t&&t<=3972||3974<=t&&t<=3975||3981<=t&&t<=3991||3993<=t&&t<=4028||4038===t||4141<=t&&t<=4144||4146<=t&&t<=4151||4153<=t&&t<=4154||4157<=t&&t<=4158||4184<=t&&t<=4185||4190<=t&&t<=4192||4209<=t&&t<=4212||4226===t||4229<=t&&t<=4230||4237===t||4253===t||4957<=t&&t<=4959||5906<=t&&t<=5908||5938<=t&&t<=5940||5970<=t&&t<=5971||6002<=t&&t<=6003||6068<=t&&t<=6069||6071<=t&&t<=6077||6086===t||6089<=t&&t<=6099||6109===t||6155<=t&&t<=6157||6313===t||6432<=t&&t<=6434||6439<=t&&t<=6440||6450===t||6457<=t&&t<=6459||6679<=t&&t<=6680||6683===t||6742===t||6744<=t&&t<=6750||6752===t||6754===t||6757<=t&&t<=6764||6771<=t&&t<=6780||6783===t||6832<=t&&t<=6845||6846===t||6912<=t&&t<=6915||6964===t||6966<=t&&t<=6970||6972===t||6978===t||7019<=t&&t<=7027||7040<=t&&t<=7041||7074<=t&&t<=7077||7080<=t&&t<=7081||7083<=t&&t<=7085||7142===t||7144<=t&&t<=7145||7149===t||7151<=t&&t<=7153||7212<=t&&t<=7219||7222<=t&&t<=7223||7376<=t&&t<=7378||7380<=t&&t<=7392||7394<=t&&t<=7400||7405===t||7412===t||7416<=t&&t<=7417||7616<=t&&t<=7669||7676<=t&&t<=7679||8204<=t&&t<=8205||8400<=t&&t<=8412||8413<=t&&t<=8416||8417===t||8418<=t&&t<=8420||8421<=t&&t<=8432||11503<=t&&t<=11505||11647===t||11744<=t&&t<=11775||12330<=t&&t<=12333||12334<=t&&t<=12335||12441<=t&&t<=12442||42607===t||42608<=t&&t<=42610||42612<=t&&t<=42621||42654<=t&&t<=42655||42736<=t&&t<=42737||43010===t||43014===t||43019===t||43045<=t&&t<=43046||43204===t||43232<=t&&t<=43249||43302<=t&&t<=43309||43335<=t&&t<=43345||43392<=t&&t<=43394||43443===t||43446<=t&&t<=43449||43452===t||43493===t||43561<=t&&t<=43566||43569<=t&&t<=43570||43573<=t&&t<=43574||43587===t||43596===t||43644===t||43696===t||43698<=t&&t<=43700||43703<=t&&t<=43704||43710<=t&&t<=43711||43713===t||43756<=t&&t<=43757||43766===t||44005===t||44008===t||44013===t||64286===t||65024<=t&&t<=65039||65056<=t&&t<=65071||65438<=t&&t<=65439||66045===t||66272===t||66422<=t&&t<=66426||68097<=t&&t<=68099||68101<=t&&t<=68102||68108<=t&&t<=68111||68152<=t&&t<=68154||68159===t||68325<=t&&t<=68326||69633===t||69688<=t&&t<=69702||69759<=t&&t<=69761||69811<=t&&t<=69814||69817<=t&&t<=69818||69888<=t&&t<=69890||69927<=t&&t<=69931||69933<=t&&t<=69940||70003===t||70016<=t&&t<=70017||70070<=t&&t<=70078||70090<=t&&t<=70092||70191<=t&&t<=70193||70196===t||70198<=t&&t<=70199||70367===t||70371<=t&&t<=70378||70400<=t&&t<=70401||70460===t||70462===t||70464===t||70487===t||70502<=t&&t<=70508||70512<=t&&t<=70516||70832===t||70835<=t&&t<=70840||70842===t||70845===t||70847<=t&&t<=70848||70850<=t&&t<=70851||71087===t||71090<=t&&t<=71093||71100<=t&&t<=71101||71103<=t&&t<=71104||71132<=t&&t<=71133||71219<=t&&t<=71226||71229===t||71231<=t&&t<=71232||71339===t||71341===t||71344<=t&&t<=71349||71351===t||71453<=t&&t<=71455||71458<=t&&t<=71461||71463<=t&&t<=71467||92912<=t&&t<=92916||92976<=t&&t<=92982||94095<=t&&t<=94098||113821<=t&&t<=113822||119141===t||119143<=t&&t<=119145||119150<=t&&t<=119154||119163<=t&&t<=119170||119173<=t&&t<=119179||119210<=t&&t<=119213||119362<=t&&t<=119364||121344<=t&&t<=121398||121403<=t&&t<=121452||121461===t||121476===t||121499<=t&&t<=121503||121505<=t&&t<=121519||125136<=t&&t<=125142||917760<=t&&t<=917999?3:127462<=t&&t<=127487?4:127995<=t&&t<=127999?12:2307===t||2363===t||2366<=t&&t<=2368||2377<=t&&t<=2380||2382<=t&&t<=2383||2434<=t&&t<=2435||2495<=t&&t<=2496||2503<=t&&t<=2504||2507<=t&&t<=2508||2563===t||2622<=t&&t<=2624||2691===t||2750<=t&&t<=2752||2761===t||2763<=t&&t<=2764||2818<=t&&t<=2819||2880===t||2887<=t&&t<=2888||2891<=t&&t<=2892||3007===t||3009<=t&&t<=3010||3014<=t&&t<=3016||3018<=t&&t<=3020||3073<=t&&t<=3075||3137<=t&&t<=3140||3202<=t&&t<=3203||3262===t||3264<=t&&t<=3265||3267<=t&&t<=3268||3271<=t&&t<=3272||3274<=t&&t<=3275||3330<=t&&t<=3331||3391<=t&&t<=3392||3398<=t&&t<=3400||3402<=t&&t<=3404||3458<=t&&t<=3459||3536<=t&&t<=3537||3544<=t&&t<=3550||3570<=t&&t<=3571||3635===t||3763===t||3902<=t&&t<=3903||3967===t||4145===t||4155<=t&&t<=4156||4182<=t&&t<=4183||4228===t||6070===t||6078<=t&&t<=6085||6087<=t&&t<=6088||6435<=t&&t<=6438||6441<=t&&t<=6443||6448<=t&&t<=6449||6451<=t&&t<=6456||6681<=t&&t<=6682||6741===t||6743===t||6765<=t&&t<=6770||6916===t||6965===t||6971===t||6973<=t&&t<=6977||6979<=t&&t<=6980||7042===t||7073===t||7078<=t&&t<=7079||7082===t||7143===t||7146<=t&&t<=7148||7150===t||7154<=t&&t<=7155||7204<=t&&t<=7211||7220<=t&&t<=7221||7393===t||7410<=t&&t<=7411||43043<=t&&t<=43044||43047===t||43136<=t&&t<=43137||43188<=t&&t<=43203||43346<=t&&t<=43347||43395===t||43444<=t&&t<=43445||43450<=t&&t<=43451||43453<=t&&t<=43456||43567<=t&&t<=43568||43571<=t&&t<=43572||43597===t||43755===t||43758<=t&&t<=43759||43765===t||44003<=t&&t<=44004||44006<=t&&t<=44007||44009<=t&&t<=44010||44012===t||69632===t||69634===t||69762===t||69808<=t&&t<=69810||69815<=t&&t<=69816||69932===t||70018===t||70067<=t&&t<=70069||70079<=t&&t<=70080||70188<=t&&t<=70190||70194<=t&&t<=70195||70197===t||70368<=t&&t<=70370||70402<=t&&t<=70403||70463===t||70465<=t&&t<=70468||70471<=t&&t<=70472||70475<=t&&t<=70477||70498<=t&&t<=70499||70833<=t&&t<=70834||70841===t||70843<=t&&t<=70844||70846===t||70849===t||71088<=t&&t<=71089||71096<=t&&t<=71099||71102===t||71216<=t&&t<=71218||71227<=t&&t<=71228||71230===t||71340===t||71342<=t&&t<=71343||71350===t||71456<=t&&t<=71457||71462===t||94033<=t&&t<=94078||119142===t||119149===t?5:4352<=t&&t<=4447||43360<=t&&t<=43388?6:4448<=t&&t<=4519||55216<=t&&t<=55238?7:4520<=t&&t<=4607||55243<=t&&t<=55291?8:44032===t||44060===t||44088===t||44116===t||44144===t||44172===t||44200===t||44228===t||44256===t||44284===t||44312===t||44340===t||44368===t||44396===t||44424===t||44452===t||44480===t||44508===t||44536===t||44564===t||44592===t||44620===t||44648===t||44676===t||44704===t||44732===t||44760===t||44788===t||44816===t||44844===t||44872===t||44900===t||44928===t||44956===t||44984===t||45012===t||45040===t||45068===t||45096===t||45124===t||45152===t||45180===t||45208===t||45236===t||45264===t||45292===t||45320===t||45348===t||45376===t||45404===t||45432===t||45460===t||45488===t||45516===t||45544===t||45572===t||45600===t||45628===t||45656===t||45684===t||45712===t||45740===t||45768===t||45796===t||45824===t||45852===t||45880===t||45908===t||45936===t||45964===t||45992===t||46020===t||46048===t||46076===t||46104===t||46132===t||46160===t||46188===t||46216===t||46244===t||46272===t||46300===t||46328===t||46356===t||46384===t||46412===t||46440===t||46468===t||46496===t||46524===t||46552===t||46580===t||46608===t||46636===t||46664===t||46692===t||46720===t||46748===t||46776===t||46804===t||46832===t||46860===t||46888===t||46916===t||46944===t||46972===t||47e3===t||47028===t||47056===t||47084===t||47112===t||47140===t||47168===t||47196===t||47224===t||47252===t||47280===t||47308===t||47336===t||47364===t||47392===t||47420===t||47448===t||47476===t||47504===t||47532===t||47560===t||47588===t||47616===t||47644===t||47672===t||47700===t||47728===t||47756===t||47784===t||47812===t||47840===t||47868===t||47896===t||47924===t||47952===t||47980===t||48008===t||48036===t||48064===t||48092===t||48120===t||48148===t||48176===t||48204===t||48232===t||48260===t||48288===t||48316===t||48344===t||48372===t||48400===t||48428===t||48456===t||48484===t||48512===t||48540===t||48568===t||48596===t||48624===t||48652===t||48680===t||48708===t||48736===t||48764===t||48792===t||48820===t||48848===t||48876===t||48904===t||48932===t||48960===t||48988===t||49016===t||49044===t||49072===t||49100===t||49128===t||49156===t||49184===t||49212===t||49240===t||49268===t||49296===t||49324===t||49352===t||49380===t||49408===t||49436===t||49464===t||49492===t||49520===t||49548===t||49576===t||49604===t||49632===t||49660===t||49688===t||49716===t||49744===t||49772===t||49800===t||49828===t||49856===t||49884===t||49912===t||49940===t||49968===t||49996===t||50024===t||50052===t||50080===t||50108===t||50136===t||50164===t||50192===t||50220===t||50248===t||50276===t||50304===t||50332===t||50360===t||50388===t||50416===t||50444===t||50472===t||50500===t||50528===t||50556===t||50584===t||50612===t||50640===t||50668===t||50696===t||50724===t||50752===t||50780===t||50808===t||50836===t||50864===t||50892===t||50920===t||50948===t||50976===t||51004===t||51032===t||51060===t||51088===t||51116===t||51144===t||51172===t||51200===t||51228===t||51256===t||51284===t||51312===t||51340===t||51368===t||51396===t||51424===t||51452===t||51480===t||51508===t||51536===t||51564===t||51592===t||51620===t||51648===t||51676===t||51704===t||51732===t||51760===t||51788===t||51816===t||51844===t||51872===t||51900===t||51928===t||51956===t||51984===t||52012===t||52040===t||52068===t||52096===t||52124===t||52152===t||52180===t||52208===t||52236===t||52264===t||52292===t||52320===t||52348===t||52376===t||52404===t||52432===t||52460===t||52488===t||52516===t||52544===t||52572===t||52600===t||52628===t||52656===t||52684===t||52712===t||52740===t||52768===t||52796===t||52824===t||52852===t||52880===t||52908===t||52936===t||52964===t||52992===t||53020===t||53048===t||53076===t||53104===t||53132===t||53160===t||53188===t||53216===t||53244===t||53272===t||53300===t||53328===t||53356===t||53384===t||53412===t||53440===t||53468===t||53496===t||53524===t||53552===t||53580===t||53608===t||53636===t||53664===t||53692===t||53720===t||53748===t||53776===t||53804===t||53832===t||53860===t||53888===t||53916===t||53944===t||53972===t||54e3===t||54028===t||54056===t||54084===t||54112===t||54140===t||54168===t||54196===t||54224===t||54252===t||54280===t||54308===t||54336===t||54364===t||54392===t||54420===t||54448===t||54476===t||54504===t||54532===t||54560===t||54588===t||54616===t||54644===t||54672===t||54700===t||54728===t||54756===t||54784===t||54812===t||54840===t||54868===t||54896===t||54924===t||54952===t||54980===t||55008===t||55036===t||55064===t||55092===t||55120===t||55148===t||55176===t?9:44033<=t&&t<=44059||44061<=t&&t<=44087||44089<=t&&t<=44115||44117<=t&&t<=44143||44145<=t&&t<=44171||44173<=t&&t<=44199||44201<=t&&t<=44227||44229<=t&&t<=44255||44257<=t&&t<=44283||44285<=t&&t<=44311||44313<=t&&t<=44339||44341<=t&&t<=44367||44369<=t&&t<=44395||44397<=t&&t<=44423||44425<=t&&t<=44451||44453<=t&&t<=44479||44481<=t&&t<=44507||44509<=t&&t<=44535||44537<=t&&t<=44563||44565<=t&&t<=44591||44593<=t&&t<=44619||44621<=t&&t<=44647||44649<=t&&t<=44675||44677<=t&&t<=44703||44705<=t&&t<=44731||44733<=t&&t<=44759||44761<=t&&t<=44787||44789<=t&&t<=44815||44817<=t&&t<=44843||44845<=t&&t<=44871||44873<=t&&t<=44899||44901<=t&&t<=44927||44929<=t&&t<=44955||44957<=t&&t<=44983||44985<=t&&t<=45011||45013<=t&&t<=45039||45041<=t&&t<=45067||45069<=t&&t<=45095||45097<=t&&t<=45123||45125<=t&&t<=45151||45153<=t&&t<=45179||45181<=t&&t<=45207||45209<=t&&t<=45235||45237<=t&&t<=45263||45265<=t&&t<=45291||45293<=t&&t<=45319||45321<=t&&t<=45347||45349<=t&&t<=45375||45377<=t&&t<=45403||45405<=t&&t<=45431||45433<=t&&t<=45459||45461<=t&&t<=45487||45489<=t&&t<=45515||45517<=t&&t<=45543||45545<=t&&t<=45571||45573<=t&&t<=45599||45601<=t&&t<=45627||45629<=t&&t<=45655||45657<=t&&t<=45683||45685<=t&&t<=45711||45713<=t&&t<=45739||45741<=t&&t<=45767||45769<=t&&t<=45795||45797<=t&&t<=45823||45825<=t&&t<=45851||45853<=t&&t<=45879||45881<=t&&t<=45907||45909<=t&&t<=45935||45937<=t&&t<=45963||45965<=t&&t<=45991||45993<=t&&t<=46019||46021<=t&&t<=46047||46049<=t&&t<=46075||46077<=t&&t<=46103||46105<=t&&t<=46131||46133<=t&&t<=46159||46161<=t&&t<=46187||46189<=t&&t<=46215||46217<=t&&t<=46243||46245<=t&&t<=46271||46273<=t&&t<=46299||46301<=t&&t<=46327||46329<=t&&t<=46355||46357<=t&&t<=46383||46385<=t&&t<=46411||46413<=t&&t<=46439||46441<=t&&t<=46467||46469<=t&&t<=46495||46497<=t&&t<=46523||46525<=t&&t<=46551||46553<=t&&t<=46579||46581<=t&&t<=46607||46609<=t&&t<=46635||46637<=t&&t<=46663||46665<=t&&t<=46691||46693<=t&&t<=46719||46721<=t&&t<=46747||46749<=t&&t<=46775||46777<=t&&t<=46803||46805<=t&&t<=46831||46833<=t&&t<=46859||46861<=t&&t<=46887||46889<=t&&t<=46915||46917<=t&&t<=46943||46945<=t&&t<=46971||46973<=t&&t<=46999||47001<=t&&t<=47027||47029<=t&&t<=47055||47057<=t&&t<=47083||47085<=t&&t<=47111||47113<=t&&t<=47139||47141<=t&&t<=47167||47169<=t&&t<=47195||47197<=t&&t<=47223||47225<=t&&t<=47251||47253<=t&&t<=47279||47281<=t&&t<=47307||47309<=t&&t<=47335||47337<=t&&t<=47363||47365<=t&&t<=47391||47393<=t&&t<=47419||47421<=t&&t<=47447||47449<=t&&t<=47475||47477<=t&&t<=47503||47505<=t&&t<=47531||47533<=t&&t<=47559||47561<=t&&t<=47587||47589<=t&&t<=47615||47617<=t&&t<=47643||47645<=t&&t<=47671||47673<=t&&t<=47699||47701<=t&&t<=47727||47729<=t&&t<=47755||47757<=t&&t<=47783||47785<=t&&t<=47811||47813<=t&&t<=47839||47841<=t&&t<=47867||47869<=t&&t<=47895||47897<=t&&t<=47923||47925<=t&&t<=47951||47953<=t&&t<=47979||47981<=t&&t<=48007||48009<=t&&t<=48035||48037<=t&&t<=48063||48065<=t&&t<=48091||48093<=t&&t<=48119||48121<=t&&t<=48147||48149<=t&&t<=48175||48177<=t&&t<=48203||48205<=t&&t<=48231||48233<=t&&t<=48259||48261<=t&&t<=48287||48289<=t&&t<=48315||48317<=t&&t<=48343||48345<=t&&t<=48371||48373<=t&&t<=48399||48401<=t&&t<=48427||48429<=t&&t<=48455||48457<=t&&t<=48483||48485<=t&&t<=48511||48513<=t&&t<=48539||48541<=t&&t<=48567||48569<=t&&t<=48595||48597<=t&&t<=48623||48625<=t&&t<=48651||48653<=t&&t<=48679||48681<=t&&t<=48707||48709<=t&&t<=48735||48737<=t&&t<=48763||48765<=t&&t<=48791||48793<=t&&t<=48819||48821<=t&&t<=48847||48849<=t&&t<=48875||48877<=t&&t<=48903||48905<=t&&t<=48931||48933<=t&&t<=48959||48961<=t&&t<=48987||48989<=t&&t<=49015||49017<=t&&t<=49043||49045<=t&&t<=49071||49073<=t&&t<=49099||49101<=t&&t<=49127||49129<=t&&t<=49155||49157<=t&&t<=49183||49185<=t&&t<=49211||49213<=t&&t<=49239||49241<=t&&t<=49267||49269<=t&&t<=49295||49297<=t&&t<=49323||49325<=t&&t<=49351||49353<=t&&t<=49379||49381<=t&&t<=49407||49409<=t&&t<=49435||49437<=t&&t<=49463||49465<=t&&t<=49491||49493<=t&&t<=49519||49521<=t&&t<=49547||49549<=t&&t<=49575||49577<=t&&t<=49603||49605<=t&&t<=49631||49633<=t&&t<=49659||49661<=t&&t<=49687||49689<=t&&t<=49715||49717<=t&&t<=49743||49745<=t&&t<=49771||49773<=t&&t<=49799||49801<=t&&t<=49827||49829<=t&&t<=49855||49857<=t&&t<=49883||49885<=t&&t<=49911||49913<=t&&t<=49939||49941<=t&&t<=49967||49969<=t&&t<=49995||49997<=t&&t<=50023||50025<=t&&t<=50051||50053<=t&&t<=50079||50081<=t&&t<=50107||50109<=t&&t<=50135||50137<=t&&t<=50163||50165<=t&&t<=50191||50193<=t&&t<=50219||50221<=t&&t<=50247||50249<=t&&t<=50275||50277<=t&&t<=50303||50305<=t&&t<=50331||50333<=t&&t<=50359||50361<=t&&t<=50387||50389<=t&&t<=50415||50417<=t&&t<=50443||50445<=t&&t<=50471||50473<=t&&t<=50499||50501<=t&&t<=50527||50529<=t&&t<=50555||50557<=t&&t<=50583||50585<=t&&t<=50611||50613<=t&&t<=50639||50641<=t&&t<=50667||50669<=t&&t<=50695||50697<=t&&t<=50723||50725<=t&&t<=50751||50753<=t&&t<=50779||50781<=t&&t<=50807||50809<=t&&t<=50835||50837<=t&&t<=50863||50865<=t&&t<=50891||50893<=t&&t<=50919||50921<=t&&t<=50947||50949<=t&&t<=50975||50977<=t&&t<=51003||51005<=t&&t<=51031||51033<=t&&t<=51059||51061<=t&&t<=51087||51089<=t&&t<=51115||51117<=t&&t<=51143||51145<=t&&t<=51171||51173<=t&&t<=51199||51201<=t&&t<=51227||51229<=t&&t<=51255||51257<=t&&t<=51283||51285<=t&&t<=51311||51313<=t&&t<=51339||51341<=t&&t<=51367||51369<=t&&t<=51395||51397<=t&&t<=51423||51425<=t&&t<=51451||51453<=t&&t<=51479||51481<=t&&t<=51507||51509<=t&&t<=51535||51537<=t&&t<=51563||51565<=t&&t<=51591||51593<=t&&t<=51619||51621<=t&&t<=51647||51649<=t&&t<=51675||51677<=t&&t<=51703||51705<=t&&t<=51731||51733<=t&&t<=51759||51761<=t&&t<=51787||51789<=t&&t<=51815||51817<=t&&t<=51843||51845<=t&&t<=51871||51873<=t&&t<=51899||51901<=t&&t<=51927||51929<=t&&t<=51955||51957<=t&&t<=51983||51985<=t&&t<=52011||52013<=t&&t<=52039||52041<=t&&t<=52067||52069<=t&&t<=52095||52097<=t&&t<=52123||52125<=t&&t<=52151||52153<=t&&t<=52179||52181<=t&&t<=52207||52209<=t&&t<=52235||52237<=t&&t<=52263||52265<=t&&t<=52291||52293<=t&&t<=52319||52321<=t&&t<=52347||52349<=t&&t<=52375||52377<=t&&t<=52403||52405<=t&&t<=52431||52433<=t&&t<=52459||52461<=t&&t<=52487||52489<=t&&t<=52515||52517<=t&&t<=52543||52545<=t&&t<=52571||52573<=t&&t<=52599||52601<=t&&t<=52627||52629<=t&&t<=52655||52657<=t&&t<=52683||52685<=t&&t<=52711||52713<=t&&t<=52739||52741<=t&&t<=52767||52769<=t&&t<=52795||52797<=t&&t<=52823||52825<=t&&t<=52851||52853<=t&&t<=52879||52881<=t&&t<=52907||52909<=t&&t<=52935||52937<=t&&t<=52963||52965<=t&&t<=52991||52993<=t&&t<=53019||53021<=t&&t<=53047||53049<=t&&t<=53075||53077<=t&&t<=53103||53105<=t&&t<=53131||53133<=t&&t<=53159||53161<=t&&t<=53187||53189<=t&&t<=53215||53217<=t&&t<=53243||53245<=t&&t<=53271||53273<=t&&t<=53299||53301<=t&&t<=53327||53329<=t&&t<=53355||53357<=t&&t<=53383||53385<=t&&t<=53411||53413<=t&&t<=53439||53441<=t&&t<=53467||53469<=t&&t<=53495||53497<=t&&t<=53523||53525<=t&&t<=53551||53553<=t&&t<=53579||53581<=t&&t<=53607||53609<=t&&t<=53635||53637<=t&&t<=53663||53665<=t&&t<=53691||53693<=t&&t<=53719||53721<=t&&t<=53747||53749<=t&&t<=53775||53777<=t&&t<=53803||53805<=t&&t<=53831||53833<=t&&t<=53859||53861<=t&&t<=53887||53889<=t&&t<=53915||53917<=t&&t<=53943||53945<=t&&t<=53971||53973<=t&&t<=53999||54001<=t&&t<=54027||54029<=t&&t<=54055||54057<=t&&t<=54083||54085<=t&&t<=54111||54113<=t&&t<=54139||54141<=t&&t<=54167||54169<=t&&t<=54195||54197<=t&&t<=54223||54225<=t&&t<=54251||54253<=t&&t<=54279||54281<=t&&t<=54307||54309<=t&&t<=54335||54337<=t&&t<=54363||54365<=t&&t<=54391||54393<=t&&t<=54419||54421<=t&&t<=54447||54449<=t&&t<=54475||54477<=t&&t<=54503||54505<=t&&t<=54531||54533<=t&&t<=54559||54561<=t&&t<=54587||54589<=t&&t<=54615||54617<=t&&t<=54643||54645<=t&&t<=54671||54673<=t&&t<=54699||54701<=t&&t<=54727||54729<=t&&t<=54755||54757<=t&&t<=54783||54785<=t&&t<=54811||54813<=t&&t<=54839||54841<=t&&t<=54867||54869<=t&&t<=54895||54897<=t&&t<=54923||54925<=t&&t<=54951||54953<=t&&t<=54979||54981<=t&&t<=55007||55009<=t&&t<=55035||55037<=t&&t<=55063||55065<=t&&t<=55091||55093<=t&&t<=55119||55121<=t&&t<=55147||55149<=t&&t<=55175||55177<=t&&t<=55203?10:11}var s=function(t){if(/^[\x20-\xFF]*$/.test(t))return t;const i=[];let s,n=0;for(;(s=e(t,n))<t.length;)i.push(t.slice(n,s)),n=s;return n<t.length&&i.push(t.slice(n)),i};class n{constructor(t,e){this.type=t,this.value=e}}class r{constructor(t){this.s=s(t),this.pos=0}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:null}peek(){return this.s[this.pos]}scan(t){let e;return e=t.exec("string"==typeof this.s?this.s.slice(this.pos):this.s.slice(this.pos).join("")),e?(this.pos+=e[0].length,e[0]):null}isWhiteSpace(){return/[ \f\n\r\t\v\xA0\u2028\u2029]/.test(this.s[this.pos])}makeToken(){if(this.end())return null;if(this.isWhiteSpace())return this.get(),new n("space");let t=null;if("\\"===this.peek()){if(this.get(),!this.end()){let e=this.scan(/^[a-zA-Z*]+/);"bgroup"===e?t=new n("{"):"egroup"===e?t=new n("}"):(e||(e=this.get()),t=new n("command",e))}}else if("{"===this.peek()||"}"===this.peek())t=new n(this.get());else if("#"===this.peek()){if(this.get(),!this.end()){let e=!1,i=this.peek();/[0-9?]/.test(i)&&(e=!0,this.pos+1<this.s.length)&&(e=/[^0-9A-Za-z]/.test(this.s[this.pos+1])),e?(t=new n("#"),i=this.get(),t.value=i>="0"&&i<="9"?parseInt(i):"?"):t=new n("literal","#")}}else"~"===this.peek()?(this.get(),t=new n("command","space")):"$"===this.peek()?(this.get(),"$"===this.peek()?(this.get(),t=new n("$$")):t=new n("$")):t=new n("literal",this.get());return t}}var o=function(t){const e=[],i=t.toString().split(/\r?\n/);let s="",n="";for(const r of i){s+=n,n=" ";const t=r.match(/((?:\\%)|[^%])*/);t&&(s+=t[0])}const o=new r(s);for(;!o.end();){const t=o.makeToken();t&&e.push(t)}return e},a={"AMS-Regular":{65:[0,.68889,0,0],66:[0,.68889,0,0],67:[0,.68889,0,0],68:[0,.68889,0,0],69:[0,.68889,0,0],70:[0,.68889,0,0],71:[0,.68889,0,0],72:[0,.68889,0,0],73:[0,.68889,0,0],74:[.16667,.68889,0,0],75:[0,.68889,0,0],76:[0,.68889,0,0],77:[0,.68889,0,0],78:[0,.68889,0,0],79:[.16667,.68889,0,0],80:[0,.68889,0,0],81:[.16667,.68889,0,0],82:[0,.68889,0,0],83:[0,.68889,0,0],84:[0,.68889,0,0],85:[0,.68889,0,0],86:[0,.68889,0,0],87:[0,.68889,0,0],88:[0,.68889,0,0],89:[0,.68889,0,0],90:[0,.68889,0,0],107:[0,.68889,0,0],165:[0,.675,.025,0],174:[.15559,.69224,0,0],240:[0,.68889,0,0],295:[0,.68889,0,0],710:[0,.825,0,0],732:[0,.9,0,0],770:[0,.825,0,0],771:[0,.9,0,0],989:[.08167,.58167,0,0],1008:[0,.43056,.04028,0],8245:[0,.54986,0,0],8463:[0,.68889,0,0],8487:[0,.68889,0,0],8498:[0,.68889,0,0],8502:[0,.68889,0,0],8503:[0,.68889,0,0],8504:[0,.68889,0,0],8513:[0,.68889,0,0],8592:[-.03598,.46402,0,0],8594:[-.03598,.46402,0,0],8602:[-.13313,.36687,0,0],8603:[-.13313,.36687,0,0],8606:[.01354,.52239,0,0],8608:[.01354,.52239,0,0],8610:[.01354,.52239,0,0],8611:[.01354,.52239,0,0],8619:[0,.54986,0,0],8620:[0,.54986,0,0],8621:[-.13313,.37788,0,0],8622:[-.13313,.36687,0,0],8624:[0,.69224,0,0],8625:[0,.69224,0,0],8630:[0,.43056,0,0],8631:[0,.43056,0,0],8634:[.08198,.58198,0,0],8635:[.08198,.58198,0,0],8638:[.19444,.69224,0,0],8639:[.19444,.69224,0,0],8642:[.19444,.69224,0,0],8643:[.19444,.69224,0,0],8644:[.1808,.675,0,0],8646:[.1808,.675,0,0],8647:[.1808,.675,0,0],8648:[.19444,.69224,0,0],8649:[.1808,.675,0,0],8650:[.19444,.69224,0,0],8651:[.01354,.52239,0,0],8652:[.01354,.52239,0,0],8653:[-.13313,.36687,0,0],8654:[-.13313,.36687,0,0],8655:[-.13313,.36687,0,0],8666:[.13667,.63667,0,0],8667:[.13667,.63667,0,0],8669:[-.13313,.37788,0,0],8672:[-.064,.437,0,0],8674:[-.064,.437,0,0],8705:[0,.825,0,0],8708:[0,.68889,0,0],8709:[.08167,.58167,0,0],8717:[0,.43056,0,0],8722:[-.03598,.46402,0,0],8724:[.08198,.69224,0,0],8726:[.08167,.58167,0,0],8733:[0,.69224,0,0],8736:[0,.69224,0,0],8737:[0,.69224,0,0],8738:[.03517,.52239,0,0],8739:[.08167,.58167,0,0],8740:[.25142,.74111,0,0],8741:[.08167,.58167,0,0],8742:[.25142,.74111,0,0],8756:[0,.69224,0,0],8757:[0,.69224,0,0],8764:[-.13313,.36687,0,0],8765:[-.13313,.37788,0,0],8769:[-.13313,.36687,0,0],8770:[-.03625,.46375,0,0],8774:[.30274,.79383,0,0],8776:[-.01688,.48312,0,0],8778:[.08167,.58167,0,0],8782:[.06062,.54986,0,0],8783:[.06062,.54986,0,0],8785:[.08198,.58198,0,0],8786:[.08198,.58198,0,0],8787:[.08198,.58198,0,0],8790:[0,.69224,0,0],8791:[.22958,.72958,0,0],8796:[.08198,.91667,0,0],8806:[.25583,.75583,0,0],8807:[.25583,.75583,0,0],8808:[.25142,.75726,0,0],8809:[.25142,.75726,0,0],8812:[.25583,.75583,0,0],8814:[.20576,.70576,0,0],8815:[.20576,.70576,0,0],8816:[.30274,.79383,0,0],8817:[.30274,.79383,0,0],8818:[.22958,.72958,0,0],8819:[.22958,.72958,0,0],8822:[.1808,.675,0,0],8823:[.1808,.675,0,0],8828:[.13667,.63667,0,0],8829:[.13667,.63667,0,0],8830:[.22958,.72958,0,0],8831:[.22958,.72958,0,0],8832:[.20576,.70576,0,0],8833:[.20576,.70576,0,0],8840:[.30274,.79383,0,0],8841:[.30274,.79383,0,0],8842:[.13597,.63597,0,0],8843:[.13597,.63597,0,0],8847:[.03517,.54986,0,0],8848:[.03517,.54986,0,0],8858:[.08198,.58198,0,0],8859:[.08198,.58198,0,0],8861:[.08198,.58198,0,0],8862:[0,.675,0,0],8863:[0,.675,0,0],8864:[0,.675,0,0],8865:[0,.675,0,0],8872:[0,.69224,0,0],8873:[0,.69224,0,0],8874:[0,.69224,0,0],8876:[0,.68889,0,0],8877:[0,.68889,0,0],8878:[0,.68889,0,0],8879:[0,.68889,0,0],8882:[.03517,.54986,0,0],8883:[.03517,.54986,0,0],8884:[.13667,.63667,0,0],8885:[.13667,.63667,0,0],8888:[0,.54986,0,0],8890:[.19444,.43056,0,0],8891:[.19444,.69224,0,0],8892:[.19444,.69224,0,0],8901:[0,.54986,0,0],8903:[.08167,.58167,0,0],8905:[.08167,.58167,0,0],8906:[.08167,.58167,0,0],8907:[0,.69224,0,0],8908:[0,.69224,0,0],8909:[-.03598,.46402,0,0],8910:[0,.54986,0,0],8911:[0,.54986,0,0],8912:[.03517,.54986,0,0],8913:[.03517,.54986,0,0],8914:[0,.54986,0,0],8915:[0,.54986,0,0],8916:[0,.69224,0,0],8918:[.0391,.5391,0,0],8919:[.0391,.5391,0,0],8920:[.03517,.54986,0,0],8921:[.03517,.54986,0,0],8922:[.38569,.88569,0,0],8923:[.38569,.88569,0,0],8926:[.13667,.63667,0,0],8927:[.13667,.63667,0,0],8928:[.30274,.79383,0,0],8929:[.30274,.79383,0,0],8934:[.23222,.74111,0,0],8935:[.23222,.74111,0,0],8936:[.23222,.74111,0,0],8937:[.23222,.74111,0,0],8938:[.20576,.70576,0,0],8939:[.20576,.70576,0,0],8940:[.30274,.79383,0,0],8941:[.30274,.79383,0,0],8994:[.19444,.69224,0,0],8995:[.19444,.69224,0,0],9416:[.15559,.69224,0,0],9484:[0,.69224,0,0],9488:[0,.69224,0,0],9492:[0,.37788,0,0],9496:[0,.37788,0,0],9585:[.19444,.68889,0,0],9586:[.19444,.74111,0,0],9632:[0,.675,0,0],9633:[0,.675,0,0],9650:[0,.54986,0,0],9651:[0,.54986,0,0],9654:[.03517,.54986,0,0],9660:[0,.54986,0,0],9661:[0,.54986,0,0],9664:[.03517,.54986,0,0],9674:[.11111,.69224,0,0],9733:[.19444,.69224,0,0],10003:[0,.69224,0,0],10016:[0,.69224,0,0],10731:[.11111,.69224,0,0],10846:[.19444,.75583,0,0],10877:[.13667,.63667,0,0],10878:[.13667,.63667,0,0],10885:[.25583,.75583,0,0],10886:[.25583,.75583,0,0],10887:[.13597,.63597,0,0],10888:[.13597,.63597,0,0],10889:[.26167,.75726,0,0],10890:[.26167,.75726,0,0],10891:[.48256,.98256,0,0],10892:[.48256,.98256,0,0],10901:[.13667,.63667,0,0],10902:[.13667,.63667,0,0],10933:[.25142,.75726,0,0],10934:[.25142,.75726,0,0],10935:[.26167,.75726,0,0],10936:[.26167,.75726,0,0],10937:[.26167,.75726,0,0],10938:[.26167,.75726,0,0],10949:[.25583,.75583,0,0],10950:[.25583,.75583,0,0],10955:[.28481,.79383,0,0],10956:[.28481,.79383,0,0],57350:[.08167,.58167,0,0],57351:[.08167,.58167,0,0],57352:[.08167,.58167,0,0],57353:[0,.43056,.04028,0],57356:[.25142,.75726,0,0],57357:[.25142,.75726,0,0],57358:[.41951,.91951,0,0],57359:[.30274,.79383,0,0],57360:[.30274,.79383,0,0],57361:[.41951,.91951,0,0],57366:[.25142,.75726,0,0],57367:[.25142,.75726,0,0],57368:[.25142,.75726,0,0],57369:[.25142,.75726,0,0],57370:[.13597,.63597,0,0],57371:[.13597,.63597,0,0]},"Caligraphic-Regular":{48:[0,.43056,0,0],49:[0,.43056,0,0],50:[0,.43056,0,0],51:[.19444,.43056,0,0],52:[.19444,.43056,0,0],53:[.19444,.43056,0,0],54:[0,.64444,0,0],55:[.19444,.43056,0,0],56:[0,.64444,0,0],57:[.19444,.43056,0,0],65:[0,.68333,0,.19445],66:[0,.68333,.03041,.13889],67:[0,.68333,.05834,.13889],68:[0,.68333,.02778,.08334],69:[0,.68333,.08944,.11111],70:[0,.68333,.09931,.11111],71:[.09722,.68333,.0593,.11111],72:[0,.68333,.00965,.11111],73:[0,.68333,.07382,0],74:[.09722,.68333,.18472,.16667],75:[0,.68333,.01445,.05556],76:[0,.68333,0,.13889],77:[0,.68333,0,.13889],78:[0,.68333,.14736,.08334],79:[0,.68333,.02778,.11111],80:[0,.68333,.08222,.08334],81:[.09722,.68333,0,.11111],82:[0,.68333,0,.08334],83:[0,.68333,.075,.13889],84:[0,.68333,.25417,0],85:[0,.68333,.09931,.08334],86:[0,.68333,.08222,0],87:[0,.68333,.08222,.08334],88:[0,.68333,.14643,.13889],89:[.09722,.68333,.08222,.08334],90:[0,.68333,.07944,.13889]},"Fraktur-Regular":{33:[0,.69141,0,0],34:[0,.69141,0,0],38:[0,.69141,0,0],39:[0,.69141,0,0],40:[.24982,.74947,0,0],41:[.24982,.74947,0,0],42:[0,.62119,0,0],43:[.08319,.58283,0,0],44:[0,.10803,0,0],45:[.08319,.58283,0,0],46:[0,.10803,0,0],47:[.24982,.74947,0,0],48:[0,.47534,0,0],49:[0,.47534,0,0],50:[0,.47534,0,0],51:[.18906,.47534,0,0],52:[.18906,.47534,0,0],53:[.18906,.47534,0,0],54:[0,.69141,0,0],55:[.18906,.47534,0,0],56:[0,.69141,0,0],57:[.18906,.47534,0,0],58:[0,.47534,0,0],59:[.12604,.47534,0,0],61:[-.13099,.36866,0,0],63:[0,.69141,0,0],65:[0,.69141,0,0],66:[0,.69141,0,0],67:[0,.69141,0,0],68:[0,.69141,0,0],69:[0,.69141,0,0],70:[.12604,.69141,0,0],71:[0,.69141,0,0],72:[.06302,.69141,0,0],73:[0,.69141,0,0],74:[.12604,.69141,0,0],75:[0,.69141,0,0],76:[0,.69141,0,0],77:[0,.69141,0,0],78:[0,.69141,0,0],79:[0,.69141,0,0],80:[.18906,.69141,0,0],81:[.03781,.69141,0,0],82:[0,.69141,0,0],83:[0,.69141,0,0],84:[0,.69141,0,0],85:[0,.69141,0,0],86:[0,.69141,0,0],87:[0,.69141,0,0],88:[0,.69141,0,0],89:[.18906,.69141,0,0],90:[.12604,.69141,0,0],91:[.24982,.74947,0,0],93:[.24982,.74947,0,0],94:[0,.69141,0,0],97:[0,.47534,0,0],98:[0,.69141,0,0],99:[0,.47534,0,0],100:[0,.62119,0,0],101:[0,.47534,0,0],102:[.18906,.69141,0,0],103:[.18906,.47534,0,0],104:[.18906,.69141,0,0],105:[0,.69141,0,0],106:[0,.69141,0,0],107:[0,.69141,0,0],108:[0,.69141,0,0],109:[0,.47534,0,0],110:[0,.47534,0,0],111:[0,.47534,0,0],112:[.18906,.52396,0,0],113:[.18906,.47534,0,0],114:[0,.47534,0,0],115:[0,.47534,0,0],116:[0,.62119,0,0],117:[0,.47534,0,0],118:[0,.52396,0,0],119:[0,.52396,0,0],120:[.18906,.47534,0,0],121:[.18906,.47534,0,0],122:[.18906,.47534,0,0],8216:[0,.69141,0,0],8217:[0,.69141,0,0],58112:[0,.62119,0,0],58113:[0,.62119,0,0],58114:[.18906,.69141,0,0],58115:[.18906,.69141,0,0],58116:[.18906,.47534,0,0],58117:[0,.69141,0,0],58118:[0,.62119,0,0],58119:[0,.47534,0,0]},"Main-Bold":{33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.13333,.63333,0,0],44:[.19444,.15556,0,0],45:[0,.44444,0,0],46:[0,.15556,0,0],47:[.25,.75,0,0],48:[0,.64444,0,0],49:[0,.64444,0,0],50:[0,.64444,0,0],51:[0,.64444,0,0],52:[0,.64444,0,0],53:[0,.64444,0,0],54:[0,.64444,0,0],55:[0,.64444,0,0],56:[0,.64444,0,0],57:[0,.64444,0,0],58:[0,.44444,0,0],59:[.19444,.44444,0,0],60:[.08556,.58556,0,0],61:[-.10889,.39111,0,0],62:[.08556,.58556,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.68611,0,0],66:[0,.68611,0,0],67:[0,.68611,0,0],68:[0,.68611,0,0],69:[0,.68611,0,0],70:[0,.68611,0,0],71:[0,.68611,0,0],72:[0,.68611,0,0],73:[0,.68611,0,0],74:[0,.68611,0,0],75:[0,.68611,0,0],76:[0,.68611,0,0],77:[0,.68611,0,0],78:[0,.68611,0,0],79:[0,.68611,0,0],80:[0,.68611,0,0],81:[.19444,.68611,0,0],82:[0,.68611,0,0],83:[0,.68611,0,0],84:[0,.68611,0,0],85:[0,.68611,0,0],86:[0,.68611,.01597,0],87:[0,.68611,.01597,0],88:[0,.68611,0,0],89:[0,.68611,.02875,0],90:[0,.68611,0,0],91:[.25,.75,0,0],92:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.31,.13444,.03194,0],96:[0,.69444,0,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[0,.69444,.10903,0],103:[.19444,.44444,.01597,0],104:[0,.69444,0,0],105:[0,.69444,0,0],106:[.19444,.69444,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,0,0],114:[0,.44444,0,0],115:[0,.44444,0,0],116:[0,.63492,0,0],117:[0,.44444,0,0],118:[0,.44444,.01597,0],119:[0,.44444,.01597,0],120:[0,.44444,0,0],121:[.19444,.44444,.01597,0],122:[0,.44444,0,0],123:[.25,.75,0,0],124:[.25,.75,0,0],125:[.25,.75,0,0],126:[.35,.34444,0,0],168:[0,.69444,0,0],172:[0,.44444,0,0],175:[0,.59611,0,0],176:[0,.69444,0,0],177:[.13333,.63333,0,0],180:[0,.69444,0,0],215:[.13333,.63333,0,0],247:[.13333,.63333,0,0],305:[0,.44444,0,0],567:[.19444,.44444,0,0],710:[0,.69444,0,0],711:[0,.63194,0,0],713:[0,.59611,0,0],714:[0,.69444,0,0],715:[0,.69444,0,0],728:[0,.69444,0,0],729:[0,.69444,0,0],730:[0,.69444,0,0],732:[0,.69444,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.69444,0,0],772:[0,.59611,0,0],774:[0,.69444,0,0],775:[0,.69444,0,0],776:[0,.69444,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.63194,0,0],824:[.19444,.69444,0,0],915:[0,.68611,0,0],916:[0,.68611,0,0],920:[0,.68611,0,0],923:[0,.68611,0,0],926:[0,.68611,0,0],928:[0,.68611,0,0],931:[0,.68611,0,0],933:[0,.68611,0,0],934:[0,.68611,0,0],936:[0,.68611,0,0],937:[0,.68611,0,0],8211:[0,.44444,.03194,0],8212:[0,.44444,.03194,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0],8224:[.19444,.69444,0,0],8225:[.19444,.69444,0,0],8242:[0,.55556,0,0],8407:[0,.72444,.15486,0],8463:[0,.69444,0,0],8465:[0,.69444,0,0],8467:[0,.69444,0,0],8472:[.19444,.44444,0,0],8476:[0,.69444,0,0],8501:[0,.69444,0,0],8592:[-.10889,.39111,0,0],8593:[.19444,.69444,0,0],8594:[-.10889,.39111,0,0],8595:[.19444,.69444,0,0],8596:[-.10889,.39111,0,0],8597:[.25,.75,0,0],8598:[.19444,.69444,0,0],8599:[.19444,.69444,0,0],8600:[.19444,.69444,0,0],8601:[.19444,.69444,0,0],8636:[-.10889,.39111,0,0],8637:[-.10889,.39111,0,0],8640:[-.10889,.39111,0,0],8641:[-.10889,.39111,0,0],8656:[-.10889,.39111,0,0],8657:[.19444,.69444,0,0],8658:[-.10889,.39111,0,0],8659:[.19444,.69444,0,0],8660:[-.10889,.39111,0,0],8661:[.25,.75,0,0],8704:[0,.69444,0,0],8706:[0,.69444,.06389,0],8707:[0,.69444,0,0],8709:[.05556,.75,0,0],8711:[0,.68611,0,0],8712:[.08556,.58556,0,0],8715:[.08556,.58556,0,0],8722:[.13333,.63333,0,0],8723:[.13333,.63333,0,0],8725:[.25,.75,0,0],8726:[.25,.75,0,0],8727:[-.02778,.47222,0,0],8728:[-.02639,.47361,0,0],8729:[-.02639,.47361,0,0],8730:[.18,.82,0,0],8733:[0,.44444,0,0],8734:[0,.44444,0,0],8736:[0,.69224,0,0],8739:[.25,.75,0,0],8741:[.25,.75,0,0],8743:[0,.55556,0,0],8744:[0,.55556,0,0],8745:[0,.55556,0,0],8746:[0,.55556,0,0],8747:[.19444,.69444,.12778,0],8764:[-.10889,.39111,0,0],8768:[.19444,.69444,0,0],8771:[.00222,.50222,0,0],8776:[.02444,.52444,0,0],8781:[.00222,.50222,0,0],8801:[.00222,.50222,0,0],8804:[.19667,.69667,0,0],8805:[.19667,.69667,0,0],8810:[.08556,.58556,0,0],8811:[.08556,.58556,0,0],8826:[.08556,.58556,0,0],8827:[.08556,.58556,0,0],8834:[.08556,.58556,0,0],8835:[.08556,.58556,0,0],8838:[.19667,.69667,0,0],8839:[.19667,.69667,0,0],8846:[0,.55556,0,0],8849:[.19667,.69667,0,0],8850:[.19667,.69667,0,0],8851:[0,.55556,0,0],8852:[0,.55556,0,0],8853:[.13333,.63333,0,0],8854:[.13333,.63333,0,0],8855:[.13333,.63333,0,0],8856:[.13333,.63333,0,0],8857:[.13333,.63333,0,0],8866:[0,.69444,0,0],8867:[0,.69444,0,0],8868:[0,.69444,0,0],8869:[0,.69444,0,0],8900:[-.02639,.47361,0,0],8901:[-.02639,.47361,0,0],8902:[-.02778,.47222,0,0],8968:[.25,.75,0,0],8969:[.25,.75,0,0],8970:[.25,.75,0,0],8971:[.25,.75,0,0],8994:[-.13889,.36111,0,0],8995:[-.13889,.36111,0,0],9651:[.19444,.69444,0,0],9657:[-.02778,.47222,0,0],9661:[.19444,.69444,0,0],9667:[-.02778,.47222,0,0],9711:[.19444,.69444,0,0],9824:[.12963,.69444,0,0],9825:[.12963,.69444,0,0],9826:[.12963,.69444,0,0],9827:[.12963,.69444,0,0],9837:[0,.75,0,0],9838:[.19444,.69444,0,0],9839:[.19444,.69444,0,0],10216:[.25,.75,0,0],10217:[.25,.75,0,0],10815:[0,.68611,0,0],10927:[.19667,.69667,0,0],10928:[.19667,.69667,0,0]},"Main-Italic":{33:[0,.69444,.12417,0],34:[0,.69444,.06961,0],35:[.19444,.69444,.06616,0],37:[.05556,.75,.13639,0],38:[0,.69444,.09694,0],39:[0,.69444,.12417,0],40:[.25,.75,.16194,0],41:[.25,.75,.03694,0],42:[0,.75,.14917,0],43:[.05667,.56167,.03694,0],44:[.19444,.10556,0,0],45:[0,.43056,.02826,0],46:[0,.10556,0,0],47:[.25,.75,.16194,0],48:[0,.64444,.13556,0],49:[0,.64444,.13556,0],50:[0,.64444,.13556,0],51:[0,.64444,.13556,0],52:[.19444,.64444,.13556,0],53:[0,.64444,.13556,0],54:[0,.64444,.13556,0],55:[.19444,.64444,.13556,0],56:[0,.64444,.13556,0],57:[0,.64444,.13556,0],58:[0,.43056,.0582,0],59:[.19444,.43056,.0582,0],61:[-.13313,.36687,.06616,0],63:[0,.69444,.1225,0],64:[0,.69444,.09597,0],65:[0,.68333,0,0],66:[0,.68333,.10257,0],67:[0,.68333,.14528,0],68:[0,.68333,.09403,0],69:[0,.68333,.12028,0],70:[0,.68333,.13305,0],71:[0,.68333,.08722,0],72:[0,.68333,.16389,0],73:[0,.68333,.15806,0],74:[0,.68333,.14028,0],75:[0,.68333,.14528,0],76:[0,.68333,0,0],77:[0,.68333,.16389,0],78:[0,.68333,.16389,0],79:[0,.68333,.09403,0],80:[0,.68333,.10257,0],81:[.19444,.68333,.09403,0],82:[0,.68333,.03868,0],83:[0,.68333,.11972,0],84:[0,.68333,.13305,0],85:[0,.68333,.16389,0],86:[0,.68333,.18361,0],87:[0,.68333,.18361,0],88:[0,.68333,.15806,0],89:[0,.68333,.19383,0],90:[0,.68333,.14528,0],91:[.25,.75,.1875,0],93:[.25,.75,.10528,0],94:[0,.69444,.06646,0],95:[.31,.12056,.09208,0],97:[0,.43056,.07671,0],98:[0,.69444,.06312,0],99:[0,.43056,.05653,0],100:[0,.69444,.10333,0],101:[0,.43056,.07514,0],102:[.19444,.69444,.21194,0],103:[.19444,.43056,.08847,0],104:[0,.69444,.07671,0],105:[0,.65536,.1019,0],106:[.19444,.65536,.14467,0],107:[0,.69444,.10764,0],108:[0,.69444,.10333,0],109:[0,.43056,.07671,0],110:[0,.43056,.07671,0],111:[0,.43056,.06312,0],112:[.19444,.43056,.06312,0],113:[.19444,.43056,.08847,0],114:[0,.43056,.10764,0],115:[0,.43056,.08208,0],116:[0,.61508,.09486,0],117:[0,.43056,.07671,0],118:[0,.43056,.10764,0],119:[0,.43056,.10764,0],120:[0,.43056,.12042,0],121:[.19444,.43056,.08847,0],122:[0,.43056,.12292,0],126:[.35,.31786,.11585,0],163:[0,.69444,0,0],305:[0,.43056,0,.02778],567:[.19444,.43056,0,.08334],768:[0,.69444,0,0],769:[0,.69444,.09694,0],770:[0,.69444,.06646,0],771:[0,.66786,.11585,0],772:[0,.56167,.10333,0],774:[0,.69444,.10806,0],775:[0,.66786,.11752,0],776:[0,.66786,.10474,0],778:[0,.69444,0,0],779:[0,.69444,.1225,0],780:[0,.62847,.08295,0],915:[0,.68333,.13305,0],916:[0,.68333,0,0],920:[0,.68333,.09403,0],923:[0,.68333,0,0],926:[0,.68333,.15294,0],928:[0,.68333,.16389,0],931:[0,.68333,.12028,0],933:[0,.68333,.11111,0],934:[0,.68333,.05986,0],936:[0,.68333,.11111,0],937:[0,.68333,.10257,0],8211:[0,.43056,.09208,0],8212:[0,.43056,.09208,0],8216:[0,.69444,.12417,0],8217:[0,.69444,.12417,0],8220:[0,.69444,.1685,0],8221:[0,.69444,.06961,0],8463:[0,.68889,0,0]},"Main-Regular":{32:[0,0,0,0],33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.08333,.58333,0,0],44:[.19444,.10556,0,0],45:[0,.43056,0,0],46:[0,.10556,0,0],47:[.25,.75,0,0],48:[0,.64444,0,0],49:[0,.64444,0,0],50:[0,.64444,0,0],51:[0,.64444,0,0],52:[0,.64444,0,0],53:[0,.64444,0,0],54:[0,.64444,0,0],55:[0,.64444,0,0],56:[0,.64444,0,0],57:[0,.64444,0,0],58:[0,.43056,0,0],59:[.19444,.43056,0,0],60:[.0391,.5391,0,0],61:[-.13313,.36687,0,0],62:[.0391,.5391,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.68333,0,0],66:[0,.68333,0,0],67:[0,.68333,0,0],68:[0,.68333,0,0],69:[0,.68333,0,0],70:[0,.68333,0,0],71:[0,.68333,0,0],72:[0,.68333,0,0],73:[0,.68333,0,0],74:[0,.68333,0,0],75:[0,.68333,0,0],76:[0,.68333,0,0],77:[0,.68333,0,0],78:[0,.68333,0,0],79:[0,.68333,0,0],80:[0,.68333,0,0],81:[.19444,.68333,0,0],82:[0,.68333,0,0],83:[0,.68333,0,0],84:[0,.68333,0,0],85:[0,.68333,0,0],86:[0,.68333,.01389,0],87:[0,.68333,.01389,0],88:[0,.68333,0,0],89:[0,.68333,.025,0],90:[0,.68333,0,0],91:[.25,.75,0,0],92:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.31,.12056,.02778,0],96:[0,.69444,0,0],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,0],100:[0,.69444,0,0],101:[0,.43056,0,0],102:[0,.69444,.07778,0],103:[.19444,.43056,.01389,0],104:[0,.69444,0,0],105:[0,.66786,0,0],106:[.19444,.66786,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,0],112:[.19444,.43056,0,0],113:[.19444,.43056,0,0],114:[0,.43056,0,0],115:[0,.43056,0,0],116:[0,.61508,0,0],117:[0,.43056,0,0],118:[0,.43056,.01389,0],119:[0,.43056,.01389,0],120:[0,.43056,0,0],121:[.19444,.43056,.01389,0],122:[0,.43056,0,0],123:[.25,.75,0,0],124:[.25,.75,0,0],125:[.25,.75,0,0],126:[.35,.31786,0,0],160:[0,0,0,0],168:[0,.66786,0,0],172:[0,.43056,0,0],175:[0,.56778,0,0],176:[0,.69444,0,0],177:[.08333,.58333,0,0],180:[0,.69444,0,0],215:[.08333,.58333,0,0],247:[.08333,.58333,0,0],305:[0,.43056,0,0],567:[.19444,.43056,0,0],710:[0,.69444,0,0],711:[0,.62847,0,0],713:[0,.56778,0,0],714:[0,.69444,0,0],715:[0,.69444,0,0],728:[0,.69444,0,0],729:[0,.66786,0,0],730:[0,.69444,0,0],732:[0,.66786,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.66786,0,0],772:[0,.56778,0,0],774:[0,.69444,0,0],775:[0,.66786,0,0],776:[0,.66786,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.62847,0,0],824:[.19444,.69444,0,0],915:[0,.68333,0,0],916:[0,.68333,0,0],920:[0,.68333,0,0],923:[0,.68333,0,0],926:[0,.68333,0,0],928:[0,.68333,0,0],931:[0,.68333,0,0],933:[0,.68333,0,0],934:[0,.68333,0,0],936:[0,.68333,0,0],937:[0,.68333,0,0],8211:[0,.43056,.02778,0],8212:[0,.43056,.02778,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0],8224:[.19444,.69444,0,0],8225:[.19444,.69444,0,0],8230:[0,.12,0,0],8242:[0,.55556,0,0],8407:[0,.71444,.15382,0],8463:[0,.68889,0,0],8465:[0,.69444,0,0],8467:[0,.69444,0,.11111],8472:[.19444,.43056,0,.11111],8476:[0,.69444,0,0],8501:[0,.69444,0,0],8592:[-.13313,.36687,0,0],8593:[.19444,.69444,0,0],8594:[-.13313,.36687,0,0],8595:[.19444,.69444,0,0],8596:[-.13313,.36687,0,0],8597:[.25,.75,0,0],8598:[.19444,.69444,0,0],8599:[.19444,.69444,0,0],8600:[.19444,.69444,0,0],8601:[.19444,.69444,0,0],8614:[.011,.511,0,0],8617:[.011,.511,0,0],8618:[.011,.511,0,0],8636:[-.13313,.36687,0,0],8637:[-.13313,.36687,0,0],8640:[-.13313,.36687,0,0],8641:[-.13313,.36687,0,0],8652:[.011,.671,0,0],8656:[-.13313,.36687,0,0],8657:[.19444,.69444,0,0],8658:[-.13313,.36687,0,0],8659:[.19444,.69444,0,0],8660:[-.13313,.36687,0,0],8661:[.25,.75,0,0],8704:[0,.69444,0,0],8706:[0,.69444,.05556,.08334],8707:[0,.69444,0,0],8709:[.05556,.75,0,0],8711:[0,.68333,0,0],8712:[.0391,.5391,0,0],8715:[.0391,.5391,0,0],8722:[.08333,.58333,0,0],8723:[.08333,.58333,0,0],8725:[.25,.75,0,0],8726:[.25,.75,0,0],8727:[-.03472,.46528,0,0],8728:[-.05555,.44445,0,0],8729:[-.05555,.44445,0,0],8730:[.2,.8,0,0],8733:[0,.43056,0,0],8734:[0,.43056,0,0],8736:[0,.69224,0,0],8739:[.25,.75,0,0],8741:[.25,.75,0,0],8743:[0,.55556,0,0],8744:[0,.55556,0,0],8745:[0,.55556,0,0],8746:[0,.55556,0,0],8747:[.19444,.69444,.11111,0],8764:[-.13313,.36687,0,0],8768:[.19444,.69444,0,0],8771:[-.03625,.46375,0,0],8773:[-.022,.589,0,0],8776:[-.01688,.48312,0,0],8781:[-.03625,.46375,0,0],8784:[-.133,.67,0,0],8800:[.215,.716,0,0],8801:[-.03625,.46375,0,0],8804:[.13597,.63597,0,0],8805:[.13597,.63597,0,0],8810:[.0391,.5391,0,0],8811:[.0391,.5391,0,0],8826:[.0391,.5391,0,0],8827:[.0391,.5391,0,0],8834:[.0391,.5391,0,0],8835:[.0391,.5391,0,0],8838:[.13597,.63597,0,0],8839:[.13597,.63597,0,0],8846:[0,.55556,0,0],8849:[.13597,.63597,0,0],8850:[.13597,.63597,0,0],8851:[0,.55556,0,0],8852:[0,.55556,0,0],8853:[.08333,.58333,0,0],8854:[.08333,.58333,0,0],8855:[.08333,.58333,0,0],8856:[.08333,.58333,0,0],8857:[.08333,.58333,0,0],8866:[0,.69444,0,0],8867:[0,.69444,0,0],8868:[0,.69444,0,0],8869:[0,.69444,0,0],8872:[.249,.75,0,0],8900:[-.05555,.44445,0,0],8901:[-.05555,.44445,0,0],8902:[-.03472,.46528,0,0],8904:[.005,.505,0,0],8942:[.03,.9,0,0],8943:[-.19,.31,0,0],8945:[-.1,.82,0,0],8968:[.25,.75,0,0],8969:[.25,.75,0,0],8970:[.25,.75,0,0],8971:[.25,.75,0,0],8994:[-.14236,.35764,0,0],8995:[-.14236,.35764,0,0],9136:[.244,.744,0,0],9137:[.244,.744,0,0],9651:[.19444,.69444,0,0],9657:[-.03472,.46528,0,0],9661:[.19444,.69444,0,0],9667:[-.03472,.46528,0,0],9711:[.19444,.69444,0,0],9824:[.12963,.69444,0,0],9825:[.12963,.69444,0,0],9826:[.12963,.69444,0,0],9827:[.12963,.69444,0,0],9837:[0,.75,0,0],9838:[.19444,.69444,0,0],9839:[.19444,.69444,0,0],10216:[.25,.75,0,0],10217:[.25,.75,0,0],10222:[.244,.744,0,0],10223:[.244,.744,0,0],10229:[.011,.511,0,0],10230:[.011,.511,0,0],10231:[.011,.511,0,0],10232:[.024,.525,0,0],10233:[.024,.525,0,0],10234:[.024,.525,0,0],10236:[.011,.511,0,0],10815:[0,.68333,0,0],10927:[.13597,.63597,0,0],10928:[.13597,.63597,0,0]},"Math-BoldItalic":{47:[.19444,.69444,0,0],65:[0,.68611,0,0],66:[0,.68611,.04835,0],67:[0,.68611,.06979,0],68:[0,.68611,.03194,0],69:[0,.68611,.05451,0],70:[0,.68611,.15972,0],71:[0,.68611,0,0],72:[0,.68611,.08229,0],73:[0,.68611,.07778,0],74:[0,.68611,.10069,0],75:[0,.68611,.06979,0],76:[0,.68611,0,0],77:[0,.68611,.11424,0],78:[0,.68611,.11424,0],79:[0,.68611,.03194,0],80:[0,.68611,.15972,0],81:[.19444,.68611,0,0],82:[0,.68611,.00421,0],83:[0,.68611,.05382,0],84:[0,.68611,.15972,0],85:[0,.68611,.11424,0],86:[0,.68611,.25555,0],87:[0,.68611,.15972,0],88:[0,.68611,.07778,0],89:[0,.68611,.25555,0],90:[0,.68611,.06979,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[.19444,.69444,.11042,0],103:[.19444,.44444,.03704,0],104:[0,.69444,0,0],105:[0,.69326,0,0],106:[.19444,.69326,.0622,0],107:[0,.69444,.01852,0],108:[0,.69444,.0088,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,.03704,0],114:[0,.44444,.03194,0],115:[0,.44444,0,0],116:[0,.63492,0,0],117:[0,.44444,0,0],118:[0,.44444,.03704,0],119:[0,.44444,.02778,0],120:[0,.44444,0,0],121:[.19444,.44444,.03704,0],122:[0,.44444,.04213,0],915:[0,.68611,.15972,0],916:[0,.68611,0,0],920:[0,.68611,.03194,0],923:[0,.68611,0,0],926:[0,.68611,.07458,0],928:[0,.68611,.08229,0],931:[0,.68611,.05451,0],933:[0,.68611,.15972,0],934:[0,.68611,0,0],936:[0,.68611,.11653,0],937:[0,.68611,.04835,0],945:[0,.44444,0,0],946:[.19444,.69444,.03403,0],947:[.19444,.44444,.06389,0],948:[0,.69444,.03819,0],949:[0,.44444,0,0],950:[.19444,.69444,.06215,0],951:[.19444,.44444,.03704,0],952:[0,.69444,.03194,0],953:[0,.44444,0,0],954:[0,.44444,0,0],955:[0,.69444,0,0],956:[.19444,.44444,0,0],957:[0,.44444,.06898,0],958:[.19444,.69444,.03021,0],959:[0,.44444,0,0],960:[0,.44444,.03704,0],961:[.19444,.44444,0,0],962:[.09722,.44444,.07917,0],963:[0,.44444,.03704,0],964:[0,.44444,.13472,0],965:[0,.44444,.03704,0],966:[.19444,.44444,0,0],967:[.19444,.44444,0,0],968:[.19444,.69444,.03704,0],969:[0,.44444,.03704,0],977:[0,.69444,0,0],981:[.19444,.69444,0,0],982:[0,.44444,.03194,0],1009:[.19444,.44444,0,0],1013:[0,.44444,0,0]},"Math-Italic":{47:[.19444,.69444,0,0],65:[0,.68333,0,.13889],66:[0,.68333,.05017,.08334],67:[0,.68333,.07153,.08334],68:[0,.68333,.02778,.05556],69:[0,.68333,.05764,.08334],70:[0,.68333,.13889,.08334],71:[0,.68333,0,.08334],72:[0,.68333,.08125,.05556],73:[0,.68333,.07847,.11111],74:[0,.68333,.09618,.16667],75:[0,.68333,.07153,.05556],76:[0,.68333,0,.02778],77:[0,.68333,.10903,.08334],78:[0,.68333,.10903,.08334],79:[0,.68333,.02778,.08334],80:[0,.68333,.13889,.08334],81:[.19444,.68333,0,.08334],82:[0,.68333,.00773,.08334],83:[0,.68333,.05764,.08334],84:[0,.68333,.13889,.08334],85:[0,.68333,.10903,.02778],86:[0,.68333,.22222,0],87:[0,.68333,.13889,0],88:[0,.68333,.07847,.08334],89:[0,.68333,.22222,0],90:[0,.68333,.07153,.08334],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,.05556],100:[0,.69444,0,.16667],101:[0,.43056,0,.05556],102:[.19444,.69444,.10764,.16667],103:[.19444,.43056,.03588,.02778],104:[0,.69444,0,0],105:[0,.65952,0,0],106:[.19444,.65952,.05724,0],107:[0,.69444,.03148,0],108:[0,.69444,.01968,.08334],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,.05556],112:[.19444,.43056,0,.08334],113:[.19444,.43056,.03588,.08334],114:[0,.43056,.02778,.05556],115:[0,.43056,0,.05556],116:[0,.61508,0,.08334],117:[0,.43056,0,.02778],118:[0,.43056,.03588,.02778],119:[0,.43056,.02691,.08334],120:[0,.43056,0,.02778],121:[.19444,.43056,.03588,.05556],122:[0,.43056,.04398,.05556],915:[0,.68333,.13889,.08334],916:[0,.68333,0,.16667],920:[0,.68333,.02778,.08334],923:[0,.68333,0,.16667],926:[0,.68333,.07569,.08334],928:[0,.68333,.08125,.05556],931:[0,.68333,.05764,.08334],933:[0,.68333,.13889,.05556],934:[0,.68333,0,.08334],936:[0,.68333,.11,.05556],937:[0,.68333,.05017,.08334],945:[0,.43056,.0037,.02778],946:[.19444,.69444,.05278,.08334],947:[.19444,.43056,.05556,0],948:[0,.69444,.03785,.05556],949:[0,.43056,0,.08334],950:[.19444,.69444,.07378,.08334],951:[.19444,.43056,.03588,.05556],952:[0,.69444,.02778,.08334],953:[0,.43056,0,.05556],954:[0,.43056,0,0],955:[0,.69444,0,0],956:[.19444,.43056,0,.02778],957:[0,.43056,.06366,.02778],958:[.19444,.69444,.04601,.11111],959:[0,.43056,0,.05556],960:[0,.43056,.03588,0],961:[.19444,.43056,0,.08334],962:[.09722,.43056,.07986,.08334],963:[0,.43056,.03588,0],964:[0,.43056,.1132,.02778],965:[0,.43056,.03588,.02778],966:[.19444,.43056,0,.08334],967:[.19444,.43056,0,.05556],968:[.19444,.69444,.03588,.11111],969:[0,.43056,.03588,0],977:[0,.69444,0,.08334],981:[.19444,.69444,0,.08334],982:[0,.43056,.02778,0],1009:[.19444,.43056,0,.08334],1013:[0,.43056,0,.05556]},"Math-Regular":{65:[0,.68333,0,.13889],66:[0,.68333,.05017,.08334],67:[0,.68333,.07153,.08334],68:[0,.68333,.02778,.05556],69:[0,.68333,.05764,.08334],70:[0,.68333,.13889,.08334],71:[0,.68333,0,.08334],72:[0,.68333,.08125,.05556],73:[0,.68333,.07847,.11111],74:[0,.68333,.09618,.16667],75:[0,.68333,.07153,.05556],76:[0,.68333,0,.02778],77:[0,.68333,.10903,.08334],78:[0,.68333,.10903,.08334],79:[0,.68333,.02778,.08334],80:[0,.68333,.13889,.08334],81:[.19444,.68333,0,.08334],82:[0,.68333,.00773,.08334],83:[0,.68333,.05764,.08334],84:[0,.68333,.13889,.08334],85:[0,.68333,.10903,.02778],86:[0,.68333,.22222,0],87:[0,.68333,.13889,0],88:[0,.68333,.07847,.08334],89:[0,.68333,.22222,0],90:[0,.68333,.07153,.08334],97:[0,.43056,0,0],98:[0,.69444,0,0],99:[0,.43056,0,.05556],100:[0,.69444,0,.16667],101:[0,.43056,0,.05556],102:[.19444,.69444,.10764,.16667],103:[.19444,.43056,.03588,.02778],104:[0,.69444,0,0],105:[0,.65952,0,0],106:[.19444,.65952,.05724,0],107:[0,.69444,.03148,0],108:[0,.69444,.01968,.08334],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,.05556],112:[.19444,.43056,0,.08334],113:[.19444,.43056,.03588,.08334],114:[0,.43056,.02778,.05556],115:[0,.43056,0,.05556],116:[0,.61508,0,.08334],117:[0,.43056,0,.02778],118:[0,.43056,.03588,.02778],119:[0,.43056,.02691,.08334],120:[0,.43056,0,.02778],121:[.19444,.43056,.03588,.05556],122:[0,.43056,.04398,.05556],915:[0,.68333,.13889,.08334],916:[0,.68333,0,.16667],920:[0,.68333,.02778,.08334],923:[0,.68333,0,.16667],926:[0,.68333,.07569,.08334],928:[0,.68333,.08125,.05556],931:[0,.68333,.05764,.08334],933:[0,.68333,.13889,.05556],934:[0,.68333,0,.08334],936:[0,.68333,.11,.05556],937:[0,.68333,.05017,.08334],945:[0,.43056,.0037,.02778],946:[.19444,.69444,.05278,.08334],947:[.19444,.43056,.05556,0],948:[0,.69444,.03785,.05556],949:[0,.43056,0,.08334],950:[.19444,.69444,.07378,.08334],951:[.19444,.43056,.03588,.05556],952:[0,.69444,.02778,.08334],953:[0,.43056,0,.05556],954:[0,.43056,0,0],955:[0,.69444,0,0],956:[.19444,.43056,0,.02778],957:[0,.43056,.06366,.02778],958:[.19444,.69444,.04601,.11111],959:[0,.43056,0,.05556],960:[0,.43056,.03588,0],961:[.19444,.43056,0,.08334],962:[.09722,.43056,.07986,.08334],963:[0,.43056,.03588,0],964:[0,.43056,.1132,.02778],965:[0,.43056,.03588,.02778],966:[.19444,.43056,0,.08334],967:[.19444,.43056,0,.05556],968:[.19444,.69444,.03588,.11111],969:[0,.43056,.03588,0],977:[0,.69444,0,.08334],981:[.19444,.69444,0,.08334],982:[0,.43056,.02778,0],1009:[.19444,.43056,0,.08334],1013:[0,.43056,0,.05556]},"SansSerif-Regular":{33:[0,.69444,0,0],34:[0,.69444,0,0],35:[.19444,.69444,0,0],36:[.05556,.75,0,0],37:[.05556,.75,0,0],38:[0,.69444,0,0],39:[0,.69444,0,0],40:[.25,.75,0,0],41:[.25,.75,0,0],42:[0,.75,0,0],43:[.08333,.58333,0,0],44:[.125,.08333,0,0],45:[0,.44444,0,0],46:[0,.08333,0,0],47:[.25,.75,0,0],48:[0,.65556,0,0],49:[0,.65556,0,0],50:[0,.65556,0,0],51:[0,.65556,0,0],52:[0,.65556,0,0],53:[0,.65556,0,0],54:[0,.65556,0,0],55:[0,.65556,0,0],56:[0,.65556,0,0],57:[0,.65556,0,0],58:[0,.44444,0,0],59:[.125,.44444,0,0],61:[-.13,.37,0,0],63:[0,.69444,0,0],64:[0,.69444,0,0],65:[0,.69444,0,0],66:[0,.69444,0,0],67:[0,.69444,0,0],68:[0,.69444,0,0],69:[0,.69444,0,0],70:[0,.69444,0,0],71:[0,.69444,0,0],72:[0,.69444,0,0],73:[0,.69444,0,0],74:[0,.69444,0,0],75:[0,.69444,0,0],76:[0,.69444,0,0],77:[0,.69444,0,0],78:[0,.69444,0,0],79:[0,.69444,0,0],80:[0,.69444,0,0],81:[.125,.69444,0,0],82:[0,.69444,0,0],83:[0,.69444,0,0],84:[0,.69444,0,0],85:[0,.69444,0,0],86:[0,.69444,.01389,0],87:[0,.69444,.01389,0],88:[0,.69444,0,0],89:[0,.69444,.025,0],90:[0,.69444,0,0],91:[.25,.75,0,0],93:[.25,.75,0,0],94:[0,.69444,0,0],95:[.35,.09444,.02778,0],97:[0,.44444,0,0],98:[0,.69444,0,0],99:[0,.44444,0,0],100:[0,.69444,0,0],101:[0,.44444,0,0],102:[0,.69444,.06944,0],103:[.19444,.44444,.01389,0],104:[0,.69444,0,0],105:[0,.67937,0,0],106:[.19444,.67937,0,0],107:[0,.69444,0,0],108:[0,.69444,0,0],109:[0,.44444,0,0],110:[0,.44444,0,0],111:[0,.44444,0,0],112:[.19444,.44444,0,0],113:[.19444,.44444,0,0],114:[0,.44444,.01389,0],115:[0,.44444,0,0],116:[0,.57143,0,0],117:[0,.44444,0,0],118:[0,.44444,.01389,0],119:[0,.44444,.01389,0],120:[0,.44444,0,0],121:[.19444,.44444,.01389,0],122:[0,.44444,0,0],126:[.35,.32659,0,0],305:[0,.44444,0,0],567:[.19444,.44444,0,0],768:[0,.69444,0,0],769:[0,.69444,0,0],770:[0,.69444,0,0],771:[0,.67659,0,0],772:[0,.60889,0,0],774:[0,.69444,0,0],775:[0,.67937,0,0],776:[0,.67937,0,0],778:[0,.69444,0,0],779:[0,.69444,0,0],780:[0,.63194,0,0],915:[0,.69444,0,0],916:[0,.69444,0,0],920:[0,.69444,0,0],923:[0,.69444,0,0],926:[0,.69444,0,0],928:[0,.69444,0,0],931:[0,.69444,0,0],933:[0,.69444,0,0],934:[0,.69444,0,0],936:[0,.69444,0,0],937:[0,.69444,0,0],8211:[0,.44444,.02778,0],8212:[0,.44444,.02778,0],8216:[0,.69444,0,0],8217:[0,.69444,0,0],8220:[0,.69444,0,0],8221:[0,.69444,0,0]},"Script-Regular":{65:[0,.7,.22925,0],66:[0,.7,.04087,0],67:[0,.7,.1689,0],68:[0,.7,.09371,0],69:[0,.7,.18583,0],70:[0,.7,.13634,0],71:[0,.7,.17322,0],72:[0,.7,.29694,0],73:[0,.7,.19189,0],74:[.27778,.7,.19189,0],75:[0,.7,.31259,0],76:[0,.7,.19189,0],77:[0,.7,.15981,0],78:[0,.7,.3525,0],79:[0,.7,.08078,0],80:[0,.7,.08078,0],81:[0,.7,.03305,0],82:[0,.7,.06259,0],83:[0,.7,.19189,0],84:[0,.7,.29087,0],85:[0,.7,.25815,0],86:[0,.7,.27523,0],87:[0,.7,.27523,0],88:[0,.7,.26006,0],89:[0,.7,.2939,0],90:[0,.7,.24037,0]},"Size1-Regular":{40:[.35001,.85,0,0],41:[.35001,.85,0,0],47:[.35001,.85,0,0],91:[.35001,.85,0,0],92:[.35001,.85,0,0],93:[.35001,.85,0,0],123:[.35001,.85,0,0],125:[.35001,.85,0,0],710:[0,.72222,0,0],732:[0,.72222,0,0],770:[0,.72222,0,0],771:[0,.72222,0,0],8214:[-99e-5,.601,0,0],8593:[1e-5,.6,0,0],8595:[1e-5,.6,0,0],8657:[1e-5,.6,0,0],8659:[1e-5,.6,0,0],8719:[.25001,.75,0,0],8720:[.25001,.75,0,0],8721:[.25001,.75,0,0],8730:[.35001,.85,0,0],8739:[-.00599,.606,0,0],8741:[-.00599,.606,0,0],8747:[.30612,.805,.19445,0],8748:[.306,.805,.19445,0],8749:[.306,.805,.19445,0],8750:[.30612,.805,.19445,0],8896:[.25001,.75,0,0],8897:[.25001,.75,0,0],8898:[.25001,.75,0,0],8899:[.25001,.75,0,0],8968:[.35001,.85,0,0],8969:[.35001,.85,0,0],8970:[.35001,.85,0,0],8971:[.35001,.85,0,0],9168:[-99e-5,.601,0,0],10216:[.35001,.85,0,0],10217:[.35001,.85,0,0],10752:[.25001,.75,0,0],10753:[.25001,.75,0,0],10754:[.25001,.75,0,0],10756:[.25001,.75,0,0],10758:[.25001,.75,0,0]},"Size2-Regular":{40:[.65002,1.15,0,0],41:[.65002,1.15,0,0],47:[.65002,1.15,0,0],91:[.65002,1.15,0,0],92:[.65002,1.15,0,0],93:[.65002,1.15,0,0],123:[.65002,1.15,0,0],125:[.65002,1.15,0,0],710:[0,.75,0,0],732:[0,.75,0,0],770:[0,.75,0,0],771:[0,.75,0,0],8719:[.55001,1.05,0,0],8720:[.55001,1.05,0,0],8721:[.55001,1.05,0,0],8730:[.65002,1.15,0,0],8747:[.86225,1.36,.44445,0],8748:[.862,1.36,.44445,0],8749:[.862,1.36,.44445,0],8750:[.86225,1.36,.44445,0],8896:[.55001,1.05,0,0],8897:[.55001,1.05,0,0],8898:[.55001,1.05,0,0],8899:[.55001,1.05,0,0],8968:[.65002,1.15,0,0],8969:[.65002,1.15,0,0],8970:[.65002,1.15,0,0],8971:[.65002,1.15,0,0],10216:[.65002,1.15,0,0],10217:[.65002,1.15,0,0],10752:[.55001,1.05,0,0],10753:[.55001,1.05,0,0],10754:[.55001,1.05,0,0],10756:[.55001,1.05,0,0],10758:[.55001,1.05,0,0]},"Size3-Regular":{40:[.95003,1.45,0,0],41:[.95003,1.45,0,0],47:[.95003,1.45,0,0],91:[.95003,1.45,0,0],92:[.95003,1.45,0,0],93:[.95003,1.45,0,0],123:[.95003,1.45,0,0],125:[.95003,1.45,0,0],710:[0,.75,0,0],732:[0,.75,0,0],770:[0,.75,0,0],771:[0,.75,0,0],8730:[.95003,1.45,0,0],8968:[.95003,1.45,0,0],8969:[.95003,1.45,0,0],8970:[.95003,1.45,0,0],8971:[.95003,1.45,0,0],10216:[.95003,1.45,0,0],10217:[.95003,1.45,0,0]},"Size4-Regular":{40:[1.25003,1.75,0,0],41:[1.25003,1.75,0,0],47:[1.25003,1.75,0,0],91:[1.25003,1.75,0,0],92:[1.25003,1.75,0,0],93:[1.25003,1.75,0,0],123:[1.25003,1.75,0,0],125:[1.25003,1.75,0,0],710:[0,.825,0,0],732:[0,.825,0,0],770:[0,.825,0,0],771:[0,.825,0,0],8730:[1.25003,1.75,0,0],8968:[1.25003,1.75,0,0],8969:[1.25003,1.75,0,0],8970:[1.25003,1.75,0,0],8971:[1.25003,1.75,0,0],9115:[.64502,1.155,0,0],9116:[1e-5,.6,0,0],9117:[.64502,1.155,0,0],9118:[.64502,1.155,0,0],9119:[1e-5,.6,0,0],9120:[.64502,1.155,0,0],9121:[.64502,1.155,0,0],9122:[-99e-5,.601,0,0],9123:[.64502,1.155,0,0],9124:[.64502,1.155,0,0],9125:[-99e-5,.601,0,0],9126:[.64502,1.155,0,0],9127:[1e-5,.9,0,0],9128:[.65002,1.15,0,0],9129:[.90001,0,0,0],9130:[0,.3,0,0],9131:[1e-5,.9,0,0],9132:[.65002,1.15,0,0],9133:[.90001,0,0,0],9143:[.88502,.915,0,0],10216:[1.25003,1.75,0,0],10217:[1.25003,1.75,0,0],57344:[-.00499,.605,0,0],57345:[-.00499,.605,0,0],57680:[0,.12,0,0],57681:[0,.12,0,0],57682:[0,.12,0,0],57683:[0,.12,0,0]},"Typewriter-Regular":{33:[0,.61111,0,0],34:[0,.61111,0,0],35:[0,.61111,0,0],36:[.08333,.69444,0,0],37:[.08333,.69444,0,0],38:[0,.61111,0,0],39:[0,.61111,0,0],40:[.08333,.69444,0,0],41:[.08333,.69444,0,0],42:[0,.52083,0,0],43:[-.08056,.53055,0,0],44:[.13889,.125,0,0],45:[-.08056,.53055,0,0],46:[0,.125,0,0],47:[.08333,.69444,0,0],48:[0,.61111,0,0],49:[0,.61111,0,0],50:[0,.61111,0,0],51:[0,.61111,0,0],52:[0,.61111,0,0],53:[0,.61111,0,0],54:[0,.61111,0,0],55:[0,.61111,0,0],56:[0,.61111,0,0],57:[0,.61111,0,0],58:[0,.43056,0,0],59:[.13889,.43056,0,0],60:[-.05556,.55556,0,0],61:[-.19549,.41562,0,0],62:[-.05556,.55556,0,0],63:[0,.61111,0,0],64:[0,.61111,0,0],65:[0,.61111,0,0],66:[0,.61111,0,0],67:[0,.61111,0,0],68:[0,.61111,0,0],69:[0,.61111,0,0],70:[0,.61111,0,0],71:[0,.61111,0,0],72:[0,.61111,0,0],73:[0,.61111,0,0],74:[0,.61111,0,0],75:[0,.61111,0,0],76:[0,.61111,0,0],77:[0,.61111,0,0],78:[0,.61111,0,0],79:[0,.61111,0,0],80:[0,.61111,0,0],81:[.13889,.61111,0,0],82:[0,.61111,0,0],83:[0,.61111,0,0],84:[0,.61111,0,0],85:[0,.61111,0,0],86:[0,.61111,0,0],87:[0,.61111,0,0],88:[0,.61111,0,0],89:[0,.61111,0,0],90:[0,.61111,0,0],91:[.08333,.69444,0,0],92:[.08333,.69444,0,0],93:[.08333,.69444,0,0],94:[0,.61111,0,0],95:[.09514,0,0,0],96:[0,.61111,0,0],97:[0,.43056,0,0],98:[0,.61111,0,0],99:[0,.43056,0,0],100:[0,.61111,0,0],101:[0,.43056,0,0],102:[0,.61111,0,0],103:[.22222,.43056,0,0],104:[0,.61111,0,0],105:[0,.61111,0,0],106:[.22222,.61111,0,0],107:[0,.61111,0,0],108:[0,.61111,0,0],109:[0,.43056,0,0],110:[0,.43056,0,0],111:[0,.43056,0,0],112:[.22222,.43056,0,0],113:[.22222,.43056,0,0],114:[0,.43056,0,0],115:[0,.43056,0,0],116:[0,.55358,0,0],117:[0,.43056,0,0],118:[0,.43056,0,0],119:[0,.43056,0,0],120:[0,.43056,0,0],121:[.22222,.43056,0,0],122:[0,.43056,0,0],123:[.08333,.69444,0,0],124:[.08333,.69444,0,0],125:[.08333,.69444,0,0],126:[0,.61111,0,0],127:[0,.61111,0,0],305:[0,.43056,0,0],567:[.22222,.43056,0,0],768:[0,.61111,0,0],769:[0,.61111,0,0],770:[0,.61111,0,0],771:[0,.61111,0,0],772:[0,.56555,0,0],774:[0,.61111,0,0],776:[0,.61111,0,0],778:[0,.61111,0,0],780:[0,.56597,0,0],915:[0,.61111,0,0],916:[0,.61111,0,0],920:[0,.61111,0,0],923:[0,.61111,0,0],926:[0,.61111,0,0],928:[0,.61111,0,0],931:[0,.61111,0,0],933:[0,.61111,0,0],934:[0,.61111,0,0],936:[0,.61111,0,0],937:[0,.61111,0,0],2018:[0,.61111,0,0],2019:[0,.61111,0,0],8242:[0,.61111,0,0]}};const l=/[\u3040-\u309F]|[\u30A0-\u30FF]|[\u4E00-\u9FAF]|[\uAC00-\uD7AF]/,c={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25]},h={defaultRuleThickness:.04,bigOpSpacing1:.111,bigOpSpacing2:.166,bigOpSpacing3:.2,bigOpSpacing4:.6,bigOpSpacing5:.1,ptPerEm:10,pxPerEm:40/3,doubleRuleSep:.2,arraycolsep:.5,baselineskip:1.2,arrayrulewidth:.04,fboxsep:.3,fboxrule:.04},u={"Â ":" ","â":" ","Ã":"A","Ã":"C","Ã":"D","Ã":"o","Ã¥":"a","Ã§":"c","Ã°":"d","Ã¾":"o","Ð":"A","Ð":"B","Ð":"B","Ð":"F","Ð":"A","Ð":"E","Ð":"K","Ð":"3","Ð":"N","Ð":"N","Ð":"K","Ð":"N","Ð":"M","Ð":"H","Ð":"O","Ð":"N","Ð ":"P","Ð¡":"C","Ð¢":"T","Ð£":"y","Ð¤":"O","Ð¥":"X","Ð¦":"U","Ð§":"h","Ð¨":"W","Ð©":"W","Ðª":"B","Ð«":"X","Ð¬":"B","Ð­":"3","Ð®":"X","Ð¯":"R","Ð°":"a","Ð±":"b","Ð²":"a","Ð³":"r","Ð´":"y","Ðµ":"e","Ð¶":"m","Ð·":"e","Ð¸":"n","Ð¹":"n","Ðº":"n","Ð»":"n","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"n","Ñ":"p","Ñ":"c","Ñ":"o","Ñ":"y","Ñ":"b","Ñ":"x","Ñ":"n","Ñ":"n","Ñ":"w","Ñ":"w","Ñ":"a","Ñ":"m","Ñ":"a","Ñ":"e","Ñ":"m","Ñ":"r"};function d(t,e,i){if("string"==typeof t){const i=t.match(/([-+]?[0-9.]*)\s*([a-zA-Z]+)/);i?(t=parseFloat(i[1]),e=i[2].toLowerCase()):t=parseFloat(t)}const s={pt:1,mm:7227/2540,cm:7227/254,ex:35271/8192,px:.75,em:h.ptPerEm,bp:1.00375,dd:1238/1157,pc:12,in:72.27,mu:10/18}[e]||1;if(isFinite(i)){const e=Math.pow(10,i);return Math.round(t/h.ptPerEm*s*e)/e}return t/h.ptPerEm*s}var p={toEm:d,toPx:function(t,e){return d(t,e)*(4/3)*h.ptPerEm},METRICS:h,SIGMAS:c,getCharacterMetrics:function(t,e){const i={cal:"Caligraphic-Regular",ams:"AMS-Regular",frak:"Fraktur-Regular",bb:"AMS-Regular",scr:"Script-Regular",cmr:"Main-Regular",cmtt:"Typewriter-Regular",cmss:"SansSerif-Regular"}[e]||e;let s=t.charCodeAt(0);t[0]in u?s=u[t[0]].charCodeAt(0):l.test(t[0])&&(s=77);const n=a[i][s];return n?n?{depth:n[0],height:n[1],italic:n[2],skew:n[3]}:null:{defaultMetrics:!0,depth:.2,height:.7,italic:0,skew:0}}};const f=[{},{},{}];let m;for(const zs in c)if(Object.prototype.hasOwnProperty.call(c,zs))for(m=0;m<3;m++)f[m][zs]=c[zs][m];for(m=0;m<3;m++)f[m].emPerEx=c.xHeight[m]/c.quad[m];class g{constructor(t,e,i,s){this.id=t,this.size=e,this.cramped=s,this.sizeMultiplier=i,this.metrics=f[e>0?e-1:0]}sup(){return b[x[this.id]]}sub(){return b[C[this.id]]}fracNum(){return b[_[this.id]]}fracDen(){return b[w[this.id]]}cramp(){return b[S[this.id]]}cls(){return y[this.size]}adjustTo(t){let e=v[this.size][t.size];return e.length>0&&(e=" "+e),e}isTight(){return this.size>=2}}const b=[new g(0,0,1,!1),new g(1,0,1,!0),new g(2,1,1,!1),new g(3,1,1,!0),new g(4,2,.7,!1),new g(5,2,.7,!0),new g(6,3,.5,!1),new g(7,3,.5,!0)],y=["displaystyle textstyle","textstyle","scriptstyle","scriptscriptstyle"],v=[["","","reset-textstyle scriptstyle","reset-textstyle scriptscriptstyle"],["reset-textstyle displaystyle textstyle","","reset-textstyle scriptstyle","reset-textstyle scriptscriptstyle"],["reset-scriptstyle textstyle displaystyle","reset-scriptstyle textstyle","","reset-scriptstyle scriptscriptstyle"],["reset-scriptscriptstyle textstyle displaystyle","reset-scriptscriptstyle textstyle","reset-scriptscriptstyle scriptstyle",""]],x=[4,5,4,5,6,7,6,7],C=[5,5,5,5,7,7,7,7],_=[2,3,4,5,6,7,6,7],w=[3,3,5,5,7,7,7,7],S=[1,1,3,3,5,5,7,7];var P={DISPLAY:b[0],TEXT:b[2],SCRIPT:b[4],SCRIPTSCRIPT:b[6],toMathstyle:function(t){return t?"object"==typeof t?t:{displaystyle:b[0],textstyle:b[2],scriptstyle:b[4],scriptscriptstyle:b[6]}[t]:t}};class k{constructor(t){this.macros=t.macros||{},this.generateID=!!t.generateID&&t.generateID,this.mathstyle=P.toMathstyle(t.mathstyle||"displaystyle"),this.size=t.size||"size5",this.parentMathstyle=t.parentMathstyle||this.mathstyle,this.parentSize=t.parentSize||this.size,this.opacity=t.opacity}clone(t){const e=new k(this);return e.parentMathstyle=this.mathstyle,e.parentSize=this.size,e.macros=this.macros,t&&("auto"!==t.mathstyle&&t.mathstyle||delete t.mathstyle,Object.assign(e,t),"string"==typeof t.mathstyle&&(e.mathstyle=P.toMathstyle(t.mathstyle))),e}setMathstyle(t){t&&"auto"!==t&&(this.mathstyle=P.toMathstyle(t))}cramp(){return this.clone({mathstyle:this.mathstyle.cramp()})}sup(){return this.clone({mathstyle:this.mathstyle.sup()})}sub(){return this.clone({mathstyle:this.mathstyle.sup()})}}var E=k;function T(t){let e="";if("number"==typeof t)e+=Math.floor(100*t)/100;else if("string"==typeof t)e+=t;else if(Array.isArray(t))for(const i of t)e+=T(i);else t&&(e+=t.toString());return e}class A{constructor(t,e){this.classes=e||"",Array.isArray(t)?this.children=[].concat.apply([],t):"string"==typeof t?this.body=t:t&&"object"==typeof t&&(this.children=[t]),this.style=null,this.updateDimensions()}updateDimensions(){let t=0,e=0,i=1;this.children&&this.children.forEach(s=>{s.height>t&&(t=s.height),s.depth>e&&(e=s.depth),s.maxFontSize>i&&(i=s.maxFontSize)}),this.height=t,this.depth=e,this.maxFontSize=i}selected(t){t&&!/ML__selected/.test(this.classes)&&(this.classes.length>0&&(this.classes+=" "),this.classes+="ML__selected"),!t&&/ML__selected/.test(this.classes)&&(this.classes=this.classes.replace("ML__selected","")),this.children&&this.children.forEach(e=>e.selected(t))}applyStyle(t){if(!t)return;if(t.color&&this.setStyle("color","none"!==t.color?t.color:""),t.backgroundColor&&this.setStyle("background-color","none"!==t.backgroundColor?t.backgroundColor:""),t.cssClass&&(this.classes+=" "+t.cssClass),!this.body)return;let e=t.fontFamily;"math"===e&&"n"===t.fontShape&&(e="cmr");let i="Main-Regular";if(e&&(i=function(t,e){if("string"!=typeof t||t.length>1||"â"===t)return Y[e];if("bb"===e||"scr"===e){if(!/^[A-Z ]$/.test(t))return null}else if("cal"===e){if(!/^[0-9A-Z ]$/.test(t))return null}else if("frak"===e){if(!/^[0-9A-Za-z ]$|^[!"#$%&'()*+,\-./:;=?[]^ââ]$/.test(t))return null}else if(("cmtt"===e||"cmss"===e)&&!/^[0-9A-Za-z ]$|^[!"&'()*+,\-./:;=?@[]^_~\u0131\u0237\u0393\u0394\u0398\u039b\u039e\u03A0\u03A3\u03A5\u03A8\u03a9ââ]$/.test(t))return null;return Y[e]}(this.body,e)),t.fontShape&&(this.classes+=" "+({it:"ML__it",sl:"ML__shape_sl",sc:"ML__shape_sc",ol:"ML__shape_ol"}[t.fontShape]||"")),t.fontSeries){const e=t.fontSeries.match(/(.?[lbm])?(.?[cx])?/);e&&(this.classes+=" "+({ul:"ML__series_ul",el:"ML__series_el",l:"ML__series_l",sl:"ML__series_sl",m:"",sb:"ML__series_sb",b:"ML__bold",eb:"ML__series_eb",ub:"ML__series_ub"}[e[1]||""]||""),this.classes+=" "+({uc:"ML__series_uc",ec:"ML__series_ec",c:"ML__series_c",sc:"ML__series_sc",n:"",sx:"ML__series_sx",x:"ML__series_x",ex:"ML__series_ex",ux:"ML__series_ux"}[e[2]||""]||""))}if(z[e]?this.classes+=" "+z[e]:e&&this.setStyle("font-family",e),this.body&&this.body.length>0&&i){this.height=0,this.depth=0,this.maxFontSize={size1:.5,size2:.7,size3:.8,size4:.9,size5:1,size6:1.2,size7:1.44,size8:1.73,size9:2.07,size10:2.49}[t.fontSize]||1,this.skew=0,this.italic=0;for(let t=0;t<this.body.length;t++){const e=p.getCharacterMetrics(this.body.charAt(t),i);e&&(this.height=Math.max(this.height,e.height),this.depth=Math.max(this.depth,e.depth),this.skew=e.skew,this.italic=e.italic)}}}setStyle(t,...e){const i=T(e);i.length>0&&(this.style||(this.style={}),this.style[t]=i)}setTop(t){t&&0!==t&&(this.style||(this.style={}),this.style.top=T(t)+"em",this.height-=t,this.depth+=t)}setLeft(t){t&&0!==t&&(this.style||(this.style={}),this.style["margin-left"]=T(t)+"em")}setRight(t){t&&0!==t&&(this.style||(this.style={}),this.style["margin-right"]=T(t)+"em")}setWidth(t){t&&0!==t&&(this.style||(this.style={}),this.style.width=T(t)+"em")}addMarginRight(t){if(t&&0!==t){if(!this.style&&!/qquad|quad|enspace|thickspace|mediumspace|thinspace|negativethinspace/.test(this.classes)){const e={2:"qquad",1:"quad",".5":"enspace",.277778:"thickspace",.222222:"mediumspace",.166667:"thinspace","-0.166667":"negativethinspace"}[t.toString()];if(e)return void(this.classes+=" rspace "+e)}this.style||(this.style={});const e=parseFloat(this.style["margin-right"]||"0");this.style["margin-right"]=T(e+t)+"em"}}toMarkup(t,e){t=t||0,e=e||1;let i="",s=this.body||"";if(this.children){let t="none";for(const i of this.children){let n=0;if(t){let s=i.type;s&&("textord"===s&&(s="mord"),"first"===s&&(s="none"),n=i.isTight?L[t+"+"+s]||0:O[t+"+"+s]||0,n=Math.floor(e*n))}s+=i.toMarkup(n,e),t=D(i)}}if("â"!==s&&s||this.classes&&"ML__selected"!==this.classes){if(i="<span",this.cssId&&(i+=' id="'+this.cssId+'" '),this.svgOverlay&&(this.setStyle("position","relative"),this.setStyle("height",this.height+this.depth,"em"),this.setStyle("vertical-align",-this.depth,"em")),this.attributes)for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(i+=" "+t+'="'+this.attributes[t]+'"');const e=this.classes.split(" ");this.type&&(/command|placeholder|error/.test(this.type)&&e.push({command:"ML__command",placeholder:"ML__placeholder",error:"ML__error"}[this.type]),this.caret&&"command"===this.type&&e.push("ML__command-caret"));let n="";if(n=e.length>1?e.filter((function(t,e,i){return t.length>0&&i.indexOf(t)===e})).join(" "):e[0],n.length>0&&(i+=' class="'+n+'"'),t&&(this.style&&this.style["margin-left"]?this.style["margin-left"]=T(parseFloat(this.style["margin-left"])+t/18)+"em":t<0&&N[-t]?s=N[-t]+s:M[t]?s=M[t]+s:(this.style||(this.style={}),this.style["margin-left"]=T(t/18)+"em")),this.style){let t="";const e=/ML__selected/.test(this.classes);for(const i in this.style)Object.prototype.hasOwnProperty.call(this.style,i)&&("background-color"===i&&e||(t+=i+":"+this.style[i]+";"));t.length>0&&(i+=' style="'+t+'"')}i+=">",this.svgOverlay?(i+='<span style="',i+="display: inline-block;",i+="height:"+(this.height+this.depth)+"em;",i+="vertical-align:"+this.depth+"em;",i+='">',i+=s,i+="</span>",i+="<svg ",i+='style="position:absolute;',i+="overflow:overlay;",i+="height:"+(this.height+this.depth)+"em;",i+="transform:translateY(-"+Math.round(p.toPx(this.depth,"em")+p.toPx(this.style.padding))+"px);",this.style&&this.style.padding?(i+="top:"+this.style.padding+";",i+="left:"+this.style.padding+";",i+="width:calc(100% - 2 * "+this.style.padding+" );"):(i+="top:0;",i+="left:0;",i+="width:100%;"),i+="z-index:2;",i+='"',this.svgStyle&&(i+=' style="'+this.svgStyle+'"'),i+=">",i+=this.svgOverlay,i+="</svg>"):i+=s,i+="</span>"}else i="";return this.caret&&"command"!==this.type&&(i+="text"===this.caret?'<span class="ML__text-caret"></span>':'<span class="ML__caret"></span>'),i}tryCoalesceWith(t){if(this.tag!==t.tag)return!1;if(this.type!==t.type)return!1;if("error"===this.type||"placeholder"===this.type||"command"===this.type)return!1;if(this.children&&this.children.length>0||t.children&&t.children.length>0)return!1;if((this.style?this.style.length:0)!==(t.style?t.style.length:0))return!1;const e=this.classes.trim().replace(/\s+/g," ").split(" "),i=t.classes.trim().replace(/\s+/g," ").split(" ");if(e.length!==i.length)return!1;e.sort(),i.sort();for(let s=0;s<e.length;s++){if("vertical-separator"===e[s])return!1;if(e[s]!==i[s])return!1}if(this.style&&t.style)for(const s in this.style)if(Object.prototype.hasOwnProperty.call(this.style,s)&&Object.prototype.hasOwnProperty.call(t.style,s)&&this.style[s]!==t.style[s])return!1;return this.body+=t.body,this.height=Math.max(this.height,t.height),this.depth=Math.max(this.depth,t.depth),this.maxFontSize=Math.max(this.maxFontSize,t.maxFontSize),this.italic=t.italic,!0}}const O={"mord+mop":3,"mord+mbin":4,"mord+mrel":5,"mord+minner":3,"mop+mord":3,"mop+mop":3,"mop+mbin":5,"mop+minner":3,"mbin+mord":4,"mbin+mop":4,"mbin+mopen":4,"mbin+minner":4,"mrel+mord":5,"mrel+mop":5,"mrel+mopen":5,"mrel+minner":5,"mclose+mop":3,"mclose+mbin":4,"mclose+mrel":5,"mclose+minner":3,"mpunct+mord":3,"mpunct+mop":3,"mpunct+mbin":4,"mpunct+mrel":5,"mpunct+mopen":3,"mpunct+mpunct":3,"mpunct+minner":3},M=["â","â","ââ","â","â","ââ","â","","","â"],N=["","ââ£","","ââ£","ââ£","ââ£"],L={"mord+mop":3,"mop+mord":3,"mop+mop":3,"mclose+mop":3,"minner+mop":3};function D(t){const e=t.type;return"first"===e?"none":"textord"===e?"mord":e}function j(t){return t?Array.isArray(t)?t.reduce((t,e)=>Math.max(t,e.height),0):t.height:0}function R(t){return t?Array.isArray(t)?t.reduce((t,e)=>Math.max(t,e.depth),0):t.depth:0}function I(t,e){if(Array.isArray(t)){const i=[];for(const e of t)e&&i.push(e);if(1===i.length)return I(i[0],e)}return new A(t,e)}function B(t,e,i){const s=I(e,i);return s.type=t,s}function F(t,e){if(!e||0===e.length){if(t instanceof A)return t;if(Array.isArray(t)&&1===t.length)return t[0]}const i=new A(t,e);let s=1;return s=t instanceof A?t.maxFontSize:t.reduce((t,e)=>Math.max(t,e.maxFontSize),0),i.height*=s,i.depth*=s,i}const Y={ams:"AMS-Regular",bb:"AMS-Regular",cal:"Caligraphic-Regular",frak:"Fraktur-Regular",scr:"Script-Regular",cmr:"Main-Regular",cmss:"SansSerif-Regular",cmtt:"Typewriter-Regular",math:"Math-Regular",mainit:"Main-Italic"},z={ams:"ML__ams",bb:"ML__bb",cal:"ML__cal",frak:"ML__frak",scr:"ML__script",cmr:"ML__mathrm",cmss:"ML__sans",cmtt:"ML__tt",math:"ML__mathit",mainit:"ML__mainit"};var q={coalesce:function t(e){if(!e||0===e.length)return[];e[0].children=t(e[0].children);const i=[e[0]];for(let s=1;s<e.length;s++)i[i.length-1].tryCoalesceWith(e[s])||(e[s].children=t(e[s].children),i.push(e[s]));return i},makeSpan:I,makeOp:function(t,e){return B("mop",t,e)},makeOrd:function(t,e){return B("mord",t,e)},makeRel:function(t,e){return B("mrel",t,e)},makeClose:function(t,e){return B("mclose",t,e)},makeOpen:function(t,e){return B("mopen",t,e)},makeInner:function(t,e){return B("minner",t,e)},makePunct:function(t,e){return B("mpunct",t,e)},makeSpanOfType:B,makeSymbol:function(t,e,i){const s=new A(e,i),n=p.getCharacterMetrics(e,t);return s.height=n.height,s.depth=n.depth,s.skew=n.skew,s.italic=n.italic,s.setRight(s.italic),s},makeVlist:function(t,e,i,s){let n=0,r=0;i=i||"shift",s=s||0;for(let h=0;h<e.length;h++)Array.isArray(e[h])&&(e[h]=1===e[h].length?e[h][0]:I(e[h]));if("shift"===i)n=-e[0].depth-s;else if("bottom"===i)n=-s;else if("top"===i){let t=s;for(const i of e)t-=i instanceof A?i.height+i.depth:i;n=t}else if("individualShift"===i){const t=e;e=[t[0]],n=-t[1]-t[0].depth,r=n;for(let i=2;i<t.length;i+=2){const s=-t[i+1]-r-t[i].depth;r+=s,e.push(s-(t[i-2].height+t[i-2].depth)),e.push(t[i])}}let o=1;for(const h of e)h instanceof A&&(o=Math.max(o,h.maxFontSize));const a=function(t,e){const i=e?e/t.mathstyle.sizeMultiplier:0,s=new A("â");return 1!==i&&(s.setStyle("font-size",i,i>0?"em":""),s.attributes={"aria-hidden":!0}),"size5"!==t.size?new A(s,"fontsize-ensurer reset-"+t.size+" size5"):0!==i?s:null}(t,o),l=[];r=n;for(const h of e)if("number"==typeof h)r+=h;else{const t=I([a,h]);t.setTop(-h.depth-r),l.push(t),r+=h.height+h.depth}const c=I(l,"vlist");return c.depth=Math.max(n,R(c)||0),c.height=Math.max(-r,j(c)||0),c},makeHlist:F,makeStyleWrap:function(t,e,i,s,n){n=n||"";const r=F(e,(n+=" style-wrap ")+i.adjustTo(s));r.type=t;const o=s.sizeMultiplier/i.sizeMultiplier;return r.height*=o,r.depth*=o,r.maxFontSize=s.sizeMultiplier,r},makeSVG:function(t,e,i){return t.svgOverlay=e,t.svgStyle=i,t},height:j,depth:R,skew:function(t){if(!t)return 0;if(Array.isArray(t)){let e=0;for(const i of t)e+=i.skew||0;return e}return t.skew},italic:function(t){return t?Array.isArray(t)?t[t.length-1].italic:t.italic:0}};let X="";const U={},G={},H={},J="CRYPTIC",$="COMMON",V="SUPERCOMMON",W={CRYPTIC:0,ARCANE:200,VERY_RARE:600,RARE:1200,UNCOMMON:2e3,COMMON:3e3,SUPERCOMMON:4e3};function K(t,...e){const i="string"==typeof t?W[t]:t;for(const s of e)U[s]&&(U[s].frequency=i),G[s]&&(G[s]=Object.assign({},G[s]),G[s].frequency=i)}function Q(t,e,i,s,n){e&&/^(ams|cmr|bb|cal|frak|scr)$/.test(e),"string"==typeof n&&(n=W[n]),U[t]={type:i===at?lt:i,baseFontFamily:e,value:s,category:X,frequency:n}}function Z(t,e){for(let i=t;i<=e;i++){const t=String.fromCodePoint(i);Q(t,"","mord",t)}}const tt={8739:"|",183:"\\cdot",188:"\\frac{1}{4}",189:"\\frac{1}{2}",190:"\\frac{3}{4}",8304:"^{0}",8305:"^{i}",185:"^{1}",178:"^{2}",179:"^{3}",8308:"^{4}",8309:"^{5}",8310:"^{6}",8311:"^{7}",8312:"^{8}",8313:"^{9}",8314:"^{+}",8315:"^{-}",8316:"^{=}",8319:"^{n}",8320:"_{0}",8321:"_{1}",8322:"_{2}",8323:"_{3}",8324:"_{4}",8325:"_{5}",8326:"_{6}",8327:"_{7}",8328:"_{8}",8329:"_{9}",8330:"_{+}",8331:"_{-}",8332:"_{=}",8336:"_{a}",8337:"_{e}",8338:"_{o}",8339:"_{x}",8242:"\\prime",8243:"\\doubleprime",8736:"\\angle",8450:"\\C",8469:"\\N",8473:"\\P",8474:"\\Q",8477:"\\R",8484:"\\Z"};function et(t,e){const i=String.fromCodePoint(e);if("math"===t&&tt[i])return tt[i];if(e>32&&e<127)return i;let s="";if("math"===t){for(const n in U)if(Object.prototype.hasOwnProperty.call(U,n)&&U[n].value===i){s=n;break}}else for(const n in Ct)if(Object.prototype.hasOwnProperty.call(Ct,n)&&Ct[n]===i){s=n;break}return s||i}const it={119893:8462,119965:8492,119968:8496,119969:8497,119971:8459,119972:8464,119975:8466,119976:8499,119981:8475,119994:8495,119996:8458,120004:8500,120070:8493,120075:8460,120076:8465,120085:8476,120093:8488,120122:8450,120127:8461,120133:8469,120135:8473,120136:8474,120137:8477,120145:8484},st=[{start:119808,len:26,offset:65,style:"bold"},{start:119834,len:26,offset:97,style:"bold"},{start:119860,len:26,offset:65,style:"italic"},{start:119886,len:26,offset:97,style:"italic"},{start:119912,len:26,offset:65,style:"bolditalic"},{start:119938,len:26,offset:97,style:"bolditalic"},{start:119964,len:26,offset:65,variant:"script"},{start:119990,len:26,offset:97,variant:"script"},{start:120016,len:26,offset:65,variant:"script",style:"bold"},{start:120042,len:26,offset:97,variant:"script",style:"bold"},{start:120068,len:26,offset:65,variant:"fraktur"},{start:120094,len:26,offset:97,variant:"fraktur"},{start:120172,len:26,offset:65,variant:"fraktur",style:"bold"},{start:120198,len:26,offset:97,variant:"fraktur",style:"bold"},{start:120120,len:26,offset:65,variant:"double-struck"},{start:120146,len:26,offset:97,variant:"double-struck"},{start:120224,len:26,offset:65,variant:"sans-serif"},{start:120250,len:26,offset:97,variant:"sans-serif"},{start:120276,len:26,offset:65,variant:"sans-serif",style:"bold"},{start:120302,len:26,offset:97,variant:"sans-serif",style:"bold"},{start:120328,len:26,offset:65,variant:"sans-serif",style:"italic"},{start:120354,len:26,offset:97,variant:"sans-serif",style:"italic"},{start:120380,len:26,offset:65,variant:"sans-serif",style:"bolditalic"},{start:120406,len:26,offset:97,variant:"sans-serif",style:"bolditalic"},{start:120432,len:26,offset:65,variant:"monospace"},{start:120458,len:26,offset:97,variant:"monospace"},{start:120488,len:25,offset:913,style:"bold"},{start:120514,len:25,offset:945,style:"bold"},{start:120546,len:25,offset:913,style:"italic"},{start:120572,len:25,offset:945,style:"italic"},{start:120604,len:25,offset:913,style:"bolditalic"},{start:120630,len:25,offset:945,style:"bolditalic"},{start:120662,len:25,offset:913,variant:"sans-serif",style:"bold"},{start:120688,len:25,offset:945,variant:"sans-serif",style:"bold"},{start:120720,len:25,offset:913,variant:"sans-serif",style:"bolditalic"},{start:120746,len:25,offset:945,variant:"sans-serif",style:"bolditalic"},{start:120782,len:10,offset:48,variant:"",style:"bold"},{start:120792,len:10,offset:48,variant:"double-struck"},{start:120803,len:10,offset:48,variant:"sans-serif"},{start:120812,len:10,offset:48,variant:"sans-serif",style:"bold"},{start:120822,len:10,offset:48,variant:"monospace"}];function nt(t){let e=t;if("string"==typeof t&&(e=t.codePointAt(0)),(e<119808||e>120831)&&(e<8448||e>8527))return{char:t};for(const i in it)if(Object.prototype.hasOwnProperty.call(it,i)&&it[i]===e){e=i;break}for(let i=0;i<st.length;i++)if(e>=st[i].start&&e<st[i].start+st[i].len)return{char:String.fromCodePoint(e-st[i].start+st[i].offset),variant:st[i].variant,style:st[i].style};return{char:t}}function rt(t,e){if("text"===t)return String.fromCodePoint(e);let i;if(tt[e])return tt[e];const s=nt(e);return s.style||s.variant?(i=s.char,s.variant&&(i="\\"+s.variant+"{"+i+"}"),"bold"===s.style?i="\\mathbf{"+i+"}":"italic"===s.style?i="\\mathit{"+i+"}":"bolditalic"===s.style&&(i="\\mathbf{\\mathit{"+i+"}}"),"\\mathord{"+i+"}"):et(t,e)}const ot="ams",at="mord",lt="mord",ct="mbin",ht="mrel",ut="mopen",dt="mclose",pt="spacing";function ft(t,e){let i=t.match(/=(.+)/),s="{}",n="auto",r=null;return i&&(s=i[1]),i=t.match(/:([^=]+)/),i&&(n=i[1].trim()),i=t.match(/^([^:=]+)/),i&&(r=i[1].trim()),{optional:e,type:n,defaultValue:s,placeholder:r}}function mt(t){if(!t||0===t.length)return[];let e=[],i=t.split("]");if("["===i[0].charAt(0)){e.push(ft(i[0].slice(1),!0));for(let t=1;t<=i.length;t++)e=e.concat(mt(i[t]))}else if(i=t.split("}"),"{"===i[0].charAt(0)){e.push(ft(i[0].slice(1),!1));for(let t=1;t<=i.length;t++)e=e.concat(mt(i[t]))}return e}function gt(t){return t.map(t=>t.body).join("")}function bt(t,e,i,s){"string"==typeof t&&(t=[t]),i||(i={});const n=mt(e),r={category:X,params:n,parser:s,mathstyle:"displaystyle",tabular:i.tabular||!0,colFormat:i.colFormat||[]};for(const o of t)H[o]=r}function yt(t,e,i,s){"string"==typeof t&&(t=[t]),i||(i={});const n={category:X,baseFontFamily:i.fontFamily,params:mt(e),allowedInText:!!i.allowedInText,infix:!!i.infix,parse:s};for(const r of t)G[r]=n}X="Environments",bt("math","",{frequency:0},(function(){return{mathstyle:"textstyle"}})),bt("displaymath","",{frequency:8},(function(){return{mathstyle:"displaystyle"}})),bt("array","{columns:colspec}",{frequency:$},(function(t,e){return{colFormat:e[0],mathstyle:"textstyle"}})),bt("eqnarray","",{},(function(){return{}})),bt("equation","",{},(function(){return{colFormat:[{align:"c"}]}})),bt("subequations","",{},(function(){return{colFormat:[{align:"c"}]}})),bt("multline","",{},(function(){return{firstRowFormat:[{align:"l"}],colFormat:[{align:"c"}],lastRowFormat:[{align:"r"}]}})),bt(["align","aligned"],"",{},(function(t,e,i){let s=0;for(const o of i)s=Math.max(s,o.length);const n=[{gap:0},{align:"r"},{gap:0},{align:"l"}];let r=2;for(;r<s;)n.push({gap:1}),n.push({align:"r"}),n.push({gap:0}),n.push({align:"l"}),r+=2;return n.push({gap:0}),{colFormat:n,jot:.3}})),bt("split","",{},(function(){return{}})),bt(["gather","gathered"],"",{},(function(){return{colFormat:[{gap:.25},{align:"c"},{gap:0}],jot:.3}})),bt(["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","smallmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*","smallmatrix*"],"[columns:colspec]",{},(function(t,e){const i={mathstyle:"textstyle"};switch(t){case"pmatrix":case"pmatrix*":i.lFence="(",i.rFence=")";break;case"bmatrix":case"bmatrix*":i.lFence="[",i.rFence="]";break;case"Bmatrix":case"Bmatrix*":i.lFence="\\lbrace",i.rFence="\\rbrace";break;case"vmatrix":case"vmatrix*":i.lFence="\\vert",i.rFence="\\vert";break;case"Vmatrix":case"Vmatrix*":i.lFence="\\Vert",i.rFence="\\Vert";break;case"smallmatrix":case"smallmatrix*":i.mathstyle="scriptstyle";break;case"matrix":case"matrix*":i.lFence=".",i.rFence="."}return i.colFormat=e[0]||[{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"},{align:"c"}],i})),bt("cases","",{},(function(){return{arraystretch:1.2,lFence:"\\lbrace",rFence:".",colFormat:[{align:"l"},{gap:1},{align:"l"}]}})),bt("theorem","",{},(function(){return{}})),bt("center","",{},(function(){return{colFormat:[{align:"c"}]}})),X="",function(t){for(let e=0;e<"0123456789/@.".length;e++){const t="0123456789/@.".charAt(e);Q(t,"",lt,t)}}(),Z(65,90),Z(97,122),X="Trigonometry",yt(["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),K(V,"\\cos","\\sin","\\tan"),K("UNCOMMON","\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arcsec","\\arccsc"),K("UNCOMMON","\\arsinh","\\arccosh","\\arctanh","\\arcsech","\\arccsch"),K("UNCOMMON","\\arg","\\ch","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\lg","\\lb","\\sec","\\sinh","\\sh","\\tanh","\\tg","\\th"),X="Functions",yt(["\\deg","\\dim","\\exp","\\hom","\\ker","\\lb","\\lg","\\ln","\\log"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),K(V,"\\ln","\\log","\\exp"),K(292,"\\hom"),K($,"\\dim"),K($,"\\ker","\\deg"),yt(["\\lim","\\mod"],"",null,(function(t){return{type:"mop",limits:"limits",symbol:!1,body:t.slice(1),baseFontFamily:"cmr"}})),yt(["\\det","\\max","\\min"],"",null,(function(t){return{type:"mop",limits:"limits",symbol:!1,isFunction:!0,body:t.slice(1),baseFontFamily:"cmr"}})),K(V,"\\lim"),K($,"\\det"),K($,"\\mod"),K($,"\\min"),K($,"\\max"),X="Decoration",yt("\\rule","[raise:dimen]{width:dimen}{thickness:dimen}",null,(function(t,e){return{type:"rule",shift:e[0],width:e[1],height:e[2]}})),yt("\\color","{:color}",{allowedInText:!0},(t,e)=>({color:e[0]})),yt("\\textcolor","{:color}{content:auto*}",{allowedInText:!0},(t,e)=>({color:e[0]})),K(3,"\\textcolor"),yt("\\overline","{:auto}",null,(function(t,e){return{type:"line",position:"overline",skipBoundary:!0,body:e[0]}})),K($,"\\overline"),yt("\\underline","{:auto}",null,(function(t,e){return{type:"line",position:"underline",skipBoundary:!0,body:e[0]}})),K($,"\\underline"),yt("\\overset","{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",overscript:e[0],skipBoundary:!0,body:e[1]}})),K($,"\\overset"),yt("\\underset","{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",underscript:e[0],skipBoundary:!0,body:e[1]}})),K($,"\\underset"),yt(["\\stackrel","\\stackbin"],"{annotation:auto}{symbol:auto}",null,(function(t,e){return{type:"overunder",overscript:e[0],skipBoundary:!0,body:e[1],mathtype:"\\stackrel"===t?"mrel":"mbin"}})),K($,"\\stackrel"),K(0,"\\stackbin"),yt("\\rlap","{:auto}",null,(function(t,e){return{type:"overlap",align:"right",skipBoundary:!0,body:e[0]}})),K(270,"\\rlap"),yt("\\llap","{:auto}",null,(function(t,e){return{type:"overlap",align:"left",skipBoundary:!0,body:e[0]}})),K(18,"\\llap"),yt("\\mathrlap","{:auto}",null,(function(t,e){return{type:"overlap",mode:"math",align:"right",skipBoundary:!0,body:e[0]}})),K(J,"\\mathrlap"),yt("\\mathllap","{:auto}",null,(function(t,e){return{type:"overlap",mode:"math",align:"left",skipBoundary:!0,body:e[0]}})),K(J,"\\mathllap"),yt("\\boxed","{content:math}",null,(function(t,e){return{type:"box",framecolor:"black",skipBoundary:!0,body:e[0]}})),K(1236,"\\boxed"),yt("\\colorbox","{background-color:color}{content:auto}",{allowedInText:!0},(function(t,e){return{type:"box",backgroundcolor:e[0],skipBoundary:!0,body:e[1]}})),K(J,"\\colorbox"),yt("\\fcolorbox","{frame-color:color}{background-color:color}{content:auto}",{allowedInText:!0},(function(t,e){return{type:"box",framecolor:e[0],backgroundcolor:e[1],skipBoundary:!0,body:e[2]}})),K(J,"\\fcolorbox"),yt("\\bbox","[:bbox]{body:auto}",{allowedInText:!0},(function(t,e){return e[0]?{type:"box",padding:e[0].padding,border:e[0].border,backgroundcolor:e[0].backgroundcolor,skipBoundary:!0,body:e[1]}:{type:"box",skipBoundary:!0,body:e[1]}})),K(J,"\\bbox"),yt("\\enclose","{notation:string}[style:string]{body:auto}",null,(function(t,e){let i=e[0]||[];const s={type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",backgroundcolor:"transparent",padding:"auto",shadow:"auto",captureSelection:!0,body:e[2]};if(e[1]){const t=e[1].split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(const e of t){const t=e.match(/\s*(\S+)\s+(\S+)\s+(.*)/);if(t)s.strokeWidth=p.toPx(t[1],"px"),isFinite(s.strokeWidth)||(s.strokeWidth=1),s.strokeStyle=t[2],s.strokeColor=t[3];else{const t=e.match(/\s*([a-z]*)\s*=\s*"(.*)"/);t&&("mathbackground"===t[1]?s.backgroundcolor=t[2]:"mathcolor"===t[1]?s.strokeColor=t[2]:"padding"===t[1]?s.padding=p.toPx(t[2],"px"):"shadow"===t[1]&&(s.shadow=t[2]))}}"dashed"===s.strokeStyle?s.svgStrokeStyle="5,5":"dotted"===s.strokeStyle&&(s.svgStrokeStyle="1,5")}s.borderStyle=s.strokeWidth+"px "+s.strokeStyle+" "+s.strokeColor,i=i.toString().split(/[, ]/).filter(t=>t.length>0).map(t=>t.toLowerCase()),s.notation={};for(const n of i)s.notation[n]=!0;return s.notation.updiagonalarrow&&(s.notation.updiagonalstrike=!1),s.notation.box&&(s.notation.left=!1,s.notation.right=!1,s.notation.bottom=!1,s.notation.top=!1),s})),K(J,"\\enclose"),yt("\\cancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{updiagonalstrike:!0},body:e[0]}})),yt("\\bcancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{downdiagonalstrike:!0},body:e[0]}})),yt("\\xcancel","{body:auto}",null,(function(t,e){return{type:"enclose",strokeColor:"currentColor",strokeWidth:1,strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"auto",notation:{updiagonalstrike:!0,downdiagonalstrike:!0},body:e[0]}})),K(J,"\\cancel","\\bcancel","\\xcancel"),X="Styling",yt(["\\tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],"",{allowedInText:!0},(function(t,e){return{fontSize:{tiny:"size1",scriptsize:"size2",footnotesize:"size3",small:"size4",normalsize:"size5",large:"size6",Large:"size7",LARGE:"size8",huge:"size9",Huge:"size10"}[t.slice(1)]}})),yt("\\fontseries","{:text}",{allowedInText:!0},(t,e)=>({fontSeries:gt(e[0])})),yt("\\bf","",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),yt("\\bm","{:math*}",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),yt("\\bold","",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"b"})),yt(["\\mathbf","\\boldsymbol"],"{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"b",fontShape:"n"})),yt("\\bfseries","",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),yt("\\textbf","{:text*}",{allowedInText:!0},(t,e)=>({fontSeries:"b"})),yt("\\mathmd","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"m",fontShape:"n"})),yt("\\mdseries","",{allowedInText:!0},(t,e)=>({fontSeries:"m"})),yt("\\textmd","{:math*}",{allowedInText:!0},(t,e)=>({fontSeries:"m"})),yt("\\fontshape","{:text}",{allowedInText:!0},(t,e)=>({fontShape:gt(e[0])})),yt("\\it","",{allowedInText:!0},(t,e)=>({fontShape:"it"})),yt("\\mathit","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontSeries:"m",fontShape:"it"})),yt("\\upshape","",{allowedInText:!0},(t,e)=>({fontShape:"n"})),yt("\\textup","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"n"})),yt("\\textit","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"it"})),yt("\\slshape","",{allowedInText:!0},(t,e)=>({fontShape:"sl"})),yt("\\textsl","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"sl"})),yt("\\scshape","",{allowedInText:!0},(t,e)=>({mode:"text",fontShape:"sc"})),yt("\\textsc","{:text*}",{allowedInText:!0},(t,e)=>({fontShape:"sc"})),yt("\\fontfamily","{:text}",{allowedInText:!0},(t,e)=>({fontFamily:gt(e[0])})),yt("\\mathrm","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",fontFamily:"cmr",fontSeries:"m",fontShape:"n"})),yt("\\rmfamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmr"})),yt("\\textrm","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmr"})),yt("\\mathsf","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cmss",fontSeries:"m",fontShape:"n"})),yt("\\sffamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmss"})),yt("\\textsf","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmss"})),yt("\\mathtt","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cmtt",fontSeries:"m",fontShape:"n"})),yt("\\ttfamily","",{allowedInText:!0},(t,e)=>({fontFamily:"cmtt"})),yt("\\texttt","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmtt"})),yt(["\\Bbb","\\mathbb"],"{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"bb"})),yt(["\\frak","\\mathfrak"],"{:math*}",{allowedInText:!0},(t,e)=>({baseFontFamily:"frak"})),yt("\\mathcal","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"cal",fontSeries:"m",fontShape:"n"})),yt("\\mathscr","{:math*}",{allowedInText:!0},(t,e)=>({mode:"math",baseFontFamily:"scr",fontSeries:"m",fontShape:"n"})),K(V,"\\mathbb"),K(1081,"\\Bbb"),K(0,"\\mathcal"),K($,"\\mathfrak"),K(271,"\\frak"),K($,"\\mathscr"),K("UNCOMMON","\\mathsf"),K($,"\\mathtt"),K($,"\\boldsymbol"),yt("\\textnormal","{:text*}",{allowedInText:!0},(t,e)=>({fontFamily:"cmr",fontShape:"n",fontSeries:"n"})),yt("\\mbox","{:text*}",null,(t,e)=>({fontFamily:"cmr"})),yt("\\text","{:text*}",{allowedInText:!0},(t,e)=>({})),yt("\\class","{name:text}{content:auto*}",{allowedInText:!0},(t,e)=>({cssClass:gt(e[0])})),yt("\\cssId","{id:text}{content:auto}",{allowedInText:!0},(t,e)=>({cssId:gt(e[0]),body:e[1],type:"group"})),yt("\\em","",{allowedInText:!0},(t,e)=>({cssClass:"ML__emph",type:"group"})),yt("\\emph","{:auto}",{allowedInText:!0},(t,e)=>({cssClass:"ML__emph",body:e[0],type:"group",skipBoundary:!0})),K($,"\\textrm"),K($,"\\textit"),K($,"\\textsf"),K($,"\\texttt"),K(433,"\\textnormal"),K($,"\\textbf"),K(421,"\\textup"),K(819,"\\emph"),K(49,"\\em"),X="Operators",yt("\\sqrt","[index:auto]{radicand:auto}",null,(function(t,e){return{type:"surd",body:e[1],index:e[0]}})),K(V,"\\sqrt"),X="Fractions",yt(["\\frac","\\dfrac","\\tfrac","\\cfrac","\\binom","\\dbinom","\\tbinom"],"{numerator}{denominator}",null,(function(t,e){const i={type:"genfrac",numer:e[0],denom:e[1],mathstyle:"auto"};switch(t){case"\\dfrac":case"\\frac":case"\\tfrac":case"\\cfrac":i.hasBarLine=!0;break;case"\\\\atopfrac":i.hasBarLine=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":i.hasBarLine=!1,i.leftDelim="(",i.rightDelim=")"}switch(t){case"\\dfrac":case"\\dbinom":i.mathstyle="displaystyle";break;case"\\tfrac":case"\\tbinom":i.mathstyle="textstyle"}return"\\cfrac"===t&&(i.continuousFraction=!0),i})),yt(["\\over","\\atop","\\choose"],"",{infix:!0},(function(t,e){const i=e[0],s=e[1];let n=!1,r=null,o=null;switch(t){case"\\atop":break;case"\\over":n=!0;break;case"\\choose":n=!1,r="(",o=")";break;default:throw new Error("Unrecognized genfrac command")}return{type:"genfrac",numer:i,denom:s,hasBarLine:n,leftDelim:r,rightDelim:o,mathstyle:"auto"}})),K(21,"\\over"),K(12,"\\atop"),K(1968,"\\choose"),yt(["\\overwithdelims","\\atopwithdelims"],"{left-delim:delim}{right-delim:delim}",{infix:!0},(function(t,e){return{type:"genfrac",numer:e[0],denom:e[1],hasBarLine:!1,leftDelim:e[2],rightDelim:e[3],mathstyle:"auto"}})),K(15,"\\overwithdelims"),K($,"\\atopwithdelims"),X="Fractions",yt("\\pdiff","{numerator}{denominator}",null,(function(t,e){return{type:"genfrac",numer:e[0],denom:e[1],numerPrefix:"â",denomPrefix:"â",hasBarLine:!0,leftDelim:null,rightDelim:null,mathstyle:"auto"}})),X="Quantifiers",Q("\\forall","",lt,"â",V),Q("\\exists","",lt,"â",V),Q("\\nexists",ot,lt,"â",V),Q("\\mid","",ht,"â£",$),Q("\\top","",lt,"â¤","RARE"),Q("\\bot","",lt,"â¥","RARE"),X="Variable Sized Symbols",yt(["\\sum","\\prod","\\bigcup","\\bigcap","\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","\\intop"],"",null,(function(t){return{type:"mop",limits:"auto",symbol:!0,baseFontFamily:"cmr",body:{coprod:"â",bigvee:"â",bigwedge:"â",biguplus:"â¨",bigcap:"â",bigcup:"â",intop:"â«",prod:"â",sum:"â",bigotimes:"â¨",bigoplus:"â¨",bigodot:"â¨",bigsqcup:"â¨",smallint:"â«"}[t.slice(1)]}})),yt(["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\ointctrclockwise","\\intctrclockwise"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!0,body:{int:"â«",iint:"â¬",iiint:"â­",oint:"â®",oiint:"â¯",oiiint:"â°",intclockwise:"â±",varointclockwise:"â²",ointctrclockwise:"â³",intctrclockwise:"â¨"}[t.slice(1)]}})),K(V,"\\sum","\\prod","\\bigcap","\\bigcup","\\int"),K($,"\\bigoplus","\\smallint","\\iint","\\oint"),K("RARE","\\bigwedge","\\bigvee"),K(756,"\\coprod"),K(723,"\\bigsqcup"),K(1241,"\\bigotimes"),K(150,"\\bigodot"),K(174,"\\biguplus"),K(878,"\\iiint"),K(97,"\\intop"),X="Various",Q("\\sharp","",lt,"â¯",$),Q("\\flat","",lt,"â­",590),Q("\\natural","",lt,"â®",278),Q("\\#","",lt,"#","RARE"),Q("\\&","",lt,"&","RARE"),Q("\\clubsuit","",lt,"â£",172),Q("\\heartsuit","",lt,"â¡","ARCANE"),Q("\\spadesuit","",lt,"â ","ARCANE"),Q("\\diamondsuit","",lt,"â¢",J),Q("\\differencedelta","",ht,"â",$),X="Letters and Letter Like Forms",yt("\\unicode","{charcode:number}",null,(function(t,e){let i=parseInt(e[0]);return isFinite(i)||(i=10067),{type:"mord",body:String.fromCodePoint(i)}})),Q("\\backslash","",lt,"\\"),Q("?","",lt,"?"),Q("!","",lt,"!"),Q("\\nabla","",lt,"â",V),Q("\\partial","",lt,"â",V),Q("\\ell","",lt,"â",$),Q("\\imaginaryI","",lt,"i"),Q("\\imaginaryJ","",lt,"j"),yt(["\\Re","\\Im"],"",null,(function(t){return{type:"mop",limits:"nolimits",symbol:!1,isFunction:!0,body:{"\\Re":"â","\\Im":"â"}[t],baseFontFamily:"frak"}})),Q("\\hbar","",lt,"â",$),Q("\\hslash",ot,lt,"â",$),Q("\\differentialD","cmr",lt,"d"),Q("\\rd","cmr",lt,"d"),Q("\\capitalDifferentialD","cmr",lt,"D"),Q("\\rD","cmr",lt,"D"),Q("\\exponentialE","cmr",lt,"e"),Q("\\Finv",ot,lt,"â²",3),Q("\\Game",ot,lt,"â",1),Q("\\wp","",lt,"â",1306),Q("\\eth",ot,lt,"Ã°",77),Q("\\mho",ot,lt,"â§",138),Q("\\Bbbk",ot,lt,"k"),Q("\\doubleStruckCapitalN","bb",lt,"N"),Q("\\N","bb",lt,"N"),Q("\\doubleStruckCapitalR","bb",lt,"R"),Q("\\R","bb",lt,"R"),Q("\\doubleStruckCapitalQ","bb",lt,"Q"),Q("\\Q","bb",lt,"Q"),Q("\\doubleStruckCapitalC","bb",lt,"C"),Q("\\C","bb",lt,"C"),Q("\\doubleStruckCapitalZ","bb",lt,"Z"),Q("\\Z","bb",lt,"Z"),Q("\\doubleStruckCapitalP","bb",lt,"P"),Q("\\P","bb",lt,"P"),Q("\\scriptCapitalE","scr",lt,"E"),Q("\\scriptCapitalH","scr",lt,"H"),Q("\\scriptCapitalL","scr",lt,"L"),Q("\\gothicCapitalC","frak",lt,"C"),Q("\\gothicCapitalH","frak",lt,"H"),Q("\\gothicCapitalI","frak",lt,"I"),Q("\\gothicCapitalR","frak",lt,"R"),Q("\\pounds","",lt,"Â£",509),Q("\\yen",ot,lt,"Â¥",57),Q("\\euro","",lt,"â¬",4),X="Crosses",Q("\\textdagger","",ct,"â "),Q("\\dagger","",ct,"â ",$),Q("\\dag","",ct,"â ",$),Q("\\ddag","",ct,"â¡",500),Q("\\textdaggerdbl","",ct,"â¡"),Q("\\ddagger","",ct,"â¡",353),Q("\\maltese",ot,lt,"â ",24),X="Arrows",Q("\\longrightarrow","",ht,"â¶",V),Q("\\rightarrow","",ht,"â",V),Q("\\Longrightarrow","",ht,"â¹",V),Q("\\Rightarrow","",ht,"â",V),Q("\\longmapsto","",ht,"â¼",$),Q("\\mapsto","",ht,"â¦",$),Q("\\Longleftrightarrow","",ht,"âº",$),Q("\\rightleftarrows",ot,ht,"â",$),Q("\\leftarrow","",ht,"â",$),Q("\\curvearrowleft",ot,ht,"â¶",$),Q("\\uparrow","",ht,"â",$),Q("\\downarrow","",ht,"â",$),Q("\\hookrightarrow","",ht,"âª",$),Q("\\rightharpoonup","",ht,"â",$),Q("\\rightleftharpoons","",ht,"â",$),Q("\\Leftarrow","",ht,"â",1695),Q("\\longleftrightarrow","",ht,"â·",1599),Q("\\longleftarrow","",ht,"âµ",878),Q("\\Longleftarrow","",ht,"â¸",296),Q("\\searrow","",ht,"â",1609),Q("\\nearrow","",ht,"â",1301),Q("\\swarrow","",ht,"â",167),Q("\\nwarrow","",ht,"â",108),Q("\\Uparrow","",ht,"â",257),Q("\\Downarrow","",ht,"â",556),Q("\\updownarrow","",ht,"â",192),Q("\\Updownarrow","",ht,"â",161),Q("\\hookleftarrow","",ht,"â©",115),Q("\\leftharpoonup","",ht,"â¼",93),Q("\\leftharpoondown","",ht,"â½",42),Q("\\rightharpoondown","",ht,"â",80),Q("\\leftrightarrows",ot,ht,"â",765),Q("\\dashrightarrow",ot,ht,"â¢",311),Q("\\dashleftarrow",ot,ht,"â ",5),Q("\\leftleftarrows",ot,ht,"â",8),Q("\\Lleftarrow",ot,ht,"â",7),Q("\\twoheadleftarrow",ot,ht,"â",32),Q("\\leftarrowtail",ot,ht,"â¢",25),Q("\\looparrowleft",ot,ht,"â«",6),Q("\\leftrightharpoons",ot,ht,"â",205),Q("\\circlearrowleft",ot,ht,"âº",105),Q("\\Lsh",ot,ht,"â°",11),Q("\\upuparrows",ot,ht,"â",15),Q("\\downharpoonleft",ot,ht,"â",21),Q("\\multimap",ot,ht,"â¸",108),Q("\\leftrightsquigarrow",ot,ht,"â­",31),Q("\\twoheadrightarrow",ot,ht,"â ",835),Q("\\rightarrowtail",ot,ht,"â£",195),Q("\\looparrowright",ot,ht,"â¬",37),Q("\\curvearrowright",ot,ht,"â·",209),Q("\\circlearrowright",ot,ht,"â»",63),Q("\\Rsh",ot,ht,"â±",18),Q("\\downdownarrows",ot,ht,"â",6),Q("\\upharpoonright",ot,ht,"â¾",579),Q("\\downharpoonright",ot,ht,"â",39),Q("\\rightsquigarrow",ot,ht,"â",674),Q("\\leadsto",ot,ht,"â",709),Q("\\Rrightarrow",ot,ht,"â",62),Q("\\restriction",ot,ht,"â¾",29),Q("\\upharpoonleft",ot,ht,"â¿",J),Q("\\rightrightarrows",ot,ht,"â",J),X="Negated Arrows",Q("\\nrightarrow",ot,ht,"â",324),Q("\\nRightarrow",ot,ht,"â",107),Q("\\nleftrightarrow",ot,ht,"â®",36),Q("\\nLeftrightarrow",ot,ht,"â",20),Q("\\nleftarrow",ot,ht,"â",7),Q("\\nLeftarrow",ot,ht,"â",5),X="Negated Relations",Q("\\nless",ot,ht,"â®",146),Q("\\nleqslant",ot,ht,"î",58),Q("\\lneq",ot,ht,"âª",54),Q("\\lneqq",ot,ht,"â¨",36),Q("\\nleqq",ot,ht,"î",18),Q("\\unlhd",ot,ct,"â´",253),Q("\\unrhd",ot,ct,"âµ",66),Q("\\lvertneqq",ot,ht,"î",6),Q("\\lnsim",ot,ht,"â¦",4),Q("\\lnapprox",ot,ht,"âª",J),Q("\\nprec",ot,ht,"â",71),Q("\\npreceq",ot,ht,"â ",57),Q("\\precnsim",ot,ht,"â¨",4),Q("\\precnapprox",ot,ht,"âª¹",2),Q("\\nsim",ot,ht,"â",40),Q("\\nshortmid",ot,ht,"î",1),Q("\\nmid",ot,ht,"â¤",417),Q("\\nvdash",ot,ht,"â¬",266),Q("\\nvDash",ot,ht,"â­",405),Q("\\ngtr",ot,ht,"â¯",90),Q("\\ngeqslant",ot,ht,"î",23),Q("\\ngeqq",ot,ht,"î",12),Q("\\gneq",ot,ht,"âª",29),Q("\\gneqq",ot,ht,"â©",35),Q("\\gvertneqq",ot,ht,"î",6),Q("\\gnsim",ot,ht,"â§",3),Q("\\gnapprox",ot,ht,"âª",J),Q("\\nsucc",ot,ht,"â",44),Q("\\nsucceq",ot,ht,"â¡",J),Q("\\succnsim",ot,ht,"â©",4),Q("\\succnapprox",ot,ht,"âªº",J),Q("\\ncong",ot,ht,"â",128),Q("\\nshortparallel",ot,ht,"î",6),Q("\\nparallel",ot,ht,"â¦",54),Q("\\nVDash",ot,ht,"â¯",5),Q("\\nsupseteqq",ot,ht,"î",1),Q("\\supsetneq",ot,ht,"â",286),Q("\\varsupsetneq",ot,ht,"î",2),Q("\\supsetneqq",ot,ht,"â«",49),Q("\\varsupsetneqq",ot,ht,"î",3),Q("\\nVdash",ot,ht,"â®",179),Q("\\precneqq",ot,ht,"âªµ",11),Q("\\succneqq",ot,ht,"âª¶",3),Q("\\nsubseteqq",ot,ht,"î",16),X="Various",Q("\\checkmark",ot,lt,"â",1025),Q("\\diagup",ot,lt,"â±",440),Q("\\diagdown",ot,lt,"â²",175),Q("\\measuredangle",ot,lt,"â¡",271),Q("\\sphericalangle",ot,lt,"â¢",156),Q("\\backprime",ot,lt,"âµ",104),Q("\\backdoubleprime",ot,lt,"â¶",J),X="Shapes",Q("\\ast","",ct,"â",V),Q("\\star","",ct,"â",$),Q("\\diamond","",ct,"â",1356),Q("\\Diamond",ot,lt,"â",695),Q("\\lozenge",ot,lt,"â",422),Q("\\blacklozenge",ot,lt,"â§«",344),Q("\\bigstar",ot,lt,"â",168),X="Hebrew",Q("\\aleph","",lt,"âµ",1381),Q("\\beth",ot,lt,"â¶",54),Q("\\daleth",ot,lt,"â¸",43),Q("\\gimel",ot,lt,"â·",36),X="Fences",Q("\\lbrace","",ut,"{",V),Q("\\rbrace","",dt,"}",V),Q("\\langle","",ut,"â¨",$),Q("\\rangle","",dt,"â©",$),Q("\\lfloor","",ut,"â",$),Q("\\rfloor","",dt,"â",$),Q("\\lceil","",ut,"â",$),Q("\\rceil","",dt,"â",$),Q("\\vert","",lt,"â£",V),Q("\\mvert","",ht,"â£"),Q("\\lvert","",ut,"â£",496),Q("\\rvert","",dt,"â£",496),Q("\\|","",lt,"â¥"),Q("\\Vert","",lt,"â¥",V),Q("\\mVert","",lt,"â¥"),Q("\\lVert","",ut,"â¥",287),Q("\\rVert","",dt,"â¥",J),Q("\\lbrack","",ut,"[",574),Q("\\rbrack","",dt,"]",213),Q("\\{","",ut,"{"),Q("\\}","",dt,"}"),Q("(","",ut,"("),Q(")","",dt,")"),Q("[","",ut,"["),Q("]","",dt,"]"),Q("\\ulcorner",ot,ut,"â",296),Q("\\urcorner",ot,dt,"â",310),Q("\\llcorner",ot,ut,"â",137),Q("\\lrcorner",ot,dt,"â",199),Q("\\lgroup","",ut,"â®",24),Q("\\rgroup","",dt,"â¯",24),Q("\\lmoustache","",ut,"â°",J),Q("\\rmoustache","",dt,"â±",J),yt(["\\middle"],"{:delim}",null,(function(t,e){return{type:"delim",delim:e[0]}})),X="Sizing";const vt={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}};function xt(t){let e="",i=!0;for(const s of t)"string"==typeof s.body?e+=s.body:i=!1;return i?e:""}yt(["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],"{:delim}",null,(function(t,e){return{type:"sizeddelim",size:vt[t].size,cls:vt[t].mclass,delim:e[0]}})),X="Relations",Q("=","",ht,"=",V),Q("\\ne","",ht,"â ",V),Q("\\neq","",ht,"â ",$),Q("<","",ht,"<",V),Q("\\lt","",ht,"<",$),Q(">","",ht,">",V),Q("\\gt","",ht,">",$),Q("\\le","",ht,"â¤",$),Q("\\ge","",ht,"â¥",$),Q("\\leqslant",ot,ht,"â©½",V),Q("\\geqslant",ot,ht,"â©¾",V),Q("\\leq","",ht,"â¤",$),Q("\\geq","",ht,"â¥",$),Q("\\ll","",ht,"âª"),Q("\\gg","",ht,"â«",$),Q("\\coloneq","",ht,"â",5),Q("\\measeq","",ht,"â"),Q("\\eqdef","",ht,"â"),Q("\\questeq","",ht,"â"),Q(":","",ht,":"),Q("\\cong","",ht,"â",$),Q("\\equiv","",ht,"â¡",$),Q("\\prec","",ht,"âº",$),Q("\\preceq","",ht,"âª¯",$),Q("\\succ","",ht,"â»",$),Q("\\succeq","",ht,"âª°",1916),Q("\\perp","",ht,"â¥",$),Q("\\parallel","",ht,"â¥",$),Q("\\propto","",ht,"â",$),Q("\\Colon","",ht,"â·"),Q("\\smile","",ht,"â£",$),Q("\\frown","",ht,"â¢",$),Q("\\sim","",ht,"â¼",$),Q("\\gtrsim",ot,ht,"â³",$),Q("\\approx","",ht,"â",V),Q("\\approxeq",ot,ht,"â",147),Q("\\thickapprox",ot,ht,"â",377),Q("\\lessapprox",ot,ht,"âª",146),Q("\\gtrapprox",ot,ht,"âª",95),Q("\\precapprox",ot,ht,"âª·",50),Q("\\succapprox",ot,ht,"âª¸",J),Q("\\thicksim",ot,ht,"â¼",779),Q("\\succsim",ot,ht,"â¿",251),Q("\\precsim",ot,ht,"â¾",104),Q("\\backsim",ot,ht,"â½",251),Q("\\eqsim",ot,ht,"â",62),Q("\\backsimeq",ot,ht,"â",91),Q("\\simeq","",ht,"â",J),Q("\\lesssim",ot,ht,"â²",J),Q("\\nleq",ot,ht,"â°",369),Q("\\ngeq",ot,ht,"â±",164),Q("\\smallsmile",ot,ht,"â£",31),Q("\\smallfrown",ot,ht,"â¢",71),Q("\\bowtie","",ht,"â",558),Q("\\asymp","",ht,"â",755),Q("\\sqsubseteq","",ht,"â",1255),Q("\\sqsupseteq","",ht,"â",183),Q("\\leqq",ot,ht,"â¦",1356),Q("\\eqslantless",ot,ht,"âª",15),Q("\\lll",ot,ht,"â",157),Q("\\lessgtr",ot,ht,"â¶",281),Q("\\lesseqgtr",ot,ht,"â",134),Q("\\lesseqqgtr",ot,ht,"âª",J),Q("\\risingdotseq",ot,ht,"â",8),Q("\\fallingdotseq",ot,ht,"â",99),Q("\\subseteqq",ot,ht,"â«",82),Q("\\Subset",ot,ht,"â"),Q("\\sqsubset",ot,ht,"â",309),Q("\\preccurlyeq",ot,ht,"â¼",549),Q("\\curlyeqprec",ot,ht,"â",14),Q("\\vDash",ot,ht,"â¨",646),Q("\\Vvdash",ot,ht,"âª",20),Q("\\bumpeq",ot,ht,"â",13),Q("\\Bumpeq",ot,ht,"â",12),Q("\\geqq",ot,ht,"â§",972),Q("\\eqslantgtr",ot,ht,"âª",13),Q("\\ggg",ot,ht,"â",127),Q("\\gtrless",ot,ht,"â·",417),Q("\\gtreqless",ot,ht,"â",190),Q("\\gtreqqless",ot,ht,"âª",91),Q("\\supseteqq",ot,ht,"â«",6),Q("\\Supset",ot,ht,"â",34),Q("\\sqsupset",ot,ht,"â",71),Q("\\succcurlyeq",ot,ht,"â½",442),Q("\\curlyeqsucc",ot,ht,"â",10),Q("\\Vdash",ot,ht,"â©",276),Q("\\shortmid",ot,ht,"â£",67),Q("\\shortparallel",ot,ht,"â¥",17),Q("\\between",ot,ht,"â¬",110),Q("\\pitchfork",ot,ht,"â",66),Q("\\varpropto",ot,ht,"â",203),Q("\\backepsilon",ot,ht,"â",176),Q("\\llless",ot,ht,"â",J),Q("\\gggtr",ot,ht,"â",J),Q("\\lhd",ot,ct,"â²",447),Q("\\rhd",ot,ct,"â³",338),Q("\\Join","",ht,"â",35),Q("\\doteq","",ht,"â",1450),Q("\\doteqdot",ot,ht,"â",60),Q("\\Doteq",ot,ht,"â",J),Q("\\eqcirc",ot,ht,"â",6),Q("\\circeq",ot,ht,"â",31),Q("\\lessdot",ot,ct,"â",88),Q("\\gtrdot",ot,ct,"â",45),Q("\\~","",ht,"~"),X="Logic",Q("\\leftrightarrow","",ht,"â",V),Q("\\Leftrightarrow","",ht,"â",V),Q("\\to","",ht,"â",V),Q("\\models","",ht,"â¨",$),Q("\\vdash","",ht,"â¢",$),Q("\\therefore",ot,ht,"â´",1129),Q("\\because",ot,ht,"âµ",388),Q("\\implies","",ht,"â¹",1858),Q("\\gets","",ht,"â",150),Q("\\dashv","",ht,"â£",299),Q("\\impliedby","",ht,"â¸",J),Q("\\biconditional","",ht,"â·",J),Q("\\roundimplies","",ht,"â¥°",J),X="Operators",Q("+","",ct,"+",V),Q("-","",ct,"â",V),Q("â","",ct,"â",V),Q("\\pm","",ct,"Â±",$),Q("\\mp","",ct,"â",$),Q("*","",ct,"â",$),Q("\\times","",ct,"Ã",$),Q("\\div","",ct,"Ã·",$),Q("\\surd","",lt,"â",$),Q("\\divides","",ct,"â£",J),Q("\\ltimes",ot,ct,"â",576),Q("\\rtimes",ot,ct,"â",946),Q("\\leftthreetimes",ot,ct,"â",34),Q("\\rightthreetimes",ot,ct,"â",14),Q("\\intercal",ot,ct,"âº",478),Q("\\dotplus",ot,ct,"â",81),Q("\\centerdot",ot,ct,"â",271),Q("\\doublebarwedge",ot,ct,"â©",5),Q("\\divideontimes",ot,ct,"â",51),Q("\\cdot","",ct,"â",J),X="Others",Q("\\infty","",lt,"â",V),Q("\\prime","",at,"â²",V),Q("\\doubleprime","",lt,"â³"),Q("\\angle","",lt,"â ",$),Q("`","",lt,"â"),Q("\\$","",lt,"$"),Q("\\%","",lt,"%"),Q("\\_","",lt,"_"),X="Greek",Q("\\alpha","",at,"Î±",$),Q("\\beta","",at,"Î²",$),Q("\\gamma","",at,"Î³",$),Q("\\delta","",at,"Î´",$),Q("\\epsilon","",at,"Ïµ",$),Q("\\varepsilon","",at,"Îµ"),Q("\\zeta","",at,"Î¶",$),Q("\\eta","",at,"Î·",$),Q("\\theta","",at,"Î¸",$),Q("\\vartheta","",at,"Ï",$),Q("\\iota","",at,"Î¹",$),Q("\\kappa","",at,"Îº",$),Q("\\varkappa",ot,at,"Ï°",$),Q("\\lambda","",at,"Î»",$),Q("\\mu","",at,"Î¼",$),Q("\\nu","",at,"Î½",$),Q("\\xi","",at,"Î¾",$),Q("\\omicron","",at,"o"),Q("\\pi","",at,"Ï",$),Q("\\varpi","",at,"Ï",$),Q("\\rho","",at,"Ï",$),Q("\\varrho","",at,"Ï±",$),Q("\\sigma","",at,"Ï",$),Q("\\varsigma","",at,"Ï",$),Q("\\tau","",at,"Ï",$),Q("\\phi","",at,"Ï",$),Q("\\varphi","",at,"Ï",$),Q("\\upsilon","",at,"Ï",$),Q("\\chi","",at,"Ï",$),Q("\\psi","",at,"Ï",$),Q("\\omega","",at,"Ï",$),Q("\\Gamma","",at,"Î",$),Q("\\Delta","",at,"Î",$),Q("\\Theta","",at,"Î",$),Q("\\Lambda","",at,"Î",$),Q("\\Xi","",at,"Î",$),Q("\\Pi","",at,"Î ",$),Q("\\Sigma","",at,"Î£",$),Q("\\Upsilon","",at,"Î¥",$),Q("\\Phi","",at,"Î¦",$),Q("\\Psi","",at,"Î¨",$),Q("\\Omega","",at,"Î©",$),Q("\\digamma",ot,at,"Ï",248),X="Others",Q("\\emptyset","",lt,"â",V),Q("\\varnothing",ot,lt,"â",V),X="Set Operators",Q("\\cap","",ct,"â©",V),Q("\\cup","",ct,"âª",V),Q("\\setminus","",ct,"â",$),Q("\\smallsetminus",ot,ct,"â",254),Q("\\complement",ot,lt,"â",200),X="Set Relations",Q("\\in","",ht,"â",V),Q("\\notin","",ht,"â",V),Q("\\not","",ht,"Ì¸",$),Q("\\ni","",ht,"â",$),Q("\\owns","",ht,"â",18),Q("\\subset","",ht,"â",V),Q("\\supset","",ht,"â",V),Q("\\subseteq","",ht,"â",V),Q("\\supseteq","",ht,"â",V),Q("\\subsetneq",ot,ht,"â",1945),Q("\\varsubsetneq",ot,ht,"î",198),Q("\\subsetneqq",ot,ht,"â«",314),Q("\\varsubsetneqq",ot,ht,"î",55),Q("\\nsubset",ot,ht,"â",J),Q("\\nsupset",ot,ht,"â",J),Q("\\nsubseteq",ot,ht,"â",950),Q("\\nsupseteq",ot,ht,"â",49),X="Spacing",Q("\\ ","",pt,"Â "),Q("~","",pt,"Â "),Q("\\space","",pt,"Â "),Q("\\!","",pt,null),Q("\\,","",pt,null),Q("\\:","",pt,null),Q("\\;","",pt,null),Q("\\enskip","",pt,null),Q("\\enspace","",pt,null,672),Q("\\quad","",pt,null,$),Q("\\qquad","",pt,null,$),yt(["\\hspace","\\hspace*"],"{width:skip}",{allowedInText:!0},(function(t,e){return{type:"spacing",width:e[0]||0}})),yt(["\\mathop","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathord","\\mathinner"],"{:auto}",null,(function(t,e){const i={type:{"\\mathop":"mop","\\mathbin":"mbin","\\mathrel":"mrel","\\mathopen":"mopen","\\mathclose":"mclose","\\mathpunct":"mpunct","\\mathord":"mord","\\mathinner":"minner"}[t],body:xt(e[0])||e[0],captureSelection:!0,baseFontFamily:"\\mathop"===t?"math":""};return"\\mathop"===t&&(i.limits="nolimits",i.isFunction=!0),i})),yt(["\\operatorname","\\operatorname*"],"{operator:string}",null,(function(t,e){const i={type:"mop",skipBoundary:!0,body:e[0],isFunction:!0,baseFontFamily:"cmr"};return"\\operatorname"===t?i.limits="nolimits":"\\operatorname*"===t&&(i.limits="limits"),i})),X="Punctuation",Q("\\colon","","mpunct",":",$),Q("\\cdotp","","mpunct","â",$),Q("\\ldots","","minner","â¦",$),Q("\\cdots","","minner","â¯",$),Q("\\ddots","","minner","â±",$),Q("\\mathellipsis","","minner","â¦",91),Q("\\vdots","",lt,"â®",$),Q("\\ldotp","","mpunct",".",18),Q(",","","mpunct",","),Q(";","","mpunct",";"),X="Logical Operators",Q("\\wedge","",ct,"â§",V),Q("\\vee","",ct,"â¨",V),Q("\\lnot","",lt,"Â¬",$),Q("\\neg","",lt,"Â¬",V),Q("\\land","",ct,"â§",659),Q("\\lor","",ct,"â¨",364),Q("\\barwedge",ot,ct,"â¼",21),Q("\\veebar",ot,ct,"â»",43),Q("\\nor",ot,ct,"â»",7),Q("\\curlywedge",ot,ct,"â",58),Q("\\curlyvee",ot,ct,"â",57),X="Boxes",Q("\\square",ot,lt,"â¡",$),Q("\\Box",ot,lt,"â¡",$),Q("\\blacksquare",ot,lt,"â ",1679),Q("\\boxminus",ot,ct,"â",79),Q("\\boxplus",ot,ct,"â",276),Q("\\boxtimes",ot,ct,"â ",457),Q("\\boxdot",ot,ct,"â¡",120),X="Circles",Q("\\circ","",ct,"â",V),Q("\\bigcirc","",ct,"â¯",903),Q("\\bullet","",ct,"â",$),Q("\\circleddash",ot,ct,"â",$),Q("\\circledast",ot,ct,"â",339),Q("\\oplus","",ct,"â",$),Q("\\ominus","",ct,"â",1568),Q("\\otimes","",ct,"â",$),Q("\\odot","",ct,"â",$),Q("\\circledcirc",ot,ct,"â",93),Q("\\oslash","",ct,"â",497),Q("\\circledS",ot,lt,"â",31),Q("\\circledR",ot,lt,"Â®",1329),X="Triangles",Q("\\triangle","",lt,"â³",$),Q("\\triangleq",ot,ht,"â",$),Q("\\bigtriangleup","",ct,"â³",1773),Q("\\vartriangle",ot,ht,"â³",762),Q("\\triangledown",ot,lt,"â½",520),Q("\\bigtriangledown","",ct,"â½",661),Q("\\triangleleft","",ct,"â",534),Q("\\vartriangleleft",ot,ht,"â²",281),Q("\\trianglelefteq",ot,ht,"â´",176),Q("\\ntriangleleft",ot,ht,"âª",13),Q("\\ntrianglelefteq",ot,ht,"â¬",22),Q("\\triangleright","",ct,"â¹",516),Q("\\vartriangleright",ot,ht,"â³",209),Q("\\trianglerighteq",ot,ht,"âµ",45),Q("\\ntriangleright",ot,ht,"â«",15),Q("\\ntrianglerighteq",ot,ht,"â­",6),Q("\\blacktriangle",ot,lt,"â²",360),Q("\\blacktriangledown",ot,lt,"â¼",159),Q("\\blacktriangleleft",ot,ht,"â",101),Q("\\blacktriangleright",ot,ht,"â¶",271),X="Others",Q("\\/","",at,"/"),Q("|","","textord","â£"),X="Big Operators",Q("\\sqcup","",ct,"â",1717),Q("\\sqcap","",ct,"â",735),Q("\\uplus","",ct,"â",597),Q("\\wr","",ct,"â",286),Q("\\Cap",ot,ct,"â",2),Q("\\Cup",ot,ct,"â",2),Q("\\doublecap",ot,ct,"â",1),Q("\\doublecup",ot,ct,"â",1),Q("\\amalg","",ct,"â¨¿",J),Q("\\And","",ct,"&"),X="Accents",yt(["\\acute","\\grave","\\dot","\\ddot","\\mathring","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec"],"{body:auto}",null,(function(t,e){return{type:"accent",accent:{"\\acute":"Ë","\\grave":"Ë","\\dot":"Ë","\\ddot":"Â¨","\\mathring":"Ë","\\tilde":"~","\\bar":"Ë","\\breve":"Ë","\\check":"Ë","\\hat":"^","\\vec":"â"}[t],limits:"accent",skipBoundary:!0,body:e[0]}})),K($,"\\bar","\\ddot","\\acute","\\tilde","\\check"),K(1548,"\\breve"),K(735,"\\grave"),K(V,"\\vec"),X="Letters and Letter Like Forms",Q("\\imath","",lt,"Ä±"),Q("\\jmath","",lt,"È·"),X="Others",Q("\\degree","",lt,"Â°",46),X="Others",Q("'","",lt,"â²"),Q('"',"",lt,"â"),X="Others",yt("\\^","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"Ã¢",e:"Ãª",i:"Ã®",o:"Ã´",u:"Ã»",A:"Ã",E:"Ã",I:"Ã",O:"Ã",U:"Ã"}[e[0]]||"^",baseFontFamily:"cmr"}})),yt("\\`","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"Ã ",e:"Ã¨",i:"Ã¬",o:"Ã²",u:"Ã¹",A:"Ã",E:"Ã",I:"Ã",O:"Ã",U:"Ã"}[e[0]]||"`",baseFontFamily:"cmr"}})),yt("\\'","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{a:"Ã¡",e:"Ã©",i:"Ã­",o:"Ã³",u:"Ãº",A:"Ã",E:"Ã",I:"Ã",O:"Ã",U:"Ã"}[e[0]]||"^",baseFontFamily:"cmr"}})),yt("\\~","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{n:"Ã±",N:"Ã",a:"Ã£",o:"Ãµ",A:"Ã",O:"Ã"}[e[0]]||"Â´",baseFontFamily:"cmr"}})),yt("\\c","{:string}",{allowedInText:!0},(function(t,e){return{type:"mord",limits:"nolimits",symbol:!0,isFunction:!1,body:e[0]&&{c:"Ã§",C:"Ã"}[e[0]]||"",baseFontFamily:"cmr"}}));const Ct={"\\#":"#","\\&":"&","\\$":"$","\\%":"%","\\_":"_","\\euro":"â¬","\\maltese":"â ","\\{":"{","\\}":"}","\\nobreakspace":"Â ","\\ldots":"â¦","\\textellipsis":"â¦","\\backslash":"\\","`":"â","'":"â","``":"â","''":"â","\\degree":"Â°","\\textasciicircum":"^","\\textasciitilde":"~","\\textasteriskcentered":"*","\\textbackslash":"\\","\\textbraceleft":"{","\\textbraceright":"}","\\textbullet":"â¢","\\textdollar":"$","\\textsterling":"Â£","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â",'"':"â","\\ss":"Ã","\\ae":"Ã¦","\\oe":"Å","\\AE":"Ã","\\OE":"Å","\\O":"Ã","\\i":"Ä±","\\j":"È·","\\aa":"Ã¥","\\AA":"Ã"},_t="undefined"!=typeof navigator&&/firefox|edge/i.test(navigator.userAgent)?/[a-zA-ZÐ°ÐÐ±ÐÐ²ÐÐ³ÐÐ´ÐÐµÐÑÐÐ¶ÐÐ·ÐÐ¸ÐÐ¹ÐÐºÐÐ»ÐÐ¼ÐÐ½ÐÐ¾ÐÐ¿ÐÑÐ ÑÐ¡ÑÐ¢ÑÐ£ÑÐ¤ÑÐ¥ÑÐ¦ÑÐ§ÑÐ¨ÑÐ©ÑÐªÑÐ«ÑÐ¬ÑÐ­ÑÐ®ÑÄÄÄÄÄÄÅÅÅÅÃÃ³ÅÅÅ¹ÅºÅ»Å¼Ã Ã¢Ã¤Ã´Ã©Ã¨Ã«ÃªÃ¯Ã®Ã§Ã¹Ã»Ã¼Ã¿Ã¦ÅÃÃÃÃÃÃÃÃÃÃÅ¸ÃÃÃÃÃÅÃ¤Ã¶Ã¼ÃÃÃÃáºÃ Ã¨Ã©Ã¬Ã­Ã®Ã²Ã³Ã¹ÃºÃÃÃÃÃÃÃÃÃÃÃ¡Ã©Ã­Ã±Ã³ÃºÃ¼ÃÃÃÃÃÃÃ]/:new RegExp("\\p{Letter}","u"),wt="undefined"!=typeof navigator&&/firefox|edge/i.test(navigator.userAgent)?/[0-9a-zA-ZÐ°ÐÐ±ÐÐ²ÐÐ³ÐÐ´ÐÐµÐÑÐÐ¶ÐÐ·ÐÐ¸ÐÐ¹ÐÐºÐÐ»ÐÐ¼ÐÐ½ÐÐ¾ÐÐ¿ÐÑÐ ÑÐ¡ÑÐ¢ÑÐ£ÑÐ¤ÑÐ¥ÑÐ¦ÑÐ§ÑÐ¨ÑÐ©ÑÐªÑÐ«ÑÐ¬ÑÐ­ÑÐ®ÑÄÄÄÄÄÄÅÅÅÅÃÃ³ÅÅÅ¹ÅºÅ»Å¼Ã Ã¢Ã¤Ã´Ã©Ã¨Ã«ÃªÃ¯Ã®Ã§Ã¹Ã»Ã¼Ã¿Ã¦ÅÃÃÃÃÃÃÃÃÃÃÅ¸ÃÃÃÃÃÅÃ¤Ã¶Ã¼ÃÃÃÃáºÃ Ã¨Ã©Ã¬Ã­Ã®Ã²Ã³Ã¹ÃºÃÃÃÃÃÃÃÃÃÃÃ¡Ã©Ã­Ã±Ã³ÃºÃ¼ÃÃÃÃÃÃÃ]/:new RegExp("[0-9\\p{Letter}]","u");var St={matchCodepoint:et,commandAllowed:function(t,e){return!(!G[e]||"text"===t&&!G[e].allowedInText)||!!{text:Ct,math:U}[t][e]},unicodeToMathVariant:nt,mathVariantToUnicode:function(t,e,i){if(!/[A-Za-z0-9]/.test(t))return t;if(!e&&!i)return t;const s=t.codePointAt(0);for(let n=0;n<st.length;n++)if((!e||st[n].variant===e)&&(!i||st[n].style===i)&&s>=st[n].offset&&s<st[n].offset+st[n].len){const t=st[n].start+s-st[n].offset;return String.fromCodePoint(it[t]||t)}return t},unicodeStringToLatex:function(t,e){let i="";for(const s of e)i+=rt(t,s.codePointAt(0));return i},getInfo:function(t,e,i){if(0===t.length)return null;let s=null;if("\\"===t.charAt(0)){if(s=G[t],s)return"math"===e||s.allowedInText?s:null;if(s||("math"===e?s=U[t]:Ct[t]&&(s={value:Ct[t]})),!s){const e=t.slice(1);if(i&&i[e]){let t=i[e];"object"==typeof t&&(t=t.def);let n=0;for(/(^|[^\\])#1/.test(t)&&(n=1),/(^|[^\\])#2/.test(t)&&(n=2),/(^|[^\\])#3/.test(t)&&(n=3),/(^|[^\\])#4/.test(t)&&(n=4),/(^|[^\\])#5/.test(t)&&(n=5),/(^|[^\\])#6/.test(t)&&(n=6),/(^|[^\\])#7/.test(t)&&(n=7),/(^|[^\\])#8/.test(t)&&(n=8),/(^|[^\\])#9/.test(t)&&(n=9),s={type:"group",allowedInText:!1,params:[],infix:!1};n>=1;)s.params.push({optional:!1,type:"math",defaultValue:null,placeholder:null}),n-=1}}}else"math"===e?s=U[t]:Ct[t]&&(s={value:Ct[t]});return!s||"mord"!==s.type||"f"!==s.value&&"g"!==s.value&&"h"!==s.value||(s.isFunction=!0),s},getValue:function(t,e){return"math"===t?U[e]&&U[e].value?U[e].value:e:Ct[e]?Ct[e]:e},getEnvironmentInfo:function(t){let e=H[t];return e||(e={params:"",parser:null,mathstyle:"displaystyle",tabular:!0,colFormat:[],lFence:".",rFence:"."}),e},suggest:function(t){if(t.length<=1)return[];const e=[];for(const i in G)Object.prototype.hasOwnProperty.call(G,i)&&i.startsWith(t)&&!G[i].infix&&e.push({match:i,frequency:G[i].frequency});for(const i in U)Object.prototype.hasOwnProperty.call(U,i)&&i.startsWith(t)&&e.push({match:i,frequency:U[i].frequency});return e.sort((t,e)=>t.frequency===e.frequency?t.match.length-e.match.length:(e.frequency||0)-(t.frequency||0)),e},FREQUENCY_VALUE:W,TEXT_SYMBOLS:Ct,MATH_SYMBOLS:U,ENVIRONMENTS:H,RIGHT_DELIM:{"(":")","{":"}","[":"]","|":"|","\\lbrace":"\\rbrace","\\{":"\\}","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},FUNCTIONS:G,MACROS:{iff:"\\;âº\\;",nicefrac:"^{#1}\\!\\!/\\!_{#2}",bra:"\\mathinner{\\langle{#1}|}",ket:"\\mathinner{|{#1}\\rangle}",braket:"\\mathinner{\\langle{#1}\\rangle}",set:"\\mathinner{\\lbrace #1 \\rbrace}",Bra:"\\left\\langle #1\\right|",Ket:"\\left|#1\\right\\rangle",Braket:"\\left\\langle{#1}\\right\\rangle",Set:"\\left\\lbrace #1 \\right\\rbrace"},COMMAND_MODE_CHARACTERS:/[a-zA-Z0-9!@*()-=+{}[\]\\';:?/.,~<>`|'$%#&^_" ]/,LETTER:_t,LETTER_AND_DIGITS:wt};const Pt=q.makeSymbol,kt=q.makeSpan,Et=q.makeVlist;function Tt(t,e,i,s,n,r){const o=Pt("Size"+i+"-Regular",St.getValue("math",e)),a=q.makeStyleWrap(t,kt(o,"delimsizing size"+i),n.mathstyle,P.TEXT,r);return s&&a.setTop((1-n.mathstyle.sizeMultiplier)*n.mathstyle.metrics.axisHeight),a.setStyle("color",n.color),"number"==typeof n.opacity&&a.setStyle("opacity",n.opacity),a}function At(t,e){let i="";return"Size1-Regular"===e?i=" delim-size1":"Size4-Regular"===e&&(i=" delim-size4"),kt(Pt(e,St.getValue("math",t)),"delimsizinginner"+i)}function Ot(t,e,i,s,n,r){let o,a,l,c;o=l=c=St.getValue("math",e),a=null;let h="Size1-Regular";"\\vert"===e||"\\lvert"===e||"\\rvert"===e||"\\mvert"===e||"\\mid"===e?l=o=c="â£":"\\Vert"===e||"\\lVert"===e||"\\rVert"===e||"\\mVert"===e||"\\|"===e?l=o=c="â¥":"\\uparrow"===e?l=c="â":"\\Uparrow"===e?l=c="â":"\\downarrow"===e?o=l="â":"\\Downarrow"===e?o=l="â":"\\updownarrow"===e?(o="â",l="â",c="â"):"\\Updownarrow"===e?(o="â",l="â",c="â"):"["===e||"\\lbrack"===e?(o="â¡",l="â¢",c="â£",h="Size4-Regular"):"]"===e||"\\rbrack"===e?(o="â¤",l="â¥",c="â¦",h="Size4-Regular"):"\\lfloor"===e?(l=o="â¢",c="â£",h="Size4-Regular"):"\\lceil"===e?(o="â¡",l=c="â¢",h="Size4-Regular"):"\\rfloor"===e?(l=o="â¥",c="â¦",h="Size4-Regular"):"\\rceil"===e?(o="â¤",l=c="â¥",h="Size4-Regular"):"("===e?(o="â",l="â",c="â",h="Size4-Regular"):")"===e?(o="â",l="â",c="â ",h="Size4-Regular"):"\\{"===e||"\\lbrace"===e?(o="â§",a="â¨",c="â©",l="âª",h="Size4-Regular"):"\\}"===e||"\\rbrace"===e?(o="â«",a="â¬",c="â­",l="âª",h="Size4-Regular"):"\\lgroup"===e?(o="â§",c="â©",l="âª",h="Size4-Regular"):"\\rgroup"===e?(o="â«",c="â­",l="âª",h="Size4-Regular"):"\\lmoustache"===e?(o="â§",c="â­",l="âª",h="Size4-Regular"):"\\rmoustache"===e?(o="â«",c="â©",l="âª",h="Size4-Regular"):"\\surd"===e?(o="î",c="â·",l="î",h="Size4-Regular"):"\\ulcorner"===e?(o="â",l=c=" "):"\\urcorner"===e?(o="â",l=c=" "):"\\llcorner"===e?(c="â",l=o=" "):"\\lrcorner"===e&&(o="â",l=o=" ");const u=p.getCharacterMetrics(St.getValue("math",o),h),d=u.height+u.depth,f=p.getCharacterMetrics(St.getValue("math",l),h),m=f.height+f.depth,g=p.getCharacterMetrics(St.getValue("math",c),h),b=g.height+g.depth;let y=0,v=1;if(null!==a){const t=p.getCharacterMetrics(St.getValue("math",a),h);y=t.height+t.depth,v=2}const x=d+b+y,C=Math.ceil((i-x)/(v*m));let _=n.mathstyle.metrics.axisHeight;s&&(_*=n.mathstyle.sizeMultiplier);const w=(x+C*v*m)/2-_,S=[];if(S.push(At(c,h)),null===a)for(let p=0;p<C;p++)S.push(At(l,h));else{for(let t=0;t<C;t++)S.push(At(l,h));S.push(At(a,h));for(let t=0;t<C;t++)S.push(At(l,h))}S.push(At(o,h));const k=Et(n,S,"bottom",w);return k.setStyle("color",n.color),"number"==typeof n.opacity&&k.setStyle("opacity",n.opacity),q.makeStyleWrap(t,kt(k,"delimsizing mult"),n.mathstyle,P.TEXT,r)}const Mt=["(",")","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","\\lceil","\\rceil","\\surd"],Nt=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\mvert","\\mid","\\lgroup","\\rgroup","\\lmoustache","\\rmoustache"],Lt=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Dt=[0,1.2,1.8,2.4,3],jt=[{type:"small",mathstyle:P.SCRIPTSCRIPT},{type:"small",mathstyle:P.SCRIPT},{type:"small",mathstyle:P.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Rt=[{type:"small",mathstyle:P.SCRIPTSCRIPT},{type:"small",mathstyle:P.SCRIPT},{type:"small",mathstyle:P.TEXT},{type:"stack"}],It=[{type:"small",mathstyle:P.SCRIPTSCRIPT},{type:"small",mathstyle:P.SCRIPT},{type:"small",mathstyle:P.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}];function Bt(t,e,i,s,n,r){if(!e||0===e.length||"."===e)return Ft(t,n,t);let o;"<"===e||"\\lt"===e?e="\\langle":">"!==e&&"\\gt"!==e||(e="\\rangle"),o=Lt.includes(e)?jt:Mt.includes(e)?It:Rt;const a=function(t,e,i,s){for(let r=Math.min(2,3-s.mathstyle.size);r<i.length&&"stack"!==i[r].type;r++){const s=p.getCharacterMetrics(t,"small"===(n=i[r]).type?"Main-Regular":"large"===n.type?"Size"+n.size+"-Regular":"Size4-Regular");if(s.defaultMetrics)return{type:"small",mathstyle:P.SCRIPT};let o=s.height+s.depth;if("small"===i[r].type&&(o*=i[r].mathstyle.sizeMultiplier),o>e)return i[r]}var n;return i[i.length-1]}(St.getValue("math",e),i,o,n);return"small"===a.type?function(t,e,i,s,n,r){const o=Pt("AMS-Regular",St.getValue("math",e)),a=q.makeStyleWrap(t,o,n.mathstyle,i,r);return s&&a.setTop((1-n.mathstyle.sizeMultiplier/i.sizeMultiplier)*n.mathstyle.metrics.axisHeight),a.setStyle("color",n.color),"number"==typeof n.opacity&&a.setStyle("opacity",n.opacity),a}(t,e,a.mathstyle,s,n,r):"large"===a.type?Tt(t,e,a.size,s,n,r):Ot(t,e,i,s,n,r)}function Ft(t,e,i){return q.makeSpanOfType(t,"","sizing"+e.mathstyle.adjustTo(P.TEXT)+" nulldelimiter "+(i||""))}var Yt={makeSizedDelim:function(t,e,i,s,n){return"."===e?Ft(t,s,n):("<"===e||"\\lt"===e?e="\\langle":">"!==e&&"\\gt"!==e||(e="\\rangle"),Mt.includes(e)||Lt.includes(e)?Tt(t,e,i,!1,s,n):Nt.includes(e)?Ot(t,e,Dt[i],!1,s,n):null)},makeCustomSizedDelim:Bt,makeLeftRightDelim:function(t,e,i,s,n,r){if("."===e)return Ft(t,n,r);const o=n.mathstyle.metrics.axisHeight*n.mathstyle.sizeMultiplier,a=5/p.METRICS.ptPerEm;let l=s+o,c=i-o;c=Math.max(l,c);let h=901*c/500;return l=2*c-a,h=Math.max(h,l),Bt(t,e,h,!0,n,r)}};const zt=q.makeSpan,qt=q.makeOrd,Xt=q.makeInner,Ut=q.makeHlist,Gt=q.makeVlist,Ht=/\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5/,Jt=/^([A-Za-z]|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5)$/,$t={size1:.5,size2:.7,size3:.8,size4:.9,size5:1,size6:1.2,size7:1.44,size8:1.73,size9:2.07,size10:2.49};class Vt{constructor(t,e,i,s){this.mode=t,this.type=e,this.body=i,this.applyStyle(s)}getStyle(){return{color:this.phantom?"transparent":this.color,backgroundColor:this.phantom?"transparent":this.backgroundColor,fontFamily:this.baseFontFamily||this.fontFamily||this.autoFontFamily,fontShape:this.fontShape,fontSeries:this.fontSeries,fontSize:this.fontSize,cssId:this.cssId,cssClass:this.cssClass}}applyStyle(t){if(Object.assign(this,t),"none"===this.fontFamily&&(this.fontFamily=""),"auto"===this.fontShape&&(this.fontShape=""),"auto"===this.fontSeries&&(this.fontSeries=""),"none"===this.color&&(this.color=""),"none"===this.backgroundColor&&(this.backgroundColor=""),"auto"===this.fontSize&&(this.fontSize=""),this.fontSize&&(this.maxFontSize=$t[this.fontSize]),"math"===this.mode){const t="string"==typeof this.body?this.body:"";this.autoFontFamily="cmr",Jt.test(t)?this.autoFontFamily="math":/\\imath|\\jmath|\\pounds/.test(t)?this.autoFontFamily="mainit":Ht.test(t)||"math"!==this.baseFontFamily||(this.autoFontFamily="cmr")}else"text"===this.mode&&("root"!==this.type&&(this.type=""),delete this.baseFontFamily,delete this.autoFontFamily)}getInitialBaseElement(){let t=this;return Array.isArray(this.body)&&this.body.length>0&&("first"!==this.body[0].type?t=this.body[0].getInitialBaseElement():this.body[1]&&(t=this.body[1].getInitialBaseElement())),t}getFinalBaseElement(){return Array.isArray(this.body)&&this.body.length>0?this.body[this.body.length-1].getFinalBaseElement():this}isCharacterBox(){const t=this.getInitialBaseElement();return/minner|mbin|mrel|mpunct|mopen|mclose|textord/.test(t.type)}forEach(t){if(t(this),Array.isArray(this.body))for(const e of this.body)e&&e.forEach(t);else this.body&&"object"==typeof this.body&&t(this.body);if(this.superscript)for(const e of this.superscript)e&&e.forEach(t);if(this.subscript)for(const e of this.subscript)e&&e.forEach(t);if(this.overscript)for(const e of this.overscript)e&&e.forEach(t);if(this.underscript)for(const e of this.underscript)e&&e.forEach(t);if(this.numer)for(const e of this.numer)e&&e.forEach(t);if(this.denom)for(const e of this.denom)e&&e.forEach(t);if(this.index)for(const e of this.index)e&&e.forEach(t);if(this.array)for(const e of this.array)for(const i of e)for(const e of i)e.forEach(t)}filter(t){let e=[];t(this)&&e.push(this);for(const i of["body","superscript","subscript","overscript","underscript","numer","denom","index"])if(Array.isArray(this[i]))for(const s of this[i])s&&(e=e.concat(s.filter(t)));if(Array.isArray(this.array))for(const i of this.array)for(const s of i)s&&(e=e.concat(s.filter(t)));return e}decomposeGroup(t){const e=t.clone({mathstyle:this.mathstyle}),i=qt(Zt(e,this.body));return this.cssId&&(i.cssId=this.cssId),i.applyStyle({backgroundColor:this.backgroundColor,cssClass:this.cssClass}),i}decomposeArray(t){let e=this.colFormat;e&&0===e.length&&(e=[{align:"l"}]),e||(e=[{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"}]);const i=[];let s=0;for(const h of e)h.align&&s++;for(const h of this.array){let t=0;for(;t<h.length;){const e=[],n=Math.min(h.length,t+s);for(;t<n;)e.push(h[t++]);i.push(e)}}1===i[i.length-1].length&&0===i[i.length-1][0].length&&i.pop();const n=P.toMathstyle(this.mathstyle)||t.mathstyle,r=(this.arraystretch||1)*h.baselineskip,o=.7*r,a=.3*r;let l=0,c=0;const u=[],d=i.length;for(let h=0;h<d;++h){const e=i[h];c=Math.max(c,e.length);let s=o,n=a;const r=[];for(let i=0;i<e.length;++i){const o=Zt(t.clone({mathstyle:this.mathstyle}),e[i])||[],a=[qt(null)].concat(o);n=Math.max(n,q.depth(a)),s=Math.max(s,q.height(a)),r.push(a)}let p=h===d-1?0:this.jot||0;this.rowGaps&&this.rowGaps[h]&&(p=this.rowGaps[h],p>0&&(p+=a,n<p&&(n=p),p=0)),r.height=s,r.depth=n,l+=s,r.pos=l,l+=n+p,u.push(r)}const p=l/2+n.metrics.axisHeight,f=[];for(let h=0;h<c;h++){const e=[];for(const t of u){const i=t[h];i&&(i.depth=t.depth,i.height=t.height,e.push(i),e.push(t.pos-p))}e.length>0&&f.push(Gt(t,e,"individualShift"))}const m=[];let g=!1,b=!1,y=0,v=!this.lFence;for(const w of e){if(w.align&&y>=f.length)break;if(w.align&&y<f.length)g?m.push(Wt(2*h.arraycolsep)):(b||v)&&m.push(Wt(h.arraycolsep)),m.push(zt(f[y],"col-align-"+w.align)),y++,g=!0,b=!1,v=!1;else if(void 0!==w.gap)m.push("number"==typeof w.gap?Wt(w.gap):Kt(t,u,p,w.gap)),g=!1,b=!1,v=!1;else if(w.rule){const e=zt(null,"vertical-separator");e.setStyle("height",l,"em"),e.setStyle("margin-top",3*t.mathstyle.metrics.axisHeight-p,"em"),e.setStyle("vertical-align","top");let i=0;b?i=h.doubleRuleSep-h.arrayrulewidth:g&&(i=h.arraycolsep-h.arrayrulewidth),e.setLeft(i,"em"),m.push(e),g=!1,b=!0,v=!1}}if(g&&!this.rFence&&m.push(Wt(h.arraycolsep)),!(this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence))return qt(m,"mtable");const x=zt(m,"mtable"),C=q.height(x),_=q.depth(x);return qt([this.bind(t,Yt.makeLeftRightDelim("mopen",this.lFence,C,_,t)),x,this.bind(t,Yt.makeLeftRightDelim("mclose",this.rFence,C,_,t))])}decomposeGenfrac(t){const e="auto"===this.mathstyle?t.mathstyle:P.toMathstyle(this.mathstyle),i=t.clone({mathstyle:e});let s=[];this.numerPrefix&&s.push(qt(this.numerPrefix));const n=this.continuousFraction?e:e.fracNum();s=s.concat(Zt(i.clone({mathstyle:n}),this.numer));const r=Ut(s,t.mathstyle.adjustTo(n));let o=[];this.denomPrefix&&o.push(qt(this.denomPrefix));const a=this.continuousFraction?e:e.fracDen();o=o.concat(Zt(i.clone({mathstyle:a}),this.denom));const l=Ut(o,t.mathstyle.adjustTo(a)),c=this.hasBarLine?h.defaultRuleThickness/e.sizeMultiplier:0;let u,d,p;e.size===P.DISPLAY.size?(u=e.metrics.num1,d=c>0?3*c:7*h.defaultRuleThickness,p=e.metrics.denom1):(c>0?(u=e.metrics.num2,d=c):(u=e.metrics.num3,d=3*h.defaultRuleThickness),p=e.metrics.denom2);const f=r?r.depth:0,m=l?l.height:0;let g;if(0===c){const t=u-f-(m-p);t<d&&(u+=.5*(d-t),p+=.5*(d-t)),g=Gt(i,[r,-u,l,p],"individualShift")}else{const t=e.metrics.axisHeight;u-f-(t+.5*c)<d&&(u+=d-(u-f-(t+.5*c))),t-.5*c-(m-p)<d&&(p+=d-(t-.5*c-(m-p)));const s=zt(null," frac-line");s.applyStyle(this.getStyle()),s.height=c;const n=[];r&&(n.push(r),n.push(-u)),n.push(s),n.push(c/2-t),l&&(n.push(l),n.push(p)),g=Gt(i,n,"individualShift")}g.classes+=" mfrac",g.height*=e.sizeMultiplier/t.mathstyle.sizeMultiplier,g.depth*=e.sizeMultiplier/t.mathstyle.sizeMultiplier;const b=e.size===P.DISPLAY.size?e.metrics.delim1:e.metrics.delim2,y=this.bind(t,Yt.makeCustomSizedDelim("mopen",this.leftDelim,b,!0,t.clone({mathstyle:e}))),v=this.bind(t,Yt.makeCustomSizedDelim("mclose",this.rightDelim,b,!0,t.clone({mathstyle:e})));y.applyStyle(this.getStyle()),v.applyStyle(this.getStyle());const x=qt([y,g,v],t.parentSize!==t.size?"sizing reset-"+t.parentSize+" "+t.size:"");return this.bind(t,x)}decomposeLeftright(t){if(!this.body)return this.leftDelim?new Vt("math","mopen",this.leftDelim).decompose(t):this.rightDelim?new Vt("math","mclose",this.rightDelim).decompose(t):null;const e=t.clone(),i=Zt(e,this.body),s=e.mathstyle;let n=0,r=0,o=[];if(n=q.height(i)*s.sizeMultiplier,r=q.depth(i)*s.sizeMultiplier,this.leftDelim&&(o.push(this.bind(t,Yt.makeLeftRightDelim("mopen",this.leftDelim,n,r,e))),o[o.length-1].applyStyle(this.getStyle())),i){for(let s=0;s<i.length;s++)if(i[s].delim){const o=i[s].caret,a=/ML__selected/.test(i[s].classes);i[s]=this.bind(t,Yt.makeLeftRightDelim("minner",i[s].delim,n,r,e)),i[s].caret=o,i[s].selected(a)}o=o.concat(i)}if(this.rightDelim){let i,s=this.rightDelim;"?"===s&&(s={"(":")","\\{":"\\}","\\[":"\\]","\\lbrace":"\\rbrace","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"}[this.leftDelim],s=s||this.leftDelim,i="ML__smart-fence__close"),o.push(this.bind(t,Yt.makeLeftRightDelim("mclose",s,n,r,e,i))),o[o.length-1].applyStyle(this.getStyle())}return this.inner?Xt(o,s.cls()):o}decomposeSurd(t){const e=t.mathstyle,i=Zt(t.cramp(),this.body),s=h.defaultRuleThickness/e.sizeMultiplier;let n=s;e.id<P.TEXT.id&&(n=e.metrics.xHeight);let r=s+n/4;const o=Math.max(2*n,(q.height(i)+q.depth(i))*e.sizeMultiplier)+(r+s),a=zt(Yt.makeCustomSizedDelim("","\\surd",o,!1,t),"sqrt-sign");a.applyStyle(this.getStyle());const l=a.height+a.depth-s;l>q.height(i)+q.depth(i)+r&&(r=(r+l-(q.height(i)+q.depth(i)))/2),a.setTop(a.height-q.height(i)-(r+s));const c=zt(null,t.mathstyle.adjustTo(P.TEXT)+" sqrt-line");c.applyStyle(this.getStyle()),c.height=s;const u=Gt(t,[i,r,c,s]);if(!this.index)return this.bind(t,qt([a,u],"sqrt"));const d=t.clone({mathstyle:P.SCRIPTSCRIPT}),p=zt(Zt(d,this.index),e.adjustTo(P.SCRIPTSCRIPT)),f=Math.max(a.height,u.height),m=Math.max(a.depth,u.depth),g=Gt(t,[p],"shift",-.6*(f-m));return this.bind(t,qt([zt(g,"root"),a,u],"sqrt"))}decomposeAccent(t){const e=t.mathstyle;let i=Zt(t.cramp(),this.body);(this.superscript||this.subscript)&&(i=this.attachSupsub(t,qt(i),"mord"));let s=0;Array.isArray(this.body)&&1===this.body.length&&this.body[0].isCharacterBox()&&(s=q.skew(i));const n=Math.min(q.height(i),e.metrics.xHeight),r=q.makeSymbol("Main-Regular",this.accent,"math");r.italic=0;const o="â"===this.accent?" accent-vec":"";let a=zt(zt(r),"accent-body"+o);return a=Gt(t,[i,-n,a]),a.children[1].setLeft(2*s),qt(a,"accent")}decomposeLine(t){const e=t.mathstyle,i=Zt(t.cramp(),this.body),s=h.defaultRuleThickness/e.sizeMultiplier,n=zt(null,t.mathstyle.adjustTo(P.TEXT)+" "+this.position+"-line");let r;if(n.height=s,n.maxFontSize=1,"overline"===this.position)r=Gt(t,[i,3*s,n,s]);else{const e=zt(i);r=Gt(t,[s,n,3*s,e],"top",q.height(e))}return qt(r,this.position)}decomposeOverunder(t){const e=Zt(t,this.body),i=t.clone({mathstyle:"scriptstyle"}),s=this.overscript?zt(Zt(i,this.overscript),t.mathstyle.adjustTo(i.mathstyle)):null,n=this.underscript?zt(Zt(i,this.underscript),t.mathstyle.adjustTo(i.mathstyle)):null;return Qt(t,e,0,0,s,n,this.mathtype||"mrel")}decomposeOverlap(t){const e=zt(Zt(t,this.body),"inner");return qt([e,zt(null,"fix")],"left"===this.align?"llap":"rlap")}decomposeRule(t){const e=t.mathstyle,i=qt("","rule");let s=this.shift&&!isNaN(this.shift)?this.shift:0;s/=e.sizeMultiplier;const n=this.width/e.sizeMultiplier,r=this.height/e.sizeMultiplier;return i.setStyle("border-right-width",n,"em"),i.setStyle("border-top-width",r,"em"),i.setStyle("margin-top",-(r-s),"em"),i.setStyle("border-color",t.color),i.width=n,i.height=r+s,i.depth=-s,i}decomposeOp(t){const e=t.mathstyle;let i,s=!1;e.size===P.DISPLAY.size&&"string"==typeof this.body&&"\\smallint"!==this.body&&(s=!0);let n=0,r=0;if(this.symbol?(i=q.makeSymbol(s?"Size2-Regular":"Size1-Regular",this.body,"op-symbol "+(s?"large-op":"small-op")),i.type="mop",n=(i.height-i.depth)/2-e.metrics.axisHeight*e.sizeMultiplier,r=i.italic,this.bind(t,i)):Array.isArray(this.body)?(i=q.makeOp(Zt(t,this.body)),this.bind(t,i)):i=this.makeSpan(t,this.body),this.superscript||this.subscript){const s=this.limits||"auto";return this.alwaysHandleSupSub||"limits"===s||"auto"===s&&e.size===P.DISPLAY.size?this.attachLimits(t,i,n,r):this.attachSupsub(t,i,"mop")}return this.symbol&&i.setTop(n),i}decomposeBox(t){const e=qt(Zt(t,this.body)),i=zt();i.setStyle("position","absolute");const s="number"==typeof this.padding?this.padding:h.fboxsep;i.setStyle("height",e.height+e.depth+2*s,"em"),i.setStyle("width",0!==s?"calc(100% + "+2*s+"em)":"100%"),i.setStyle("top",-s,"em"),i.setStyle("left",-s,"em"),i.setStyle("z-index","-1"),this.backgroundcolor&&i.setStyle("background-color",this.backgroundcolor),this.framecolor&&i.setStyle("border",h.fboxrule+"em solid "+this.framecolor),this.border&&i.setStyle("border",this.border),e.setStyle("display","inline-block"),e.setStyle("height",e.height+e.depth,"em"),e.setStyle("vertical-align",-e.depth+s,"em");const n=zt([i,e]);return n.setStyle("position","relative"),n.setStyle("vertical-align",-s+e.depth,"em"),n.height=e.height+s,n.depth=e.depth+s,n.setLeft(s),n.setRight(s),n}decomposeEnclose(t){const e=qt(Zt(t,this.body)),i="auto"===this.padding?.2:this.padding;e.setStyle("padding",i,"em"),e.setStyle("display","inline-block"),e.setStyle("height",e.height+e.depth,"em"),e.setStyle("left",-i,"em"),this.backgroundcolor&&"transparent"!==this.backgroundcolor&&e.setStyle("background-color",this.backgroundcolor);let s="";if(this.notation.box&&e.setStyle("border",this.borderStyle),this.notation.actuarial&&(e.setStyle("border-top",this.borderStyle),e.setStyle("border-right",this.borderStyle)),this.notation.madruwb&&(e.setStyle("border-bottom",this.borderStyle),e.setStyle("border-right",this.borderStyle)),this.notation.roundedbox&&(e.setStyle("border-radius",(q.height(e)+q.depth(e))/2,"em"),e.setStyle("border",this.borderStyle)),this.notation.circle&&(e.setStyle("border-radius","50%"),e.setStyle("border",this.borderStyle)),this.notation.top&&e.setStyle("border-top",this.borderStyle),this.notation.left&&e.setStyle("border-left",this.borderStyle),this.notation.right&&e.setStyle("border-right",this.borderStyle),this.notation.bottom&&e.setStyle("border-bottom",this.borderStyle),this.notation.horizontalstrike&&(s+='<line x1="3%"  y1="50%" x2="97%" y2="50%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.verticalstrike&&(s+='<line x1="50%"  y1="3%" x2="50%" y2="97%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.updiagonalstrike&&(s+='<line x1="3%"  y1="97%" x2="97%" y2="3%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),this.notation.downdiagonalstrike&&(s+='<line x1="3%"  y1="3%" x2="97%" y2="97%"',s+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,s+=' stroke-linecap="round"',this.svgStrokeStyle&&(s+=` stroke-dasharray="${this.svgStrokeStyle}"`),s+="/>"),s){let t;return"none"!==this.shadow&&(t="auto"===this.shadow?"filter: drop-shadow(0 0 .5px rgba(255, 255, 255, .7)) drop-shadow(1px 1px 2px #333)":"filter: drop-shadow("+this.shadow+")"),q.makeSVG(e,s,t)}return e}decompose(t,e){let i=null;if(!this.type||/mord|minner|mbin|mrel|mpunct|mopen|mclose|textord/.test(this.type)?(i=this.makeSpan(t,"string"==typeof this.body?this.body:Zt(t,this.body)),i.type=this.type):"group"===this.type||"root"===this.type?i=this.decomposeGroup(t):"array"===this.type?i=this.decomposeArray(t):"genfrac"===this.type?i=this.decomposeGenfrac(t):"surd"===this.type?i=this.decomposeSurd(t):"accent"===this.type?i=this.decomposeAccent(t):"leftright"===this.type?i=this.decomposeLeftright(t):"delim"===this.type?(i=zt(null,""),i.delim=this.delim):"sizeddelim"===this.type?i=this.bind(t,Yt.makeSizedDelim(this.cls,this.delim,this.size,t)):"line"===this.type?i=this.decomposeLine(t):"overunder"===this.type?i=this.decomposeOverunder(t):"overlap"===this.type?i=this.decomposeOverlap(t):"rule"===this.type?i=this.decomposeRule(t):"styling"===this.type||("msubsup"===this.type?(i=qt("â"),e&&(i.height=e[0].height,i.depth=e[0].depth)):"mop"===this.type?i=this.decomposeOp(t):"space"===this.type?i=this.makeSpan(t," "):"spacing"===this.type?"â"===this.body?i=this.makeSpan(t,"â"):"Â "===this.body?i=this.makeSpan(t,"math"===this.mode?" ":"Â "):this.width?(i=zt("â","mspace "),this.width>0?i.setWidth(this.width):i.setStyle("margin-left",this.width,"em")):i=zt("â","mspace "+({qquad:"qquad",quad:"quad",enspace:"enspace",";":"thickspace",":":"mediumspace",",":"thinspace","!":"negativethinspace"}[this.body]||"quad")):"mathstyle"===this.type?t.setMathstyle(this.mathstyle):"box"===this.type?i=this.decomposeBox(t):"enclose"===this.type?i=this.decomposeEnclose(t):"command"===this.type||"error"===this.type?(i=this.makeSpan(t,this.body),i.classes="",this.error&&(i.classes+=" ML__error"),this.suggestion&&(i.classes+=" ML__suggestion")):"placeholder"===this.type?i=this.makeSpan(t,"â¬"):"first"===this.type&&(i=this.makeSpan(t,"â"))),!i)return i;if(this.caret&&"styling"!==this.type&&"msubsup"!==this.type&&"command"!==this.type&&"placeholder"!==this.type&&"first"!==this.type&&(Array.isArray(i)?i[i.length-1].caret=this.caret:i.caret=this.caret),!this.limits&&(this.superscript||this.subscript))if(Array.isArray(i)){const e=i[i.length-1];i[i.length-1]=this.attachSupsub(t,e,e.type)}else i=[this.attachSupsub(t,i,i.type)];return Array.isArray(i)?i:[i]}attachSupsub(t,e,i){if(!this.superscript&&!this.subscript)return e;const s=t.mathstyle;let n=null,r=null;if(this.superscript){const e=Zt(t.sup(),this.superscript);n=zt(e,s.adjustTo(s.sup()))}if(this.subscript){const e=Zt(t.sub(),this.subscript);r=zt(e,s.adjustTo(s.sub()))}let o,a=0,l=0;this.isCharacterBox()||(a=q.height(e)-s.metrics.supDrop,l=q.depth(e)+s.metrics.subDrop),o=s===P.DISPLAY?s.metrics.sup1:s.cramped?s.metrics.sup3:s.metrics.sup2;const c=.5/h.ptPerEm/(P.TEXT.sizeMultiplier*s.sizeMultiplier);let u=null;if(r&&n){a=Math.max(a,o,n.depth+.25*s.metrics.xHeight),l=Math.max(l,s.metrics.sub2);const i=h.defaultRuleThickness;if(a-q.depth(n)-(q.height(r)-l)<4*i){l=4*i-(a-n.depth)+q.height(r);const t=.8*s.metrics.xHeight-(a-q.depth(n));t>0&&(a+=t,l-=t)}u=Gt(t,[r,l,n,-a],"individualShift"),this.symbol&&u.children[0].setLeft(-q.italic(e))}else r&&!n?(l=Math.max(l,s.metrics.sub1,q.height(r)-.8*s.metrics.xHeight),u=Gt(t,[r],"shift",l),u.children[0].setRight(c),this.isCharacterBox()&&u.children[0].setLeft(-q.italic(e))):!r&&n&&(a=Math.max(a,o,n.depth+.25*s.metrics.xHeight),u=Gt(t,[n],"shift",-a),u.children[0].setRight(c));const d=zt(u,"msubsup");return this.caret&&(d.caret=this.caret),q.makeSpanOfType(i,[e,d])}attachLimits(t,e,i,s){const n=this.superscript?zt(Zt(t.sup(),this.superscript),t.mathstyle.adjustTo(t.mathstyle.sup())):null,r=this.subscript?zt(Zt(t.sub(),this.subscript),t.mathstyle.adjustTo(t.mathstyle.sub())):null;return Qt(t,e,i,s,n,r,"mop")}bind(t,e){return"first"!==this.type&&"â"!==this.body&&(this.id=function(t){let e;return"boolean"==typeof t.generateID&&t.generateID?e=Date.now().toString(36).slice(-2)+Math.floor(1e5*Math.random()).toString(36):"object"==typeof t.generateID&&(t.generateID.overrideID?e=t.generateID.overrideID:(e=t.generateID.seed.toString(36),t.generateID.seed+=1)),e}(t),this.id&&(e.attributes||(e.attributes={}),e.attributes["data-atom-id"]=this.id)),e}makeSpan(t,e){const i=q.makeSpanOfType("textord"===this.type?"mord":this.type,e),s=this.getStyle();i.applyStyle(s);const n=s&&s.fontSize?s.fontSize:"size5";return n!==t.parentSize?(i.classes+=" sizing reset-"+t.parentSize,i.classes+=" "+n):t.parentSize!==t.size&&(i.classes+=" sizing reset-"+t.parentSize,i.classes+=" "+t.size),i.maxFontSize=Math.max(i.maxFontSize,t.sizeMultiplier||1),"text"===this.mode&&(i.classes+=" ML__text"),t.mathstyle.isTight()&&(i.isTight=!0),"math"!==this.mode&&(i.italic=0),i.setRight(i.italic),"number"==typeof t.opacity&&i.setStyle("opacity",t.opacity),this.bind(t,i),this.caret&&(this.superscript||this.subscript||(i.caret=this.caret,t.mathstyle.isTight()&&(i.isTight=!0))),i}}function Wt(t){const e=zt("â","arraycolsep");return e.setWidth(t,"em"),e}function Kt(t,e,i,s){const n=[];for(const r of e){const e=zt(Zt(t,s));e.depth=r.depth,e.height=r.height,n.push(e),n.push(r.pos-i)}return Gt(t,n,"individualShift")}function Qt(t,e,i,s,n,r,o){if(!n&&!r)return e;e=zt(e);let a=0,l=0;n&&(a=Math.max(h.bigOpSpacing1,h.bigOpSpacing3-n.depth)),r&&(l=Math.max(h.bigOpSpacing2,h.bigOpSpacing4-r.height));let c=null;if(r&&n){const o=h.bigOpSpacing5+q.height(r)+q.depth(r)+l+q.depth(e)+i;c=Gt(t,[h.bigOpSpacing5,r,l,e,a,n,h.bigOpSpacing5],"bottom",o),c.children[0].setLeft(-s),c.children[2].setLeft(s)}else if(r&&!n){const n=q.height(e)-i;c=Gt(t,[h.bigOpSpacing5,r,l,e],"top",n),c.children[0].setLeft(-s)}else if(!r&&n){const r=q.depth(e)+i;c=Gt(t,[e,a,n,h.bigOpSpacing5],"bottom",r),c.children[1].setLeft(s)}return q.makeSpanOfType(o,c,"op-limits")}function Zt(t,e){t instanceof E||(t=new E(t));const i=!t.generateID||!t.generateID.groupNumbers;let s=[];if(Array.isArray(e)){if(0===e.length)return s;if(1===e.length)s=e[0].decompose(t),s&&i&&e[0].isSelected&&s.forEach(t=>t.selected(!0));else{let n="none",r=e[1].type,o=[],a=null,l=null;for(let c=0;c<e.length;c++){"mbin"===e[c].type&&(/first|none|mrel|mpunct|mopen|mbin|mop/.test(n)||/none|mrel|mpunct|mclose/.test(r))&&(e[c].type="mord"),"â"===e[c].body&&(e[c].superscript||e[c].subscript)||(l=null),t.generateID.groupNumbers&&a&&"mord"===e[c].type&&/[0-9,.]/.test(e[c].latex)&&(t.generateID.overrideID=a);const h=e[c].decompose(t,l);if(t.generateID&&(t.generateID.overrideID=null),h){const n=[].concat.apply([],h);l=n,t.generateID&&t.generateID.groupNumbers&&("mord"===e[c].type&&/[0-9,.]/.test(e[c].latex)&&(a||(a=e[c].id)),("mord"!==e[c].type||/[0-9,.]/.test(e[c].latex)||e[c].superscript||e[c].subscript)&&a&&(a=null)),i&&e[c].isSelected?(o=o.concat(n),o.forEach(t=>t.selected(!0))):(o.length>0&&(s=[...s,...o],o=[]),s=s.concat(n))}n=e[c].getFinalBaseElement().type,r=e[c+1]?e[c+1].getInitialBaseElement().type:"none"}o.length>0&&(s=[...s,...o],o=[])}}else e&&(s=e.decompose(t),s&&i&&e.isSelected&&s.forEach(t=>t.selected(!0)));if(!s||0===s.length)return null;if(t.mathstyle!==t.parentMathstyle){const e=t.mathstyle.sizeMultiplier/t.parentMathstyle.sizeMultiplier;for(const t of s)t.height*=e,t.depth*=e}if(t.size!==t.parentSize){const e=$t[t.size]/$t[t.parentSize];for(const t of s)t.height*=e,t.depth*=e}return s}var te={MathAtom:Vt,decompose:Zt,makeRoot:function(t,e){const i=new Vt(t=t||"math","root",e||[]);return 0!==i.body.length&&"first"===i.body[0].type||i.body.unshift(new Vt("","first")),i},GREEK_REGEX:Ht};const ee={m0:"#3f3d99",m1:"#993d71",m2:"#998b3d",m3:"#3d9956",m4:"#3d5a99",m5:"#993d90",m6:"#996d3d",m7:"#43993d",m8:"#3d7999",m9:"#843d99"},ie={apricot:"#FBB982",aquamarine:"#00B5BE",bittersweet:"#C04F17",black:"#221E1F",blue:"#2D2F92",bluegreen:"#00B3B8",blueviolet:"#473992",brickred:"#B6321C",brown:"#792500",burntorange:"#F7921D",cadetblue:"#74729A",carnationpink:"#F282B4",cerulean:"#00A2E3",cornflowerblue:"#41B0E4",cyan:"#00AEEF",dandelion:"#FDBC42",darkorchid:"#A4538A",emerald:"#00A99D",forestgreen:"#009B55",fuchsia:"#8C368C",goldenrod:"#FFDF42",gray:"#949698",green:"#00A64F",greenyellow:"#DFE674",junglegreen:"#00A99A",lavender:"#F49EC4",limegreen:"#8DC73E",magenta:"#EC008C",mahogany:"#A9341F",maroon:"#AF3235",melon:"#F89E7B",midnightblue:"#006795",mulberry:"#A93C93",navyblue:"#006EB8",olivegreen:"#3C8031",orange:"#F58137",orangered:"#ED135A",orchid:"#AF72B0",peach:"#F7965A",periwinkle:"#7977B8",pinegreen:"#008B72",plum:"#92268F",processblue:"#00B0F0",purple:"#99479B",rawsienna:"#974006",red:"#ED1B23",redorange:"#F26035",redviolet:"#A1246B",rhodamine:"#EF559F",royalblue:"#0071BC",royalpurple:"#613F99",rubinered:"#ED017D",salmon:"#F69289",seagreen:"#3FBC9D",sepia:"#671800",skyblue:"#46C5DD",springgreen:"#C6DC67",tan:"#DA9D76",tealblue:"#00AEB3",thistle:"#D883B7",turquoise:"#00B4CE",violet:"#58429B",violetred:"#EF58A0",white:"#FFFFFF",wildstrawberry:"#EE2967",yellow:"#FFF200",yellowgreen:"#98CC70",yelloworange:"#FAA21A"};var se=function(t){const e=t.toLowerCase().split("!");let i,s,n,r=255,o=255,a=255,l=-1;const c=e.length>0&&"-"===e[0].charAt(0);c&&(e[0]=e[0].slice(1));for(let h=0;h<e.length;h++){i=r,s=o,n=a;let t=e[h].match(/([a-z0-9]*)/);t&&(t=t[1]);let c=ie[t]||ee[t];c||(c=e[h]);let u=c.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(u&&u[1]&&u[2]&&u[3])r=Math.max(0,Math.min(255,parseInt(u[1],16))),o=Math.max(0,Math.min(255,parseInt(u[2],16))),a=Math.max(0,Math.min(255,parseInt(u[3],16)));else if(u=c.match(/^#([0-9a-f]{3})$/i),u&&u[1]){const t=parseInt(u[1][0],16),e=parseInt(u[1][1],16),i=parseInt(u[1][2],16);r=Math.max(0,Math.min(255,16*t+t)),o=Math.max(0,Math.min(255,16*e+e)),a=Math.max(0,Math.min(255,16*i+i))}else{if(u=c.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),!(u&&u[1]&&u[2]&&u[3]))return null;r=Math.max(0,Math.min(255,parseInt(u[1]))),o=Math.max(0,Math.min(255,parseInt(u[2]))),a=Math.max(0,Math.min(255,parseInt(u[3])))}l>=0&&(r=(1-l)*r+l*i,o=(1-l)*o+l*s,a=(1-l)*a+l*n,l=-1),h+1<e.length&&(l=Math.max(0,Math.min(100,parseInt(e[++h])))/100)}return l>=0&&(r=l*r+(1-l)*i,o=l*o+(1-l)*s,a=l*a+(1-l)*n),c&&(r=255-r,o=255-o,a=255-a),"#"+("00"+Math.round(r).toString(16)).slice(-2)+("00"+Math.round(o).toString(16)).slice(-2)+("00"+Math.round(a).toString(16)).slice(-2)},ne=function(t){let e=t.toUpperCase();for(const i in ie)if(ie[i]===e){e=i;break}for(const i in ee)if(ee[i]===e){e=i;break}return e},re=["#d35d60","#7293cb","#e1974d","#84bb5d","#9066a7","#aD6a58","#f5a4ce","#fff590","#212121","#818787","#d4d5d2","#ffffff"],oe=["#cc2428","#3769b1","#da7e30","#409852","#6b4c9a","#922426","#e7298a","#ffe907","#000000","#525055","#adafaa","#ffffff"];const ae=te.MathAtom;class le{constructor(t,e,i){this.tokens=t,this.index=0,this.args=e,this.macros=i,this.mathList=[],this.style={},this.parseMode="math",this.tabularMode=!1,this.endCount=0}swapMathList(t){const e=this.mathList;return this.mathList=t||[],e}swapParseMode(t){const e=this.parseMode;return this.parseMode=t,e}end(){return this.endCount++,this.index>=this.tokens.length||this.endCount>1e3}get(){return this.endCount=0,this.index<this.tokens.length?this.tokens[this.index++]:null}peek(t){const e=this.index+(t||0);return e<this.tokens.length?this.tokens[e]:null}lastMathAtom(){const t=0===this.mathList.length?"none":this.mathList[this.mathList.length-1].type;if("mop"!==t&&"msubsup"!==t){const t=new ae(this.parseMode,"msubsup","â");t.attributes={"aria-hidden":!0},this.mathList.push(t)}return this.mathList[this.mathList.length-1]}hasToken(t){const e=this.index;return e<this.tokens.length&&this.tokens[e].type===t}hasLiteral(t){const e=this.index;return e<this.tokens.length&&"literal"===this.tokens[e].type&&(!t||this.tokens[e].value===t)}hasLiteralPattern(t){return this.hasToken("literal")&&t.test(this.tokens[this.index].value)}hasCommand(t){const e=this.index;return e<this.tokens.length&&"command"===this.tokens[e].type&&this.tokens[e].value===t}hasInfixCommand(){const t=this.index;if(t<this.tokens.length&&"command"===this.tokens[t].type){const e=St.getInfo("\\"+this.tokens[t].value,this.parseMode,this.macros);return e&&e.infix}return!1}hasColumnSeparator(){const t=this.index;return!!(this.tabularMode&&t<this.tokens.length)&&"literal"===this.tokens[t].type&&"&"===this.tokens[t].value}hasRowSeparator(){const t=this.index;return!!(this.tabularMode&&t<this.tokens.length)&&"command"===this.tokens[t].type&&("\\"===this.tokens[t].value||"cr"===this.tokens[t].value)}parseColumnSeparator(){return!!this.hasColumnSeparator()&&(this.index++,!0)}placeholder(){if(this.args&&"string"==typeof this.args["?"])return ce(o(this.args["?"]),this.parseMode,null,this.macros);const t=new ae(this.parseMode,"placeholder","?",this.style);return t.captureSelection=!0,[t]}hasImplicitCommand(t){if(this.index<this.tokens.length){const e=this.tokens[this.index];if("command"===e.type)return t.includes(e.value)}return!1}parseRowSeparator(){return!!this.hasRowSeparator()&&(this.index++,!0)}parseToken(t){return!!this.hasToken(t)&&(this.index++,!0)}skipWhitespace(){let t=!1;for(;this.hasToken("space");)this.index++,t=!0;return t}skipUntilToken(t){for(;!this.end()&&!this.parseToken(t);)this.get()}parseCommand(t){return!!this.hasCommand(t)&&(this.index++,!0)}parseLiteral(t){return!!this.hasLiteral(t)&&(this.index++,!0)}parseFiller(){let t=!1,e=!1;do{const i=this.skipWhitespace(),s=this.parseCommand("relax");t=t||i||s,e=!i&&!s}while(!e);return t}parseKeyword(t){const e=this.index;let i=this.end(),s="";for(;!i;){const e=this.get();"literal"===e.type&&(s+=e.value),i=this.end()||"literal"!==e.type||s.length>=t.length}const n=t.toUpperCase()===s.toUpperCase();return n||(this.index=e),n}scanString(){let t="",e=this.end();for(;!e;){if(this.hasLiteral("]"))e=!0;else if(this.hasToken("literal"))t+=this.get().value;else if(this.skipWhitespace())t+=" ";else if(this.hasToken("command")){const e=this.get();t+="space"===e.value?"Â ":e.value}else e=!0;e=e||this.end()}return t}scanColor(){return se(this.scanString())}scanNumber(t){const e=this.parseLiteral("-");e||this.parseLiteral("+"),this.skipWhitespace(),t=!!t;let i=10,s=/[0-9]/;this.parseLiteral("'")?(i=8,s=/[0-7]/,t=!0):(this.parseLiteral('"')||this.parseLiteral("x"))&&(i=16,s=/[0-9A-F]/,t=!0);let n="";for(;this.hasLiteralPattern(s);)n+=this.get().value;if(!t&&(this.parseLiteral(".")||this.parseLiteral(",")))for(n+=".";this.hasLiteralPattern(s);)n+=this.get().value;const r=t?parseInt(n,i):parseFloat(n);return e?-r:r}scanDimen(){const t=this.scanNumber(!1);let e;return this.skipWhitespace(),e=this.parseKeyword("pt")?p.toEm(t,"pt"):this.parseKeyword("mm")?p.toEm(t,"mm"):this.parseKeyword("cm")?p.toEm(t,"cm"):this.parseKeyword("ex")?p.toEm(t,"ex"):this.parseKeyword("px")?p.toEm(t,"px"):this.parseKeyword("em")?p.toEm(t,"em"):this.parseKeyword("bp")?p.toEm(t,"bp"):this.parseKeyword("dd")?p.toEm(t,"dd"):this.parseKeyword("pc")?p.toEm(t,"pc"):this.parseKeyword("in")?p.toEm(t,"in"):this.parseKeyword("mu")?p.toEm(t,"mu"):p.toEm(t,"pt"),e}scanSkip(){const t=this.scanDimen();return this.skipWhitespace(),this.parseKeyword("plus")&&this.scanDimen(),this.skipWhitespace(),this.parseKeyword("minus")&&this.scanDimen(),t}scanColspec(){this.skipWhitespace();const t=[];for(;!this.end()&&!this.hasToken("}")&&!this.hasLiteral("]");)if(this.hasLiteral()){const e=this.get().value;if("lcr".includes(e))t.push({align:e});else if("|"===e)t.push({rule:!0});else if("@"===e){if(this.parseToken("{")){const e=this.swapParseMode("math");t.push({gap:this.scanImplicitGroup(t=>"}"===t.type)}),this.swapParseMode(e)}this.parseToken("}")}}return t}scanModeSet(){let t;if(this.parseCommand("(")&&(t=")"),!t&&this.parseCommand("[")&&(t="]"),!t)return null;const e=this.swapParseMode("math"),i=new ae("math","group");return i.mathstyle=")"===t?"textstyle":"displaystyle",i.body=this.scanImplicitGroup(e=>"command"===e.type&&e.value===t),this.parseCommand(t),this.swapParseMode(e),i.body&&0!==i.body.length?i:null}scanModeShift(){if(!this.hasToken("$")&&!this.hasToken("$$"))return null;const t=this.get().type,e=new ae("math","group");e.mathstyle="$"===t?"textstyle":"displaystyle",e.latexOpen="textstyle"===e.mathstyle?"$":"$$",e.latexClose=e.latexOpen;const i=this.swapParseMode("math");return e.body=this.scanImplicitGroup(e=>e.type===t),this.parseToken(t),this.swapParseMode(i),e.body&&0!==e.body.length?e:null}scanEnvironment(){if(!this.parseCommand("begin"))return null;const t=this.scanArg("string"),e=St.getEnvironmentInfo(t),i=[];if(e&&e.params)for(const d of e.params)if(d.optional){const t=this.scanOptionalArg(d.type);i.push(t)}else i.push(this.scanArg(d.type));const s=this.parseMode,n=this.tabularMode,r=this.swapMathList([]);this.tabularMode=e.tabular;const o=[],a=[];let l=[],c=!1;do{if(c=this.end(),!c&&this.parseCommand("end")&&(c=this.scanArg("string")===t),!c)if(this.parseColumnSeparator())l.push(this.swapMathList([]));else if(this.parseRowSeparator()){l.push(this.swapMathList([]));let t=0;this.skipWhitespace(),this.parseLiteral("[")&&(t=this.scanDimen(),this.skipWhitespace(),this.parseLiteral("]")),a.push(t||0),o.push(l),l=[]}else this.mathList=this.mathList.concat(this.scanImplicitGroup())}while(!c);l.push(this.swapMathList([])),l.length>0&&o.push(l);const h=this.swapMathList(r);if(this.parseMode=s,this.tabularMode=n,!e.tabular&&0===h.length)return null;if(e.tabular&&0===o.length)return null;const u=new ae(this.parseMode,"array",h,e.parser?e.parser(t,i,o):{});return u.array=o,u.rowGaps=a,u.env={...e},u.env.name=t,u}scanImplicitGroup(t){const e=this.style;t||(t=t=>"}"===t.type||"literal"===t.type&&"&"===t.value||"command"===t.type&&/^(end|cr|\\)$/.test(t.value));let i=null,s=null;const n=this.swapMathList([]);for(;!this.end()&&!t(this.peek());)if(this.hasImplicitCommand(["displaystyle","textstyle","scriptstyle","scriptscriptstyle"])){this.parseMode="math";const t=new ae("math","mathstyle");t.mathstyle=this.get().value,this.mathList.push(t)}else this.hasInfixCommand()&&!i?(i=this.get(),s=this.swapMathList([])):this.parseAtom();let r;if(i){const t=this.swapMathList(n),e=St.getInfo("\\"+i.value,"math",this.macros);r=e?[new ae(this.parseMode,e.type,e.value||i.value,e.parse?e.parse("\\"+i.value,[s,t]):null)]:[new ae(this.parseMode,"mop",i.value)]}else r=this.swapMathList(n);return this.style=e,r}scanGroup(){if(!this.parseToken("{"))return null;const t=new ae(this.parseMode,"group");return t.body=this.scanImplicitGroup(t=>"}"===t.type),this.parseToken("}"),t.latexOpen="{",t.latexClose="}",t}scanSmartFence(){if(this.skipWhitespace(),!this.parseLiteral("("))return null;const t=new ae(this.parseMode,"leftright");t.leftDelim="(",t.inner=!1;const e=this.swapMathList([]);let i=1;for(;!this.end()&&0!==i;)this.hasLiteral("(")&&(i+=1),this.hasLiteral(")")&&(i-=1),0!==i&&this.parseAtom();return 0===i&&this.parseLiteral(")"),t.rightDelim=0===i?")":"?",t.body=this.swapMathList(e),t}scanDelim(){this.skipWhitespace();const t=this.get();if(!t)return null;let e=".";"command"===t.type?e="\\"+t.value:"literal"===t.type&&(e=t.value);const i=St.getInfo(e,"math",this.macros);return i&&("mopen"===i.type||"mclose"===i.type||/^(\?|\||<|>|\\vert|\\Vert|\\\||\\surd|\\uparrow|\\downarrow|\\Uparrow|\\Downarrow|\\updownarrow|\\Updownarrow|\\mid|\\mvert|\\mVert)$/.test(e))?e:null}scanLeftRight(){if(this.parseCommand("right")||this.parseCommand("mright")){const t=new ae(this.parseMode,"leftright");return t.rightDelim=this.scanDelim()||".",t}const t=this.style;let e="right";if(!this.parseCommand("left")){if(!this.parseCommand("mleft"))return null;e="mright"}const i=this.scanDelim()||".",s=this.swapMathList([]);for(;!this.end()&&!this.parseCommand(e);)this.parseAtom();this.style=t;const n=this.scanDelim(),r=new ae(this.parseMode,"leftright");return r.leftDelim=i,r.rightDelim=n,r.inner="right"===e,r.body=this.swapMathList(s),r}parseSupSub(){if("math"!==this.parseMode)return!1;let t=!1;for(;this.hasLiteral("^")||this.hasLiteral("_")||this.hasLiteral("'");){let e;if(this.hasLiteral("^")?e="superscript":this.hasLiteral("_")&&(e="subscript"),this.parseLiteral("^")||this.parseLiteral("_")){const i=this.scanArg();if(i){const s=this.lastMathAtom();s[e]=s[e]||[],s[e]=s[e].concat(i),t=!0}}else if(this.parseLiteral("'")){const e=this.lastMathAtom();e.superscript=e.superscript||[],e.superscript.push(new ae(e.parseMode,"mord","â²")),t=!0}}return t}parseLimits(){if(this.parseCommand("limits")){const t=this.lastMathAtom();return t.limits="limits",t.explicitLimits=!0,!0}if(this.parseCommand("nolimits")){const t=this.lastMathAtom();return t.limits="nolimits",t.explicitLimits=!0,!0}return!1}scanOptionalArg(t){if(t=t&&"auto"!==t?t:this.parseMode,this.skipWhitespace(),!this.parseLiteral("["))return null;const e=this.parseMode;this.parseMode=t;const i=this.swapMathList();let s;for(;!this.end()&&!this.parseLiteral("]");)if("string"===t)s=this.scanString();else if("number"===t)s=this.scanNumber();else if("dimen"===t)s=this.scanDimen();else if("skip"===t)s=this.scanSkip();else if("colspec"===t)s=this.scanColspec();else if("color"===t)s=this.scanColor()||"#ffffff";else if("bbox"===t){const t=this.scanString().toLowerCase().trim().split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(const e of t){const t=se(e);if(t)s=s||{},s.backgroundcolor=t;else{const t=e.match(/^\s*([0-9.]+)\s*([a-z][a-z])/);if(t)s=s||{},s.padding=p.toEm(t[1],t[2]);else{const t=e.match(/^\s*border\s*:\s*(.*)/);t&&(s=s||{},s.border=t[1])}}}}else this.mathList=this.mathList.concat(this.scanImplicitGroup(t=>"literal"===t.type&&"]"===t.value));this.parseMode=e;const n=this.swapMathList(i);return s||n}scanArg(t){let e;if(t=t&&"auto"!==t?t:this.parseMode,this.parseFiller(),!this.parseToken("{")){if("delim"===t)return this.scanDelim()||".";if(/^(math|text)$/.test(t)){const e=this.parseMode;this.parseMode=t;const i=this.scanToken();return this.parseMode=e,Array.isArray(i)?i:i?[i]:null}}if(this.hasToken("#")){const t=this.get();return this.skipUntilToken("}"),"?"===t.value?this.placeholder():this.args?void 0===this.args[t.value]&&void 0!==this.args["?"]?this.placeholder():this.args[t.value]||null:null}const i=this.parseMode;this.parseMode=t;const s=this.swapMathList([]);if("string"===t)e=this.scanString(),this.skipUntilToken("}");else if("number"===t)e=this.scanNumber(),this.skipUntilToken("}");else if("dimen"===t)e=this.scanDimen(),this.skipUntilToken("}");else if("skip"===t)e=this.scanSkip(),this.skipUntilToken("}");else if("colspec"===t)e=this.scanColspec(),this.skipUntilToken("}");else if("color"===t)e=this.scanColor()||"#ffffff",this.skipUntilToken("}");else if("delim"===t)e=this.scanDelim()||".",this.skipUntilToken("}");else do{this.mathList=this.mathList.concat(this.scanImplicitGroup())}while(!this.parseToken("}")&&!this.end());this.parseMode=i;const n=this.swapMathList(s);return e||n}scanToken(){const t=this.get();if(!t)return null;let e=null;if("space"===t.type)"text"===this.parseMode&&(e=new ae("text",""," ",this.style));else if("placeholder"===t.type)e=new ae(this.parseMode,"placeholder",t.value),e.captureSelection=!0;else if("command"===t.type){if("placeholder"===t.value)e=new ae(this.parseMode,"placeholder",this.scanArg("string"),this.style),e.captureSelection=!0;else if("char"===t.value){let t=Math.floor(this.scanNumber(!0));(!isFinite(t)||t<0||t>1114111)&&(t=10067),e=new ae(this.parseMode,"math"===this.parseMode?"mord":"",String.fromCodePoint(t)),e.latex='{\\char"'+("000000"+t.toString(16)).toUpperCase().substr(-6)+"}"}else if("hskip"===t.value||"kern"===t.value){const i=this.scanSkip();isFinite(i)&&(e=new ae(this.parseMode,"spacing",null,this.style),e.width=i),e.latex="\\"+t.value}else if(e=this.scanMacro(t.value),!e){const i=St.getInfo("\\"+t.value,this.parseMode,this.macros),s=[];let n="",r="";if(i&&i.params)for(const t of i.params)if(t.optional){const e=this.scanOptionalArg(t.type);s.push(e)}else if(t.type.endsWith("*"))r=t.type.slice(0,-1);else{const e=this.scanArg(t.type);if(e&&1===e.length&&"placeholder"===e[0].type&&t.placeholder&&(e[0].value=t.placeholder),e)s.push(e);else if(t.placeholder){const e=new ae(this.parseMode,"placeholder",t.placeholder);e.captureSelection=!0,s.push([e])}else s.push(this.placeholder());"math"!==t.type&&"string"==typeof e&&(n+=e)}if(i&&!i.infix){if(i.parse){const n=i.parse("\\"+t.value,s);if(n.type)e=new ae(this.parseMode,i.type,r?this.scanArg(r):null,{...this.style,...n});else{const t=this.parseMode;if(n.mode&&(this.parseMode=n.mode,delete n.mode),r){const t=this.style;this.style={...this.style,...n},e=this.scanArg(r),this.style=t}else this.style={...this.style,...n};this.parseMode=t}}else{const s={...this.style};i.baseFontFamily&&(s.baseFontFamily=i.baseFontFamily),e=new ae(this.parseMode,i.type||"mop",i.value||t.value,s),i.skipBoundary&&(e.skipBoundary=!0)}if(e&&!/^(llap|rlap|class|cssId)$/.test(t.value)&&(e.latex="\\"+t.value,n&&(e.latex+="{"+n+"}"),e.isFunction&&this.smartFence)){const t=this.scanSmartFence();t&&(e=[e,t])}}i||(e=new ae(this.parseMode,"error","\\"+t.value),e.latex="\\"+t.value)}}else if("literal"===t.type){const i=St.getInfo(t.value,this.parseMode,this.macros);if(i){const s={...this.style};i.baseFontFamily&&(s.baseFontFamily=i.baseFontFamily),e=new ae(this.parseMode,i.type,i.value||t.value,s),i.isFunction&&(e.isFunction=!0)}else e=new ae(this.parseMode,"math"===this.parseMode?"mord":"",t.value,this.style);if(e.latex=St.matchCodepoint(this.parseMode,t.value.codePointAt(0)),i&&i.isFunction&&this.smartFence){const t=this.scanSmartFence();t&&(e=[e,t])}}else if("#"===t.type)if("?"===t.value)e=this.placeholder();else if(this.args)if(e=this.args[t.value]||null,Array.isArray(e)&&1===e.length)e=e[0];else if(Array.isArray(e)){const t=new ae(this.parseMode,"group");t.body=e,e=t}else e=this.placeholder();return e}scanMacro(t){if(!this.macros||!this.macros[t])return null;const e={};let i,s=0;"string"==typeof this.macros[t]?(i=this.macros[t],/(^|[^\\])#1/.test(i)&&(s=1),/(^|[^\\])#2/.test(i)&&(s=2),/(^|[^\\])#3/.test(i)&&(s=3),/(^|[^\\])#4/.test(i)&&(s=4),/(^|[^\\])#5/.test(i)&&(s=5),/(^|[^\\])#6/.test(i)&&(s=6),/(^|[^\\])#7/.test(i)&&(s=7),/(^|[^\\])#8/.test(i)&&(s=8),/(^|[^\\])#9/.test(i)&&(s=9)):(i=this.macros[t].def,s=this.macros[t].args||0);for(let o=1;o<=s;o++)e[o]=this.scanArg();this.args&&"string"==typeof this.args["?"]&&(e["?"]=this.args["?"]);const n=new ae(this.parseMode,"group",ce(o(i),this.parseMode,e,this.macros));n.captureSelection=!0,n.latex="\\"+t;let r="";for(let o=1;o<=s;o++){if(r+="{",Array.isArray(e[o]))for(let t=0;t<e[o].length;t++)r+=e[o][t].latex;r+="}"}return n.latex+=r||"",n}parseAtom(){let t=this.scanEnvironment()||this.scanModeShift()||this.scanModeSet()||this.scanGroup()||this.scanLeftRight();return!(t||!this.parseSupSub()&&!this.parseLimits())||(t||(t=this.scanToken()),Array.isArray(t)?this.mathList=this.mathList.concat(t):t&&this.mathList.push(t),null!==t)}}function ce(t,e,i,s,n){let r=[];const o=new le(t,i,s);for(o.parseMode=e||"math",n&&(o.smartFence=!0);!o.end();)r=r.concat(o.scanImplicitGroup());return r}var he={Parser:le,parseTokens:ce};function ue(t,e){let i="";for(const s of t)i+=s.relation+":"+s.offset+"/";return e&&(i+="#"+e),i}function de(t){const e={path:[],extent:0},i=t.split("#");i.length>1&&(e.extent=parseInt(i[1]));const s=i[0].split("/");for(const n of s){const t=n.match(/([^:]*):(.*)/);t&&e.path.push({relation:t[1],offset:parseInt(t[2])})}return e}var pe={pathFromString:de,pathToString:ue,pathDistance:function(t,e){let i=0,s=-1,n=!1;for(;!n;)s+=1,n=s>=t.length||s>=e.length,n=n||!(t[s].relation===e[s].relation&&t[s].offset===e[s].offset);return i=s===t.length&&s===e.length?0:s+1===t.length&&s+1===e.length&&t[s].relation===e[s].relation?1:2,i},pathCommonAncestor:function(t,e){const i=[],s=Math.min(t.length-1,e.length-1);let n=0;for(;n<=s&&t[n].relation===e[n].relation&&t[n].offset===e[n].offset;)i.push(t[n]),n+=1;return i},clone:function(t){return de(ue(t)).path}};const fe={Left:"moveToPreviousChar",Right:"moveToNextChar",Up:"moveUp",Down:"moveDown","Shift-Left":"extendToPreviousChar","Shift-Right":"extendToNextChar","Shift-Up":"extendUp","Shift-Down":"extendDown",Backspace:"deletePreviousChar","Alt-Del":"deletePreviousChar",Del:"deleteNextChar","Alt-Backspace":"deleteNextChar","Alt-Left":"moveToPreviousWord","Alt-Right":"moveToNextWord","Alt-Shift-Left":"extendToPreviousWord","Alt-Shift-Right":"extendToNextWord","Ctrl-Left":"moveToGroupStart","Ctrl-Right":"moveToGroupEnd","Ctrl-Shift-Left":"extendToGroupStart","Ctrl-Shift-Right":"extendToGroupEnd","math:Spacebar":"moveAfterParent","math:Shift-Spacebar":"moveBeforeParent",Home:"moveToMathFieldStart","mac:Meta-Left":"moveToMathFieldStart","Shift-Home":"extendToMathFieldStart","mac:Meta-Shift-Left":"extendToMathFieldStart",End:"moveToMathFieldEnd","mac:Meta-Right":"moveToMathFieldEnd","Shift-End":"extendToMathFieldEnd","mac:Meta-Shift-Right":"extendToMathFieldEnd",PageUp:"moveToGroupStart",PageDown:"moveToGroupEnd","math:Tab":"moveToNextPlaceholder","math:F8":"moveToNextPlaceholder","math:Shift-Tab":"moveToPreviousPlaceholder","math:Shift-F8":"moveToPreviousPlaceholder","text:Tab":"moveToNextPlaceholder","text:F8":"moveToNextPlaceholder","text:Shift-Tab":"moveToPreviousPlaceholder","text:Shift-F8":"moveToPreviousPlaceholder","math:Esc":["switch-mode","command"],"math:Backslash":["switch-mode","command"],"math:IntlBackslash":["switch-mode","command"],"math:Alt-Equal":["apply-style",{mode:"text"}],"text:Alt-Equal":["apply-style",{mode:"math"}],"command:Esc":["complete",{discard:!0}],"command:Tab":["complete",{acceptSuggestion:!0}],"command:Return":"complete","command:Enter":"complete","command:Shift-Esc":["complete",{discard:!0}],"command:Down":"nextSuggestion","ios:command:Tab":"nextSuggestion","command:Up":"previousSuggestion","!mac:Ctrl-KeyA":"selectAll","mac:Meta-KeyA":"selectAll",Cut:"cut",Copy:"copy",Paste:"paste",Clear:"delete","!mac:Ctrl-KeyZ":"undo","mac:Meta-KeyZ":"undo",Undo:"undo","!mac:Ctrl-KeyY":"redo","mac:Meta-Shift-KeyY":"redo","!mac:Ctrl-Shift-KeyZ":"redo","mac:Meta-Shift-KeyZ":"redo",Redo:"redo",EraseEof:"deleteToGroupEnd","mac:Ctrl-KeyB":"moveToPreviousChar","mac:Ctrl-KeyF":"moveToNextChar","mac:Ctrl-KeyP":"moveUp","mac:Ctrl-KeyN":"moveDown","mac:Ctrl-KeyA":"moveToMathFieldStart","mac:Ctrl-KeyE":"moveToMathFieldEnd","mac:Ctrl-Shift-KeyB":"extendToPreviousChar","mac:Ctrl-Shift-KeyF":"extendToNextChar","mac:Ctrl-Shift-KeyP":"extendUp","mac:Ctrl-Shift-KeyN":"extendDown","mac:Ctrl-Shift-KeyA":"extendToMathFieldStart","mac:Ctrl-Shift-KeyE":"extendToMathFieldEnd","mac:Ctrl-Alt-KeyB":"moveToPreviousWord","mac:Ctrl-Alt-KeyF":"moveToNextWord","mac:Ctrl-Shift-Alt-KeyB":"extendToPreviousWord","mac:Ctrl-Shift-Alt-KeyF":"extendToNextWord","mac:Ctrl-KeyH":"deletePreviousChar","mac:Ctrl-KeyD":"deleteNextChar","mac:Ctrl-KeyL":"scrollIntoView","mac:Ctrl-KeyT":"transpose","math:Shift-Quote":["switch-mode","text","","â"],"text:Shift-Quote":["switch-mode","math","â",""],"math:Ctrl-Digit2":["insert","\\sqrt{#0}"],"math:Ctrl-Digit5":"moveToOpposite","math:Ctrl-Digit6":"moveToSuperscript","math:Ctrl-Minus":"moveToSubscript","math:Alt-BracketLeft":["insert","\\left\\lbrack #0 \\right\\rbrack"],"math:Alt-Shift-BracketLeft":["insert","\\left\\lbrace #0 \\right\\rbrace"],"math:Return":"addRowAfter","math:Enter":"addRowAfter","math:Ctrl-Comma":"addColumnAfter","math:Alt-KeyQ":["insert","\\theta"],"math:Alt-KeyP":["insert","\\pi"],"math:Alt-KeyV":["insert","\\sqrt{#0}"],"math:Alt-KeyW":["insert","\\sum_{i=#?}^{#?}"],"math:Alt-KeyB":["insert","\\int_{#?}^{#?}"],"math:Alt-KeyU":["insert","\\cup"],"math:Alt-KeyN":["insert","\\cap"],"math:Alt-KeyO":["insert","\\emptyset"],"math:Alt-KeyD":["insert","\\differentialD"],"math:Alt-Shift-KeyO":["insert","\\varnothing"],"math:Alt-Shift-KeyD":["insert","\\partial"],"math:Alt-Shift-KeyP":["insert","\\prod_{i=#?}^{#?}"],"math:Alt-Shift-KeyU":["insert","\\bigcup"],"math:Alt-Shift-KeyN":["insert","\\bigcap"],"math:Alt-Shift-KeyA":["insert","\\forall"],"math:Alt-Shift-KeyE":["insert","\\exists"],"math:Alt-Digit5":["insert","\\infty"],"math:Alt-Digit6":["insert","\\wedge"],"math:Alt-Shift-Digit6":["insert","\\vee"],"math:Alt-Digit9":["insert","("],"math:Alt-Digit0":["insert",")"],"math:Alt-Shift-Backslash":["insert","|"],"math:Alt-Backslash":["insert","\\backslash"],"math:Slash":["insert","\\frac{#@}{#?}"],"math:Alt-Slash":["insert","\\frac{#?}{#@}"],"math:NumpadDivide":["insert","\\frac{#@}{#?}"],"math:Alt-NumpadDivide":["insert","\\frac{#?}{#@}"],"math:Shift-Backquote":["insert","\\~"],"math:Alt-Shift-Slash":["insert","\\/"],"Alt-Shift-KeyK":"toggleKeystrokeCaption","Alt-Space":"toggleVirtualKeyboard","mac:Ctrl-Meta-Up":["speak","parent",{withHighlighting:!1}],"!mac:Ctrl-Alt-Up":["speak","parent",{withHighlighting:!1}],"mac:Ctrl-Meta-Down":["speak","all",{withHighlighting:!1}],"!mac:Ctrl-Alt-Down":["speak","all",{withHighlighting:!1}],"mac:Ctrl-Meta-Left":["speak","left",{withHighlighting:!1}],"!mac:Ctrl-Alt-Left":["speak","left",{withHighlighting:!1}],"mac:Ctrl-Meta-Right":["speak","right",{withHighlighting:!1}],"!mac:Ctrl-Alt-Right":["speak","right",{withHighlighting:!1}],"!mac:Ctrl-Alt-Period":["speak","selection",{withHighlighting:!1}],"mac:Ctrl-Meta-Period":["speak","selection",{withHighlighting:!1}],"mac:Ctrl-Meta-Shift-Up":["speak","parent",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Up":["speak","parent",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Down":["speak","all",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Down":["speak","all",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Left":["speak","left",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Left":["speak","left",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Right":["speak","right",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Right":["speak","right",{withHighlighting:!0}],"!mac:Ctrl-Alt-Shift-Period":["speak","selection",{withHighlighting:!0}],"mac:Ctrl-Meta-Shift-Period":["speak","selection",{withHighlighting:!0}]},me={"\\theta":"Alt-KeyQ","\\sqrt":["Alt-KeyV","Ctrl-Digit2"],"\\pi":"Alt-KeyP","\\prod":"Alt-Shift-KeyP","\\sum":"Alt-KeyW","\\int":"Alt-KeyB","\\cup":"Alt-KeyU","\\cap":"Alt-KeyN","\\bigcup":"Alt-Shift-KeyU","\\bigcap":"Alt-Shift-KeyN","\\forall":"Alt-Shift-KeyA","\\exists":"Alt-Shift-KeyE","\\infty":"Alt-Digit5","\\wedge":"Alt-Digit5","\\vee":"Alt-Shift-Digit6","\\differentialD":"Alt-keyD","\\partial":"Alt-Shift-KeyD","\\frac":"Slash","\\emptyset":"Alt-KeyO","\\varnothing":"Alt-Shift-KeyO","\\~":"~"},ge={"''":{mode:"math",value:"^{\\doubleprime}"},alpha:"\\alpha",delta:"\\delta",Delta:"\\Delta",pi:{mode:"math",value:"\\pi"},"pi ":{mode:"text",value:"\\pi "},Pi:{mode:"math",value:"\\Pi"},theta:"\\theta",Theta:"\\Theta",ii:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryI"},jj:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryJ"},ee:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\exponentialE"},nabla:{mode:"math",value:"\\nabla"},grad:{mode:"math",value:"\\nabla"},del:{mode:"math",value:"\\partial"},"â":"\\infty",oo:{mode:"math",after:"nothing+digit+frac+surd+binop+relop+punct+array+openfence+closefence+space",value:"\\infty"},"â":{mode:"math",value:"\\sum"},sum:{mode:"math",value:"\\sum_{#?}^{#?}"},prod:{mode:"math",value:"\\prod_{#?}^{#?}"},sqrt:{mode:"math",value:"\\sqrt"},"â":{mode:"math",value:"\\differentialD"},"â":{mode:"math",value:"\\differentialD"},sin:{mode:"math",value:"\\sin"},cos:{mode:"math",value:"\\cos"},tan:{mode:"math",value:"\\tan"},tanh:{mode:"math",value:"\\tanh"},log:{mode:"math",value:"\\log"},ln:{mode:"math",value:"\\ln"},exp:{mode:"math",value:"\\exp"},lim:{mode:"math",value:"\\lim_{#?}"},dx:"\\differentialD x",dy:"\\differentialD y",dt:"\\differentialD t",AA:{mode:"math",value:"\\forall"},EE:{mode:"math",value:"\\exists"},"!EE":{mode:"math",value:"\\nexists"},"&&":{mode:"math",value:"\\land"},xin:{mode:"math",after:"nothing+text+relop+punct+openfence+space",value:"x \\in"},in:{mode:"math",after:"nothing+letter+closefence",value:"\\in"},"!in":{mode:"math",value:"\\notin"},NN:"\\N",ZZ:"\\Z",QQ:"\\Q",RR:"\\R",CC:"\\C",PP:"\\P",xx:"\\times","+-":"\\pm","!=":"\\ne",">=":"\\ge","<=":"\\le","<<":"\\ll",">>":"\\gg","~~":"\\approx","â":"\\approx","?=":"\\questeq","Ã·":"\\div","Â¬":"\\neg",":=":"\\coloneq","::":"\\Colon","(:":"\\langle",":)":"\\rangle",beta:"\\beta",chi:"\\chi",epsilon:"\\epsilon",varepsilon:"\\varepsilon",eta:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\eta"},"eta ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\eta "},gamma:"\\gamma",Gamma:"\\Gamma",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",Lambda:"\\Lambda",mu:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\mu"},"mu ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\mu "},nu:{mode:"math",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\nu"},"nu ":{mode:"text",after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\nu "},"Âµ":"\\mu",phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\phi"},Phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Phi"},varphi:"\\varphi",psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\psi"},Psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Psi"},rho:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\rho"},sigma:"\\sigma",Sigma:"\\Sigma",tau:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\tau"},vartheta:"\\vartheta",upsilon:"\\upsilon",xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\xi"},Xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Xi"},zeta:"\\zeta",omega:"\\omega",Omega:"\\Omega","Î©":"\\omega",forall:"\\forall",exists:{mode:"math",value:"\\exists"},"!exists":{mode:"math",value:"\\nexists"},":.":{mode:"math",value:"\\therefore"},liminf:"\\operatorname*{lim~inf}_{#?}",limsup:"\\operatorname*{lim~sup}_{#?}",argmin:"\\operatorname*{arg~min}_{#?}",argmax:"\\operatorname*{arg~max}_{#?}",det:"\\det",mod:{mode:"math",value:"\\mod"},max:{mode:"math",value:"\\max"},min:{mode:"math",value:"\\min"},erf:"\\operatorname{erf}",erfc:"\\operatorname{erfc}",bessel:{mode:"math",value:"\\operatorname{bessel}"},mean:{mode:"math",value:"\\operatorname{mean}"},median:{mode:"math",value:"\\operatorname{median}"},fft:{mode:"math",value:"\\operatorname{fft}"},lcm:{mode:"math",value:"\\operatorname{lcm}"},gcd:{mode:"math",value:"\\operatorname{gcd}"},randomReal:"\\operatorname{randomReal}",randomInteger:"\\operatorname{randomInteger}",Re:{mode:"math",value:"\\operatorname{Re}"},Im:{mode:"math",value:"\\operatorname{Im}"},mm:{mode:"math",after:"nothing+digit",value:"\\operatorname{mm}"},cm:{mode:"math",after:"nothing+digit",value:"\\operatorname{cm}"},km:{mode:"math",after:"nothing+digit",value:"\\operatorname{km}"},kg:{mode:"math",after:"nothing+digit",value:"\\operatorname{kg}"},"...":"\\ldots","+...":"+\\cdots","-...":"-\\cdots","->...":"\\to\\cdots","->":"\\to","|->":"\\mapsto","--\x3e":"\\longrightarrow","<--":"\\longleftarrow","=>":"\\Rightarrow","==>":"\\Longrightarrow","<=>":"\\Leftrightarrow","<->":"\\leftrightarrow","(.)":"\\odot","(+)":"\\oplus","(/)":"\\oslash","(*)":"\\otimes","(-)":"\\ominus","||":"\\Vert","{":"\\{","}":"\\}","*":"\\cdot"};function be(t,e,i){if(!i)return i;if("string"==typeof i)return i;if("string"==typeof i.mode&&i.mode!==t)return null;if(!e)return i?i.value:void 0;let s=!1,n=!1,r=!1,o=!1,a=!1,l=!1,c=!1,h=!1,u=!1,d=!1,p=!1,f=!1,m=!1,g=!1,b=e[e.length-1],y=e.length-1;for(;b&&/msubsup|placeholder/.test(b.type);)y-=1,b=e[y];return s=!b||"first"===b.type,b&&(m="text"===b.mode,n=!m&&"mord"===b.type&&St.LETTER.test(b.body),r=!m&&"mord"===b.type&&/[0-9]+$/.test(b.body),o=!m&&b.isFunction,a="genfrac"===b.type,l="surd"===b.type,c="mbin"===b.type,h="mrel"===b.type,u="mpunct"===b.type||"minner"===b.type,d=b.array,p="mopen"===b.type,f="mclose"===b.type||"leftright"===b.type,g="space"===b.type),void 0!==i.after?/nothing/.test(i.after)&&s||/letter/.test(i.after)&&n||/digit/.test(i.after)&&r||/function/.test(i.after)&&o||/frac/.test(i.after)&&a||/surd/.test(i.after)&&l||/binop/.test(i.after)&&c||/relop/.test(i.after)&&h||/punct/.test(i.after)&&u||/array/.test(i.after)&&d||/openfence/.test(i.after)&&p||/closefence/.test(i.after)&&f||/text/.test(i.after)&&m||/space/.test(i.after)&&g?i.value:null:i.value}function ye(t){let e="other";return navigator&&navigator.platform&&navigator.userAgent&&(/^(mac)/i.test(navigator.platform)?e="mac":/^(win)/i.test(navigator.platform)?e="win":/(android)/i.test(navigator.userAgent)?e="android":/(iphone)/i.test(navigator.userAgent)||/(ipod)/i.test(navigator.userAgent)||/(ipad)/i.test(navigator.userAgent)?e="ios":/\bCrOS\b/i.test(navigator.userAgent)&&(e="chromeos")),e===t?t:"!"+t}function ve(t){let e=t;return Array.isArray(e)&&e.length>0&&(e=e[0]+"("+e.slice(1).join("")+")"),e}function xe(t,e){let i="";Array.isArray(t)||(t=[t]);for(const s of t){let t;const n=s.match(/(^[^:]*):/),r=n?n[1]:"";if(r===ye("mac")||r===ye("win")||r===ye("ios")||r===ye("android")||r===ye("chromeos")||r===ye("other")){const e=s.match(/:([^:]*)$/);t=e?e[1]:s}else if(!["mac","!mac","win","!win","ios","!ios","android","!android","chromeos","!chromeos","other","!other"].includes(r)){const e=s.match(/:([^:]*)$/);t=e?e[1]:s}if(t){const s="mac"===ye("mac")||"ios"===ye("ios"),n=t.length>1?t.split("-"):[t];let r="";for(const t of n)!s&&r.length>0&&(r+='<span class="ML__shortcut-join">+</span>'),"Key"===t.substr(0,3)?r+=t.substr(3,1):"Digit"===t.substr(0,5)?r+=t.substr(5,1):r+={Meta:s?"â":"command",Shift:s?"â§":"shift",Alt:s?"â¥":"alt",Ctrl:s?"â":"control","\n":s?"â":"return",Return:s?"â":"return",Enter:s?"â¤":"enter",Tab:s?"â¥":"tab",Esc:"esc",Backspace:s?"â«":"backspace",Del:s?"â¦":"del",PageUp:s?"â":"page up",PageDown:s?"â":"page down",Home:s?"â¤":"home",End:s?"â¤":"end",Spacebar:"space",Semicolon:";",Period:".",Comma:",",Minus:"-",Equal:"=",Quote:"'",BracketLeft:"[",BracketRight:"]",Backslash:"\\",IntlBackslash:"\\",Backquote:"`",Slash:"/",NumpadMultiply:"* &#128290;",NumpadDivide:"/ &#128290;",NumpadSubtract:"- &#128290;",NumpadAdd:"+ &#128290;",NumpadDecimal:". &#128290;",NumpadComma:", &#128290;",Help:"help",Left:"â ",Up:"â¡",Right:"â¢",Down:"â£"}[t]||t;i.length>0&&(i+=e||" or "),i+=r}}return i}var Ce={KEYBOARD_SHORTCUTS:fe,INLINE_SHORTCUTS:ge,stringify:xe,startsWithString:function(t,e){const i=[];for(let s=0;s<=t.length-1;s++){const n=t.substring(s);e&&e.overrideDefaultInlineShortcuts||Object.keys(ge).forEach(t=>{t.startsWith(n)&&!i.includes(t)&&i.push(t)});const r=e&&e.inlineShortcuts?e.inlineShortcuts:null;r&&Object.keys(r).forEach(t=>{t.startsWith(n)&&i.push(t)})}return i},forString:function(t,e,i,s){let n="";s&&s.overrideDefaultInlineShortcuts||(n=be(t,e,ge[i]));const r=s&&s.inlineShortcuts?s.inlineShortcuts:null;let o;return r&&(o=be(t,e,r[i])),o||n},selectorForKeystroke:function(t,e){for(const i of[ye("mac")+":"+t+":"+e,ye("win")+":"+t+":"+e,ye("ios")+":"+t+":"+e,ye("android")+":"+t+":"+e,ye("chromeos")+":"+t+":"+e,ye("other")+":"+t+":"+e,ye("mac")+":"+e,ye("win")+":"+e,ye("ios")+":"+e,ye("android")+":"+e,ye("chromeos")+":"+e,t+":"+e,e])if(fe[i])return fe[i];return""},forCommand:function(t){let e=[];if("string"==typeof t){const i=me[t];Array.isArray(i)?e=i.slice():i&&e.push(i)}t=ve(t);const i=new RegExp("^"+t.replace("\\","\\\\").replace("|","\\|").replace("*","\\*").replace("$","\\$").replace("^","\\^")+"([^*a-zA-Z]|$)");return Object.keys(fe).forEach(t=>{if(i.test(ve(fe[t]))){const i=t.match(/:([^:]*)$/);i&&e.push(i[1])}}),xe(e)}};function _e(t,e){this.root=te.makeRoot(),this.path=[{relation:"body",offset:0}],this.extent=0,this.config=t?{...t}:{},this.target=e,this.suppressChangeNotifications=!1}function we(t){const e=Object.assign(new _e(t.config,t.target),t);return e.path=pe.clone(t.path),e}function Se(t,e){let i=0;for(let s=0;s<e.row;s++)for(let e=0;e<t[s].length;e++)i+=1;return i+=e.col,i}function Pe(t,e){if("string"==typeof e){const t=e.match(/cell([0-9]*)$/);t&&(e=parseInt(t[1]))}const i={row:0,col:0};for(;e>0;)i.col+=1,(!t[i.row]||i.col>=t[i.row].length)&&(i.col=0,i.row+=1),e-=1;return i}function ke(t,e){let i;return"object"!=typeof e&&(e=Pe(t,e)),Array.isArray(t[e.row])&&(i=t[e.row][e.col]||null),!i||0!==i.length&&"first"===i[0].type||i.unshift(Ie()),i}function Ee(t){let e=0,i=0,s=1;for(const n of t)i+=1,n.length>s&&(s=n.length);return e=i*s,e}function Te(t,e,i){if(!t)return[];e||(e=",");let s,n=[];for(let r of t)r&&r.length>0&&"first"===r[0].type&&(r=r.slice(1)),r&&r.length>0&&(s?n.push(s):s=new te.MathAtom("math","mpunct",e,i),n=n.concat(r));return n}function Ae(t,e,i){const s={...e};if(s.row+=i,s.row<0){if(s.col+=i,s.row=t.length-1,s.col<0)return null;for(;s.row>=0&&!ke(t,s);)s.row-=1;if(s.row<0)return null}else if(s.row>=t.length){for(s.col+=i,s.row=0;s.row<t.length&&!ke(t,s);)s.row+=1;if(s.row>t.length-1)return null}return s}function Oe(t){return!!t&&("mord"===t.type&&/[0-9.]/.test(t.body)||"mpunct"===t.type&&","===t.body)}function Me(t,e){if(!t)return!1;if(Array.isArray(t)){for(const i of t)if(Me(i,e))return!0}else{if(t===e)return!0;if(["body","numer","denom","index","subscript","superscript","underscript","overscript"].some((function(i){return i===e||Me(t[i],e)})))return!0;if(t.array)for(let i=Ee(t.array);i>=0;i--)if(Me(ke(t.array,i),e))return!0}return!1}function Ne(t){if(t)return 1===t.length&&"leftright"===t[0].type&&"("===t[0].leftDelim&&(t=t[0].body),t}function Le(t,e){return t?t.length<=1?t:(e&&"ASCIIMath"===e.format||(t=t.replace(/\\\\([^\s\n])/g,"\\$1")),e&&"ASCIIMath"===e.format||!/\\/.test(t)?De(t=(t=(t=(t=(t=(t=t.replace(/\u2061/gu,"")).replace(/\u3016/gu,"{")).replace(/\u3017/gu,"}")).replace(/([^\\])sinx/g,"$1\\sin x")).replace(/([^\\])cosx/g,"$1\\cos x ")).replace(/\u2013/g,"-"),e):t):""}function De(t,e){if(!t)return"";let i,s=!1;if(s||"^"!==t[0]&&"_"!==t[0]||(i=je(t.substr(1),{...e,noWrap:!0}),t=t[0]+"{"+i.match+"}",t+=De(i.rest,e),s=!0),s||(i=t.match(/^(sqrt|\u221a)(.*)/),i&&(i=je(i[2],{...e,noWrap:!0}),t="\\sqrt{"+i.match+"}",t+=De(i.rest,e),s=!0)),s||(i=t.match(/^(\\cbrt|\u221b)(.*)/),i&&(i=je(i[2],{...e,noWrap:!0}),t="\\sqrt[3]{"+i.match+"}",t+=De(i.rest,e),s=!0)),s||(i=t.match(/^abs(.*)/),i&&(i=je(i[1],{...e,noWrap:!0}),t="\\left|"+i.match+"\\right|",t+=De(i.rest,e),s=!0)),s||(i=t.match(/^["ââ](.*?)["ââ](.*)/),i&&(t="\\text{"+i[1]+"}",t+=De(i[2],e),s=!0)),s||(i=t.match(/^([^a-zA-Z({[_^\\\s"]+)(.*)/),i&&(t=Re(i[1],e),t+=De(i[2],e),s=!0)),!s&&/^(f|g|h)[^a-zA-Z]/.test(t)&&(i=je(t.substring(1),e),t=t[0],t+=i.match,t+=De(i.rest,e),s=!0),s||(i=t.match(/^([a-zA-Z]+)(.*)/),i&&(t=Re(i[1],e),t+=De(i[2],e),s=!0)),!s)if(i=je(t,{...e,noWrap:!0}),i.match&&"/"===i.rest[0]){const n=je(i.rest.substr(1),{...e,noWrap:!0});n.match&&(t="\\frac{"+i.match+"}{"+n.match+"}"+De(n.rest,e)),s=!0}else i.match&&/^(\(|\{|\[)$/.test(t[0])?(t="\\left"+t[0]+i.match+"\\right"+{"(":")","{":"}","[":"]"}[t[0]]+De(i.rest,e),s=!0):i.match&&(t=i.match,t+=De(i.rest,e),s=!0);return s||(i=t.match(/^(\s+)(.*)$/),i&&(t=" "+De(i[2],e),s=!0)),t}function je(t,e){let i="",s=t=t.trim();const n=t.charAt(0),r={"(":")","{":"}","[":"]"}[n];if(r){let o=1,a=1;for(;a<t.length&&o>0;)t[a]===n&&o++,t[a]===r&&o--,a++;0===o?(i=e.noWrap&&"("===n&&")"===r?De(t.substring(1,a-1),e):"\\mleft"+n+De(t.substring(1,a-1),e)+"\\mright"+r,s=t.substring(a)):(i=t.substring(1,a),s="")}else{let n=t.match(/^([a-zA-Z]+)/);if(n){let i=Ce.forString("math",null,t,e);if(i)return i=i.replace("_{#?}",""),i=i.replace("^{#?}",""),{match:i,rest:t.substring(i.length)}}if(n=t.match(/^([a-zA-Z])/),n)return{match:n[1],rest:t.substring(1)};if(n=t.match(/^(-)?\d+(\.\d*)?/),n)return{match:n[0],rest:t.substring(n[0].length)};/^\\(left|right)/.test(t)||(n=t.match(/^(\\[a-zA-Z]+)/),n&&(s=t.substring(n[1].length),i=n[1]))}return{match:i,rest:s}}function Re(t,e){let i=Ce.forString("math",null,t,e);return i?(i=i.replace("_{#?}",""),i=i.replace("^{#?}",""),i+=" "):i=t,i}function Ie(){return new te.MathAtom("","first")}_e.prototype._announce=function(t,e,i){"function"==typeof this.config.onAnnounce&&this.config.onAnnounce(this.target,t,e,i)},_e.prototype.filter=function(t,e){e=e<0?-1:1;const i=[],s=new _e;s.path=pe.clone(this.path),s.extent=this.extent,s.root=this.root,e>=0?s.collapseForward():(s.collapseBackward(),s.move(1));const n=s.anchor();do{t.bind(s)(s.path,s.anchor())&&i.push(s.toString()),e>=0?s.next({iterateAll:!0}):s.previous({iterateAll:!0})}while(n!==s.anchor());return i},_e.prototype.forEach=function(t){this.root.forEach(t)},_e.prototype.forEachSelected=function(t,e){(e=e||{}).recursive=void 0!==e.recursive&&e.recursive;const i=this.siblings(),s=this.startOffset()+1,n=this.endOffset()+1;if(e.recursive)for(let r=s;r<n;r++)i[r]&&"first"!==i[r].type&&i[r].forEach(t);else for(let r=s;r<n;r++)i[r]&&"first"!==i[r].type&&t(i[r])},_e.prototype.toString=function(){return pe.pathToString(this.path,this.extent)},_e.prototype.adjustPlaceholder=function(){const t=this.siblings();if(t&&t.length<=1){let e;const i=this.relation();if("numer"===i?e="numerator":"denom"===i?e="denominator":"surd"===this.parent().type&&"body"===i?e="radicand":"overunder"===this.parent().type&&"body"===i?e="base":"underscript"!==i&&"overscript"!==i||(e="annotation"),e){const e=[new te.MathAtom("math","placeholder","â¬",this.anchorStyle())];Array.prototype.splice.apply(t,[1,0].concat(e))}}},_e.prototype.selectionWillChange=function(){"function"!=typeof this.config.onSelectionWillChange||this.suppressChangeNotifications||this.config.onSelectionWillChange(this.target)},_e.prototype.selectionDidChange=function(){"function"!=typeof this.config.onSelectionDidChange||this.suppressChangeNotifications||this.config.onSelectionDidChange(this.target)},_e.prototype.contentWillChange=function(){"function"!=typeof this.config.onContentWillChange||this.suppressChangeNotifications||this.config.onContentWillChange(this.target)},_e.prototype.contentDidChange=function(){"function"!=typeof this.config.onContentDidChange||this.suppressChangeNotifications||this.config.onContentDidChange(this.target)},_e.prototype.setPath=function(t,e){if("string"==typeof t)t=pe.pathFromString(t);else if(Array.isArray(t)){const i=pe.clone(t),s=this.path;this.path=i,0===e&&"placeholder"===this.anchor().type&&(i[i.length-1].offset=0,e=1),t={path:i,extent:e||0},this.path=s}const i=0!==pe.pathDistance(this.path,t.path),s=t.extent!==this.extent;return(i||s)&&(i&&this.adjustPlaceholder(),this.selectionWillChange(),this.path=pe.clone(t.path),this.siblings().length<this.anchorOffset()?(this.path=[{relation:"body",offset:0}],this.extent=0):this.setExtent(t.extent),this.selectionDidChange()),i||s},_e.prototype.wordBoundary=function(t,e){e=e<0?-1:1;const i=new _e;i.path=pe.clone(t),i.root=this.root;let s=0;for(;i.sibling(s)&&"text"===i.sibling(s).mode&&St.LETTER_AND_DIGITS.test(i.sibling(s).body);)s+=e;return i.sibling(s)||(s-=e),i.path[i.path.length-1].offset+=s,i.path},_e.prototype.wordBoundaryOffset=function(t,e){e=e<0?-1:1;const i=this.siblings();if(!i[t])return t;if("text"!==i[t].mode)return t;let s;if(St.LETTER_AND_DIGITS.test(i[t].body)){let n,r=t;do{n="text"===i[r].mode&&St.LETTER_AND_DIGITS.test(i[r].body),r+=e}while(i[r]&&n);s=i[r]?r-2*e:r-e}else if(/\s/.test(i[t].body)){let n=t;for(;i[n]&&"text"===i[n].mode&&/\s/.test(i[n].body);)n+=e;if(i[n]){let t=!0;do{t="text"===i[n].mode&&!/\s/.test(i[n].body),n+=e}while(i[n]&&t);s=i[n]?n-2*e:n-e}else s=n-e}else{let n=t;for(;i[n]&&"text"===i[n].mode&&!/\s/.test(i[n].body);)n+=e;s=i[n]?n:n-e;let r=!0;for(;i[n]&&r;)r="text"===i[n].mode&&/\s/.test(i[n].body),r&&(s=n),n+=e;s=i[n]?n-2*e:n-e}return s-(e>0?0:1)},_e.prototype.setRange=function(t,e,i){i=i||{};const s=pe.pathDistance(t,e);if(0===s)return i.extendToWordBoundary?(t=this.wordBoundary(t,-1),e=this.wordBoundary(e,1),this.setRange(t,e)):this.setPath(pe.clone(t),0);if(1===s){const s=e[e.length-1].offset-t[t.length-1].offset;return i.extendToWordBoundary?(t=this.wordBoundary(t,s<0?1:-1),e=this.wordBoundary(e,s<0?-1:1),this.setRange(t,e)):this.setPath(pe.clone(t),s)}let n=pe.pathCommonAncestor(t,e);const r=n.length;if(t.length===r||e.length===r||t[r].relation!==e[r].relation)return this.setPath(n,-1);n.push(t[r]),n=pe.clone(n);let o=e[r].offset-t[r].offset+1;return o<=0?e.length>r+1?(n[r].relation=e[r].relation,n[r].offset=e[r].offset,n[n.length-1].offset-=1,o=2-o):(n[r].relation=e[r].relation,n[r].offset=e[r].offset,o=1-o):e.length<=t.length?n[n.length-1].offset-=1:e.length>t.length&&(n[r].offset-=1),this.setPath(n,o)},_e.prototype.ancestor=function(t){if(t>this.path.length)return null;let e=this.root;for(let i=0;i<this.path.length-t;i++){const t=this.path[i];if(e.array)e=ke(e.array,t.relation)[t.offset];else{if(!e[t.relation])return null;{0!==e[t.relation].length&&"first"===e[t.relation][0].type||e[t.relation].unshift(Ie());const i=Math.min(t.offset,e[t.relation].length-1);e=e[t.relation][i]}}}return e},_e.prototype.anchor=function(){if(this.parent().array)return ke(this.parent().array,this.relation())[this.anchorOffset()];const t=this.siblings();return t[Math.min(t.length-1,this.anchorOffset())]},_e.prototype.parent=function(){return this.ancestor(1)},_e.prototype.relation=function(){return this.path.length>0?this.path[this.path.length-1].relation:""},_e.prototype.anchorOffset=function(){return this.path.length>0?this.path[this.path.length-1].offset:0},_e.prototype.focusOffset=function(){return this.path.length>0?this.path[this.path.length-1].offset+this.extent:0},_e.prototype.startOffset=function(){return Math.min(this.focusOffset(),this.anchorOffset())},_e.prototype.endOffset=function(){return Math.max(this.focusOffset(),this.anchorOffset())},_e.prototype.insertFirstAtom=function(){this.siblings()},_e.prototype.siblings=function(){if(0===this.path.length)return[];let t;return this.parent().array?t=ke(this.parent().array,this.relation()):(t=this.parent()[this.relation()]||[],"string"==typeof t&&(t=[])),0!==t.length&&"first"===t[0].type||t.unshift(Ie()),t},_e.prototype.sibling=function(t){return this.siblings()[this.startOffset()+t]},_e.prototype.isCollapsed=function(){return 0===this.extent},_e.prototype.setExtent=function(t){this.extent=t},_e.prototype.collapseForward=function(){return 0!==this.extent&&(this.setSelection(this.endOffset()),!0)},_e.prototype.collapseBackward=function(){return 0!==this.extent&&(this.setSelection(this.startOffset()),!0)},_e.prototype.selectGroup_=function(){const t=this.siblings();if("text"===this.anchorMode()){let e=this.startOffset(),i=this.endOffset();for(;t[e]&&"text"===t[e].mode&&St.LETTER_AND_DIGITS.test(t[e].body);)e-=1;for(;t[i]&&"text"===t[i].mode&&St.LETTER_AND_DIGITS.test(t[i].body);)i+=1;if(i-=1,e>=i)return void this.setSelection(this.endOffset()-1,1);this.setSelection(e,i-e)}else if("mord"===this.sibling(0).type&&/[0-9,.]/.test(this.sibling(0).body)){let e=this.startOffset(),i=this.endOffset();for(;Oe(t[e]);)e-=1;for(;Oe(t[i]);)i+=1;i-=1,this.setSelection(e,i-e)}else this.setSelection(0,"end")},_e.prototype.selectAll_=function(){this.path=[{relation:"body",offset:0}],this.setSelection(0,"end")},_e.prototype.deleteAll_=function(){this.selectAll_(),this.delete_()},_e.prototype.contains=function(t){if(this.isCollapsed())return!1;const e=this.siblings(),i=this.startOffset(),s=this.endOffset();for(let n=i;n<s;n++)if(Me(e[n],t))return!0;return!1},_e.prototype.getSelectedAtoms=function(){if(this.isCollapsed())return null;const t=[],e=this.siblings(),i=this.startOffset()+1,s=this.endOffset()+1;for(let n=i;n<s;n++)e[n]&&"first"!==e[n].type&&t.push(e[n]);return t},_e.prototype.commandOffsets=function(){const t=this.siblings();if(t.length<=1)return null;let e=Math.min(this.endOffset(),t.length-1);if("command"!==t[e].type)return null;for(;e>0&&"command"===t[e].type;)e-=1;let i=this.startOffset()+1;for(;i<=t.length-1&&"command"===t[i].type;)i+=1;return i>e?{start:e+1,end:i}:null},_e.prototype.extractCommandStringAroundInsertionPoint=function(t){let e="";const i=this.commandOffsets();if(i){const s=t?this.anchorOffset()+1:i.end,n=this.siblings();for(let t=i.start;t<s;t++)e+=n[t].body||""}return e},_e.prototype.decorateCommandStringAroundInsertionPoint=function(t){const e=this.commandOffsets();if(e){const i=this.siblings();for(let s=e.start;s<e.end;s++)i[s].error=t}},_e.prototype.commitCommandStringBeforeInsertionPoint=function(){const t=this.commandOffsets();if(t){const e=this.siblings(),i=this.anchorOffset()+1;for(let s=t.start;s<i;s++)e[s]&&(e[s].suggestion=!1)}},_e.prototype.spliceCommandStringAroundInsertionPoint=function(t){const e=this.commandOffsets();if(e){if(this.contentWillChange(),t){Array.prototype.splice.apply(this.siblings(),[e.start,e.end-e.start].concat(t));let i=[];for(const e of t)i=i.concat(e.filter(t=>"placeholder"===t.type));this.setExtent(0),this.path[this.path.length-1].offset=e.start-1,0!==i.length&&this.leap(1,!1)||this.setSelection(e.start+t.length-1)}else this.siblings().splice(e.start,e.end-e.start),this.setSelection(e.start-1,0);this.contentDidChange()}},_e.prototype.removeCommandString=function(){this.contentWillChange();const t=this.suppressChangeNotifications;this.suppressChangeNotifications=!0,function t(e){if(e)if(Array.isArray(e))for(let i=e.length-1;i>=0;i--)"command"===e[i].type?e.splice(i,1):t(e[i]);else if(t(e.body),t(e.superscript),t(e.subscript),t(e.underscript),t(e.overscript),t(e.numer),t(e.denom),t(e.index),e.array)for(let i=Ee(e.array);i>=0;i--)t(ke(e.array,i))}(this.root.body),this.suppressChangeNotifications=t,this.contentDidChange()},_e.prototype.extractArgBeforeInsertionPoint=function(){const t=this.siblings();if(t.length<=1)return[];const e=[];let i=this.startOffset();if("text"===t[i].mode)for(;i>=1&&"text"===t[i].mode;)e.unshift(t[i]),i--;else for(;i>=1&&/^(mord|surd|msubsup|leftright|mop)$/.test(t[i].type);)e.unshift(t[i]),i--;return e},_e.prototype.setSelection=function(t,e,i){t=t||0,e=e||0;const s=this.path[this.path.length-1].relation;i||(i=s);const n=this.parent();if(!n&&"body"!==i)return!1;const r=i.startsWith("cell");if(!r&&!n[i]||r&&!n.array)return!1;const o=i!==s;this.path[this.path.length-1].relation=i;const a=this.siblings().length;this.path[this.path.length-1].relation=s;const l=this.extent;"end"===e?e=a-t-1:"start"===e&&(e=-t),this.setExtent(e);const c=this.extent!==l;return this.setExtent(l),t<0&&(t=a+t),t=Math.max(0,Math.min(t,a-1)),(o||this.path[this.path.length-1].offset!==t||c)&&(o&&this.adjustPlaceholder(),this.selectionWillChange(),this.path[this.path.length-1].relation=i,this.path[this.path.length-1].offset=t,this.setExtent(e),this.selectionDidChange()),!0},_e.prototype.next=function(t){t=t||{};const e={body:"numer",numer:"denom",denom:"index",index:"overscript",overscript:"underscript",underscript:"subscript",subscript:"superscript"};if(this.anchorOffset()===this.siblings().length-1){this.adjustPlaceholder();let i=e[this.relation()];const s=this.parent();for(;i&&!s[i];)i=e[i];if(i)return void this.setSelection(0,0,i);if(this.parent().array){const t=Ee(this.parent().array);let e=parseInt(this.relation().match(/cell([0-9]*)$/)[1])+1;for(;e<t;){if(ke(this.parent().array,e)&&this.setSelection(0,0,"cell"+e))return void this.selectionDidChange();e+=1}}if(1===this.path.length)(this.suppressChangeNotifications||!this.config.onMoveOutOf||this.config.onMoveOutOf(this,"forward"))&&(this.path[0].offset=0);else{const e=!t.iterateAll&&this.parent().skipBoundary;this.path.pop(),e&&this.next(t)}return void this.selectionDidChange()}this.setSelection(this.anchorOffset()+1);const i=this.anchor();if(i&&!i.captureSelection){let s;if(i.array){let t=0;s="";const e=Ee(i.array);for(;!s&&t<e;)ke(i.array,t)&&(s="cell"+t.toString()),t+=1;return this.path.push({relation:s,offset:0}),void this.setSelection(0,0,s)}for(s="body";s;){if(Array.isArray(i[s]))return this.path.push({relation:s,offset:0}),this.insertFirstAtom(),void(!t.iterateAll&&i.skipBoundary&&this.next(t));s=e[s]}}},_e.prototype.previous=function(t){const e={numer:"body",denom:"numer",index:"denom",overscript:"index",underscript:"overscript",subscript:"underscript",superscript:"subscript"};if(!(t=t||{}).iterateAll&&1===this.anchorOffset()&&this.parent()&&this.parent().skipBoundary&&this.setSelection(0),this.anchorOffset()<1){let t=e[this.relation()];for(;t&&!this.setSelection(-1,0,t);)t=e[t];const i=this.parent()?this.parent().type:"none";if("body"!==t||"msubsup"!==i&&"mop"!==i||(t=null),t)return;if(this.adjustPlaceholder(),this.selectionWillChange(),this.relation().startsWith("cell")){let t=parseInt(this.relation().match(/cell([0-9]*)$/)[1])-1;for(;t>=0;){if(ke(this.parent().array,t)&&this.setSelection(-1,0,"cell"+t))return void this.selectionDidChange();t-=1}}return 1===this.path.length?(this.suppressChangeNotifications||!this.config.onMoveOutOf||this.config.onMoveOutOf.bind(this)(-1))&&(this.path[0].offset=this.root.body.length-1):(this.path.pop(),this.setSelection(this.anchorOffset()-1)),void this.selectionDidChange()}const i=this.anchor();if(!i.captureSelection){let t;if(i.array){t="";const e=Ee(i.array);let s=e-1;for(;!t&&s<e;)ke(i.array,s)&&(t="cell"+s.toString()),s-=1;return s+=1,this.path.push({relation:t,offset:ke(i.array,s).length-1}),void this.setSelection(-1,0,t)}for(t="superscript";t;){if(Array.isArray(i[t]))return this.path.push({relation:t,offset:i[t].length-1}),void this.setSelection(-1,0,t);t=e[t]}}this.setSelection(this.anchorOffset()-1),!t.iterateAll&&this.sibling(0)&&this.sibling(0).skipBoundary&&this.previous(t)},_e.prototype.move=function(t,e){const i=(e=e||{extend:!1}).extend||!1;if(this.removeSuggestion(),i)this.extend(t,e);else{const e=we(this);if(t>0)for(this.collapseForward()&&t--;t>0;)this.next(),t--;else if(t<0)for(this.collapseBackward()&&t++;0!==t;)this.previous(),t++;this._announce("move",e)}},_e.prototype.up=function(t){const e=(t=t||{extend:!1}).extend||!1;this.collapseBackward();const i=this.relation();if("denom"===i)e?(this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange()):this.setSelection(this.anchorOffset(),0,"numer"),this._announce("moveUp");else if(this.parent().array){let e=Pe(this.parent().array,i);e=Ae(this.parent().array,e,-1),e&&ke(e)?(this.path[this.path.length-1].relation="cell"+Se(this.parent().array,e),this.setSelection(this.anchorOffset()),this._announce("moveUp")):this.move(-1,t)}else this._announce("line")},_e.prototype.down=function(t){const e=(t=t||{extend:!1}).extend||!1;this.collapseForward();const i=this.relation();if("numer"===i)e?(this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange()):this.setSelection(this.anchorOffset(),0,"denom"),this._announce("moveDown");else if(this.parent().array){let e=Pe(this.parent().array,i);e=Ae(this.parent().array,e,1),e&&ke(e)?(this.path[this.path.length-1].relation="cell"+Se(this.parent().array,e),this.setSelection(this.anchorOffset()),this._announce("moveDown")):this.move(1,t)}else this._announce("line")},_e.prototype.extend=function(t){let e=this.path[this.path.length-1].offset,i=0;const s=we(this);i=this.extent+t;const n=e+i;if(n<0&&0!==i){if(this.path.length>1)return this.selectionWillChange(),this.path.pop(),this.setExtent(-1),this.selectionDidChange(),void this._announce("move",s);e=this.path[this.path.length-1].offset,i=this.extent}else if(n>=this.siblings().length){if(this.path.length>1)return this.selectionWillChange(),this.path.pop(),this.path[this.path.length-1].offset-=1,this.setExtent(1),this.selectionDidChange(),void this._announce("move",s);this.isCollapsed()&&(e-=1),i-=1}this.setSelection(e,i),this._announce("move",s)},_e.prototype.skip=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=t<0?-1:1;const s=we(this),n=this.siblings(),r=this.focusOffset();let o=r+t;if(i&&(o=Math.min(Math.max(0,o),n.length-1)),o<0||o>=n.length)this.move(t,e);else{if(n[o]&&"text"===n[o].mode){if(o=this.wordBoundaryOffset(o,t),o<0&&!i)return void this.setSelection(0);if(o>n.length)return this.setSelection(n.length-1),void this.move(t,e)}else{const e=n[o]?n[o].type:"";if("mopen"===e&&t>0||"mclose"===e&&t<0){let i="mopen"===e?1:-1;for(o+=t>0?1:-1;o>=0&&o<n.length&&0!==i;)"mopen"===n[o].type?i+=1:"mclose"===n[o].type&&(i-=1),o+=t;0!==i&&(o=r+t),t>0&&(o-=1)}else{for(;n[o]&&"math"===n[o].mode&&n[o].type===e;)o+=t;o-=t>0?1:0}}if(i){const t=this.anchorOffset();this.setSelection(t,o-t)}else this.setSelection(o);this._announce("move",s)}},_e.prototype.jump=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=t<0?-1:1;const s=this.siblings();let n=this.focusOffset();t>0&&(n=Math.min(n+1,s.length-1));const r=t<0?0:s.length-1;i?this.extend(r-n):this.move(r-n)},_e.prototype.jumpToMathFieldBoundary=function(t,e){const i=(e=e||{extend:!1}).extend||!1;t=(t=t||1)<0?-1:1;const s=we(this),n=[{relation:"body",offset:this.path[0].offset}];let r;i?t<0?n[0].offset>0&&(r=-n[0].offset):n[0].offset<this.siblings().length-1&&(r=this.siblings().length-1-n[0].offset):(n[0].offset=t<0?0:this.root.body.length-1,r=0),this.setPath(n,r),this._announce("move",s)},_e.prototype.leap=function(t,e){t=(t=t||1)<0?-1:1,e=e||!0;const i=this.suppressChangeNotifications;this.suppressChangeNotifications=!0;const s=we(this),n=this.extent;this.move(t),"placeholder"===this.anchor().type&&this.move(t);const r=this.filter((t,e)=>"placeholder"===e.type||t.length>1&&1===this.siblings().length,t);if(0===r.length){if(this.setPath(s,n),e)if(this.config.onTabOutOf)this.config.onTabOutOf(this.target,t>0?"forward":"backward");else if(document.activeElement){const e=Array.prototype.filter.call(document.querySelectorAll('a[href]:not([disabled]),\n                    button:not([disabled]),\n                    textarea:not([disabled]),\n                    input[type=text]:not([disabled]),\n                    select:not([disabled]),\n                    [contentEditable="true"],\n                    [tabindex]:not([disabled]):not([tabindex="-1"])'),t=>(t.offsetWidth>0||t.offsetHeight>0)&&!t.contains(document.activeElement)||t===document.activeElement);let i=e.indexOf(document.activeElement)+t;i<0&&(i=e.length-1),i>=e.length&&(i=0),e[i].focus()}return this.suppressChangeNotifications=i,!1}return this.selectionWillChange(),this.setPath(r[0]),"placeholder"===this.anchor().type&&this.setExtent(-1),this._announce("move",s),this.selectionDidChange(),this.suppressChangeNotifications=i,!0},_e.prototype.anchorMode=function(){const t=this.isCollapsed()?this.anchor():this.sibling(1);let e;if(t){if("commandliteral"===t.type||"command"===t.type)return"command";e=t.mode}let i=1,s=this.ancestor(i);for(;!e&&s;)s&&(e=s.mode),i+=1,s=this.ancestor(i);return e},_e.prototype.anchorStyle=function(){const t=this.isCollapsed()?this.anchor():this.sibling(1);let e;if(t&&"first"!==t.type){if("commandliteral"===t.type||"command"===t.type)return{};e={color:t.color,backgroundColor:t.backgroundColor,fontFamily:t.fontFamily,fontShape:t.fontShape,fontSeries:t.fontSeries,fontSize:t.fontSize}}let i=1,s=this.ancestor(i);for(;!e&&s;)s&&(e={color:s.color,backgroundColor:s.backgroundColor,fontFamily:s.fontFamily,fontShape:s.fontShape,fontSeries:s.fontSeries,fontSize:s.fontSize}),i+=1,s=this.ancestor(i);return e},_e.prototype.simplifyParen=function(t){if(t&&this.config.removeExtraneousParentheses){for(let e=0;t[e];e++)if("leftright"===t[e].type&&"("===t[e].leftDelim&&Array.isArray(t[e].body)){let i=0,s=0,n=0;for(let r=0;t[e].body[r];r++)"genfrac"===t[e].body[r].type&&(i++,s=r),"first"!==t[e].body[r].type&&n++;0===n&&1===i&&(t[e]=t[e].body[s])}t.forEach(t=>{if("genfrac"===t.type&&(this.simplifyParen(t.numer),this.simplifyParen(t.denom),t.numer=Ne(t.numer),t.denom=Ne(t.denom)),t.superscript&&(this.simplifyParen(t.superscript),t.superscript=Ne(t.superscript)),t.subscript&&(this.simplifyParen(t.subscript),t.subscript=Ne(t.subscript)),t.underscript&&(this.simplifyParen(t.underscript),t.underscript=Ne(t.underscript)),t.overscript&&(this.simplifyParen(t.overscript),t.overscript=Ne(t.overscript)),t.index&&(this.simplifyParen(t.index),t.index=Ne(t.index)),"surd"===t.type?(this.simplifyParen(t.body),t.body=Ne(t.body)):t.body&&Array.isArray(t.body)&&this.simplifyParen(t.body),t.array)for(let e=Ee(t.array);e>=0;e--)this.simplifyParen(ke(t.array,e))})}},_e.prototype.insert=function(t,e){if((e=e||{}).smartFence&&this._insertSmartFence(t,e.style))return;const i=this.suppressChangeNotifications;e.suppressChangeNotifications&&(this.suppressChangeNotifications=!0),this.contentWillChange();const s=this.suppressChangeNotifications;this.suppressChangeNotifications=!0,e.insertionMode||(e.insertionMode="replaceSelection"),e.selectionMode||(e.selectionMode="placeholder"),e.format||(e.format="auto"),e.macros=e.macros||this.config.macros;const n=e.mode||this.anchorMode();let r;const a=[this.getSelectedAtoms()];void 0!==e.placeholder&&(a["?"]=e.placeholder),"replaceSelection"!==e.insertionMode||this.isCollapsed()?"replaceAll"===e.insertionMode?(this.root.body.splice(1),this.path=[{relation:"body",offset:0}],this.extent=0):"insertBefore"===e.insertionMode?this.collapseBackward():"insertAfter"===e.insertionMode&&this.collapseForward():this.delete_();const l=this.siblings(),c=this.startOffset();if(c+1<l.length&&l[c+1]&&"placeholder"===l[c+1].type?this.delete_(1):c>0&&l[c]&&"placeholder"===l[c].type&&this.delete_(-1),"math"===n&&"ASCIIMath"===e.format)t=Le(t,{...this.config,format:"ASCIIMath"}),r=he.parseTokens(o(t),"math",null,e.macros,!1),this.simplifyParen(r);else if("text"!==n&&"auto"===e.format)if("command"===n){r=[];for(const e of t)St.COMMAND_MODE_CHARACTERS.test(e)&&r.push(new te.MathAtom("command","command",e))}else""===t?r=[new te.MathAtom("command","command","\\")]:(t=Le(t,this.config),a[0]?t=t.replace(/(^|[^\\])#@/g,"$1#0"):/(^|[^\\])#@/.test(t)?(t=t.replace(/(^|[^\\])#@/g,"$1#0"),a[0]=this.extractArgBeforeInsertionPoint(),this._deleteAtoms(-a[0].length),Array.isArray(a[0])&&0===a[0].length&&(a[0]=void 0)):t=t.replace(/(^|[^\\])#@/g,"$1#?"),r=he.parseTokens(o(t),n,a,e.macros,e.smartFence),this.simplifyParen(r));else"latex"===e.format?r=he.parseTokens(o(t),n,a,e.macros,e.smartFence):"text"!==n&&"text"!==e.format||(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"\\textbackslash ")).replace(/#/g,"\\#")).replace(/\$/g,"\\$")).replace(/%/g,"\\%")).replace(/&/g,"\\&")).replace(/_/g,"\\_")).replace(/{/g,"\\textbraceleft ")).replace(/}/g,"\\textbraceright ")).replace(/\^/g,"\\textasciicircum ")).replace(/~/g,"\\textasciitilde ")).replace(/Â£/g,"\\textsterling "),r=he.parseTokens(o(t),"text",a,e.macros,!1));!function t(e,i){e&&i&&(Array.isArray(e)?e.forEach(e=>t(e,i)):"object"==typeof e&&(e.color||e.backgroundColor||e.fontFamily||e.fontShape||e.fontSeries||e.fontSize||(e.applyStyle(i),t(e.body,i),t(e.numer,i),t(e.denom,i),t(e.index,i),t(e.overscript,i),t(e.underscript,i),t(e.subscript,i),t(e.superscript,i))))}(r,e.style);const h=this.parent();if(this.config.removeExtraneousParentheses&&h&&"leftright"===h.type&&"("===h.leftDelim&&function(t){return 0===t.length||1===t.length&&"first"===t[0].type}(h.body)&&r&&1===r.length&&"genfrac"===r[0].type?(this.path.pop(),this.siblings()[this.anchorOffset()]=r[0]):Array.prototype.splice.apply(this.siblings(),[this.anchorOffset()+1,0].concat(r)),this.insertFirstAtom(),this.suppressChangeNotifications=s,"placeholder"===e.selectionMode){let t=[];for(const e of r)t=t.concat(e.filter(t=>"placeholder"===t.type));0!==t.length&&this.leap(1,!1)?this._announce("move"):this.setSelection(this.anchorOffset()+r.length)}else"before"===e.selectionMode||("after"===e.selectionMode?this.setSelection(this.anchorOffset()+r.length):"item"===e.selectionMode&&this.setSelection(this.anchorOffset(),r.length));this.contentDidChange(),this.suppressChangeNotifications=i},_e.prototype._insertSmartFence=function(t,e){const i=this.parent();if("leftright"===i.type&&"|"!==i.leftDelim&&/\||\\vert|\\Vert|\\mvert|\\mid/.test(t))return this.insert("\\,\\middle"+t+"\\, ",{mode:"math",format:"latex",style:e}),!0;"{"!==t&&"\\{"!==t||(t="\\lbrace"),"}"!==t&&"\\}"!==t||(t="\\rbrace"),"["!==t&&"\\["!==t||(t="\\lbrack"),"]"!==t&&"\\]"!==t||(t="\\rbrack");const s=St.RIGHT_DELIM[t];if(s&&("leftright"!==i.type||"|"!==i.leftDelim)){let i="";const n=this.isCollapsed()||"placeholder"===this.anchor().type;i=this.sibling(0).isFunction?"\\mleft"+t+"\\mright":"\\left"+t+"\\right",i+=n?"?":s;let r=[];return n&&(r=this.siblings().splice(this.anchorOffset()+1,this.siblings().length)),this.insert(i,{mode:"math",format:"latex",style:e}),n&&(this.sibling(0).body=r,this.move(-1)),!0}let n;if(Object.keys(St.RIGHT_DELIM).forEach(e=>{t===St.RIGHT_DELIM[e]&&(n=e)}),n){if(i&&"leftright"===i.type&&this.endOffset()===this.siblings().length-1)return this.contentWillChange(),i.rightDelim=t,this.move(1),this.contentDidChange(),!0;const s=this.siblings();let n;for(n=this.endOffset();n>=0&&("leftright"!==s[n].type||"?"!==s[n].rightDelim);n--);if(n>=0)return this.contentWillChange(),s[n].rightDelim=t,s[n].body=s[n].body.concat(s.slice(n+1,this.endOffset()+1)),s.splice(n+1,this.endOffset()-n),this.setSelection(n),this.contentDidChange(),!0;if(i&&"leftright"===i.type&&"?"===i.rightDelim){this.contentWillChange(),i.rightDelim=t;const e=s.slice(this.endOffset()+1);return s.splice(this.endOffset()+1),this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.endOffset()+1,0].concat(e)),this.contentDidChange(),!0}const r=this.ancestor(2);return r&&"leftright"===r.type&&"?"===r.rightDelim&&this.endOffset()===s.length-1?(this.move(1),this._insertSmartFence(t,e)):(this.insert(t,{mode:"math",format:"latex",style:e}),!0)}return!1},_e.prototype.positionInsertionPointAfterCommitedCommand=function(){const t=this.siblings(),e=this.commandOffsets();let i=e.start;for(;i<e.end&&!t[i].suggestion;)i++;this.setSelection(i-1)},_e.prototype.removeSuggestion=function(){const t=this.siblings();for(let e=t.length-1;e>=0;e--)t[e].suggestion&&t.splice(e,1)},_e.prototype.insertSuggestion=function(t,e){this.removeSuggestion();const i=[],s=t.substr(e);for(const n of s){const t=new te.MathAtom("command","command",n);t.suggestion=!0,i.push(t)}Array.prototype.splice.apply(this.siblings(),[this.anchorOffset()+1,0].concat(i))},_e.prototype._deleteAtoms=function(t){t>0?this.siblings().splice(this.anchorOffset()+1,t):(this.siblings().splice(this.anchorOffset()+t+1,-t),this.setSelection(this.anchorOffset()+t))},_e.prototype.delete=function(t){if(0===(t=t||0))this.delete_(0);else if(t>0)for(;t>0;)this.delete_(1),t--;else for(;t<0;)this.delete_(-1),t++},_e.prototype.delete_=function(t){this.contentWillChange(),this.selectionWillChange();const e=this.suppressChangeNotifications;if(this.suppressChangeNotifications=!0,t=(t=t||0)<0?-1:t>0?1:t,this.removeSuggestion(),this.parent().array&&t<0&&0===this.startOffset()){const t=this.parent().array;if(function(t){const e={col:0,row:0};for(;e.row<t.length&&!ke(t,e);)e.row+=1;return ke(t,e)?"cell"+Se(t,e):""}(t)===this.relation()){const e=function(t,e,i){e||(e=[";",","]);let s,n=[];for(const r of t)s?n.push(s):s=new te.MathAtom("math","mpunct",e[0],void 0),n=n.concat(Te(r,e[1]));return n}(t);this.path.pop(),this.siblings().splice(this.anchorOffset(),1,...e),this.setSelection(this.anchorOffset()-1,e.length)}else{const e=Pe(t,this.relation());if(0===e.col){const i=Ae(t,e,-1);i.col=t[i.row].length-1,this.path[this.path.length-1].relation="cell"+Se(t,i);const s=t[i.row][i.col].length,n=Te(t[e.row]);t[i.row][i.col]=t[i.row][i.col].concat(n),this.setSelection(s-1,n.length),function(t,e){t.splice(e,1)}(t,e.row)}else 0===function(t,e){let i=0;const s={col:e,row:0};for(;s.row<t.length;){const e=ke(t,s);if(e&&e.length>0){let t=e.length;"first"===e[0].type&&(t-=1),t>0&&(i+=1)}s.row+=1}return i}(t,e.col)&&(function(t,e){let i=0;for(;i<t.length;)t[i][e]&&t[i].splice(e,1),i+=1}(t,e.col),e.col-=1,this.path[this.path.length-1].relation="cell"+Se(t,e),this.setSelection(t[e.row][e.col].length-1,0))}return this.suppressChangeNotifications=e,this.selectionDidChange(),void this.contentDidChange()}const i=this.siblings();if(this.isCollapsed()){const e=this.anchorOffset();if(t<0)if(0!==e){const t=this.sibling(0);"leftright"===t.type?(t.rightDelim="?",this.move(-1)):!t.captureSelection&&/^(group|array|genfrac|surd|leftright|overlap|overunder|box|mathstyle|sizing)$/.test(t.type)?this.move(-1):(this._announce("delete",null,i.slice(e,e+1)),i.splice(e,1),this.setSelection(e-1))}else{const t=this.relation();if("superscript"===t||"subscript"===t){const e=this.parent()[t].filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.parent()[t]=null,this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(e)),this.setSelection(this.anchorOffset()-1),this._announce("deleted: "+t)}else if("denom"===t){const t=this.parent().numer.filter(t=>"placeholder"!==t.type&&"first"!==t.type),e=this.parent().denom.filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(e)),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(t)),this.setSelection(this.anchorOffset()+t.length-1),this._announce("deleted: denominator")}else if("body"===t){const t=this.siblings().filter(t=>"placeholder"!==t.type);this.path.length>1&&(t.shift(),this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(t)),this.setSelection(this.anchorOffset()-1),this._announce("deleted: root"))}else this.move(-1),this.delete(-1)}else if(t>0)if(e!==i.length-1)/^(group|array|genfrac|surd|leftright|overlap|overunder|box|mathstyle|sizing)$/.test(this.sibling(1).type)?this.move(1):(this._announce("delete",null,i.slice(e+1,e+2)),i.splice(e+1,1));else if("numer"===this.relation()){const t=this.parent().numer.filter(t=>"placeholder"!==t.type&&"first"!==t.type),e=this.parent().denom.filter(t=>"placeholder"!==t.type&&"first"!==t.type);this.path.pop(),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),1].concat(e)),Array.prototype.splice.apply(this.siblings(),[this.anchorOffset(),0].concat(t)),this.setSelection(this.anchorOffset()+t.length-1),this._announce("deleted: numerator")}else this.move(1),this.delete(1)}else{const t=this.startOffset()+1,e=this.endOffset()+1;this._announce("deleted",null,i.slice(t,e)),i.splice(t,e-t),this.setSelection(t-1)}this.suppressChangeNotifications=e,this.selectionDidChange(),this.contentDidChange()},_e.prototype.moveToNextPlaceholder_=function(){this.leap(1)},_e.prototype.moveToPreviousPlaceholder_=function(){this.leap(-1)},_e.prototype.moveToNextChar_=function(){this.move(1)},_e.prototype.moveToPreviousChar_=function(){this.move(-1)},_e.prototype.moveUp_=function(){this.up()},_e.prototype.moveDown_=function(){this.down()},_e.prototype.moveToNextWord_=function(){this.skip(1)},_e.prototype.moveToPreviousWord_=function(){this.skip(-1)},_e.prototype.moveToGroupStart_=function(){this.setSelection(0)},_e.prototype.moveToGroupEnd_=function(){this.setSelection(-1)},_e.prototype.moveToMathFieldStart_=function(){this.jumpToMathFieldBoundary(-1)},_e.prototype.moveToMathFieldEnd_=function(){this.jumpToMathFieldBoundary(1)},_e.prototype.deleteNextChar_=function(){this.delete_(1)},_e.prototype.deletePreviousChar_=function(){this.delete_(-1)},_e.prototype.deleteNextWord_=function(){this.extendToNextBoundary(),this.delete_()},_e.prototype.deletePreviousWord_=function(){this.extendToPreviousBoundary(),this.delete_()},_e.prototype.deleteToGroupStart_=function(){this.extendToGroupStart(),this.delete_()},_e.prototype.deleteToGroupEnd_=function(){this.extendToMathFieldStart(),this.delete_()},_e.prototype.deleteToMathFieldEnd_=function(){this.extendToMathFieldEnd(),this.delete_()},_e.prototype.transpose_=function(){},_e.prototype.extendToNextChar_=function(){this.extend(1)},_e.prototype.extendToPreviousChar_=function(){this.extend(-1)},_e.prototype.extendToNextWord_=function(){this.skip(1,{extend:!0})},_e.prototype.extendToPreviousWord_=function(){this.skip(-1,{extend:!0})},_e.prototype.extendUp_=function(){this.up({extend:!0})},_e.prototype.extendDown_=function(){this.down({extend:!0})},_e.prototype.extendToNextBoundary_=function(){this.skip(1,{extend:!0})},_e.prototype.extendToPreviousBoundary_=function(){this.skip(-1,{extend:!0})},_e.prototype.extendToGroupStart_=function(){this.setExtent(-this.anchorOffset())},_e.prototype.extendToGroupEnd_=function(){this.setExtent(this.siblings().length-this.anchorOffset())},_e.prototype.extendToMathFieldStart_=function(){this.jumpToMathFieldBoundary(-1,{extend:!0})},_e.prototype.extendToMathFieldEnd_=function(){this.jumpToMathFieldBoundary(1,{extend:!0})},_e.prototype.moveToSuperscript_=function(){if(this.collapseForward(),!this.anchor().superscript)if(this.anchor().subscript)this.anchor().superscript=[Ie()];else{const t=this.sibling(1);t&&t.superscript?this.path[this.path.length-1].offset+=1:t&&t.subscript?(this.path[this.path.length-1].offset+=1,this.anchor().superscript=[Ie()]):("limits"!==this.anchor().limits&&(this.siblings().splice(this.anchorOffset()+1,0,new te.MathAtom(this.parent().anchorMode,"msubsup","â",this.anchorStyle())),this.path[this.path.length-1].offset+=1),this.anchor().superscript=[Ie()])}this.path.push({relation:"superscript",offset:0}),this.selectGroup_()},_e.prototype.moveToSubscript_=function(){if(this.collapseForward(),!this.anchor().subscript)if(this.anchor().superscript)this.anchor().subscript=[Ie()];else{const t=this.sibling(1);t&&t.subscript?this.path[this.path.length-1].offset+=1:t&&t.superscript?(this.path[this.path.length-1].offset+=1,this.anchor().subscript=[Ie()]):("limits"!==this.anchor().limits&&(this.siblings().splice(this.anchorOffset()+1,0,new te.MathAtom(this.parent().anchorMode,"msubsup","â",this.anchorStyle())),this.path[this.path.length-1].offset+=1),this.anchor().subscript=[Ie()])}this.path.push({relation:"subscript",offset:0}),this.selectGroup_()},_e.prototype.moveToOpposite_=function(){const t={superscript:"subscript",subscript:"superscript",denom:"numer",numer:"denom"}[this.relation()];t||this.moveToSuperscript_(),this.parent()[t]||(this.parent()[t]=[Ie()]),this.setSelection(0,"end",t)},_e.prototype.moveBeforeParent_=function(){this.path.length>1?(this.path.pop(),this.setSelection(this.anchorOffset()-1)):this._announce("plonk")},_e.prototype.moveAfterParent_=function(){if(this.path.length>1){const t=we(this);this.path.pop(),this.setExtent(0),this._announce("move",t)}else this._announce("plonk")},_e.prototype._addCell=function(t){const e=this.parent();if(e&&"array"===e.type&&Array.isArray(e.array)){const i=this.relation();if(e.array){const s=Pe(e.array,i);"after row"===t||"before row"===t?(s.col=0,s.row=s.row+("after row"===t?1:0),e.array.splice(s.row,0,[[]])):(s.col+="after column"===t?1:0,e.array[s.row].splice(s.col,0,[]));const n=Se(e.array,s);this.path.pop(),this.path.push({relation:"cell"+n.toString(),offset:0}),this.insertFirstAtom()}}},_e.prototype.convertParentToArray=function(){const t=this.parent();if("leftright"===t.type){t.type="array";const e={"(":"pmatrix","\\lbrack":"bmatrix","\\lbrace":"cases"}[t.leftDelim]||"matrix",i=St.getEnvironmentInfo(e),s=[[t.body]];i.parser&&Object.assign(t,i.parser(e,[],s)),t.tabularMode=i.tabular,t.parseMode=this.anchorMode(),t.env={...i},t.env.name=e,t.array=s,t.rowGaps=[0],delete t.body,this.path[this.path.length-1].relation="cell0"}},_e.prototype.addRowAfter_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("after row"),this.contentDidChange()},_e.prototype.addRowBefore_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("before row"),this.contentDidChange()},_e.prototype.addColumnAfter_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("after column"),this.contentDidChange()},_e.prototype.addColumnBefore_=function(){this.contentWillChange(),this.convertParentToArray(),this._addCell("before column"),this.contentDidChange()},_e.prototype._applyStyle=function(t){if(this.isCollapsed())return;const e=this;function i(t,i){let s=!0;return e.forEachSelected(e=>{s=s&&e[t]===i},{recursive:!0}),s}t.color&&i("color",t.color)&&(t.color="none"),t.backgroundColor&&i("backgroundColor",t.backgroundColor)&&(t.backgroundColor="none"),t.fontFamily&&i("fontFamily",t.fontFamily)&&(t.fontFamily="none"),t.series&&(t.fontSeries=t.series),t.fontSeries&&i("fontSeries",t.fontSeries)&&(t.fontSeries="auto"),t.shape&&(t.fontShape=t.shape),t.fontShape&&i("fontShape",t.fontShape)&&(t.fontShape="auto"),t.size&&(t.fontSize=t.size),t.fontSize&&i("fontSize",t.fontSize)&&(t.fontSize="size5"),this.contentWillChange(),this.forEachSelected(e=>e.applyStyle(t),{recursive:!0}),this.contentDidChange()};var Be={EditableMathlist:_e,parseMathString:Le};const Fe={"#":"#","|":"|","[":"BracketLeft","]":"BracketRight","-":"Minus","+":"Plus","=":"Equal","/":"Slash","\\":"Backslash"},Ye={Space:"Spacebar"," ":"Spacebar",Escape:"Esc",ArrowLeft:"Left",ArrowUp:"Up",ArrowRight:"Right",ArrowDown:"Down",Delete:"Del"},ze={q:"KeyQ",w:"KeyW",e:"KeyE",r:"KeyR",t:"KeyT",y:"KeyY",u:"KeyU",i:"KeyI",o:"KeyO",p:"KeyP",a:"KeyA",s:"KeyS",d:"KeyD",f:"KeyF",g:"KeyG",h:"KeyH",j:"KeyJ",k:"KeyK",l:"KeyL",z:"KeyZ",x:"KeyX",c:"KeyC",v:"KeyV",b:"KeyB",n:"KeyN",m:"KeyM",1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",0:"Digit0","!":"Shift-Digit1","@":"Shift-Digit2","#":"Shift-Digit3",$:"Shift-Digit4","%":"Shift-Digit5","^":"Shift-Digit6","&":"Shift-Digit7","*":"Shift-Digit8","(":"Shift-Digit9",")":"Shift-Digit0","-":"Minus",_:"Shift-Minus","/":"Slash","\\":"Backslash","|":"Shift-Backslash","?":"Shift-Slash"," ":"Spacebar"};function qe(t){let e,i=!0;"Unidentified"===t.key&&t.target&&(e=ze[t.target.value]||t.target.value),e||(Fe[t.key]?(e=Fe[t.key],i=!1):e=Ye[t.key],e||(e=ze[t.key.toLowerCase()]||t.key)),!e&&t.code&&(e=Ye[t.code]||t.code);const s=[];return t.ctrlKey&&s.push("Ctrl"),t.metaKey&&s.push("Meta"),i&&t.altKey&&s.push("Alt"),i&&t.shiftKey&&s.push("Shift"),0===s.length?e:(s.push(e),s.join("-"))}function Xe(t,e){let i,s=null,n=null,r=!1,o=!1;function a(t){clearTimeout(i),i=setTimeout((function(){clearTimeout(i),t()}))}function l(){if(function(t){return t.selectionStart!==t.selectionEnd}(t))return;const i=t.value;t.value="",i.length>0&&e.typedText(i)}const c=t||e.container;c.addEventListener("keydown",(function(i){if("function"==typeof e.allowDeadKey&&e.allowDeadKey()||"Dead"!==i.key&&"Unidentified"!==i.key&&229!==i.keyCode)o=!1;else{o=!0,r=!1;const i=e.blur,s=e.focus;e.blur=null,e.focus=null,t.blur(),t.focus(),e.blur=i,e.focus=s}return!(!r&&"CapsLock"!==i.code&&!/(Control|Meta|Alt|Shift)(Right|Left)/.test(i.code))||(s=i,n=null,e.keystroke(qe(i),i))}),!0),c.addEventListener("keypress",(function(t){r||(s&&n&&e.keystroke(qe(s),s),n=t,a(l))}),!0),c.addEventListener("keyup",(function(){r||!s||n||l()}),!0),c.addEventListener("paste",(function(){t.focus();const i=t.value;t.value="",i.length>0&&e.paste(i)}),!0),c.addEventListener("copy",(function(t){e.copy&&e.copy(t)}),!0),c.addEventListener("cut",(function(t){e.cut&&e.cut(t)}),!0),c.addEventListener("blur",(function(){s=null,n=null,e.blur&&e.blur()}),!0),c.addEventListener("focus",(function(){e.focus&&e.focus()}),!0),c.addEventListener("compositionstart",()=>{r=!0},!0),c.addEventListener("compositionend",()=>{r=!1,a(l)},!0),c.addEventListener("input",()=>{if(o){const i=e.blur,s=e.focus;e.blur=null,e.focus=null,t.blur(),t.focus(),e.blur=i,e.focus=s,o=!1,r=!1,a(l)}else r||a(l)})}var Ue={delegateKeyboardEvents:Xe,select:Xe.select,keyboardEventToString:qe,eventToChar:function(t){if(!t)return"";let e;return"Unidentified"===t.key&&t.target&&(e=t.target.value),e=e||t.key||t.code,/^(Return|Enter|Tab|Escape|Delete|PageUp|PageDown|Home|End|Help|ArrowLeft|ArrowRight|ArrowUp|ArrowDown)$/.test(e)&&(e=""),e},charToEvent:function(t){return{key:t,metaKey:!1,ctrlKey:!1,altKey:!1,shiftKey:!1}}};const Ge={"\\mathrm":"\\mathrm{x=+3.14, x\\in A}","\\mathbf":"\\mathbf{x=+3.14, x\\in A}","\\bf":"\\bf{x=+3.14, x\\in A}","\\bm":"\\bm{x=+3.14, x\\in A}","\\bold":"\\bold{x=+3.14, x\\in A}","\\mathit":"\\mathbb{x=+3.14}","\\mathbb":"\\mathbb{ABCD}","\\Bbb":"\\mathbb{ABCD}","\\frak":"\\frak{ABCD}","\\mathfrak":"\\mathfrak{ABCD}","\\mathscr":"\\mathscr{ABCD}","\\mathsf":"\\mathsf{ABab01}","\\mathtt":"\\mathtt{x=+3.14, x\\in A}","\\mathcal":"\\mathcal{ABCD}","\\boldsymbol":"\\boldsymbol{ABab01+=}","\\text":"\\text{ABC abc}","\\textrm":"\\textrm{ABC abc}","\\textnormal":"\\textnormal{ABC abc}","\\textit":"\\textit{ABC abc}","\\textbf":"\\textbf{ABC abc}","\\texttt":"\\texttt{ABC abc}","\\textsf":"\\textsf{ABC abc}","\\textcolor":"{\\textcolor{m0}A}{\\textcolor{m1}B}{\\textcolor{m2}C }{\\textcolor{m3}a}{\\textcolor{m4}b}{\\textcolor{m5}c}{\\textcolor{m6}8}","\\color":"{\\color{m0}A}{\\color{m1}B}{\\color{m2}C}{\\color{m3}a}{\\color{m4}b}{\\color{m5}c}{\\color{m6}8}","\\underline":'\\underline{\\unicode{"2B1A}}',"\\overline":'\\overline{\\unicode{"2B1A}}',"\\vec":'\\vec{\\unicode{"25CC}}',"\\check":'\\check{\\unicode{"25CC}}',"\\acute":'\\acute{\\unicode{"25CC}}',"\\breve":'\\breve{\\unicode{"25CC}}',"\\tilde":'\\tilde{\\unicode{"25CC}}',"\\hat":'\\hat{\\unicode{"25CC}}',"\\ddot":'\\ddot{\\unicode{"25CC}}',"\\dot":'\\dot{\\unicode{"25CC}}',"\\bar":'\\bar{\\unicode{"25CC}}',"\\!":'\\unicode{"203A}\\!\\unicode{"2039}',"\\,":'\\unicode{"203A}\\,\\unicode{"2039}',"\\:":'\\unicode{"203A}\\:\\unicode{"2039}',"\\;":'\\unicode{"203A}\\;\\unicode{"2039}',"\\quad":'\\unicode{"203A}\\quad\\unicode{"2039}',"\\qquad":'\\unicode{"203A}\\qquad\\unicode{"2039}',"\\enskip":'\\unicode{"203A}\\enskip\\unicode{"2039}',"\\space":'\\unicode{"203A}\\space\\unicode{"2039}',"\\frac":'\\frac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\dfrac":'\\dfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\cfrac":'\\cfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\tfrac":'\\tfrac{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\dbinom":'\\dbinom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\tbinom":'\\tbinom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\binom":'\\binom{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\pdiff":'\\pdiff{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\in":"n\\in\\N","\\notin":"n\\notin\\N","\\not":"B \\not A","\\ni":"N\\in n","\\owns":"N\\owns n","\\subset":"A\\subset B","\\supset":"B\\supset A","\\subseteq":"A\\subseteq B","\\supseteq":"B\\supseteq A","\\nsubseteq":"A\\nsubseteq B","\\nsupseteq":"B\\nsupseteq A","\\subsetneq":"A\\subsetneq B","\\supsetneq":"B\\supsetneq A","\\varsubsetneq":"A\\varsubsetneq B","\\varsupsetneq":"B\\varsupsetneq A","\\nsubseteqq":"A\\varsupsetneq B","\\subsetneqq":"A\\subsetneqq B","\\varsubsetneqq":"A\\varsubsetneqq B","\\nsubset":"A\\nsubset B","\\nsupset":"B\\nsupset A","\\complement":"A^\\complement","\\bigcup":'\\bigcup_{\\unicode{"2B1A}}',"\\bigcap":'\\bigcap_{\\unicode{"2B1A}}',"\\sqrt":'\\sqrt{\\unicode{"2B1A}}',"\\prod":'\\prod_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\sum":'\\sum_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\int":'\\int_{\\unicode{"2B1A}}^{\\unicode{"2B1A}}',"\\stackrel":'\\stackrel{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\stackbin":'\\stackbin{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\underset":'\\underset{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\overset":'\\overset{\\unicode{"2B1A}}{\\unicode{"2B1A}}',"\\prime":'\\unicode{"2B1A}^{\\prime}',"\\boxed":'\\boxed{\\unicode{"2B1A}}',"\\colorbox":'\\colorbox{#fbc0bd}{\\unicode{"2B1A}}',"\\bbox":'\\bbox[#ffd400, solid 2px #ffd400]{\\unicode{"2B1A}}',"\\enclose":'\\enclose{updiagonalstrike,roundedbox}[1px solid red, mathbackground="#fbc0bd"]{23+45}',"\\fcolorbox":'\\fcolorbox{#cd0030}{#ffd400}{\\unicode{"2B1A}}',"\\ ":'\\char"2423',"\\top":"{\\color{red}P}\\top","\\bot":"{\\color{#0F0}P}\\bot","\\mid":"P(p\\mid q)","\\rlap":"\\rlap{x}o","\\llap":"o\\llap{/}"},He={"\\text":"roman text","\\textrm":"roman text","\\textnormal":"roman text","\\textit":"italic text","\\textbf":"bold text","\\texttt":"monospaced text","\\textsf":"sans-serif text","\\mathrm":["roman","(upright)"],"\\mathbf":"bold","\\bf":"bold","\\bold":"bold","\\mathit":"italic","\\mathbb":"blackboard","\\Bbb":"blackboard","\\mathscr":"script","\\mathtt":["typewriter","(monospaced)"],"\\mathsf":"sans-serif","\\mathcal":"caligraphic","\\frak":["fraktur","(gothic)"],"\\mathfrak":["fraktur","(gothic)"],"\\textcolor":"text color","\\color":"color","\\forall":"for all","\\exists":"there exists","\\nexists":"there does not exist","\\frac":"fraction","\\dfrac":"display fraction","\\cfrac":"continuous fraction","\\tfrac":"text fraction","\\binom":"binomial coefficient","\\dbinom":"display binomial coefficient","\\tbinom":"text binomial coefficient","\\pdiff":"partial differential","\\vec":"vector","\\check":"caron","\\acute":"acute","\\breve":"breve","\\tilde":"tilde","\\dot":"dot","\\hat":["hat","circumflex"],"\\ddot":"double dot","\\bar":"bar","\\prime":"prime","\\doubleprime":"double prime","\\varnothing":"empty set","\\emptyset":"empty set","\\subseteq":"subset of or <br>equal to","\\supseteq":"superset of or <br>equal to","\\supset":"superset of","\\subset":"subset of","\\partial":"partial derivative","\\bigcup":"union","\\bigcap":"intersection","\\approx":"approximately equal to","\\notin":"not an element of","\\in":["element of","included in"],"\\infty":"infinity","\\land":"logical and","\\sqrt":"square root","\\prod":"product","\\sum":"summation","\\amalg":["amalgamation","coproduct","free product","disjoint union"],"\\cup":"union with","\\cap":"intersection with","\\int":"integral","\\iint":"surface integral","\\oint":"curve integral","\\iiint":"volume integral","\\iff":"if and only if","\\ln":"natural logarithm","\\boldsymbol":"bold","\\setminus":"set subtraction","\\stackrel":"relation with symbol above","\\stackbin":"operator with symbol above","\\underset":"symbol with annotation below","\\overset":"symbol with annotation above","\\hslash":["h-bar","Planck constant"],"\\gtrsim":"greater than or <br>similar to","\\propto":"proportional to","\\equiv":"equivalent to","\\!":["negative thin space","(-3 mu)"],"\\ ":["space","(6 mu)"],"\\,":["thin space","(3 mu)"],"\\:":["medium space","(4 mu)"],"\\;":["thick space","(5 mu)"],"\\quad":["1 em space","(18 mu)"],"\\qquad":["2 em space","(36 mu)"],"\\enskip":["&#189; em space","(9 mu)"],"\\mp":"minus or plus","\\pm":"plus or minus","\\Im":"Imaginary part of","\\Re":"Real part of","\\gothicCapitalR":"Real part of","\\gothicCapitalI":"Imaginary part part of","\\differentialD":"differential d","\\aleph":["aleph","infinite cardinal",'<a target="_blank" href="https://en.wikipedia.org/wiki/Cardinal_number">Wikipedia <big>&#x203A;</big></a>'],"\\beth":["beth","beth number",'<a target="_blank" href="https://en.wikipedia.org/wiki/Beth_number">Wikipedia <big>&#x203A;</big></a>'],"\\gimel":["gimel","gimel function",'<a target="_blank" href="https://en.wikipedia.org/wiki/Gimel_function">Wikipedia <big>&#x203A;</big></a>'],"\\O":"empty set","\\N":"set of <br>natural numbers","\\Z":"set of <br>integers","\\Q":"set of <br>rational numbers","\\C":"set of <br>complex numbers","\\R":"set of <br>real numbers","\\P":"set of <br>prime numbers","\\lesseqqgtr":"less than, equal to or<br> greater than","\\gnapprox":"greater than and <br>not approximately","\\lnapprox":"lesser than and <br>not approximately","\\j":"dotless j","\\i":"dotless i","\\cdot":"centered dot","\\lmoustache":"left moustache","\\rmoustache":"right moustache","\\nabla":["nabla","del","differential vector operator"],"\\square":["square","dâAlembert operator",'<a target="_blank" href="https://en.wikipedia.org/wiki/D%27Alembert_operator">Wikipedia <big>&#x203A;</big></a>'],"\\blacksquare":["black square","end of proof","tombstone","Halmos symbol"],"\\Box":"end of proof","\\colon":["such that","ratio"],"\\coloneq":["is defined by","is assigned"],"\\Colon":["is defined by","as"],"\\_":["underbar","underscore"],"\\ll":"much less than","\\gg":"much greater than","\\doteq":"approximately equal to","\\Doteq":"approximately equal to","\\doteqdot":"approximately equal to","\\cong":["isomorphism of","(for algebras, modules...)"],"\\det":["determinant of","(of a matrix)"],"\\dotplus":"Cartesian product algebra","\\otimes":["tensor product","(of algebras)","Kronecker product","(of matrices)"],"\\oplus":["direct sum","(of modules)"],"\\lb":"base-2 logarithm","\\lg":"base-10 logarithm","\\wp":["Weierstrass P",'<a target="_blank" href="https://en.wikipedia.org/wiki/Weierstrass%27s_elliptic_functions">Wikipedia <big>&#x203A;</big></a>'],"\\wr":["wreath product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Wreath_product">Wikipedia <big>&#x203A;</big></a>'],"\\top":["tautology","Proposition P is universally true"],"\\bot":["contradiction","Proposition P is contradictory"],"\\mid":["probability","of event A given B"],"\\mho":["Siemens","electrical conductance in SI unit",'<a target="_blank" href="https://en.wikipedia.org/wiki/Siemens_(unit)">Wikipedia <big>&#x203A;</big></a>'],"\\Longrightarrow":"implies","\\Longleftrightarrow":"if, and only if,","\\prec":"precedes","\\preceq":"precedes or is equal to","\\succ":"succeedes","\\succeq":"succeedes or is equal to","\\perp":["is perpendicular to","is independent of"],"\\models":["entails","double-turnstyle, models","is a semantic consequence of",'<a target="_blank" href="https://en.wikipedia.org/wiki/Double_turnstile">Wikipedia <big>&#x203A;</big></a>'],"\\vdash":["satisfies","turnstyle, assertion sign","syntactic inference",'<a target="_blank" href="https://en.wikipedia.org/wiki/Turnstile_(symbol)">Wikipedia <big>&#x203A;</big></a>'],"\\implies":["implies","logical consequence"],"\\impliedby":["implied by","logical consequence"],"\\surd":["surd","root of","checkmark"],"\\ltimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\rtimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\leftthreetimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\rightthreetimes":["semi direct product",'<a target="_blank" href="https://en.wikipedia.org/wiki/Semidirect_product">Wikipedia <big>&#x203A;</big></a>'],"\\divideontimes":["divide on times"],"\\curlywedge":"nor","\\curlyvee":"nand","\\simeq":"is group isomorphic with","\\vartriangleleft":["is a normal subgroup of","is an ideal ring of"],"\\circ":["circle","ring","function composition"],"\\rlap":["overlap right","\\rlap{x}o"],"\\llap":["overlap left","o\\llap{/}"],"\\colorbox":["color box","\\colorbox{#fbc0bd}{...}"],"\\ast":["asterisk","reflexive closure (as a superscript)"],"\\bullet":"bullet","\\lim":"limit"};function Je(t){let e=He[t]||"";return Array.isArray(e)&&(e=e.join("<br>")),e}function $e(t,e){t.popover.innerHTML=e;const i=t._getCaretPosition();i&&Ve(t,i),t.popover.classList.add("is-visible")}function Ve(t,e){const i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerWidth-document.documentElement.clientWidth,r=window.innerHeight-document.documentElement.clientHeight,o=t.virtualKeyboardVisible?t.virtualKeyboard.offsetHeight:0;t.popover.style.left=e.x+t.popover.offsetWidth/2>s-n?s-t.popover.offsetWidth-n+"px":e.x-t.popover.offsetWidth/2<0?0:e.x-t.popover.offsetWidth/2+"px",e.y+t.popover.offsetHeight+5>i-r-o?(t.popover.classList.add("reverse-direction"),t.popover.style.top=e.y-e.height-t.popover.offsetHeight-5+"px"):(t.popover.classList.remove("reverse-direction"),t.popover.style.top=e.y+5+"px")}function We(t){t.popover.classList.remove("is-visible")}var Ke={getNote:Je,SAMPLES:Ge,NOTES:He,showPopoverWithLatex:function(t,e,i){if(!e||0===e.length)return void We(t);const s=e,n=function(t,e){const i=he.parseTokens(o(t),"math",null,e.config.macros),s=te.decompose({mathstyle:"displaystyle",macros:e.config.macros},i),n=q.makeSpan(s,"ML__base"),r=q.makeSpan("","ML__strut");r.setStyle("height",n.height,"em");const a=q.makeSpan("","ML__strut--bottom");return a.setStyle("height",n.height+n.depth,"em"),a.setStyle("vertical-align",-n.depth,"em"),q.makeSpan([r,a,n],"ML__mathlive").toMarkup()}(Ge[s]||e,t),r=Je(s),a=Ce.forCommand(s);let l=i?'<div class="ML__popover__prev-shortcut" role="button" aria-label="Previous suggestion"><span><span>&#x25B2;</span></span></div>':"";l+='<span class="ML__popover__content" role="button">',l+='<div class="ML__popover__command">'+n+"</div>",r&&(l+='<div class="ML__popover__note">'+r+"</div>"),a&&(l+='<div class="ML__popover__shortcut">'+a+"</div>"),l+="</span>",l+=i?'<div class="ML__popover__next-shortcut" role="button" aria-label="Next suggestion"><span><span>&#x25BC;</span></span></div>':"",$e(t,l);let c=t.popover.getElementsByClassName("ML__popover__content");c&&c.length>0&&t._attachButtonHandlers(c[0],["complete",{acceptSuggestion:!0}]),c=t.popover.getElementsByClassName("ML__popover__prev-shortcut"),c&&c.length>0&&t._attachButtonHandlers(c[0],"previousSuggestion"),c=t.popover.getElementsByClassName("ML__popover__next-shortcut"),c&&c.length>0&&t._attachButtonHandlers(c[0],"nextSuggestion")},showPopover:$e,hidePopover:We,updatePopoverPosition:function t(e,i){if(e.element&&e.element.mathfield===e&&e.popover.classList.contains("is-visible"))if(i&&i.deferred)window.requestAnimationFrame(()=>t(e));else if(e.mathlist.anchor()&&"command"===e.mathlist.anchor().type){const t=e._getCaretPosition();t&&Ve(e,t)}else We(e)}};function Qe(t,e,i){let s="";if(Array.isArray(e)&&e.length>0){if("first"===e[0].type&&0===(e=e.slice(1)).length)return"";s=function t(e,i,s,n){if(0===s.length)return"";if(0===i.length)return s.map(t=>t.toLatex(n)).join("");let r="",o="",a="";const l=i[0];let c=s[0][l];"fontFamily"===l&&(c=s[0].fontFamily||s[0].baseFontFamily);const h=function(t,e,i){let s=0;if("fontFamily"===e)for(;t[s]&&("mop"===t[s].type||(t[s].fontFamily||t[s].baseFontFamily)===i);)s++;else for(;t[s]&&("mop"===t[s].type||t[s][e]===i);)s++;return s}(s,l,c);if("text"===s[0].mode){if("fontShape"===l&&s[0].fontShape)"it"===s[0].fontShape?(o="\\textit{",a="}"):"sl"===s[0].fontShape?(o="\\textsl{",a="}"):"sc"===s[0].fontShape?(o="\\textsc{",a="}"):"n"===s[0].fontShape?(o="\\textup{",a="}"):(o="\\text{\\fontshape{"+s[0].fontShape+"}",a="}");else if("fontSeries"===l&&s[0].fontSeries)"b"===s[0].fontSeries?(o="\\textbf{",a="}"):"l"===s[0].fontSeries?(o="\\textlf{",a="}"):"m"===s[0].fontSeries?(o="\\textmd{",a="}"):(o="\\text{\\fontseries{"+s[0].fontSeries+"}",a="}");else if("mode"===l){let t=!0;for(let e=0;e<h;e++)if(!(s[e].fontSeries||s[e].fontShape||s[e].fontFamily||s[e].baseFontFamily)){t=!1;break}t||(o="\\text{",a="}")}else if("fontSize"===l&&s[0].fontSize)o="{\\"+({size1:"tiny",size2:"scriptsize",size3:"footnotesize",size4:"small",size5:"normalsize",size6:"large",size7:"Large",size8:"LARGE",size9:"huge",size10:"Huge"}[s[0].fontSize]||"")+" ",a="}";else if("fontFamily"===l&&(s[0].fontFamily||s[0].baseFontFamily)){const t={cmr:"textrm",cmtt:"texttt",cmss:"textsf"}[s[0].fontFamily||s[0].baseFontFamily]||"";t?(o="\\"+t+"{",a="}"):(o+="{\\fontfamily{"+(s[0].fontFamily||s[0].baseFontFamily)+"}",a="}")}}else if("math"===s[0].mode)if("fontSeries"===l)"b"===s[0].fontSeries?(o="\\mathbf{",a="}"):s[0].fontSeries&&"n"!==s[0].fontSeries&&(o="{\\fontSeries{"+s[0].fontSeries+"}",a="}");else if("fontShape"===l)"it"===s[0].fontShape?(o="\\mathit{",a="}"):"n"===s[0].fontShape?(o="{\\upshape ",a="}"):s[0].fontShape&&"n"!==s[0].fontShape&&(o="{\\fontShape{"+s[0].fontShape+"}",a="}");else if("fontSize"===l&&s[0].fontSize)o="{\\"+({size1:"tiny",size2:"scriptsize",size3:"footnotesize",size4:"small",size5:"normalsize",size6:"large",size7:"Large",size8:"LARGE",size9:"huge",size10:"Huge"}[s[0].fontSize]||"")+" ",a="}";else if("fontFamily"===l&&s[0].fontFamily){if(!/^(math|main)$/.test(s[0].fontFamily)){const r={cal:"mathcal",frak:"mathfrak",bb:"mathbb",scr:"mathscr",cmr:"mathrm",cmtt:"mathtt",cmss:"mathsf"}[s[0].fontFamily]||"";if(r){if(/^\\operatorname{/.test(s[0].latex))return s[0].latex+t(e,i,s.slice(h),n);s[0].isFunction||(o="\\"+r+"{",a="}"),i=[]}else o+="{\\fontfamily{"+s[0].fontFamily+"}",a="}"}}else if("fontFamily"===l&&s[0].baseFontFamily)if(s[0].latex&&s[0].latex.startsWith("\\"))o="",a="";else{const t={cal:"mathcal",frak:"mathfrak",bb:"mathbb",scr:"mathscr",cmr:"mathrm",cmtt:"mathtt",cmss:"mathsf"}[s[0].baseFontFamily]||"";t&&(o="\\"+t+"{",a="}")}return"color"!==l||!s[0].color||"none"===s[0].color||e&&e.color===s[0].color||(o="\\textcolor{"+ne(s[0].color)+"}{",a="}"),"backgroundColor"!==l||!s[0].backgroundColor||"none"===s[0].backgroundColor||e&&e.backgroundColor===s[0].backgroundColor||(o="\\colorbox{"+ne(s[0].backgroundColor)+"}{",a="}"),r+=o,r+=t(e,i.slice(1),s.slice(0,h),n),r+=a,r+=t(e,i,s.slice(h),n),r}(t,["mode","color","backgroundColor","fontSize","fontFamily","fontShape","fontSeries"],e,i)}else"number"==typeof e||"boolean"==typeof e?s=e.toString():"string"==typeof e?s=e.replace(/\s/g,"~"):e&&"function"==typeof e.toLatex&&(s=e.toLatex(i));return s}function Ze(t){const e=Ze.locale.substring(0,2);let i="";return Ze.strings[Ze.locale]&&(i=Ze.strings[Ze.locale][t]),!i&&Ze.strings[e]&&(i=Ze.strings[e][t]),i||(i=Ze.strings.en[t]),i||(i=t),i}te.MathAtom.prototype.toLatex=function(t){t=void 0!==t&&t;let e,i="",s=0,n=0;const r=this.latex?this.latex.match(/^(\\[^{\s0-9]+)/):null,o=r?r[1]:null;switch(this.type){case"group":i+=this.latexOpen||(this.cssId||this.cssClass?"":"{"),this.cssId&&(i+="\\cssId{"+this.cssId+"}{"),"ML__emph"===this.cssClass?i+="\\emph{"+Qe(this,this.body,t)+"}":(this.cssClass&&(i+="\\class{"+this.cssClass+"}{"),i+=t?Qe(this,this.body,!0):this.latex||Qe(this,this.body,!1),this.cssClass&&(i+="}")),this.cssId&&(i+="}"),i+=this.latexClose||(this.cssId||this.cssClass?"":"}");break;case"array":if(i+="\\begin{"+this.env.name+"}","array"===this.env.name){if(i+="{",this.colFormat)for(n=0;n<this.colFormat.length;n++)this.colFormat[n].align?i+=this.colFormat[n].align:this.colFormat[n].rule&&(i+="|");i+="}"}for(s=0;s<this.array.length;s++){for(e=0;e<this.array[s].length;e++)e>0&&(i+=" & "),i+=Qe(this,this.array[s][e],t);s<this.array.length-1&&(i+=" \\\\ ")}i+="\\end{"+this.env.name+"}";break;case"root":i=Qe(this,this.body,t);break;case"genfrac":/^(choose|atop|over)$/.test(this.body)?(i+="{",i+=Qe(this,this.numer,t),i+="\\"+this.body+" ",i+=Qe(this,this.denom,t),i+="}"):(i+=o,i+=`{${Qe(this,this.numer,t)}}{${Qe(this,this.denom,t)}}`);break;case"surd":i+="\\sqrt",this.index&&(i+="[",i+=Qe(this,this.index,t),i+="]"),i+=`{${Qe(this,this.body,t)}}`;break;case"leftright":this.inner?(i+="\\left"+(this.leftDelim||"."),this.leftDelim&&this.leftDelim.length>1&&(i+=" "),i+=Qe(this,this.body,t),i+="\\right"+(this.rightDelim||"."),this.rightDelim&&this.rightDelim.length>1&&(i+=" ")):(i+="\\mleft"+(this.leftDelim||"."),this.leftDelim&&this.leftDelim.length>1&&(i+=" "),i+=Qe(this,this.body,t),i+="\\mright"+(this.rightDelim||"."),this.rightDelim&&this.rightDelim.length>1&&(i+=" "));break;case"delim":case"sizeddelim":i+=o+"{"+this.delim+"}";break;case"rule":i+=o,this.shift&&(i+=`[${Qe(this,this.shift,t)}em]`),i+=`{${Qe(this,this.width,t)}em}{${Qe(this,this.height,t)}em}`;break;case"line":case"overlap":case"accent":i+=`${o}{${Qe(this,this.body,t)}}`;break;case"overunder":i+=`${o}{${Qe(this,this.overscript||this.underscript,t)}}{${Qe(parent,this.body,t)}}`;break;case"mord":case"minner":case"mbin":case"mrel":case"mpunct":case"mopen":case"mclose":case"textord":case"":/^\\(mathbin|mathrel|mathopen|mathclose|mathpunct|mathord|mathinner)/.test(o)?i+=o+"{"+Qe(this,this.body,t)+"}":'\\char"'===o?i+=this.latex+" ":"\\unicode"===o?(i+='\\unicode{"',i+=("000000"+this.body.charCodeAt(0).toString(16)).toUpperCase().substr(-6),i+="}"):(this.latex||"string"==typeof this.body)&&(this.latex&&"\\"===this.latex[0]?(i+=this.latex,/[a-zA-Z0-9]$/.test(this.latex)&&(i+=" ")):i+=o||("â"!==this.body?this.latex||this.body:""));break;case"mop":"â"!==this.body&&("\\mathop"===o?i+=o+"{"+Qe(this,this.body,t)+"}":"\\operatorname"===o?i+=o+"{"+this.body+"}":this.latex&&"\\"===this.latex[0]?(i+=this.latex,/[a-zA-Z0-9]$/.test(this.latex)&&(i+=" ")):i+=o||("â"!==this.body?this.latex||this.body:"")),this.explicitLimits&&("limits"===this.limits&&(i+="\\limits "),"nolimits"===this.limits&&(i+="\\nolimits "));break;case"box":if("\\bbox"===o){if(i+=o,isFinite(this.padding)||void 0!==this.border||void 0!==this.backgroundcolor){const t=[];isFinite(this.padding)&&t.push(Math.floor(100*this.padding)/100+"em"),this.border&&t.push("border:"+this.border),this.backgroundcolor&&t.push(ne(this.backgroundcolor)),i+=`[${t.join(",")}]`}i+=`{${Qe(this,this.body,t)}}`}else"\\boxed"===o?i+=`\\boxed{${Qe(this,this.body,t)}}`:(i+=o,this.framecolor&&(i+=`{${ne(this.framecolor)}}`),this.backgroundcolor&&(i+=`{${ne(this.backgroundcolor)}}`),i+=`{${Qe(this,this.body,t)}}`);break;case"spacing":i+=o,"\\hspace"===o||"\\hspace*"===o?(i+="{",i+=this.width?this.width+"em":"0em",i+="}"):(i+=" ",this.width&&(i+=this.width+"em "));break;case"enclose":if(i+=o,"\\enclose"===o){i+="{";let t="";for(const s in this.notation)Object.prototype.hasOwnProperty.call(this.notation,s)&&this.notation[s]&&(i+=t+s,t=" ");i+="}";let e="";t="",this.backgroundcolor&&"transparent"!==this.backgroundcolor&&(e+=t+'mathbackground="'+ne(this.backgroundcolor)+'"',t=","),this.shadow&&"auto"!==this.shadow&&(e+=t+'shadow="'+this.shadow+'"',t=","),1!==this.strokeWidth||"solid"!==this.strokeStyle?(e+=t+this.borderStyle,t=","):this.strokeColor&&"currentColor"!==this.strokeColor&&(e+=t+'mathcolor="'+ne(this.strokeColor)+'"',t=","),e&&(i+=`[${e}]`)}i+=`{${Qe(this,this.body,t)}}`;break;case"mathstyle":i+="\\"+this.mathstyle+" ";break;case"space":i+=this.latex;break;case"placeholder":i+="\\placeholder{"+(this.value||"")+"}";break;case"first":case"command":case"msubsup":break;case"error":i+=this.latex}if(this.superscript){let e=Qe(this,this.superscript,t);1===e.length?("â²"===e?e="\\prime ":"â³"===e&&(e="\\doubleprime "),i+="^"+e):i+="^{"+e+"}"}if(this.subscript){const e=Qe(this,this.subscript,t);i+=1===e.length?"_"+e:"_{"+e+"}"}return i},Ze.plural=function(t,e,i){(i=i||{}).type=i.type||"cardinal";const s=Ze.locale.substring(0,2),n="ordinal"===i.type?Ze.ordinal:Ze.cardinal;let r,o="ordinal"===i.type?Ze._ordinalPluralCategories.indexOf(n.select(t)):Ze._cardinalPluralCategories.indexOf(n.select(t));return Ze.strings[Ze.locale]&&(r=Ze.strings[Ze.locale][e]),!r&&Ze.strings[s]&&(r=Ze.strings[s][e]),r||(r=Ze.strings.en[e],r||(r=e),o="ordinal"===i.type?Ze._ordinalPluralCategories.indexOf(Ze._ordinalEnglish.select(t)):Ze._cardinalPluralCategories.indexOf(Ze._cardinalEnglish.select(t))),r.split(";")[o]||r.split(";")[0]},Ze.merge=function(t,e){if(t&&e){const i=Ze._locale;Ze.locale=t,Ze.strings[t]={...Ze.strings[t],...e},Ze.locale=i}else t&&!e&&(e=t,Object.keys(e).forEach(t=>Ze.merge(t,e[t])))},Object.defineProperty(Ze,"locale",{set(t){Ze._locale=t,Ze._ordinal=null,Ze._cardinal=null},get:()=>(Ze._locale||(Ze._locale="undefined"==typeof navigator?"en":navigator.language.slice(0,5)),Ze._locale)}),Object.defineProperty(Ze,"ordinal",{get:()=>(Ze._ordinal||(Ze._ordinalEnglish=new Intl.PluralRules("en",{type:"ordinal"}),Ze._ordinalEnglishPluralCategories=Ze._ordinalEnglish.resolvedOptions().pluralCategories,Ze._ordinal=new Intl.PluralRules(Ze.locale,{type:"ordinal"}),Ze._ordinalPluralCategories=Ze._ordinal.resolvedOptions().pluralCategories),Ze._ordinal)}),Object.defineProperty(Ze,"cardinal",{get:()=>(Ze._cardinal||(Ze._cardinalEnglish=new Intl.PluralRules("en",{type:"cardinal"}),Ze._cardinalEnglishPluralCategories=Ze._cardinalEnglish.resolvedOptions().pluralCategories,Ze._cardinal=new Intl.PluralRules(Ze.locale,{type:"cardinal"}),Ze._cardinaPluralCategories=Ze._ordinal.resolvedOptions().pluralCategories),Ze._cardinal)}),Ze.strings={en:{"keyboard.tooltip.functions":"Functions","keyboard.tooltip.greek":"Greek Letters","keyboard.tooltip.command":"LaTeX Command Mode","keyboard.tooltip.numeric":"Numeric","keyboard.tooltip.roman":"Symbols and Roman Letters","tooltip.copy to clipboard":"Copy to Clipboard","tooltip.redo":"Redo","tooltip.toggle virtual keyboard":"Toggle Virtual Keyboard","tooltip.undo":"Undo"},ar:{"keyboard.tooltip.functions":"ÙÙØ§Ù","keyboard.tooltip.greek":"Ø­Ø±ÙÙ ÙÙÙØ§ÙÙØ©","keyboard.tooltip.command":"Ø­Ø§ÙØ© ØªÙÙÙ Ø§ÙØ£ÙØ§ÙØ± Ø§ÙÙØ§ØªÙ","keyboard.tooltip.numeric":"Ø§ÙØ±ÙÙÙØ©","keyboard.tooltip.roman":"Ø±ÙÙØ² Ø§ÙØ§Ø­Ø±Ù Ø§ÙØ±ÙÙØ§ÙÙØ©","tooltip.copy to clipboard":"ÙØ³Ø® Ø¥ÙÙ Ø§ÙØ­Ø§ÙØ¸Ø©","tooltip.redo":"Ø§ÙØ¥Ø¹Ø§Ø¯Ø©","tooltip.toggle virtual keyboard":"ØªØ¨Ø¯ÙÙ ÙÙØ­Ø© Ø§ÙÙÙØ§ØªÙØ­ Ø§ÙØ¥ÙØªØ±Ø§Ø¶ÙØ©","tooltip.undo":"Ø¥ÙØºØ§Ø¡"},de:{"keyboard.tooltip.functions":"Funktionen","keyboard.tooltip.greek":"Griechische Buchstaben","keyboard.tooltip.command":"LaTeX-Befehlsmodus","keyboard.tooltip.numeric":"Numerisch","keyboard.tooltip.roman":"Symbole und rÃ¶mische Buchstaben","tooltip.copy to clipboard":"In die Zwischenablage kopieren","tooltip.redo":"Wiederholen","tooltip.toggle virtual keyboard":"Virtuelle Tastatur umschalten","tooltip.undo":"Widerrufen"},el:{"keyboard.tooltip.functions":"ÏÏÎ½Î±ÏÏÎ®ÏÎµÎ¹Ï","keyboard.tooltip.greek":"ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ Î³ÏÎ¬Î¼Î¼Î±ÏÎ±","keyboard.tooltip.command":"ÎÎµÎ¹ÏÎ¿ÏÏÎ³Î¯Î± ÎµÎ½ÏÎ¿Î»ÏÎ½ LaTeX","keyboard.tooltip.numeric":"ÎÏÎ¹Î¸Î¼Î·ÏÎ¹ÎºÏÏ","keyboard.tooltip.roman":"Î£ÏÎ¼Î²Î¿Î»Î± ÎºÎ±Î¹ ÏÏÎ¼Î±ÏÎºÎ¬ Î³ÏÎ¬Î¼Î¼Î±ÏÎ±","tooltip.copy to clipboard":"ÎÎ½ÏÎ¹Î³ÏÎ±ÏÎ® ÏÏÎ¿ ÏÏÏÏÎµÎ¹ÏÎ¿","tooltip.redo":"ÎÎ±Î½Î±ÎºÎ¬Î½Ï","tooltip.toggle virtual keyboard":"ÎÎ½Î±Î»Î»Î±Î³Î® ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¿Ï ÏÎ»Î·ÎºÏÏÎ¿Î»Î¿Î³Î¯Î¿Ï","tooltip.undo":"ÎÎµÎºÎ¬Î½Ï"},es:{"keyboard.tooltip.functions":"Funciones","keyboard.tooltip.greek":"Letras griegas","keyboard.tooltip.command":"Modo Comando LaTeX","keyboard.tooltip.numeric":"NumÃ©rico","keyboard.tooltip.roman":"SÃ­mbolos y letras romanas","tooltip.copy to clipboard":"Copiar al portapapeles","tooltip.redo":"Rehacer","tooltip.toggle virtual keyboard":"Alternar teclado virtual","tooltip.undo":"Deshacer"},fa:{"keyboard.tooltip.functions":"ØªÙØ§Ø¨Ø¹","keyboard.tooltip.greek":"Ø­Ø±ÙÙ ÛÙÙØ§ÙÛ","keyboard.tooltip.command":"Ø­Ø§ÙØª Ø¯Ø³ØªÙØ± ÙØ§ØªÚ©","keyboard.tooltip.numeric":"Ø¹Ø¯Ø¯Û","keyboard.tooltip.roman":"Ø¹ÙØ§Ø¦Ù Ù Ø­Ø±ÙÙ ÙØ§ØªÛÙ","tooltip.copy to clipboard":"Ú©Ù¾Û Ø¨Ù Ú©ÙÛÙ¾Ø¨ÙØ±Ø¯","tooltip.redo":"Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù Ø¨Ø¹Ø¯","tooltip.toggle virtual keyboard":"ÙÙØ§ÛØ´/ÙÙÙØªÙ Ú©ÛØ¨ÙØ±Ø¯ ÙØ¬Ø§Ø²Û","tooltip.undo":"Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù ÙØ¨Ù"},fr:{"keyboard.tooltip.functions":"Fonctions","keyboard.tooltip.greek":"Lettres grecques","keyboard.tooltip.command":"Mode de commandes LaTeX","keyboard.tooltip.numeric":"NumÃ©rique","keyboard.tooltip.roman":"Lettres et symboles romains","tooltip.copy to clipboard":"Copier dans le presse-papiers","tooltip.redo":"RÃ©tablir","tooltip.toggle virtual keyboard":"Afficher/Masquer le clavier virtuel","tooltip.undo":"Annuler"},it:{"keyboard.tooltip.functions":"Funzioni","keyboard.tooltip.greek":"Lettere greche","keyboard.tooltip.command":"ModalitÃ  di comando LaTeX","keyboard.tooltip.numeric":"Numerico","keyboard.tooltip.roman":"Simboli e lettere romane","tooltip.copy to clipboard":"Copia negli appunti","tooltip.redo":"Rifare","tooltip.toggle virtual keyboard":"Attiva / disattiva la tastiera virtuale","tooltip.undo":"Disfare"},ja:{"keyboard.tooltip.functions":"é¢æ°","keyboard.tooltip.greek":"ã®ãªã·ã£æå­","keyboard.tooltip.command":"LaTeXã³ãã³ãã¢ã¼ã","keyboard.tooltip.numeric":"æ°å¤","keyboard.tooltip.roman":"è¨å·ã¨ã­ã¼ãå­","tooltip.copy to clipboard":"ã¯ãªãããã¼ãã«ã³ãã¼","tooltip.redo":"ããç´ã","tooltip.toggle virtual keyboard":"ä»®æ³ã­ã¼ãã¼ãã®åãæ¿ã","tooltip.undo":"åã«æ»ã"},pl:{"keyboard.tooltip.functions":"Funkcje","keyboard.tooltip.greek":"Litery greckie","keyboard.tooltip.command":"Tryb poleceÅ LaTeX","keyboard.tooltip.numeric":"Numeryczne","keyboard.tooltip.roman":"Symbole i litery rzymskie","tooltip.copy to clipboard":"Kopiuj do Schowka","tooltip.redo":"PrzywrÃ³Ä","tooltip.toggle virtual keyboard":"PrzeÅÄcz wirtualnÄ klawiaturÄ","tooltip.undo":"Cofnij"},ru:{"keyboard.tooltip.functions":"Ð¤ÑÐ½ÐºÑÐ¸Ð¸","keyboard.tooltip.greek":"ÐÑÐµÑÐµÑÐºÐ¸Ðµ Ð±ÑÐºÐ²Ñ","keyboard.tooltip.command":"Ð ÐµÐ¶Ð¸Ð¼ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¹ ÑÑÑÐ¾ÐºÐ¸ LaTeX","keyboard.tooltip.numeric":"ÑÐ¸ÑÐ»Ð¾Ð²Ð¾Ð¹","keyboard.tooltip.roman":"Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ñ Ð¸ ÑÐ¸Ð¼ÑÐºÐ¸Ðµ Ð±ÑÐºÐ²Ñ","tooltip.copy to clipboard":"Ð¡ÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°ÑÑ Ð² Ð±ÑÑÐµÑ Ð¾Ð±Ð¼ÐµÐ½Ð°","tooltip.redo":"Ð¿ÐµÑÐµÐ´ÐµÐ»ÑÐ²Ð°ÑÑ","tooltip.toggle virtual keyboard":"ÐÐµÑÐµÐºÐ»ÑÑÐ¸ÑÑ Ð²Ð¸ÑÑÑÐ°Ð»ÑÐ½ÑÑ ÐºÐ»Ð°Ð²Ð¸Ð°ÑÑÑÑ","tooltip.undo":"ÑÐ°ÑÑÑÐµÐ³Ð¸Ð²Ð°ÑÑ"}};const ti={numeric:{tooltip:"keyboard.tooltip.numeric",layer:"math",label:"123",layers:["math"]},roman:{tooltip:"keyboard.tooltip.roman",layer:"lower-roman",label:"ABC",layers:["lower-roman","upper-roman","symbols"]},greek:{tooltip:"keyboard.tooltip.greek",layer:"lower-greek",label:"&alpha;&beta;&gamma;",classes:"tex-math",layers:["lower-greek","upper-greek"]},functions:{tooltip:"keyboard.tooltip.functions",layer:"functions",label:"<i>f</i>&thinsp;()",classes:"tex",layers:["functions"]},command:{tooltip:"keyboard.tooltip.command",command:"enterCommandMode",label:"<svg><use xlink:href='#svg-command' /></svg>",layers:["lower-command","upper-command","symbols-command"]},style:{tooltip:"keyboard.tooltip.style",layer:"style",label:"<b>b</b><i>i</i>ð¹"}},ei={"\\varphi ":{label:"&Phi;",insert:"\\Phi "},"\\varsigma ":{label:"&Sigma;",insert:"\\Sigma "},"\\epsilon ":{label:"&#x0190;",insert:'{\\char"0190}'},"\\rho ":{label:"&#x3A1",insert:'{\\char"3A1}'},"\\tau ":{label:"&#x3A4;",insert:'{\\char"3A4}'},"\\upsilon ":{label:"&Upsilon;",insert:"\\Upsilon "},"\\theta ":{label:"&Theta;",insert:"\\Theta "},"\\iota ":{label:"&Iota;",insert:'{\\char"399}'},"\\omicron ":{label:"&#x039F;",insert:'{\\char"39F}'},"\\pi ":{label:"&Pi;",insert:"\\Pi "},"\\alpha ":{label:"&Alpha;",insert:'{\\char"391}'},"\\sigma ":{label:"&Sigma;",insert:"\\Sigma "},"\\delta ":{label:"&Delta;",insert:"\\Delta "},"\\phi ":{label:"&#x03a6;",insert:"\\Phi "},"\\gamma ":{label:"&Gamma;",insert:"\\Gamma "},"\\eta ":{label:"&Eta;",insert:'{\\char"397}'},"\\xi ":{label:"&Xi;",insert:"\\Xi "},"\\kappa ":{label:"&Kappa;",insert:'{\\char"39A}'},"\\lambda ":{label:"&Lambda;",insert:"\\Lambda "},"\\zeta ":{label:"&Zeta;",insert:'{\\char"396}'},"\\chi ":{label:"&Chi;",insert:'{\\char"3A7}'},"\\psi ":{label:"&Psi;",insert:"\\Psi "},"\\omega ":{label:"&Omega;",insert:"\\Omega "},"\\beta ":{label:"&Beta;",insert:'{\\char"392}'},"\\nu ":{label:"&Nu;",insert:'{\\char"39D}'},"\\mu ":{label:"&Mu;",insert:'{\\char"39C}'}},ii={0:["\\emptyset","\\varnothing","\\infty",{latex:"#?_0",insert:"#@_0"},"\\circ","\\bigcirc","\\bullet"],2:["\\frac{1}{2}",{latex:"#?^2",insert:"#@^2"}],3:["\\frac{1}{3}",{latex:"#?^3",insert:"#@^3"}],".":[",",";","\\colon",{latex:":",aside:"ratio"},{latex:"\\cdotp",aside:"center dot",classes:"box"},{latex:"\\cdots",aside:"center ellipsis",classes:"box"},{latex:"\\ldotp",aside:"low dot",classes:"box"},{latex:"\\ldots",aside:"low ellipsis",classes:"box"},{latex:"\\vdots",aside:"",classes:"box"},{latex:"\\ddots",aside:"",classes:"box"},"\\odot","\\oslash","\\circledcirc"],"*":["\\cdot","\\ast","\\star","\\bigstar","\\ltimes","\\rtimes","\\rightthreetimes","\\leftthreetimes","\\intercal","\\prod",{latex:"\\prod_{n\\mathop=0}^{\\infty}",classes:"small"}],"+":["\\pm","\\mp","\\sum",{latex:"\\sum_{n\\mathop=0}^{\\infty}",classes:"small"},"\\dotplus","\\oplus"],"-":["\\pm","\\mp","\\ominus","\\vert #0  \\vert"],"/":["\\divideontimes","/","\\div"],"(":["\\left( #0\\right)","\\left[ #0\\right]","\\left\\{ #0\\right\\}","\\left\\langle #0\\right\\rangle","\\lfloor","\\llcorner","(","\\lbrack","\\lvert","\\lVert","\\lgroup","\\langle","\\lceil","\\ulcorner","\\lmoustache","\\lbrace"],")":["\\rfloor","\\lrcorner",")","\\rbrack","\\rvert","\\rVert","\\rgroup","\\rangle","\\rceil","\\urcorner","\\rmoustache","\\rbrace"],"=":["\\cong","\\asymp","\\equiv","\\differencedelta","\\varpropto","\\thickapprox","\\approxeq","\\thicksim","\\backsim","\\eqsim","\\simeq","\\Bumpeq","\\bumpeq","\\doteq","\\Doteq","\\fallingdotseq","\\risingdotseq","\\coloneq","\\eqcirc","\\circeq","\\triangleq","\\between"],"!=":["\\neq","\\ncong","","\\nsim"],"<":["\\leq","\\leqq","\\lneqq","\\ll","\\nless","\\nleq","\\precsim","\\lesssim","\\lessgtr","\\prec","\\preccurlyeq","\\lessdot","\\nprec"],">":["\\geq","\\geqq","\\gneqq","\\gg","\\ngtr","\\ngeq","\\succsim","\\gtrsim","\\gtrless","\\succ","\\succcurlyeq","\\gtrdot","\\nsucc"],set:["\\in","\\owns","\\subset","\\nsubset","\\supset","\\nsupset"],"!set":["\\notin","\\backepsilon"],subset:[],supset:[],infinity:["\\aleph_0","\\aleph_1","\\omega","\\mathfrak{m}"],"numeric-pi":["\\prod","\\theta","\\rho","\\sin","\\cos","\\tan"],ee:["\\times 10^{#?}","\\ln","\\ln_{10}","\\log"],"^":["_{#?}"],int:[{latex:"\\int_{#?}^{#?}",classes:"small"},{latex:"\\int",classes:"small"},{latex:"\\smallint",classes:"small"},{latex:"\\iint",classes:"small"},{latex:"\\iiint",classes:"small"},{latex:"\\oint",classes:"small"},{latex:"\\dfrac{\\rd}{\\rd x}",classes:"small"},{latex:"\\frac{\\partial}{\\partial x}",classes:"small"},"\\capitalDifferentialD","\\rd","\\partial"],nabla:["\\nabla\\times","\\nabla\\cdot","\\nabla^{2}"],"!":["!!","\\Gamma","\\Pi"],accents:["\\bar{#@}","\\vec{#@}","\\hat{#@}","\\check{#@}","\\dot{#@}","\\ddot{#@}","\\mathring{#@}","\\breve{#@}","\\acute{#@}","\\tilde{#@}","\\grave{#@}"],A:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"}],a:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"}],b:[{latex:"\\beth",aside:"beth"}],B:[{latex:"\\beth",aside:"beth"}],c:[{latex:"\\C",aside:"set of complex numbers"}],d:[{latex:"\\daleth",aside:"daleth"}],D:[{latex:"\\daleth",aside:"daleth"}],e:[{latex:"\\exponentialE",aside:"exponential e"},{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isnât"}],g:[{latex:"\\gimel",aside:"gimel"}],G:[{latex:"\\gimel",aside:"gimel"}],h:[{latex:"\\hbar",aside:"h bar"},{latex:"\\hslash",aside:"h slash"}],i:[{latex:"\\imaginaryI",aside:"imaginary i"}],j:[{latex:"\\imaginaryJ",aside:"imaginary j"}],l:[{latex:"\\ell",aside:"ell"}],n:[{latex:"\\N",aside:"set of natural numbers"}],p:[{latex:"\\P",aside:"set of primes"}],q:[{latex:"\\Q",aside:"set of rational numbers"}],r:[{latex:"\\R",aside:"set of real numbers"}],z:[{latex:"\\Z",aside:"set of integers"}],"x-var":["y","z","t","r",{latex:"f(#?)",classes:"small"},{latex:"g(#?)",classes:"small"},"x^2","x^n","x_n","x_{n+1}","x_i","x_{i+1}"],"n-var":["i","j","p","k","a","u"],ii:["\\Re","\\Im","\\imaginaryJ","\\Vert #0 \\Vert"],logic:[{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isnât"},{latex:"\\ni",aside:"such that"},{latex:"\\Colon",aside:"such that"},{latex:"\\implies",aside:"implies"},{latex:"\\impliedby",aside:"implied by"},{latex:"\\iff",aside:"if and only if"},{latex:"\\land",aside:"and"},{latex:"\\lor",aside:"or"},{latex:"\\oplus",aside:"xor"},{latex:"\\lnot",aside:"not"},{latex:"\\downarrow",aside:"nor"},{latex:"\\uparrow",aside:"nand"},{latex:"\\curlywedge",aside:"nor"},{latex:"\\bar\\curlywedge",aside:"nand"},{latex:"\\therefore",aside:"therefore"},{latex:"\\because",aside:"because"},{latex:"^\\biconditional",aside:"biconditional"},"\\leftrightarrow","\\Leftrightarrow","\\to","\\models","\\vdash","\\gets","\\dashv","\\roundimplies"],"set-operators":["\\cap","\\cup","\\setminus","\\smallsetminus","\\complement"],"set-relations":["\\in","\\notin","\\ni","\\owns","\\subset","\\supset","\\subseteq","\\supseteq","\\subsetneq","\\supsetneq","\\varsubsetneq","\\subsetneqq","\\nsubset","\\nsupset","\\nsubseteq","\\nsupseteq"],space:[{latex:'\\char"203A\\!\\char"2039',insert:"\\!",aside:"negative thin space<br>â»Â³â§¸ââ em"},{latex:'\\unicode{"203A}\\,\\unicode{"2039}',insert:"\\,",aside:"thin space<br>Â³â§¸ââ em"},{latex:'\\unicode{"203A}\\:\\unicode{"2039}',insert:"\\:",aside:"medium space<br>â´â§¸ââ em"},{latex:'\\unicode{"203A}\\;\\unicode{"2039}',insert:"\\;",aside:"thick space<br>âµâ§¸ââ em"},{latex:'\\unicode{"203A}\\ \\unicode{"2039}',insert:"\\ ",aside:"â em"},{latex:'\\unicode{"203A}\\enspace\\unicode{"2039}',insert:"\\enspace",aside:"Â½ em"},{latex:'\\unicode{"203A}\\quad\\unicode{"2039}',insert:"\\quad",aside:"1 em"},{latex:'\\unicode{"203A}\\qquad\\unicode{"2039}',insert:"\\qquad",aside:"2 em"}],delete:[{label:'<span class="warning"><svg><use xlink:href="#svg-trash" /></svg></span>',command:'"deleteAll"'}],"->|":[]};let si={};const ni={math:"\n        <div class='rows'>\n            <ul>\n                <li class='keycap tex' data-alt-keys='x-var'><i>x</i></li>\n                <li class='keycap tex' data-alt-keys='n-var'><i>n</i></li>\n                <li class='separator w5'></li>\n                <row name='numpad-1'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-key='ee' data-alt-keys='ee'>e</li>\n                <li class='keycap tex' data-key='ii' data-alt-keys='ii'>i</li>\n                <li class='keycap tex' data-latex='\\pi' data-alt-keys='numeric-pi'></li>\n            </ul>\n            <ul>\n                <li class='keycap tex' data-key='<' data-alt-keys='<'>&lt;</li>\n                <li class='keycap tex' data-key='>' data-alt-keys='>'>&gt;</li>\n                <li class='separator w5'></li>\n                <row name='numpad-2'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='x2' data-insert='#@^{2}'><span><i>x</i>&thinsp;Â²</span></li>\n                <li class='keycap tex' data-alt-keys='^' data-insert='#@^{#?}'><span><i>x</i><sup>&thinsp;<small>&#x2b1a;</small></sup></span></li>\n                <li class='keycap tex' data-alt-keys='sqrt' data-insert='\\sqrt{#0}' data-latex='\\sqrt{#0}'></li>\n            </ul>\n            <ul>\n                <li class='keycap tex' data-alt-keys='(' >(</li>\n                <li class='keycap tex' data-alt-keys=')' >)</li>\n                <li class='separator w5'></li>\n                <row name='numpad-3'/>\n                <li class='separator w5'></li>\n                <li class='keycap tex small' data-alt-keys='int' data-latex='\\int_0^\\infty'><span></span></li>\n                <li class='keycap tex' data-latex='\\forall' data-alt-keys='logic' ></li>\n                <li class='action font-glyph bottom right' data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            </ul>\n            <ul>\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428; box-sizing: border-box'></span></li>\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590; box-sizing: border-box'></span></li>\n                <li class='separator w5'></li>\n                <row name='numpad-4'/>\n                <li class='separator w5'></li>\n                <arrows/>\n            </ul>\n        </div>\n    ","lower-roman":"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <row name='lower-1' shift-layer='upper-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <row name='lower-2'  shift-layer='upper-roman''/>\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <row name='lower-3'  shift-layer='upper-roman''/>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols'>&infin;â </li>\n                <li class='keycap' data-alt-keys=','>,</li>\n                <li class='keycap w50' data-key=' ' data-alt-keys='space'>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","upper-roman":"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <row name='upper-1'  shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <row name='upper-2' shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <row name='upper-3' shift-layer='lower-roman'/>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols'>&infin;â </li>\n                <li class='keycap' data-alt-keys='.'>;</li>\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",symbols:"\n        <div class='rows'>\n            <ul>\n                <row name='numpad-1' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\lbrace '>{</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rbrace '>}</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='set' data-insert='\\in '>&#x2208;</li>\n                <li class='keycap tex' data-alt-keys='!set' data-insert='\\notin '>&#x2209;</li>\n                <li class='keycap tex' data-insert='\\Re '>&#x211c;<aside>Real</aside></li>\n                <li class='keycap tex' data-insert='\\Im '>&#x2111;<aside>Imaginary</aside></li>\n                <li class='keycap w15' data-insert='\\ulcorner#0\\urcorner '><span><sup>&#x250c;</sup><span><span style='color:#ddd'>o</span><sup>&#x2510;</sup></span><aside>ceil</aside></li>\n                <li class='keycap tex' data-alt-keys='nabla' data-insert='\\nabla '>&#x2207;<aside>nabla</aside></li>\n                <li class='keycap tex' data-alt-keys='infinity' data-insert='\\infty '>&#x221e;</li>\n\n            </ul>\n            <ul>\n                <row name='numpad-2' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\lbrack '>[</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rbrack '>]</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-alt-keys='subset' data-insert='\\subset '>&#x2282;</li>\n                <li class='keycap tex' data-alt-keys='supset' data-insert='\\supset '>&#x2283;</li>\n                <li class='keycap tex' data-key='!' data-alt-keys='!'>!<aside>factorial</aside></li>\n                <li class='keycap' data-insert='^{\\prime} '><span><sup><span><span style='color:#ddd'>o</span>&#x2032</sup></span><aside>prime</aside></li>\n                <li class='keycap w15' data-insert='\\llcorner#0\\lrcorner '><span><sub>&#x2514;</sub><span style='color:#ddd'>o</span><sub>&#x2518;</sub></span><aside>floor</aside></li>\n                <li class='keycap tex' data-insert='\\partial '>&#x2202;<aside>partial<br>derivative</aside></li>\n                <li class='keycap tex' data-insert='\\emptyset '>&#x2205;<aside>empty set</aside></li>\n\n            </ul>\n            <ul>\n                <row name='numpad-3' class='if-wide'/>\n                <li class='keycap tex' data-alt-keys='(' data-insert='\\langle '>&#x27e8;</li>\n                <li class='keycap tex' data-alt-keys=')' data-insert='\\rangle '>&#x27e9;</li>\n                <li class='separator w5'></li>\n                <li class='keycap tex' data-insert='\\subseteq '>&#x2286;</li>\n                <li class='keycap tex' data-insert='\\supseteq '>&#x2287;</li>\n                <li class='keycap tex' data-alt-keys='accents' data-insert='\\vec{#@}' data-latex='\\vec{#?}' data-aside='vector'></li>\n                <li class='keycap tex' data-alt-keys='accents' data-insert='\\bar{#@}' data-latex='\\bar{#?}' data-aside='bar'></li>\n                <li class='keycap tex' data-alt-keys='absnorm' data-insert='\\lvert #@ \\rvert ' data-latex='\\lvert #? \\rvert' data-aside='abs'></li>\n                <li class='keycap tex' data-insert='\\ast '>&#x2217;<aside>asterisk</aside></li>\n\n                <li class='action font-glyph bottom right w15'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <row name='numpad-4' class='if-wide'/>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='lower-roman'>abc</li>\n                <li class='keycap tex' data-insert='\\cdot '>&#x22c5;<aside>centered dot</aside></li>\n                <li class='keycap tex' data-insert='\\colon '>:<aside>colon</aside></li>\n                <li class='keycap tex' data-insert='\\circ '>&#x2218;<aside>circle</aside></li>\n                <li class='keycap tex' data-insert='\\approx '>&#x2248;<aside>approx.</aside></li>\n                <li class='keycap tex' data-insert='\\ne '>&#x2260;</li>\n                <li class='keycap tex' data-insert='\\pm '>&#x00b1;</li>\n                <arrows/>\n            </ul>\n        </div>","lower-greek":"\n        <div class='rows'>\n            <ul><li class='keycap tex' data-insert='\\varphi '><i>&#x03c6;</i><aside>phi var.</aside></li>\n                <li class='keycap tex' data-insert='\\varsigma '><i>&#x03c2;</i><aside>sigma var.</aside></li>\n                <li class='keycap tex' data-insert='\\epsilon '><i>&#x03f5;</i></li>\n                <li class='keycap tex' data-insert='\\rho '><i>&rho;</i></li>\n                <li class='keycap tex' data-insert='\\tau '><i>&tau;</i></li>\n                <li class='keycap tex' data-insert='\\upsilon '><i>&upsilon;</i></li>\n                <li class='keycap tex' data-insert='\\theta '><i>&theta;</i></li>\n                <li class='keycap tex' data-insert='\\iota '><i>&iota;</i></li>\n                <li class='keycap tex' data-insert='\\omicron '>&omicron;</i></li>\n                <li class='keycap tex' data-insert='\\pi '><i>&pi;</i></li>\n            </ul>\n            <ul><li class='keycap tex' data-insert='\\alpha ' data-shifted='&Alpha;' data-shifted-command='[\"insert\",\"{\\\\char\\\"391}\"]'><i>&alpha;</i></li>\n                <li class='keycap tex' data-insert='\\sigma '><i>&sigma;</i></li>\n                <li class='keycap tex' data-insert='\\delta '><i>&delta;</i></li>\n                <li class='keycap tex' data-insert='\\phi '><i>&#x03d5;</i></i></li>\n                <li class='keycap tex' data-insert='\\gamma '><i>&gamma;</i></li>\n                <li class='keycap tex' data-insert='\\eta '><i>&eta;</i></li>\n                <li class='keycap tex' data-insert='\\xi '><i>&xi;</i></li>\n                <li class='keycap tex' data-insert='\\kappa '><i>&kappa;</i></li>\n                <li class='keycap tex' data-insert='\\lambda '><i>&lambda;</i></li>\n            </ul>\n            <ul><li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='upper-greek'>&#x21e7;</li>\n                <li class='keycap tex' data-insert='\\zeta '><i>&zeta;</i></li>\n                <li class='keycap tex' data-insert='\\chi '><i>&chi;</i></li>\n                <li class='keycap tex' data-insert='\\psi '><i>&psi;</i></li>\n                <li class='keycap tex' data-insert='\\omega '><i>&omega;</i></li>\n                <li class='keycap tex' data-insert='\\beta '><i>&beta;</i></li>\n                <li class='keycap tex' data-insert='\\nu '><i>&nu;</i></li>\n                <li class='keycap tex' data-insert='\\mu '><i>&mu;</i></li>\n                <li class='action font-glyph bottom right w15'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <li class='keycap ' data-key=' '>&nbsp;</li>\n                <li class='keycap'>,</li>\n                <li class='keycap tex' data-insert='\\varepsilon '><i>&#x03b5;</i><aside>epsilon var.</aside></li>\n                <li class='keycap tex' data-insert='\\vartheta '><i>&#x03d1;</i><aside>theta var.</aside></li>\n                <li class='keycap tex' data-insert='\\varkappa '><i>&#x3f0;</i><aside>kappa var.</aside></li>\n                <li class='keycap tex' data-insert='\\varpi '><i>&#x03d6;<aside>pi var.</aside></i></li>\n                <li class='keycap tex' data-insert='\\varrho '><i>&#x03f1;</i><aside>rho var.</aside></li>\n                <arrows/>\n            </ul>\n        </div>","upper-greek":"\n        <div class='rows'>\n            <ul><li class='keycap tex' data-insert='\\Phi '>&Phi;<aside>phi</aside></li>\n                <li class='keycap tex' data-insert='\\Sigma '>&Sigma;<aside>sigma</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"0190}'>&#x0190;<aside>epsilon</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A1}'>&#x3A1;<aside>rho</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A4}'>&#x3A4;<aside>tau</aside></li>\n                <li class='keycap tex' data-insert='\\Upsilon '>&Upsilon;<aside>upsilon</aside></li>\n                <li class='keycap tex' data-insert='\\Theta '>&Theta;<aside>theta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"399}'>&Iota;<aside>iota</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39F}'>&#x039F;<aside>omicron</aside></li>\n                <li class='keycap tex' data-insert='\\Pi '>&Pi;<aside>pi</aside></li></ul>\n            <ul><li class='keycap tex' data-insert='{\\char\"391}'>&#x391;<aside>alpha</aside></li>\n                <li class='keycap tex' data-insert='\\Sigma '>&Sigma;<aside>sigma</aside></li>\n                <li class='keycap tex' data-insert='\\Delta '>&Delta;<aside>delta</aside></li>\n                <li class='keycap tex' data-insert='\\Phi '>&#x03a6;<aside>phi</aside></li>\n                <li class='keycap tex' data-insert='\\Gamma '>&Gamma;<aside>gamma</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"397}'>&Eta;<aside>eta</aside></li>\n                <li class='keycap tex' data-insert='\\Xi '>&Xi;<aside>xi</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39A}'>&Kappa;<aside>kappa</aside></li>\n                <li class='keycap tex' data-insert='\\Lambda '>&Lambda;<aside>lambda</aside></li></ul>\n            <ul><li class='shift modifier font-glyph bottom left selected w15 layer-switch' data-layer='lower-greek'>&#x21e7;</li>\n                <li class='keycap tex' data-insert='{\\char\"396}'>&Zeta;<aside>zeta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"3A7}'>&Chi;<aside>chi</aside></li>\n                <li class='keycap tex' data-insert='\\Psi '>&Psi;<aside>psi</aside></li>\n                <li class='keycap tex' data-insert='\\Omega '>&Omega;<aside>omega</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"392}'>&Beta;<aside>beta</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39D}'>&Nu;<aside>nu</aside></li>\n                <li class='keycap tex' data-insert='{\\char\"39C}'>&Mu;<aside>mu</aside></li>\n                <li class='action font-glyph bottom right w15' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            <ul>\n                <li class='separator w10'>&nbsp;</li>\n                <li class='keycap'>.</li>\n                <li class='keycap w50' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","lower-command":"\n        <div class='rows'>\n            <ul><row name='lower-1' class='tt' shift-layer='upper-command'/></ul>\n            <ul><row name='lower-2' class='tt' shift-layer='upper-command'/></ul>\n            <ul><row name='lower-3' class='tt' shift-layer='upper-command'/></ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'>01#</li>\n                <li class='keycap tt' data-shifted='[' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"[\"]'>{</li>\n                <li class='keycap tt' data-shifted=']' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"]\"]'>}</li>\n                <li class='keycap tt' data-shifted='(' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \"(\"]'>^</li>\n                <li class='keycap tt' data-shifted=')' data-shifted-command='[\"insertAndUnshiftKeyboardLayer\", \")\"]'>_</li>\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","upper-command":"\n        <div class='rows'>\n            <ul><row name='upper-1' class='tt' shift-layer='lower-command'/></ul>\n            <ul><row name='upper-2' class='tt' shift-layer='lower-command'/></ul>\n            <ul><row name='upper-3' class='tt' shift-layer='lower-command'/></ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='symbols-command'01#</li>\n                <li class='keycap tt'>[</li>\n                <li class='keycap tt'>]</li>\n                <li class='keycap tt'>(</li>\n                <li class='keycap tt'>)</li>\n                <li class='keycap w20' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>","symbols-command":"\n        <div class='rows'>\n            <ul><li class='keycap tt'>1</li><li class='keycap tt'>2</li><li class='keycap tt'>3</li><li class='keycap tt'>4</li><li class='keycap tt'>5</li><li class='keycap tt'>6</li><li class='keycap tt'>7</li><li class='keycap tt'>8</li><li class='keycap tt'>9</li><li class='keycap tt'>0</li></ul>\n            <ul><li class='keycap tt'>!</li><li class='keycap tt'>@</li><li class='keycap tt'>#</li><li class='keycap tt'>$</li><li class='keycap tt'>%</li><li class='keycap tt'>^</li><li class='keycap tt'>&</li><li class='keycap tt'>*</li><li class='keycap tt'>+</li><li class='keycap tt'>=</li></ul>\n            <ul>\n                <li class='keycap tt'>\\</li>\n                <li class='keycap tt'>|</li>\n                <li class='keycap tt'>/</li>\n                <li class='keycap tt'>`</li>\n                <li class='keycap tt'>;</li>\n                <li class='keycap tt'>:</li>\n                <li class='keycap tt'>?</li>\n                <li class='keycap tt'>'</li>\n                <li class='keycap tt'>\"</li>\n                <li class='action font-glyph bottom right'\n                    data-shifted='<span class=\"warning\"><svg><use xlink:href=\"#svg-trash\" /></svg></span>'\n                    data-shifted-command='\"deleteAll\"'\n                    data-alt-keys='delete' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'\n                >&#x232b;</li>\n            </ul>\n            <ul>\n                <li class='layer-switch font-glyph modifier bottom left' data-layer='lower-command'>abc</li>\n                <li class='keycap tt'>&lt;</li>\n                <li class='keycap tt'>&gt;</li>\n                <li class='keycap tt'>~</li>\n                <li class='keycap tt'>,</li>\n                <li class='keycap tt'>.</li>\n                <li class='keycap' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",functions:"\n        <div class='rows'>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\sin'></li>\n                <li class='fnbutton' data-insert='\\sin^{-1}'></li>\n                <li class='fnbutton' data-insert='\\ln'></li>\n                <li class='fnbutton' data-insert='\\exponentialE^{#?}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{lcm}(#?)' data-latex='\\operatorname{lcm}()'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{ceil}(#?)' data-latex='\\operatorname{ceil}()'></li>\n                <li class='bigfnbutton' data-insert='\\lim_{n\\to\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\int'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{abs}(#?)' data-latex='\\operatorname{abs}()'></li>\n            </ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\cos'></li>\n                <li class='fnbutton' data-insert='\\cos^{-1}'></li>\n                <li class='fnbutton' data-insert='\\ln_{10}'></li>\n                <li class='fnbutton' data-insert='10^{#?}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{gcd}(#?)' data-latex='\\operatorname{gcd}()'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{floor}(#?)' data-latex='\\operatorname{floor}()'></li>\n                <li class='bigfnbutton' data-insert='\\sum_{n\\mathop=0}^{\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\int_{0}^{\\infty}'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{sign}(#?)' data-latex='\\operatorname{sign}()'></li>\n            </ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton' data-insert='\\tan'></li>\n                <li class='fnbutton' data-insert='\\tan^{-1}'></li>\n                <li class='fnbutton' data-insert='\\log_{#?}'></li>\n                <li class='fnbutton' data-insert='\\sqrt[#?]{#0}'></li>\n                <li class='bigfnbutton' data-insert='#0 \\mod' data-latex='\\mod'></li>\n                <li class='bigfnbutton' data-insert='\\operatorname{round}(#?) ' data-latex='\\operatorname{round}()'></li>\n                <li class='bigfnbutton' data-insert='\\prod_{n\\mathop=0}^{\\infty}' data-latex='{\\tiny \\prod_{n=0}^{\\infty}}'></li>\n                <li class='bigfnbutton' data-insert='\\frac{\\differentialD #0}{\\differentialD x}'></li>\n                <li class='action font-glyph bottom right' data-command='[\"performWithFeedback\",\"deletePreviousChar\"]'>&#x232b;</li></ul>\n            <ul><li class='separator'></li>\n                <li class='fnbutton'>(</li>\n                <li class='fnbutton'>)</li>\n                <li class='fnbutton' data-insert='^{#?} ' data-latex='x^{#?} '></li>\n                <li class='fnbutton' data-insert='_{#?} ' data-latex='x_{#?} '></li>\n                <li class='keycap w20 ' data-key=' '>&nbsp;</li>\n                <arrows/>\n            </ul>\n        </div>",style:"\n        <div class='rows'>\n            <ul>\n                <li class='keycap' data-alt-keys='foreground-color' data-command='[\"applyStyle\",{\"color\":\"#cc2428\"}]'><span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428'></span></li>\n                <li class='keycap' data-alt-keys='background-color' data-command='[\"applyStyle\",{\"backgroundColor\":\"#fff590\"}]'><span style='border-radius: 50%;width:22px;height:22px; background:#fff590'></span></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size3\"}]' data-latex='\\scriptsize\\text{small}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size5\"}]' data-latex='\\scriptsize\\text{normal}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"size\":\"size9\"}]' data-latex='\\huge\\text{big}'></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-latex='\\langle' data-command='[\"insert\", \"\\\\langle\", {\"smartFence\":true}]'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"l\"}]' data-latex='\\fontseries{l}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"m\"}]' data-latex='\\fontseries{m}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"b\"}]' data-latex='\\fontseries{b}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"bx\"}]' data-latex='\\fontseries{bx}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"sb\"}]' data-latex='\\fontseries{sb}\\text{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"series\":\"c\"}]' data-latex='\\fontseries{c}\\text{Ab}'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"up\"}]' data-latex='\\textup{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"it\"}]' data-latex='\\textit{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sl\"}]' data-latex='\\textsl{Ab}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"shape\":\"sc\"}]' data-latex='\\textsc{Ab}'></li>\n                <li class='separator w5'></li>\n                <li class='keycap' data-insert='\\emph{#?} ' data-latex='\\text{\\emph{emph}}'></li>\n            </ul>\n            <ul>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmr\"}]' data-latex='\\textrm{Az}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmtt\"}]' data-latex='\\texttt{Az}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cmss\"}]' data-latex='\\textsf{Az}'></li>\n\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"bb\"}]'  data-latex='\\mathbb{AZ}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"scr\"}]'  data-latex='\\mathscr{AZ}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"cal\"}]' data-latex='\\mathcal{A1}'></li>\n                <li class='keycap' data-command='[\"applyStyle\",{\"fontFamily\":\"frak\"}]' data-latex='\\mathfrak{Az}'></li>\n            </ul>\n        </div>"};function ri(t,e,i){t=t.replace(/(^|[^\\])#@/g,"$1#?");const s=he.parseTokens(o(t),"math",e,i.config.macros),n=te.decompose({mathstyle:"displaystyle",macros:i.config.macros},s),r=q.makeSpan(n,"ML__base"),a=q.makeSpan("","ML__strut");a.setStyle("height",r.height,"em");const l=q.makeSpan("","ML__strut--bottom");return l.setStyle("height",r.height+r.depth,"em"),l.setStyle("vertical-align",-r.depth,"em"),q.makeSpan([a,l,r],"ML__mathlive").toMarkup()}function oi(t,e,i){let s="<div class='left'>";const n=e.replace(/\s+/g," ").split(" ");if(n.length>1){const e=Object.assign({},ti,t.config.customVirtualKeyboards||{});for(const t of n){if(!e[t])break;s+="<div class='",s+=t===i?"selected ":e[t].command?"action ":"layer-switch ",s+=(e[t].classes||"")+"'",e[t].tooltip&&(s+="data-tooltip='"+Ze(e[t].tooltip)+"' ",s+="data-placement='top' data-delay='1s'"),t!==i&&(e[t].command&&(s+="data-command='\""+e[t].command+"\"'"),e[t].layer&&(s+="data-layer='"+e[t].layer+"'")),s+=">"+e[t].label+"</div>"}}return s+="</div>",s+=`\n        <div class='right'>\n            <div class='action'\n                data-command='"copyToClipboard"'\n                data-tooltip='${Ze("tooltip.copy to clipboard")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-copy' /></svg>\n            </div>\n            <div class='action disabled'\n                data-command='"undo"'\n                data-tooltip='${Ze("tooltip.undo")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-undo' /></svg>\n            </div>\n            <div class='action disabled'\n                data-command='"redo"'\n                data-tooltip='${Ze("tooltip.redo")}' data-placement='top' data-delay='1s'>\n                <svg><use xlink:href='#svg-redo' /></svg>\n            </div>\n        </div>\n    `,"<div class='keyboard-toolbar' role='toolbar'>"+s+"</div>"}function ai(t,e,i){for(let s=0;s<e.length;++s){const n=e[s];n.getAttribute("data-latex")?n.innerHTML=ri(n.getAttribute("data-latex").replace(/&quot;/g,'"'),{"?":'{\\color{#555}{\\tiny \\char"2B1A}}'},t):""===n.innerHTML&&n.getAttribute("data-insert")?n.innerHTML=ri(n.getAttribute("data-insert").replace(/&quot;/g,'"'),{"?":'{\\color{#555}{\\tiny \\char"2B1A}}'},t):n.getAttribute("data-content")&&(n.innerHTML=n.getAttribute("data-content").replace(/&quot;/g,'"')),n.getAttribute("data-aside")&&(n.innerHTML+="<aside>"+n.getAttribute("data-aside").replace(/&quot;/g,'"')+"</aside>"),n.getAttribute("data-classes")&&n.classList.add(n.getAttribute("data-classes"));let r,o=n.getAttribute("data-insert");if(o&&(o=o.replace(/&quot;/g,'"')),o&&ei[o]&&(n.setAttribute("data-shifted",ei[o].label),n.setAttribute("data-shifted-command",JSON.stringify(["insertAndUnshiftKeyboardLayer",ei[o].insert]))),r=n.getAttribute("data-command")?JSON.parse(n.getAttribute("data-command")):n.getAttribute("data-insert")?["insert",n.getAttribute("data-insert"),{focus:!0,feedback:!0,mode:"math",format:"auto",resetStyle:!0}]:n.getAttribute("data-latex")?["insert",n.getAttribute("data-latex"),{focus:!0,feedback:!0,mode:"math",format:"auto",resetStyle:!0}]:["typedText",n.getAttribute("data-key")||n.textContent,{focus:!0,feedback:!0,simulateKeystroke:!0}],i&&(r=[i,r]),n.getAttribute("data-alt-keys")){const t=si[n.getAttribute("data-alt-keys")];t&&(r={default:r,pressAndHoldStart:["showAlternateKeys",n.getAttribute("data-alt-keys"),t],pressAndHoldEnd:"hideAlternateKeys"})}t._attachButtonHandlers(n,r)}}function li(t,e){const i={qwerty:{"lower-1":"qwertyuiop","lower-2":" asdfghjkl ","lower-3":"^zxcvbnm~","upper-1":"QWERTYUIOP","upper-2":" ASDFGHJKL ","upper-3":"^ZXCVBNM~","numpad-1":"789/","numpad-2":"456*","numpad-3":"123-","numpad-4":"0.=+"},azerty:{"lower-1":"azertyuiop","lower-2":"qsdfghjklm","lower-3":"^ wxcvbn ~","upper-1":"AZERTYUIOP","upper-2":"QSDFGHJKLM","upper-3":"^ WXCVBN ~"},qwertz:{"lower-1":"qwertzuiop","lower-2":" asdfghjkl ","lower-3":"^yxcvbnm~","upper-1":"QWERTZUIOP","upper-2":" ASDFGHJKL","upper-3":"^YXCVBNM~"},dvorak:{"lower-1":"^  pyfgcrl ","lower-2":"aoeuidhtns","lower-3":"qjkxbmwvz~","upper-1":"^  PYFGCRL ","upper-2":"AOEUIDHTNS","upper-3":"QJKXBMWVZ~"},colemak:{"lower-1":" qwfpgjluy ","lower-2":"arstdhneio","lower-3":"^zxcvbkm~","upper-1":" QWFPGNLUY ","upper-2":"ARSTDHNEIO","upper-3":"^ZXCVBKM~"}},s=i[t.config.virtualKeyboardLayout]?i[t.config.virtualKeyboardLayout]:i.qwerty;let n,r=e;r=r.replace(/<arrows\/>/g,"\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToPreviousChar\"]'\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-left\" /></svg>'\n            data-shifted-command='[\"performWithFeedback\",\"extendToPreviousChar\"]'>\n            <svg><use xlink:href='#svg-arrow-left' /></svg>\n        </li>\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextChar\"]'\n            data-shifted='<svg><use xlink:href=\"#svg-angle-double-right\" /></svg>'\n            data-shifted-command='[\"performWithFeedback\",\"extendToNextChar\"]'>\n            <svg><use xlink:href='#svg-arrow-right' /></svg>\n        </li>\n        <li class='action' data-command='[\"performWithFeedback\",\"moveToNextPlaceholder\"]'>\n        <svg><use xlink:href='#svg-tab' /></svg></li>");let o=r.match(/(<row\s+)(.*)((?:<\/row|\/)>)/);for(;o;){n="";const t=o[2].match(/[a-zA-Z][a-zA-Z0-9-]*=(['"])(.*?)\1/g),e={};for(const i of t){const t=i.match(/([a-zA-Z][a-zA-Z0-9-]*)=(['"])(.*?)\2/);e[t[1]]=t[3]}let a=s[e.name];if(a||(a=i.qwerty[e.name]),a)for(const i of a){let t=e.class||"";t&&(t=" "+t),"~"===i?(n+="<li class='action font-glyph bottom right ",n+=a.length-(a.match(/ /g)||[]).length/2==10?"w10":"w15",n+='\' data-shifted=\'<span class="warning"><svg><use xlink:href="#svg-trash" /></svg></span>\'\n                        data-shifted-command=\'"deleteAll"\'\n                        data-alt-keys=\'delete\' data-command=\'["performWithFeedback","deletePreviousChar"]\'\n                        >&#x232b;</li>'):" "===i?n+="<li class='separator w5'></li>":"^"===i?n+="<li class='shift modifier font-glyph bottom left w15 layer-switch' data-layer='"+e["shift-layer"]+"'>&#x21e7;</li>":"/"===i?n+="<li class='keycap"+t+"' data-alt-keys='/' data-insert='\\frac{#0}{#?}'>&divide;</li>":"*"===i?n+="<li class='keycap"+t+"' data-alt-keys='*' data-insert='\\times '>&times;</li>":"-"===i?n+="<li class='keycap"+t+"' data-alt-keys='*' data-key='-' data-alt-keys='-'>&#x2212;</li>":/tt/.test(t)?n+="<li class='keycap"+t+"' data-alt-keys='"+i+'\' data-command=\'["typedText","'+i+'",{"commandMode":true, "focus":true, "feedback":true}]\'>'+i+"</li>":n+="<li class='keycap"+t+"' data-alt-keys='"+i+"'>"+i+"</li>"}r=r.replace(new RegExp(o[1]+o[2]+o[3]),n),o=r.match(/(<row\s+)(.*)((?:<\/row|\/)>)/)}return r}var ci={make:function(t,e){let i='<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">\n\n            <symbol id="svg-command" viewBox="0 0 640 512">\n                <path d="M34.495 36.465l211.051 211.05c4.686 4.686 4.686 12.284 0 16.971L34.495 475.535c-4.686 4.686-12.284 4.686-16.97 0l-7.071-7.07c-4.686-4.686-4.686-12.284 0-16.971L205.947 256 10.454 60.506c-4.686-4.686-4.686-12.284 0-16.971l7.071-7.07c4.686-4.687 12.284-4.687 16.97 0zM640 468v-10c0-6.627-5.373-12-12-12H300c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h328c6.627 0 12-5.373 12-12z"/>\n            </symbol>\n\n            <symbol id="svg-undo" viewBox="0 0 512 512">\n                <path d="M20 8h10c6.627 0 12 5.373 12 12v110.625C85.196 57.047 165.239 7.715 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.834 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l7.069-7.069c4.503-4.503 11.749-4.714 16.482-.454C150.782 449.238 200.935 470 256 470c117.744 0 214-95.331 214-214 0-117.744-95.331-214-214-214-82.862 0-154.737 47.077-190.289 116H180c6.627 0 12 5.373 12 12v10c0 6.627-5.373 12-12 12H20c-6.627 0-12-5.373-12-12V20c0-6.627 5.373-12 12-12z"/>\n            </symbol>\n            <symbol id="svg-redo" viewBox="0 0 512 512">\n                <path d="M492 8h-10c-6.627 0-12 5.373-12 12v110.625C426.804 57.047 346.761 7.715 255.207 8.001 118.82 8.428 7.787 120.009 8 256.396 8.214 393.181 119.166 504 256 504c63.926 0 122.202-24.187 166.178-63.908 5.113-4.618 5.354-12.561.482-17.433l-7.069-7.069c-4.503-4.503-11.749-4.714-16.482-.454C361.218 449.238 311.065 470 256 470c-117.744 0-214-95.331-214-214 0-117.744 95.331-214 214-214 82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12z"/>\n            </symbol>\n            <symbol id="svg-arrow-left" viewBox="0 0 192 512">\n                <path d="M25.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L64.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L25 264.5c-4.6-4.7-4.6-12.3.1-17z"/>\n            </symbol>\n            <symbol id="svg-arrow-right" viewBox="0 0 192 512">\n                    <path d="M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17z"/>\n            </symbol>\n            <symbol id="svg-tab" viewBox="0 0 448 512">\n                    <path d="M32 217.1c0-8.8 7.2-16 16-16h144v-93.9c0-7.1 8.6-10.7 13.6-5.7l143.5 143.1c6.3 6.3 6.3 16.4 0 22.7L205.6 410.4c-5 5-13.6 1.5-13.6-5.7v-93.9H48c-8.8 0-16-7.2-16-16v-77.7m-32 0v77.7c0 26.5 21.5 48 48 48h112v61.9c0 35.5 43 53.5 68.2 28.3l143.6-143c18.8-18.8 18.8-49.2 0-68L228.2 78.9c-25.1-25.1-68.2-7.3-68.2 28.3v61.9H48c-26.5 0-48 21.6-48 48zM436 64h-8c-6.6 0-12 5.4-12 12v360c0 6.6 5.4 12 12 12h8c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12z"/>\n            </symbol>\n            <symbol id="svg-copy" viewBox="0 0 448 512">\n                <path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM352 32.491a15.88 15.88 0 0 1 7.431 4.195l51.882 51.883A15.885 15.885 0 0 1 415.508 96H352V32.491zM288 464c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V144c0-8.822 7.178-16 16-16h80v240c0 26.51 21.49 48 48 48h112v48zm128-96c0 8.822-7.178 16-16 16H176c-8.822 0-16-7.178-16-16V48c0-8.822 7.178-16 16-16h144v72c0 13.2 10.8 24 24 24h72v240z"/>\n            </symbol>\n            <symbol id="svg-angle-double-right" viewBox="0 0 320 512">\n                <path d="M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17zm128-17l-117.8-116c-4.7-4.7-12.3-4.7-17 0l-7.1 7.1c-4.7 4.7-4.7 12.3 0 17L255.3 256 153.1 356.4c-4.7 4.7-4.7 12.3 0 17l7.1 7.1c4.7 4.7 12.3 4.7 17 0l117.8-116c4.6-4.7 4.6-12.3-.1-17z"/>\n            </symbol>\n            <symbol id="svg-angle-double-left" viewBox="0 0 320 512">\n                <path d="M153.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L192.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L153 264.5c-4.6-4.7-4.6-12.3.1-17zm-128 17l117.8 116c4.7 4.7 12.3 4.7 17 0l7.1-7.1c4.7-4.7 4.7-12.3 0-17L64.7 256l102.2-100.4c4.7-4.7 4.7-12.3 0-17l-7.1-7.1c-4.7-4.7-12.3-4.7-17 0L25 247.5c-4.6 4.7-4.6 12.3.1 17z"/>\n            </symbol>\n            <symbol id="svg-trash" viewBox="0 0 448 512">\n                <path d="M336 64l-33.6-44.8C293.3 7.1 279.1 0 264 0h-80c-15.1 0-29.3 7.1-38.4 19.2L112 64H24C10.7 64 0 74.7 0 88v2c0 3.3 2.7 6 6 6h26v368c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V96h26c3.3 0 6-2.7 6-6v-2c0-13.3-10.7-24-24-24h-88zM184 32h80c5 0 9.8 2.4 12.8 6.4L296 64H152l19.2-25.6c3-4 7.8-6.4 12.8-6.4zm200 432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V96h320v368zm-176-44V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm-80 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm160 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12z"/>\n            </symbol>\n        </svg>\n        ';ii["foreground-color"]=[];for(const u of oe)ii["foreground-color"].push({classes:"small-button",content:'<span style="border-radius:50%;width:32px;height:32px; box-sizing: border-box; border: 3px solid '+u+'"></span>',command:'["applyStyle",{"color":"'+u+'"}]'});ii["background-color"]=[];for(const u of re)ii["background-color"].push({classes:"small-button",content:'<span style="border-radius:50%;width:32px;height:32px; background:'+u+'"></span>',command:'["applyStyle",{"backgroundColor":"'+u+'"}]'});si={...ii},Object.keys(si).forEach(t=>{si[t]=si[t].slice()});const s="abcdefghijklmnopqrstuvwxyz";for(let u=0;u<26;u++){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[u];si[t]||(si[t]=[]),si[t].unshift({latex:"\\mathbb{"+t+"}",aside:"blackboard",insert:"\\mathbb{"+t+"}"}),si[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),si[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathsf{"+t+"}"}),si[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),si[t].unshift({latex:"\\mathcal{"+t+"}",aside:"script",insert:"\\mathcal{"+t+"}"}),si[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"}),si[t].unshift({latex:"\\mathbb{"+s[u]+"}",aside:"blackboard",insert:"\\mathbb{"+s[u]+"}"}),si[t].unshift({latex:"\\mathbf{"+s[u]+"}",aside:"bold",insert:"\\mathbf{"+s[u]+"}"}),si[t].unshift({latex:"\\mathsf{"+s[u]+"}",aside:"sans",insert:"\\mathsf{"+s[u]+"}"}),si[t].unshift({latex:"\\mathcal{"+s[u]+"}",aside:"script",insert:"\\mathcal{"+s[u]+"}"}),si[t].unshift({latex:"\\mathfrak{"+s[u]+"}",aside:"fraktur",insert:"\\mathfrak{"+s[u]+"}"})}for(let u=0;u<=26;u++){const t=s[u];si[t]||(si[t]=[]),si[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathbb{"+t+"}"}),si[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),si[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),si[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"})}for(let u=0;u<10;u++){const t="0123456789"[u];si[t]||(si[t]=[]),si[t].unshift({latex:"\\mathbf{"+t+"}",aside:"bold",insert:"\\mathbf{"+t+"}"}),si[t].unshift({latex:"\\mathsf{"+t+"}",aside:"sans",insert:"\\mathsf{"+t+"}"}),si[t].unshift({latex:"\\mathtt{"+t+"}",aside:"monospace",insert:"\\mathtt{"+t+"}"}),si[t].unshift({latex:"\\mathcal{"+t+"}",aside:"script",insert:"\\mathcal{"+t+"}"}),si[t].unshift({latex:"\\mathfrak{"+t+"}",aside:"fraktur",insert:"\\mathfrak{"+t+"}"})}let n=t.config.virtualKeyboards;n||(n="all"),n=n.replace(/\ball\b/i,"numeric roman greek functions command");const r=Object.assign({},ni,t.config.customVirtualKeyboardLayers||{}),o=Object.assign({},ti,t.config.customVirtualKeyboards||{}),a=n.replace(/\s+/g," ").split(" ");for(const u of a){if(!o[u])break;let e=o[u].layers||[];o[u].layer&&e.push(o[u].layer),e=Array.from(new Set(e));for(const s of e){if(!r[s])break;if("object"==typeof r[s]){let t="";if(r[s].styles&&(t+=`<style>${r[s].styles}</style>`),r[s].backdrop&&(t+=`<div class='${r[s].backdrop}'>`),r[s].container&&(t+=`<div class='${r[s].container}'>`),r[s].rows){t+="<div class='rows'>";for(const e of r[s].rows){t+="<ul>";for(const i of e)t+="<li",i.class&&(t+=` class="${i.class}"`),i.key&&(t+=` data-key="${i.key}"`),i.command&&("string"==typeof i.command?t+=` data-command='"${i.command}"'`:(t+=" data-command='",t+=JSON.stringify(i.command),t+="'")),i.insert&&(t+=` data-insert="${i.insert}"`),i.latex&&(t+=` data-latex="${i.latex}"`),i.aside&&(t+=` data-aside="${i.aside}"`),i.altKeys&&(t+=` data-alt-keys="${i.altKeys}"`),i.shifted&&(t+=` data-shifted="${i.shifted}"`),i.shiftedCommand&&(t+=` data-shifted-command="${i.shiftedCommand}"`),t+=`>${i.label?i.label:""}</li>`;t+="</ul>"}t+="</div>",r[s].container&&(t+="</div'>"),r[s].backdrop&&(t+="</div'>")}r[s]=t}i+="<div tabindex=\"-1\" class='keyboard-layer' data-layer='"+s+"'>",i+=oi(t,n,u);const e="function"==typeof r[s]?r[s]():r[s];i+=li(t,e),i+="</div>"}}const l=document.createElement("div");l.className="ML__keyboard",e?l.classList.add(e):t.config.virtualKeyboardTheme?l.classList.add(t.config.virtualKeyboardTheme):/android|cros/i.test(navigator.userAgent)&&l.classList.add("material"),l.innerHTML=i,ai(t,l.querySelectorAll(".keycap, .action, .fnbutton, .bigfnbutton"));const c=l.getElementsByClassName("layer-switch");for(let u=0;u<c.length;++u)c[u].classList.contains("shift")?t._attachButtonHandlers(c[u],{pressed:["shiftKeyboardLayer","shift"],default:["switchKeyboardLayer",c[u].getAttribute("data-layer")],pressAndHoldEnd:"unshiftKeyboardLayer"}):t._attachButtonHandlers(c[u],{default:["switchKeyboardLayer",c[u].getAttribute("data-layer")]});const h=l.getElementsByClassName("keyboard-layer");return Array.from(h).forEach(t=>{t.addEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation()}),t.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation()})}),h[0].classList.add("is-visible"),window.addEventListener("mouseup",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("blur",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("touchend",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),window.addEventListener("touchcancel",(function(){t.hideAlternateKeys_(),t.unshiftKeyboardLayer_()})),l},makeKeycap:ai};const hi={"â":"-","-":"-","\\alpha":"alpha","\\beta":"beta","\\gamma":"gamma","\\delta":"delta","\\epsilon":"epsilon","\\varepsilon":"varepsilon","\\zeta":"zeta","\\eta":"eta","\\theta":"theta","\\vartheta":"vartheta","\\iota":"iota","\\kappa":"kappa","\\lambda":"lambda","\\mu":"mu","\\nu":"nu","\\xi":"xi","\\pi":"pi","\\rho":"rho","\\sigma":"sigma","\\tau":"tau","\\upsilon":"upsilon","\\phi":"phi","\\varphi":"varphi","\\chi":"chi","\\psi":"psi","\\omega":"omega","\\Gamma":"Gamma","\\Delta":"Delta","\\Theta":"Theta","\\Lambda":"Lambda","\\Xi":"Xi","\\Pi":"Pi","\\Sigma":"Sigma","\\Phi":"Phi","\\Psi":"Psi","\\Omega":"Omega"},ui={"\\pm":"+-","\\times":"xx","\\colon":":","\\vert":"|","\\Vert":"||","\\mid":"|","\\lbrace":"{","\\rbrace":"}","\\langle":"(:","\\rangle":":)"},di={"\\pm":"&PlusMinus;","\\times":"&times;","\\colon":":","\\vert":"|","\\Vert":"â¥","\\mid":"â£","\\lbrace":"{","\\rbrace":"}","\\langle":"â¨","\\rangle":"â©","\\lfloor":"â","\\rfloor":"â","\\lceil":"â","\\rceil":"â","\\vec":"&#x20d7;","\\acute":"&#x00b4;","\\grave":"&#x0060;","\\dot":"&#x02d9;","\\ddot":"&#x00a8;","\\tilde":"&#x007e;","\\bar":"&#x00af;","\\breve":"&#x02d8;","\\check":"&#x02c7;","\\hat":"&#x005e;"};function pi(t){return t.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function fi(t,e){return t&&e.generateID?' extid="'+t+'"':""}function mi(t,e,i){let s=!1,n="",r="",o=-1,a=-1;const l=t.atoms[t.index];if(t.index<(e=e||t.atoms.length)&&("mord"===l.type||"textord"===l.type)&&"0123456789,.".indexOf(l.body)<0&&(r=l.toMathML(i),l.superscript&&(o=t.index),l.subscript&&(a=t.index),t.index+=1),r.length>0){if(s=!0,gi(t)&&(o=t.index,t.index+=1),bi(t)&&(a=t.index,t.index+=1),o>=0&&a>=0)n="<msubsup>"+r,n+=wi(t.atoms[a].subscript,0,0,i).mathML,n+=wi(t.atoms[o].superscript,0,0,i).mathML,n+="</msubsup>";else if(o>=0){if(n="<msup>"+r,gi(t)){const e=wi(t.atoms[o].superscript,0,0,i).mathML,s=wi(t.atoms[o+1].superscript,0,0,i).mathML;n+="<mi>â²</mi>"!==e&&"<mi>&#x2032;</mi>"!==e||"<mi>â²</mi>"!==s&&"<mi>&#x2032;</mi>"!==s?"<mi>â²</mi>"===e||"<mi>&#x2032;</mi>"===e?"<mi>&#x2032;</mi>":e:"<mi>&#x2033;</mi>"}else n+=wi(t.atoms[o].superscript,0,0,i).mathML;n+="</msup>"}else a>=0?(n="<msub>"+r,n+=wi(t.atoms[a].subscript,0,0,i).mathML,n+="</msub>"):n=r;"mi"!==t.lastType&&"mn"!==t.lastType&&"mtext"!==t.lastType&&"fence"!==t.lastType||/^<mo>(.*)<\/mo>$/.test(n)||(n="<mo>&InvisibleTimes;</mo>"+n),r.endsWith(">f</mi>")||r.endsWith(">g</mi>")?(n+="<mo> &ApplyFunction; </mo>",t.lastType="applyfunction"):t.lastType=/^<mo>(.*)<\/mo>$/.test(n)?"mo":"mi",t.mathML+=n}return s}function gi(t){return t.index<t.atoms.length&&t.atoms[t.index].superscript&&"msubsup"===t.atoms[t.index].type}function bi(t){return t.index<t.atoms.length&&t.atoms[t.index].subscript&&"msubsup"===t.atoms[t.index].type}function yi(t,e,i){let s=!1,n="",r=e.atoms[e.index-1];return!!r&&(r.superscript||r.subscript||(gi(e)||bi(e))&&(r=e.atoms[e.index],e.index+=1),!!r&&(r.superscript&&r.subscript?(n="<msubsup>"+t,n+=wi(r.subscript,0,0,i).mathML,n+=wi(r.superscript,0,0,i).mathML,n+="</msubsup>"):r.superscript?(n="<msup>"+t,n+=wi(r.superscript,0,0,i).mathML,n+="</msup>"):r.subscript&&(n="<msub>"+t,n+=wi(r.subscript,0,0,i).mathML,n+="</msub>"),n.length>0&&(s=!0,e.mathML+=n,e.lastType=""),s))}function vi(t,e,i){let s=!1;e=e||t.atoms.length;const n=t.index;let r="";for(;t.index<e&&"text"===t.atoms[t.index].mode;)r+=t.atoms[t.index].body?t.atoms[t.index].body:" ",t.index+=1;return r.length>0&&(s=!0,r="<mtext"+fi(t.atoms[n].id,i)+">"+r+"</mtext>",t.mathML+=r,t.lastType="mtext"),s}function xi(t,e,i){let s=!1;e=e||t.atoms.length;const n=t.index;let r="",o=function(t){let e=-1,i=t.index,s=!1,n=!1;for(;i<t.atoms.length&&!s&&!n;)s="mord"!==t.atoms[i].type||"0123456789,.".indexOf(t.atoms[i].body)<0,n=!s&&t.atoms[i].superscript,i++;return n&&(e=i-1),e}(t);for(o>=0&&o<e&&(e=o);t.index<e&&"mord"===t.atoms[t.index].type&&"0123456789,.".indexOf(t.atoms[t.index].body)>=0;)r+=t.atoms[t.index].body,t.index+=1;return r.length>0&&(s=!0,r="<mn"+fi(t.atoms[n].id,i)+">"+r+"</mn>",o<0&&gi(t)&&(o=t.index,t.index+=1),o>=0&&(r="<msup>"+r,r+=wi(t.atoms[o].superscript,0,0,i).mathML,r+="</msup>"),t.mathML+=r,t.lastType="mn"),s}function Ci(t,e,i){let s=!1,n="",r="";if(t.index<(e=e||t.atoms.length)&&"mopen"===t.atoms[t.index].type){let o=!1,a=0;const l=t.index;let c=-1,h=l+1;for(;h<e&&!o;)"mopen"===t.atoms[h].type?a+=1:"mclose"===t.atoms[h].type&&(a-=1),-1===a&&(o=!0,c=h),h+=1;o&&(n="<mrow>",n+=Si(t.atoms[l],i),n+=wi(t.atoms,l+1,c,i).mathML,n+=Si(t.atoms[c],i),n+="</mrow>","mi"!==t.lastType&&"mn"!==t.lastType&&"mfrac"!==t.lastType&&"fence"!==t.lastType||(n="<mo>&InvisibleTimes;</mo>"+n),t.index=c+1,yi(n,t,i)&&(s=!0,t.lastType="",n=""),r="fence")}return n.length>0&&(s=!0,t.mathML+=n,t.lastType=r),s}function _i(t,e,i){let s=!1,n="",r="";const o=t.atoms[t.index];if(t.index<(e=e||t.atoms.length)&&("mbin"===o.type||"mrel"===o.type))n+=t.atoms[t.index].toMathML(i),t.index+=1,r="mo";else if(t.index<e&&"mop"===o.type){if("limits"===o.limits&&(o.superscript||o.subscript)){const t=Si(o,i);o.superscript&&o.subscript?(n+=("nolimits"!==o.limits?"<munderover>":"<msubsup>")+t,n+=wi(o.subscript,0,0,i).mathML,n+=wi(o.superscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</munderover>":"</msubsup>"):o.superscript?(n+=("nolimits"!==o.limits?"<mover>":"<msup>")+t,n+=wi(o.superscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</mover>":"</msup>"):(n+=("nolimits"!==o.limits?"<munder>":"<msub>")+t,n+=wi(o.subscript,0,0,i).mathML,n+="nolimits"!==o.limits?"</munder>":"</msub>"),r="mo"}else{const e=t.atoms[t.index],o=0===e.latex.indexOf("\\operatorname"),a=o?'<mi class="MathML-Unit"'+fi(e.id,i)+">"+Pi(e.body)+"</mi>":Si(e,i);n+=a,t.index+=1,yi(n,t,i)&&(s=!0,t.lastType="",n=""),t.index-=1,o||/^<mo>(.*)<\/mo>$/.test(a)?r=o?"mi":"mo":(n+="<mo>&#x2061;</mo>",r="applyfunction")}"mi"!==t.lastType&&"mn"!==t.lastType||/^<mo>(.*)<\/mo>$/.test(n)||(n="<mo>&InvisibleTimes;</mo>"+n),t.index+=1}return n.length>0&&(s=!0,t.mathML+=n,t.lastType=r),s}function wi(t,e,i,s){const n={atoms:t,index:e||0,mathML:"",lastType:""};if(i=i||(t?t.length:0),"number"==typeof t||"boolean"==typeof t)n.mathML=t.toString();else if("string"==typeof t)n.mathML=t;else if(t&&"function"==typeof t.toMathML)n.mathML=t.toMathML(s);else if(Array.isArray(t)){let t=0;for(;n.index<i;)if(vi(n,i,s)||xi(n,i,s)||mi(n,i,s)||_i(n,i,s)||Ci(n,i,s))t+=1;else if(n.index<i){let e=n.atoms[n.index].toMathML(s);"mn"===n.lastType&&e.length>0&&"genfrac"===n.atoms[n.index].type&&(e="<mo>&#x2064;</mo>"+e),n.lastType="genfrac"===n.atoms[n.index].type?"mfrac":"",e.length>0&&(n.mathML+=e,t+=1),n.index+=1}t>1&&(n.mathML="<mrow>"+n.mathML+"</mrow>")}return n}function Si(t,e){let i="";const s=Pi(t.body);return s&&(i="<mo"+fi(t.id,e)+">"+s+"</mo>"),i}function Pi(t){if(!t)return"";if("string"==typeof t)return pi(t);if(!Array.isArray(t)&&"string"==typeof t.body)return pi(t.body);let e="";for(const i of t)"string"==typeof i.body&&(e+=i.body);return pi(e)}te.MathAtom.prototype.toMathML=function(t){const e={"\\exponentialE":"&#x02147;","\\imaginaryI":"&#x2148;","\\differentialD":"&#x2146;","\\capitalDifferentialD":"&#x2145;","\\alpha":"&#x03b1;","\\pi":"&#x03c0;","\\infty":"&#x221e;","\\forall":"&#x2200;","\\nexists":"&#x2204;","\\exists":"&#x2203;","\\hbar":"â","\\cdotp":"â","\\ldots":"â¦","\\cdots":"â¯","\\ddots":"â±","\\vdots":"â®","\\ldotp":"."},i={"\\!":-3/18,"\\ ":6/18,"\\,":3/18,"\\:":4/18,"\\;":5/18,"\\enspace":.5,"\\quad":1,"\\qquad":2,"\\enskip":.5};let s,n,r,o,a,l,c="",h="",u={cal:"script",frak:"fraktur",bb:"double-struck",scr:"script",cmtt:"monospace",cmss:"sans-serif"}[this.fontFamily||this.font]||"";u&&(u=' mathvariant="'+u+'"');const d=this.latex?this.latex.trim():null;let p;switch(this.type){case"group":case"root":c=wi(this.body,0,0,t).mathML;break;case"array":if((this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence)&&(c+="<mrow>",this.lFence&&"."!==this.lFence&&(c+="<mo>"+(di[this.lFence]||this.lFence)+"</mo>")),c+="<mtable",this.colFormat){for(c+=' columnalign="',r=0;r<this.colFormat.length;r++)this.colFormat[r].align&&(c+={l:"left",c:"center",r:"right"}[this.colFormat[r].align]+" ");c+='"'}for(c+=">",n=0;n<this.array.length;n++){for(c+="<mtr>",s=0;s<this.array[n].length;s++)c+="<mtd>"+wi(this.array[n][s],0,0,t).mathML+"</mtd>";c+="</mtr>"}c+="</mtable>",(this.lFence&&"."!==this.lFence||this.rFence&&"."!==this.rFence)&&(this.rFence&&"."!==this.rFence&&(c+="<mo>"+(di[this.lFence]||this.rFence)+"</mo>"),c+="</mrow>");break;case"genfrac":(this.leftDelim||this.rightDelim)&&(c+="<mrow>"),this.leftDelim&&"."!==this.leftDelim&&(c+="<mo"+fi(this.id,t)+">"+(di[this.leftDelim]||this.leftDelim)+"</mo>"),this.hasBarLine?(c+="<mfrac>",c+=wi(this.numer,0,0,t).mathML||"<mi>&nbsp;</mi>",c+=wi(this.denom,0,0,t).mathML||"<mi>&nbsp;</mi>",c+="</mfrac>"):(c+="<mtable"+fi(this.id,t)+">",c+="<mtr>"+wi(this.numer,0,0,t).mathML+"</mtr>",c+="<mtr>"+wi(this.denom,0,0,t).mathML+"</mtr>",c+="</mtable>"),this.rightDelim&&"."!==this.rightDelim&&(c+="<mo"+fi(this.id,t)+">"+(di[this.rightDelim]||this.rightDelim)+"</mo>"),(this.leftDelim||this.rightDelim)&&(c+="</mrow>");break;case"surd":this.index?(c+="<mroot"+fi(this.id,t)+">",c+=wi(this.body,0,0,t).mathML,c+=wi(this.index,0,0,t).mathML,c+="</mroot>"):(c+="<msqrt"+fi(this.id,t)+">",c+=wi(this.body,0,0,t).mathML,c+="</msqrt>");break;case"leftright":c="<mrow>",this.leftDelim&&"."!==this.leftDelim&&(c+="<mo"+fi(this.id,t)+">"+(di[this.leftDelim]||this.leftDelim)+"</mo>"),this.body&&(c+=wi(this.body,0,0,t).mathML),this.rightDelim&&"."!==this.rightDelim&&(c+="<mo"+fi(this.id,t)+">"+(di[this.rightDelim]||this.rightDelim)+"</mo>"),c+="</mrow>";break;case"sizeddelim":case"delim":c+='<mo separator="true"'+fi(this.id,t)+">"+(di[this.delim]||this.delim)+"</mo>";break;case"accent":c+='<mover accent="true"'+fi(this.id,t)+">",c+=wi(this.body,0,0,t).mathML,c+="<mo>"+(di[d]||this.accent)+"</mo>",c+="</mover>";break;case"line":case"overlap":break;case"overunder":a=this.overscript,o=this.underscript,a&&o?l=this.body:a?(l=this.body,this.body[0]&&this.body[0].underscript?(o=this.body[0].underscript,l=this.body[0].body):this.body[0]&&"first"===this.body[0].type&&this.body[1]&&this.body[1].underscript&&(o=this.body[1].underscript,l=this.body[1].body)):o&&(l=this.body,this.body[0]&&this.body[0].overscript?(a=this.body[0].overscript,l=this.body[0].body):this.body[0]&&"first"===this.body[0].type&&this.body[1]&&this.body[1].overscript&&(a=this.body[1].overscript,l=this.body[1].body)),a&&o?(c+="<munderover"+u+fi(this.id,t)+">"+wi(l,0,0,t).mathML,c+=wi(o,0,0,t).mathML,c+=wi(a,0,0,t).mathML,c+="</munderover>"):a?(c+="<mover"+u+fi(this.id,t)+">"+wi(l,0,0,t).mathML,c+=wi(a,0,0,t).mathML,c+="</mover>"):o&&(c+="<munder"+u+fi(this.id,t)+">"+wi(l,0,0,t).mathML,c+=wi(o,0,0,t).mathML,c+="</munder>");break;case"mord":{c=e[d]||d||("string"==typeof this.body?this.body:""),p=d?d.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):null,p?c="&#x"+p[1]+";":c.length>0&&"\\"===c.charAt(0)&&(c="string"==typeof this.body&&this.body.charCodeAt(0)>255?"&#x"+("000000"+this.body.charCodeAt(0).toString(16)).substr(-4)+";":"string"==typeof this.body?this.body.charAt(0):this.body);const i=/\d/.test(c)?"mn":"mi";c="<"+i+u+fi(this.id,t)+">"+pi(c)+"</"+i+">";break}case"mbin":case"mrel":case"textord":case"minner":c=d&&e[d]?"<mi"+fi(this.id,t)+">"+e[d]+"</mi>":d&&di[d]?"<mo"+fi(this.id,t)+">"+di[d]+"</mo>":Si(this,t);break;case"mpunct":c='<mo separator="true"'+fi(this.id,t)+">"+(di[d]||d)+"</mo>";break;case"mop":"â"!==this.body&&(c="<mo"+fi(this.id,t)+">",c+="\\operatorname"===d?this.body:d||this.body,c+="</mo>");break;case"mathstyle":break;case"box":c='<menclose notation="box"',this.backgroundcolor&&(c+=' mathbackground="'+se(this.backgroundcolor)+'"'),c+=fi(this.id,t)+">"+wi(this.body,0,0,t).mathML+"</menclose>";break;case"spacing":c+='<mspace width="'+(i[d]||0)+'em"/>';break;case"enclose":c='<menclose notation="';for(const t in this.notation)Object.prototype.hasOwnProperty.call(this.notation,t)&&this.notation[t]&&(c+=h+t,h=" ");c+=fi(this.id,t)+'">'+wi(this.body,0,0,t).mathML+"</menclose>";break;case"space":c+="&nbsp;"}return c},te.toMathML=function(t,e){return wi(t,0,0,e).mathML};const ki={"\\imaginaryI":"â","\\imaginaryJ":"â","\\pi":"Ï","\\exponentialE":"â¯","ï¹¢":"+","ï¼":"+","â":"-","-":"-","ï¹£":"-","ï¼":"-","\\times":"*","\\cdot":"*","â¨":"*","ï¸â":"*","ï¸Ã":"*",".":"*","Ã·":"/","â":"/","ï¼":"/","!":"factorial","\\mp":"minusplus","\\ne":"!=","\\coloneq":":=","\\questeq":"?=","\\approx":"approx","\\cong":"congruent","\\sim":"similar","\\equiv":"equiv","\\pm":"plusminus","\\land":"and","\\wedge":"and","\\lor":"or","\\vee":"or","\\oplus":"xor","\\veebar":"xor","\\lnot":"not","\\neg":"not","\\exists":"exists","\\nexists":"!exists","\\forall":"forAll","\\backepsilon":"suchThat","\\therefore":"therefore","\\because":"because","\\nabla":"nabla","\\circ":"circle","\\ominus":"ominus","\\odot":"odot","\\otimes":"otimes","\\zeta":"Zeta","\\Gamma":"Gamma","\\min":"min","\\max":"max","\\mod":"mod","\\lim":"lim","\\sum":"sum","\\prod":"prod","\\int":"integral","\\iint":"integral2","\\iiint":"integral3","\\Re":"Re","\\gothicCapitalR":"Re","\\Im":"Im","\\gothicCapitalI":"Im","\\binom":"nCr","\\partial":"partial","\\differentialD":"differentialD","\\capitalDifferentialD":"capitalDifferentialD","\\Finv":"Finv","\\Game":"Game","\\wp":"wp","\\ast":"ast","\\star":"star","\\asymp":"asymp","\\to":"to","\\gets":"gets","\\in":"elementof","\\notin":"!elementof","\\ni":"ownedby","\\owns":"ownedby","\\subset":"subset","\\supset":"superset","\\complement":"complement","\\rightarrow":"shortLogicalImplies","\\leftarrow":"shortLogicalImpliedBy","\\leftrightarrow":"shortLogicalEquivalent","\\longrightarrow":"logicalImplies","\\longleftarrow":"logicalImpliedBy","\\longleftrightarrow":"logicalEquivalent","\\Rightarrow":"shortImplies","\\Leftarrow":"shortImpliedBy","\\Leftrightarrow":"shortEquivalent","\\implies":"implies","\\Longrightarrow":"implies","\\impliedby":"impliedBy","\\Longleftarrow":"impliedBy","\\iff":"equivalent","\\Longleftrightarrow":"equivalent"},Ei={"+":"add","*":"multiply","-":"subtract","/":"divide","=":"equal",":=":"assign","!=":"ne","?=":"questeq",approx:"approx",congruent:"congruent",similar:"similar",equiv:"equiv","<":"lt",">":"gt","<=":"le",">=":"ge","â¤":"le","â¥":"ge",">>":"gg","<<":"ll","**":"pow","++":"increment","--":"decrement"},Ti={equal:"%0 = %1",ne:"%0 \\ne %1",questeq:"%0 \\questeq %1",approx:"%0 \\approx %1",congruent:"%0 \\cong %1",similar:"%0 \\sim %1",equiv:"%0 \\equiv %1",assign:"%0 := %1",lt:"%0 < %1",gt:"%0 > %1",le:"%0 \\le %1",ge:"%0 \\ge %1",sin:"\\sin%_%^ %0",cos:"\\cos%_%^ %0",tan:"\\tan%_%^ %0",cot:"\\cot%_%^ %0",sec:"\\sec%_%^ %0",csc:"\\csc%_%^ %0",sinh:"\\sinh %0",cosh:"\\cosh %0",tanh:"\\tanh %0",csch:"\\csch %0",sech:"\\sech %0",coth:"\\coth %0",arcsin:"\\arcsin %0",arccos:"\\arccos %0",arctan:"\\arctan %0",arccot:"\\arcctg %0",arcsec:"\\arcsec %0",arccsc:"\\arccsc %0",arsinh:"\\arsinh %0",arcosh:"\\arcosh %0",artanh:"\\artanh %0",arcsch:"\\arcsch %0",arsech:"\\arsech %0",arcoth:"\\arcoth %0",ln:"\\ln%_%^ %",log:"\\log%_%^ %",lg:"\\lg %",lb:"\\lb %",sum:"\\sum%_%^ %0",prod:"\\prod%_%^ %0",Zeta:"\\zeta%_%^ %",Gamma:"\\Gamma %",min:"\\min%_%^ %",max:"\\max%_%^ %",mod:"\\mod%_%^ %",lim:"\\lim%_%^ %",binom:"\\binom %",nabla:"\\nabla %",curl:"\\nabla\\times %0",div:"\\nabla\\cdot %0",floor:"\\lfloor %0 \\rfloor%_%^",ceil:"\\lceil %0 \\rceil%_%^",abs:"\\left| %0 \\right|%_%^",norm:"\\lVert %0 \\rVert%_%^",ucorner:"\\ulcorner %0 \\urcorner%_%^",lcorner:"\\llcorner %0 \\lrcorner%_%^",angle:"\\langle %0 \\rangle%_%^",group:"\\lgroup %0 \\rgroup%_%^",moustache:"\\lmoustache %0 \\rmoustache%_%^",brace:"\\lbrace %0 \\rbrace%_%^","sqrt[]":"\\sqrt[%^]{%0}",sqrt:"\\sqrt{%0}",lcm:"\\operatorname{lcm}%",gcd:"\\operatorname{gcd}%",erf:"\\operatorname{erf}%",erfc:"\\operatorname{erfc}%",randomReal:"\\operatorname{randomReal}%",randomInteger:"\\operatorname{randomInteger}%",and:"%0 \\land %1",or:"%0 \\lor %1",xor:"%0 \\oplus %1",not:"%0 \\lnot %1",circle:"%0 \\circ %1",ast:"%0 \\ast %1",star:"%0 \\star %1",asymp:"%0 \\asymp %1","/":"\\frac{%0}{%1}",Re:"\\Re{%0}",Im:"\\Im{%0}",factorial:"%0!",factorial2:"%0!!"},Ai={degree:880,nabla:740,curl:740,partial:740,differentialD:740,capitalDifferentialD:740,"**":720,odot:710,not:680,div:660,solidus:660,"/":660,setminus:650,"%":640,otimes:410,union:350,intersection:350,"*":390,ast:390,".":390,oplus:300,ominus:300,"+":275,"-":275,"+-":275,"-+":275,circle:265,circledast:265,circledcirc:265,star:265,"..":263,to:262,in:262,"|":261,congruent:265,equiv:260,"=":260,"!=":255,"?=":255,similar:250,approx:247,"<":245,">":243,">=":242,"â¥":242,"<=":241,complement:240,subset:240,superset:240,elementof:240,"!elementof":240,exists:230,"!exists":230,forall:230,and:200,xor:195,or:190,suchThat:110,":":100,assign:80,":=":80,therefore:70,because:70,shortLogicalImplies:52,shortImplies:51,logicalImplies:50,implies:49,shortLogicalImpliedBy:48,shortImpliedBy:47,logicalImpliedBy:46,impliedBy:45,shortLogicalEquivalent:44,shortEquivalent:43,logicalEquivalent:42,equivalent:41,",":40,";":30};function Oi(t,e){return Array.isArray(t.arg)?t.arg[e]:void 0}function Mi(t){return t&&Ai[t]||-1}function Ni(t){return/=|=>/.test(t)?"right":"left"}function Li(t){if("f"===t||"g"===t)return!0;const e=Ti[t];return!!e&&!!/%[^01_^]?/.test(e)}function Di(t){t=(t||"").trim();let e=ki[t];if(!e)if(/^\\[^{}]+$/.test(t)){const i=St.getInfo(t,"math",{});e=i&&i.value||t.slice(1)}else e=t;return e}function ji(t){if(!t)return null;const e=Di(zi(t)),i=[Mi(e),Ni(e)];return i[0]<=0?null:i}function Ri(t){return null!==ji(t)}const Ii={"\\lfloor\\rfloor":"floor","\\lceil\\rceil":"ceil","\\vert\\vert":"abs","\\lvert\\rvert":"abs","||":"abs","\\Vert\\Vert":"norm","\\lVert\\rVert":"norm","\\ulcorner\\urcorner":"ucorner","\\llcorner\\lrcorner":"lcorner","\\langle\\rangle":"angle","\\lgroup\\rgroup":"group","\\lmoustache\\rmoustache":"moustache","\\lbrace\\rbrace":"brace"},Bi={"!":"factorial","\\dag":"dagger","\\dagger":"dagger","\\ddagger":"dagger2","\\maltese":"maltese","\\backprime":"backprime","\\backdoubleprime":"backprime2","\\prime":"prime","\\doubleprime":"prime2","\\$":"$","\\%":"%","\\_":"_","\\degree":"degree"},Fi={"+":"add","-":"add","*":"multiply","=":"equal",",":"list",";":"list2",and:"and",or:"or",xor:"xor",union:"union",shortLogicalEquivalent:"logicalEquivalent",logicalEquivalent:"logicalEquivalent",shortEquivalent:"equivalent",equivalent:"equivalent"},Yi={",":"list",";":"list2"};function zi(t){if(Array.isArray(t)){let e="";for(const i of t)e+=zi(i);return e}if(t.latex&&!/^\\math(op|bin|rel|open|punct|ord|inner)/.test(t.latex))return t.latex.trim();if("leftright"===t.type)return"";if("string"==typeof t.body)return t.body;if(Array.isArray(t.body)){let e="";for(const i of t.body)e+=zi(i);return e}return""}function qi(t){return"string"==typeof t.sym?function(t){let e=Ti[t];if(e)return e.replace("%1","").replace("%0","").replace("%","");if(t.length>1){const i=St.getInfo("\\"+t,"math");!i||i.fontFamily&&"cmr"!==i.fontFamily&&"ams"!==i.fontFamily||(e="\\"+t)}return e||(e=St.unicodeStringToLatex("math",t)),e}(t.sym)||t.sym:""}function Xi(t){return parseFloat(t.num)}function Ui(t){return"object"==typeof t&&void 0!==t.num}function Gi(t){let e=0;return Ui(t)&&(e="object"==typeof t.num?void 0!==t.num.re?hs(t.num.re):0:parseFloat(t.num)),e}function Hi(t){let e=0;return Ui(t)&&"object"==typeof t.num&&(e=void 0!==t.num.im?hs(t.num.im):0),e}function Ji(t){return t&&void 0!==t.sup}function $i(t){return t&&void 0!==t.sub}function Vi(t,e,i){let s=!1;const n=t.atoms[t.index];return n&&n.type===e&&(s=void 0===i||zi(n)===i),s}function Wi(t,...e){const i={fn:t};if(e){const t=[];for(const i of e)i&&t.push(i);t.length>0&&(i.arg=t)}return i}function Ki(t){return"number"==typeof t?{num:t.toString()}:"string"==typeof t||"object"==typeof t?{num:t}:void 0}function Qi(t){if(Ui(t)){const e=Gi(t),i=Hi(t);return 0!==i?(0!==e&&(t.num.re=(-e).toString()),t.num.im=(-i).toString()):t.num=(-e).toString(),t}return Wi("negate",t)}function Zi(t){const e=t.atoms[t.index+1];return e&&"msubsup"===e.type}function ts(t,e){let i=t.atoms[t.index];return!i||void 0===i.superscript&&void 0===i.subscript?i=null:t.index+=1,i||(i=t.atoms[t.index+1],i&&"msubsup"===i.type&&(i.superscript||i.subscript)?t.index+=2:i=null),i?(void 0!==i.subscript&&(t.ast.sub=as(i.subscript,e)),void 0!==i.superscript&&("msubsup"===i.type?/['\u2032]|\\prime/.test(zi(i.superscript))?(t.index+=1,i=t.atoms[t.index+1],i&&"msubsup"===i.type&&/['\u2032]|\\prime/.test(zi(i.superscript))?t.ast.sup={sym:"â³"}:(t.ast.sup={sym:"â²"},t.index-=1)):/['\u2033]|\\doubleprime/.test(zi(i.superscript))?t.ast.sup={sym:"â³"}:t.ast&&(t.ast.sup=as(i.superscript,e)):t.ast.sup=as(i.superscript,e))):t.index+=1,t}function es(t,e){const i=t.ast;if(ss(t,"!!"))return t.index+=1,t.ast=Wi("factorial2",i),es(t=ts(t,e),e);if(ss(t,"++"))return t.index+=1,t.ast=Wi("increment",i),es(t=ts(t,e),e);if(ss(t,"--"))return t.index+=1,t.ast=Wi("decrement",i),es(t=ts(t,e),e);const s=t.atoms[t.index];return s&&s.latex&&Bi[s.latex.trim()]&&(t.ast=Wi(Bi[s.latex.trim()],i),t=es(t=ts(t,e),e)),t}function is(t,e,i,s){if(t.index=t.index||0,0===t.atoms.length||t.index>=t.atoms.length)return t.ast=void 0,t;const n=t.minPrec;t.minPrec=0;let r=t.atoms[t.index];if(e){if("mopen"===r.type&&zi(r)===e)t.index+=1,r=(t=rs(t,s)).atoms[t.index],r&&"mclose"===r.type&&zi(r)===i&&(Zi(t)&&(t.ast={group:t.ast}),t=es(t=ts(t,s),s));else if("textord"===r.type&&zi(r)===e)t.index+=1,r=(t=rs(t,s)).atoms[t.index],r&&"textord"===r.type&&zi(r)===i&&(t.index+=1,t=es(t=ts(t,s),s));else if("\\lVert"===e&&"textord"===r.type&&"|"===r.latex){if(r=t.atoms[t.index+1],r&&"textord"===r.type&&"|"===r.latex){t.index+=2,r=(t=rs(t,s)).atoms[t.index];const e=t.atoms[t.index+1];r&&"textord"===r.type&&"|"===r.latex&&e&&"textord"===e.type&&"|"===e.latex&&(t.index+=2,t=es(t=ts(t,s),s))}}else if("sizeddelim"===r.type&&r.delim===e)t.index+=1,r=(t=rs(t,s)).atoms[t.index],r&&"sizeddelim"===r.type&&r.delim===i&&(t.index+=1,t=es(t=ts(t,s),s));else{if("leftright"!==r.type||r.leftDelim!==e||"?"!==r.rightDelim&&r.rightDelim!==i)return;t.ast=as(r.body,s),Zi(t)&&(t.ast={group:t.ast}),t=es(t=ts(t,s),s)}return t.minPrec=n,t}{let s=!0;if("mopen"===r.type?(e=r.latex.trim(),i=St.RIGHT_DELIM[e]):"sizeddelim"===r.type?i=St.RIGHT_DELIM[e=r.delim]:"leftright"===r.type?(s=!1,e=r.leftDelim,"?"===(i=r.rightDelim)&&(i=St.RIGHT_DELIM[e])):"textord"===r.type&&(e=r.latex.trim(),i=St.RIGHT_DELIM[e]),e&&i){if("|"===e&&"|"===i){const s=t.atoms[t.index+1];s&&"textord"===s.type&&"|"===s.latex&&(e="\\lVert",i="\\rVert")}if(t=is(t,e,i))return s&&(t.index+=1),t.ast={fn:Ii[e+i]||e+i,arg:[t.ast]},t.minPrec=n,t}}}function ss(t,e){return t.index=t.index||0,!(t.atoms.length<=1||t.index>=t.atoms.length-1)&&e===zi(t.atoms[t.index])+zi(t.atoms[t.index+1])}function ns(t){if(t.index=t.index||0,!(t.atoms.length<=1||t.index>=t.atoms.length-1)){if(!Vi(t,"textord","\\nabla")){const e=t.atoms[t.index].latex+t.atoms[t.index+1].latex,i=/^(>=|<=|>>|<<|:=|!=|\*\*|\+\+|--)$/.test(e)?e:"";return i&&(t.index+=1),i}return t.index+=1,Vi(t,"mbin","\\times")?(t.index+=1,t.ast="curl",t):Vi(t,"mbin","\\cdot")?(t.index+=1,t.ast="div",t):void(t.index-=1)}}function rs(t,e){if(t.index=t.index||0,t.ast=void 0,0===t.atoms.length||t.index>=t.atoms.length)return t;t.minPrec=t.minPrec||0;let i=function t(e,i){if(e.index=e.index||0,e.ast=void 0,0===e.atoms.length||e.index>=e.atoms.length)return e;let s=e.atoms[e.index];const n=Di(zi(s));if(ns(e))e.ast=Wi(e.ast,t(e,i).ast);else{if("root"===s.type)return e.index=0,e.atoms=s.body,t(e,i);if("mbin"===s.type&&"-"===n)e.index+=1,(e=t(e,i)).ast=Qi(e.ast);else if("mbin"===s.type&&"+"===n)e.index+=1,(e=t(e,i)).ast=Wi("add",e.ast);else if("mord"===s.type&&/^[0-9.]$/.test(s.latex)){let n="",r=!1,o=/^[0-9.eEdD]$/;for(;e.index<e.atoms.length&&!r&&(Vi(e,"spacing")||(Vi(e,"mord")||Vi(e,"mpunct",",")||Vi(e,"mbin"))&&o.test(e.atoms[e.index].latex));)if("spacing"===e.atoms[e.index].type)e.index+=1;else if(void 0!==e.atoms[e.index].superscript||void 0!==e.atoms[e.index].subscript)r=!0;else{let t=e.atoms[e.index].latex;"d"===t||"D"===t?(t="e",o=/^[0-9+-.]$/):"e"===t||"E"===t?Zi(e)?(t="",e.index-=1,r=!0):(t="E",o=/^[0-9+-.]$/):o===/^[0-9+-.]$/&&(o=/^[0-9]$/),n+=","===t?"":t,e.index+=1}if(e.ast=n?Ki(n):void 0,s=e.atoms[e.index],s&&"genfrac"===s.type&&!isNaN(e.ast.num)){const s=e.ast;(e=t(e,i)).ast=Wi("add",s,e.ast)}if(s&&"group"===s.type&&s.latex&&s.latex.startsWith("\\nicefrac")){const s=e.ast;(e=t(e,i)).ast=Wi("add",s,e.ast)}s&&"msubsup"===s.type&&(e=ts(e,i)),e=es(e,i)}else if("genfrac"===s.type||"surd"===s.type)e.ast=s.toAST(i),e=es(e=ts(e,i),i);else if("mord"===s.type||"mbin"===s.type){if(Li(n)&&!Ri(s)){e.ast={fn:n};const s=(e=ts(e,i)).ast,r=t(e,i).ast;r&&/^(list0|list|list2)$/.test(r.fn)?s.arg=r.arg:r&&(s.arg=[r]),e.ast=s}else e.ast=s.toAST(i),"â"===e.ast.sym&&(e.ast=Ki({im:"1"})),e=ts(e);e=es(e,i)}else if("textord"===s.type){if(!Ri(s)&&!St.RIGHT_DELIM[s.latex?s.latex.trim():s.body])if(Li(n)){e.ast={fn:n};const s=(e=ts(e,i)).ast;e.index+=1,s.arg=[t(e,i).ast],e.ast=s,e=es(e,i)}else e.ast=s.toAST(i),void 0===s.superscript&&(e.index+=1),e=es(e=ts(e,i),i)}else if("mop"===s.type){if((/^\\(mathop|operatorname|operatorname\*)/.test(s.latex)||Li(n))&&!Ri(s))if(e.ast={fn:/^\\(mathop|operatorname|operatorname\*)/.test(s.latex)?s.body:n},Ji((e=ts(e,i)).ast)){const s={sin:"arcsin",cos:"arccos",tan:"arctan",cot:"arccot",sec:"arcsec",csc:"arccsc",sinh:"arsinh",cosh:"arcosh",tanh:"artanh",csch:"arcsch",sech:"arsech",coth:"arcoth"};if(-1===Xi(e.ast.sup)&&s[n])e.ast=Wi(s[n],t(e,i).ast);else{const s=e.ast;s.arg=[t(e,i).ast],e.ast=s}}else{const s=e.ast,n=t(e,i).ast;n&&/^(list0|list|list2)$/.test(n.fn)?s.arg=n.arg:n&&(s.arg=[n]),e.ast=s}}else if("array"===s.type)e.index+=1,e.ast=s.toAST(i);else if("group"===s.type)e.index+=1,e.ast=s.toAST(i);else{if("mclose"===s.type)return e;if("error"===s.type)return e.index+=1,e.ast={error:s.latex},e}}if(void 0===e.ast){const t=is(e,"(",")",i)||is(e,null,null,i);t?e=t:Ri(s)||("placeholder"===s.type?e.ast=Ki(0):(e.ast={text:"?"},e.ast.error="Unexpected token '"+s.type+"'",s.latex?e.ast.latex=s.latex:s.body&&s.toLatex&&(e.ast.latex=s.toLatex())),e.index+=1)}if(s=e.atoms[e.index],s&&("mord"===s.type||"surd"===s.type||"mop"===s.type||"mopen"===s.type||"sizeddelim"===s.type||"leftright"===s.type)){if("sizeddelim"===s.type)for(const t in St.RIGHT_DELIM)if(s.delim===St.RIGHT_DELIM[t])return e.index+=1,e;if(("mord"===s.type||"textord"===s.type||"mop"===s.type)&&Ri(s))return e;const n=e.ast;e.ast={},(e=t(e,i))&&e.ast&&n?Li(n.fn)&&void 0===n.arg||Array.isArray(n.arg)&&0===n.arg.length?e.ast="list2"===e.ast.fn||"list"===e.ast.fn?Wi(n.fn,e.ast.arg):Wi("multiply",n,e.ast):"multiply"===e.ast.fn?e.ast.arg.unshift(n):e.ast=0===Hi(n)&&0!==Gi(n)&&1===Hi(e.ast)&&0===Gi(e.ast)?Ki({im:Gi(n).toString()}):Wi("multiply",n,e.ast):e.ast=n}return e}(t,e).ast,s=!1;const n=t.minPrec;for(;!s;){const r=t.atoms[t.index],o=ns(t);let a,l;if(s=!r||"text"===r.mode||!o&&!Ri(r),s||([a,l]=o?[Mi(o),Ni(o)]:ji(r),s=a<n),!s){const n=o||Di(zi(r));if(t.minPrec="left"===l?a+1:a,t.index+=1,"|"===n)if(void 0!==r.subscript||t.atoms[t.index]&&void 0!==t.atoms[t.index].subscript&&"msubsup"===t.atoms[t.index].type){t.ast={};const s=ts(t,e).ast.sub;if(i=Wi("bind",i),s&&"equal"===s.fn&&i.arg)i.arg.push(Oi(s,0)),i.arg.push(Oi(s,1));else if(s&&i.arg&&("list"===s.fn||"list2"===s.fn)){let t={sym:"x"};for(let e=0;e<s.arg.length;e++)"equal"===s.arg[e].fn?(t=Oi(s.arg[e],0),i.arg.push(t),i.arg.push(Oi(s.arg[e],1))):(i.arg.push(t),i.arg.push(s.arg[e]))}else s&&(i.arg.push({sym:"x"}),i.arg.push(s))}else s=!0;else{const s=rs(t,e).ast;let r=Yi[n];r&&i&&i.fn!==r&&(i=Wi(r,i)),"-"===n?i&&i.arg&&"add"===i.fn?void 0!==s&&i.arg.push(Qi(s)):i=i&&"subtract"===i.fn?Wi("add",Oi(i,0),Qi(Oi(i,1)),Qi(s)):!Ui(i)||Ji(i)||!Ui(s)||Ji(s)||void 0!==s.num.re&&"0"!==s.num.re||void 0===s.num.im?Wi("subtract",i,s):{num:{re:i.num,im:(-parseFloat(s.num.im)).toString()}}:(r=Fi[n],"add"===r&&i&&"subtract"===i.fn?i=Wi("add",Oi(i,0),Qi(Oi(i,1)),s):r&&i&&i.fn===r&&!Ji(i)?void 0!==s&&(s.fn===r&&!Ji(s)&&s.arg?i.arg=[...i.arg,...s.arg]:i.arg&&i.arg.push(s)):r&&s&&s.arg&&s.fn===r?(s.arg.unshift(i),i=s):i="multiply"===r&&Ui(i)&&!Ji(i)&&s&&10===Xi(s)&&Ui(s.sup)?Ki(Xi(i)*Math.pow(10,Xi(s.sup))):"add"===r&&Ui(i)&&!Ji(i)&&s&&0!==Hi(s)&&!Ji(s)?{num:{re:i.num,im:s.num.im}}:Wi(r||Ei[n]||n,i,s))}}}return t.ast=i,t}function os(t){if(!t)return[];let e;if(Array.isArray(t)){e=[];for(const i of t){const t=os(i);e=e.concat(t)}}else{if("spacing"===t.type)return[];"first"===t.type||"box"===t.type?e=os(t.body):(t.body&&Array.isArray(t.body)&&(t.body=os(t.body)),t.superscript&&Array.isArray(t.superscript)&&(t.superscript=os(t.superscript)),t.subscript&&Array.isArray(t.subscript)&&(t.subscript=os(t.subscript)),t.index&&Array.isArray(t.index)&&(t.index=os(t.index)),t.denom&&Array.isArray(t.denom)&&(t.denom=os(t.denom)),t.numer&&Array.isArray(t.numer)&&(t.numer=os(t.numer)),t.array&&Array.isArray(t.array)&&(t.array=t.array.map(t=>t.map(t=>os(t)))),e=[t])}return e}function as(t,e){return function(t,e){t.index=t.index||0,t.ast=void 0;const i=[];for(;t.atoms[t.index];)if("text"===t.atoms[t.index].mode){let e="";for(;t.atoms[t.index]&&"text"===t.atoms[t.index].mode;)e+=t.atoms[t.index].body,t.index+=1;i.push(e)}else{const s=rs(t,e).ast;if(!s)return;i.push(s)}return i.length>1?Wi("text",...i):i[0]||void 0}({atoms:os(t)},e)}function ls(t){const e=Array.prototype.slice.call(arguments);e.shift(),t=t||".. ";let i="";if(e.length>0){"."!==t[0]&&(i+=t[0]);let s="";for(const n of e)i+=s+n,s=t[2];"."!==t[1]&&(i+=t[1])}return i}function cs(t,e){const i=t.length;t=t.substr(0,e.precision-2);for(let s=0;s<t.length-16;s++){const i=t.substr(0,s);for(let n=0;n<17;n++){const r=t.substr(s,n+1),o=Math.floor((t.length-i.length)/r.length);if(o>1&&(i+r.repeat(o+1)).startsWith(t))return"0"===r?i.replace(/(\d{3})/g,"$1"+e.groupSeparator):i.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.beginRepeatingDigits+r.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.endRepeatingDigits}}return i!==t.length&&(t+="\\ldots"),t.replace(/(\d{3})/g,"$1"+e.groupSeparator)}function hs(t){return parseFloat(parseFloat(t).toPrecision(15))}function us(t,e){let i="";if("number"==typeof e.precision){if("number"!=typeof t){let i="",s="";if("-"===t[0]?(i="-",t=t.substr(1)):"+"===t[0]&&(t=t.substr(1)),t.indexOf(".")>=0){const n=t.match(/(\d*).(\d*)([e|E]([-+]?[0-9]*))?/),r=n[1],o=n[2].substring(0,Math.min(e.precision-r.length,n[2].length));if(s=n[4]||"","0"===r){let s=0;for(;"0"===o[s]&&s<o.length;)s+=1;let n="";if(s<=4)n="0"+e.decimalMarker,n+=o.substr(0,s),n+=cs(t.substr(n.length),e);else if(s+1>=e.precision)n="0",i="";else{n=t[s];const i=cs(t.substr(s+1),e);i&&(n+=e.decimalMarker+i)}"0"!==n&&(t.length-1>e.precision&&!n.endsWith("}")&&!n.endsWith("\\ldots")&&(n+="\\ldots"),s>4&&(n+=e.exponentProduct,n+=e.exponentMarker?e.exponentMarker+(1-s).toString():"10^{"+(1-s).toString()+"}")),t=n}else{t=r.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator);const i=cs(o,e);i&&(t+=e.decimalMarker+i)}}else if(t.length>e.precision){const i=t.length;let s=t[0];const n=cs(t.substr(2),e);n&&(s+=e.decimalMarker+n,"}"!==s[s.length-1]&&(s+="\\ldots")),"1"!==s?s+=e.exponentProduct:s="",s+=e.exponentMarker?e.exponentMarker+(i-2).toString():"10^{"+(i-2).toString()+"}",t=s}else t=t.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator);return s&&(s=e.exponentMarker?e.exponentMarker+s:e.exponentProduct+" 10^{"+s+"}"),i+t+s}t=hs(t)}if("engineering"===e.scientificNotation)if(0===t)i="0";else{const s=Math.abs(t);let n=Math.round(Math.log10(s));n-=n%3,s<1e3&&(n=0);let r=s/Math.pow(10,n);const o=r.toString().match(/^(.*)\.(.*)$/);o&&o[1]&&o[2]&&(r=o[1]+e.decimalMarker+o[2]),e.groupSeparator&&(r=cs(r.toExponential(),e)),n=0===n?"":e.exponentMarker?e.exponentMarker+n:e.exponentProduct+" 10^{"+n+"}",i=(t<0?"-":"")+r+n}else{const s="string"==typeof t?t:t.toString();let n,r,o,a=s.match(/^(.*)[e|E]([-+]?[0-9]*)$/i);n=s,o="",a&&a[1]&&a[2]&&(n=a[1],r=e.exponentMarker?e.exponentMarker+a[2]:e.exponentProduct+" 10^{"+a[2]+"}"),a=n.match(/^(.*)\.(.*)$/),a&&a[1]&&a[2]&&(n=a[1],o=a[2]),e.groupSeparator&&(n=n.replace(/\B(?=(\d{3})+(?!\d))/g,e.groupSeparator),o=cs(o,e)),o&&(o=e.decimalMarker+o),i=n+o+(r||"")}return i}te.MathAtom.prototype.toAST=function(t){let e,i,s,n,r={},a="",l={bb:"double-struck",cal:"script",scr:"script",frak:"fraktur",cmrss:"sans-serif",cmrtt:"monospace"}[this.baseFontFamily||this.fontFamily],c="";"b"===this.fontSeries&&(c+="bold"),"it"===this.fontShape&&(c+="italic");const h=this.latex?this.latex.trim():null;switch(this.type){case"root":case"group":this.latex&&this.latex.startsWith("\\nicefrac")?(e=this.latex.slice(9).match(/({.*}|[^}])({.*}|[^}])/),e?(i=1===e[1].length?e[1]:e[1].substr(1,e[1].length-2),i=he.parseTokens(o(i),"math",null,t.macros),s=1===e[2].length?e[2]:e[2].substr(1,e[2].length-2),s=he.parseTokens(o(s),"math",null,t.macros),r=Wi("divide",as(i,t),as(s,t))):r.fn="divide"):r.group=as(this.body,t);break;case"genfrac":r=Wi("divide",as(this.numer,t),this.denom&&this.denom[0]&&"placeholder"===this.denom[0].type?Ki(1):as(this.denom,t));break;case"surd":r=this.index?Wi("pow",as(this.body,t),Wi("divide",1,as(this.index,t))):Wi("sqrt",as(this.body,t));break;case"rule":break;case"line":case"overlap":case"accent":case"overunder":break;case"mord":case"textord":case"mbin":e=h?h.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):void 0,e?a=String.fromCodePoint(parseInt(e[1],16)):(a=Di(zi(this)),a.length>0&&"\\"===a.charAt(0)&&"string"==typeof this.body&&(a=this.body)),n=St.mathVariantToUnicode(a,l,c).replace(/[\\]/g,"\\\\").replace(/["]/g,'\\"').replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t"),n!==a?(r={sym:n},l="normal"):r={sym:a};break;case"minner":case"mop":break;case"box":r=as(this.body,t);break;case"enclose":break;case"array":if("cardinality"===this.env.name)r=Wi("card",as(this.array,t));else if(/array|matrix|pmatrix|bmatrix/.test(this.env.name)){r={fn:"array",args:[]};for(const e of this.array)r.args.push(e.map(e=>as(e,t)))}else if("cases"===this.env.name){r={fn:"cases",args:[]};for(const e of this.array)if(e[0]){const i=[];i.push(as(e[0],t));let s=as(e[1],t);s&&"text"===s.fn&&s.arg&&/^(if|when|for)$/i.test(s.arg[0].trim())&&(s=s.arg.filter(t=>"string"!=typeof t)),i.push(s||{}),r.args.push(i)}}break;case"spacing":case"space":case"mathstyle":break;default:r=void 0}return r&&l&&"normal"!==l&&(r.variant=l),r&&"string"==typeof this.cssClass&&(r.class=this.cssClass),r&&"string"==typeof this.cssId&&(r.id=this.cssId),r},te.toAST=function(t,e){return as(t,e)};const ds={"\\alpha":"alpha ","\\mu":"mew ","\\sigma":"sigma ","\\pi":"pie ","\\imaginaryI":"eye ","\\sum":"Summation ","\\prod":"Product ",a:'<phoneme alphabet="ipa" ph="eÉª">a</phoneme>',A:'capital <phoneme alphabet="ipa" ph="eÉª">A</phoneme>',"+":"plus ","-":"minus ",";":'<break time="150ms"/> semi-colon <break time="150ms"/>',",":'<break time="150ms"/> comma  <break time="150ms"/>',"|":'<break time="150ms"/>Vertical bar<break time="150ms"/>',"(":'<break time="150ms"/>Open paren. <break time="150ms"/>',")":'<break time="150ms"/> Close paren. <break time="150ms"/>',"=":"equals ","<":"is less than ","\\lt":"is less than ","<=":"is less than or equal to ","\\le":"is less than or equal to ","\\gt":"is greater than ",">":"is greater than ","\\ge":"is greater than or equal to ","\\geq":"is greater than or equal to ","\\leq":"is less than or equal to ","!":"factorial ","\\sin":"sine ","\\cos":"cosine ","â":"","â":"minus ",":":'<break time="150ms"/> such that <break time="200ms"/> ',"\\colon":'<break time="150ms"/> such that <break time="200ms"/> ',"\\hbar":"etch bar ","\\iff":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\Longleftrightarrow":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\land":"and ","\\lor":"or ","\\neg":"not ","\\div":"divided by ","\\forall":"for all ","\\exists":"there exists ","\\nexists":"there does not exists ","\\in":"element of ","\\N":'the set <break time="150ms"/><say-as interpret-as="character">n</say-as>',"\\C":'the set <break time="150ms"/><say-as interpret-as="character">c</say-as>',"\\Z":'the set <break time="150ms"/><say-as interpret-as="character">z</say-as>',"\\Q":'the set <break time="150ms"/><say-as interpret-as="character">q</say-as>',"\\infty":"infinity ","\\nabla":"nabla ","\\partial":"partial derivative of ","\\cdots":"dot dot dot ","\\Rightarrow":"implies ","\\lbrace":'<break time="150ms"/>open brace<break time="150ms"/>',"\\{":'<break time="150ms"/>open brace<break time="150ms"/>',"\\rbrace":'<break time="150ms"/>close brace<break time="150ms"/>',"\\}":'<break time="150ms"/>close brace<break time="150ms"/>',"\\langle":'<break time="150ms"/>left angle bracket<break time="150ms"/>',"\\rangle":'<break time="150ms"/>right angle bracket<break time="150ms"/>',"\\lfloor":'<break time="150ms"/>open floor<break time="150ms"/>',"\\rfloor":'<break time="150ms"/>close floor<break time="150ms"/>',"\\lceil":'<break time="150ms"/>open ceiling<break time="150ms"/>',"\\rceil":'<break time="150ms"/>close ceiling<break time="150ms"/>',"\\vert":'<break time="150ms"/>vertical bar<break time="150ms"/>',"\\mvert":'<break time="150ms"/>divides<break time="150ms"/>',"\\lvert":'<break time="150ms"/>left vertical bar<break time="150ms"/>',"\\rvert":'<break time="150ms"/>right vertical bar<break time="150ms"/>',"\\lbrack":'<break time="150ms"/> open square bracket <break time="150ms"/>',"\\rbrack":'<break time="150ms"/> close square bracket <break time="150ms"/>',mm:"millimeters",cm:"centimeters",km:"kilometers",kg:"kilograms"};function ps(t){let e=0;if(t&&Array.isArray(t))for(const i of t)"first"!==i.type&&(e+=1);return 1===e}function fs(t){let e="";if(t&&Array.isArray(t))for(const i of t)"first"!==i.type&&"string"==typeof i.body&&(e+=i.body);return e}function ms(t,e,i,s){e=e.split(" ");for(const n of e){const e=n.match(/(.*):(.*)/);if(e){const n=s||{};"active"===e[2]?n.passive=!1:n[e[2]]=!0,t.addEventListener(e[1],i,n)}else t.addEventListener(n,i,s)}}function gs(t,e,i,s){e=e.split(" ");for(const n of e){const e=n.match(/(.*):(.*)/);if(e){const n=s||{};"active"===e[2]?n.passive=!1:n[e[2]]=!0,t.removeEventListener(e[1],i,n)}else t.removeEventListener(n,i,s)}}function bs(t,e){let i=document.getElementById(t);return i?i.setAttribute("data-refcount",parseInt(i.getAttribute("data-refcount"))+1):(i=document.createElement("div"),i.setAttribute("aria-hidden","true"),i.setAttribute("data-refcount","1"),i.className=e,i.id=t,document.body.appendChild(i)),i}function ys(t){if(!t)return null;const e=parseInt(t.getAttribute("data-refcount"));return e&&1!==e?t.setAttribute("data-refcount",e-1):t.remove(),t}function vs(t){return t.element&&t.element.mathfield===t}te.toSpeakableFragment=function(t,e){function i(t){return"<emphasis>"+t+"</emphasis>"}if(!t)return"";let s="";if(t.id&&"math"===e.speechMode&&(s+='<mark name="'+t.id.toString()+'"/>'),Array.isArray(t)){let n=!1;for(let r=0;r<t.length;r++)r<t.length-2&&"mopen"===t[r].type&&"mclose"===t[r+2].type&&"mord"===t[r+1].type?(s+=" of ",s+=i(te.toSpeakableFragment(t[r+1],e)),r+=2):"text"===t[r].mode?s+=t[r].body?t[r].body:" ":"mord"===t[r].type&&/[0123456789,.]/.test(t[r].body)?n?s+=t[r].body:(n=!0,s+=te.toSpeakableFragment(t[r],e)):(n=!1,s+=te.toSpeakableFragment(t[r],e))}else{let n="",r="",o="",a=!1;switch(t.type){case"group":case"root":s+=te.toSpeakableFragment(t.body,e);break;case"genfrac":if(n=te.toSpeakableFragment(t.numer,e),r=te.toSpeakableFragment(t.denom,e),ps(t.numer)&&ps(t.denom)){const e={"1/2":" half ","1/3":" one third ","2/3":" two third","1/4":" one quarter ","3/4":" three quarter ","1/5":" one fifth ","2/5":" two fifths ","3/5":" three fifths ","4/5":" four fifths ","1/6":" one sixth ","5/6":" five sixths ","1/8":" one eight ","3/8":" three eights ","5/8":" five eights ","7/8":" seven eights ","1/9":" one ninth ","2/9":" two ninths ","4/9":" four ninths ","5/9":" five ninths ","7/9":" seven ninths ","8/9":" eight ninths "}[fs(t.numer)+"/"+fs(t.denom)];e?s=e:s+=n+" over "+r}else s+=' the fraction <break time="150ms"/>'+n+', over <break time="150ms"/>'+r+'.<break time="150ms"/> End fraction.<break time="150ms"/>';break;case"surd":if(o=te.toSpeakableFragment(t.body,e),t.index){let i=te.toSpeakableFragment(t.index,e);i=i.trim();const n=i.replace(/<mark([^/]*)\/>/g,"");s+="3"===n?' the cube root of <break time="200ms"/>'+o+'. <break time="200ms"/> End cube root':"n"===n?' the nth root of <break time="200ms"/>'+o+'. <break time="200ms"/> End root':' the root with index: <break time="200ms"/>'+i+', of <break time="200ms"/>'+o+'. <break time="200ms"/> End root'}else ps(t.body)?s+=" the square root of "+o+" , ":s+=' the square root of <break time="200ms"/>'+o+'. <break time="200ms"/> End square root';break;case"accent":break;case"leftright":s+=ds[t.leftDelim]||t.leftDelim,s+=te.toSpeakableFragment(t.body,e),s+=ds[t.rightDelim]||t.rightDelim;break;case"line":case"rule":case"overunder":case"overlap":break;case"placeholder":s+="placeholder "+t.body;break;case"delim":case"sizeddelim":case"mord":case"minner":case"mbin":case"mrel":case"mpunct":case"mopen":case"mclose":case"textord":{const i=t.latex?t.latex.trim():"";if("\\mathbin"===i||"\\mathrel"===i||"\\mathopen"===i||"\\mathclose"===i||"\\mathpunct"===i||"\\mathord"===i||"\\mathinner"===i){s=te.toSpeakableFragment(t.body,e);break}let n=t.body,r=t.latex;if("delim"!==t.type&&"sizeddelim"!==t.type||(n=r=t.delim),"text"===e.speechMode)s+=n;else{if("mbin"===t.type&&(s+='<break time="150ms"/>'),n){const t=ds[n]||(r?ds[r.trim()]:"");s+=t?" "+t:(r?function(t){let e=Ke.NOTES[t];return e||"\\"!==t.charAt(0)||(e=" "+t.replace("\\","")+" "),Array.isArray(e)&&(e=e[0]),e}(r.trim()):"")||function(t){let i="";return e.textToSpeechMarkup?/[a-z]/.test(t)?i+=' <say-as interpret-as="character">'+t+"</say-as>":/[A-Z]/.test(t)?i+="capital "+t.toLowerCase():i+=t:/[a-z]/.test(t)?i+=" '"+t.toUpperCase()+"'":/[A-Z]/.test(t)?i+=" 'capital "+t.toUpperCase()+"'":i+=t,i}(n)}else s+=te.toSpeakableFragment(t.body,e);"mbin"===t.type&&(s+='<break time="150ms"/>')}break}case"mop":if("â"!==t.body){const n=t.latex?t.latex.trim():"";if("\\sum"===n)if(t.superscript&&t.subscript){let i=te.toSpeakableFragment(t.superscript,e);i=i.trim();let n=te.toSpeakableFragment(t.subscript,e);n=n.trim(),s+=' the summation from <break time="200ms"/>'+n+'<break time="200ms"/> to  <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else if(t.subscript){let i=te.toSpeakableFragment(t.subscript,e);i=i.trim(),s+=' the summation from <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else s+=" the summation of";else if("\\prod"===n)if(t.superscript&&t.subscript){let i=te.toSpeakableFragment(t.superscript,e);i=i.trim();let n=te.toSpeakableFragment(t.subscript,e);n=n.trim(),s+=' the product from <break time="200ms"/>'+n+'<break time="200ms"/> to <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else if(t.subscript){let i=te.toSpeakableFragment(t.subscript,e);i=i.trim(),s+=' the product from <break time="200ms"/>'+i+'<break time="200ms"/> of <break time="150ms"/>',a=!0}else s+=" the product  of ";else if("\\int"===n)if(t.superscript&&t.subscript){let n=te.toSpeakableFragment(t.superscript,e);n=n.trim();let r=te.toSpeakableFragment(t.subscript,e);r=r.trim(),s+=' the integral from <break time="200ms"/>'+i(r)+'<break time="200ms"/> to <break time="200ms"/>'+i(n)+' <break time="200ms"/> of ',a=!0}else s+=' the integral of <break time="200ms"/> ';else"string"==typeof t.body?s+=ds[t.body]||ds[t.latex.trim()]||" "+t.body:t.latex&&t.latex.length>0&&(s+="\\"===t.latex[0]?" "+t.latex.substr(1):" "+t.latex)}break;case"enclose":o=te.toSpeakableFragment(t.body,e),ps(t.body)?s+=" crossed out "+o+" , ":s+=" crossed out "+o+". End cross out"}if(!a&&t.superscript){let i=te.toSpeakableFragment(t.superscript,e);i=i.trim();const n=i.replace(/<[^>]*>/g,"");if(ps(t.superscript)){if("math"===e.speechMode){const e=function(t){if(t&&Array.isArray(t))for(const e of t)if("first"!==e.type&&e.id)return e.id.toString();return""}(t.superscript);e&&(s+='<mark name="'+e+'"/>')}"â²"===n?s+=" prime ":"2"===n?s+=" squared ":"3"===n?s+=" cubed ":isNaN(parseInt(n))?s+=" to the "+i+"; ":s+=' to the <say-as interpret-as="ordinal">'+n+"</say-as> power; "}else isNaN(parseInt(n))?s+=" raised to the "+i+"; ":s+=' raised to the <say-as interpret-as="ordinal">'+n+"</say-as> power; "}if(!a&&t.subscript){let i=te.toSpeakableFragment(t.subscript,e);i=i.trim(),ps(t.subscript)?s+=" sub "+i:s+=" subscript "+i+". End subscript. "}}return s},te.toSpeakableText=function(t,e){const i=e?JSON.parse(JSON.stringify(e)):{textToSpeechMarkup:"",textToSpeechRules:"mathlive"};if(i.speechMode="math",window.sre&&"sre"===i.textToSpeechRules){i.generateID=!0;const e=te.toMathML(t,i);return e?(i.textToSpeechMarkup&&(i.textToSpeechRulesOptions=i.textToSpeechRulesOptions||{},i.textToSpeechRulesOptions.markup=i.textToSpeechMarkup,"ssml"===i.textToSpeechRulesOptions.markup&&(i.textToSpeechRulesOptions.markup="ssml_step"),i.textToSpeechRulesOptions.rate=i.speechEngineRate),i.textToSpeechRulesOptions&&window.sre.System.getInstance().setupEngine(i.textToSpeechRulesOptions),window.sre.System.getInstance().toSpeech(e)):""}let s=te.toSpeakableFragment(t,i);if("ssml"===i.textToSpeechMarkup){let t="";i.speechEngineRate&&(t='<prosody rate="'+i.speechEngineRate+'">'),s='<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US"><amazon:auto-breaths>'+t+"<p><s>"+s+"</s></p>"+(t?"</prosody>":"")+"</amazon:auto-breaths></speak>"}else s="mac"===i.textToSpeechMarkup&&"mac"===function(t){let e="other";return navigator&&navigator.platform&&navigator.userAgent&&(/^(mac)/i.test(navigator.platform)?e="mac":/^(win)/i.test(navigator.platform)?e="win":/(android)/i.test(navigator.userAgent)?e="android":/(iphone)/i.test(navigator.userAgent)||/(ipod)/i.test(navigator.userAgent)||/(ipad)/i.test(navigator.userAgent)?e="ios":/\bCrOS\b/i.test(navigator.userAgent)&&(e="chromeos")),"mac"===e?"mac":"!mac"}()?s.replace(/<mark([^/]*)\/>/g,"").replace(/<emphasis>/g,"[[emph+]]").replace(/<\/emphasis>/g,"").replace(/<break time="([0-9]*)ms"\/>/g,"[[slc $1]]").replace(/<say-as[^>]*>/g,"").replace(/<\/say-as>/g,""):s.replace(/<[^>]*>/g,"").replace(/\s{2,}/g," ");return s};class xs{constructor(t,e){this.$setConfig(e||{}),this.element=t,t.mathfield=this,this.originalContent=t.innerHTML;let i=this.element.textContent;i&&(i=i.trim());let s="";this.config.substituteTextArea?s+="string"==typeof this.config.substituteTextArea?this.config.substituteTextArea:"<span></span>":/android|ipad|ipod|iphone/i.test(navigator.userAgent)?s+="<span class='ML__textarea'>\n                <span class='ML__textarea__textarea'\n                    tabindex=\"0\" role=\"textbox\"\n                    style='display:inline-block;height:1px;width:1px' >\n                </span>\n            </span>":s+='<span class="ML__textarea"><textarea class="ML__textarea__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" aria-hidden="true" tabindex="0"></textarea></span>',s+='<span class="ML__fieldcontainer"><span class="ML__fieldcontainer__field"></span>',this.config.virtualKeyboardMode||(this.config.virtualKeyboardMode=window.matchMedia&&window.matchMedia("(any-pointer: coarse)").matches?"onfocus":"off"),"manual"===this.config.virtualKeyboardMode?(s+=`<button class="ML__virtual-keyboard-toggle" data-tooltip="${Ze("tooltip.toggle virtual keyboard")}">`,s+=this.config.virtualKeyboardToggleGlyph?this.config.virtualKeyboardToggleGlyph:'<span style="width: 21px; margin-top: 4px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M528 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm16 336c0 8.823-7.177 16-16 16H48c-8.823 0-16-7.177-16-16V112c0-8.823 7.177-16 16-16h480c8.823 0 16 7.177 16 16v288zM168 268v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-336 80v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm384 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zM120 188v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-96 152v-8c0-6.627-5.373-12-12-12H180c-6.627 0-12 5.373-12 12v8c0 6.627 5.373 12 12 12h216c6.627 0 12-5.373 12-12z"/></svg></span>',s+="</button>"):s+="<span ></span>",s+="</span>",s+='\n        <div class="sr-only">\n            <span aria-live="assertive" aria-atomic="true"></span>\n            <span></span>\n        </div>\n    ',this.element.innerHTML=s;let n=0;this.textarea="function"==typeof this.config.substituteTextArea?this.config.substituteTextArea():this.element.children[n++].firstElementChild,this.field=this.element.children[n].children[0],this.field.addEventListener("wheel",t=>{t.preventDefault(),t.stopPropagation();let e=void 0===t.deltaX?t.detail:-t.deltaX;isFinite(e)||(e=t.wheelDelta/10),this.field.scroll({top:0,left:this.field.scrollLeft-5*e})},{passive:!1}),this.virtualKeyboardToggleDOMNode=this.element.children[n++].children[1],this._attachButtonHandlers(this.virtualKeyboardToggleDOMNode,{default:"toggleVirtualKeyboard",alt:"toggleVirtualKeyboardAlt",shift:"toggleVirtualKeyboardShift"}),this.ariaLiveText=this.element.children[n].children[0],this.accessibleNode=this.element.children[n++].children[1],this.popover=bs("mathlive-popover-panel","ML__popover"),this.keystrokeCaption=bs("mathlive-keystroke-caption-panel","ML__keystroke-caption"),this.keystrokeCaptionVisible=!1,this.virtualKeyboardVisible=!1,this.keystrokeBuffer="",this.keystrokeBufferStates=[],this.keystrokeBufferResetTimer=null,this.suggestionIndex=0,this.mode=e.defaultMode||"math",this.smartModeSuppressed=!1,this.style={},this.blurred=!0,ms(this.element,"focus",this),ms(this.element,"blur",this),ms(this.textarea,"cut",this),ms(this.textarea,"copy",this),ms(this.textarea,"paste",this),Ue.delegateKeyboardEvents(this.textarea,{container:this.element,allowDeadKey:()=>"text"===this.mode,typedText:this._onTypedText.bind(this),paste:this._onPaste.bind(this),keystroke:this._onKeystroke.bind(this),focus:this._onFocus.bind(this),blur:this._onBlur.bind(this)}),window.PointerEvent?ms(this.field,"pointerdown",this):ms(this.field,"touchstart:active mousedown",this),ms(window,"resize",this);const r={...e};r.onSelectionDidChange=xs.prototype._onSelectionDidChange.bind(this),r.onContentDidChange=xs.prototype._onContentDidChange.bind(this),r.onAnnounce=this.config.onAnnounce,r.macros=this.config.macros,r.removeExtraneousParentheses=this.config.removeExtraneousParentheses,this.mathlist=new Be.EditableMathlist(r,this),this.undoManager=new class{constructor(t){this.mathlist=t,this.maximumDepth=1e3,this.record=!1,this.canCoalesce=!1,this.reset()}reset(){this.stack=[],this.index=-1}startRecording(){this.record=!0}canUndo(){return this.index>0}canRedo(){return this.index!==this.stack.length-1}undo(t){this.canUndo()&&(t&&"function"==typeof t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"undo"),this.restore(this.stack[this.index-1],t),this.index-=1,t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"undo"),this.canCoalesce=!1)}redo(t){this.canRedo()&&(t&&"function"===t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"redo"),this.index+=1,this.restore(this.stack[this.index],t),t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"redo"),this.canCoalesce=!1)}pop(){this.canUndo()&&(this.index-=1,this.stack.pop())}snapshot(t){this.record&&(t&&"function"===t.onUndoStateWillChange&&t.onUndoStateWillChange(this.mathlist.target,"snapshot"),this.stack.splice(this.index+1,this.stack.length-this.index-1),this.stack.push({latex:this.mathlist.root.toLatex(),selection:this.mathlist.toString()}),this.index++,this.stack.length>this.maximumDepth&&this.stack.shift(),t&&"function"==typeof t.onUndoStateDidChange&&t.onUndoStateDidChange(this.mathlist.target,"snapshot"),this.canCoalesce=!1)}snapshotAndCoalesce(t){this.canCoalesce&&this.pop(),this.snapshot(t),this.canCoalesce=!0}save(){return{latex:this.mathlist.root.toLatex(),selection:this.mathlist.toString()}}restore(t,e){const i=this.mathlist.suppressChangeNotifications;void 0!==e.suppressChangeNotifications&&(this.mathlist.suppressChangeNotifications=e.suppressChangeNotifications),this.mathlist.insert(t?t.latex:"",{mode:"math",insertionMode:"replaceAll",selectionMode:"after",format:"latex",...e}),this.mathlist.setPath(t?t.selection:[{relation:"body",offset:0}]),this.mathlist.suppressChangeNotifications=i}}(this.mathlist),i.length>0&&this.$latex(i),this.undoManager.startRecording(),this.undoManager.snapshot(this.config)}handleEvent(t){switch(t.type){case"focus":this._onFocus(t);break;case"blur":this._onBlur(t);break;case"touchstart":case"mousedown":case"pointerdown":this._onPointerDown(t);break;case"resize":this._resizeTimer&&window.cancelAnimationFrame(this._resizeTimer),this._resizeTimer=window.requestAnimationFrame(()=>vs(this)&&this._onResize());break;case"cut":this._onCut(t);break;case"copy":this._onCopy(t);break;case"paste":this._onPaste(t)}}$revertToOriginalContent(){this.element.innerHTML=this.originalContent,this.element.mathfield=null,delete this.accessibleNode,delete this.ariaLiveText,delete this.field,gs(this.textarea,"cut",this),gs(this.textarea,"copy",this),gs(this.textarea,"paste",this),this.textarea.remove(),delete this.textarea,this.virtualKeyboardToggleDOMNode.remove(),delete this.virtualKeyboardToggleDOMNode,ys(this.popover),ys(this.keystrokeCaption),ys(this.virtualKeyboard),ys(document.getElementById("mathlive-alternate-keys-panel")),gs(this.element,"pointerdown",this),gs(this.element,"touchstart:active mousedown",this),gs(this.element,"focus",this),gs(this.element,"blur",this),gs(window,"resize",this),delete this.element}_resetKeystrokeBuffer(){this.keystrokeBuffer="",this.keystrokeBufferStates=[],clearTimeout(this.keystrokeBufferResetTimer)}_getCaretPosition(){const t=function t(e){if(e.classList.contains("ML__caret")||e.classList.contains("ML__text-caret")||e.classList.contains("ML__command-caret"))return e;let i;return Array.from(e.children).forEach((function(e){i=i||t(e)})),i}(this.field);if(t){const e=t.getBoundingClientRect();return{x:e.right,y:e.bottom,height:e.height}}return null}_getSelectionBounds(){const t=this.field.querySelectorAll(".ML__selected");if(t&&t.length>0){const e={top:1/0,bottom:-1/0,left:1/0,right:-1/0};t.forEach(t=>{const i=t.getBoundingClientRect();i.left<e.left&&(e.left=i.left),i.right>e.right&&(e.right=i.right),i.bottom>e.bottom&&(e.bottom=i.bottom),i.top<e.top&&(e.top=i.top)});const i=this.field.getBoundingClientRect(),s=e.right-e.left,n=e.bottom-e.top;return e.left=Math.ceil(e.left-i.left+this.field.scrollLeft),e.right=e.left+s,e.top=Math.ceil(e.top-i.top),e.bottom=e.top+n,e}return null}_pathFromPoint(t,e,i){let s;(i=i||{}).bias=i.bias||0;const n=function t(e,i,s){let n={element:null,distance:Number.POSITIVE_INFINITY},r=!0;if(e.getAttribute("data-atom-id")){n.element=e;const t=e.getBoundingClientRect(),o=i-(t.left+t.right)/2,a=s-(t.top+t.bottom)/2;n.distance=o*o+a*a,r=i>=t.left&&i<=t.right}return r&&e.children&&Array.from(e.children).forEach((function(e){const r=t(e,i,s);r.element&&r.distance<=n.distance&&(n=r)})),n}(this.field,t,e).element,r=n?n.getAttribute("data-atom-id"):null;if(r){const e=this.mathlist.filter((function(t,e){return e.captureSelection?e.filter(t=>t.id===r).length>0:e.id===r}));if(e&&e.length>0)if(s=pe.pathFromString(e[0]).path,0===i.bias){const e=n.getBoundingClientRect();t<e.left+e.width/2&&!n.classList.contains("ML__placeholder")&&(s[s.length-1].offset=Math.max(0,s[s.length-1].offset-1))}else i.bias<0&&(s[s.length-1].offset=Math.min(this.mathlist.siblings().length-1,Math.max(0,s[s.length-1].offset+i.bias)))}return s}_onPointerDown(t){const e=this;let i,s=!1,n=!1,r=!1;if(1!==t.buttons)return;function o(t){window.PointerEvent?(gs(e.field,"pointermove",h),gs(e.field,"pointerend pointerleave pointercancel",o),e.field.releasePointerCapture(t.pointerId)):(gs(e.field,"touchmove",h),gs(e.field,"touchend touchleave",o),gs(window,"mousemove",h),gs(window,"mouseup blur",o)),s=!1,clearInterval(c),e.element.querySelectorAll(".ML__scroller").forEach(t=>t.parentNode.removeChild(t)),t.preventDefault(),t.stopPropagation()}let a=!1,l=!1;const c=setInterval(()=>{a?e.field.scroll({top:0,left:e.field.scrollLeft-16}):l&&e.field.scroll({top:0,left:e.field.scrollLeft+16})},32);function h(t){const s=t.touches?t.touches[0].clientX:t.clientX,r=t.touches?t.touches[0].clientY:t.clientY,o="touch"===t.pointerType?20:5;if(Date.now()<p+500&&Math.abs(u-s)<o&&Math.abs(d-r)<o)return t.preventDefault(),void t.stopPropagation();const c=e.field.getBoundingClientRect();l=s>c.right,a=s<c.left;let h=i;window.PointerEvent?t.isPrimary||(h=e._pathFromPoint(t.clientX,t.clientY,{bias:0})):t.touches&&2===t.touches.length&&(h=e._pathFromPoint(t.touches[1].clientX,t.touches[1].clientY,{bias:0}));const f=e._pathFromPoint(s,r,{bias:s<=u?s===u?0:-1:1});f&&e.mathlist.setRange(h,f,{extendToWordBoundary:n})&&e._requestUpdate(),t.preventDefault(),t.stopPropagation()}const u=t.touches?t.touches[0].clientX:t.clientX,d=t.touches?t.touches[0].clientY:t.clientY,p=Date.now();Cs&&Math.abs(Cs.x-u)<5&&Math.abs(Cs.y-d)<5&&Date.now()<Cs.time+500?(_s+=1,Cs.time=p):(Cs={x:u,y:d,time:p},_s=1);const f=this.field.getBoundingClientRect();if(u>=f.left&&u<=f.right&&d>=f.top&&d<=f.bottom){if(this.$hasFocus()||(r=!0,this.textarea.focus&&this.textarea.focus()),this._resetKeystrokeBuffer(),this.smartModeSuppressed=!1,i=this._pathFromPoint(u,d,{bias:0}),i){let a=document.createElement("div");a.className="ML__scroller",this.element.appendChild(a),a.style.left=f.left-200+"px",a=document.createElement("div"),a.className="ML__scroller",this.element.appendChild(a),a.style.left=f.right+"px",t.shiftKey?(this.mathlist.setRange(this.mathlist.path,i),i=pe.clone(this.mathlist.path),i[i.length-1].offset-=1):this.mathlist.setPath(i,0),r=!0,this.style={},3===t.detail||_s>2?(o(t),3!==t.detail&&3!==_s||this.mathlist.selectAll_()):s||(s=!0,window.PointerEvent?(ms(e.field,"pointermove",h),ms(e.field,"pointerend pointercancel pointerup",o),e.field.setPointerCapture(t.pointerId)):(ms(window,"blur",o),t.touches?(ms(t.target,"touchmove",h),ms(t.target,"touchend",o)):(ms(window,"mousemove",h),ms(window,"mouseup",o))),2!==t.detail&&2!==_s||(n=!0,this.mathlist.selectGroup_()))}}else Cs=null;r&&this._requestUpdate(),t.preventDefault()}_onSelectionDidChange(){this.mathlist.commitCommandStringBeforeInsertionPoint();let t="";this.mathlist.forEachSelected(e=>{t+=e.toLatex()}),t?(this.textarea.value=t,this.$hasFocus()&&this.textarea.select&&this.textarea.select()):(this.textarea.value="",this.textarea.setAttribute("aria-label",""));{const t=this.mode;this.mode=this.mathlist.anchorMode()||this.config.defaultMode,this.mode!==t&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode),"command"===t&&"command"!==this.mode&&(Ke.hidePopover(this),this.mathlist.removeCommandString())}Ke.updatePopoverPosition(this,{deferred:!0}),"function"==typeof this.config.onSelectionDidChange&&this.config.onSelectionDidChange(this)}_onContentDidChange(){this.undoManager.canRedo()?this.element.classList.add("can-redo"):this.element.classList.remove("can-redo"),this.undoManager.canUndo()?this.element.classList.add("can-undo"):this.element.classList.remove("can-undo"),"function"==typeof this.config.onContentDidChange&&this.config.onContentDidChange(this)}_nextAtomSpeechText(t){function e(t,e){return"body"===e.relation?{enclose:"cross out",leftright:"fence",surd:"square root",root:"math field"}[t.type]:{numer:"numerator",denom:"denominator",index:"index",body:"parent",subscript:"subscript",superscript:"superscript"}[e.relation]}const i=t?t.path:[],s=this.mathlist.path,n=s[s.length-1];let r="";for(;i.length>s.length;)r+="out of "+e(t.parent(),i[i.length-1])+"; ",i.pop();if(!this.mathlist.isCollapsed())return ws(this,"",this.mathlist.getSelectedAtoms());const o=e(this.mathlist.parent(),n);0===n.offset&&(r+=(o?"start of "+o:"unknown")+": ");const a=this.mathlist.sibling(Math.max(1,this.mathlist.extent));return a?r+=ws(this,"",a):0!==n.offset&&(r+=o?"end of "+o:"unknown"),r}_announce(t,e,i){"function"==typeof this.config.onAnnounce&&this.config.onAnnounce(this,t,e,i)}_onFocus(){this.blurred&&(this.blurred=!1,this.textarea.focus&&this.textarea.focus(),"onfocus"===this.config.virtualKeyboardMode&&this.showVirtualKeyboard_(),Ke.updatePopoverPosition(this),this.config.onFocus&&this.config.onFocus(this),this._requestUpdate())}_onBlur(){this.blurred||(this.blurred=!0,this.ariaLiveText.textContent="","onfocus"===this.config.virtualKeyboardMode&&this.hideVirtualKeyboard_(),this.complete_({discard:!0}),this._requestUpdate(),this.config.onBlur&&this.config.onBlur(this))}_onResize(){this.element.classList.remove("ML__isNarrowWidth","ML__isWideWidth","ML__isExtendedWidth"),window.innerWidth>=1024?this.element.classList.add("ML__isExtendedWidth"):window.innerWidth>=768?this.element.classList.add("ML__isWideWidth"):this.element.classList.add("ML__isNarrowWidth"),Ke.updatePopoverPosition(this)}toggleKeystrokeCaption_(){this.keystrokeCaptionVisible=!this.keystrokeCaptionVisible,this.keystrokeCaption.innerHTML="",this.keystrokeCaptionVisible||(this.keystrokeCaption.style.visibility="hidden")}_showKeystroke(t){const e=this.keystrokeCaption;if(e&&this.keystrokeCaptionVisible){const i=this.element.getBoundingClientRect();e.style.left=i.left+"px",e.style.top=i.top-64+"px",e.innerHTML="<span>"+(Ce.stringify(t)||t)+"</span>"+e.innerHTML,e.style.visibility="visible",setTimeout((function(){e.childNodes.length>0&&e.removeChild(e.childNodes[e.childNodes.length-1]),0===e.childNodes.length&&(e.style.visibility="hidden")}),3e3)}}$perform(t){if(!t)return!1;let e,i=!1,s=[],n=!1;if(Array.isArray(t)?(e=t[0],s=t.slice(1)):e=t,e=e.replace(/-\w/g,t=>t[1].toUpperCase()),e+="_","function"==typeof this.mathlist[e]){if(/^(delete|transpose|add)/.test(e)&&this._resetKeystrokeBuffer(),/^(delete|transpose|add)/.test(e)&&"command"!==this.mode&&(this.undoManager.pop(),this.undoManager.snapshot(this.config)),this.mathlist[e](...s),/^(delete|transpose|add)/.test(e)&&"command"!==this.mode&&this.undoManager.snapshot(this.config),/^(delete)/.test(e)&&"command"===this.mode){const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=St.suggest(t);0===e.length?Ke.hidePopover(this):Ke.showPopoverWithLatex(this,e[0].match,e.length>1)}n=!0,i=!0}else"function"==typeof this[e]&&(n=this[e](...s),i=!0);return this.mathlist.isCollapsed()&&!/^(transpose|paste|complete|((moveToNextChar|moveToPreviousChar|extend).*))_$/.test(e)||(this._resetKeystrokeBuffer(),this.style={}),n&&this._requestUpdate(),i}performWithFeedback_(t){return this.$focus(),this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(3),"moveToNextPlaceholder"===(t=t.replace(/-\w/g,t=>t[1].toUpperCase()))||"moveToPreviousPlaceholder"===t||"complete"===t?this.returnKeypressSound?(this.returnKeypressSound.load(),this.returnKeypressSound.play().catch(t=>{})):this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>{})):"deletePreviousChar"!==t&&"deleteNextChar"!==t&&"deletePreviousWord"!==t&&"deleteNextWord"!==t&&"deleteToGroupStart"!==t&&"deleteToGroupEnd"!==t&&"deleteToMathFieldStart"!==t&&"deleteToMathFieldEnd"!==t||!this.deleteKeypressSound?this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>{})):(this.deleteKeypressSound.load(),this.deleteKeypressSound.play().catch(t=>{})),this.$perform(t)}convertLastAtomsToText_(t,e){"function"==typeof t&&(e=t,t=1/0),void 0===t&&(t=1/0);let i=0,s=!1;for(this.mathlist.contentWillChange();!s;){const n=this.mathlist.sibling(i);s=0===t||!n||"math"!==n.mode||!(/mord|textord|mpunct/.test(n.type)||"mop"===n.type&&/[a-zA-Z]+/.test(n.body))||n.superscript||n.subscript||e&&!e(n),s||(n.applyStyle({mode:"text"}),n.latex=n.body),i-=1,t-=1}this.mathlist.contentDidChange()}convertLastAtomsToMath_(t,e){"function"==typeof t&&(e=t,t=1/0),void 0===t&&(t=1/0),this.mathlist.contentWillChange();let i=0,s=!1;for(;!s;){const n=this.mathlist.sibling(i);s=0===t||!n||"text"!==n.mode||" "===n.body||e&&!e(n),s||n.applyStyle({mode:"math",type:"mord"}),i-=1,t-=1}this.removeIsolatedSpace_(),this.mathlist.contentDidChange()}removeIsolatedSpace_(){let t=0;for(;this.mathlist.sibling(t)&&"math"===this.mathlist.sibling(t).mode;)t-=1;if(this.mathlist.sibling(t)&&"text"===this.mathlist.sibling(t).mode&&" "===this.mathlist.sibling(t).body&&(!this.mathlist.sibling(t-1)||"math"===this.mathlist.sibling(t-1).mode)){this.mathlist.contentWillChange(),this.mathlist.siblings().splice(t-1,1),this.mathlist.contentDidChange();const e=this.mathlist.suppressChangeNotifications;this.mathlist.suppressChangeNotifications=!0,this.mathlist.setSelection(this.mathlist.anchorOffset()-1),this.mathlist.suppressChangeNotifications=e}}getTextBeforeAnchor_(){let t="",e=0,i=!1;for(;!i;){const s=this.mathlist.sibling(e);i=!(s&&("text"===s.mode&&!s.type||"math"===s.mode&&/mord|textord|mpunct/.test(s.type))),i||(t=s.body+t),e-=1}return t}smartMode_(t,e){if(this.smartModeSuppressed)return!1;if(this.mathlist.endOffset()<this.mathlist.siblings().length-1)return!1;if(!e||e.ctrlKey||e.metaKey)return!1;const i=Ue.eventToChar(e);if(i.length>1)return!1;if(!this.mathlist.isCollapsed())return!("text"!==this.mode||!/[/_^]/.test(i));const s=this.getTextBeforeAnchor_()+i;if("text"===this.mode){if("Esc"===t||/[/\\]/.test(i))return!0;if(/[\^_]/.test(i))return/(^|\s)[a-zA-Z][^_]$/.test(s)&&this.convertLastAtomsToMath_(1),!0;const e={")":"(","}":"{","]":"["}[i];if(e&&this.mathlist.parent()&&"leftright"===this.mathlist.parent().type&&this.mathlist.parent().leftDelim===e)return!0;if(/(^|[^a-zA-Z])(a|I)[ ]$/.test(s))return!1;if(/[$â¬Â£â¤âºÂ¥Â¤à¸¿Â¢â¡â§â¨â¹â©â±]/u.test(i))return!0;if(/(^|[^a-zA-Z'â])[a-zA-Z][ ]$/.test(s))return this.convertLastAtomsToMath_(1),!1;if(/[^0-9]\.[^0-9\s]$/.test(s)){this.convertLastAtomsToMath_(1);const t=this.mathlist.sibling(0);return t.body="â",t.autoFontFamily="cmr",t.latex="\\cdot",!0}if(/(^|\s)[a-zA-Z][^a-zA-Z]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/\.[0-9]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/[(][0-9+\-.]$/.test(s))return this.convertLastAtomsToMath_(1),!0;if(/[(][a-z][,;]$/.test(s))return this.convertLastAtomsToMath_(2),!0;if(/[0-9+\-=><*|]$/.test(i))return this.removeIsolatedSpace_(),!0}else{if("Spacebar"===t)return this.convertLastAtomsToText_(t=>/[a-z][:,;.]$/.test(t.body)),!0;if(/[a-zA-Z]{3,}$/.test(s)&&!/(dxd|abc|xyz|uvw)$/.test(s))return this.convertLastAtomsToText_(t=>/[a-zA-Z:,;.]/.test(t.body)),!0;if(/(^|\W)(if|If)$/i.test(s))return this.convertLastAtomsToText_(1),!0;if(/(\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5){3,}$/u.test(s)&&!/(Î±Î²Î³)$/.test(s))return this.convertLastAtomsToText_(t=>/(:|,|;|.|\u0393|\u0394|\u0398|\u039b|\u039E|\u03A0|\u03A3|\u03a5|\u03a6|\u03a8|\u03a9|[\u03b1-\u03c9]|\u03d1|\u03d5|\u03d6|\u03f1|\u03f5)/u.test(t.body)),!0;if(/\?|\./.test(i))return!0}return!1}_onKeystroke(t,e){if(this._showKeystroke(t),clearTimeout(this.keystrokeBufferResetTimer),this.config.onKeystroke&&!this.config.onKeystroke(this,t,e))return e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1;let i,s,n,r=!1;if("command"!==this.mode&&(!e||!e.ctrlKey&&!e.metaKey)){const t=Ue.eventToChar(e);if("Backspace"!==t)if(!t||t.length>1)this._resetKeystrokeBuffer();else{const e=this.keystrokeBuffer+t;let n=0;for(;!i&&n<e.length;){let t;if(this.keystrokeBufferStates[n]){const e=new Be.EditableMathlist;e.root=te.makeRoot("math",he.parseTokens(o(this.keystrokeBufferStates[n].latex),this.config.default,null,this.config.macros)),e.setPath(this.keystrokeBufferStates[n].selection),t=e.siblings()}else t=this.mathlist.siblings();i=Ce.forString(this.mode,t,e.slice(n),this.config),n+=1}s=n-1,this.keystrokeBuffer+=t,this.keystrokeBufferStates.push(this.undoManager.save()),Ce.startsWithString(e,this.config).length<=1?r=!0:this.config.inlineShortcutTimeout&&(this.keystrokeBufferResetTimer=setTimeout(()=>{this._resetKeystrokeBuffer()},this.config.inlineShortcutTimeout))}}if(this.config.smartMode){const s=this.mode;i?this.mode="math":this.smartMode_(t,e)&&(this.mode={math:"text",text:"math"}[this.mode],n=""),this.mode!==s&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode)}if(i||n||(n=Ce.selectorForKeystroke(this.mode,t)),!i&&!n)return!0;this.mathlist.decorateCommandStringAroundInsertionPoint(!1);const a=this.mathlist.parent();if("moveAfterParent"===n&&a&&"leftright"===a.type&&this.mathlist.endOffset()===this.mathlist.siblings().length-1&&this.config.smartFence&&this.mathlist._insertSmartFence(".")&&(n="",this._requestUpdate()),"math"===this.mode&&"Spacebar"===t&&!i){const t=this.mathlist.sibling(1),e=this.mathlist.sibling(-1);(t&&"text"===t.mode||e&&"text"===e.mode)&&this.mathlist.insert(" ",{mode:"text"})}if((n&&!this.$perform(n)||i)&&i){if(!/^(\\{|\\}|\\[|\\]|\\@|\\#|\\$|\\%|\\^|\\_|\\backslash)$/.test(i)){const t={...this.mathlist.anchorStyle(),...this.style};this.mathlist.insert(Ue.eventToChar(e),{suppressChangeNotifications:!0,mode:this.mode,style:t});const i=this.mode;this.undoManager.snapshotAndCoalesce(this.config),this.undoManager.restore(this.keystrokeBufferStates[s],{...this.config,suppressChangeNotifications:!0}),this.mode=i}this.mathlist.contentWillChange();const t=this.mathlist.suppressChangeNotifications;this.mathlist.suppressChangeNotifications=!0;const n={...this.mathlist.anchorStyle(),...this.style};this.mathlist.insert(i,{format:"latex",mode:this.mode,style:n,smartFence:!0}),this.removeIsolatedSpace_(),i.endsWith(" ")&&(this.mode="text",this.mathlist.insert(" ",{mode:"text",style:n})),this.mathlist.suppressChangeNotifications=t,this.mathlist.contentDidChange(),this.undoManager.snapshot(this.config),this._requestUpdate(),this._announce("replacement"),r&&this._resetKeystrokeBuffer()}return this.scrollIntoView(),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1}_onTypedText(t,e){if((e=e||{}).focus&&this.$focus(),e.feedback&&(this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(3),this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play().catch(t=>{}))),e.commandMode&&"command"!==this.mode&&this.switchMode_("command"),this.mathlist.decorateCommandStringAroundInsertionPoint(!1),e.simulateKeystroke){const e=t.charAt(0),i=Ue.charToEvent(e);if(!this.$keystroke(Ue.keyboardEventToString(i),i))return}let i="",n=!1;if(this.pasteInProgress)this.pasteInProgress=!1,this.mathlist.insert(t,{smartFence:this.config.smartFence,mode:"math"});else{const e={...this.mathlist.anchorStyle(),...this.style},r=s(t);for(const t of r)if("command"===this.mode){this.mathlist.removeSuggestion(),this.suggestionIndex=0;const e=this.mathlist.extractCommandStringAroundInsertionPoint(),s=St.suggest(e+t);n=s.length>1,0===s.length?(this.mathlist.insert(t,{mode:"command"}),/^\\[a-zA-Z\\*]+$/.test(e+t)&&this.mathlist.decorateCommandStringAroundInsertionPoint(!0),Ke.hidePopover(this)):(this.mathlist.insert(t,{mode:"command"}),s[0].match!==e+t&&this.mathlist.insertSuggestion(s[0].match,-s[0].match.length+e.length+1),i=s[0].match)}else if("math"===this.mode){const i={"^":"moveToSuperscript",_:"moveToSubscript"," ":"moveAfterParent"}[t];if(i){if("moveToSuperscript"===i){if(this._superscriptDepth()>=this.config.scriptDepth[1])return void this._announce("plonk")}else if("moveToSubscript"===i&&this._subscriptDepth()>=this.config.scriptDepth[0])return void this._announce("plonk");this.$perform(i)}else this.config.smartSuperscript&&"superscript"===this.mathlist.relation()&&/[0-9]/.test(t)&&0===this.mathlist.siblings().filter(t=>"first"!==t.type).length?(this.mathlist.insert(t,{mode:"math",style:e}),this.mathlist.moveAfterParent_()):this.mathlist.insert(t,{mode:"math",style:e,smartFence:this.config.smartFence})}else"text"===this.mode&&this.mathlist.insert(t,{mode:"text",style:e})}"command"!==this.mode&&this.undoManager.snapshotAndCoalesce(this.config),this._requestUpdate(),this.scrollIntoView(),Ke.showPopoverWithLatex(this,i,n)}_hash(){let t=0;const e=this.mathlist.root.toLatex(!1);for(let i=0;i<e.length;i++)t=31*t+e.charCodeAt(i),t|=0;return Math.abs(t)}_requestUpdate(){this.dirty||(this.dirty=!0,requestAnimationFrame(t=>vs(this)&&this._render()))}_render(t){t=t||{},this.dirty=!1,window.mathlive||(window.mathlive={}),this.mathlist.anchor()||(this.mathlist.path=[{relation:"body",offset:0}]),this.mathlist.forEach(t=>{t.caret="",t.isSelected=!1});const e=this.$hasFocus();this.mathlist.isCollapsed()?this.mathlist.anchor().caret=e?this.mode:"":this.mathlist.forEachSelected(t=>{t.isSelected=!0});const i=te.decompose({mathstyle:"displaystyle",generateID:{seed:this._hash(),groupNumbers:t.forHighlighting},macros:this.config.macros},this.mathlist.root),s=q.makeSpan(i,"ML__base");s.attributes={translate:"no","aria-hidden":"true"};const n=q.makeSpan("","ML__strut");n.setStyle("height",s.height,"em");const r=[n];if(0!==s.depth){const t=q.makeSpan("","ML__strut--bottom");t.setStyle("height",s.height+s.depth,"em"),t.setStyle("vertical-align",-s.depth,"em"),r.push(t)}r.push(s);const o=q.makeSpan(r,"ML__mathlive");this.field.innerHTML=o.toMarkup(0,this.config.horizontalSpacingScale),this.field.classList.toggle("ML__focused",e),this.accessibleNode.innerHTML="<math xmlns='http://www.w3.org/1998/Math/MathML'>"+te.toMathML(this.mathlist.root,this.config)+"</math>";const a=this._getSelectionBounds();if(a){const t=document.createElement("div");t.classList.add("ML__selection"),t.style.position="absolute",t.style.left=a.left+"px",t.style.top=a.top+"px",t.style.width=Math.ceil(a.right-a.left)+"px",t.style.height=Math.ceil(a.bottom-a.top-1)+"px",this.field.insertBefore(t,this.field.childNodes[0])}}_onPaste(){return this.pasteInProgress=!0,!0}_onCut(){return setTimeout((function(){this.$clearSelection(),this._requestUpdate()}).bind(this),0),!0}_onCopy(t){this.mathlist.isCollapsed()?(t.clipboardData.setData("text/plain",this.$text("latex-expanded")),t.clipboardData.setData("application/json",this.$text("json")),t.clipboardData.setData("application/xml",this.$text("mathML"))):(t.clipboardData.setData("text/plain",this.$selectedText("latex-expanded")),t.clipboardData.setData("application/json",this.$selectedText("json")),t.clipboardData.setData("application/xml",this.$selectedText("mathML"))),t.preventDefault()}formatMathlist(t,e){let i="";if("latex"===(e=e||"latex")||"latex-expanded"===e)i=t.toLatex("latex-expanded"===e);else if("mathML"===e)i=t.toMathML(this.config);else if("spoken"===e)i=te.toSpeakableText(t,this.config);else if("spoken-text"===e){const e=this.config.textToSpeechMarkup;this.config.textToSpeechMarkup="",i=te.toSpeakableText(t,this.config),this.config.textToSpeechMarkup=e}else if("spoken-ssml"===e||"spoken-ssml-withHighlighting"===e){const s=this.config.textToSpeechMarkup,n=this.config.generateID;this.config.textToSpeechMarkup="ssml","spoken-ssml-withHighlighting"===e&&(this.config.generateID=!0),i=te.toSpeakableText(t,this.config),this.config.textToSpeechMarkup=s,this.config.generateID=n}else if("json"===e){const e=te.toAST(t,this.config);i=JSON.stringify(e)}else"ASCIIMath"===e&&(i=function t(e,i){if(!e)return"";if(Array.isArray(e)){let i="";if(0===e.length)return"";if("first"===e[0].type&&e.shift(),"text"===e[0].mode){let s=0;for(i='"';e[s]&&"text"===e[s].mode;)i+=e[s].body,s++;i+='"'+t(e.slice(s))}else{let s=0;for(;e[s]&&"math"===e[s].mode;)i+=t(e[s]),s++;i+=t(e.slice(s))}return i.trim()}let s="";const n=e.latex?e.latex.trim():null;let r;switch(e.type){case"group":case"root":s=t(e.body);break;case"array":break;case"genfrac":(e.leftDelim||e.rightDelim)&&(s+="."!==e.leftDelim&&e.leftDelim?e.leftDelim:"{:"),e.hasBarLine?(s+="(",s+=t(e.numer),s+=")/(",s+=t(e.denom),s+=")"):(s+="("+t(e.numer)+"),",s+="("+t(e.denom)+")"),(e.leftDelim||e.rightDelim)&&(s+="."!==e.rightDelim&&e.rightDelim?e.rightDelim:"{:");break;case"surd":s+=e.index?"root("+t(e.index)+")("+t(e.body)+")":"sqrt("+t(e.body)+")";break;case"leftright":s+="."!==e.leftDelim&&e.leftDelim?e.leftDelim:"{:",s+=t(e.body),s+="."!==e.rightDelim&&e.rightDelim?e.rightDelim:"{:";break;case"sizeddelim":case"delim":case"accent":break;case"line":case"overlap":case"overunder":break;case"mord":s=hi[n]||n||("string"==typeof e.body?e.body:""),"\\"===s[0]&&(s+=""),r=n?n.match(/[{]?\\char"([0-9abcdefABCDEF]*)[}]?/):null,r?s=String.fromCharCode(parseInt("0x"+r[1])):s.length>0&&"\\"===s.charAt(0)&&(s="string"==typeof e.body?e.body.charAt(0):e.latex);break;case"mbin":case"mrel":case"textord":case"minner":s=n&&hi[n]?hi[n]:n&&ui[n]?ui[n]:e.body;break;case"mopen":case"mclose":s+=e.body;break;case"mpunct":s=ui[n]||n;break;case"mop":"â"!==e.body&&(s="",s+="\\operatorname"===n?e.body:e.body||n,s+=" ");break;case"mathstyle":case"box":case"spacing":case"enclose":break;case"space":s=" "}if(e.subscript){s+="_";const i=t(e.subscript);i.length>1&&!/^(-)?\d+(\.\d*)?$/.test(i)?s+="("+i+")":s+=i}if(e.superscript){s+="^";const i=t(e.superscript);i.length>1&&!/^(-)?\d+(\.\d*)?$/.test(i)?s+="("+i+")":s+=i}return s}(t));return i}$text(t){return this.formatMathlist(this.mathlist.root,t)}$selectedText(t){const e=this.mathlist.getSelectedAtoms();if(!e)return"";const i=te.makeRoot("math",e);return this.formatMathlist(i,t)}$selectionIsCollapsed(){return this.mathlist.isCollapsed()}$selectionDepth(){return this.mathlist.path.length}_superscriptDepth(){let t=0,e=0,i=this.mathlist.ancestor(e),s=!1;for(;i;)(i.superscript||i.subscript)&&(t+=1),i.superscript?s=!0:i.subscript&&(s=!1),e+=1,i=this.mathlist.ancestor(e);return s?t:0}_subscriptDepth(){let t=0,e=0,i=this.mathlist.ancestor(e),s=!1;for(;i;)(i.superscript||i.subscript)&&(t+=1),i.superscript?s=!1:i.subscript&&(s=!0),e+=1,i=this.mathlist.ancestor(e);return s?t:0}$selectionAtStart(){return 0===this.mathlist.startOffset()}$selectionAtEnd(){return this.mathlist.endOffset()>=this.mathlist.siblings().length-1}groupIsSelected(){return 0===this.mathlist.startOffset()&&this.mathlist.endOffset()>=this.mathlist.siblings().length-1}$latex(t,e){return t?(t!==this.mathlist.root.toLatex()&&(e=e||{},this.mathlist.insert(t,Object.assign({},this.config,{insertionMode:"replaceAll",selectionMode:"after",format:"latex",mode:"math",suppressChangeNotifications:e.suppressChangeNotifications})),this.undoManager.snapshot(this.config),this._requestUpdate()),t):this.mathlist.root.toLatex()}$el(){return this.element}undo(){return this.complete_(),this.undoManager.undo(this.config),!0}redo(){return this.complete_(),this.undoManager.redo(this.config),!0}scrollIntoView(){this.dirty&&this._render();let t=this._getCaretPosition();const e=this.field.getBoundingClientRect();if(!t){const i=this._getSelectionBounds();i&&(t={x:i.right+e.left-this.field.scrollLeft,y:i.top+e.top-this.field.scrollTop})}if(t){const i=t.x-window.scrollX;i<e.left?this.field.scroll({top:0,left:i-e.left+this.field.scrollLeft-20,behavior:"smooth"}):i>e.right&&this.field.scroll({top:0,left:i-e.right+this.field.scrollLeft+20,behavior:"smooth"})}}scrollToStart(){this.field.scroll(0,0)}scrollToEnd(){const t=this.field.getBoundingClientRect();this.field.scroll(t.left-window.scrollX,0)}enterCommandMode_(){this.switchMode_("command")}copyToClipboard_(){return this.$focus(),this.mathlist.isCollapsed()&&this.$select(),document.execCommand("copy"),!1}cutToClipboard_(){return this.$focus(),document.execCommand("cut"),!0}pasteFromClipboard_(){return this.$focus(),document.execCommand("paste"),!0}$insert(t,e){if("string"==typeof t&&t.length>0){if((e=e||{}).focus&&this.$focus(),e.feedback&&(this.config.keypressVibration&&navigator.vibrate&&navigator.vibrate(3),this.keypressSound&&(this.keypressSound.load(),this.keypressSound.play())),"\\\\"===t)this.mathlist.addRowAfter_();else if("&"===t)this.mathlist.addColumnAfter_();else{const i=this.style;this.mathlist.insert(t,{mode:this.mode,style:this.mathlist.anchorStyle(),...e}),e.resetStyle&&(this.style=i)}return this.undoManager.snapshot(this.config),this._requestUpdate(),!0}return!1}switchMode_(t,e,i){this._resetKeystrokeBuffer(),this.smartModeSuppressed=/text|math/.test(this.mode)&&/text|math/.test(t),e&&this.$insert(e,{format:"latex",mode:{math:"text",text:"math"}[t]}),this.mathlist.decorateCommandStringAroundInsertionPoint(!1),"command"===t?(this.mathlist.removeSuggestion(),Ke.hidePopover(this),this.suggestionIndex=0,this.virtualKeyboardVisible&&this.switchKeyboardLayer_("lower-command"),this.mathlist.insert("",{mode:"math"})):this.mode=t,i&&this.$insert(i,{format:"latex",mode:t}),"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode),this._requestUpdate()}complete_(t){if(t=t||{},Ke.hidePopover(this),t.discard)return this.mathlist.spliceCommandStringAroundInsertionPoint(null),this.switchMode_("math"),!0;const e=this.mathlist.extractCommandStringAroundInsertionPoint(!t.acceptSuggestion);if(e){if("\\("===e||"\\)"===e)this.mathlist.spliceCommandStringAroundInsertionPoint([]),this.mathlist.insert(e.slice(1),{mode:this.mode});else{const t="math";if(St.commandAllowed(t,e)){const i=he.parseTokens(o(e),t,null,this.config.macros);this.mathlist.spliceCommandStringAroundInsertionPoint(i)}else{const i=he.parseTokens(o(e),t,null,this.config.macros);i?this.mathlist.spliceCommandStringAroundInsertionPoint(i):this.mathlist.decorateCommandStringAroundInsertionPoint(!0)}}return this.undoManager.snapshot(this.config),this._announce("replacement"),!0}return!1}_updateSuggestion(){this.mathlist.positionInsertionPointAfterCommitedCommand(),this.mathlist.removeSuggestion();const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=St.suggest(t);if(0===e.length)Ke.hidePopover(this),this.mathlist.decorateCommandStringAroundInsertionPoint(!0);else{const i=this.suggestionIndex%e.length,s=t.length-e[i].match.length;0!==s&&this.mathlist.insertSuggestion(e[i].match,s),Ke.showPopoverWithLatex(this,e[i].match,e.length>1)}this._requestUpdate()}nextSuggestion_(){return this.suggestionIndex+=1,this._updateSuggestion(),!1}previousSuggestion_(){if(this.suggestionIndex-=1,this.suggestionIndex<0){this.mathlist.removeSuggestion();const t=this.mathlist.extractCommandStringAroundInsertionPoint(),e=St.suggest(t);this.suggestionIndex=e.length-1}return this._updateSuggestion(),!1}_attachButtonHandlers(t,e){const i=this;let s,n,r,o,a;"object"==typeof e&&(e.default||e.pressed)?(e.default&&t.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e.default)),e.alt&&t.setAttribute("data-"+this.config.namespace+"command-alt",JSON.stringify(e.alt)),e.altshift&&t.setAttribute("data-"+this.config.namespace+"command-altshift",JSON.stringify(e.altshift)),e.shift&&t.setAttribute("data-"+this.config.namespace+"command-shift",JSON.stringify(e.shift)),e.pressed&&t.setAttribute("data-"+this.config.namespace+"command-pressed",JSON.stringify(e.pressed)),e.pressAndHoldStart&&t.setAttribute("data-"+this.config.namespace+"command-pressAndHoldStart",JSON.stringify(e.pressAndHoldStart)),e.pressAndHoldEnd&&t.setAttribute("data-"+this.config.namespace+"command-pressAndHoldEnd",JSON.stringify(e.pressAndHoldEnd))):t.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e)),ms(t,"mousedown touchstart:passive",(function(e){if("mousedown"!==e.type||1===e.buttons){e.stopPropagation(),e.preventDefault(),t.classList.add("pressed"),s=Date.now(),"touchstart"===e.type&&(r=e.changedTouches[0].identifier);const o=t.getAttribute("data-"+i.config.namespace+"command-pressed");o&&i.$perform(JSON.parse(o));const l=t.getAttribute("data-"+i.config.namespace+"command-pressAndHoldStart");l&&(n=t,a&&clearTimeout(a),a=window.setTimeout((function(){t.classList.contains("pressed")&&i.$perform(JSON.parse(l))}),300))}})),ms(t,"mouseleave touchcancel",(function(){t.classList.remove("pressed")})),ms(t,"touchmove:passive",(function(t){t.preventDefault();for(let e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].identifier===r){const i=document.elementFromPoint(t.changedTouches[e].clientX,t.changedTouches[e].clientY);i!==o&&o&&(o.dispatchEvent(new MouseEvent("mouseleave"),{bubbles:!0}),o=null),i&&(o=i,i.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,buttons:1})))}})),ms(t,"mouseenter",(function(e){1===e.buttons&&t.classList.add("pressed")})),ms(t,"mouseup touchend click",(function(e){if(o){e.stopPropagation(),e.preventDefault();const t=o;return o=null,void t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0}))}if(t.classList.remove("pressed"),t.classList.add("active"),"click"===e.type&&0!==e.detail)return e.stopPropagation(),void e.preventDefault();window.setTimeout((function(){t.classList.remove("active")}),150);let r=t.getAttribute("data-"+i.config.namespace+"command-pressAndHoldEnd");const a=Date.now();(t!==n||a<s+300)&&(r=void 0),!r&&e.altKey&&e.shiftKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-altshift")),!r&&e.altKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-alt")),!r&&e.shiftKey&&(r=t.getAttribute("data-"+i.config.namespace+"command-shift")),r||(r=t.getAttribute("data-"+i.config.namespace+"command")),r&&i.$perform(JSON.parse(r)),e.stopPropagation(),e.preventDefault()}))}_makeButton(t,e,i,s){const n=document.createElement("span");return n.innerHTML=t,e&&n.classList.add([].slice.call(e.split(" "))),i&&n.setAttribute("aria-label",i),this._attachButtonHandlers(n,s),n}showAlternateKeys_(t,e){const i=bs("mathlive-alternate-keys-panel","ML__keyboard alternate-keys");this.virtualKeyboard.classList.contains("material")&&i.classList.add("material"),i.style.width=e.length>=7?"286px":4===e.length||2===e.length?"146px":1===e.length?"86px":"146px",i.style.height="auto";let s="";for(const r of e)s+="<li","string"==typeof r?s+=' data-latex="'+r.replace(/"/g,"&quot;")+'"':(r.latex&&(s+=' data-latex="'+r.latex.replace(/"/g,"&quot;")+'"'),r.content&&(s+=' data-content="'+r.content.replace(/"/g,"&quot;")+'"'),r.insert&&(s+=' data-insert="'+r.insert.replace(/"/g,"&quot;")+'"'),r.command&&(s+=" data-command='"+r.command.replace(/"/g,"&quot;")+"'"),r.aside&&(s+=' data-aside="'+r.aside.replace(/"/g,"&quot;")+'"'),r.classes&&(s+=' data-classes="'+r.classes+'"')),s+=">",s+=r.label||"",s+="</li>";s="<ul>"+s+"</ul>",i.innerHTML=s,ci.makeKeycap(this,i.getElementsByTagName("li"),"performAlternateKeys");const n=this.virtualKeyboard.querySelector('div.keyboard-layer.is-visible div.rows ul li[data-alt-keys="'+t+'"]').getBoundingClientRect();if(n){n.top-i.clientHeight<0&&(i.style.width="auto",i.style.height=e.length<=6?"56px":e.length<=12?"108px":"205px");const t=(n.top-i.clientHeight+5).toString()+"px",s=Math.max(0,Math.min(window.innerWidth-i.offsetWidth,(n.left+n.right-i.offsetWidth)/2))+"px";i.style.transform="translate("+s+","+t+")",i.classList.add("is-visible")}return!1}hideAlternateKeys_(){const t=document.getElementById("mathlive-alternate-keys-panel");return t&&(t.classList.remove("is-visible"),t.innerHTML="",ys(t)),!1}performAlternateKeys_(t){return this.hideAlternateKeys_(),this.$perform(t)}switchKeyboardLayer_(t){if("off"!==this.config.virtualKeyboardMode){"lower-command"!==t&&"upper-command"!==t&&"symbols-command"!==t&&this.complete_(),this.showVirtualKeyboard_(),this.hideAlternateKeys_(),this.unshiftKeyboardLayer_();const e=this.virtualKeyboard.getElementsByClassName("keyboard-layer");let i=!1;for(let s=0;s<e.length;s++)if(e[s].dataset.layer===t){i=!0;break}if(i)for(let s=0;s<e.length;s++)e[s].dataset.layer===t?e[s].classList.add("is-visible"):e[s].classList.remove("is-visible");this.$focus()}return!0}shiftKeyboardLayer_(){const t=this.virtualKeyboard.querySelectorAll("div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action");if(t)for(let e=0;e<t.length;e++){const i=t[e];let s=i.getAttribute("data-shifted");if(s||/^[a-z]$/.test(i.innerHTML)){i.setAttribute("data-unshifted-content",i.innerHTML),s||(s=i.innerHTML.toUpperCase()),i.innerHTML=s;const t=i.getAttribute("data-"+this.config.namespace+"command");if(t){i.setAttribute("data-unshifted-command",t);const e=i.getAttribute("data-shifted-command");if(e)i.setAttribute("data-"+this.config.namespace+"command",e);else{const e=JSON.parse(t);Array.isArray(e)&&(e[1]=e[1].toUpperCase()),i.setAttribute("data-"+this.config.namespace+"command",JSON.stringify(e))}}}}return!1}unshiftKeyboardLayer_(){const t=this.virtualKeyboard.querySelectorAll("div.keyboard-layer.is-visible .rows .keycap, div.keyboard-layer.is-visible .rows .action");if(t)for(let e=0;e<t.length;e++){const i=t[e],s=i.getAttribute("data-unshifted-content");s&&(i.innerHTML=s);const n=i.getAttribute("data-unshifted-command");n&&i.setAttribute("data-"+this.config.namespace+"command",n)}return!1}insertAndUnshiftKeyboardLayer_(t){return this.$insert(t),this.unshiftKeyboardLayer_(),!0}toggleVirtualKeyboardAlt_(){let t=!1;return this.virtualKeyboard&&(t=this.virtualKeyboard.classList.contains("material"),this.virtualKeyboard.remove(),delete this.virtualKeyboard,this.virtualKeyboard=null),this.showVirtualKeyboard_(t?"":"material"),!1}toggleVirtualKeyboardShift_(){this.config.virtualKeyboardLayout={qwerty:"azerty",azerty:"qwertz",qwertz:"dvorak",dvorak:"colemak",colemak:"qwerty"}[this.config.virtualKeyboardLayout];let t=this.virtualKeyboard?this.virtualKeyboard.querySelector("div.keyboard-layer.is-visible"):null;return t=t?t.id:"",this.virtualKeyboard&&(this.virtualKeyboard.remove(),delete this.virtualKeyboard,this.virtualKeyboard=null),this.showVirtualKeyboard_(),t&&this.switchKeyboardLayer_(t),!1}showVirtualKeyboard_(t){return this.virtualKeyboardVisible=!1,this.toggleVirtualKeyboard_(t),!1}hideVirtualKeyboard_(){return this.virtualKeyboardVisible=!0,this.toggleVirtualKeyboard_(),!1}toggleVirtualKeyboard_(t){if(this.virtualKeyboardVisible=!this.virtualKeyboardVisible,this.virtualKeyboardVisible){this.virtualKeyboard?this.virtualKeyboard.classList.add("is-visible"):(this.virtualKeyboard=ci.make(this,t),ms(this.virtualKeyboard,"touchstart:passive mousedown",(function(){e.$focus()})),document.body.appendChild(this.virtualKeyboard));const e=this;window.setTimeout((function(){e.virtualKeyboard.classList.add("is-visible")}),1)}else this.virtualKeyboard&&this.virtualKeyboard.classList.remove("is-visible");return"function"==typeof this.config.onVirtualKeyboardToggle&&this.config.onVirtualKeyboardToggle(this,this.virtualKeyboardVisible,this.virtualKeyboard),!1}$applyStyle(t){if(this._resetKeystrokeBuffer(),(t=function(t){const e={};return"string"==typeof t.mode&&(e.mode=t.mode.toLowerCase()),"string"==typeof t.color&&(e.color=t.color),"string"==typeof t.backgroundColor&&(e.backgroundColor=t.backgroundColor),"string"==typeof t.fontFamily&&(e.fontFamily=t.fontFamily),"string"==typeof t.series&&(e.fontSeries=t.series),"string"==typeof t.fontSeries&&(e.fontSeries=t.fontSeries.toLowerCase()),e.fontSeries&&(e.fontSeries={bold:"b",medium:"m",normal:"mn"}[e.fontSeries]||e.fontSeries),"string"==typeof t.shape&&(e.fontShape=t.shape),"string"==typeof t.fontShape&&(e.fontShape=t.fontShape.toLowerCase()),e.fontShape&&(e.fontShape={italic:"it",up:"n",upright:"n",normal:"n"}[e.fontShape]||e.fontShape),"string"==typeof t.size?e.fontSize=t.size:"number"==typeof t.size&&(e.fontSize="size"+Math.min(0,Math.max(10,t.size))),"string"==typeof t.fontSize&&(e.fontSize=t.fontSize.toLowerCase()),e.fontSize&&(e.fontSize={tiny:"size1",scriptsize:"size2",footnotesize:"size3",small:"size4",normal:"size5",normalsize:"size5",large:"size6",Large:"size7",LARGE:"size8",huge:"size9",Huge:"size10"}[e.fontSize]||e.fontSize),e}(t)).mode){if(this.mathlist.isCollapsed())this.switchMode_(t.mode);else{const t=this.mode,e="math"===(this.mathlist.anchorMode()||this.config.default)?"text":"math";let i=this.$selectedText("ASCIIMath");if("math"===e&&/^"[^"]+"$/.test(i)&&(i=i.slice(1,-1)),this.$insert(i,{mode:e,selectionMode:"item",format:"text"===e?"text":"ASCIIMath"}),this.mode=e,this.groupIsSelected()){const t=this.mathlist.parent();!t||"group"!==t.type&&"root"!==t.type||(t.mode=e)}this.mode!==t&&"function"==typeof this.config.onModeChange&&this.config.onModeChange(this,this.mode)}delete t.mode}return this.mathlist.isCollapsed()?(this.style.fontSeries&&t.fontSeries===this.style.fontSeries&&(t.fontSeries="auto"),t.fontShape&&t.fontShape===this.style.fontShape&&(t.fontShape="auto"),t.color&&t.color===this.style.color&&(t.color="none"),t.backgroundColor&&t.backgroundColor===this.style.backgroundColor&&(t.backgroundColor="none"),t.fontSize&&t.fontSize===this.style.fontSize&&(t.fontSize="auto"),this.style={...this.style,...t}):(this.mathlist._applyStyle(t),this.undoManager.snapshot(this.config)),!0}$hasFocus(){return document.hasFocus()&&document.activeElement===this.textarea}$focus(){this.$hasFocus()||(this.textarea.focus&&this.textarea.focus(),this._announce("line"))}$blur(){this.$hasFocus()&&this.textarea.blur&&this.textarea.blur()}$select(){this.mathlist.selectAll_()}$clearSelection(){this.mathlist.delete_()}$keystroke(t,e){return this._onKeystroke(t,e)}$typedText(t){this._onTypedText(t)}typedText_(t,e){return this._onTypedText(t,e)}$setConfig(t){if(this.config||(this.config={smartFence:!0,smartSuperscript:!0,scriptDepth:[1/0,1/0],removeExtraneousParentheses:!0,overrideDefaultInlineShortcuts:!1,virtualKeyboard:"",virtualKeyboardLayout:"qwerty",namespace:""}),this.config={...this.config,...t},void 0!==this.config.scriptDepth&&!Array.isArray(this.config.scriptDepth)){const t=parseInt(this.config.scriptDepth);this.config.scriptDepth=[t,t]}if(void 0===this.config.removeExtraneousParentheses&&(this.config.removeExtraneousParentheses=!0),this.config.onAnnounce=t.onAnnounce||Ss,this.config.macros=Object.assign({},St.MACROS,this.config.macros),!/^[a-z]*[-]?$/.test(this.config.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(this.config.namespace)||(this.config.namespace+="-"),Ze.locale=this.config.locale||Ze.locale,Ze.merge(this.config.strings),this.config.virtualKeyboardLayout=t.virtualKeyboardLayout||{fr:"azerty",be:"azerty",al:"qwertz",ba:"qwertz",cz:"qwertz",de:"qwertz",hu:"qwertz",sk:"qwertz",ch:"qwertz"}[Ze.locale.substring(0,2)]||"qwerty",this.keypressSound=void 0,this.spacebarKeypressSound=void 0,this.returnKeypressSound=void 0,this.deleteKeypressSound=void 0,this.config.keypressSound&&("string"==typeof this.config.keypressSound?(this.keypressSound=new Audio,this.keypressSound.preload="none",this.keypressSound.src=this.config.keypressSound,this.keypressSound.volume=.5,this.spacebarKeypressSound=this.keypressSound,this.returnKeypressSound=this.keypressSound,this.deleteKeypressSound=this.keypressSound):(this.keypressSound=new Audio,this.keypressSound.preload="none",this.keypressSound.src=this.config.keypressSound.default,this.keypressSound.volume=.5,this.spacebarKeypressSound=this.keypressSound,this.returnKeypressSound=this.keypressSound,this.deleteKeypressSound=this.keypressSound,this.config.keypressSound.spacebar&&(this.spacebarKeypressSound=new Audio,this.spacebarKeypressSound.preload="none",this.spacebarKeypressSound.src=this.config.keypressSound.spacebar,this.spacebarKeypressSound.volume=.5),this.config.keypressSound.return&&(this.returnKeypressSound=new Audio,this.returnKeypressSound.preload="none",this.returnKeypressSound.src=this.config.keypressSound.return,this.returnKeypressSound.volume=.5),this.config.keypressSound.delete&&(this.deleteKeypressSound=new Audio,this.deleteKeypressSound.preload="none",this.deleteKeypressSound.src=this.config.keypressSound.delete,this.deleteKeypressSound.volume=.5))),this.config.plonkSound&&(this.plonkSound=new Audio,this.plonkSound.preload="none",this.plonkSound.src=this.config.plonkSound,this.plonkSound.volume=.5)}speak_(t,e){e=e||{withHighlighting:!1};const i=function(t,e){let i=null;switch(e){case"all":i=t.mathlist.root;break;case"selection":t.mathlist.isCollapsed()||(i=t.mathlist.getSelectedAtoms());break;case"left":{const e=t.mathlist.siblings(),s=t.mathlist.startOffset();if(s>=1){i=[];for(let t=1;t<=s;t++)i.push(e[t])}break}case"right":{const e=t.mathlist.siblings(),s=t.mathlist.endOffset()+1;if(s<=e.length-1){i=[];for(let t=s;t<=e.length-1;t++)i.push(e[t])}break}case"start":case"end":break;case"group":i=t.mathlist.siblings();break;case"parent":{const e=t.mathlist.parent();e&&"root"!==e.type&&(i=t.mathlist.parent());break}}return i}(this,t);if(null===i)return this.config.handleSpeak(function(t){let e="";switch(t){case"all":break;case"selection":e="no selection";break;case"left":e="at start";break;case"right":e="at end";break;case"group":break;case"parent":e="no parent"}return e}(t)),!1;const s={...this.config};(e.withHighlighting||"amazon"===s.speechEngine)&&(s.textToSpeechMarkup=window.sre&&"sre"===s.textToSpeechRules?"ssml_step":"ssml",e.withHighlighting&&(s.generateID=!0));const n=te.toSpeakableText(i,s);return e.withHighlighting?(window.mathlive.readAloudMathField=this,this._render({forHighlighting:!0}),this.config.handleReadAloud&&this.config.handleReadAloud(this.field,n,this.config)):this.config.handleSpeak&&this.config.handleSpeak(n,s),!1}}let Cs,_s=0;function ws(t,e,i){const s=Object.assign({},t.config);return s.textToSpeechMarkup="",s.textToSpeechRulesOptions=s.textToSpeechRulesOptions||{},s.textToSpeechRulesOptions.markup="none",e+te.toSpeakableText(i,s)}function Ss(t,e,i,s){let n="";"plonk"===e?(t.plonkSound&&(t.plonkSound.load(),t.plonkSound.play().catch(t=>{})),t._resetKeystrokeBuffer()):"delete"===e?n=ws(t,"deleted: ",s):"focus"===e||/move/.test(e)?n=(t.mathlist.isCollapsed()?"":"selected: ")+t._nextAtomSpeechText(i):"replacement"===e?n=ws(t,"",t.mathlist.sibling(0)):"line"===e?(n=ws(t,"",t.mathlist.root),t.accessibleNode.innerHTML='<math xmlns="http://www.w3.org/1998/Math/MathML">'+te.toMathML(t.mathlist.root,t.config)+"</math>",t.textarea.setAttribute("aria-label","after: "+n)):n=s?ws(t,e+" ",s):e;const r=/\u00a0/.test(t.ariaLiveText.textContent)?" â¯ ":" Â  ";t.ariaLiveText.textContent=n+r}xs.prototype.undo_=xs.prototype.undo,xs.prototype.redo_=xs.prototype.redo,xs.prototype.scrollIntoView_=xs.prototype.scrollIntoView,xs.prototype.scrollToStart_=xs.prototype.scrollToStart,xs.prototype.scrollToEnd_=xs.prototype.scrollToEnd,xs.prototype.insert_=xs.prototype.$insert;var Ps={isValidMathfield:vs,MathField:xs};function ks(t,e,i){let s=i,n=0;const r=t.length;for(;s<e.length;){const i=e[s];if(n<=0&&e.slice(s,s+r)===t)return s;"\\"===i?s++:"{"===i?n++:"}"===i&&n--,s++}return-1}function Es(t,e,i,s){const n=[];for(let r=0;r<t.length;r++)if("text"===t[r].type){const o=t[r].data;let a,l=!0,c=0;a=o.indexOf(e),-1!==a&&(c=a,c>0&&n.push({type:"text",data:o.slice(0,c)}),l=!1);let h=!1;for(;!h;){if(l){if(a=o.indexOf(e,c),-1===a){h=!0;break}c!==a&&n.push({type:"text",data:o.slice(c,a)}),c=a}else{if(a=ks(i,o,c+e.length),-1===a){h=!0;break}n.push({type:"math",data:o.slice(c+e.length,a),rawData:o.slice(c,a+i.length),mathstyle:s}),c=a+i.length}l=!l}c<o.length&&n.push({type:"text",data:o.slice(c)})}else n.push(t[r]);return n}function Ts(t,e){let i=[{type:"text",data:t}];for(let s=0;s<e.inline.length;s++){const t=e.inline[s];i=Es(i,t[0],t[1],"textstyle")}for(let s=0;s<e.display.length;s++){const t=e.display[s];i=Es(i,t[0],t[1],"displaystyle")}return i}function As(t,e,i,s){const n=function(t,e,i,s){let n=document.createElement("span");n.setAttribute("aria-hidden","true"),e.preserveOriginalContent&&(n.setAttribute("data-"+e.namespace+"original-content",t),i&&n.setAttribute("data-"+e.namespace+"original-mathstyle",i));try{n.innerHTML=e.renderToMarkup(t,i||"displaystyle","html",e.macros)}catch(e){if(!s)return null;n=document.createTextNode(t)}return n}(t,i,e,s);if(n&&/\b(mathml|speakable-text)\b/i.test(i.renderAccessibleContent)){const e=document.createDocumentFragment();if(/\bmathml\b/i.test(i.renderAccessibleContent)&&i.renderToMathML&&e.appendChild(function(t,e){const i=document.createElement("span");try{i.innerHTML="<math xmlns='http://www.w3.org/1998/Math/MathML'>"+e.renderToMathML(t,e)+"</math>"}catch(e){i.textContent=t}return i.className="sr-only",i}(t,i)),/\bspeakable-text\b/i.test(i.renderAccessibleContent)&&i.renderToSpeakableText){const s=document.createElement("span");s.innerHTML=i.renderToSpeakableText(t,i),s.className="sr-only",e.appendChild(s)}return e.appendChild(n),e}return n}function Os(t,e){let i=null;if(e.TeX.processEnvironments&&/^\s*\\begin/.test(t))i=document.createDocumentFragment(),i.appendChild(As(t,void 0,e,!0));else{const s=Ts(t,e.TeX.delimiters);if(1===s.length&&"text"===s[0].type)return null;i=document.createDocumentFragment();for(let t=0;t<s.length;t++)i.appendChild("text"===s[t].type?document.createTextNode(s[t].data):As(s[t].data,s[t].mathstyle,e,!0))}return i}const Ms={namespace:"",skipTags:["noscript","style","textarea","pre","code","annotation","annotation-xml"],processScriptType:"math/tex",ignoreClass:"tex2jax_ignore",processClass:"tex2jax_process",preserveOriginalContent:!0,renderAccessibleContent:"mathml",TeX:{disabled:!1,processEnvironments:!0,delimiters:{inline:[["\\(","\\)"]],display:[["$$","$$"],["\\[","\\]"]]}}};var Ns={renderMathInElement:function(t,e){try{if((e=Object.assign({},Ms,e)).ignoreClassPattern=new RegExp(e.ignoreClass),e.processClassPattern=new RegExp(e.processClass),e.processScriptTypePattern=new RegExp(e.processScriptType),e.macros=St.MACROS,e.namespace){if(!/^[a-z]+[-]?$/.test(e.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(e.namespace)||(e.namespace+="-")}!function t(e,i){const s=e.getAttribute("data-"+i.namespace+"original-content");if(s){const t=As(s,e.getAttribute("data-"+i.namespace+"mathstyle"),i,!1);null!=t&&(e.textContent="",e.appendChild(t))}else{if(1===e.childNodes.length&&3===e.childNodes[0].nodeType){const t=e.childNodes[0].textContent;if(i.TeX.processEnvironments&&/^\s*\\begin/.test(t))return e.textContent="",void e.appendChild(As(t,void 0,i,!0));const s=Ts(t,i.TeX.delimiters);if(1===s.length&&"math"===s[0].type)return e.textContent="",void e.appendChild(As(s[0].data,s[0].mathstyle,i,!0));if(1===s.length&&"text"===s[0].type)return}for(let s=0;s<e.childNodes.length;s++){const n=e.childNodes[s];if(3===n.nodeType){const t=Os(n.textContent,i);t&&(s+=t.childNodes.length-1,e.replaceChild(t,n))}else if(1===n.nodeType){const e=n.nodeName.toLowerCase();if("script"===e&&i.processScriptTypePattern.test(n.type)){let t="displaystyle";for(const i of n.type.split(";")){const e=i.split("=");"mode"===e[0].toLowerCase()&&(t="display"===e[1].toLoweCase()?"displaystyle":"textstyle")}const e=As(n.textContent,t,i,!0);n.parentNode.replaceChild(e,n)}else(i.processClassPattern.test(n.className)||!i.skipTags.includes(e)&&!i.ignoreClassPattern.test(n.className))&&t(n,i)}}}}(t,e)}catch(t){Error}}};function Ls(t,e,i,s){e=e||"displaystyle";const n=o(t),r=he.parseTokens(n,"math",null,s);if("mathlist"===i)return r;let a=te.decompose({mathstyle:e},r);if(a=q.coalesce(a),"span"===i)return a;const l=q.makeSpan(a,"ML__base"),c=q.makeSpan("","ML__strut");c.setStyle("height",l.height,"em");const h=[c];if(0!==l.depth){const t=q.makeSpan("","ML__strut--bottom");t.setStyle("height",l.height+l.depth,"em"),t.setStyle("vertical-align",-l.depth,"em"),h.push(t)}return h.push(l),q.makeSpan(h,"ML__mathlive").toMarkup()}function Ds(t,e){if(!te.toMathML)return"";(e=e||{}).macros=e.macros||{},Object.assign(e.macros,St.MACROS);const i=he.parseTokens(o(t),"math",null,e.macros);return te.toMathML(i,e)}function js(t,e){if(!te.toSpeakableText)return"";(e=e||{}).macros=e.macros||{},Object.assign(e.macros,St.MACROS);const i=he.parseTokens(o(t),"math",null,e.macros);return te.toSpeakableText(i,e)}function Rs(t,e){if(!e&&window&&window.mathlive&&(e=window.mathlive.config),(e=e||{}).speechEngine&&"local"!==e.speechEngine)"amazon"===e.speechEngine&&window&&window.AWS&&new window.AWS.Polly({apiVersion:"2016-06-10"}).synthesizeSpeech({OutputFormat:"mp3",VoiceId:e.speechEngineVoice||"Joanna",Text:t,TextType:"ssml"},(function(t,e){if(t);else if(e&&e.AudioStream){const t=new Uint8Array(e.AudioStream),i=new Blob([t.buffer],{type:"audio/mpeg"}),s=URL.createObjectURL(i);new Audio(s).play().catch(t=>{})}}));else{const e=new SpeechSynthesisUtterance(t);window&&window.speechSynthesis.speak(e)}}function Is(t,e,i){if(!window)return;if(!i&&window.mathlive&&(i=window.mathlive.config),"amazon"!==(i=i||{}).speechEngine)return void(i.handleSpeak&&i.handleSpeak(e));if(!window.AWS)return;const s=new window.AWS.Polly({apiVersion:"2016-06-10"}),n={OutputFormat:"json",VoiceId:i.speechEngineVoice||"Joanna",Text:e,TextType:"ssml",SpeechMarkTypes:["ssml"]};window.mathlive=window.mathlive||{},window.mathlive.readAloudElement=t;const r=i.onReadAloudStatus||window.mathlive.onReadAloudStatus;s.synthesizeSpeech(n,(function(t,e){if(t);else if(e&&e.AudioStream){const t=new TextDecoder("utf-8").decode(new Uint8Array(e.AudioStream));window.mathlive.readAloudMarks=t.split("\n").map(t=>t?JSON.parse(t):{}),window.mathlive.readAloudTokens=[];for(const e of window.mathlive.readAloudMarks)e.value&&window.mathlive.readAloudTokens.push(e.value);window.mathlive.readAloudCurrentMark="",n.OutputFormat="mp3",n.SpeechMarkTypes=[],s.synthesizeSpeech(n,(function(t,e){if(t);else if(e&&e.AudioStream){const t=new Uint8Array(e.AudioStream),i=new Blob([t.buffer],{type:"audio/mpeg"}),s=URL.createObjectURL(i);window.mathlive.readAloudAudio?window.mathlive.readAloudAudio.pause():(window.mathlive.readAloudAudio=new Audio,window.mathlive.readAloudAudio.addEventListener("ended",()=>{r&&r(window.mathlive.readAloudMathField,"ended"),window.mathlive.readAloudMathField?(window.mathlive.readAloudMathField._render(),window.mathlive.readAloudElement=null,window.mathlive.readAloudMathField=null,window.mathlive.readAloudTokens=[],window.mathlive.readAloudMarks=[],window.mathlive.readAloudCurrentMark=""):function t(e){e.classList.remove("highlight"),e.children&&Array.from(e.children).forEach(e=>{t(e)})}(window.mathlive.readAloudElement)}),window.mathlive.readAloudAudio.addEventListener("timeupdate",()=>{let t="";const e=1e3*window.mathlive.readAloudAudio.currentTime+100;for(const i of window.mathlive.readAloudMarks)i.time<e&&(t=i.value);window.mathlive.readAloudCurrentMark!==t&&(window.mathlive.readAloudCurrentToken=t,t&&t===window.mathlive.readAloudFinalToken?window.mathlive.readAloudAudio.pause():(window.mathlive.readAloudCurrentMark=t,function t(e,i){i&&e.dataset.atomId!==i?(e.classList.remove("highlight"),e.children&&e.children.length>0&&Array.from(e.children).forEach(e=>{t(e,i)})):(e.classList.add("highlight"),e.children&&e.children.length>0&&Array.from(e.children).forEach(e=>{t(e)}))}(window.mathlive.readAloudElement,window.mathlive.readAloudCurrentMark)))})),window.mathlive.readAloudAudio.src=s,r&&r(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()}}))}}))}function Bs(t){let e=t;if("string"==typeof t&&(e=document.getElementById(t),!e))throw Error(`The element with ID "${t}" could not be found.`);return e}function Fs(t,e){Ns&&((e=e||{}).renderToMarkup=e.renderToMarkup||Ls,e.renderToMathML=e.renderToMathML||Ds,e.renderToSpeakableText=e.renderToSpeakableText||js,e.macros=e.macros||St.MACROS,Ns.renderMathInElement(Bs(t),e))}function Ys(t){if(t.namespace){if(!/^[a-z]+[-]?$/.test(t.namespace))throw Error("options.namespace must be a string of lowercase characters only");/-$/.test(t.namespace)||(t.namespace+="-")}}return{latexToMarkup:Ls,latexToMathML:Ds,latexToSpeakableText:js,latexToAST:function(t,e){if(!te.toAST)return{};(e=e||{}).macros=e.macros||{},Object.assign(e.macros,St.MACROS);const i=he.parseTokens(o(t),"math",null,e.macros);return te.toAST(i,e)},astToLatex:function(t,e){return function t(e,i){const s=Object.assign({precision:14,decimalMarker:".",groupSeparator:"\\, ",product:"\\cdot ",exponentProduct:"\\cdot ",exponentMarker:"",arcSeparator:"\\,",scientificNotation:"auto",beginRepeatingDigits:"\\overline{",endRepeatingDigits:"}"},i);let n="";if(void 0===e)return"";if("string"==typeof e&&(e=JSON.parse(e)),e.latex)n=e.latex;else if(Ui(e)){const i=Xi(e);if(i===-1/0)n="-\\infty ";else if(i===1/0)n="\\infty ";else if("object"!=typeof e.num||"string"!=typeof e.num.re&&"string"!=typeof e.num.im)n=isNaN(i)?"\\text{NaN}":us(e.num,s);else{const t=Gi(e),i=Hi(e);isNaN(t)||isNaN(i)?n="\\text{NaN}":Math.abs(i)<=Number.EPSILON&&Math.abs(t)<=Number.EPSILON?n="0":(Math.abs(t)>Number.EPSILON&&(n=us(t,s)),Math.abs(i)>Number.EPSILON&&(Math.abs(t)>Number.EPSILON&&(n+=i>0?"+":""),n+=(1!==Math.abs(i)?us(i,s):"")+"\\imaginaryI "))}Ji(e)&&(n+="^{"+t(e.sup,s)+"}"),$i(e)&&(n+="_{"+t(e.sub,s)+"}")}else if(e.group)n=t(e.group,s),Ui(e.group)||qi(e.group)?0!==Hi(e.group)&&(n=ls(e.fence||"(),",n)):n=ls(e.fence||"(),",n),Ji(e)&&(n+="^{"+t(e.sup,s)+"}"),$i(e)&&(n+="_{"+t(e.sub,s)+"}");else if(e.fn)if("bind"===e.fn){if(n=t(Oi(e,0),s)+"|_{",e.arg&&2===e.arg.length)n+=t(Oi(e,1));else{let i="";for(let s=1;s<e.arg.length;s+=2)n+=i+t(Oi(e,s))+" = "+t(Oi(e,s+1)),i=", "}n+="}"}else if("divide"===e.fn)n="\\frac{"+t(Oi(e,0),s)+"}{"+t(Oi(e,1),s)+"}";else if("negate"===e.fn)n="-"+t(Oi(e,0),s);else if("subtract"===e.fn)n=t(Oi(e,0),s)+" - "+t(Oi(e,1),s);else if("add"!==e.fn&&"multiply"!==e.fn||!Array.isArray(e.arg))if("list"===e.fn||"list2"===e.fn){const i=[];for(const n of e.arg)i.push(t(n,s));n=i.join("list2"===e.fn?"; ":", ")}else if("pow"===e.fn&&Array.isArray(e.arg)&&e.arg.length>=2)n=t(Oi(e,0),s),Ui(Oi(e,0))||qi(Oi(e,0))||(n=ls(e.fence||"(),",n)),n+="^{"+t(Oi(e,1),s)+"}";else if("equal"===e.fn&&e.arg&&e.arg.length>2)n=e.arg.map(e=>t(e,s)).join(" = ");else{const i=function(t){let e=Ti[t];return e||(e=t.length>1?"\\operatorname{"+t+"}%^%_ %":t+"%^%_ %"),e}(e.fn);n=i;let r="";if(/%(?![01_^])/.test(i)&&Array.isArray(e.arg)&&e.arg.length>1)n+=ls(e.fence||"(),",...e.arg.map(e=>t(e,s)));else if(Array.isArray(e.arg)&&e.arg.length>0){const o=t(Oi(e,0),s),a=t(Oi(e,1),s),l=[...e.arg];/%0/.test(i)&&(n=n.replace("%0",o),l.shift()),/%1/.test(i)&&(n=n.replace("%1",a),l.shift()),l.length>0&&(r=ls(e.fence||"(),",...l.map(e=>t(e,s))))}else r=ls(e.fence||"(),","");n=Ji(e)?n.replace("%^","^{"+t(e.sup,s)+"}"):n.replace("%^",""),n=$i(e)?n.replace("%_","_{"+t(e.sub,s)+"}"):n.replace("%_",""),n=n.replace(/%(?![01_^])/,r),n=n.replace("%0","").replace("%1","")}else{const i=[];for(const n of e.arg)"add"===n.fn||"subtract"===n.fn||0!==Gi(r=n)&&0!==Hi(r)||Ji(e)&&0!==Hi(n)&&1!==Hi(n)?i.push(ls("() ",t(n,s))):i.push(t(n,s));if("multiply"===e.fn)n=!e.arg||2!==e.arg.length||!Ui(e.arg[0])&&"divide"!==e.arg[0].fn||Ui(e.arg[1])&&(0!==Gi(e.arg[1])||1!==Hi(e.arg[1]))?i.join(" \\times "):i[0]+i[1];else if(e.arg&&1===e.arg.length)n="negate"===e.arg[0].fn||Ui(e.arg[0])&&Xi(e.arg[0])<0?i[0]:"+"+i[0];else{n=i[0];for(let t=1;t<e.arg.length;t++)"negate"===e.arg[t].fn||Ui(e.arg[t])&&Xi(e.arg[t])<0?n+=i[t]:n+=" + "+i[t]}}else if("string"==typeof e.sym){n=qi(e);let i=n.match(/^&#x([0-9a-f]+);$/i);i&&i[1]?n=String.fromCodePoint(parseInt(i[1],16)):(i=n.match(/^&#([0-9]+);$/i),i&&i[1]&&(n=String.fromCodePoint(parseInt(i[1])))),"string"==typeof e.variant&&(n="\\"+{normal:"mathrm","double-struck":"mathbb",bold:"mathbf",fraktur:"mathfrak",script:"mathscr","sans-serif":"mathsf",monospace:"mathtt"}[e.variant]+"{"+n+"}"),Ji(e)&&(n+="^{"+t(e.sup,s)+"}"),$i(e)&&(n+="_{"+t(e.sub,s)+"}")}else"string"==typeof e.text&&(n="\\text{"+e.text+"}");var r;return"string"==typeof e.error&&(n="\\bbox[#F56165]{"+n+"}"),n}(t,e)},makeMathField:function(t,e){if(!Ps)throw Error("The MathField module is not loaded.");return(e=e||{}).handleSpeak=e.handleSpeak||Rs,e.handleReadAloud=e.handleReadAloud||Is,new Ps.MathField(Bs(t),e)},renderMathInDocument:function(t){Fs(document.body,t)},renderMathInElement:Fs,revertToOriginalContent:function(t,e){(t=(t=Bs(t)).children[1])instanceof Ps.MathField?t.revertToOriginalContent():(Ys(e=e||{}),t.innerHTML=t.getAttribute("data-"+(e.namespace||"")+"original-content"))},getOriginalContent:function(t,e){return(t=(t=Bs(t)).children[1])instanceof Ps.MathField?t.originalContent:(Ys(e=e||{}),t.getAttribute("data-"+(e.namespace||"")+"original-content"))},readAloud:Is,readAloudStatus:function(){return window?(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio?window.mathlive.readAloudAudio.paused?"paused":window.mathlive.readAloudAudio.ended?"ready":"playing":"ready"):"unavailable"},pauseReadAloud:function(){window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio&&(window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"paused"),window.mathlive.readAloudAudio.pause()))},resumeReadAloud:function(){window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio&&(window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()))},playReadAloud:function(t,e){if(window&&(window.mathlive=window.mathlive||{},window.mathlive.readAloudAudio)){let i=0;if(window.mathlive.readAloudFinalToken=null,t){window.mathlive.readAloudMarks=window.mathlive.readAloudMarks||[];for(const e of window.mathlive.readAloudMarks)e.value===t&&(i=e.time/1e3);let s=window.mathlive.readAloudTokens.indexOf(t);s>=0&&(s+=e,s<window.mathlive.readAloudTokens.length&&(window.mathlive.readAloudFinalToken=s))}window.mathlive.readAloudAudio.currentTime=i,window.mathlive.onReadAloudStatus&&window.mathlive.onReadAloudStatus(window.mathlive.readAloudMathField,"playing"),window.mathlive.readAloudAudio.play()}}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).MathLive=factory();